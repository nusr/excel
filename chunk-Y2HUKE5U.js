/* 
MIT License

Copyright (c) 2020 Steve Xu

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/
var L="Sheet",T=200,v=30;var Pe=30,De=200,$e=-999,Ue="=",h="_",y=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],He=256,We=new Set(["#ERROR!","#DIV/0!","#NULL!","#NUM!","#REF!","#VALUE!","#N/A","#NAME?"]),Be=[{formatCode:"general",label:"",id:0},{formatCode:"0",label:"",id:1},{formatCode:"0.00",label:"",id:2},{formatCode:"#,##0",label:"",id:3},{formatCode:"#,##0.00",label:"",id:4},{formatCode:"0%",label:"",id:9},{formatCode:"0.00%",label:"",id:10},{formatCode:"0.00E+00",label:"",id:11},{formatCode:"# ?/?",label:"",id:12},{formatCode:"# ??/??",label:"",id:13},{formatCode:"mm-dd-yy",label:"",id:14},{formatCode:"d-mmm-yy",label:"",id:15},{formatCode:"d-mmm",label:"",id:16},{formatCode:"mmm-yy",label:"",id:17},{formatCode:"h:mm AM/PM",label:"",id:18},{formatCode:"h:mm:ss AM/PM",label:"",id:19},{formatCode:"hh:mm",label:"",id:20},{formatCode:"hh:mm:ss",label:"",id:21},{formatCode:"m/d/yy hh:mm",label:"",id:22},{formatCode:"#,##0 ;(#,##0)",label:"",id:37},{formatCode:"#,##0 ;[red](#,##0)",label:"",id:38},{formatCode:"#,##0.00 ;(#,##0.00)",label:"",id:39},{formatCode:"#,##0.00 ;[red](#,##0.00)",label:"",id:40},{formatCode:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',label:"",id:41},{formatCode:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',label:"",id:42},{formatCode:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',label:"",id:43},{formatCode:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)',label:"",id:44},{formatCode:"mm:ss",label:"",id:45},{formatCode:"[h]:mm:ss",label:"",id:46},{formatCode:"mm:ss.0",label:"",id:47},{formatCode:"##0.0E+0",label:"",id:48},{formatCode:"@",label:"",id:49}],Ye=24,ze=68,Ge=0,ke=16384,je=1048576;function O(e){if(typeof e=="number"&&!window.isNaN(e))return!0;if(typeof e!="string")return!1;let t=parseFloat(e);return!window.isNaN(t)}function ee(e){return O(e)?Number(e):0}function Je(e){let t=[];for(let o=0;o<e.length;o++){let r=ee(e[o]);window.isNaN(r)||t.push(r)}return t}function te(e=[]){let t=e.map(o=>O(o)?parseInt(o,10):0).filter(o=>!isNaN(o));return Math.max(Math.max(...t),0)}function Ze(e=[]){let t=te(e.map(o=>o.sheetId))+1;return{name:`${L}${t}`,sheetId:String(t)}}function Ke(e){return e?!Intl||!Intl.Segmenter?[...e]:[...new Intl.Segmenter([],{granularity:"word"}).segment(e)].map(r=>r.segment):[]}function Qe(e){let t=String(e);return typeof e=="boolean"||["TRUE","FALSE"].includes(t.toUpperCase())?t=t.toUpperCase():e==null&&(t=""),t}function qe(e,t){return`${e}${h}${t}`}function et(e){let[t,o]=e.split(h),r=parseInt(t,10),n=parseInt(o,10);return{row:isNaN(r)?0:r,col:isNaN(n)?0:n}}function tt(e,t){return`${e}${h}${t}`}function ot(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID();let e=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){let r=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(o==="x"?r:r&3|8).toString(16)})}function rt(){let e=[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i],t=navigator.userAgent;return e.some(o=>t.match(o))}function it(e,t=500){let o=!1,r=null;return function(...n){o?r=n:(e.apply(this,n),setTimeout(()=>{r&&e.apply(this,r),o=!1},t))}}function at(e,t,o){let r=e==null?void 0:t.replace(/\[/g,".").replace(/\]/g,"").split(".").reduce((n,i)=>n==null?n:n[i],e);return r===void 0?o:r}function st(e){let t=e||{};return[Object,Array].includes(t.constructor)&&!Object.entries(t).length}function oe(e,t){if(e===t)return!0;if(e&&typeof e=="object"&&t&&typeof t=="object"){if(Object.keys(e).length!==Object.keys(t).length)return!1;let o=Object.keys(e),r=Object.keys(t);for(let n=0;n<o.length;n++){let i=o[n],a=r[n];if(i!==a||!oe(e[i],t[a]))return!1}return!0}return!1}var re={smallFont:"10px",font:"12px",largeFont:"14px",padding:"12px",lineHeight:1.5,mediumPadding:"8px",largePadding:"20px",borderRadius:"4px",borderLargeRadius:"8px",tinyPadding:"4px",scrollBarSize:"18px"},N=re;var ne={lowZIndex:2,middleZIndex:3,highZIndex:4,highestZIndex:9},_=ne;function ie(e,t,o,r){t=t/100,o=o/100;let n=(1-Math.abs(2*o-1))*t,i=n*(1-Math.abs(e/60%2-1)),a=o-n/2,l,u,c;if(e>=0&&e<60?(l=n,u=i,c=0):e>=60&&e<120?(l=i,u=n,c=0):e>=120&&e<180?(l=0,u=n,c=i):e>=180&&e<240?(l=0,u=i,c=n):e>=240&&e<300?(l=i,u=0,c=n):(l=n,u=0,c=i),r!==1)return`rgba(${l},${u},${c},${r})`;let s=q=>Math.round(q*255).toString(16).padStart(2,"0"),m=s(l+a),d=s(u+a),I=s(c+a);return`#${m}${d}${I}`}var ae=(e,t,o)=>{let r=e/255,n=t/255,i=o/255,a=Math.min(r,n,i),l=Math.max(r,n,i),u=l-a,c=se(r,n,i),s=ce(l,a),m=le(u,s);return[c,m*100,s*100]},se=(e,t,o)=>{let r=Math.max(e,t,o),n=Math.min(e,t,o),i=r-n,a=0;if(i==0)a=0;else switch(r){case e:{let c=(t-o)/i,s=0;c<0&&(s=360/60),a=c+s;break}case t:{let c=(o-e)/i,s=120/60;a=c+s;break}case o:let l=(e-t)/i,u=240/60;a=l+u;break}return a*60},le=(e,t)=>e==0?0:e/(1-Math.abs(2*t-1)),ce=(e,t)=>(e+t)/2,A=([e,t,o,r])=>{let[n,i,a]=ae(e,t,o);return ie(n,i*.9,100-a,r)};function ue(e){e.startsWith("#")&&(e=e.slice(1));let t=parseInt(e.substring(0,2),16),o=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16),n=parseInt(e.substring(6,8)||"ff",16);return[t,o,r,n/255]}var P=e=>{if(e.startsWith("rgb")){let o=e.replace("rgb","").replace("a","").replace("(","").replace(")","").split(",").map(Number);return o.length<=3&&o.push(1),A(o)}else return A(ue(e))};var R=Object.freeze({primaryColor:"#217346",buttonActiveColor:"#c6c6c6",selectionColor:"rgba(198,198,198,0.3)",backgroundColor:"#e6e6e6",hoverColor:"rgba(0, 0, 0, 0.04)",scrollbarColor:"rgba(0, 0, 0, 0.1)",scrollbarHoveColor:"rgba(0, 0, 0, 0.2)",dialogBackground:"rgba(0, 0, 0, 0.6)",white:"#ffffff",black:"#000000",triangleFillColor:"#dddddd",contentColor:"#333333",borderColor:"#cccccc",activeBorderColor:"#808080",errorFormulaColor:"#ff0000"}),D=Object.freeze(Object.fromEntries(Object.entries(R).map(([e,t])=>[e,P(t)])));var ht={...N,..._};var S="data-theme";function bt(e){localStorage.setItem(S,e),document.documentElement.setAttribute(S,e)}function me(){let e=localStorage.getItem(S);return e||(window.matchMedia&&typeof window.matchMedia=="function"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}function xt(e){return me()==="dark"?D[e]:R[e]}function de(e=window.devicePixelRatio){return Math.max(Math.floor(e||1),1)}function $(e){return Math.floor(e*de())}function yt(){return 1}function Rt(){return navigator.userAgent.indexOf("Mac OS X")>-1}var U=11,b="sans-serif",zt=[6,8,9,10,U,12,14,16,18,20,22,24,26,28,36,48,72];function fe(e="normal",t="normal",o=12,r=""){let n=`${e} ${t} ${o}px `;return r?`${n}${r},${b}`:n+b}var Gt=fe(void 0,"500",$(U));function kt(e){let t="";return e.fontColor&&(t+=`color:${e.fontColor};`),e.fillColor&&(t+=`background-color:${e.fillColor};`),e.fontSize&&(t+=`font-size:${e.fontSize}pt;`),e.fontFamily&&(t+=`font-family:${e.fontFamily};`),e.isItalic&&(t+="font-style:italic;"),e.isBold&&(t+="font-weight:700;"),e.isWrapText&&(t+="white-space:normal;"),e.underline&&e.isStrike?t+="text-decoration-line:underline line-through;":e.underline?t+="text-decoration-line:underline;":e.isStrike&&(t+="text-decoration-line:line-through;"),e.underline===2&&(t+="text-decoration-style: double;"),t}function w(e){let{color:t,backgroundColor:o,fontSize:r,fontFamily:n,fontStyle:i,fontWeight:a,whiteSpace:l,textDecorationLine:u,textDecorationStyle:c}=e,s={};if(t&&(s.fontColor=t),o&&(s.fillColor=o),r){let m=parseInt(r,10);isNaN(m)||(s.fontSize=m)}return n&&(s.fontFamily=n),i==="italic"&&(s.isItalic=!0),a&&["700","800","900","bold"].includes(a)&&(s.isBold=!0),l&&["normal","pre-wrap","pre-line","break-spaces","revert","unset"].includes(l)&&(s.isWrapText=!0),u?.includes("underline")&&(s.underline=1,c==="double"&&(s.underline=2)),u?.includes("line-through")&&(s.isStrike=!0),s}function pe(e,t,o,r){let n={},i=e[r]||e[r.toLowerCase()];return i&&(n=w(i)),e[o]&&(n=Object.assign(n,w(e[o]))),n=Object.assign(n,w(t)),r==="s"||r==="strike"?n.isStrike=!0:r==="i"?n.isItalic=!0:r==="b"||r==="strong"?n.isBold=!0:r==="u"&&(n.underline=1),n}function Ce(e){let t=e.replace(/\s+/g,"").replace("<!--",""),o=/([^{}]+)\s*\{([^}]*)\}/g,r={},n;for(;(n=o.exec(t))!==null;){let i=document.createElement("div");i.style.cssText=n[2];let a=n[1].trim();r[a]=i.style,i=null}return r}function jt(e){let t=document.createElement("template");t.innerHTML=e;let o=t.content,r={};for(let l of o.querySelectorAll("style")){let u=Ce(l.textContent||"");for(let[c,s]of Object.entries(u))r[c]=Object.assign(r[c]||{},s)}let n=[],i=[],a=o.querySelectorAll("tr");for(let l of a){let u=[],c=[];for(let s of l.children){if(s.tagName!=="TD")continue;let m=s,d={};for(;m.nodeType!==Node.TEXT_NODE;){let I=pe(r,m.style,m.className?`.${m.className}`:"",m.tagName);if(d=Object.assign(d,I),m.firstChild)m=m.firstChild;else break}c.push(d),u.push(m.textContent||"")}n.push(u),i.push(c)}return t=null,{textList:n,styleList:i}}function Vt(e,t="assert error",o="production"){if(!e)throw o!=="test"&&window.alert(t),new Error(t)}function H(e=""){let t=e.toUpperCase(),o=0;for(let r=0;r<t.length;r++)o=t.charCodeAt(r)-64+o*26;return o-1}function W(e){let t=e+1,o="",r=Math.floor(Math.abs(t)),n;for(;r>0;)n=(r-1)%26,o=String.fromCharCode(65+n)+o,r=Math.floor((r-n)/26);return o.toUpperCase()}function B(e){let t=parseInt(e,10);return window.isNaN(t)?t=-1:t=Math.max(t-1,-1),t}function Kt(...e){let t="";for(let o of e)if(o!==void 0&&(typeof o=="string"&&o&&(t+=`${o} `),typeof o=="object"))for(let r of Object.keys(o))o[r]&&(t+=`${r} `);return t.trim()}function qt(e){return ge(e)&&he(e)}function ge(e){return e.colCount===0}function he(e){return e.rowCount===0}function eo(e,t){return!e||!t?!1:e.col===t.col&&e.row===t.row&&e.colCount===t.colCount&&e.rowCount===t.rowCount&&e.sheetId===t.sheetId}function to(e,t,o){return e>=o.row&&e<o.row+o.rowCount&&t>=o.col&&t<o.col+o.colCount}var p=class e{constructor(t,o,r,n,i){this.row=0;this.col=0;this.colCount=0;this.rowCount=0;this.sheetId="";this.row=t,this.col=o,this.colCount=n,this.rowCount=r,this.sheetId=i}isValid(){return this.row>=0&&this.col>=0&&this.colCount>=0&&this.rowCount>=0}static makeRange(t){return new e(t.row,t.col,t.rowCount,t.colCount,t.sheetId)}toIRange(){return{row:this.row,col:this.col,rowCount:this.rowCount,colCount:this.colCount,sheetId:this.sheetId}}};var be=e=>e>="a"&&e<="z"||e>="A"&&e<="Z",xe=e=>e>="0"&&e<="9";function F(e){return e}function Y(e,t=F){if(typeof e!="string"||!e)return null;let o=e.trim(),[r,n=""]=o.split("!");o.includes("!")||(r="",n=o);let i=0,a="",l="";for(n[i]==="$"&&i++;be(n[i]);)l+=n[i++];for(n[i]==="$"&&i++;xe(n[i]);)a+=n[i++];if(i!==n.length||!a&&!l)return null;let u=1,c=1,s=0,m=0;return a===""?(c=0,u=T):s=B(a),l===""?(c=v,u=0):m=H(l),s===-1||m===-1?null:new p(s,m,u,c,t(r))}function ao(e,t=F){let[o,r]=e.split(":"),n=Y(o,t);if(!n)return null;let i=Y(r,t);return i?(i.sheetId=n.sheetId,Ie(n,i)):n}function Ie(e,t){if(e.sheetId!==t.sheetId)return null;if(e.row===t.row&&e.col===t.col&&e.rowCount===t.rowCount&&e.colCount===t.colCount)return e;if((e.rowCount===0||t.rowCount===0)&&(t.rowCount!==0||t.rowCount!==0)||(e.colCount===0||t.colCount===0)&&(t.colCount!==0||t.colCount!==0))return null;let o=Math.abs(e.row-t.row)+1,r=Math.abs(e.col-t.col)+1,n=e.row<t.row?e.row:t.row,i=e.col<t.col?e.col:t.col;return new p(n,i,o,r,e.sheetId)}function z(e,t,o){let r=o==="absolute",n=o==="absolute";return`${r?"$":""}${W(t)}${n?"$":""}${e+1}`}function so(e,t="relative",o=F){let r=z(e.row,e.col,t),n=o(e.sheetId);if(n=n?`${n}!`:"",e.colCount>1&&e.rowCount>1){let i=z(e.row+e.rowCount,e.col+e.colCount,t);r=`${r}:${i}`}return n+r}var C=class e{constructor(t){this.init=()=>(this.setColor(),this.log);this.log=(...t)=>{if(!this.enable())return;let{namespace:o}=this,r=e.colorMap.get(o),n=[`%c ${o}:`,`color:${r};`,...t];console.log(...n)};this.getRandomColor=()=>{let t=Math.floor(Math.random()*y.length);return y[t]};this.namespace=t}static{this.colorMap=new Map}static{this.enableMap=new Map([])}enable(){return this.checkEnable()&&e.enableMap.get(this.namespace)!==!1}checkEnable(t=window.localStorage){return t.getItem("debug")==="*"}setColor(){e.colorMap.has(this.namespace)||e.colorMap.set(this.namespace,this.getRandomColor())}static disable(t){e.enableMap.set(t,!1)}},uo=new C("controller").init(),mo=new C("canvas").init(),fo=new C("model").init();var G="QUERY_ALL_LOCAL_FONT",k="LOCAL_FONT_KEY",j=["\u7B49\u7EBF","\u7B49\u7EBF Light","\u65B9\u6B63\u8212\u4F53","\u65B9\u6B63\u59DA\u4F53","\u4EFF\u5B8B","\u9ED1\u4F53","\u534E\u6587\u5F69\u4E91","\u534E\u6587\u4EFF\u5B8B","\u534E\u6587\u7425\u73C0","\u534E\u6587\u6977\u4F53","\u534E\u6587\u96B6\u4E66","\u534E\u6587\u5B8B\u4F53","\u534E\u6587\u7EC6\u9ED1","\u534E\u6587\u65B0\u9B4F","\u534E\u6587\u884C\u6977","\u534E\u6587\u4E2D\u5B8B","\u6977\u4F53","\u96B6\u4E66","\u5B8B\u4F53","\u5FAE\u8F6F\u96C5\u9ED1","\u5FAE\u8F6F\u96C5\u9ED1 Light","\u65B0\u5B8B\u4F53","\u5E7C\u5706","Arial","Arial Narrow","Cascadia Code","Cascadia Code ExtraLight","Cascadia Code Light","Cascadia Code PL","Cascadia Code PL ExtraLight","Cascadia Code PL Light","Cascadia Code PL SemiBold","Cascadia Code SemiBold","Cascadia Mono","Cascadia Mono ExtraLight","Cascadia Mono Light","Cascadia Mono PL","Cascadia Mono PL ExtraLight","Cascadia Mono PL Light","Cascadia Mono PL SemiBold","Cascadia Mono SemiBold","Microsoft JhengHei","Microsoft JhengHei Light","Microsoft JhengHei UI","Microsoft JhengHei UI Light","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft Yahei UI","Microsoft YaHei UI Light","Microsoft Yi Baiti","SimSun-ExtB","Times New Roman","Yu Gothic Light","Yu Gothic Medium","Yu Gothic Regular","Yu Gothic UI Light","Yu Gothic UI Regular","Yu Gothic UI Semibold"];function ye(){let e=["monospace",b,"serif"],t="mmmmmmmmmmlli",o="72px",r=document.getElementsByTagName("body")[0],n=document.createElement("span");n.style.fontSize=o,n.innerHTML=t;let i={},a={};for(let u of e)n.style.fontFamily=u,r.appendChild(n),i[u]=n.offsetWidth,a[u]=n.offsetHeight,r.removeChild(n);function l(u){let c=!1;for(let s of e){n.style.fontFamily=u+","+s,r.appendChild(n);let m=n.offsetWidth!=i[s]||n.offsetHeight!=a[s];r.removeChild(n),c=c||m}return c}return l}var Re=ye();function bo(e=j){let t=localStorage.getItem(k);if(t)return JSON.parse(t).map(n=>({value:n,label:n,disabled:!1}));let o=e.map(r=>({label:r,value:r,disabled:!Re(r)})).filter(r=>!r.disabled);return window.queryLocalFonts&&o.push({value:G,label:"--> get all local installed fonts",disabled:!1}),o}var f="text/plain",g="text/html";function Se(e){let t=e.hasAttribute("readonly");return t||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),t||e.removeAttribute("readonly"),e.value}function we(e){let t=document.documentElement.getAttribute("dir")==="rtl",o=document.createElement("textarea");o.style.fontSize="12pt",o.style.border="0",o.style.padding="0",o.style.margin="0",o.style.position="absolute",o.style[t?"right":"left"]="-9999px";let r=window.pageYOffset||document.documentElement.scrollTop;return o.style.top=`${r}px`,o.setAttribute("readonly",""),o.value=e,o}function Fe(e){let t={},o=Object.keys(e);for(let n of o)t[n]=new Blob([e[n]],{type:n});let r=[new ClipboardItem(t)];return navigator?.clipboard?.write(r)}async function Me(){let e={[g]:"",[f]:""},t=await navigator?.clipboard?.read()||[];for(let o of t){if(o.types.includes(f)){let r=await o.getType(f);e[f]=await r.text()}if(o.types.includes(g)){let r=await o.getType(g);e[g]=await r.text()}}return e}var Ee=(e,t,o)=>{let r=we(e);t.appendChild(r);let n=Se(r);return document.execCommand(o),r.remove(),r=null,n};async function Io(e,t){try{return await Fe(e),e[f]}catch(o){return console.error(o),Ee(e[f],document.body,t)}}async function yo(){try{return Me()}catch(e){console.error(e);let t=await navigator?.clipboard?.readText()||"";return{[g]:"",[f]:t}}}function Ro(e,t){return`<html
  xmlns:v="urn:schemas-microsoft-com:vml"
  xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:x="urn:schemas-microsoft-com:office:excel"
  xmlns="http://www.w3.org/TR/REC-html40"
>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="ProgId" content="Excel.Sheet" />
    <meta name="Generator" content="Microsoft Excel 15" />
    <style>
      ${e}
    </style>
  </head>

  <body >
    <table
    >
      ${t}
    </table>
  </body>
</html>`}function wo(e,t,o){if(t<0||o<0)return null;let r=e.getSheetInfo(e.getCurrentSheetId());if(!r)return null;let n=e.getScroll(),i=e.getHeaderSize(),a=i.width,l=i.height,u=t-i.width,c=o-i.height,{row:s,col:m}=n;for(;a+e.getColWidth(m).len<=t;){let d=e.getColWidth(m).len;a+=d,u-=d,m++}for(;l+e.getRowHeight(s).len<=o;){let d=e.getRowHeight(s).len;l+=d,c-=d,s++}return s>=r.rowCount||m>=r.colCount?null:{row:s,col:m,marginX:u,marginY:c}}function Mo(e,t){let o=document.createElement("a");o.download=t||"download",o.rel="noopener",o.target="_blank",typeof e=="string"?o.href=e:o.href=URL.createObjectURL(e),o.dispatchEvent(new MouseEvent("click")),o=null}var X={maroon:"#800000",red:"#ff0000",orange:"#ffA500",yellow:"#ffff00",olive:"#808000",purple:"#800080",fuchsia:"#ff00ff",white:"#ffffff",lime:"#00ff00",green:"#008000",navy:"#000080",blue:"#0000ff",aqua:"#00ffff",teal:"#008080",black:"#000000",silver:"#c0c0c0",gray:"#808080",transparent:"#0000"},Le="(?:#([a-f0-9]{3,8}))",M="\\s*([.\\d%]+)\\s*",Te="(?:,\\s*([.\\d]+)\\s*)?",Z=`\\(${[M,M,M]}${Te}\\)`,ve="(?:rgb)a?",Oe="(?:hsl)a?",K=RegExp(Le,"i"),V=RegExp(ve+Z,"i"),J=RegExp(Oe+Z,"i");function Ne(e){return e.length===1?`0${e}`:e}function Q(e,t,o,r){return`#${[e,t,o,r*255].map(i=>Ne(Math.round(i).toString(16))).join("")}`}function _e(e,t,o,r){let n=1;r&&(n=parseFloat(r));let i=parseFloat(e),a=parseFloat(t),l=parseFloat(o);return i<=255&&i>=0&&a<=255&&a>=0&&l<=255&&l>=0&&n<=1&&n>=0?Q(i,a,l,n):""}function E(e,t,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+(t-e)*6*o:o<1/2?t:o<2/3?e+(t-e)*(2/3-o)*6:e}function Ae(e,t,o,r){let n=1;r&&(n=parseFloat(r)/1);let i=parseFloat(e)/360,a=parseFloat(t)/360,l=parseFloat(o)/360;if(i>1||i<0||a>1||a<0||l>1||l<0||n>1||n<0)return"";let u,c,s;if(a===0)u=l,c=l,s=l;else{let m=l<.5?l*(1+a):l+a-l*a,d=2*l-m;u=E(d,m,i+1/3),c=E(d,m,i),s=E(d,m,i-1/3)}return Q(u*255,c*255,s*255,n)}function x(e){if(!K.test(e))return"";if(e.length===9)return e.toUpperCase();if(e.length===7)return`${e}ff`.toUpperCase();if(e.length===5){let[,t,o,r,n]=e;return`#${t}${t}${o}${o}${r}${r}${n}${n}`.toUpperCase()}if(e.length===4){let[,t,o,r]=e;return`#${t}${t}${o}${o}${r}${r}ff`.toUpperCase()}return""}function Lo(e){if(!e)return"";if(X[e])return x(X[e]);if(K.test(e))return x(e);if(V.test(e)){let[,t,o,r,n]=e.match(V);return x(_e(t,o,r,n))}if(J.test(e)){let[,t,o,r,n]=e.match(J);return x(Ae(t,o,r,n))}return""}export{de as a,$ as b,yt as c,Rt as d,U as e,zt as f,fe as g,Gt as h,kt as i,jt as j,Vt as k,T as l,v as m,Pe as n,De as o,$e as p,Ue as q,y as r,He as s,We as t,Be as u,Ye as v,ze as w,Ge as x,ke as y,je as z,O as A,ee as B,Je as C,Ze as D,Ke as E,Qe as F,qe as G,et as H,tt as I,ot as J,rt as K,W as L,Kt as M,qt as N,ge as O,he as P,eo as Q,to as R,p as S,ao as T,Ie as U,so as V,uo as W,mo as X,fo as Y,G as Z,k as _,Re as $,bo as aa,f as ba,g as ca,Io as da,yo as ea,Ro as fa,it as ga,at as ha,st as ia,oe as ja,R as ka,D as la,ht as ma,bt as na,me as oa,xt as pa,wo as qa,Mo as ra,Lo as sa};
//# sourceMappingURL=chunk-Y2HUKE5U.js.map
