{
  "version": 3,
  "sources": ["../src/util/dpr.ts", "../src/util/style.ts", "../src/util/assert.ts", "../src/util/constant.ts", "../src/util/util.ts", "../src/util/convert.ts", "../src/util/classnames.ts", "../src/util/range.ts", "../src/util/reference.ts", "../src/lodash/isEmpty.ts", "../src/lodash/randomInt.ts", "../src/lodash/get.ts", "../src/lodash/setWith.ts", "../src/lodash/debounce.ts", "../src/util/debug.ts", "../src/util/isSupportFontFamily.ts", "../src/react/dom.ts", "../src/react/h.ts", "../src/react/init.ts", "../src/react/modules/attributes.ts", "../src/react/modules/class.ts", "../src/react/modules/dataset.ts", "../src/react/modules/event.ts", "../src/react/modules/props.ts", "../src/react/modules/style.ts", "../src/react/index.ts", "../src/containers/canvas/index.ts", "../src/containers/FormulaBar/FormulaEditor.ts", "../src/containers/FormulaBar/index.tsx", "../src/components/Button/index.tsx", "../src/components/Github/index.ts", "../src/components/BaseIcon/icon.ts", "../src/components/BaseIcon/BaseIcon.ts", "../src/components/BaseIcon/FillColorIcon.ts", "../src/components/BaseIcon/index.ts", "../src/components/Select/index.ts", "../src/components/ColorPicker/index.tsx", "../src/containers/ToolBar/index.ts", "../src/theme/size.ts", "../src/theme/color.ts", "../src/theme/index.ts", "../src/containers/SheetBar/index.ts", "../src/containers/ContextMenu/index.ts", "../src/App.ts", "../src/controller/Controller.ts", "../src/controller/History.ts", "../src/parser/token.ts", "../src/parser/error.ts", "../src/parser/scanner.ts", "../src/parser/expression.ts", "../src/parser/parser.ts", "../src/formula/text.ts", "../src/formula/math.ts", "../src/formula/index.ts", "../src/parser/interpreter.ts", "../src/parser/eval.ts", "../src/model/Model.ts", "../src/model/mockModel.ts", "../src/canvas/Main.ts", "../src/canvas/event.ts", "../src/canvas/util.ts", "../src/canvas/Selection.ts", "../src/canvas/constant.ts", "../src/canvas/Content.ts", "../src/init.ts", "../src/index.ts"],
  "sourcesContent": ["export function dpr(data = window.devicePixelRatio): number {\r\n  return Math.max(Math.floor(data || 1), 1);\r\n}\r\n\r\nexport function npx(px: number): number {\r\n  return Math.floor(px * dpr());\r\n}\r\n\r\nexport function thinLineWidth(): number {\r\n  return 1;\r\n}\r\n\r\nexport function resizeCanvas(\r\n  canvas: HTMLCanvasElement,\r\n  width: number,\r\n  height: number,\r\n): void {\r\n  canvas.style.width = width + 'px';\r\n  canvas.style.height = height + 'px';\r\n  const realWidth = npx(width);\r\n  const realHeight = npx(height);\r\n  canvas.width = realWidth;\r\n  canvas.height = realHeight;\r\n}\r\n\r\nexport function createCanvas() {\r\n  const canvas = document.createElement('canvas');\r\n  canvas.style.display = 'none';\r\n  document.body.appendChild(canvas);\r\n  return canvas;\r\n}\r\n", "/**\r\n * font-style:  none | normal | italic | oblique\r\n * font-variant none | normal | small-caps // \u4F5C\u7528\u4E0D\u5927\r\n * font-weight  none | normal | bold | \u6570\u5B57\r\n * font-size\r\n * line-height\r\n * font-family\r\n * e.g italic bold 14px/16px sans-serif;\r\n */\r\nimport { npx } from \"./dpr\";\r\n\r\nexport const DEFAULT_FONT_SIZE = 11;\r\nexport const DEFAULT_FONT_COLOR = \"#333333\";\r\nexport const ERROR_FORMULA_COLOR = \"#ff0000\";\r\nexport const DEFAULT_FILL_COLOR = \"transparent\";\r\nexport const MUST_FONT_FAMILY = \"sans-serif\";\r\nexport const DEFAULT_FONT_FAMILY = \"\u5B8B\u4F53\";\r\n\r\nexport const FONT_SIZE_LIST = [\r\n  6,\r\n  8,\r\n  9,\r\n  10,\r\n  DEFAULT_FONT_SIZE,\r\n  12,\r\n  14,\r\n  16,\r\n  18,\r\n  20,\r\n  22,\r\n  24,\r\n  26,\r\n  28,\r\n  36,\r\n  48,\r\n  72,\r\n];\r\n\r\nexport const FONT_FAMILY_LIST = [\r\n  DEFAULT_FONT_FAMILY,\r\n  \"Times New Roman\",\r\n  \"Arial\",\r\n  \"Tahoma\",\r\n  \"Verdana\",\r\n  \"\u5FAE\u8F6F\u96C5\u9ED1\",\r\n  \"\u9ED1\u4F53\",\r\n  \"\u6977\u4F53\",\r\n  \"\u4EFF\u5B8B\",\r\n  \"\u65B0\u5B8B\u4F53\",\r\n  \"\u534E\u6587\u65B0\u9B4F\",\r\n  \"\u534E\u6587\u884C\u6977\",\r\n  \"\u534E\u6587\u96B6\u4E66\",\r\n  \"\u82F9\u65B9\",\r\n];\r\n\r\nexport function makeFont(\r\n  fontStyle: \"none\" | \"normal\" | \"italic\" | \"oblique\" = \"normal\",\r\n  fontWeight = \"normal\",\r\n  fontSize = 12,\r\n  fontFamily: string = DEFAULT_FONT_FAMILY\r\n): string {\r\n  return `${fontStyle} ${fontWeight} ${fontSize}px ${fontFamily},${MUST_FONT_FAMILY}`;\r\n}\r\n\r\nexport const DEFAULT_FONT_CONFIG = makeFont(\r\n  undefined,\r\n  \"500\",\r\n  npx(DEFAULT_FONT_SIZE)\r\n);\r\n", "export function assert(\r\n  condition: boolean,\r\n  message = \"assert error\",\r\n  env = process.env.NODE_ENV\r\n): asserts condition {\r\n  if (!condition) {\r\n    if (env === \"production\") {\r\n      console.error(message);\r\n      return;\r\n    }\r\n    throw new Error(message);\r\n  }\r\n}\r\n", "import type { ErrorTypes, StoreValue } from '@/types';\r\nexport const SHEET_NAME_PREFIX = 'Sheet';\r\nexport const STYLE_ID_PREFIX = 'style';\r\nexport const DEFAULT_ROW_COUNT = 200;\r\nexport const DEFAULT_COL_COUNT = 30;\r\nexport const MAIN_CANVAS_ID = 'main-canvas-id';\r\nexport const FORMULA_EDITOR_ID = 'formula-editor';\r\nexport const DOUBLE_CLICK_TIME = 300;\r\nexport const TEST_ID_KEY = 'data-test-id';\r\nexport const SCROLL_SIZE = 30;\r\nexport const DEBUG_COLOR_LIST = [\r\n  '#0000CC',\r\n  '#0000FF',\r\n  '#0033CC',\r\n  '#0033FF',\r\n  '#0066CC',\r\n  '#0066FF',\r\n  '#0099CC',\r\n  '#0099FF',\r\n  '#00CC00',\r\n  '#00CC33',\r\n  '#00CC66',\r\n  '#00CC99',\r\n  '#00CCCC',\r\n  '#00CCFF',\r\n  '#3300CC',\r\n  '#3300FF',\r\n  '#3333CC',\r\n  '#3333FF',\r\n  '#3366CC',\r\n  '#3366FF',\r\n  '#3399CC',\r\n  '#3399FF',\r\n  '#33CC00',\r\n  '#33CC33',\r\n  '#33CC66',\r\n  '#33CC99',\r\n  '#33CCCC',\r\n  '#33CCFF',\r\n  '#6600CC',\r\n  '#6600FF',\r\n  '#6633CC',\r\n  '#6633FF',\r\n  '#66CC00',\r\n  '#66CC33',\r\n  '#9900CC',\r\n  '#9900FF',\r\n  '#9933CC',\r\n  '#9933FF',\r\n  '#99CC00',\r\n  '#99CC33',\r\n  '#CC0000',\r\n  '#CC0033',\r\n  '#CC0066',\r\n  '#CC0099',\r\n  '#CC00CC',\r\n  '#CC00FF',\r\n  '#CC3300',\r\n  '#CC3333',\r\n  '#CC3366',\r\n  '#CC3399',\r\n  '#CC33CC',\r\n  '#CC33FF',\r\n  '#CC6600',\r\n  '#CC6633',\r\n  '#CC9900',\r\n  '#CC9933',\r\n  '#CCCC00',\r\n  '#CCCC33',\r\n  '#FF0000',\r\n  '#FF0033',\r\n  '#FF0066',\r\n  '#FF0099',\r\n  '#FF00CC',\r\n  '#FF00FF',\r\n  '#FF3300',\r\n  '#FF3333',\r\n  '#FF3366',\r\n  '#FF3399',\r\n  '#FF33CC',\r\n  '#FF33FF',\r\n  '#FF6600',\r\n  '#FF6633',\r\n  '#FF9900',\r\n  '#FF9933',\r\n  '#FFCC00',\r\n  '#FFCC33',\r\n];\r\nexport const MAX_PARAMS_COUNT = 256;\r\n\r\nexport const ERROR_SET = new Set<ErrorTypes>([\r\n  '#ERROR!',\r\n  '#DIV/0!',\r\n  '#NULL!',\r\n  '#NUM!',\r\n  '#REF!',\r\n  '#VALUE!',\r\n  '#N/A',\r\n  '#NAME?',\r\n]);\r\n\r\nexport const DEFAULT_STORE_VALUE: StoreValue = {\r\n  sheetList: [],\r\n  currentSheetId: '',\r\n  isCellEditing: false,\r\n  activeCell: {\r\n    value: '',\r\n    row: 0,\r\n    col: 0,\r\n    style: {},\r\n  },\r\n  cellPosition: {\r\n    left: -999,\r\n    top: -999,\r\n    width: 0,\r\n    height: 0,\r\n  },\r\n  canRedo: false,\r\n  canUndo: false,\r\n  fontFamilyList: [],\r\n  contextMenuPosition: undefined,\r\n  scrollLeft: 0,\r\n  scrollTop: 0,\r\n};\r\n", "import { SHEET_NAME_PREFIX } from './constant';\r\nimport type { WorksheetType, ResultType } from '@/types';\r\nexport const isString = (value: ResultType): boolean => {\r\n  return typeof value === 'string';\r\n};\r\nexport function isNumber(value: ResultType): boolean {\r\n  if (typeof value === 'number' && !window.isNaN(value)) {\r\n    return true;\r\n  }\r\n  if (typeof value !== 'string') {\r\n    return false;\r\n  }\r\n  const temp = parseFloat(value);\r\n  return !window.isNaN(temp) && temp === Number(value);\r\n}\r\n\r\nexport function parseNumber(value: ResultType): number {\r\n  if (isNumber(value)) {\r\n    return Number(value);\r\n  }\r\n  return 0;\r\n}\r\n\r\nexport function parseNumberArray(list: ResultType[]): number[] {\r\n  const result: number[] = [];\r\n  for (let i = 0; i < list.length; i++) {\r\n    const temp = parseNumber(list[i]);\r\n    if (!window.isNaN(temp)) {\r\n      result.push(temp);\r\n    }\r\n  }\r\n  return result;\r\n}\r\n\r\nexport function getListMaxNum(list: string[] = [], prefix = ''): number {\r\n  const idList: number[] = list\r\n    .map((item) => {\r\n      if (isNumber(item) || prefix.length === 0) {\r\n        return parseInt(item, 10);\r\n      }\r\n      return parseInt(\r\n        item.includes(prefix) ? item.slice(prefix.length) : item,\r\n        10,\r\n      );\r\n    })\r\n    .filter((v) => !isNaN(v));\r\n  return Math.max(Math.max(...idList), 0);\r\n}\r\n\r\nexport function getDefaultSheetInfo(\r\n  list: WorksheetType[] = [],\r\n): Pick<WorksheetType, 'name' | 'sheetId'> {\r\n  const sheetNum = getListMaxNum(\r\n    list.map((item) => item.name),\r\n    SHEET_NAME_PREFIX,\r\n  );\r\n  const sheetId = getListMaxNum(list.map((item) => item.sheetId)) + 1;\r\n  return {\r\n    name: `${SHEET_NAME_PREFIX}${sheetNum + 1}`,\r\n    sheetId: String(sheetId),\r\n  };\r\n}\r\n\r\nexport function isTestEnv(): boolean {\r\n  return process.env.NODE_ENV === 'test';\r\n}\r\n", "/**\r\n * convert column name to number. e.g A -> 0, a -> 0\r\n * @param { string } columnName\r\n */\r\nexport function columnNameToInt(columnName = \"\"): number {\r\n  const temp = columnName.toUpperCase();\r\n  let num = 0;\r\n  for (let i = 0; i < temp.length; i++) {\r\n    num = temp.charCodeAt(i) - 64 + num * 26;\r\n  }\r\n  return num - 1;\r\n}\r\n/**\r\n * convert number to column name 0 -> A\r\n * @param { string } number\r\n */\r\nexport function intToColumnName(temp: number): string {\r\n  const num = temp + 1;\r\n  let columnName = \"\";\r\n  let dividend = Math.floor(Math.abs(num));\r\n  let rest;\r\n\r\n  while (dividend > 0) {\r\n    rest = (dividend - 1) % 26;\r\n    columnName = String.fromCharCode(65 + rest) + columnName;\r\n    dividend = Math.floor((dividend - rest) / 26);\r\n  }\r\n  return columnName.toUpperCase();\r\n}\r\n\r\nexport function rowLabelToInt(label: string): number {\r\n  let result = parseInt(label, 10);\r\n  if (window.isNaN(result)) {\r\n    result = -1;\r\n  } else {\r\n    result = Math.max(result - 1, -1);\r\n  }\r\n  return result;\r\n}\r\n\r\nexport function intToRowLabel(row: number): string {\r\n  if (row >= 0) {\r\n    return `${row + 1}`;\r\n  }\r\n  return \"\";\r\n}\r\n", "export function classnames(\r\n  ...rest: Array<string | Record<string, unknown>>\r\n): string {\r\n  let result = \"\";\r\n  for (const temp of rest) {\r\n    if (typeof temp === \"string\" && temp) {\r\n      result += `${temp} `;\r\n    }\r\n    if (typeof temp === \"object\") {\r\n      for (const key of Object.keys(temp)) {\r\n        if (temp[key]) {\r\n          result += `${key} `;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return result.trim();\r\n}\r\n", "import { IRange } from \"@/types\";\r\nexport function isSheet(range: IRange): boolean {\r\n  return isRow(range) && isCol(range);\r\n}\r\nexport function isRow(range: IRange): boolean {\r\n  return range.col === range.rowCount && range.rowCount === 0;\r\n}\r\nexport function isCol(range: IRange): boolean {\r\n  return range.row === range.colCount && range.colCount === 0;\r\n}\r\nexport class Range implements IRange {\r\n  row = 0;\r\n  col = 0;\r\n  colCount = 0;\r\n  rowCount = 0;\r\n  sheetId = \"\";\r\n  constructor(\r\n    row: number,\r\n    col: number,\r\n    rowCount: number,\r\n    colCount: number,\r\n    sheetId: string\r\n  ) {\r\n    this.row = row;\r\n    this.col = col;\r\n    this.colCount = colCount;\r\n    this.rowCount = rowCount;\r\n    this.sheetId = sheetId;\r\n  }\r\n\r\n  isValid(): boolean {\r\n    return (\r\n      this.row >= 0 && this.col >= 0 && this.colCount >= 0 && this.rowCount >= 0\r\n    );\r\n  }\r\n  static makeRange(range: IRange): Range {\r\n    return new Range(\r\n      range.row,\r\n      range.col,\r\n      range.rowCount,\r\n      range.colCount,\r\n      range.sheetId\r\n    );\r\n  }\r\n}\r\n", "import { columnNameToInt, rowLabelToInt } from './convert';\r\nimport { Range } from './range';\r\nimport { DEFAULT_ROW_COUNT, DEFAULT_COL_COUNT } from './constant';\r\n\r\nconst isCharacter = (char: string) =>\r\n  (char >= 'a' && char <= 'z') || (char >= 'A' && char <= 'Z');\r\nconst isNum = (char: string) => char >= '0' && char <= '9';\r\n\r\nexport function parseCell(ref: string): Range | null {\r\n  if (typeof ref !== 'string' || !ref) {\r\n    return null;\r\n  }\r\n  const realRef = ref.trim();\r\n  let [sheetName, other = ''] = realRef.split('!');\r\n  if (!realRef.includes('!')) {\r\n    sheetName = ''\r\n    other = realRef\r\n  }\r\n  let i = 0;\r\n  let rowText = '';\r\n  let colText = '';\r\n  if (other[i] === '$') {\r\n    i++;\r\n  }\r\n  while (isCharacter(other[i])) {\r\n    colText += other[i++];\r\n  }\r\n  if (other[i] === '$') {\r\n    i++;\r\n  }\r\n  while (isNum(other[i])) {\r\n    rowText += other[i++];\r\n  }\r\n  if (i !== other.length) {\r\n    return null;\r\n  }\r\n  if (!rowText && !colText) {\r\n    return null;\r\n  }\r\n\r\n  let rowCount = 1;\r\n  let colCount = 1;\r\n  let row = 0;\r\n  let col = 0;\r\n  if (rowText === '') {\r\n    colCount = 0;\r\n    rowCount = DEFAULT_ROW_COUNT;\r\n  } else {\r\n    row = rowLabelToInt(rowText);\r\n  }\r\n  if (colText === '') {\r\n    colCount = DEFAULT_COL_COUNT;\r\n    rowCount = 0;\r\n  } else {\r\n    col = columnNameToInt(colText);\r\n  }\r\n  if (row === -1 || col === -1) {\r\n    return null\r\n  }\r\n  const range = new Range(row, col, rowCount, colCount, sheetName);\r\n  return range;\r\n}\r\n\r\nexport function parseReference(text: string): Range | null {\r\n  const [cell1, cell2] = text.split(':');\r\n  const startCell = parseCell(cell1);\r\n  if (!startCell) {\r\n    return null;\r\n  }\r\n  const endCell = parseCell(cell2);\r\n  if (!endCell) {\r\n    return startCell;\r\n  }\r\n  const rowCount = endCell.row - startCell.row + 1;\r\n  const colCount = endCell.col - startCell.col + 1;\r\n  return new Range(\r\n    startCell.row,\r\n    startCell.col,\r\n    rowCount,\r\n    colCount,\r\n    endCell.sheetId,\r\n  );\r\n}\r\n", "export function isEmpty(value: unknown): boolean {\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  const temp: any = value || {};\r\n  return (\r\n    [Object, Array].includes(temp.constructor) && !Object.entries(temp).length\r\n  );\r\n}\r\n", "export function randomInt(min: number, max: number): number {\r\n  const t1 = Math.min(min, max);\r\n  const t2 = Math.max(min, max);\r\n  return Math.floor(t1 + Math.random() * (t2 - t1 + 1));\r\n}\r\n", "export function get<T>(\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  obj: Record<string, any> | null | undefined,\r\n  path: string,\r\n  defaultValue?: T\r\n): T {\r\n  const result =\r\n    obj == null\r\n      ? undefined\r\n      : path\r\n          .replace(/\\[/g, \".\")\r\n          .replace(/\\]/g, \"\")\r\n          .split(\".\")\r\n          .reduce((res, key) => {\r\n            return res == null ? res : res[key];\r\n          }, obj);\r\n  return (result === undefined ? defaultValue : result) as T;\r\n}\r\n", "export function setWith<ValueType>(\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  obj: Record<string, any> | null | undefined,\r\n  path: string,\r\n  value: ValueType\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n): Record<string, any> | null | undefined {\r\n  if (obj == null || typeof obj !== \"object\") {\r\n    return obj;\r\n  }\r\n  path\r\n    .replace(/\\[/g, \".\")\r\n    .replace(/\\]/g, \"\")\r\n    .split(\".\")\r\n    .reduce((res, key, index, arr) => {\r\n      if (index === arr.length - 1) {\r\n        res[key] = value;\r\n      } else {\r\n        if (res[key] == null) {\r\n          res[key] = {};\r\n        }\r\n      }\r\n      return res[key];\r\n    }, obj);\r\n  return obj;\r\n}\r\n", "export function debounce(fn: (...params: any[]) => void) {\r\n  let timer: ReturnType<typeof requestAnimationFrame>;\r\n  return (...rest: any[]) => {\r\n    cancelAnimationFrame(timer);\r\n    timer = requestAnimationFrame(() => {\r\n      fn(...rest);\r\n    });\r\n  };\r\n}", "import { randomInt } from '@/lodash';\r\nimport { assert } from './assert';\r\nimport { DEBUG_COLOR_LIST } from './constant';\r\ntype NameSpaceType = 'react' | 'controller' | 'canvas' | 'model';\r\n\r\nclass Debug {\r\n  namespace: NameSpaceType;\r\n\r\n  static readonly colorMap: Map<NameSpaceType, string> = new Map<\r\n    NameSpaceType,\r\n    string\r\n  >();\r\n  static readonly enableMap: Map<NameSpaceType, boolean> = new Map<\r\n    NameSpaceType,\r\n    boolean\r\n  >([]);\r\n  constructor(namespace: NameSpaceType) {\r\n    this.namespace = namespace;\r\n  }\r\n  init = () => {\r\n    this.setColor();\r\n    return this.log;\r\n  };\r\n  log = (...rest: Array<unknown>): void => {\r\n    if (!this.enable()) {\r\n      return;\r\n    }\r\n    const { namespace } = this;\r\n    const color = Debug.colorMap.get(namespace);\r\n    const result = [`%c ${namespace}:`, `color:${color};`, ...rest];\r\n    console.log(...result);\r\n  };\r\n  getRandomColor = (): string => {\r\n    const index = randomInt(0, DEBUG_COLOR_LIST.length - 1);\r\n    assert(index >= 0 && index < DEBUG_COLOR_LIST.length, String(index));\r\n    return DEBUG_COLOR_LIST[index];\r\n  };\r\n  enable() {\r\n    return this.checkEnable() && Debug.enableMap.get(this.namespace) !== false;\r\n  }\r\n  checkEnable(storage = window.localStorage) {\r\n    return storage.getItem('debug') === '*';\r\n  }\r\n  setColor() {\r\n    if (!Debug.colorMap.has(this.namespace)) {\r\n      Debug.colorMap.set(this.namespace, this.getRandomColor());\r\n    }\r\n  }\r\n}\r\n\r\nexport const reactLog = new Debug('react').init();\r\nexport const controllerLog = new Debug('controller').init();\r\nexport const canvasLog = new Debug('canvas').init();\r\nexport const modelLog = new Debug('model').init();\r\n", "import { assert } from './assert';\r\nimport { MUST_FONT_FAMILY } from './style';\r\nimport { isTestEnv } from './util';\r\n\r\nfunction SupportFontFamilyFactory(defaultFont = MUST_FONT_FAMILY) {\r\n  if (isTestEnv()) {\r\n    return {\r\n      isSupportFontFamily: () => true,\r\n    };\r\n  }\r\n  const canvas = document.createElement('canvas');\r\n  const ctx = canvas.getContext('2d');\r\n  assert(ctx !== null);\r\n  const getImageData = function (font: string) {\r\n    const width = 50;\r\n    canvas.width = width;\r\n    canvas.height = width;\r\n    ctx.textAlign = 'center';\r\n    ctx.fillStyle = 'black';\r\n    ctx.textBaseline = 'middle';\r\n    ctx.clearRect(0, 0, width, width);\r\n    ctx.font = `${width}px ${font},${defaultFont}`;\r\n    ctx.fillText('\u5B8Ba', width / 2, width / 2);\r\n    const imageData = ctx.getImageData(0, 0, width, width, {\r\n      colorSpace: 'srgb',\r\n    }).data;\r\n    return imageData.join('');\r\n  };\r\n  const defaultImageData = getImageData(defaultFont);\r\n  const isSupportFontFamily = (fontFamily: string) => {\r\n    if (typeof fontFamily != 'string') {\r\n      return false;\r\n    }\r\n    if (fontFamily.toLowerCase() == defaultFont.toLowerCase()) {\r\n      return true;\r\n    }\r\n    return defaultImageData !== getImageData(fontFamily);\r\n  };\r\n  return {\r\n    isSupportFontFamily,\r\n  };\r\n}\r\n\r\nconst { isSupportFontFamily } = SupportFontFamilyFactory();\r\n\r\nexport { isSupportFontFamily };\r\n", "import { reactLog } from '@/util';\r\n\r\nexport interface DOMOperation {\r\n  createElement: (\r\n    tagName: any,\r\n    options?: ElementCreationOptions,\r\n  ) => HTMLElement;\r\n  createElementNS: (\r\n    namespaceURI: string,\r\n    qualifiedName: string,\r\n    options?: ElementCreationOptions,\r\n  ) => Element;\r\n  createTextNode: (text: string) => Text;\r\n  insertBefore: (\r\n    parentNode: Node,\r\n    newNode: Node,\r\n    referenceNode: Node | null,\r\n  ) => void;\r\n  removeChild: (node: Node, child: Node) => void;\r\n  appendChild: (node: Node, child: Node) => void;\r\n  parentNode: (node: Node) => Node | null;\r\n  nextSibling: (node: Node) => Node | null;\r\n  setTextContent: (node: Node, text: string | null) => void;\r\n  isElement: (node: Node) => node is Element;\r\n}\r\n\r\nfunction createElement(\r\n  tagName: any,\r\n  options?: ElementCreationOptions,\r\n): HTMLElement {\r\n  reactLog('createElement');\r\n  return document.createElement(tagName, options);\r\n}\r\n\r\nfunction createElementNS(\r\n  namespaceURI: string,\r\n  qualifiedName: string,\r\n  options?: ElementCreationOptions,\r\n): Element {\r\n  reactLog('createElementNS');\r\n  return document.createElementNS(namespaceURI, qualifiedName, options);\r\n}\r\n\r\nfunction createTextNode(text: string): Text {\r\n  reactLog('createTextNode');\r\n  return document.createTextNode(text);\r\n}\r\n\r\nfunction insertBefore(\r\n  parentNode: Node,\r\n  newNode: Node,\r\n  referenceNode: Node | null,\r\n): void {\r\n  parentNode.insertBefore(newNode, referenceNode);\r\n}\r\n\r\nfunction removeChild(node: Node, child: Node): void {\r\n  node.removeChild(child);\r\n}\r\n\r\nfunction appendChild(node: Node, child: Node): void {\r\n  node.appendChild(child);\r\n}\r\n\r\nfunction parentNode(node: Node): Node | null {\r\n  return node.parentNode;\r\n}\r\n\r\nfunction nextSibling(node: Node): Node | null {\r\n  return node.nextSibling;\r\n}\r\n\r\nfunction setTextContent(node: Node, text: string | null): void {\r\n  node.textContent = text;\r\n}\r\n\r\nfunction isElement(node: Node): node is Element {\r\n  return node.nodeType === 1;\r\n}\r\n\r\nexport const htmlDomApi: DOMOperation = {\r\n  createElement,\r\n  createElementNS,\r\n  createTextNode,\r\n  insertBefore,\r\n  removeChild,\r\n  appendChild,\r\n  parentNode,\r\n  nextSibling,\r\n  setTextContent,\r\n  isElement,\r\n};\r\n", "import { VNode, VNodeData, Key, Listener } from './vNode';\r\nimport { CSSProperties } from './modules/style';\r\nimport { Hooks } from './hooks';\r\n\r\nconst SVG_NS = 'http://www.w3.org/2000/svg';\r\n\r\ntype EventListener = {\r\n  [N in keyof HTMLElementEventMap as N extends string\r\n    ? `on${N}`\r\n    : never]?: Listener<HTMLElementEventMap[N]>;\r\n};\r\n\r\ninterface VNodePropsData extends EventListener {\r\n  className?: string;\r\n  style?: CSSProperties;\r\n  key?: Key;\r\n  id?: string;\r\n  value?: string | number;\r\n  href?: string;\r\n  fill?: string;\r\n  ns?: string; // for SVGs\r\n  is?: string; // for custom elements v1\r\n  viewBox?: string;\r\n  name?: string;\r\n  'aria-hidden'?: boolean;\r\n  'aria-label'?: string;\r\n  target?: string;\r\n  rel?: string;\r\n  d?: string;\r\n  'fill-opacity'?: string;\r\n  hook?: Hooks;\r\n  'data-testId'?: string;\r\n  disabled?: boolean;\r\n  title?: string;\r\n}\r\n\r\nfunction addNs(node: VNode) {\r\n  node.data!.ns = SVG_NS;\r\n  if (node.data?.props) {\r\n    node.data!.attrs = Object.assign(\r\n      node.data!.props || {},\r\n      node.data?.attrs || {},\r\n    );\r\n    node.data!.props = undefined;\r\n  } else {\r\n    node.data!.attrs = {};\r\n  }\r\n  node.data!.attrs.class = node.data!.className || '';\r\n  node.data!.className = undefined;\r\n  if (node.children) {\r\n    for (const item of node.children) {\r\n      if (item) {\r\n        addNs(item);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function h(\r\n  sel: string,\r\n  data: VNodePropsData,\r\n  ...children: Array<VNode | string | null | undefined | number>\r\n): VNode {\r\n  const key = data.key === undefined ? undefined : data.key;\r\n  const nodeData: VNodeData = {\r\n    hook: data.hook,\r\n    style: data.style,\r\n    key: data.key,\r\n    className: data.className,\r\n  };\r\n\r\n  const nodeList: VNode[] = [];\r\n  const textList: string[] = [];\r\n  const list = children || [];\r\n  for (const item of list) {\r\n    if (typeof item === 'string' || typeof item === 'number') {\r\n      const t = String(item);\r\n      if (t) {\r\n        textList.push(t);\r\n      }\r\n    } else if (item && typeof item === 'object') {\r\n      nodeList.push(item);\r\n    }\r\n  }\r\n  const keyList = Object.keys(data) as Array<keyof VNodePropsData>;\r\n  for (const key of keyList) {\r\n    if (['className', 'style', 'key', 'ns', 'is'].includes(key)) {\r\n      continue;\r\n    }\r\n    const item: any = data[key];\r\n    if (key === 'data-testId') {\r\n      if (!nodeData.dataset) {\r\n        nodeData.dataset = {};\r\n      }\r\n      nodeData.dataset[key.slice(5)] = item;\r\n    } else if (key.startsWith('on')) {\r\n      if (!nodeData.on) {\r\n        nodeData.on = {};\r\n      }\r\n\r\n      nodeData.on[key.slice(2)] = item;\r\n    } else {\r\n      if (!nodeData.props) {\r\n        nodeData.props = {};\r\n      }\r\n      nodeData.props[key] = item;\r\n    }\r\n  }\r\n  const result: VNode = {\r\n    sel: sel,\r\n    data: nodeData,\r\n    key,\r\n    elm: undefined,\r\n    children: [],\r\n    text: undefined,\r\n  };\r\n\r\n  if (textList.length > 0 && nodeList.length > 0) {\r\n    throw new Error('error node');\r\n  }\r\n  if (textList.length > 0) {\r\n    result.text = textList.join(' ');\r\n  }\r\n  if (nodeList.length > 0) {\r\n    result.children = nodeList;\r\n  }\r\n  if (result.sel === 'svg') {\r\n    addNs(result);\r\n  }\r\n\r\n  return result;\r\n}\r\n", "import { Module } from './modules/module';\r\nimport { VNode } from './vNode';\r\nimport { htmlDomApi, DOMOperation } from './dom';\r\nimport { h } from './h';\r\n\r\ntype NonUndefined<T> = T extends undefined ? never : T;\r\n\r\nfunction isUndef(s: any): boolean {\r\n  return s === undefined;\r\n}\r\nfunction isDef<A>(s: A): s is NonUndefined<A> {\r\n  return s !== undefined;\r\n}\r\n\r\ntype VNodeQueue = VNode[];\r\n\r\nconst emptyNode = h('', {});\r\n\r\nfunction sameVNode(vNode1: VNode, vNode2: VNode): boolean {\r\n  const isSameKey = vNode1.key === vNode2.key;\r\n  const isSameIs = vNode1.data?.is === vNode2.data?.is;\r\n  const isSameSel = vNode1.sel === vNode2.sel;\r\n  const isSameTextOrFragment =\r\n    !vNode1.sel && vNode1.sel === vNode2.sel\r\n      ? typeof vNode1.text === typeof vNode2.text\r\n      : true;\r\n\r\n  return isSameSel && isSameKey && isSameIs && isSameTextOrFragment;\r\n}\r\n\r\nfunction isElement(\r\n  api: DOMOperation,\r\n  vNode: Element | VNode,\r\n): vNode is Element {\r\n  return api.isElement(vNode as any);\r\n}\r\n\r\ntype KeyToIndexMap = { [key: string]: number };\r\n\r\ntype ArraysOf<T> = {\r\n  [K in keyof T]: Array<T[K]>;\r\n};\r\n\r\ntype ModuleHooks = ArraysOf<Required<Module>>;\r\n\r\nfunction createKeyToOldIdx(\r\n  children: VNode[],\r\n  beginIdx: number,\r\n  endIdx: number,\r\n): KeyToIndexMap {\r\n  const map: KeyToIndexMap = {};\r\n  for (let i = beginIdx; i <= endIdx; ++i) {\r\n    const key = children[i]?.key;\r\n    if (key !== undefined) {\r\n      map[key as string] = i;\r\n    }\r\n  }\r\n  return map;\r\n}\r\n\r\nconst hooks: Array<keyof Module> = [\r\n  'create',\r\n  'update',\r\n  'remove',\r\n  'destroy',\r\n  'pre',\r\n  'post',\r\n];\r\n\r\n// TODO Should `domApi` be put into this in the next major version bump?\r\nexport type Options = {\r\n  experimental?: {\r\n    fragments?: boolean;\r\n  };\r\n};\r\n\r\nexport function init(modules: Array<Partial<Module>>, domApi?: DOMOperation) {\r\n  const cbs: ModuleHooks = {\r\n    create: [],\r\n    update: [],\r\n    remove: [],\r\n    destroy: [],\r\n    pre: [],\r\n    post: [],\r\n  };\r\n\r\n  const api: DOMOperation = domApi !== undefined ? domApi : htmlDomApi;\r\n\r\n  for (const hook of hooks) {\r\n    for (const module of modules) {\r\n      const currentHook = module[hook];\r\n      if (currentHook !== undefined) {\r\n        (cbs[hook] as any[]).push(currentHook);\r\n      }\r\n    }\r\n  }\r\n\r\n  function createRmCb(childElm: Node, listeners: number) {\r\n    return function rmCb() {\r\n      if (--listeners === 0) {\r\n        const parent = api.parentNode(childElm) as Node;\r\n        api.removeChild(parent, childElm);\r\n      }\r\n    };\r\n  }\r\n\r\n  function createElm(vNode: VNode, insertedVNodeQueue: VNodeQueue): Node {\r\n    let i: any;\r\n    let data = vNode.data;\r\n    if (data !== undefined) {\r\n      const init = data.hook?.init;\r\n      if (init) {\r\n        init(vNode);\r\n        data = vNode.data;\r\n      }\r\n    }\r\n    const children = vNode.children;\r\n    const sel = vNode.sel;\r\n    if (sel !== undefined) {\r\n      const elm = (vNode.elm =\r\n        isDef(data) && isDef((i = data.ns))\r\n          ? api.createElementNS(i, sel, data)\r\n          : api.createElement(sel, data));\r\n      for (i = 0; i < cbs.create.length; ++i) cbs.create[i](emptyNode, vNode);\r\n      if (Array.isArray(children) && children.length > 0) {\r\n        for (i = 0; i < children.length; ++i) {\r\n          const ch = children[i];\r\n          if (ch != null) {\r\n            api.appendChild(elm, createElm(ch as VNode, insertedVNodeQueue));\r\n          }\r\n        }\r\n      } else if (\r\n        typeof vNode.text === 'string' ||\r\n        typeof vNode.text === 'number'\r\n      ) {\r\n        api.appendChild(elm, api.createTextNode(vNode.text));\r\n      }\r\n      const hook = vNode.data!.hook;\r\n      if (isDef(hook)) {\r\n        hook.create?.(emptyNode, vNode);\r\n        if (hook.insert) {\r\n          insertedVNodeQueue.push(vNode);\r\n        }\r\n      }\r\n    } else {\r\n      vNode.elm = api.createTextNode(vNode.text!);\r\n    }\r\n    return vNode.elm;\r\n  }\r\n\r\n  function addVNodes(\r\n    parentElm: Node,\r\n    before: Node | null,\r\n    vNodes: VNode[],\r\n    startIdx: number,\r\n    endIdx: number,\r\n    insertedVNodeQueue: VNodeQueue,\r\n  ) {\r\n    for (; startIdx <= endIdx; ++startIdx) {\r\n      const ch = vNodes[startIdx];\r\n      if (ch != null) {\r\n        api.insertBefore(parentElm, createElm(ch, insertedVNodeQueue), before);\r\n      }\r\n    }\r\n  }\r\n\r\n  function invokeDestroyHook(vNode: VNode) {\r\n    const data = vNode.data;\r\n    if (data !== undefined) {\r\n      data?.hook?.destroy?.(vNode);\r\n      for (let i = 0; i < cbs.destroy.length; ++i) cbs.destroy[i](vNode);\r\n      if (vNode.children !== undefined) {\r\n        for (let j = 0; j < vNode.children.length; ++j) {\r\n          const child = vNode.children[j];\r\n          if (child != null && typeof child !== 'string') {\r\n            invokeDestroyHook(child);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function removeVNodes(\r\n    parentElm: Node,\r\n    vNodes: VNode[],\r\n    startIdx: number,\r\n    endIdx: number,\r\n  ): void {\r\n    for (; startIdx <= endIdx; ++startIdx) {\r\n      let listeners: number;\r\n      let rm: () => void;\r\n      const ch = vNodes[startIdx];\r\n      if (ch != null) {\r\n        if (isDef(ch.sel)) {\r\n          invokeDestroyHook(ch);\r\n          listeners = cbs.remove.length + 1;\r\n          rm = createRmCb(ch.elm!, listeners);\r\n          for (let i = 0; i < cbs.remove.length; ++i) cbs.remove[i](ch, rm);\r\n          const removeHook = ch?.data?.hook?.remove;\r\n          if (isDef(removeHook)) {\r\n            removeHook(ch, rm);\r\n          } else {\r\n            rm();\r\n          }\r\n        } else if (ch.children) {\r\n          // Fragment node\r\n          invokeDestroyHook(ch);\r\n          removeVNodes(\r\n            parentElm,\r\n            ch.children as VNode[],\r\n            0,\r\n            ch.children.length - 1,\r\n          );\r\n        } else {\r\n          // Text node\r\n          api.removeChild(parentElm, ch.elm!);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function updateChildren(\r\n    parentElm: Node,\r\n    oldCh: VNode[],\r\n    newCh: VNode[],\r\n    insertedVNodeQueue: VNodeQueue,\r\n  ) {\r\n    let oldStartIdx = 0;\r\n    let newStartIdx = 0;\r\n    let oldEndIdx = oldCh.length - 1;\r\n    let oldStartVNode = oldCh[0];\r\n    let oldEndVNode = oldCh[oldEndIdx];\r\n    let newEndIdx = newCh.length - 1;\r\n    let newStartVNode = newCh[0];\r\n    let newEndVNode = newCh[newEndIdx];\r\n    let oldKeyToIdx: KeyToIndexMap | undefined;\r\n    let idxInOld: number;\r\n    let elmToMove: VNode;\r\n    let before: any;\r\n\r\n    while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {\r\n      if (oldStartVNode == null) {\r\n        oldStartVNode = oldCh[++oldStartIdx]; // VNode might have been moved left\r\n      } else if (oldEndVNode == null) {\r\n        oldEndVNode = oldCh[--oldEndIdx];\r\n      } else if (newStartVNode == null) {\r\n        newStartVNode = newCh[++newStartIdx];\r\n      } else if (newEndVNode == null) {\r\n        newEndVNode = newCh[--newEndIdx];\r\n      } else if (sameVNode(oldStartVNode, newStartVNode)) {\r\n        patchVNode(oldStartVNode, newStartVNode, insertedVNodeQueue);\r\n        oldStartVNode = oldCh[++oldStartIdx];\r\n        newStartVNode = newCh[++newStartIdx];\r\n      } else if (sameVNode(oldEndVNode, newEndVNode)) {\r\n        patchVNode(oldEndVNode, newEndVNode, insertedVNodeQueue);\r\n        oldEndVNode = oldCh[--oldEndIdx];\r\n        newEndVNode = newCh[--newEndIdx];\r\n      } else if (sameVNode(oldStartVNode, newEndVNode)) {\r\n        // vNode moved right\r\n        patchVNode(oldStartVNode, newEndVNode, insertedVNodeQueue);\r\n        api.insertBefore(\r\n          parentElm,\r\n          oldStartVNode.elm!,\r\n          api.nextSibling(oldEndVNode.elm!),\r\n        );\r\n        oldStartVNode = oldCh[++oldStartIdx];\r\n        newEndVNode = newCh[--newEndIdx];\r\n      } else if (sameVNode(oldEndVNode, newStartVNode)) {\r\n        // vNode moved left\r\n        patchVNode(oldEndVNode, newStartVNode, insertedVNodeQueue);\r\n        api.insertBefore(parentElm, oldEndVNode.elm!, oldStartVNode.elm!);\r\n        oldEndVNode = oldCh[--oldEndIdx];\r\n        newStartVNode = newCh[++newStartIdx];\r\n      } else {\r\n        if (oldKeyToIdx === undefined) {\r\n          oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx);\r\n        }\r\n        idxInOld = oldKeyToIdx[newStartVNode.key as string];\r\n        if (isUndef(idxInOld)) {\r\n          // New element\r\n          api.insertBefore(\r\n            parentElm,\r\n            createElm(newStartVNode, insertedVNodeQueue),\r\n            oldStartVNode.elm!,\r\n          );\r\n        } else {\r\n          elmToMove = oldCh[idxInOld];\r\n          if (elmToMove.sel !== newStartVNode.sel) {\r\n            api.insertBefore(\r\n              parentElm,\r\n              createElm(newStartVNode, insertedVNodeQueue),\r\n              oldStartVNode.elm!,\r\n            );\r\n          } else {\r\n            patchVNode(elmToMove, newStartVNode, insertedVNodeQueue);\r\n            oldCh[idxInOld] = undefined as any;\r\n            api.insertBefore(parentElm, elmToMove.elm!, oldStartVNode.elm!);\r\n          }\r\n        }\r\n        newStartVNode = newCh[++newStartIdx];\r\n      }\r\n    }\r\n\r\n    if (newStartIdx <= newEndIdx) {\r\n      before = newCh[newEndIdx + 1] == null ? null : newCh[newEndIdx + 1].elm;\r\n      addVNodes(\r\n        parentElm,\r\n        before,\r\n        newCh,\r\n        newStartIdx,\r\n        newEndIdx,\r\n        insertedVNodeQueue,\r\n      );\r\n    }\r\n    if (oldStartIdx <= oldEndIdx) {\r\n      removeVNodes(parentElm, oldCh, oldStartIdx, oldEndIdx);\r\n    }\r\n  }\r\n\r\n  function patchVNode(\r\n    oldVNode: VNode,\r\n    vNode: VNode,\r\n    insertedVNodeQueue: VNodeQueue,\r\n  ) {\r\n    const hook = vNode.data?.hook;\r\n    hook?.prePatch?.(oldVNode, vNode);\r\n    const elm = (vNode.elm = oldVNode.elm)!;\r\n    if (oldVNode === vNode) return;\r\n    if (\r\n      vNode.data !== undefined ||\r\n      (isDef(vNode.text) && vNode.text !== oldVNode.text)\r\n    ) {\r\n      vNode.data ??= {};\r\n      oldVNode.data ??= {};\r\n      for (let i = 0; i < cbs.update.length; ++i)\r\n        cbs.update[i](oldVNode, vNode);\r\n      vNode.data?.hook?.update?.(oldVNode, vNode);\r\n    }\r\n    const oldCh = oldVNode.children as VNode[];\r\n    const ch = vNode.children as VNode[];\r\n    if (isUndef(vNode.text)) {\r\n      if (isDef(oldCh) && isDef(ch)) {\r\n        if (oldCh !== ch) updateChildren(elm, oldCh, ch, insertedVNodeQueue);\r\n      } else if (isDef(ch)) {\r\n        if (isDef(oldVNode.text)) api.setTextContent(elm, '');\r\n        addVNodes(elm, null, ch, 0, ch.length - 1, insertedVNodeQueue);\r\n      } else if (isDef(oldCh)) {\r\n        removeVNodes(elm, oldCh, 0, oldCh.length - 1);\r\n      } else if (isDef(oldVNode.text)) {\r\n        api.setTextContent(elm, '');\r\n      }\r\n    } else if (oldVNode.text !== vNode.text) {\r\n      if (isDef(oldCh)) {\r\n        removeVNodes(elm, oldCh, 0, oldCh.length - 1);\r\n      }\r\n      api.setTextContent(elm, vNode.text!);\r\n    }\r\n    hook?.postPatch?.(oldVNode, vNode);\r\n    if (hook?.ref) {\r\n      hook?.ref(vNode.elm! as Element);\r\n    }\r\n  }\r\n\r\n  function patch(oldVNode: VNode | Element, vNode: VNode): VNode {\r\n    let i: number, elm: Node, parent: Node;\r\n    const insertedVNodeQueue: VNodeQueue = [];\r\n    for (i = 0; i < cbs.pre.length; ++i) cbs.pre[i]();\r\n\r\n    if (isElement(api, oldVNode)) {\r\n      createElm(vNode, insertedVNodeQueue);\r\n      api.appendChild(oldVNode, vNode.elm!);\r\n      return vNode;\r\n    }\r\n\r\n    if (sameVNode(oldVNode, vNode)) {\r\n      patchVNode(oldVNode, vNode, insertedVNodeQueue);\r\n    } else {\r\n      elm = oldVNode.elm!;\r\n      parent = api.parentNode(elm) as Node;\r\n\r\n      createElm(vNode, insertedVNodeQueue);\r\n\r\n      if (parent !== null) {\r\n        api.insertBefore(parent, vNode.elm!, api.nextSibling(elm));\r\n        removeVNodes(parent, [oldVNode], 0, 0);\r\n      }\r\n    }\r\n\r\n    for (i = 0; i < insertedVNodeQueue.length; ++i) {\r\n      insertedVNodeQueue[i].data!.hook!.insert!(insertedVNodeQueue[i]);\r\n    }\r\n    for (i = 0; i < cbs.post.length; ++i) cbs.post[i]();\r\n    return vNode;\r\n  }\r\n  return patch;\r\n}\r\n", "import { VNode, VNodeData } from \"../vNode\";\r\nimport { Module } from \"./module\";\r\n\r\nexport type Attrs = Record<string, string | number | boolean>;\r\n\r\nconst xLinkNS = \"http://www.w3.org/1999/xlink\";\r\nconst xmlNS = \"http://www.w3.org/XML/1998/namespace\";\r\nconst colonChar = 58;\r\nconst xChar = 120;\r\n\r\nfunction updateAttrs(oldVNode: VNode, vNode: VNode): void {\r\n  let key: string;\r\n  const elm: Element = vNode.elm as Element;\r\n  let oldAttrs = (oldVNode.data as VNodeData).attrs;\r\n  let attrs = (vNode.data as VNodeData).attrs;\r\n\r\n  if (!oldAttrs && !attrs) return;\r\n  if (oldAttrs === attrs) return;\r\n  oldAttrs = oldAttrs || {};\r\n  attrs = attrs || {};\r\n\r\n  // update modified attributes, add new attributes\r\n  for (key in attrs) {\r\n    const cur = attrs[key];\r\n    const old = oldAttrs[key];\r\n    if (old !== cur) {\r\n      if (cur === true) {\r\n        elm.setAttribute(key, \"\");\r\n      } else if (cur === false) {\r\n        elm.removeAttribute(key);\r\n      } else {\r\n        if (key.charCodeAt(0) !== xChar) {\r\n          elm.setAttribute(key, cur as any);\r\n        } else if (key.charCodeAt(3) === colonChar) {\r\n          // Assume xml namespace\r\n          elm.setAttributeNS(xmlNS, key, cur as any);\r\n        } else if (key.charCodeAt(5) === colonChar) {\r\n          // Assume xLink namespace\r\n          elm.setAttributeNS(xLinkNS, key, cur as any);\r\n        } else {\r\n          elm.setAttribute(key, cur as any);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  // remove removed attributes\r\n  // use `in` operator since the previous `for` iteration uses it (.i.e. add even attributes with undefined value)\r\n  // the other option is to remove all attributes with value == undefined\r\n  for (key in oldAttrs) {\r\n    if (!(key in attrs)) {\r\n      elm.removeAttribute(key);\r\n    }\r\n  }\r\n}\r\n\r\nexport const attributesModule: Module = {\r\n  create: updateAttrs,\r\n  update: updateAttrs,\r\n};\r\n", "import { VNode, VNodeData } from '../vNode';\r\nimport { Module } from './module';\r\n\r\nfunction updateClass(oldVNode: VNode, vNode: VNode): void {\r\n  const elm: Element = vNode.elm as Element;\r\n  const oldClass = (oldVNode.data as VNodeData).className;\r\n  const newClass = (vNode.data as VNodeData).className;\r\n\r\n  if (oldClass === newClass) return;\r\n  elm.className = newClass || '';\r\n}\r\n\r\nexport const classModule: Module = { create: updateClass, update: updateClass };\r\n", "import { VNode, VNodeData } from '../vNode';\r\nimport { Module } from './module';\r\n\r\nexport type Dataset = Record<string, string>;\r\n\r\nexport const CAPS_REGEX = /[A-Z]/g;\r\n\r\nfunction updateDataset(oldVNode: VNode, vNode: VNode): void {\r\n  const elm: HTMLElement = vNode.elm as HTMLElement;\r\n  let oldDataset = (oldVNode.data as VNodeData).dataset;\r\n  let dataset = (vNode.data as VNodeData).dataset;\r\n  let key: string;\r\n\r\n  if (!oldDataset && !dataset) return;\r\n  if (oldDataset === dataset) return;\r\n  oldDataset = oldDataset || {};\r\n  dataset = dataset || {};\r\n  const d = elm.dataset;\r\n\r\n  for (key in oldDataset) {\r\n    if (!dataset[key]) {\r\n      if (d) {\r\n        if (key in d) {\r\n          delete d[key];\r\n        }\r\n      } else {\r\n        elm.removeAttribute(\r\n          'data-' + key.replace(CAPS_REGEX, '-$&').toLowerCase(),\r\n        );\r\n      }\r\n    }\r\n  }\r\n  for (key in dataset) {\r\n    if (oldDataset[key] !== dataset[key]) {\r\n      if (d) {\r\n        d[key] = dataset[key];\r\n      } else {\r\n        elm.setAttribute(\r\n          'data-' + key.replace(CAPS_REGEX, '-$&').toLowerCase(),\r\n          dataset[key],\r\n        );\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport const datasetModule: Module = {\r\n  create: updateDataset,\r\n  update: updateDataset,\r\n};\r\n", "import { VNode, Listener } from '../vNode';\r\nimport { Module } from './module';\r\n\r\nexport type On = {\r\n  [N in keyof HTMLElementEventMap]?: Listener<HTMLElementEventMap[N]>;\r\n} & {\r\n  [event: string]: Listener<any>;\r\n};\r\n\r\ntype SomeListener<N extends keyof HTMLElementEventMap> =\r\n  | Listener<HTMLElementEventMap[N]>\r\n  | Listener<any>;\r\n\r\nfunction invokeHandler<N extends keyof HTMLElementEventMap>(\r\n  handler: SomeListener<N> | Array<SomeListener<N>>,\r\n  vNode: VNode,\r\n  event?: Event,\r\n): void {\r\n  if (typeof handler === 'function') {\r\n    const temp: any = event || {};\r\n    // call function handler\r\n    handler.call(vNode, temp, vNode);\r\n  } else if (typeof handler === 'object') {\r\n    // call multiple handlers\r\n    for (let i = 0; i < handler.length; i++) {\r\n      invokeHandler(handler[i], vNode, event);\r\n    }\r\n  }\r\n}\r\n\r\nfunction handleEvent(event: Event, vNode: VNode) {\r\n  const name = event.type;\r\n  const on: any = vNode.data?.on;\r\n\r\n  // call event handler(s) if exists\r\n  if (on && on[name]) {\r\n    invokeHandler(on[name], vNode, event);\r\n  }\r\n}\r\n\r\nfunction createListener() {\r\n  return function handler(event: Event) {\r\n    handleEvent(event, (handler as any).vNode);\r\n  };\r\n}\r\n\r\nfunction updateEventListeners(oldVNode: VNode, vNode?: VNode): void {\r\n  const oldOn: any = oldVNode.data?.on;\r\n  const oldListener = (oldVNode as any).listener;\r\n  const oldElm: Element = oldVNode.elm as Element;\r\n  const on: any = vNode?.data?.on;\r\n  const elm: Element = (vNode && vNode.elm) as Element;\r\n  let name: string;\r\n\r\n  // optimization for reused immutable handlers\r\n  if (oldOn === on) {\r\n    return;\r\n  }\r\n\r\n  // remove existing listeners which no longer used\r\n  if (oldOn && oldListener) {\r\n    // if element changed or deleted we remove all existing listeners unconditionally\r\n    if (!on) {\r\n      for (name in oldOn) {\r\n        // remove listener if element was changed or existing listeners removed\r\n        oldElm.removeEventListener(name, oldListener, false);\r\n      }\r\n    } else {\r\n      for (name in oldOn) {\r\n        // remove listener if existing listener removed\r\n        if (!on[name]) {\r\n          oldElm.removeEventListener(name, oldListener, false);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // add new listeners which has not already attached\r\n  if (on) {\r\n    // reuse existing listener or create new\r\n    const listener = ((vNode as any).listener =\r\n      (oldVNode as any).listener || createListener());\r\n    // update vNode for listener\r\n    listener.vNode = vNode;\r\n\r\n    // if element changed or added we add all needed listeners unconditionally\r\n    if (!oldOn) {\r\n      for (name in on) {\r\n        // add listener if element was changed or new listeners added\r\n        elm.addEventListener(name, listener, false);\r\n      }\r\n    } else {\r\n      for (name in on) {\r\n        // add listener if new listener added\r\n        if (!oldOn[name]) {\r\n          elm.addEventListener(name, listener, false);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport const eventListenersModule: Module = {\r\n  create: updateEventListeners,\r\n  update: updateEventListeners,\r\n  destroy: updateEventListeners,\r\n};\r\n", "import { VNode, VNodeData } from '../vNode';\r\nimport { Module } from './module';\r\n\r\nexport type Props = Record<string, any>;\r\n\r\nfunction updateProps(oldVNode: VNode, vNode: VNode): void {\r\n  let key: string;\r\n  let cur: any;\r\n  let old: any;\r\n  const elm: any = vNode.elm;\r\n  let oldProps = (oldVNode.data as VNodeData).props;\r\n  let props = (vNode.data as VNodeData).props;\r\n\r\n  if (!oldProps && !props) return;\r\n  if (oldProps === props) return;\r\n  oldProps = oldProps || {};\r\n  props = props || {};\r\n\r\n  for (key in props) {\r\n    cur = props[key];\r\n    old = oldProps[key];\r\n    if (old !== cur && (key !== 'value' || elm[key] !== cur)) {\r\n      elm[key] = cur;\r\n    }\r\n  }\r\n}\r\n\r\nexport const propsModule: Module = { create: updateProps, update: updateProps };\r\n", "import { VNode, VNodeData } from '../vNode';\r\nimport { Module } from './module';\r\nimport { CAPS_REGEX } from './dataset';\r\n\r\nexport type CSSProperties = {\r\n  [K in keyof CSSStyleDeclaration]?: CSSStyleDeclaration[K] | number;\r\n} & {\r\n  [event: string]: string | number;\r\n};\r\n\r\nconst convertKey = (key: string) =>\r\n  key.replace(CAPS_REGEX, '-$&').toLowerCase();\r\n\r\nfunction updateStyle(oldVNode: VNode, vNode: VNode): void {\r\n  let name: string;\r\n  const elm: any = vNode.elm;\r\n  let oldStyle = (oldVNode.data as VNodeData).style;\r\n  let style = (vNode.data as VNodeData).style;\r\n\r\n  if (!oldStyle && !style) return;\r\n  if (oldStyle === style) return;\r\n  oldStyle = oldStyle || {};\r\n  style = style || {};\r\n\r\n  for (name in oldStyle) {\r\n    if (!style[name]) {\r\n      if (name.slice(0, 2) === '--') {\r\n        elm.style.removeProperty(name);\r\n      } else {\r\n        elm.style[convertKey(name)] = '';\r\n      }\r\n    }\r\n  }\r\n  for (name in style) {\r\n    if (style[name] !== oldStyle[name]) {\r\n      if (name.slice(0, 2) === '--') {\r\n        elm.style.setProperty(name, style[name]);\r\n      } else {\r\n        const key = convertKey(name);\r\n        const t = style[name];\r\n        if (typeof t === 'number') {\r\n          elm.style[key] = t + 'px';\r\n        } else {\r\n          elm.style[key] = t;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport const styleModule: Module = {\r\n  create: updateStyle,\r\n  update: updateStyle,\r\n};\r\n", "import type { StoreValue, IController } from '@/types';\r\nimport { VNode } from './vNode';\r\nimport { init } from './init';\r\nimport { attributesModule } from './modules/attributes';\r\nimport { classModule } from './modules/class';\r\nimport { datasetModule } from './modules/dataset';\r\nimport { eventListenersModule } from './modules/event';\r\nimport { propsModule } from './modules/props';\r\nimport { styleModule } from './modules/style';\r\nimport { htmlDomApi } from './dom';\r\n\r\ninterface DomType extends Element {\r\n  vDom?: VNode;\r\n}\r\n\r\nconst patch = init(\r\n  [\r\n    attributesModule,\r\n    classModule,\r\n    datasetModule,\r\n    eventListenersModule,\r\n    propsModule,\r\n    styleModule,\r\n  ],\r\n  htmlDomApi,\r\n);\r\nexport function render(container: Element, vNode: VNode): VNode {\r\n  const dom = container as DomType;\r\n  let temp: VNode;\r\n  if (dom.vDom) {\r\n    temp = patch(dom.vDom as VNode, vNode);\r\n  } else {\r\n    temp = patch(dom, vNode);\r\n  }\r\n  dom.vDom = temp;\r\n  return temp;\r\n}\r\n\r\nexport type { VNode, FunctionComponent } from './vNode';\r\nexport { h } from './h';\r\nexport type { CSSProperties } from './modules/style';\r\n\r\nexport interface SmartComponent {\r\n  (props: StoreValue, controller: IController): VNode;\r\n  displayName: string;\r\n}\r\n", "import { h, SmartComponent } from '@/react';\r\nimport { MAIN_CANVAS_ID, SCROLL_SIZE } from '@/util';\r\n\r\nexport const CanvasContainer: SmartComponent = (state, controller) => {\r\n  const headerSize = controller.getHeaderSize();\r\n  return h(\r\n    'div',\r\n    {\r\n      className: 'relative canvas-container',\r\n    },\r\n    h('canvas', {\r\n      className: 'full canvas-content',\r\n      id: MAIN_CANVAS_ID,\r\n    }),\r\n    h(\r\n      'div',\r\n      {\r\n        className: 'vertical-scroll-bar',\r\n        style: {\r\n          top: headerSize.height,\r\n        },\r\n      },\r\n      h('div', {\r\n        className: 'vertical-scroll-bar-content',\r\n        style: {\r\n          height: SCROLL_SIZE,\r\n          transform: `translateY(${state.scrollTop}px)`,\r\n        },\r\n      }),\r\n    ),\r\n    h(\r\n      'div',\r\n      {\r\n        className: 'horizontal-scroll-bar',\r\n        style: {\r\n          left: headerSize.width,\r\n        },\r\n      },\r\n      h('div', {\r\n        className: 'horizontal-scroll-bar-content',\r\n        style: {\r\n          width: SCROLL_SIZE,\r\n          transform: `translateX(${state.scrollLeft}px)`,\r\n        },\r\n      }),\r\n    ),\r\n  );\r\n};\r\nCanvasContainer.displayName = 'CanvasContainer';\r\n", "import { h, SmartComponent, CSSProperties } from '@/react';\r\nimport { QueryCellResult, CanvasOverlayPosition } from '@/types';\r\nimport {\r\n  DEFAULT_FONT_COLOR,\r\n  makeFont,\r\n  DEFAULT_FONT_SIZE,\r\n  FORMULA_EDITOR_ID,\r\n} from '@/util';\r\nimport { isEmpty } from '@/lodash';\r\n\r\nexport function getEditorStyle(\r\n  style: QueryCellResult['style'],\r\n  cellPosition: CanvasOverlayPosition,\r\n): CSSProperties | undefined {\r\n  if (isEmpty(style)) {\r\n    return cellPosition;\r\n  }\r\n  const font = makeFont(\r\n    style?.isItalic ? 'italic' : 'normal',\r\n    style?.isBold ? 'bold' : '500',\r\n    style?.fontSize || DEFAULT_FONT_SIZE,\r\n    style?.fontFamily,\r\n  );\r\n  return {\r\n    ...cellPosition,\r\n    backgroundColor: style?.fillColor || 'inherit',\r\n    color: style?.fontColor || DEFAULT_FONT_COLOR,\r\n    font,\r\n  };\r\n}\r\n\r\nexport const FormulaEditor: SmartComponent = (state, controller) => {\r\n  const { activeCell, isCellEditing, cellPosition } = state;\r\n  const initValue = activeCell.formula || String(activeCell.value || '');\r\n  let inputDom: HTMLInputElement;\r\n  const ref = (element: Element) => {\r\n    inputDom = element as HTMLInputElement;\r\n  };\r\n\r\n  const setValue = (value: string) => {\r\n    controller.setCellValue(activeCell, value);\r\n    inputDom.value = '';\r\n    state.isCellEditing = false;\r\n  };\r\n  return h('input', {\r\n    title: 'editor',\r\n    className: 'base-editor',\r\n    id: FORMULA_EDITOR_ID,\r\n    value: initValue,\r\n    style: isCellEditing\r\n      ? getEditorStyle(activeCell.style, cellPosition)\r\n      : undefined,\r\n    hook: {\r\n      ref,\r\n    },\r\n    onfocus: () => {\r\n      if (!isCellEditing) {\r\n        return;\r\n      }\r\n      state.isCellEditing = true;\r\n    },\r\n    onblur: (event: any) => {\r\n      setValue(event.currentTarget.value);\r\n    },\r\n    onkeydown: (event: any) => {\r\n      inputDom.nextSibling!.textContent = event.currentTarget.value;\r\n      if (event.key === 'Enter' || event.key === 'Tab') {\r\n        setValue(event.currentTarget.value);\r\n      }\r\n    },\r\n  });\r\n};\r\n\r\nFormulaEditor.displayName = 'FormulaEditor';\r\n", "import { h, SmartComponent } from '@/react';\r\nimport { FormulaEditor } from './FormulaEditor';\r\nimport { intToColumnName, classnames } from '@/util';\r\n\r\nexport const FormulaBarContainer: SmartComponent = (\r\n  state,\r\n  controller,\r\n) => {\r\n  const { activeCell } = state;\r\n  return h(\r\n    'div',\r\n    {\r\n      className: 'formula-bar-wrapper',\r\n    },\r\n    h(\r\n      'div',\r\n      { className: 'formula-bar-name' },\r\n      `${intToColumnName(activeCell.col)}${activeCell.row + 1}`,\r\n    ),\r\n    h(\r\n      'div',\r\n      { className: 'formula-bar-editor-wrapper' },\r\n      FormulaEditor(state, controller),\r\n      h('div', {\r\n        className: classnames('formula-bar-value', {\r\n          show: state.isCellEditing,\r\n        })\r\n      }, activeCell.formula || String(activeCell.value || ''))\r\n    ),\r\n  );\r\n};\r\nFormulaBarContainer.displayName = 'FormulaBarContainer';\r\n", "import { h, FunctionComponent, CSSProperties } from '@/react';\r\nimport { classnames } from '@/util';\r\n\r\nexport interface ButtonProps {\r\n  type?: 'normal' | 'circle';\r\n  style?: CSSProperties;\r\n  active?: boolean;\r\n  disabled?: boolean;\r\n  onClick?: (event: MouseEvent) => void;\r\n  className?: string;\r\n  testId?: string;\r\n}\r\n\r\nconst defaultClick: (event: MouseEvent) => void = () => {\r\n  console.log('add click event');\r\n};\r\n\r\nexport const Button: FunctionComponent<ButtonProps> = (props, ...children) => {\r\n  const {\r\n    className = '',\r\n    onClick = defaultClick,\r\n    disabled = false,\r\n    active = false,\r\n    type = 'normal',\r\n    style = {},\r\n    testId = undefined,\r\n  } = props;\r\n  return h(\r\n    'div',\r\n    {\r\n      onclick: onClick,\r\n      className: classnames('button-wrapper', className, {\r\n        disabled,\r\n        active,\r\n        circle: type === 'circle',\r\n      }),\r\n      style,\r\n      'data-testId': testId,\r\n    },\r\n    ...children,\r\n  );\r\n};\r\nButton.displayName = 'Button';\r\n", "import { h, FunctionComponent } from '@/react';\r\n\r\nconst pathStyle = {\r\n  'transform-origin': '130px 106px',\r\n};\r\n\r\nexport const Github: FunctionComponent = () => {\r\n  return h(\r\n    'a',\r\n    {\r\n      href: 'https://github.com/nusr/excel',\r\n      'aria-label': 'View source on Github',\r\n      target: '_blank',\r\n      rel: 'noreferrer',\r\n      title: 'github link'\r\n    },\r\n    h(\r\n      'svg',\r\n      {\r\n        className: 'github-wrapper',\r\n        viewBox: '0 0 250 250',\r\n        'aria-hidden': true,\r\n      },\r\n      h('path', {\r\n        d: 'M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z',\r\n      }),\r\n      h('path', {\r\n        d: 'M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2',\r\n        fill: 'currentColor',\r\n        style: pathStyle,\r\n      }),\r\n      h('path', {\r\n        style: pathStyle,\r\n        fill: 'currentColor',\r\n        d: 'M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z',\r\n      }),\r\n    ),\r\n  );\r\n};\r\nGithub.displayName = 'Github';\r\n", "export type BaseIconName =\r\n  | 'alignCenter'\r\n  | 'alignLeft'\r\n  | 'alignRight'\r\n  | 'bold'\r\n  | 'fontColor'\r\n  | 'italic'\r\n  | 'middleAlign'\r\n  | 'plus'\r\n  | 'redo'\r\n  | 'underline'\r\n  | 'undo';\r\n\r\nconst icon: Record<BaseIconName, string[]> = {\r\n  alignCenter: [\r\n    'M142.2 227.6h739.6v56.9H142.2zM142.2 568.9h739.6v56.9H142.2zM256 398.2h512v56.9H256zM256 739.6h512v56.9H256z',\r\n  ],\r\n  alignLeft: [\r\n    'M627.712 788.48c11.305 0 20.48-9.155 20.48-20.48s-9.175-20.48-20.48-20.48H218.46c-11.305 0-20.48 9.155-20.48 20.48s9.175 20.48 20.48 20.48h409.252zM832.86 583.68h-614.4c-11.305 0-20.48 9.155-20.48 20.48s9.175 20.48 20.48 20.48h614.4c11.305 0 20.48-9.155 20.48-20.48s-9.175-20.48-20.48-20.48zM832.86 256h-614.4c-11.305 0-20.48 9.155-20.48 20.48s9.175 20.48 20.48 20.48h614.4c11.305 0 20.48-9.155 20.48-20.48S844.165 256 832.86 256zM218.46 460.8h409.252c11.305 0 20.48-9.155 20.48-20.48s-9.175-20.48-20.48-20.48H218.46c-11.305 0-20.48 9.155-20.48 20.48s9.155 20.48 20.48 20.48z',\r\n  ],\r\n  alignRight: [\r\n    'M832.86 747.52H423.588a20.48 20.48 0 1 0 0 40.96H832.84a20.48 20.48 0 0 0 0.02-40.96z m20.48-143.36a20.48 20.48 0 0 0-20.48-20.48h-614.4a20.48 20.48 0 1 0 0 40.96h614.4a20.48 20.48 0 0 0 20.48-20.48zM832.86 256h-614.4a20.48 20.48 0 1 0 0 40.96h614.4a20.48 20.48 0 1 0 0-40.96z m0 163.84H423.588a20.48 20.48 0 1 0 0 40.96H832.84a20.48 20.48 0 0 0 0.02-40.96z',\r\n  ],\r\n  bold: [\r\n    'M724.342857 477.028571c38.4-40 61.942857-94.057143 61.942857-153.485714v-11.657143C786.285714 188.914286 685.6 89.142857 561.485714 89.142857H223.314286c-17.257143 0-31.314286 14.057143-31.314286 31.314286v776.114286c0 18.628571 15.085714 33.714286 33.714286 33.714285h364.228571c133.714286 0 242.057143-107.657143 242.057143-240.571428v-12.571429c0-83.428571-42.742857-156.914286-107.657143-200.114286zM301.714286 198.857143h256.8c65.257143 0 118.057143 50.742857 118.057143 113.485714v10.857143c0 62.628571-52.914286 113.485714-118.057143 113.485714H301.714286V198.857143z m418.971428 490.742857c0 71.885714-59.085714 130.171429-132 130.171429H301.714286V547.085714h286.971428c72.914286 0 132 58.285714 132 130.171429v12.342857z',\r\n  ],\r\n  fontColor: [\r\n    'M650.496 597.333333H373.504l-68.266667 170.666667H213.333333l256-640h85.333334l256 640h-91.904l-68.266667-170.666667z m-34.133333-85.333333L512 251.093333 407.637333 512h208.725334zM128 853.333333h768v85.333334H128v-85.333334z',\r\n  ],\r\n  italic: [\r\n    'M219.428571 949.714286l9.714286-48.571429q3.428571-1.142857 46.571429-12.285714t63.714286-21.428571q16-20 23.428571-57.714286 0.571429-4 35.428571-165.142857t65.142857-310.571429 29.714286-169.428571l0-14.285714q-13.714286-7.428571-31.142857-10.571429t-39.714286-4.571429-33.142857-3.142857l10.857143-58.857143q18.857143 1.142857 68.571429 3.714286t85.428571 4 68.857143 1.428571q27.428571 0 56.285714-1.428571t69.142857-4 56.285714-3.714286q-2.857143 22.285714-10.857143 50.857143-17.142857 5.714286-58 16.285714t-62 19.142857q-4.571429 10.857143-8 24.285714t-5.142857 22.857143-4.285714 26-3.714286 24q-15.428571 84.571429-50 239.714286t-44.285714 203.142857q-1.142857 5.142857-7.428571 33.142857t-11.428571 51.428571-9.142857 47.714286-3.428571 32.857143l0.571429 10.285714q9.714286 2.285714 105.714286 17.714286-1.714286 25.142857-9.142857 56.571429-6.285714 0-18.571429 0.857143t-18.571429 0.857143q-16.571429 0-49.714286-5.714286t-49.142857-5.714286q-78.857143-1.142857-117.714286-1.142857-29.142857 0-81.714286 5.142857t-69.142857 6.285714z',\r\n  ],\r\n  middleAlign: [\r\n    'M740.43392 788.48c11.30496 0 20.48-9.15456 20.48-20.48s-9.17504-20.48-20.48-20.48L331.18208 747.52c-11.30496 0-20.48 9.15456-20.48 20.48s9.17504 20.48 20.48 20.48L740.43392 788.48zM863.49824 604.16c0-11.32544-9.17504-20.48-20.48-20.48l-614.4 0c-11.30496 0-20.48 9.15456-20.48 20.48s9.17504 20.48 20.48 20.48l614.4 0C854.3232 624.64 863.49824 615.48544 863.49824 604.16zM208.13824 276.48c0 11.32544 9.17504 20.48 20.48 20.48l614.4 0c11.30496 0 20.48-9.15456 20.48-20.48s-9.17504-20.48-20.48-20.48l-614.4 0C217.2928 256 208.13824 265.15456 208.13824 276.48zM740.43392 460.8c11.30496 0 20.48-9.15456 20.48-20.48s-9.17504-20.48-20.48-20.48L331.18208 419.84c-11.30496 0-20.48 9.15456-20.48 20.48s9.17504 20.48 20.48 20.48L740.43392 460.8z',\r\n  ],\r\n  plus: [\r\n    'M896 468.571429H555.428571V100.571429h-86.857142v368H128c-5.028571 0-9.142857 4.114286-9.142857 9.142857v68.571428c0 5.028571 4.114286 9.142857 9.142857 9.142857h340.571429v368h86.857142V555.428571h340.571429c5.028571 0 9.142857-4.114286 9.142857-9.142857v-68.571428c0-5.028571-4.114286-9.142857-9.142857-9.142857z',\r\n  ],\r\n  redo: [\r\n    'M611.783111 569.344L549.622519 644.740741h284.444444l-65.498074-265.481482-59.922963 72.666074c-35.422815-28.48237-108.278519-68.342519-238.667852-68.342518-202.827852 0-280.651852 206.01363-280.651852 206.013629s116.318815-132.778667 246.215111-132.778666c97.204148-0.037926 153.865481 74.827852 176.241778 112.526222z',\r\n  ],\r\n  underline: [\r\n    'M512 725.333333c166.4 0 298.666667-132.266667 298.666667-298.666666V128c0-25.6-17.066667-42.666667-42.666667-42.666667s-42.666667 17.066667-42.666667 42.666667v298.666667c0 119.466667-93.866667 213.333333-213.333333 213.333333s-213.333333-93.866667-213.333333-213.333333V128c0-25.6-17.066667-42.666667-42.666667-42.666667s-42.666667 17.066667-42.666667 42.666667v298.666667c0 166.4 132.266667 298.666667 298.666667 298.666666zM853.333333 853.333333H170.666667c-25.6 0-42.666667 17.066667-42.666667 42.666667s17.066667 42.666667 42.666667 42.666667h682.666666c25.6 0 42.666667-17.066667 42.666667-42.666667s-17.066667-42.666667-42.666667-42.666667z',\r\n  ],\r\n  undo: [\r\n    'M489.244444 568.888889l60.681482 75.851852H265.481481l64.474075-265.481482 60.681481 72.05926c34.133333-30.340741 109.985185-68.266667 238.933333-68.266667 201.007407 0 280.651852 204.8 280.651852 204.8S792.651852 455.111111 663.703704 455.111111c-98.607407 0-155.496296 75.851852-174.45926 113.777778z',\r\n  ],\r\n};\r\n\r\nexport default icon;\r\n", "import { h, FunctionComponent } from '@/react';\r\nimport { classnames } from '@/util';\r\n\r\ntype PathItem = {\r\n  d: string;\r\n  'fill-opacity'?: string;\r\n};\r\n\r\nexport interface BaseIconProps {\r\n  className?: string;\r\n  paths: PathItem[];\r\n}\r\n\r\nexport const BaseIcon: FunctionComponent<BaseIconProps> = ({\r\n  className = '',\r\n  paths = [],\r\n}) => {\r\n  return h(\r\n    'svg',\r\n    {\r\n      className: classnames('base-icon', className),\r\n      viewBox: '0 0 1137 1024',\r\n      'aria-hidden': true,\r\n    },\r\n    ...paths.map((item) => h('path', item)),\r\n  );\r\n};\r\nBaseIcon.displayName = 'BaseIcon';\r\n", "import type { FunctionComponent } from '@/react'\r\nimport { BaseIcon } from './BaseIcon';\r\n\r\nexport const FillColorIcon: FunctionComponent = () => {\r\n  return BaseIcon({\r\n    paths: [\r\n      {\r\n        d: 'M0 0h1024v1024H0z',\r\n        'fill-opacity': '.01',\r\n      },\r\n      {\r\n        d: 'M496.512 32a128 128 0 0 1 127.84 121.6l0.16 6.4-0.032 113.504 264.256 264.256a32 32 0 0 1-8.16 51.2l-144.064 72.96-269.12 269.12a64 64 0 0 1-90.496 0l-294.144-294.176a64 64 0 0 1 0-90.496l286.016-286.08-0.192-2.048-0.064-2.08V160a128 128 0 0 1 128-128z m-6.464 197.568L128 591.616l294.144 294.144 276.32-276.32 113.792-57.632-187.776-187.776V416a32 32 0 0 1-28.256 31.776l-3.712 0.224a32 32 0 0 1-31.808-28.256L560.512 416l-0.032-115.968-70.432-70.464z m402.016 395.936l1.792 2.24 5.472 8.416c30.112 46.752 45.184 80.032 45.184 99.84a64 64 0 1 1-128 0c0-20.96 16.864-57.024 50.624-108.224a16 16 0 0 1 24.928-2.24zM496.512 96a64 64 0 0 0-63.84 59.2l-0.16 4.8-0.032 36.576 34.944-34.88a32 32 0 0 1 45.248 0l47.808 47.808V160a64 64 0 0 0-59.2-63.84L496.48 96z',\r\n      },\r\n    ],\r\n  });\r\n};\r\nFillColorIcon.displayName = 'FillColorIcon';\r\n", "import type { FunctionComponent } from '@/react'\r\nimport iconConfig from './icon';\r\nimport type { BaseIconName } from './icon';\r\nimport { BaseIcon, BaseIconProps } from './BaseIcon';\r\n\r\nexport interface IconProps {\r\n  name: BaseIconName;\r\n  className?: string;\r\n}\r\n\r\nexport const Icon: FunctionComponent<IconProps> = ({ name, className = '' }) => {\r\n  const paths = iconConfig[name].map((item) => ({ d: item }));\r\n  return BaseIcon({ className, paths });\r\n};\r\nIcon.displayName = 'Icon';\r\n\r\nexport { BaseIcon, BaseIconProps };\r\n\r\nexport { FillColorIcon } from './FillColorIcon';\r\n", "import { h, CSSProperties, FunctionComponent } from '@/react';\r\nimport { classnames } from '@/util';\r\nimport { OptionItem } from '@/types';\r\n\r\nexport type SelectProps = {\r\n  value?: string | number;\r\n  style?: CSSProperties;\r\n  data: Array<string | number | OptionItem>;\r\n  getItemStyle?: (value: string | number) => CSSProperties;\r\n  onChange: (value: string | number) => void;\r\n};\r\n\r\nexport const Select: FunctionComponent<SelectProps> = (props) => {\r\n  const {\r\n    data,\r\n    value: activeValue,\r\n    style = {},\r\n    onChange,\r\n    getItemStyle = () => ({}),\r\n  } = props;\r\n  const handleChange = (event: any) => {\r\n    const { value } = event.target;\r\n    onChange(value);\r\n  };\r\n  return h(\r\n    'select',\r\n    {\r\n      onchange: handleChange,\r\n      value: activeValue,\r\n      style,\r\n      name: 'select',\r\n      className: 'select-list',\r\n    },\r\n    ...data.map((item) => {\r\n      const value = typeof item === 'object' ? item.value : item;\r\n      const label = typeof item === 'object' ? item.label : item;\r\n      const disabled = typeof item === 'object' ? item.disabled : false;\r\n      const itemStyle = getItemStyle(value);\r\n      return h(\r\n        'option',\r\n        {\r\n          key: value,\r\n          value,\r\n          style: itemStyle,\r\n          disabled: !!disabled,\r\n          className: classnames('select-item', { disabled }),\r\n        },\r\n        label,\r\n      );\r\n    }),\r\n  );\r\n};\r\nSelect.displayName = 'Select';\r\n", "import { h, FunctionComponent, CSSProperties } from '@/react';\r\nexport type ColorPickerProps = {\r\n  color: string;\r\n  style?: CSSProperties;\r\n  key: string;\r\n  onChange: (value: string) => void;\r\n};\r\nexport const COLOR_LIST = [\r\n  '#4D4D4D',\r\n  '#999999',\r\n  '#FFFFFF',\r\n  '#F44E3B',\r\n  '#FE9200',\r\n  '#FCDC00',\r\n  '#DBDF00',\r\n  '#A4DD00',\r\n  '#68CCCA',\r\n  '#73D8FF',\r\n  '#AEA1FF',\r\n  '#FDA1FF',\r\n  '#333333',\r\n  '#808080',\r\n  '#cccccc',\r\n  '#D33115',\r\n  '#E27300',\r\n  '#FCC400',\r\n  '#B0BC00',\r\n  '#68BC00',\r\n  '#16A5A5',\r\n  '#009CE0',\r\n  '#7B64FF',\r\n  '#FA28FF',\r\n  '#000000',\r\n  '#666666',\r\n  '#B3B3B3',\r\n  '#9F0500',\r\n  '#C45100',\r\n  '#FB9E00',\r\n  '#808900',\r\n  '#194D33',\r\n  '#0C797D',\r\n  '#0062B1',\r\n  '#653294',\r\n  '#AB149E',\r\n];\r\n\r\nconst baseClassName = 'color-picker-wrapper';\r\n\r\nexport const ColorPicker: FunctionComponent<ColorPickerProps> = (\r\n  props,\r\n  ...children\r\n) => {\r\n  const { color, style = {}, onChange, key } = props;\r\n  let ref: Element;\r\n  const toggleVisible = (value: boolean) => {\r\n    let className = baseClassName;\r\n    if (value) {\r\n      className = className + ' ' + 'show';\r\n    }\r\n    ref.className = className;\r\n  };\r\n  return h(\r\n    'div',\r\n    {\r\n      className: 'relative color-picker',\r\n      key,\r\n      style: style,\r\n    },\r\n    h(\r\n      'div',\r\n      {\r\n        className: 'color-picker-trigger',\r\n        style: {\r\n          color,\r\n        },\r\n        onclick: () => {\r\n          toggleVisible(true);\r\n        },\r\n      },\r\n      ...children,\r\n    ),\r\n\r\n    h(\r\n      'div',\r\n      {\r\n        className: baseClassName,\r\n        hook: {\r\n          ref: (dom) => {\r\n            ref = dom;\r\n          },\r\n        },\r\n        onmouseleave() {\r\n          toggleVisible(false);\r\n        },\r\n      },\r\n      h(\r\n        'div',\r\n        {\r\n          className: 'color-picker-list',\r\n        },\r\n        ...COLOR_LIST.map((item) =>\r\n          h('div', {\r\n            key: item,\r\n            className: 'color-picker-item',\r\n            style: {\r\n              backgroundColor: item,\r\n            },\r\n            onclick: () => {\r\n              toggleVisible(false);\r\n              onChange(item);\r\n            },\r\n          }),\r\n        ),\r\n      ),\r\n    ),\r\n  );\r\n};\r\nColorPicker.displayName = 'ColorPicker';\r\n", "import { h, SmartComponent } from '@/react';\r\nimport {\r\n  Icon,\r\n  Button,\r\n  ColorPicker,\r\n  Github,\r\n  Select,\r\n  FillColorIcon,\r\n} from '@/components';\r\nimport {\r\n  DEFAULT_FONT_FAMILY,\r\n  FONT_SIZE_LIST,\r\n  DEFAULT_FONT_SIZE,\r\n  DEFAULT_FONT_COLOR,\r\n} from '@/util';\r\nimport { StyleType, EWrap } from '@/types';\r\n\r\nexport const ToolbarContainer: SmartComponent = (state, controller) => {\r\n  const getItemStyle = (value: string | number) => {\r\n    return {\r\n      'font-family': String(value),\r\n    };\r\n  };\r\n  const setCellStyle = (value: Partial<StyleType>) => {\r\n    controller.setCellStyle(value);\r\n  };\r\n  const { activeCell, canRedo, canUndo, fontFamilyList } = state;\r\n  const { style = {} } = activeCell;\r\n  const {\r\n    isBold,\r\n    isItalic,\r\n    fontSize = DEFAULT_FONT_SIZE,\r\n    fontColor = DEFAULT_FONT_COLOR,\r\n    fillColor = '',\r\n    fontFamily = DEFAULT_FONT_FAMILY,\r\n    wrapText,\r\n  } = style;\r\n  return h(\r\n    'div',\r\n    {\r\n      className: 'toolbar-wrapper',\r\n    },\r\n    Button(\r\n      {\r\n        disabled: !canUndo,\r\n        onClick() {\r\n          controller.undo();\r\n        },\r\n        testId: 'toolbar-undo',\r\n      },\r\n      Icon({ name: 'undo' }),\r\n    ),\r\n    Button(\r\n      {\r\n        disabled: !canRedo,\r\n        onClick() {\r\n          controller.redo();\r\n        },\r\n        testId: 'toolbar-redo',\r\n      },\r\n      Icon({ name: 'redo' }),\r\n    ),\r\n    Button(\r\n      {\r\n        active: isBold,\r\n        onClick: () => {\r\n          setCellStyle({\r\n            isBold: !isBold,\r\n          });\r\n        },\r\n        testId: 'toolbar-bold',\r\n      },\r\n      Icon({ name: 'bold' }),\r\n    ),\r\n    Button(\r\n      {\r\n        active: isItalic,\r\n        onClick: () => {\r\n          setCellStyle({\r\n            isItalic: !isItalic,\r\n          });\r\n        },\r\n        testId: 'toolbar-italic',\r\n      },\r\n      Icon({ name: 'italic' }),\r\n    ),\r\n    Button(\r\n      {\r\n        onClick: () => {\r\n          setCellStyle({ wrapText: EWrap.AUTO_WRAP });\r\n        },\r\n        active: wrapText === EWrap.AUTO_WRAP,\r\n        testId: 'toolbar-wrap-text',\r\n      },\r\n      'Wrap Text',\r\n    ),\r\n    Select({\r\n      data: fontFamilyList,\r\n      value: fontFamily,\r\n      style: {\r\n        width: '140px',\r\n      },\r\n      getItemStyle: getItemStyle,\r\n      onChange: (value) => {\r\n        setCellStyle({ fontFamily: String(value) });\r\n      },\r\n    }),\r\n    Select({\r\n      data: FONT_SIZE_LIST,\r\n      value: fontSize,\r\n      onChange: (value) => {\r\n        setCellStyle({ fontSize: Number(value) });\r\n      },\r\n    }),\r\n    ColorPicker(\r\n      {\r\n        color: fontColor,\r\n        onChange: (value) => {\r\n          setCellStyle({ fontColor: value });\r\n        },\r\n        key: 'font-color',\r\n      },\r\n      Icon({ name: 'fontColor' }),\r\n    ),\r\n    ColorPicker(\r\n      {\r\n        key: 'fill-color',\r\n        color: fillColor,\r\n        onChange: (value) => {\r\n          setCellStyle({ fillColor: value });\r\n        },\r\n      },\r\n      FillColorIcon({}),\r\n    ),\r\n    Github({}),\r\n  );\r\n};\r\n\r\nToolbarContainer.displayName = 'ToolbarContainer';\r\n", "import { MUST_FONT_FAMILY, DEFAULT_FONT_FAMILY } from \"@/util/\";\r\nconst size = {\r\n  smallFont: \"10px\",\r\n  font: \"12px\",\r\n  largeFont: \"14px\",\r\n  padding: \"12px\",\r\n  fontFamily: `${DEFAULT_FONT_FAMILY},${MUST_FONT_FAMILY}`,\r\n  lineHeight: \"1.5\",\r\n  mediumPadding: \"8px\",\r\n  borderRadius: \"4px\",\r\n  tinyPadding: \"4px\",\r\n};\r\nexport default size;\r\n", "import { DEFAULT_FONT_COLOR } from \"@/util/\";\r\nconst color = {\r\n  primaryColor: \"#217346\",\r\n  buttonActiveColor: \"rgb(198,198,198)\",\r\n  selectionColor: \"rgba(198,198,198,0.3)\",\r\n  backgroundColor: \"#e6e6e6\",\r\n  white: \"#ffffff\",\r\n  black: \"#000000\",\r\n  gridStrokeColor: \"#d4d4d4\",\r\n  triangleFillColor: \"#b4b4b4\",\r\n  contentColor: DEFAULT_FONT_COLOR,\r\n  borderColor: \"#cccccc\",\r\n  activeBorderColor: \"#808080\",\r\n  disabledColor: \"#ccc\",\r\n};\r\nexport default color;\r\n", "import size from \"./size\";\r\nimport color from \"./color\";\r\nconst theme = {\r\n  ...size,\r\n  ...color,\r\n};\r\n\r\nexport default theme;\r\n", "import { h, SmartComponent } from '@/react';\r\nimport { classnames } from '@/util';\r\nimport theme from '@/theme';\r\nimport { Button, Icon } from '@/components';\r\n\r\nexport const SheetBarContainer: SmartComponent = (state, controller) => {\r\n  return h(\r\n    'div',\r\n    {\r\n      className: 'sheet-bar-wrapper',\r\n    },\r\n    h(\r\n      'div',\r\n      {\r\n        className: 'sheet-bar-list',\r\n      },\r\n      ...state.sheetList.map((item) => {\r\n        return h(\r\n          'div',\r\n          {\r\n            key: item.sheetId,\r\n            className: classnames('sheet-bar-item', {\r\n              active: state.currentSheetId === item.sheetId,\r\n            }),\r\n            onclick: () => {\r\n              controller.setCurrentSheetId(item.sheetId);\r\n            },\r\n          },\r\n          item.name,\r\n        );\r\n      }),\r\n    ),\r\n    h(\r\n      'div',\r\n      {\r\n        className: 'sheet-bar-add',\r\n      },\r\n      Button(\r\n        {\r\n          onClick: () => {\r\n            controller.addSheet();\r\n          },\r\n          type: 'circle',\r\n          style: {\r\n            backgroundColor: theme.buttonActiveColor,\r\n          },\r\n        },\r\n        Icon({\r\n          name: 'plus',\r\n        }),\r\n      ),\r\n    ),\r\n  );\r\n};\r\nSheetBarContainer.displayName = 'SheetBarContainer';\r\n", "import { h, SmartComponent, CSSProperties } from '@/react';\r\nimport { Button } from '@/components';\r\n\r\nconst defaultStyle: CSSProperties = {\r\n  display: 'none',\r\n};\r\n\r\nexport const ContextMenuContainer: SmartComponent = (state, controller) => {\r\n  const { contextMenuPosition } = state;\r\n  const style =\r\n    contextMenuPosition === undefined\r\n      ? defaultStyle\r\n      : {\r\n          top: contextMenuPosition.top,\r\n          left: contextMenuPosition.left,\r\n        };\r\n  const hideContextMenu = () => {\r\n    state.contextMenuPosition = undefined;\r\n  };\r\n  return h(\r\n    'div',\r\n    {\r\n      className: 'context-menu',\r\n      style,\r\n    },\r\n    Button(\r\n      {\r\n        onClick() {\r\n          controller.addCol(controller.getActiveCell().col, 1);\r\n          hideContextMenu();\r\n        },\r\n      },\r\n      '\u65B0\u589E\u4E00\u5217',\r\n    ),\r\n    Button(\r\n      {\r\n        onClick() {\r\n          controller.addRow(controller.getActiveCell().row, 1);\r\n          hideContextMenu();\r\n        },\r\n      },\r\n      '\u65B0\u589E\u4E00\u884C',\r\n    ),\r\n  );\r\n};\r\nContextMenuContainer.displayName = 'ContextMenuContainer';\r\n", "import { h, SmartComponent } from './react';\r\nimport {\r\n  CanvasContainer,\r\n  SheetBarContainer,\r\n  ToolbarContainer,\r\n  FormulaBarContainer,\r\n  ContextMenuContainer,\r\n} from './containers';\r\n\r\nexport const App: SmartComponent = (state, controller) => {\r\n  return h(\r\n    'div',\r\n    {\r\n      className: 'app-container',\r\n    },\r\n    ToolbarContainer(state, controller),\r\n    FormulaBarContainer(state, controller),\r\n    CanvasContainer(state, controller),\r\n    SheetBarContainer(state, controller),\r\n    ContextMenuContainer(state, controller),\r\n  );\r\n};\r\nApp.displayName = 'App';\r\n", "import { isEmpty } from '@/lodash';\r\nimport {\r\n  Coordinate,\r\n  WorkBookJSON,\r\n  CellInfo,\r\n  StyleType,\r\n  ChangeEventType,\r\n  IController,\r\n  IHooks,\r\n  IModel,\r\n  WorksheetType,\r\n  IHistory,\r\n  IWindowSize,\r\n  CanvasOverlayPosition,\r\n  ScrollValue,\r\n} from '@/types';\r\nimport { parseReference, controllerLog, Range, assert } from '@/util';\r\n\r\nconst DEFAULT_ACTIVE_CELL = { row: 0, col: 0 };\r\nconst CELL_HEIGHT = 20;\r\nconst CELL_WIDTH = 68;\r\nconst ROW_TITLE_HEIGHT = 20;\r\nconst COL_TITLE_WIDTH = 34;\r\n\r\nconst defaultScrollValue: ScrollValue = {\r\n  top: 0,\r\n  left: 0,\r\n  row: 0,\r\n  col: 0,\r\n  scrollLeft: 0,\r\n  scrollTop: 0,\r\n};\r\n\r\nexport class Controller implements IController {\r\n  private scrollValue: Record<string, ScrollValue> = {};\r\n  private model: IModel;\r\n  private ranges: Array<Range> = [];\r\n  private changeSet = new Set<ChangeEventType>();\r\n  private hooks: IHooks = {\r\n    modelChange() {},\r\n  };\r\n  private history: IHistory;\r\n  private readonly rowMap: Map<number, number> = new Map([]);\r\n  private readonly colMap: Map<number, number> = new Map([]);\r\n  private viewSize = {\r\n    width: 0,\r\n    height: 0,\r\n  };\r\n  constructor(model: IModel, history: IHistory) {\r\n    this.model = model;\r\n    this.ranges = [\r\n      new Range(\r\n        DEFAULT_ACTIVE_CELL.row,\r\n        DEFAULT_ACTIVE_CELL.col,\r\n        1,\r\n        1,\r\n        this.getCurrentSheetId(),\r\n      ),\r\n    ];\r\n    this.history = history;\r\n  }\r\n  getCurrentSheetId(): string {\r\n    return this.model.getCurrentSheetId();\r\n  }\r\n  getSheetList(): WorkBookJSON['workbook'] {\r\n    return this.model.getSheetList();\r\n  }\r\n  getCellsContent(sheetId?: string | undefined): Coordinate[] {\r\n    return this.model.getCellsContent(sheetId);\r\n  }\r\n  getSheetInfo(sheetId?: string | undefined): WorksheetType {\r\n    return this.model.getSheetInfo(sheetId);\r\n  }\r\n  getRanges(): Range[] {\r\n    return this.ranges;\r\n  }\r\n  setHooks(hooks: IHooks): void {\r\n    this.hooks = hooks;\r\n  }\r\n  private emitChange(recordHistory = true): void {\r\n    controllerLog('emitChange', this.changeSet);\r\n    if (recordHistory) {\r\n      this.history.onChange(this.toJSON());\r\n    }\r\n    this.hooks.modelChange(this.changeSet);\r\n    this.changeSet = new Set<ChangeEventType>();\r\n  }\r\n  getActiveCell(): Coordinate {\r\n    const { activeCell } = this.getSheetInfo();\r\n    if (!activeCell) {\r\n      return { ...DEFAULT_ACTIVE_CELL };\r\n    }\r\n    const result = parseReference(activeCell);\r\n    assert(!!result);\r\n    const { row, col } = result;\r\n    return { row, col };\r\n  }\r\n  setActiveCell(row = -1, col = -1, colCount = 1, rowCount = 1): void {\r\n    this.changeSet.add('selectionChange');\r\n    let position: Coordinate = { ...DEFAULT_ACTIVE_CELL };\r\n    if (row === col && row === -1) {\r\n      position = this.getActiveCell();\r\n    } else {\r\n      position = { row, col };\r\n    }\r\n    this.model.setActiveCell(position.row, position.col);\r\n    this.ranges = [\r\n      new Range(\r\n        position.row,\r\n        position.col,\r\n        colCount,\r\n        rowCount,\r\n        this.getCurrentSheetId(),\r\n      ),\r\n    ];\r\n    this.emitChange();\r\n  }\r\n  setCurrentSheetId(id: string): void {\r\n    if (id === this.getCurrentSheetId()) {\r\n      return;\r\n    }\r\n    this.model.setCurrentSheetId(id);\r\n    this.setActiveCell();\r\n    this.changeSet.add('contentChange');\r\n    this.computeViewSize();\r\n    this.emitChange();\r\n  }\r\n  addSheet(): void {\r\n    this.model.addSheet();\r\n    this.computeViewSize();\r\n    this.model.setActiveCell(0, 0);\r\n    this.setScroll({\r\n      top: 0,\r\n      left: 0,\r\n      row: 0,\r\n      col: 0,\r\n      scrollLeft: 0,\r\n      scrollTop: 0,\r\n    });\r\n  }\r\n  selectAll(row: number, col: number): void {\r\n    this.setActiveCell(row, col, 0, 0);\r\n    controllerLog('selectAll');\r\n  }\r\n  selectCol(row: number, col: number): void {\r\n    const sheetInfo = this.model.getSheetInfo();\r\n    this.setActiveCell(row, col, sheetInfo.rowCount, 0);\r\n    controllerLog('selectCol');\r\n  }\r\n  selectRow(row: number, col: number): void {\r\n    const sheetInfo = this.model.getSheetInfo();\r\n    this.setActiveCell(row, col, 0, sheetInfo.colCount);\r\n    controllerLog('selectRow');\r\n  }\r\n  fromJSON(json: WorkBookJSON): void {\r\n    controllerLog('loadJSON', json);\r\n    this.model.fromJSON(json);\r\n    this.model.setActiveCell(0, 0);\r\n    this.changeSet.add('contentChange');\r\n    this.emitChange(false);\r\n  }\r\n  toJSON(): WorkBookJSON {\r\n    return this.model.toJSON();\r\n  }\r\n  updateSelection(row: number, col: number): void {\r\n    const activeCell = this.getActiveCell();\r\n    if (activeCell.row === row && activeCell.col === col) {\r\n      return;\r\n    }\r\n    const colCount = Math.abs(col - activeCell.col) + 1;\r\n    const rowCount = Math.abs(row - activeCell.row) + 1;\r\n    const temp = new Range(\r\n      Math.min(activeCell.row, row),\r\n      Math.min(activeCell.col, col),\r\n      rowCount,\r\n      colCount,\r\n      this.getCurrentSheetId(),\r\n    );\r\n    this.ranges = [temp];\r\n    controllerLog('updateSelection', temp);\r\n    this.changeSet.add('selectionChange');\r\n    this.emitChange();\r\n  }\r\n\r\n  setCellValue(data: Coordinate, value: string): void {\r\n    controllerLog('setCellValue', value);\r\n    const temp = [\r\n      new Range(data.row, data.col, 1, 1, this.getCurrentSheetId()),\r\n    ];\r\n    this.model.setCellValues(value, temp);\r\n    this.changeSet.add('contentChange');\r\n    this.emitChange();\r\n  }\r\n  setCellStyle(style: Partial<StyleType>, ranges = this.ranges): void {\r\n    if (isEmpty(style)) {\r\n      return;\r\n    }\r\n    this.model.setCellStyle(style, ranges);\r\n    this.changeSet.add('contentChange');\r\n    this.emitChange();\r\n  }\r\n  getCell = (data: Coordinate): CellInfo => {\r\n    const { row, col } = data;\r\n    const { model } = this;\r\n    const { value, formula, style } = model.queryCell(row, col);\r\n    return {\r\n      value,\r\n      row,\r\n      col,\r\n      formula,\r\n      style,\r\n    };\r\n  };\r\n  canRedo(): boolean {\r\n    return this.history.canRedo();\r\n  }\r\n  canUndo(): boolean {\r\n    return this.history.canUndo();\r\n  }\r\n  undo(): void {\r\n    const result = this.history.undo(this.toJSON());\r\n    if (result) {\r\n      this.fromJSON(result);\r\n    }\r\n  }\r\n  redo(): void {\r\n    const result = this.history.redo(this.toJSON());\r\n    if (result) {\r\n      this.fromJSON(result);\r\n    }\r\n  }\r\n  getColWidth(col: number): number {\r\n    return this.colMap.get(col) || CELL_WIDTH;\r\n  }\r\n  setColWidth(col: number, width: number): void {\r\n    this.colMap.set(col, width);\r\n    this.computeViewSize();\r\n    this.changeSet.add('contentChange');\r\n  }\r\n  getRowHeight(row: number): number {\r\n    return this.rowMap.get(row) || CELL_HEIGHT;\r\n  }\r\n  setRowHeight(row: number, height: number) {\r\n    this.rowMap.set(row, height);\r\n    this.computeViewSize();\r\n    this.changeSet.add('contentChange');\r\n  }\r\n  private computeViewSize() {\r\n    const headerSize = this.getHeaderSize();\r\n    const sheetInfo = this.model.getSheetInfo();\r\n    let width = headerSize.width;\r\n    let height = headerSize.height;\r\n    for (let i = 0; i < sheetInfo.colCount; i++) {\r\n      width += this.getColWidth(i);\r\n    }\r\n    for (let i = 0; i < sheetInfo.rowCount; i++) {\r\n      height += this.getRowHeight(i);\r\n    }\r\n    this.viewSize = {\r\n      width,\r\n      height,\r\n    };\r\n  }\r\n  getViewSize() {\r\n    return {\r\n      ...this.viewSize,\r\n    };\r\n  }\r\n  getCellSize(row: number, col: number): IWindowSize {\r\n    return { width: this.getColWidth(col), height: this.getRowHeight(row) };\r\n  }\r\n  getHeaderSize() {\r\n    return {\r\n      width: COL_TITLE_WIDTH,\r\n      height: ROW_TITLE_HEIGHT,\r\n    };\r\n  }\r\n  computeCellPosition(row: number, col: number): CanvasOverlayPosition {\r\n    const size = this.getHeaderSize();\r\n    const scroll = this.getScroll();\r\n    let resultX = size.width;\r\n    let resultY = size.height;\r\n    let r = scroll.row;\r\n    let c = scroll.col;\r\n    while (c < col) {\r\n      resultX += this.getColWidth(c);\r\n      c++;\r\n    }\r\n    while (r < row) {\r\n      resultY += this.getRowHeight(r);\r\n      r++;\r\n    }\r\n    const cellSize = this.getCellSize(row, col);\r\n    return { ...cellSize, top: resultY, left: resultX };\r\n  }\r\n\r\n  addRow(rowIndex: number, count: number): void {\r\n    this.model.addRow(rowIndex, count);\r\n    this.changeSet.add('contentChange');\r\n    this.emitChange();\r\n  }\r\n  addCol(colIndex: number, count: number): void {\r\n    this.model.addCol(colIndex, count);\r\n    this.changeSet.add('contentChange');\r\n    this.emitChange();\r\n  }\r\n  getChangeSet(): Set<ChangeEventType> {\r\n    const result = this.changeSet;\r\n    this.changeSet = new Set<ChangeEventType>();\r\n    return result;\r\n  }\r\n\r\n  getScroll(): ScrollValue {\r\n    const sheetId = this.model.getCurrentSheetId()\r\n    const result = this.scrollValue[sheetId] || defaultScrollValue;\r\n    return result;\r\n  }\r\n  setScroll(data: ScrollValue): void {\r\n    const sheetId = this.model.getCurrentSheetId()\r\n    this.scrollValue[sheetId] = {\r\n      ...data\r\n    }\r\n    this.changeSet.add('contentChange');\r\n    this.emitChange();\r\n  }\r\n}\r\n", "import { WorkBookJSON, IHistory } from '@/types';\r\nexport class History implements IHistory {\r\n  private undoList: string[] = [];\r\n  private redoList: string[] = [];\r\n  constructor() {\r\n    this.reset();\r\n  }\r\n  private reset(): void {\r\n    this.undoList = [];\r\n    this.redoList = [];\r\n  }\r\n  onChange(sheetData: WorkBookJSON): void {\r\n    this.addUndoData(sheetData);\r\n    this.redoList = [];\r\n  }\r\n  private addUndoData(sheetData: WorkBookJSON): void {\r\n    this.undoList.push(JSON.stringify(sheetData));\r\n  }\r\n  private addRedoData(sheetData: WorkBookJSON): void {\r\n    this.redoList.push(JSON.stringify(sheetData));\r\n  }\r\n  private getUndoData(): WorkBookJSON | undefined {\r\n    const temp = this.undoList.pop();\r\n    return temp ? JSON.parse(temp) : temp;\r\n  }\r\n  private getRedoData(): WorkBookJSON | undefined {\r\n    const temp = this.redoList.pop();\r\n    return temp ? JSON.parse(temp) : temp;\r\n  }\r\n  canRedo(): boolean {\r\n    return this.redoList.length > 0;\r\n  }\r\n  canUndo(): boolean {\r\n    return this.undoList.length > 0;\r\n  }\r\n  redo(sheetData: WorkBookJSON): WorkBookJSON | undefined {\r\n    if (this.canRedo()) {\r\n      this.addUndoData(sheetData);\r\n      return this.getRedoData();\r\n    }\r\n    return undefined;\r\n  }\r\n  undo(sheetData: WorkBookJSON): WorkBookJSON | undefined {\r\n    if (this.canUndo()) {\r\n      this.addRedoData(sheetData);\r\n      return this.getUndoData();\r\n    }\r\n    return undefined;\r\n  }\r\n}\r\n", "import type { TokenType } from '@/types'\r\nexport class Token {\r\n  type: TokenType;\r\n  value: string;\r\n  constructor(type: TokenType, value: string) {\r\n    this.type = type;\r\n    this.value = value;\r\n  }\r\n  error() {\r\n    return `type:${this.type},value:${this.value}`;\r\n  }\r\n}", "import type { ErrorTypes } from '@/types'\r\nexport class CustomError extends Error {\r\n  readonly value: ErrorTypes;\r\n  constructor(value: ErrorTypes) {\r\n    super(value);\r\n    this.value = value;\r\n  }\r\n}", "import { TokenType } from '@/types';\r\nimport { Token } from './token';\r\nimport { CustomError } from './error';\r\n\r\nconst emptyData = '';\r\nconst identifierMap = new Map<string, TokenType>([\r\n  ['TRUE', TokenType.TRUE],\r\n  ['FALSE', TokenType.FALSE],\r\n]);\r\n\r\nexport class Scanner {\r\n  private readonly list: string[];\r\n  private current = 0;\r\n  private start = 0;\r\n  private readonly tokens: Token[] = [];\r\n  constructor(source: string) {\r\n    // unicode\r\n    this.list = [...source];\r\n  }\r\n  scan(): Token[] {\r\n    while (!this.isAtEnd()) {\r\n      this.start = this.current;\r\n      this.scanToken();\r\n    }\r\n    this.tokens.push(new Token(TokenType.EOF, ''));\r\n    if (this.tokens.length > 0 && this.tokens[0].type === TokenType.EQUAL) {\r\n      this.tokens.shift();\r\n    }\r\n    return this.tokens;\r\n  }\r\n  private peek() {\r\n    if (this.isAtEnd()) {\r\n      return emptyData;\r\n    }\r\n    return this.list[this.current];\r\n  }\r\n  private match(text: string) {\r\n    if (this.peek() !== text) {\r\n      return false;\r\n    }\r\n    this.next();\r\n    return true;\r\n  }\r\n  private next() {\r\n    if (this.isAtEnd()) {\r\n      return emptyData;\r\n    }\r\n    return this.list[this.current++];\r\n  }\r\n  private isAtEnd() {\r\n    return this.current >= this.list.length;\r\n  }\r\n  private addToken(type: TokenType) {\r\n    const text = this.list.slice(this.start, this.current).join('');\r\n    this.tokens.push(new Token(type, text));\r\n  }\r\n  private string(end: string) {\r\n    while (!this.isAtEnd() && this.peek() !== end) {\r\n      this.next();\r\n    }\r\n    if (this.peek() !== end) {\r\n      throw new CustomError('#VALUE!');\r\n    } else {\r\n      this.next();\r\n    }\r\n    const text = this.list.slice(this.start + 1, this.current - 1).join('');\r\n    this.tokens.push(new Token(TokenType.STRING, text));\r\n  }\r\n  private number() {\r\n    while (!this.isAtEnd() && this.isDigit(this.peek())) {\r\n      this.next();\r\n    }\r\n    if (this.match('.')) {\r\n      while (!this.isAtEnd() && this.isDigit(this.peek())) {\r\n        this.next();\r\n      }\r\n    }\r\n    this.addToken(TokenType.NUMBER);\r\n  }\r\n  private isDigit(char: string) {\r\n    return char >= '0' && char <= '9';\r\n  }\r\n  private identifier() {\r\n    while (!this.isAtEnd() && this.anyChar(this.peek())) {\r\n      this.next();\r\n    }\r\n    let text = this.list.slice(this.start, this.current).join('');\r\n    const temp = identifierMap.get(text.toUpperCase());\r\n    let type: TokenType = TokenType.IDENTIFIER;\r\n    if (temp) {\r\n      text = text.toUpperCase();\r\n      type = temp;\r\n    }\r\n    this.tokens.push(new Token(type, text));\r\n  }\r\n  private scanToken() {\r\n    const c = this.next();\r\n    switch (c) {\r\n      case '(':\r\n        this.addToken(TokenType.LEFT_BRACKET);\r\n        break;\r\n      case ')':\r\n        this.addToken(TokenType.RIGHT_BRACKET);\r\n        break;\r\n      case ',':\r\n        this.addToken(TokenType.COMMA);\r\n        break;\r\n      case ':':\r\n        this.addToken(TokenType.COLON);\r\n        break;\r\n      case '=':\r\n        this.addToken(TokenType.EQUAL);\r\n        break;\r\n      case '<':\r\n        if (this.match('>')) {\r\n          this.addToken(TokenType.NOT_EQUAL);\r\n        } else if (this.match('=')) {\r\n          this.addToken(TokenType.LESS_EQUAL);\r\n        } else {\r\n          this.addToken(TokenType.LESS);\r\n        }\r\n        break;\r\n      case '>':\r\n        if (this.match('=')) {\r\n          this.addToken(TokenType.GREATER_EQUAL);\r\n        } else {\r\n          this.addToken(TokenType.GREATER);\r\n        }\r\n        break;\r\n      case '+':\r\n        this.addToken(TokenType.PLUS);\r\n        break;\r\n      case '-':\r\n        this.addToken(TokenType.MINUS);\r\n        break;\r\n      case '*':\r\n        this.addToken(TokenType.STAR);\r\n        break;\r\n      case '/':\r\n        this.addToken(TokenType.SLASH);\r\n        break;\r\n      case '^':\r\n        this.addToken(TokenType.EXPONENT);\r\n        break;\r\n      case '&':\r\n        this.addToken(TokenType.CONCATENATE);\r\n        break;\r\n      case '%':\r\n        this.addToken(TokenType.PERCENT);\r\n        break;\r\n      case '\"':\r\n        this.string(c);\r\n        break;\r\n      case ';':\r\n        this.addToken(TokenType.SEMICOLON);\r\n        break;\r\n      case '{':\r\n        this.addToken(TokenType.lEFT_BRACE);\r\n        break;\r\n      case '}':\r\n        this.addToken(TokenType.RIGHT_BRACE);\r\n        break;\r\n      case ' ':\r\n        // while (!this.isAtEnd() && this.peek() === ' ') {\r\n          // this.next();\r\n        // }\r\n        // this.addToken(TokenType.EMPTY_CHAR);\r\n        break;\r\n      case '\\r':\r\n      case '\\t':\r\n      case '\\n':\r\n        break;\r\n      default:\r\n        if (this.isDigit(c)) {\r\n          this.number();\r\n        } else if (this.anyChar(c)) {\r\n          this.identifier();\r\n        } else {\r\n          throw new CustomError('#ERROR!');\r\n        }\r\n        break;\r\n    }\r\n  }\r\n  private anyChar(c: string) {\r\n    const text = '(),:=<>+-*/^&%\"{}';\r\n    return !text.includes(c) && !this.isWhiteSpace(c);\r\n  }\r\n  private isWhiteSpace(c: string) {\r\n    return c === ' ' || c === '\\r' || c === '\\n' || c === '\\t';\r\n  }\r\n}\r\n", "import type { Token } from './token';\r\nimport type { ReferenceType } from '@/types';\r\n\r\nexport interface Visitor {\r\n  visitBinaryExpression(expr: BinaryExpression): any;\r\n  visitUnaryExpression(expr: UnaryExpression): any;\r\n  visitPostUnaryExpression(expr: PostUnaryExpression): any;\r\n  visitLiteralExpression(expr: LiteralExpression): any;\r\n  visitCellExpression(expr: CellExpression): any;\r\n  visitCellRangeExpression(expr: CellRangeExpression): any;\r\n  visitCallExpression(expr: CallExpression): any;\r\n  visitErrorExpression(expr: ErrorExpression): any;\r\n  visitGroupExpression(expr: GroupExpression): any;\r\n  visitDefineNameExpression(expr: DefineNameExpression): any;\r\n}\r\n\r\nexport interface Expression {\r\n  accept(visitor: Visitor): any;\r\n  toString(): string;\r\n}\r\n\r\nexport class BinaryExpression implements Expression {\r\n  readonly left: Expression;\r\n  readonly right: Expression;\r\n  readonly operator: Token;\r\n  constructor(left: Expression, operator: Token, right: Expression) {\r\n    this.left = left;\r\n    this.operator = operator;\r\n    this.right = right;\r\n  }\r\n  accept(visitor: Visitor) {\r\n    return visitor.visitBinaryExpression(this);\r\n  }\r\n  toString(): string {\r\n    return '';\r\n  }\r\n}\r\n\r\nexport class UnaryExpression implements Expression {\r\n  readonly right: Expression;\r\n  readonly operator: Token;\r\n  constructor(operator: Token, right: Expression) {\r\n    this.operator = operator;\r\n    this.right = right;\r\n  }\r\n  accept(visitor: Visitor) {\r\n    return visitor.visitUnaryExpression(this);\r\n  }\r\n  toString(): string {\r\n    return '';\r\n  }\r\n}\r\n\r\nexport class PostUnaryExpression implements Expression {\r\n  readonly left: Expression;\r\n  readonly operator: Token;\r\n  constructor(operator: Token, left: Expression) {\r\n    this.operator = operator;\r\n    this.left = left;\r\n  }\r\n  accept(visitor: Visitor) {\r\n    return visitor.visitPostUnaryExpression(this);\r\n  }\r\n  toString(): string {\r\n    return '';\r\n  }\r\n}\r\n\r\nexport class LiteralExpression implements Expression {\r\n  readonly value: Token;\r\n  constructor(value: Token) {\r\n    this.value = value;\r\n  }\r\n  accept(visitor: Visitor) {\r\n    return visitor.visitLiteralExpression(this);\r\n  }\r\n  toString(): string {\r\n    return '';\r\n  }\r\n}\r\n\r\nexport class CellExpression implements Expression {\r\n  readonly value: Token;\r\n  readonly sheetName: Token | null;\r\n  readonly type: ReferenceType;\r\n  constructor(value: Token, type: ReferenceType, sheetName: Token | null) {\r\n    this.value = value;\r\n    this.sheetName = sheetName;\r\n    this.type = type;\r\n  }\r\n  accept(visitor: Visitor) {\r\n    return visitor.visitCellExpression(this);\r\n  }\r\n  toString(): string {\r\n    return '';\r\n  }\r\n}\r\n\r\nexport class CallExpression implements Expression {\r\n  readonly name: Token;\r\n  readonly params: Expression[];\r\n  constructor(name: Token, params: Expression[]) {\r\n    this.name = name;\r\n    this.params = params;\r\n  }\r\n  accept(visitor: Visitor) {\r\n    return visitor.visitCallExpression(this);\r\n  }\r\n  toString(): string {\r\n    return '';\r\n  }\r\n}\r\nexport class ErrorExpression implements Expression {\r\n  readonly value: Token;\r\n  constructor(value: Token) {\r\n    this.value = value;\r\n  }\r\n  accept(visitor: Visitor): any {\r\n    return visitor.visitErrorExpression(this);\r\n  }\r\n  toString(): string {\r\n    return '';\r\n  }\r\n}\r\nexport class CellRangeExpression implements Expression {\r\n  readonly left: Expression;\r\n  readonly right: Expression;\r\n  readonly operator: Token;\r\n  constructor(left: Expression, operator: Token, right: Expression) {\r\n    this.left = left;\r\n    this.operator = operator;\r\n    this.right = right;\r\n  }\r\n  accept(visitor: Visitor) {\r\n    return visitor.visitCellRangeExpression(this);\r\n  }\r\n  toString(): string {\r\n    return '';\r\n  }\r\n}\r\n\r\nexport class GroupExpression implements Expression {\r\n  readonly value: Expression;\r\n  constructor(value: Expression) {\r\n    this.value = value;\r\n  }\r\n  accept(visitor: Visitor) {\r\n    return visitor.visitGroupExpression(this);\r\n  }\r\n  toString(): string {\r\n    return '';\r\n  }\r\n}\r\n\r\nexport class DefineNameExpression implements Expression {\r\n  readonly value: Token;\r\n  constructor(value: Token) {\r\n    this.value = value;\r\n  }\r\n  accept(visitor: Visitor) {\r\n    return visitor.visitDefineNameExpression(this);\r\n  }\r\n  toString(): string {\r\n    return '';\r\n  }\r\n}\r\n", "import { TokenType, ErrorTypes } from '@/types';\r\nimport { Token } from './token';\r\nimport {\r\n  DefineNameExpression,\r\n  Expression,\r\n  GroupExpression,\r\n  PostUnaryExpression,\r\n} from './expression';\r\nimport {\r\n  BinaryExpression,\r\n  UnaryExpression,\r\n  CellExpression,\r\n  CallExpression,\r\n  LiteralExpression,\r\n  ErrorExpression,\r\n  CellRangeExpression,\r\n} from './expression';\r\nimport { CustomError } from './error';\r\n\r\nconst errorSet = new Set<ErrorTypes>([\r\n  '#ERROR!',\r\n  '#DIV/0!',\r\n  '#NULL!',\r\n  '#NUM!',\r\n  '#REF!',\r\n  '#VALUE!',\r\n  '#N/A',\r\n  '#NAME?',\r\n]);\r\n\r\nexport class Parser {\r\n  private readonly tokens: Token[];\r\n  private current = 0;\r\n  constructor(tokens: Token[]) {\r\n    this.tokens = tokens;\r\n  }\r\n  parse() {\r\n    const result: Expression[] = [];\r\n    while (!this.isAtEnd()) {\r\n      result.push(this.expression());\r\n    }\r\n    return result;\r\n  }\r\n  private expression(): Expression {\r\n    return this.comparison();\r\n  }\r\n  private comparison(): Expression {\r\n    let expr = this.concatenate();\r\n    while (\r\n      this.match(\r\n        TokenType.EQUAL,\r\n        TokenType.NOT_EQUAL,\r\n        TokenType.GREATER,\r\n        TokenType.GREATER_EQUAL,\r\n        TokenType.LESS,\r\n        TokenType.LESS_EQUAL,\r\n      )\r\n    ) {\r\n      const operator = this.previous();\r\n      const right = this.concatenate();\r\n      expr = new BinaryExpression(expr, operator, right);\r\n    }\r\n    return expr;\r\n  }\r\n  private concatenate(): Expression {\r\n    let expr = this.term();\r\n    while (this.match(TokenType.CONCATENATE)) {\r\n      const operator = this.previous();\r\n      const right = this.term();\r\n      expr = new BinaryExpression(expr, operator, right);\r\n    }\r\n    return expr;\r\n  }\r\n  private term(): Expression {\r\n    let expr = this.factor();\r\n    while (this.match(TokenType.PLUS, TokenType.MINUS)) {\r\n      const operator = this.previous();\r\n      const right = this.factor();\r\n      expr = new BinaryExpression(expr, operator, right);\r\n    }\r\n    return expr;\r\n  }\r\n  private factor(): Expression {\r\n    let expr = this.expo();\r\n    while (this.match(TokenType.SLASH, TokenType.STAR)) {\r\n      const operator = this.previous();\r\n      const right = this.expo();\r\n      expr = new BinaryExpression(expr, operator, right);\r\n    }\r\n    return expr;\r\n  }\r\n  private expo(): Expression {\r\n    let expr = this.unary();\r\n    while (this.match(TokenType.EXPONENT)) {\r\n      const operator = this.previous();\r\n      const right = this.unary();\r\n      expr = new BinaryExpression(expr, operator, right);\r\n    }\r\n    return expr;\r\n  }\r\n\r\n  private unary(): Expression {\r\n    if (this.match(TokenType.PLUS, TokenType.MINUS)) {\r\n      const operator = this.previous();\r\n      const right = this.unary();\r\n      return new UnaryExpression(operator, right);\r\n    }\r\n    return this.postUnary();\r\n  }\r\n  private postUnary(): Expression {\r\n    let expr = this.spread();\r\n    if(this.match(TokenType.PERCENT)) {\r\n      const operator = this.previous();\r\n      expr = new PostUnaryExpression(operator, expr)\r\n    }\r\n    return expr\r\n  }\r\n  private spread(): Expression {\r\n    let expr = this.call();\r\n    while (this.match(TokenType.COLON)) {\r\n      const operator = this.previous();\r\n      const right = this.call();\r\n      expr = new CellRangeExpression(expr, operator, right);\r\n    }\r\n    return expr;\r\n  }\r\n  private call(): Expression {\r\n    let expr = this.primary();\r\n    if (this.match(TokenType.LEFT_BRACKET)) {\r\n      if (expr instanceof DefineNameExpression) {\r\n        expr = this.finishCall(expr.value);\r\n      } else {\r\n        throw new CustomError('#NAME?');\r\n      }\r\n    }\r\n    return expr;\r\n  }\r\n\r\n  private finishCall(name: Token): CallExpression {\r\n    const params: Expression[] = [];\r\n    if (!this.check(TokenType.RIGHT_BRACKET)) {\r\n      do {\r\n        params.push(this.expression());\r\n      } while (this.match(TokenType.COMMA));\r\n    }\r\n    this.expect(TokenType.RIGHT_BRACKET);\r\n    let realName: Token = name;\r\n    if (name.value[0] === '@') {\r\n      realName = new Token(TokenType.IDENTIFIER, name.value.slice(1));\r\n    }\r\n    return new CallExpression(realName, params);\r\n  }\r\n  private primary(): Expression {\r\n    if (\r\n      this.match(\r\n        TokenType.NUMBER,\r\n        TokenType.STRING,\r\n        TokenType.TRUE,\r\n        TokenType.FALSE,\r\n      )\r\n    ) {\r\n      return new LiteralExpression(this.previous());\r\n    }\r\n\r\n    if (this.match(TokenType.IDENTIFIER)) {\r\n      const name = this.previous();\r\n      const { value, type } = name;\r\n      const realValue = value.toUpperCase();\r\n      const newToken = new Token(type, realValue);\r\n      if (errorSet.has(realValue as ErrorTypes)) {\r\n        return new ErrorExpression(new Token(type, realValue));\r\n      }\r\n      if (realValue && realValue[realValue.length - 1] === '!') {\r\n        const expr = this.expression();\r\n        if (expr instanceof CellExpression) {\r\n          return new CellExpression(expr.value, expr.type, name);\r\n        }\r\n        throw new CustomError('#REF!');\r\n      }\r\n      if (/^[a-z]+$/i.test(value)) {\r\n        return new DefineNameExpression(name);\r\n      }\r\n      if (\r\n        /^\\$[A-Z]+\\$\\d+$/.test(realValue) ||\r\n        /^\\$[A-Z]+$/.test(realValue) ||\r\n        /^\\$\\d+$/.test(realValue)\r\n      ) {\r\n        return new CellExpression(newToken, 'absolute', null);\r\n      }\r\n      if (/^\\$[A-Z]+\\d+$/.test(realValue) || /^[A-Z]+\\$\\d+$/.test(realValue)) {\r\n        return new CellExpression(newToken, 'mixed', null);\r\n      }\r\n      if (/^[A-Z]+\\d+$/.test(realValue) || /^[A-Z]+$/.test(realValue)) {\r\n        return new CellExpression(newToken, 'relative', null);\r\n      }\r\n    }\r\n    if (this.match(TokenType.LEFT_BRACKET)) {\r\n      const value = this.expression();\r\n      this.expect(TokenType.RIGHT_BRACKET);\r\n      return new GroupExpression(value);\r\n    }\r\n    // if (this.match(TokenType.EMPTY_CHAR)) {\r\n      // return this.expression();\r\n    // }\r\n    throw new CustomError('#ERROR!');\r\n  }\r\n  private match(...types: TokenType[]): boolean {\r\n    const type = this.peek().type;\r\n    if (types.includes(type)) {\r\n      this.next();\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n  private previous(): Token {\r\n    return this.tokens[this.current - 1];\r\n  }\r\n  private check(type: TokenType): boolean {\r\n    return this.peek().type === type;\r\n  }\r\n  private expect(type: TokenType): Token {\r\n    if (this.check(type)) {\r\n      this.next();\r\n      return this.previous();\r\n    } else {\r\n      throw new CustomError('#ERROR!');\r\n    }\r\n  }\r\n  private next() {\r\n    this.current++;\r\n  }\r\n  private isAtEnd() {\r\n    return this.peek().type === TokenType.EOF;\r\n  }\r\n  private peek(): Token {\r\n    if (this.current < this.tokens.length) {\r\n      return this.tokens[this.current];\r\n    }\r\n    return new Token(TokenType.EOF, '');\r\n  }\r\n}\r\n", "import type { TextFormulaType } from \"@/types\";\r\n\r\nexport const T = (value: unknown): string => {\r\n  return typeof value === \"string\" ? value : \"\";\r\n};\r\n\r\nexport const LOWER = (value: string): string => value.toLowerCase();\r\nexport const CHAR = (value: number): string => String.fromCharCode(value);\r\nexport const CODE = (value: string): number => value.charCodeAt(0);\r\nexport const LEN = (value: string): number => value.length;\r\n\r\nexport const SPLIT = (value: string, sep: string): string[] => value.split(sep);\r\nexport const UNICHAR = CHAR;\r\nexport const UNICODE = CODE;\r\nexport const UPPER = (value: string): string => value.toUpperCase();\r\nexport const TRIM = (value: string): string => value.replace(/ +/g, \" \").trim();\r\n\r\nconst textFormulas: TextFormulaType = {\r\n  ASC: null,\r\n  BAHTTEXT: null,\r\n  CONCATENATE: null,\r\n  CLEAN: null,\r\n  DBCS: null,\r\n  DOLLAR: null,\r\n  EXACT: null,\r\n  FIND: null,\r\n  FIXED: null,\r\n  HTML2TEXT: null,\r\n  LEFT: null,\r\n  MID: null,\r\n  NUMBERVALUE: null,\r\n  PRONETIC: null,\r\n  PROPER: null,\r\n  REGEXEXTRACT: null,\r\n  REGEXMATCH: null,\r\n  REGREPLACE: null,\r\n  REPLACE: null,\r\n  REPT: null,\r\n  RIGHT: null,\r\n  SEARCH: null,\r\n  SPLIT: null,\r\n  SUBSTITUTE: null,\r\n  TEXT: null,\r\n  VALUE: null,\r\n  CHAR: {\r\n    func: CHAR,\r\n    options: {\r\n      paramsType: \"string\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"string\",\r\n    },\r\n  },\r\n  CODE: {\r\n    func: CODE,\r\n    options: {\r\n      paramsType: \"string\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  UNICHAR: {\r\n    func: UNICHAR,\r\n    options: {\r\n      paramsType: \"string\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"string\",\r\n    },\r\n  },\r\n  UNICODE: {\r\n    func: UNICODE,\r\n    options: {\r\n      paramsType: \"string\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  LEN: {\r\n    func: LEN,\r\n    options: {\r\n      paramsType: \"string\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  LOWER: {\r\n    func: LOWER,\r\n    options: {\r\n      paramsType: \"string\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"string\",\r\n    },\r\n  },\r\n  UPPER: {\r\n    func: UPPER,\r\n    options: {\r\n      paramsType: \"string\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"string\",\r\n    },\r\n  },\r\n  TRIM: {\r\n    func: TRIM,\r\n    options: {\r\n      paramsType: \"string\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"string\",\r\n    },\r\n  },\r\n  T: {\r\n    func: T,\r\n    options: {\r\n      paramsType: \"any\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"string\",\r\n    },\r\n  },\r\n};\r\n\r\nexport default textFormulas;\r\n", "import { parseNumberArray, MAX_PARAMS_COUNT } from \"@/util\";\r\nimport type { ResultType, MathFormulaType } from \"../types\";\r\nexport const ABS = (data: number): number => {\r\n  return Math.abs(data);\r\n};\r\nexport const ACOS = (data: number): number => {\r\n  return Math.acos(data);\r\n};\r\n\r\nexport const ACOSH = (data: number): number => {\r\n  return Math.log(data + Math.sqrt(data * data - 1));\r\n};\r\n\r\nexport const ACOT = (data: number): number => {\r\n  return Math.atan(1 / data);\r\n};\r\n\r\nexport const ACOTH = (data: number): number => {\r\n  return 0.5 * Math.log((data + 1) / (data - 1));\r\n};\r\nexport const ASIN = (data: number): number => {\r\n  return Math.asin(data);\r\n};\r\n\r\nexport const ASINH = (data: number): number => {\r\n  return Math.log(data + Math.sqrt(data * data + 1));\r\n};\r\nexport const ATAN = (data: number): number => Math.atan(data);\r\nexport const ATANH = (data: number): number =>\r\n  Math.log((1 + data) / (data + 1)) / 2;\r\nexport const COS = (data: number): number => Math.cos(data);\r\nexport const COT = (data: number): number => 1 / Math.tan(data);\r\nexport const CSC = (data: number): number => 1 / Math.sin(data);\r\nexport const DECIMAL = (data: string, radix: number): number =>\r\n  parseInt(data, radix);\r\nexport const DEGREES = (data: number): number => (data * 180) / Math.PI;\r\nexport const EXP = (data: number): number => Math.exp(data);\r\nexport const INT = (data: number): number => Math.floor(data);\r\nexport const LN10 = (): number => Math.log(10);\r\nexport const LN2 = (): number => Math.log(2);\r\nexport const LOG10E = (): number => Math.LOG10E;\r\nexport const LOG2E = (): number => Math.LOG2E;\r\nexport const LOG = (data: number, base = 10): number =>\r\n  Math.log(data) / Math.log(base);\r\nexport const LOG10 = (data: number): number => Math.log(data) / Math.log(10);\r\nexport const PI = (): number => Math.PI;\r\nexport const E = (): number => Math.E;\r\nexport const SIN = (data: number): number => Math.sin(data);\r\nexport const SUM = (...rest: Array<ResultType>): number => {\r\n  const list = parseNumberArray(rest);\r\n  return list.reduce((sum, cur) => sum + cur, 0);\r\n};\r\n\r\nconst formulas: MathFormulaType = {\r\n  ABS: {\r\n    func: ABS,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  ACOS: {\r\n    func: ACOS,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  ACOSH: {\r\n    func: ACOSH,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  ACOT: {\r\n    func: ACOT,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n\r\n  ACOTH: {\r\n    func: ACOTH,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n\r\n  ASIN: {\r\n    func: ASIN,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n\r\n  ASINH: {\r\n    func: ASINH,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  ATAN: {\r\n    func: ATAN,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  ATANH: {\r\n    func: ATANH,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  COT: {\r\n    func: COT,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  COS: {\r\n    func: COS,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  EXP: {\r\n    func: EXP,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  INT: {\r\n    func: INT,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  PI: {\r\n    func: PI,\r\n    options: {\r\n      paramsType: \"any\",\r\n      minParamsCount: 0,\r\n      maxParamsCount: 0,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  E: {\r\n    func: INT,\r\n    options: {\r\n      paramsType: \"any\",\r\n      minParamsCount: 0,\r\n      maxParamsCount: 0,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  SIN: {\r\n    func: SIN,\r\n    options: {\r\n      paramsType: \"number\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: 1,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n  SUM: {\r\n    func: SUM,\r\n    options: {\r\n      paramsType: \"any\",\r\n      minParamsCount: 1,\r\n      maxParamsCount: MAX_PARAMS_COUNT,\r\n      resultType: \"number\",\r\n    },\r\n  },\r\n};\r\n\r\nexport default formulas;\r\n", "import textFormulas from \"./text\";\r\nimport mathFormulas from \"./math\";\r\nimport type { FormulaType } from \"@/types\";\r\n\r\nexport type FormulasKeys = \"SUM\" | \"ABS\" | \"T\" | \"LOWER\";\r\n\r\nconst formulas: FormulaType = {\r\n  ...textFormulas,\r\n  ...mathFormulas,\r\n};\r\nexport default formulas;", "import { Range, parseReference, parseCell } from '@/util';\r\nimport {\r\n  TokenType,\r\n  FunctionMap,\r\n  CellDataMap,\r\n  ErrorTypes,\r\n  VariableMap,\r\n} from '@/types';\r\nimport type {\r\n  Visitor,\r\n  Expression,\r\n  CellRangeExpression,\r\n  PostUnaryExpression,\r\n} from './expression';\r\nimport {\r\n  BinaryExpression,\r\n  UnaryExpression,\r\n  CellExpression,\r\n  CallExpression,\r\n  LiteralExpression,\r\n  ErrorExpression,\r\n  DefineNameExpression,\r\n  GroupExpression,\r\n} from './expression';\r\nimport { CustomError } from './error';\r\nimport { Token } from './token';\r\n\r\nexport class Interpreter implements Visitor {\r\n  private readonly expressions: Expression[];\r\n  private readonly functionMap: FunctionMap;\r\n  private readonly cellDataMap: CellDataMap;\r\n  private readonly variableMap: VariableMap;\r\n  constructor(\r\n    expressions: Expression[],\r\n    functionMap: FunctionMap,\r\n    cellDataMap: CellDataMap,\r\n    variableMap: VariableMap,\r\n  ) {\r\n    this.expressions = expressions;\r\n    this.functionMap = functionMap;\r\n    this.cellDataMap = cellDataMap;\r\n    this.variableMap = variableMap;\r\n  }\r\n  interpret(): any {\r\n    const result: any[] = [];\r\n    for (const item of this.expressions) {\r\n      result.push(this.evaluate(item));\r\n    }\r\n    if (result.length === 1) {\r\n      return this.getRangeCellValue(result[0]);\r\n    } else {\r\n      throw new CustomError('#ERROR!');\r\n    }\r\n  }\r\n  private getRangeCellValue(value: any): any {\r\n    if (value instanceof Range) {\r\n      if (value.colCount === value.rowCount && value.colCount === 1) {\r\n        return this.cellDataMap.get(value.row, value.col, value.sheetId);\r\n      } else {\r\n        throw new CustomError('#REF!');\r\n      }\r\n    }\r\n    return value;\r\n  }\r\n  private checkNumber(value: any) {\r\n    if (typeof value !== 'number') {\r\n      throw new CustomError('#VALUE!');\r\n    }\r\n  }\r\n  visitBinaryExpression(data: BinaryExpression): any {\r\n    let left = this.evaluate(data.left);\r\n    let right = this.evaluate(data.right);\r\n    left = this.getRangeCellValue(left);\r\n    right = this.getRangeCellValue(right);\r\n    switch (data.operator.type) {\r\n      case TokenType.MINUS:\r\n        this.checkNumber(left);\r\n        this.checkNumber(right);\r\n        return left - right;\r\n      case TokenType.PLUS:\r\n        this.checkNumber(left);\r\n        this.checkNumber(right);\r\n        return left + right;\r\n      case TokenType.SLASH:\r\n        this.checkNumber(left);\r\n        this.checkNumber(right);\r\n        if (right === 0) {\r\n          throw new CustomError('#DIV/0!');\r\n        }\r\n        return left / right;\r\n      case TokenType.STAR:\r\n        this.checkNumber(left);\r\n        this.checkNumber(right);\r\n        return left * right;\r\n      case TokenType.EXPONENT:\r\n        this.checkNumber(left);\r\n        this.checkNumber(right);\r\n        return Math.pow(left, right);\r\n      case TokenType.EQUAL:\r\n        return left === right;\r\n      case TokenType.NOT_EQUAL:\r\n        return left !== right;\r\n      case TokenType.GREATER:\r\n        return left > right;\r\n      case TokenType.GREATER_EQUAL:\r\n        return left >= right;\r\n      case TokenType.LESS:\r\n        return left < right;\r\n      case TokenType.LESS_EQUAL:\r\n        return left <= right;\r\n      case TokenType.CONCATENATE:\r\n        return `${left}${right}`;\r\n      default:\r\n        throw new CustomError('#VALUE!');\r\n    }\r\n  }\r\n  visitCallExpression(expr: CallExpression) {\r\n    const callee: any = this.functionMap.get(expr.name.value);\r\n    if (callee && typeof callee === 'function') {\r\n      const params: any[] = [];\r\n      for (const item of expr.params) {\r\n        const t = this.evaluate(item);\r\n        if (t instanceof Range) {\r\n          const { row, col, rowCount, colCount, sheetId } = t;\r\n          for (let r = row, endRow = row + rowCount; r < endRow; r++) {\r\n            for (let c = col, endCol = col + colCount; c < endCol; c++) {\r\n              params.push(this.cellDataMap.get(r, c, sheetId));\r\n            }\r\n          }\r\n        } else {\r\n          params.push(t);\r\n        }\r\n      }\r\n      return callee(...params);\r\n    }\r\n    throw new CustomError('#NAME?');\r\n  }\r\n  visitCellExpression(data: CellExpression) {\r\n    const t = parseCell(data.value.value);\r\n    if (t === null) {\r\n      throw new CustomError('#REF!');\r\n    }\r\n    return t;\r\n  }\r\n  visitErrorExpression(data: ErrorExpression) {\r\n    throw new CustomError(data.value.value as ErrorTypes);\r\n  }\r\n  visitLiteralExpression(expr: LiteralExpression) {\r\n    const { type, value } = expr.value;\r\n    switch (type) {\r\n      case TokenType.STRING:\r\n        return value;\r\n      case TokenType.NUMBER:\r\n        return parseFloat(value);\r\n      case TokenType.TRUE:\r\n        return true;\r\n      case TokenType.FALSE:\r\n        return false;\r\n      default:\r\n        throw new CustomError('#ERROR!');\r\n    }\r\n  }\r\n  visitDefineNameExpression(expr: DefineNameExpression) {\r\n    if (!this.variableMap.has(expr.value.value)) {\r\n      throw new CustomError('#NAME?');\r\n    }\r\n    const result = this.variableMap.get(expr.value.value);\r\n    return result;\r\n  }\r\n  visitUnaryExpression(data: UnaryExpression): any {\r\n    const value = this.evaluate(data.right);\r\n    switch (data.operator.type) {\r\n      case TokenType.MINUS:\r\n        return -value;\r\n      case TokenType.PLUS:\r\n        return value;\r\n      default:\r\n        throw new CustomError('#VALUE!');\r\n    }\r\n  }\r\n  private convertToCellExpression(expr: Expression): CellExpression | null {\r\n    if (expr instanceof CellExpression) {\r\n      return expr;\r\n    }\r\n    if (expr instanceof DefineNameExpression) {\r\n      return new CellExpression(\r\n        new Token(TokenType.IDENTIFIER, expr.value.value.toUpperCase()),\r\n        'relative',\r\n        null,\r\n      );\r\n    }\r\n    if (expr instanceof LiteralExpression) {\r\n      if (\r\n        expr.value.type === TokenType.NUMBER &&\r\n        /^\\d+$/.test(expr.value.value)\r\n      ) {\r\n        return new CellExpression(\r\n          new Token(TokenType.IDENTIFIER, expr.value.value),\r\n          'relative',\r\n          null,\r\n        );\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  visitCellRangeExpression(expr: CellRangeExpression): any {\r\n    switch (expr.operator.type) {\r\n      case TokenType.COLON: {\r\n        const left = this.convertToCellExpression(expr.left);\r\n        const right = this.convertToCellExpression(expr.right);\r\n        if (left !== null && right !== null) {\r\n          const result = parseReference(\r\n            `${left.value.value}:${right.value.value}`,\r\n          );\r\n          if (result === null) {\r\n            throw new CustomError('#REF!');\r\n          }\r\n          return result;\r\n        } else {\r\n          throw new CustomError('#REF!');\r\n        }\r\n        break;\r\n      }\r\n      default:\r\n        throw new CustomError('#REF!');\r\n    }\r\n  }\r\n  visitGroupExpression(expr: GroupExpression): any {\r\n    return this.evaluate(expr.value);\r\n  }\r\n  visitPostUnaryExpression(expr: PostUnaryExpression): any {\r\n    const value = this.evaluate(expr.left);\r\n    switch (expr.operator.type) {\r\n      case TokenType.PERCENT:\r\n        this.checkNumber(value);\r\n        return value * 0.01;\r\n      default:\r\n        throw new CustomError('#VALUE!');\r\n    }\r\n  }\r\n  private evaluate(expr: Expression) {\r\n    return expr.accept(this);\r\n  }\r\n}\r\n", "import { Scanner } from './scanner';\r\nimport { Parser } from './parser';\r\nimport formulas from '../formula';\r\nimport { Interpreter } from './interpreter';\r\nimport {\r\n  FunctionMap,\r\n  CellDataMap,\r\n  InterpreterResult,\r\n  FormulaKeys,\r\n  VariableMap,\r\n} from '@/types';\r\nimport { CustomError } from './error';\r\nimport { isNumber, isString } from '@/util';\r\n\r\nexport function parseFormula(\r\n  source: string,\r\n  cellData: CellDataMap = new CellDataMapImpl(),\r\n  variableMap: VariableMap = new VariableMapImpl(),\r\n): InterpreterResult {\r\n  const func = new FunctionMapImpl();\r\n  const list = Object.keys(formulas) as Array<FormulaKeys>;\r\n  for (const key of list) {\r\n    func.set(key, (...args: any[]) => {\r\n      const item = formulas[key];\r\n      if (item === null) {\r\n        throw new CustomError('#NAME?');\r\n      }\r\n      const { func, options } = item;\r\n      const { paramsType, minParamsCount, maxParamsCount, resultType } =\r\n        options;\r\n      if (paramsType === 'number') {\r\n        if (!args.every(isNumber)) {\r\n          throw new CustomError('#VALUE!');\r\n        }\r\n      } else if (paramsType === 'string') {\r\n        if (!args.every(isString)) {\r\n          throw new CustomError('#VALUE!');\r\n        }\r\n      }\r\n      if (args.length > maxParamsCount || args.length < minParamsCount) {\r\n        throw new CustomError('#VALUE!');\r\n      }\r\n      const result = func(...args);\r\n      if (resultType === 'number') {\r\n        if (!isNumber(result)) {\r\n          throw new CustomError('#NUM!');\r\n        }\r\n      } else if (resultType === 'string') {\r\n        if (!isString(result)) {\r\n          throw new CustomError('#NUM!');\r\n        }\r\n      }\r\n      return result;\r\n    });\r\n  }\r\n  return interpret(source, func, cellData, variableMap);\r\n}\r\n\r\nfunction interpret(\r\n  source: string,\r\n  func: FunctionMap,\r\n  cellData: CellDataMap,\r\n  variableMap: VariableMap,\r\n): InterpreterResult {\r\n  try {\r\n    const list = new Scanner(source).scan();\r\n    const expressions = new Parser(list).parse();\r\n    const result = new Interpreter(\r\n      expressions,\r\n      func,\r\n      cellData,\r\n      variableMap,\r\n    ).interpret();\r\n    return {\r\n      result: result,\r\n      error: null,\r\n    };\r\n  } catch (error) {\r\n    if (error instanceof CustomError) {\r\n      return {\r\n        result: null,\r\n        error: error.value,\r\n      };\r\n    }\r\n  }\r\n  return {\r\n    result: null,\r\n    error: '#ERROR!',\r\n  };\r\n}\r\n\r\nexport class FunctionMapImpl implements FunctionMap {\r\n  private readonly map = new Map<string, any>();\r\n  set(name: string, value: (...list: any[]) => any) {\r\n    this.map.set(name.toLowerCase(), value);\r\n  }\r\n  get(name: string) {\r\n    return this.map.get(name.toLowerCase());\r\n  }\r\n}\r\n\r\nexport class CellDataMapImpl implements CellDataMap {\r\n  private readonly map = new Map<string, any>();\r\n  private getKey(row: number, col: number, sheetId: string = '') {\r\n    const key = `${row}_${col}_${sheetId}`;\r\n    return key;\r\n  }\r\n  set(row: number, col: number, sheetId: string, value: any): void {\r\n    const key = this.getKey(row, col, sheetId);\r\n    this.map.set(key, value);\r\n  }\r\n  get(row: number, col: number, sheetId: string = ''): any {\r\n    const key = this.getKey(row, col, sheetId);\r\n    return this.map.get(key);\r\n  }\r\n}\r\n\r\nexport class VariableMapImpl implements VariableMap {\r\n  private readonly map = new Map<string, any>();\r\n  set(name: string, value: any): void {\r\n    this.map.set(name, value);\r\n  }\r\n  get(name: string): any {\r\n    return this.map.get(name);\r\n  }\r\n  has(name: string): boolean {\r\n    return this.map.has(name);\r\n  }\r\n}\r\n", "import { isEmpty, get, setWith } from '@/lodash';\r\nimport {\r\n  StyleType,\r\n  QueryCellResult,\r\n  WorkBookJSON,\r\n  WorksheetType,\r\n  Coordinate,\r\n  ModelCellType,\r\n  IModel,\r\n  ResultType,\r\n} from '@/types';\r\nimport {\r\n  getDefaultSheetInfo,\r\n  assert,\r\n  modelLog,\r\n  Range,\r\n  getListMaxNum,\r\n  STYLE_ID_PREFIX,\r\n  intToColumnName,\r\n  DEFAULT_ROW_COUNT,\r\n  DEFAULT_COL_COUNT,\r\n} from '@/util';\r\nimport { parseFormula } from '@/parser';\r\n\r\n// const XLSX_MAX_COL_COUNT = 16384; // XFD\r\n// const XLSX_MAX_ROW_COUNT = 1048575; // XFD\r\n\r\nexport class Model implements IModel {\r\n  private currentSheetId = '';\r\n  private workbook: WorkBookJSON['workbook'] = [];\r\n  private worksheets: WorkBookJSON['worksheets'] = {};\r\n  private styles: WorkBookJSON['styles'] = {};\r\n  private mergeCells: WorkBookJSON['mergeCells'] = [];\r\n  getSheetList(): WorkBookJSON['workbook'] {\r\n    return this.workbook;\r\n  }\r\n  setActiveCell(row: number, col: number): void {\r\n    const index = this.workbook.findIndex(\r\n      (v) => v.sheetId === this.currentSheetId,\r\n    );\r\n    if (index >= 0) {\r\n      const tempList = Array.from(this.workbook);\r\n      const activeCell = `${intToColumnName(col)}${row + 1}`;\r\n      tempList.splice(index, 1, { ...this.workbook[index], activeCell });\r\n      this.workbook = tempList;\r\n    }\r\n  }\r\n  addSheet(): void {\r\n    const item = getDefaultSheetInfo(this.workbook);\r\n    this.workbook = [\r\n      ...this.workbook,\r\n      { ...item, colCount: DEFAULT_COL_COUNT, rowCount: DEFAULT_ROW_COUNT },\r\n    ];\r\n    this.currentSheetId = item.sheetId;\r\n  }\r\n  getSheetInfo(id: string = this.currentSheetId): WorksheetType {\r\n    const item = this.workbook.find((item) => item.sheetId === id);\r\n    assert(item !== undefined);\r\n    return item;\r\n  }\r\n  setCurrentSheetId(id: string): void {\r\n    this.currentSheetId = id;\r\n  }\r\n  getCurrentSheetId(): string {\r\n    return this.currentSheetId;\r\n  }\r\n  getCellsContent(): Array<Coordinate> {\r\n    const sheetData = this.worksheets[this.currentSheetId];\r\n    if (isEmpty(sheetData)) {\r\n      return [];\r\n    }\r\n    const result = [];\r\n    const rowKeys = Object.keys(sheetData);\r\n    for (const rowKey of rowKeys) {\r\n      const colKeys = Object.keys(sheetData[rowKey]);\r\n      for (const colKey of colKeys) {\r\n        const row = Number(rowKey);\r\n        const col = Number(colKey);\r\n        result.push({\r\n          row,\r\n          col,\r\n        });\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  fromJSON(json: WorkBookJSON): void {\r\n    modelLog('fromJSON', json);\r\n    const {\r\n      worksheets = {},\r\n      workbook = [],\r\n      styles = {},\r\n      mergeCells = [],\r\n    } = json;\r\n    this.worksheets = worksheets;\r\n    this.workbook = workbook;\r\n    this.styles = styles;\r\n    this.currentSheetId = workbook[0].sheetId || this.currentSheetId;\r\n    this.mergeCells = mergeCells;\r\n    this.computeAllCell();\r\n  }\r\n  toJSON(): WorkBookJSON {\r\n    const { worksheets, styles, workbook, mergeCells } = this;\r\n    return {\r\n      workbook,\r\n      styles,\r\n      worksheets,\r\n      mergeCells,\r\n    };\r\n  }\r\n\r\n  private setCellValue(value: ResultType, range: Range): void {\r\n    const { row, col } = range;\r\n    const configPath = `worksheets[${\r\n      range.sheetId || this.currentSheetId\r\n    }][${row}][${col}]`;\r\n    setWith(this, `${configPath}.value`, value);\r\n  }\r\n  private setCellFormula(formula: string, range: Range): void {\r\n    const { row, col } = range;\r\n    const configPath = `worksheets[${\r\n      range.sheetId || this.currentSheetId\r\n    }][${row}][${col}]`;\r\n    setWith(this, `${configPath}.formula`, formula);\r\n  }\r\n  setCellValues(value: string, ranges: Range[]): void {\r\n    const [range] = ranges;\r\n    if (value.startsWith('=')) {\r\n      this.setCellFormula(value, range);\r\n    } else {\r\n      this.setCellFormula('', range);\r\n      this.setCellValue(value, range);\r\n    }\r\n    this.computeAllCell();\r\n  }\r\n  setCellStyle(style: Partial<StyleType>, ranges: Range[]): void {\r\n    const [range] = ranges;\r\n    const { row, col, rowCount, colCount } = range;\r\n    for (let r = row, endRow = row + rowCount; r < endRow; r++) {\r\n      for (let c = col, endCol = col + colCount; c < endCol; c++) {\r\n        const stylePath = `worksheets[${this.currentSheetId}][${r}][${c}].style`;\r\n        const oldStyleId = get<string>(this, stylePath, '');\r\n        if (oldStyleId) {\r\n          const oldStyle = this.styles[oldStyleId];\r\n          if (isEmpty(oldStyle)) {\r\n            this.styles[oldStyleId] = { ...style };\r\n          } else {\r\n            this.styles[oldStyleId] = {\r\n              ...oldStyle,\r\n              ...style,\r\n            };\r\n          }\r\n        } else {\r\n          const styleNum = getListMaxNum(\r\n            Object.keys(this.styles),\r\n            STYLE_ID_PREFIX,\r\n          );\r\n          const styleId = `${STYLE_ID_PREFIX}${styleNum + 1}`;\r\n          this.styles[styleId] = { ...style };\r\n          setWith(this, stylePath, styleId);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  queryCell = (\r\n    row: number,\r\n    col: number,\r\n    sheetId: string = '',\r\n  ): QueryCellResult => {\r\n    const realSheetId = sheetId || this.currentSheetId;\r\n    const cellData = get<ModelCellType>(\r\n      this,\r\n      `worksheets[${realSheetId}][${row}][${col}]`,\r\n      {},\r\n    );\r\n    const { style } = cellData;\r\n    let temp = undefined;\r\n    if (style && this.styles[style]) {\r\n      temp = this.styles[style];\r\n    }\r\n    return { ...cellData, style: temp };\r\n  };\r\n  private computeAllCell() {\r\n    const sheetData = this.worksheets[this.currentSheetId];\r\n    if (isEmpty(sheetData)) {\r\n      return [];\r\n    }\r\n    const rowKeys = Object.keys(sheetData);\r\n    for (const rowKey of rowKeys) {\r\n      const colKeys = Object.keys(sheetData[rowKey]);\r\n      for (const colKey of colKeys) {\r\n        const temp = sheetData[rowKey][colKey];\r\n        if (temp?.formula) {\r\n          temp.value = this.parseFormula(temp.formula);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  private parseFormula(formula: string) {\r\n    const result = parseFormula(formula, {\r\n      get: (row: number, col: number, sheetId: string) => {\r\n        const temp = this.queryCell(row, col, sheetId);\r\n        return temp.value;\r\n      },\r\n      set: () => {},\r\n    });\r\n    return result.error ? result.error : result.result;\r\n  }\r\n  addRow(rowIndex: number, count: number): void {\r\n    const sheetData = this.worksheets[this.currentSheetId];\r\n    if (isEmpty(sheetData)) {\r\n      return;\r\n    }\r\n    const rowKeys = Object.keys(sheetData);\r\n    for (let i = rowKeys.length - 1; i >= 0; i--) {\r\n      const rowKey = rowKeys[i];\r\n      const item = Number(rowKeys[i]);\r\n      if (item < rowIndex) {\r\n        continue;\r\n      }\r\n      const key = String(item + count);\r\n      sheetData[key] = {\r\n        ...sheetData[rowKey],\r\n      };\r\n      sheetData[rowKey] = {};\r\n    }\r\n    const sheetInfo = this.getSheetInfo();\r\n    sheetInfo.rowCount += count;\r\n  }\r\n  addCol(colIndex: number, count: number): void {\r\n    const sheetData = this.worksheets[this.currentSheetId];\r\n    if (isEmpty(sheetData)) {\r\n      return;\r\n    }\r\n    const sheetInfo = this.getSheetInfo();\r\n\r\n    const rowKeys = Object.keys(sheetData);\r\n    for (const rowKey of rowKeys) {\r\n      const colKeys = Object.keys(sheetData[rowKey]);\r\n      for (let i = colKeys.length - 1; i >= 0; i--) {\r\n        const colKey = colKeys[i];\r\n        const col = Number(colKey);\r\n        if (col < colIndex) {\r\n          continue;\r\n        }\r\n        const key = String(col + count);\r\n        sheetData[rowKey][key] = {\r\n          ...sheetData[rowKey][colKey],\r\n        };\r\n        sheetData[rowKey][colKey] = {};\r\n      }\r\n    }\r\n\r\n    sheetInfo.colCount += count;\r\n  }\r\n}\r\n", "import { WorkBookJSON } from '@/types';\r\nimport { DEFAULT_ROW_COUNT, DEFAULT_COL_COUNT } from '@/util';\r\n\r\nexport const MOCK_MODEL: WorkBookJSON = {\r\n  workbook: [\r\n    {\r\n      sheetId: 'Sheet1',\r\n      name: 'Sheet1',\r\n      activeCell: 'B2',\r\n      colCount: DEFAULT_COL_COUNT,\r\n      rowCount: DEFAULT_ROW_COUNT,\r\n    },\r\n    {\r\n      sheetId: '2',\r\n      name: 'test',\r\n      colCount: DEFAULT_COL_COUNT,\r\n      rowCount: DEFAULT_ROW_COUNT,\r\n      activeCell: 'F5',\r\n    },\r\n  ],\r\n  worksheets: {\r\n    Sheet1: {\r\n      '0': {\r\n        '0': {\r\n          value: '',\r\n          formula: '=SUM(1, SUM(1,2))',\r\n          style: '1',\r\n        },\r\n        '1': {\r\n          value: '',\r\n          formula: '=SUM(1,4)',\r\n        },\r\n        '2': {\r\n          value: '',\r\n          formula: '=SUM(A1)',\r\n          style: '2',\r\n        },\r\n        '3': {\r\n          value: '\u8D85\u5927\u5B57',\r\n          style: '3',\r\n        },\r\n        4: {\r\n          value: '\u8FD9\u662F\u4E00\u6BB5\u975E\u5E38\u957F\u7684\u6587\u6848\uFF0C\u9700\u8981\u6362\u884C\u5C55\u793A',\r\n          style: '4',\r\n        },\r\n      },\r\n      '3': {\r\n        0: {\r\n          style: 'style1',\r\n        },\r\n        1: {\r\n          style: 'style1',\r\n        },\r\n        2: {\r\n          style: 'style1',\r\n        },\r\n        3: {\r\n          style: 'style1',\r\n        },\r\n      },\r\n      '4': {\r\n        0: {\r\n          style: 'style1',\r\n        },\r\n        1: {\r\n          style: 'style1',\r\n        },\r\n        2: {\r\n          style: 'style1',\r\n        },\r\n        3: {\r\n          style: 'style1',\r\n        },\r\n      },\r\n    },\r\n  },\r\n  styles: {\r\n    '1': {\r\n      fontColor: '#ff0000',\r\n    },\r\n    '2': {},\r\n    style1: {\r\n      fillColor: 'red',\r\n    },\r\n    '3': {\r\n      // fontSize: 36,\r\n    },\r\n    4: {\r\n      // wrapText: EWrap.AUTO_WRAP,\r\n    },\r\n  },\r\n  mergeCells: ['D2:E3'],\r\n};\r\n", "import { dpr, resizeCanvas, npx } from \"@/util\";\r\nimport {\r\n  EventType,\r\n  IWindowSize,\r\n  ContentView,\r\n} from \"@/types\";\r\n\r\nexport class MainCanvas implements ContentView {\r\n  private ctx: CanvasRenderingContext2D;\r\n  private content: ContentView;\r\n  private selection: ContentView;\r\n  private canvas: HTMLCanvasElement;\r\n  private canvasSize: IWindowSize = {\r\n    width: 0,\r\n    height: 0,\r\n  };\r\n  constructor(\r\n    canvas: HTMLCanvasElement,\r\n    content: ContentView,\r\n    selection: ContentView\r\n  ) {\r\n    this.canvas = canvas;\r\n    this.ctx = canvas.getContext(\"2d\")!;\r\n    this.content = content;\r\n    this.selection = selection;\r\n    const size = dpr();\r\n    this.ctx.scale(size, size);\r\n  }\r\n  getCanvas() {\r\n    return this.canvas;\r\n  }\r\n  resize(width: number, height: number) {\r\n    this.canvasSize = {\r\n      width,\r\n      height,\r\n    };\r\n    resizeCanvas(this.canvas, width, height);\r\n    this.content.resize(width, height);\r\n    this.selection.resize(width, height);\r\n  }\r\n  private clear() {\r\n    this.ctx.clearRect(\r\n      0,\r\n      0,\r\n      npx(this.canvasSize.width),\r\n      npx(this.canvasSize.height)\r\n    );\r\n  }\r\n  render = (params: EventType): void => {\r\n    if (params.changeSet.size === 0) {\r\n      return;\r\n    }\r\n    this.content.render(params);\r\n    this.selection.render(params);\r\n    this.clear();\r\n    this.ctx.drawImage(this.content.getCanvas(), 0, 0);\r\n    this.ctx.drawImage(this.selection.getCanvas(), 0, 0);\r\n  };\r\n}\r\n", "import { StoreValue, IController, ScrollValue } from '@/types';\r\nimport { FORMULA_EDITOR_ID, DOUBLE_CLICK_TIME, SCROLL_SIZE } from '@/util';\r\nimport { debounce } from '@/lodash';\r\n\r\ninterface IHitInfo {\r\n  width: number;\r\n  height: number;\r\n  x: number;\r\n  y: number;\r\n  row: number;\r\n  col: number;\r\n  pageX: number;\r\n  pageY: number;\r\n}\r\n\r\nfunction getHitInfo(\r\n  event: MouseEvent,\r\n  controller: IController,\r\n  canvasSize: DOMRect,\r\n): IHitInfo | null {\r\n  const scroll = controller.getScroll();\r\n  const sheetInfo = controller.getSheetInfo();\r\n  const headerSize = controller.getHeaderSize();\r\n  const { pageX, pageY } = event;\r\n  const x = pageX - canvasSize.left;\r\n  const y = pageY - canvasSize.top;\r\n  let resultX = headerSize.width;\r\n  let resultY = headerSize.height;\r\n  let row = scroll.row;\r\n  let col = scroll.col;\r\n  while (resultX + controller.getColWidth(col) <= x) {\r\n    resultX += controller.getColWidth(col);\r\n    col++;\r\n  }\r\n  while (resultY + controller.getRowHeight(row) <= y) {\r\n    resultY += controller.getRowHeight(row);\r\n    row++;\r\n  }\r\n  if (row >= sheetInfo.rowCount || col >= sheetInfo.colCount) {\r\n    return null;\r\n  }\r\n  const cellSize = controller.getCellSize(row, col);\r\n  return { ...cellSize, row, col, pageY, pageX, x, y };\r\n}\r\n\r\nconst BOTTOM_BUFF = 100;\r\n\r\nexport function registerEvents(\r\n  stateValue: StoreValue,\r\n  controller: IController,\r\n  canvas: HTMLCanvasElement,\r\n  resizeWindow: () => void,\r\n): void {\r\n  let lastTimeStamp = 0;\r\n  const inputDom = document.querySelector<HTMLInputElement>(\r\n    `#${FORMULA_EDITOR_ID}`,\r\n  )!;\r\n  window.addEventListener('resize', () => {\r\n    resizeWindow();\r\n  });\r\n  window.addEventListener('keydown', function (event) {\r\n    if (event.key === 'Enter') {\r\n      controller.setActiveCell(\r\n        stateValue.activeCell.row + 1,\r\n        stateValue.activeCell.col,\r\n        1,\r\n        1,\r\n      );\r\n    } else if (event.key === 'Tab') {\r\n      controller.setActiveCell(\r\n        stateValue.activeCell.row,\r\n        stateValue.activeCell.col + 1,\r\n        1,\r\n        1,\r\n      );\r\n    }\r\n    if (inputDom === event.target) {\r\n      return;\r\n    }\r\n    stateValue.isCellEditing = true;\r\n    inputDom.focus();\r\n  });\r\n\r\n  document.body.addEventListener(\r\n    'wheel',\r\n    debounce((event) => {\r\n      if (event.target !== canvas) {\r\n        return;\r\n      }\r\n      const headerSize = controller.getHeaderSize();\r\n      const canvasRect = canvas.getBoundingClientRect();\r\n      const sheetInfo = controller.getSheetInfo();\r\n      const viewSize = controller.getViewSize();\r\n      const oldScroll = controller.getScroll();\r\n\r\n      const maxHeight = viewSize.height - canvasRect.height + BOTTOM_BUFF;\r\n      const maxWidth = viewSize.width - canvasRect.width + BOTTOM_BUFF;\r\n\r\n      const maxScrollHeight =\r\n        canvasRect.height - headerSize.height - SCROLL_SIZE * 1.5;\r\n      const maxScrollWidth =\r\n        canvasRect.width - headerSize.width - SCROLL_SIZE * 1.5;\r\n      let top = oldScroll.top + event.deltaY;\r\n      if (top < 0) {\r\n        top = 0;\r\n      } else if (top > maxHeight) {\r\n        top = maxHeight;\r\n      }\r\n\r\n      let left = oldScroll.left + event.deltaX;\r\n      if (left < 0) {\r\n        left = 0;\r\n      } else if (left > maxWidth) {\r\n        left = maxWidth;\r\n      }\r\n\r\n      let resultX = 0;\r\n      let resultY = 0;\r\n      let r = 0;\r\n      let c = 0;\r\n      while (resultX < left && c < sheetInfo.colCount) {\r\n        resultX += controller.getColWidth(c);\r\n        c++;\r\n      }\r\n      while (resultY < top && r < sheetInfo.rowCount) {\r\n        resultY += controller.getRowHeight(r);\r\n        r++;\r\n      }\r\n\r\n      const scrollTop = (top * maxScrollHeight) / maxHeight;\r\n      const scrollLeft = (left * maxScrollWidth) / maxWidth;\r\n      controller.setScroll({\r\n        top: top,\r\n        left: left,\r\n        row: r,\r\n        col: c,\r\n        scrollLeft,\r\n        scrollTop,\r\n      });\r\n    }),\r\n  );\r\n\r\n  canvas.addEventListener('mousedown', (event) => {\r\n    const headerSize = controller.getHeaderSize();\r\n    stateValue.contextMenuPosition = undefined;\r\n    const canvasRect = canvas.getBoundingClientRect();\r\n    const { timeStamp, clientX, clientY } = event;\r\n    const x = clientX - canvasRect.left;\r\n    const y = clientY - canvasRect.top;\r\n    const position = getHitInfo(event, controller, canvasRect);\r\n    if (!position) {\r\n      return;\r\n    }\r\n    if (headerSize.width > x && headerSize.height > y) {\r\n      controller.selectAll(0, 0);\r\n      return;\r\n    }\r\n    if (headerSize.width > x && headerSize.height <= y) {\r\n      controller.selectRow(position.row, position.col);\r\n      return;\r\n    }\r\n    if (headerSize.width <= x && headerSize.height > y) {\r\n      controller.selectCol(position.row, position.col);\r\n      return;\r\n    }\r\n    const activeCell = controller.getActiveCell();\r\n    const check =\r\n      activeCell.row >= 0 &&\r\n      activeCell.row === position.row &&\r\n      activeCell.col === position.col;\r\n    if (!check) {\r\n      controller.setActiveCell(position.row, position.col, 1, 1);\r\n    }\r\n    const delay = timeStamp - lastTimeStamp;\r\n    if (delay < DOUBLE_CLICK_TIME) {\r\n      stateValue.isCellEditing = true;\r\n    }\r\n    lastTimeStamp = timeStamp;\r\n  });\r\n\r\n  canvas.addEventListener('mousemove', (event) => {\r\n    const headerSize = controller.getHeaderSize();\r\n    const rect = canvas.getBoundingClientRect();\r\n    const { clientX, clientY } = event;\r\n    const x = clientX - rect.left;\r\n    const y = clientY - rect.top;\r\n    const checkMove =\r\n      x > headerSize.width && y > headerSize.height && event.buttons === 1;\r\n    if (checkMove) {\r\n      const position = getHitInfo(event, controller, rect);\r\n      if (!position) {\r\n        return;\r\n      }\r\n      controller.updateSelection(position.row, position.col);\r\n    }\r\n  });\r\n  canvas.addEventListener('contextmenu', (event) => {\r\n    event.preventDefault();\r\n    stateValue.contextMenuPosition = {\r\n      top: event.clientY,\r\n      left: event.clientX,\r\n      width: 100,\r\n      height: 100,\r\n    };\r\n    return false;\r\n  });\r\n}\r\n", "import {\r\n  npx,\r\n  DEFAULT_FONT_CONFIG,\r\n  isNumber,\r\n  DEFAULT_FONT_SIZE,\r\n  DEFAULT_FONT_COLOR,\r\n  makeFont,\r\n  assert,\r\n  ERROR_SET,\r\n  ERROR_FORMULA_COLOR,\r\n  isTestEnv,\r\n} from '@/util';\r\nimport { isEmpty } from '@/lodash';\r\nimport { CellInfo, ErrorTypes, EWrap, Point } from '@/types';\r\n\r\nexport const getStyle = (\r\n  key: 'lineHeight' | 'letterSpacing',\r\n  dom: HTMLElement = document.body,\r\n): number => {\r\n  if (isTestEnv()) {\r\n    return 20;\r\n  }\r\n  return parseInt(window.getComputedStyle(dom)[key]);\r\n};\r\n\r\nconst measureTextMap = new Map<string, TextMetrics>();\r\n\r\nexport function measureText(ctx: CanvasRenderingContext2D, char: string) {\r\n  const mapKey = `${char}__${ctx.font}`;\r\n  let temp = measureTextMap.get(mapKey);\r\n  if (!temp) {\r\n    const metrics = ctx.measureText(char);\r\n    measureTextMap.set(mapKey, metrics);\r\n    temp = metrics;\r\n  }\r\n  return temp;\r\n}\r\n\r\nexport function fillRect(\r\n  ctx: CanvasRenderingContext2D,\r\n  x: number,\r\n  y: number,\r\n  width: number,\r\n  height: number,\r\n): void {\r\n  ctx.fillRect(npx(x), npx(y), npx(width), npx(height));\r\n}\r\nexport function strokeRect(\r\n  ctx: CanvasRenderingContext2D,\r\n  x: number,\r\n  y: number,\r\n  width: number,\r\n  height: number,\r\n): void {\r\n  ctx.strokeRect(npx(x), npx(y), npx(width), npx(height));\r\n}\r\n\r\nfunction getFontSizeHeight(ctx: CanvasRenderingContext2D, char: string) {\r\n  const { actualBoundingBoxDescent, actualBoundingBoxAscent } = measureText(\r\n    ctx,\r\n    char,\r\n  );\r\n  const result = actualBoundingBoxDescent + actualBoundingBoxAscent;\r\n  return Math.ceil(result);\r\n}\r\n\r\nexport function fillText(\r\n  ctx: CanvasRenderingContext2D,\r\n  text: string,\r\n  x: number,\r\n  y: number,\r\n) {\r\n  ctx.fillText(text, npx(x), npx(y));\r\n}\r\n\r\nexport function fillWrapText(\r\n  ctx: CanvasRenderingContext2D,\r\n  text: string,\r\n  x: number,\r\n  y: number,\r\n  cellWidth: number,\r\n  lineHeight: number,\r\n): number {\r\n  let line = '';\r\n  const textList = text.split('');\r\n  let testWidth = 0;\r\n  const realCellWidth = cellWidth * 2;\r\n  let wrapHeight = lineHeight;\r\n  y += lineHeight / 2;\r\n  for (let i = 0; i < textList.length; i++) {\r\n    const char = textList[i];\r\n    const { width } = measureText(ctx, char);\r\n    if (testWidth + width > realCellWidth) {\r\n      fillText(ctx, line, x, y);\r\n      line = char;\r\n      y += lineHeight;\r\n      testWidth = width;\r\n      wrapHeight += lineHeight;\r\n    } else {\r\n      testWidth += width;\r\n      line = line + char;\r\n    }\r\n  }\r\n  if (line) {\r\n    fillText(ctx, line, x, y);\r\n  }\r\n  return wrapHeight;\r\n}\r\n\r\nexport function fillTexts(\r\n  ctx: CanvasRenderingContext2D,\r\n  text: string,\r\n  x: number,\r\n  y: number,\r\n  cellWidth: number,\r\n) {\r\n  let line = '';\r\n  const textList = text.split('');\r\n  let testWidth = 0;\r\n  const realCellWidth = cellWidth * 2;\r\n  let textWidth = 0;\r\n  for (let i = 0; i < textList.length; i++) {\r\n    const char = textList[i];\r\n    const { width } = measureText(ctx, char);\r\n    if (testWidth + width > realCellWidth) {\r\n      if (i === 0) {\r\n        textWidth = width;\r\n        line = char;\r\n      }\r\n      break;\r\n    } else {\r\n      testWidth += width;\r\n      line = line + char;\r\n    }\r\n  }\r\n  fillText(ctx, line, x, y);\r\n  return textWidth;\r\n}\r\n\r\ninterface IRenderCellResult {\r\n  wrapHeight?: number;\r\n  fontSizeHeight?: number;\r\n  textWidth?: number;\r\n}\r\n\r\nexport function renderCell(\r\n  ctx: CanvasRenderingContext2D,\r\n  cellInfo: CellInfo & {\r\n    left: number;\r\n    top: number;\r\n    width: number;\r\n    height: number;\r\n  },\r\n  canvasLineHeight: number,\r\n): IRenderCellResult {\r\n  const { style, value, left, top, width, height } = cellInfo;\r\n  const isNum = isNumber(value);\r\n  let font = DEFAULT_FONT_CONFIG;\r\n  let fillStyle = DEFAULT_FONT_COLOR;\r\n  if (!isEmpty(style)) {\r\n    const fontSize = npx(style?.fontSize ? style.fontSize : DEFAULT_FONT_SIZE);\r\n    font = makeFont(\r\n      style?.isItalic ? 'italic' : 'normal',\r\n      style?.isBold ? 'bold' : '500',\r\n      fontSize,\r\n      style?.fontFamily,\r\n    );\r\n    fillStyle = style?.fontColor || DEFAULT_FONT_COLOR;\r\n    if (style?.fillColor) {\r\n      ctx.fillStyle = style?.fillColor;\r\n      fillRect(ctx, left, top, width, height);\r\n    }\r\n  }\r\n  let text = String(value);\r\n  if (ERROR_SET.has(text as ErrorTypes)) {\r\n    fillStyle = ERROR_FORMULA_COLOR;\r\n  } else if (\r\n    typeof value === 'boolean' ||\r\n    ['TRUE', 'FALSE'].includes(text.toUpperCase())\r\n  ) {\r\n    text = text.toUpperCase();\r\n  } else if (value === undefined || value === null) {\r\n    text = '';\r\n  }\r\n\r\n  ctx.textAlign = isNum ? 'right' : 'left';\r\n  ctx.font = font;\r\n  ctx.fillStyle = fillStyle;\r\n  ctx.textBaseline = 'middle';\r\n  const x = left + (isNum ? width : 0);\r\n  const result: IRenderCellResult = {};\r\n  const fontSizeHeight = getFontSizeHeight(ctx, text[0]);\r\n  const textHeight = Math.max(\r\n    fontSizeHeight,\r\n    canvasLineHeight,\r\n    getStyle('lineHeight'),\r\n  );\r\n  if (style?.wrapText === EWrap.AUTO_WRAP) {\r\n    const y = top;\r\n    result.wrapHeight = fillWrapText(ctx, text, x, y, width, textHeight);\r\n  } else {\r\n    const y = Math.floor(top + height / 2);\r\n    result.textWidth = fillTexts(ctx, text, x, y, width);\r\n  }\r\n  return {\r\n    ...result,\r\n    fontSizeHeight: textHeight,\r\n  };\r\n}\r\n\r\nexport function drawLines(\r\n  ctx: CanvasRenderingContext2D,\r\n  pointList: Array<Point>,\r\n): void {\r\n  assert(pointList.length > 0);\r\n  ctx.beginPath();\r\n  for (let i = 0; i < pointList.length; i += 2) {\r\n    const first = pointList[i];\r\n    const second = pointList[i + 1];\r\n    ctx.moveTo(npx(first[0]), npx(first[1]));\r\n    ctx.lineTo(npx(second[0]), npx(second[1]));\r\n  }\r\n  ctx.stroke();\r\n}\r\n\r\nexport function drawTriangle(\r\n  ctx: CanvasRenderingContext2D,\r\n  point1: Point,\r\n  point2: Point,\r\n  point3: Point,\r\n) {\r\n  ctx.beginPath();\r\n  ctx.moveTo(npx(point1[0]), npx(point1[1]));\r\n  ctx.lineTo(npx(point2[0]), npx(point2[1]));\r\n  ctx.lineTo(npx(point3[0]), npx(point3[1]));\r\n  ctx.fill();\r\n}\r\n\r\n\r\n", "import { dpr, npx, resizeCanvas, assert, isCol, isRow, isSheet } from '@/util';\r\nimport theme from '@/theme';\r\nimport { fillRect, renderCell, getStyle, strokeRect } from './util';\r\nimport type { ContentView, IController, IWindowSize } from '@/types';\r\n\r\nexport class Selection implements ContentView {\r\n  private canvas: HTMLCanvasElement;\r\n  private ctx: CanvasRenderingContext2D;\r\n  private controller: IController;\r\n  private canvasSize: IWindowSize = {\r\n    width: 0,\r\n    height: 0,\r\n  };\r\n  constructor(controller: IController, canvas: HTMLCanvasElement) {\r\n    this.controller = controller;\r\n    this.canvas = canvas;\r\n    const ctx = this.canvas.getContext('2d')!;\r\n    this.ctx = ctx;\r\n    const size = dpr();\r\n    this.ctx.scale(size, size);\r\n  }\r\n  getCanvas() {\r\n    return this.canvas;\r\n  }\r\n  resize(width: number, height: number) {\r\n    this.canvasSize = {\r\n      width,\r\n      height,\r\n    };\r\n    resizeCanvas(this.canvas, width, height);\r\n  }\r\n  private clear() {\r\n    this.ctx.clearRect(\r\n      0,\r\n      0,\r\n      npx(this.canvasSize.width),\r\n      npx(this.canvasSize.height),\r\n    );\r\n  }\r\n\r\n  render(): void {\r\n    this.clear();\r\n    const { controller } = this;\r\n    const ranges = controller.getRanges();\r\n    const [range] = ranges;\r\n    if (isSheet(range)) {\r\n      this.renderSelectAll();\r\n      return;\r\n    }\r\n    if (isCol(range)) {\r\n      this.renderSelectCol();\r\n      return;\r\n    }\r\n    if (isRow(range)) {\r\n      this.renderSelectRow();\r\n      return;\r\n    }\r\n    this.renderSelectRange();\r\n  }\r\n  private renderSelectRange() {\r\n    const { controller } = this;\r\n    const headerSize = controller.getHeaderSize();\r\n    const ranges = controller.getRanges();\r\n    const [range] = ranges;\r\n    const activeCell = controller.computeCellPosition(range.row, range.col);\r\n    const endCellRow = range.row + range.rowCount - 1;\r\n    const endCellCol = range.col + range.colCount - 1;\r\n    assert(endCellRow >= 0 && endCellCol >= 0);\r\n    const endCell = controller.computeCellPosition(endCellRow, endCellCol);\r\n    const width = endCell.left + endCell.width - activeCell.left;\r\n    const height = endCell.top + endCell.height - activeCell.top;\r\n\r\n    this.ctx.fillStyle = theme.selectionColor;\r\n\r\n    fillRect(this.ctx, activeCell.left, 0, width, headerSize.height);\r\n    fillRect(this.ctx, 0, activeCell.top, headerSize.width, height);\r\n\r\n    this.ctx.strokeStyle = theme.primaryColor;\r\n    this.ctx.lineWidth = dpr();\r\n\r\n    assert(width >= 0 && height >= 0);\r\n    strokeRect(this.ctx, activeCell.left, activeCell.top, width, height);\r\n  }\r\n  private renderSelectAll(): void {\r\n    const { controller } = this;\r\n    this.ctx.fillStyle = theme.selectionColor;\r\n    fillRect(this.ctx, 0, 0, this.canvasSize.width, this.canvasSize.height);\r\n    const cellData = controller.getCell(controller.getActiveCell());\r\n    const activeCell = controller.computeCellPosition(\r\n      cellData.row,\r\n      cellData.col,\r\n    );\r\n    renderCell(\r\n      this.ctx,\r\n      { ...cellData, ...activeCell },\r\n      getStyle('lineHeight', this.canvas),\r\n    );\r\n\r\n    const headerSize = controller.getHeaderSize();\r\n    this.ctx.strokeStyle = theme.primaryColor;\r\n    this.ctx.lineWidth = dpr();\r\n    strokeRect(\r\n      this.ctx,\r\n      headerSize.width,\r\n      headerSize.height,\r\n      this.canvasSize.width - headerSize.width,\r\n      this.canvasSize.height - headerSize.height,\r\n    );\r\n  }\r\n  private renderSelectCol(): void {\r\n    const { controller } = this;\r\n    const headerSize = controller.getHeaderSize();\r\n    const ranges = controller.getRanges();\r\n    const [range] = ranges;\r\n    this.ctx.fillStyle = theme.selectionColor;\r\n    const activeCell = controller.computeCellPosition(range.row, range.col);\r\n    fillRect(this.ctx, activeCell.left, 0, activeCell.width, headerSize.height);\r\n    fillRect(\r\n      this.ctx,\r\n      0,\r\n      activeCell.top,\r\n      headerSize.width,\r\n      this.canvasSize.height,\r\n    );\r\n    fillRect(\r\n      this.ctx,\r\n      activeCell.left,\r\n      activeCell.top + activeCell.height,\r\n      activeCell.width,\r\n      this.canvasSize.height - activeCell.height,\r\n    );\r\n\r\n    this.ctx.strokeStyle = theme.primaryColor;\r\n    this.ctx.lineWidth = dpr();\r\n    strokeRect(\r\n      this.ctx,\r\n      activeCell.left,\r\n      activeCell.top,\r\n      activeCell.width,\r\n      this.canvasSize.height,\r\n    );\r\n  }\r\n  private renderSelectRow(): void {\r\n    const { controller } = this;\r\n    const headerSize = controller.getHeaderSize();\r\n    const ranges = controller.getRanges();\r\n    const [range] = ranges;\r\n    this.ctx.fillStyle = theme.selectionColor;\r\n    const activeCell = controller.computeCellPosition(range.row, range.col);\r\n    fillRect(\r\n      this.ctx,\r\n      activeCell.left,\r\n      0,\r\n      this.canvasSize.width,\r\n      headerSize.height,\r\n    );\r\n    fillRect(this.ctx, 0, activeCell.top, headerSize.width, activeCell.height);\r\n\r\n    fillRect(\r\n      this.ctx,\r\n      activeCell.left + activeCell.width,\r\n      activeCell.top,\r\n      this.canvasSize.width - activeCell.width,\r\n      activeCell.height,\r\n    );\r\n\r\n    this.ctx.strokeStyle = theme.primaryColor;\r\n    this.ctx.lineWidth = dpr();\r\n    strokeRect(\r\n      this.ctx,\r\n      activeCell.left,\r\n      activeCell.top,\r\n      activeCell.width,\r\n      this.canvasSize.height,\r\n    );\r\n  }\r\n}\r\n", "import { thinLineWidth, DEFAULT_FONT_CONFIG } from \"@/util\";\r\nimport theme from \"@/theme\";\r\n\r\nexport const HEADER_STYLE: Pick<\r\n  CanvasRenderingContext2D,\r\n  | \"textAlign\"\r\n  | \"textBaseline\"\r\n  | \"font\"\r\n  | \"fillStyle\"\r\n  | \"lineWidth\"\r\n  | \"strokeStyle\"\r\n> = {\r\n  textAlign: \"center\",\r\n  textBaseline: \"middle\",\r\n  font: DEFAULT_FONT_CONFIG,\r\n  fillStyle: theme.black,\r\n  lineWidth: thinLineWidth(),\r\n  strokeStyle: theme.gridStrokeColor,\r\n};\r\n", "import { isEmpty } from \"@/lodash\";\r\nimport {\r\n  thinLineWidth,\r\n  npx,\r\n  dpr,\r\n  intToColumnName,\r\n  isTestEnv,\r\n  resizeCanvas,\r\n} from \"@/util\";\r\nimport theme from \"@/theme\";\r\nimport {\r\n  fillRect,\r\n  fillText,\r\n  drawLines,\r\n  renderCell,\r\n  drawTriangle,\r\n  getStyle,\r\n} from \"./util\";\r\nimport { HEADER_STYLE } from \"./constant\";\r\nimport type {\r\n  Point,\r\n  ContentView,\r\n  IController,\r\n  EventType,\r\n  IWindowSize,\r\n} from \"@/types\";\r\n\r\nexport class Content implements ContentView {\r\n  private canvas: HTMLCanvasElement;\r\n  private ctx: CanvasRenderingContext2D;\r\n  private controller: IController;\r\n  private canvasSize: IWindowSize = {\r\n    width: 0,\r\n    height: 0,\r\n  };\r\n  constructor(controller: IController, canvas: HTMLCanvasElement) {\r\n    this.controller = controller;\r\n    this.canvas = canvas;\r\n    const ctx = this.canvas.getContext(\"2d\")!;\r\n    this.ctx = ctx;\r\n    const size = dpr();\r\n    this.ctx.scale(size, size);\r\n  }\r\n  getCanvas() {\r\n    return this.canvas;\r\n  }\r\n  resize(width: number, height: number) {\r\n    this.canvasSize = {\r\n      width,\r\n      height,\r\n    };\r\n    resizeCanvas(this.canvas, width, height);\r\n  }\r\n\r\n  private clear() {\r\n    this.ctx.clearRect(\r\n      0,\r\n      0,\r\n      npx(this.canvasSize.width),\r\n      npx(this.canvasSize.height)\r\n    );\r\n  }\r\n\r\n  render({ changeSet }: EventType): void {\r\n    const { width, height } = this.canvasSize;\r\n    if (!changeSet.has(\"contentChange\")) {\r\n      return;\r\n    }\r\n    const headerSize = this.controller.getHeaderSize();\r\n    this.clear();\r\n    const contentWidth = width - headerSize.width;\r\n    const contentHeight = height - headerSize.height;\r\n    this.renderGrid(contentWidth, contentHeight);\r\n    this.renderRowsHeader(contentHeight);\r\n    this.renderColsHeader(contentWidth);\r\n    this.renderTriangle();\r\n    this.renderContent(width, height);\r\n  }\r\n  private renderContent(width: number, height: number): void {\r\n    const { controller } = this;\r\n    const data = controller.getCellsContent();\r\n    if (isEmpty(data)) {\r\n      return;\r\n    }\r\n    this.ctx.save();\r\n    const { row: rowIndex, col: colIndex } = controller.getScroll();\r\n    for (const item of data) {\r\n      const { row, col } = item;\r\n      if (row < rowIndex || col < colIndex) {\r\n        continue;\r\n      }\r\n      const result = controller.computeCellPosition(row, col);\r\n      if (result.top > height || result.left > width) {\r\n        continue;\r\n      }\r\n\r\n      const cellInfo = this.controller.getCell(item);\r\n      const {\r\n        wrapHeight = 0,\r\n        fontSizeHeight = 0,\r\n        textWidth = 0,\r\n      } = renderCell(\r\n        this.ctx,\r\n        {\r\n          ...cellInfo,\r\n          ...result,\r\n        },\r\n        getStyle(\"lineHeight\", this.canvas)\r\n      );\r\n      const t = Math.max(wrapHeight, fontSizeHeight);\r\n      if (t > result.height) {\r\n        controller.setRowHeight(row, t);\r\n      }\r\n      if (textWidth > result.width) {\r\n        controller.setColWidth(col, textWidth);\r\n      }\r\n    }\r\n    this.ctx.restore();\r\n  }\r\n  private renderTriangle(): void {\r\n    if (isTestEnv()) {\r\n      return;\r\n    }\r\n    const headerSize = this.controller.getHeaderSize();\r\n    this.ctx.save();\r\n    this.ctx.fillStyle = theme.backgroundColor;\r\n\r\n    fillRect(this.ctx, 0, 0, headerSize.width, headerSize.height);\r\n    this.ctx.fillStyle = theme.triangleFillColor;\r\n    const offset = 2;\r\n    drawTriangle(\r\n      this.ctx,\r\n      [headerSize.width / 2 - offset, headerSize.height - offset],\r\n      [headerSize.width - offset, headerSize.height - offset],\r\n      [headerSize.width - offset, offset]\r\n    );\r\n\r\n    this.ctx.restore();\r\n  }\r\n\r\n  private renderGrid(width: number, height: number): void {\r\n    const { controller } = this;\r\n    const headerSize = controller.getHeaderSize();\r\n    const { row: rowIndex, col: colIndex } = controller.getScroll();\r\n    const { rowCount, colCount } = this.controller.getSheetInfo();\r\n    const lineWidth = thinLineWidth();\r\n    this.ctx.save();\r\n    this.ctx.fillStyle = theme.white;\r\n    this.ctx.lineWidth = lineWidth;\r\n    this.ctx.strokeStyle = theme.gridStrokeColor;\r\n    this.ctx.translate(npx(headerSize.width), npx(headerSize.height));\r\n    const pointList: Array<Point> = [];\r\n    let y = 0;\r\n    let x = 0;\r\n    let maxX = 0;\r\n    for (let i = colIndex; i < colCount; i++) {\r\n      maxX += controller.getColWidth(i);\r\n      if (maxX > width) {\r\n        break;\r\n      }\r\n    }\r\n    const realWidth = Math.min(maxX, width);\r\n    for (let i = rowIndex; i < rowCount; i++) {\r\n      pointList.push([0, y], [realWidth, y]);\r\n      y += controller.getRowHeight(i);\r\n      if (y > height) {\r\n        break;\r\n      }\r\n    }\r\n    for (let i = colIndex; i < colCount; i++) {\r\n      pointList.push([x, 0], [x, y]);\r\n      x += controller.getColWidth(i);\r\n      if (x > realWidth) {\r\n        break;\r\n      }\r\n    }\r\n    pointList.push([0, y], [x, y]);\r\n    pointList.push([x, 0], [x, y]);\r\n    drawLines(this.ctx, pointList);\r\n    this.ctx.restore();\r\n  }\r\n  private fillRowText(row: number, rowWidth: number, y: number): void {\r\n    this.ctx.fillStyle = theme.black;\r\n    fillText(this.ctx, String(row), rowWidth / 2, y);\r\n  }\r\n\r\n  private fillColText(colText: string, x: number, colHeight: number): void {\r\n    this.ctx.fillStyle = theme.black;\r\n    fillText(this.ctx, colText, x, colHeight / 2 + dpr());\r\n  }\r\n  private renderRowsHeader(height: number): void {\r\n    const { controller } = this;\r\n    const { row: rowIndex } = controller.getScroll();\r\n    const headerSize = controller.getHeaderSize();\r\n    const { rowCount } = controller.getSheetInfo();\r\n    this.ctx.save();\r\n    this.ctx.fillStyle = theme.backgroundColor;\r\n    fillRect(this.ctx, 0, headerSize.height, headerSize.width, height);\r\n    Object.assign(this.ctx, HEADER_STYLE);\r\n    const pointList: Array<Point> = [];\r\n    let y = headerSize.height;\r\n    let i = rowIndex;\r\n\r\n    for (; i < rowCount; i++) {\r\n      const rowHeight = controller.getRowHeight(i);\r\n      let temp = y;\r\n      if (i === rowIndex) {\r\n        temp += thinLineWidth() / 2;\r\n      }\r\n      pointList.push([0, temp], [headerSize.width, temp]);\r\n      this.fillRowText(i + 1, headerSize.width, temp + rowHeight / 2);\r\n      y += rowHeight;\r\n      if (y > height) {\r\n        break;\r\n      }\r\n    }\r\n    pointList.push([0, y], [headerSize.width, y]);\r\n    pointList.push([0, 0], [0, y]);\r\n    drawLines(this.ctx, pointList);\r\n    this.ctx.restore();\r\n  }\r\n  private renderColsHeader(width: number): void {\r\n    const { controller } = this;\r\n\r\n    const { col: colIndex } = controller.getScroll();\r\n    const headerSize = controller.getHeaderSize();\r\n    const { colCount } = controller.getSheetInfo();\r\n    const pointList: Array<Point> = [];\r\n    this.ctx.save();\r\n    this.ctx.fillStyle = theme.backgroundColor;\r\n    fillRect(this.ctx, headerSize.width, 0, width, headerSize.height);\r\n    Object.assign(this.ctx, HEADER_STYLE);\r\n\r\n    let x = headerSize.width;\r\n    let i = colIndex;\r\n    for (; i < colCount; i++) {\r\n      const colWidth = controller.getColWidth(i);\r\n      let temp = x;\r\n      if (i === colIndex) {\r\n        temp += thinLineWidth() / 2;\r\n      }\r\n      pointList.push([temp, 0], [temp, headerSize.height]);\r\n      this.fillColText(\r\n        intToColumnName(i),\r\n        temp + colWidth / 2,\r\n        headerSize.height\r\n      );\r\n      x += colWidth;\r\n      if (x > width) {\r\n        break;\r\n      }\r\n    }\r\n    pointList.push([x, 0], [x, headerSize.height]);\r\n    pointList.push([0, 0], [x, 0]);\r\n    drawLines(this.ctx, pointList);\r\n    this.ctx.restore();\r\n  }\r\n}\r\n", "import { StoreValue, IController, ChangeEventType } from \"./types\";\r\nimport { Controller, History } from \"./controller\";\r\nimport { Model, MOCK_MODEL } from \"./model\";\r\nimport { MainCanvas, registerEvents, Selection, Content } from \"./canvas\";\r\nimport {\r\n  FONT_FAMILY_LIST,\r\n  isSupportFontFamily,\r\n  MAIN_CANVAS_ID,\r\n  createCanvas,\r\n} from \"./util\";\r\nimport theme from \"./theme\";\r\n\r\nexport function initTheme(dom: HTMLElement) {\r\n  const keyList = Object.keys(theme) as Array<keyof typeof theme>;\r\n  for (const key of keyList) {\r\n    dom.style.setProperty(`--${key}`, String(theme[key] || \"\"));\r\n  }\r\n}\r\nexport function initFontFamilyList() {\r\n  const list = FONT_FAMILY_LIST.map((v) => {\r\n    const disabled = !isSupportFontFamily(v);\r\n    return { label: v, value: v, disabled };\r\n  });\r\n  return list;\r\n}\r\n\r\nfunction getStoreValue(controller: IController, canvasTop: number) {\r\n  const cell = controller.getCell(controller.getActiveCell());\r\n  const cellPosition = controller.computeCellPosition(cell.row, cell.col);\r\n  cellPosition.top = canvasTop + cellPosition.top;\r\n  const scroll = controller.getScroll();\r\n  const newStateValue: Partial<StoreValue> = {\r\n    isCellEditing: false,\r\n    canRedo: controller.canRedo(),\r\n    canUndo: controller.canUndo(),\r\n    sheetList: controller.getSheetList(),\r\n    currentSheetId: controller.getCurrentSheetId(),\r\n    cellPosition: cellPosition,\r\n    scrollLeft: scroll.scrollLeft,\r\n    scrollTop: scroll.scrollTop,\r\n  };\r\n  newStateValue.activeCell = cell;\r\n  return newStateValue;\r\n}\r\n\r\nexport function initCanvas(stateValue: StoreValue, controller: IController) {\r\n  const canvas = document.querySelector<HTMLCanvasElement>(\r\n    `#${MAIN_CANVAS_ID}`\r\n  )!;\r\n  const mainCanvas = new MainCanvas(canvas, new Content(controller, createCanvas()), new Selection(controller, createCanvas()));\r\n  const resize = () => {\r\n    const size = canvas.parentElement!.getBoundingClientRect();\r\n    mainCanvas.resize(size.width, size.height);\r\n    mainCanvas.render({\r\n      changeSet: new Set<ChangeEventType>([\"contentChange\"]),\r\n    });\r\n  };\r\n  resize();\r\n  registerEvents(stateValue, controller, canvas, resize);\r\n  const canvasPosition = canvas.parentElement!.getBoundingClientRect();\r\n  controller.setHooks({\r\n    modelChange: (changeSet) => {\r\n      const newStateValue = getStoreValue(controller, canvasPosition.top);\r\n      Object.assign(stateValue, newStateValue);\r\n      mainCanvas.render({ changeSet: changeSet });\r\n      mainCanvas.render({\r\n        changeSet: controller.getChangeSet(),\r\n      });\r\n    },\r\n  });\r\n  controller.fromJSON(MOCK_MODEL);\r\n}\r\nexport function initController(): IController {\r\n  const controller = new Controller(new Model(), new History());\r\n  controller.addSheet();\r\n  return controller;\r\n}\r\n", "import { render } from './react';\r\nimport { App } from './App';\r\nimport { DEFAULT_STORE_VALUE } from './util';\r\nimport {\r\n  initCanvas,\r\n  initController,\r\n  initTheme,\r\n  initFontFamilyList,\r\n} from './init';\r\nimport './global.css';\r\nimport './components/index.css';\r\nimport './containers/index.css';\r\n\r\nfunction init(containerDom: HTMLDivElement) {\r\n  initTheme(document.documentElement);\r\n  const controller = initController();\r\n  const stateValue = new Proxy(DEFAULT_STORE_VALUE, {\r\n    set(obj, prop, value) {\r\n      const res = Reflect.set(obj, prop, value);\r\n      setState();\r\n      return res;\r\n    },\r\n  });\r\n\r\n  const setState = () => {\r\n    render(containerDom, App(stateValue, controller));\r\n  };\r\n  setState();\r\n  stateValue.fontFamilyList = initFontFamilyList();\r\n  initCanvas(stateValue, controller);\r\n}\r\n\r\ninit(document.querySelector<HTMLDivElement>('#root')!);\r\n"],
  "mappings": "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",
  "names": ["color", "isSupportFontFamily", "parentNode", "key", "isElement", "init", "patch", "color", "hooks", "size", "formulas", "func", "item", "size", "isNum", "size", "size", "size", "init"]
}
