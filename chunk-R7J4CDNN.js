/* 
MIT License

Copyright (c) 2020 Steve Xu

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/
import{A as tt,J as re,M as rt,N as nt,V as st,la as Le,ma as at,na as Ne,oa as q,pa as it,qa as ot,s as Ye,sa as ht,u as ce,w as Se,y as et}from"./chunk-456IQKKT.js";import{b as Ct,c as Mt}from"./chunk-AI5EXC2Q.js";var mt=Ct((fn,Fe)=>{"use strict";var xt={};function nr(u){u.version="0.11.3";function e(n){for(var t="",r=n.length-1;r>=0;)t+=n.charAt(r--);return t}function s(n,t){for(var r="";r.length<t;)r+=n;return r}function c(n,t){var r=""+n;return r.length>=t?r:s("0",t-r.length)+r}function m(n,t){var r=""+n;return r.length>=t?r:s(" ",t-r.length)+r}function v(n,t){var r=""+n;return r.length>=t?r:r+s(" ",t-r.length)}function N(n,t){var r=""+Math.round(n);return r.length>=t?r:s("0",t-r.length)+r}function D(n,t){var r=""+n;return r.length>=t?r:s("0",t-r.length)+r}var F=Math.pow(2,32);function A(n,t){if(n>F||n<-F)return N(n,t);var r=Math.round(n);return D(r,t)}function $(n,t){return t=t||0,n.length>=7+t&&(n.charCodeAt(t)|32)===103&&(n.charCodeAt(t+1)|32)===101&&(n.charCodeAt(t+2)|32)===110&&(n.charCodeAt(t+3)|32)===101&&(n.charCodeAt(t+4)|32)===114&&(n.charCodeAt(t+5)|32)===97&&(n.charCodeAt(t+6)|32)===108}var B=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],X=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Re(n){n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'}var z={};Re(z);var H=[],b=0;for(b=5;b<=8;++b)H[b]=32+b;for(b=23;b<=26;++b)H[b]=0;for(b=27;b<=31;++b)H[b]=14;for(b=50;b<=58;++b)H[b]=14;for(b=59;b<=62;++b)H[b]=b-58;for(b=67;b<=68;++b)H[b]=b-58;for(b=72;b<=75;++b)H[b]=b-58;for(b=67;b<=68;++b)H[b]=b-57;for(b=76;b<=78;++b)H[b]=b-56;for(b=79;b<=81;++b)H[b]=b-34;var Tt={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function le(n,t,r){for(var E=n<0?-1:1,a=n*E,T=0,o=1,d=0,y=1,p=0,w=0,C=Math.floor(a);p<t&&(C=Math.floor(a),d=C*o+T,w=C*p+y,!(a-C<5e-8));)a=1/(a-C),T=o,o=d,y=p,p=w;if(w>t&&(p>t?(w=y,d=T):(w=p,d=o)),!r)return[0,E*d,w];var Q=Math.floor(E*d/w);return[Q,E*d-Q*w,w]}function bt(n){var t=n.toPrecision(16);if(t.indexOf("e")>-1){var r=t.slice(0,t.indexOf("e"));return r=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+s("0",r.length-15),r+t.slice(t.indexOf("e"))}var E=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+s("0",t.length-15);return Number(E)}function ee(n,t,r){if(n>2958465||n<0)return null;n=bt(n);var E=n|0,a=Math.floor(86400*(n-E)),T=0,o=[],d={D:E,T:a,u:86400*(n-E)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),t&&t.date1904&&(E+=1462),d.u>.9999&&(d.u=0,++a==86400&&(d.T=a=0,++E,++d.D)),E===60)o=r?[1317,10,29]:[1900,2,29],T=3;else if(E===0)o=r?[1317,8,29]:[1900,1,0],T=6;else{E>60&&--E;var y=new Date(1900,0,1);y.setDate(y.getDate()+E-1),o=[y.getFullYear(),y.getMonth()+1,y.getDate()],T=y.getDay(),E<60&&(T=(T+6)%7),r&&(T=At(y,o))}return d.y=o[0],d.m=o[1],d.d=o[2],d.S=a%60,a=Math.floor(a/60),d.M=a%60,a=Math.floor(a/60),d.H=a,d.q=T,d}u.parse_date_code=ee;var Pe=new Date(1899,11,31,0,0,0),yt=Pe.getTime(),kt=new Date(1900,2,1,0,0,0);function He(n,t){var r=n.getTime();return t?r-=1461*24*60*60*1e3:n>=kt&&(r+=24*60*60*1e3),(r-(yt+(n.getTimezoneOffset()-Pe.getTimezoneOffset())*6e4))/(24*60*60*1e3)}var Ve=function(){var t=/(?:\.0*|(\.\d*[1-9])0+)$/;function r(p){return p.indexOf(".")==-1?p:p.replace(t,"$1")}var E=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,a=/(E[+-])(\d)$/;function T(p){return p.indexOf("E")==-1?p:p.replace(E,"$1E").replace(a,"$10$2")}function o(p){var w=p<0?12:11,C=r(p.toFixed(12));return C.length<=w||(C=p.toPrecision(10),C.length<=w)?C:p.toExponential(5)}function d(p){var w=r(p.toFixed(11));return w.length>(p<0?12:11)||w==="0"||w==="-0"?p.toPrecision(6):w}function y(p){var w=Math.floor(Math.log(Math.abs(p))*Math.LOG10E),C;return w>=-4&&w<=-1?C=p.toPrecision(10+w):Math.abs(w)<=9?C=o(p):w===10?C=p.toFixed(10).substr(0,12):C=d(p),r(T(C.toUpperCase()))}return y}();u._general_num=Ve;function pe(n,t){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):Ve(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return Ze(14,He(n,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+n)}u._general=pe;function At(n,t){t[0]-=581;var r=n.getDay();return n<60&&(r=(r+6)%7),r}var sr="\u0E50\u0E51\u0E52\u0E53\u0E54\u0E55\u0E56\u0E57\u0E58\u0E59".split("");function wt(n,t,r,E){var a="",T=0,o=0,d=r.y,y,p=0;switch(n){case 98:d=r.y+543;case 121:switch(t.length){case 1:case 2:y=d%100,p=2;break;default:y=d%1e4,p=4;break}break;case 109:switch(t.length){case 1:case 2:y=r.m,p=t.length;break;case 3:return X[r.m-1][1];case 5:return X[r.m-1][0];default:return X[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:y=r.d,p=t.length;break;case 3:return B[r.q][0];default:return B[r.q][1]}break;case 104:switch(t.length){case 1:case 2:y=1+(r.H+11)%12,p=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:y=r.H,p=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:y=r.M,p=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?c(r.S,t.length):(E>=2?o=E===3?1e3:100:o=E===1?10:1,T=Math.round(o*(r.S+r.u)),T>=60*o&&(T=0),t==="s"?T===0?"0":""+T/o:(a=c(T,2+E),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":y=r.D*24+r.H;break;case"[m]":case"[mm]":y=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":y=((r.D*24+r.H)*60+r.M)*60+(E==0?Math.round(r.S+r.u):r.S);break;default:throw"bad abstime format: "+t}p=t.length===3?1:2;break;case 101:y=d,p=1;break}var w=p>0?c(y,p):"";return w}function Z(n){var t=3;if(n.length<=t)return n;for(var r=n.length%t,E=n.substr(0,r);r!=n.length;r+=t)E+=(E.length>0?",":"")+n.substr(r,t);return E}var W=function(){var t=/%/g;function r(l,i,h){var x=i.replace(t,""),g=i.length-x.length;return W(l,x,h*Math.pow(10,2*g))+s("%",g)}function E(l,i,h){for(var x=i.length-1;i.charCodeAt(x-1)===44;)--x;return W(l,i.substr(0,x),h/Math.pow(10,3*(i.length-x)))}function a(l,i){var h,x=l.indexOf("E")-l.indexOf(".")-1;if(l.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+a(l,-i);var g=l.indexOf(".");g===-1&&(g=l.indexOf("E"));var f=Math.floor(Math.log(i)*Math.LOG10E)%g;if(f<0&&(f+=g),h=(i/Math.pow(10,f)).toPrecision(x+1+(g+f)%g),h.indexOf("e")===-1){var k=Math.floor(Math.log(i)*Math.LOG10E);for(h.indexOf(".")===-1?h=h.charAt(0)+"."+h.substr(1)+"E+"+(k-h.length+f):h+="E+"+(k-f);h.substr(0,2)==="0.";)h=h.charAt(0)+h.substr(2,g)+"."+h.substr(2+g),h=h.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");h=h.replace(/\+-/,"-")}h=h.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(O,S,L,R){return S+L+R.substr(0,(g+f)%g)+"."+R.substr(f)+"E"})}else h=i.toExponential(x);return l.match(/E\+00$/)&&h.match(/e[+-]\d$/)&&(h=h.substr(0,h.length-1)+"0"+h.charAt(h.length-1)),l.match(/E\-/)&&h.match(/e\+/)&&(h=h.replace(/e\+/,"e")),h.replace("e","E")}var T=/# (\?+)( ?)\/( ?)(\d+)/;function o(l,i,h){var x=parseInt(l[4],10),g=Math.round(i*x),f=Math.floor(g/x),k=g-f*x,O=x;return h+(f===0?"":""+f)+" "+(k===0?s(" ",l[1].length+1+l[4].length):m(k,l[1].length)+l[2]+"/"+l[3]+c(O,l[4].length))}function d(l,i,h){return h+(i===0?"":""+i)+s(" ",l[1].length+2+l[4].length)}var y=/^#*0*\.([0#]+)/,p=/\).*[0#]/,w=/\(###\) ###\\?-####/;function C(l){for(var i="",h,x=0;x!=l.length;++x)switch(h=l.charCodeAt(x)){case 35:break;case 63:i+=" ";break;case 48:i+="0";break;default:i+=String.fromCharCode(h)}return i}function Q(l,i){var h=Math.pow(10,i);return""+Math.round(l*h)/h}function te(l,i){var h=l-Math.floor(l),x=Math.pow(10,i);return i<(""+Math.round(h*x)).length?0:Math.round(h*x)}function _e(l,i){return i<(""+Math.round((l-Math.floor(l))*Math.pow(10,i))).length?1:0}function j(l){return l<2147483647&&l>-2147483648?""+(l>=0?l|0:l-1|0):""+Math.floor(l)}function _(l,i,h){if(l.charCodeAt(0)===40&&!i.match(p)){var x=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return h>=0?_("n",x,h):"("+_("n",x,-h)+")"}if(i.charCodeAt(i.length-1)===44)return E(l,i,h);if(i.indexOf("%")!==-1)return r(l,i,h);if(i.indexOf("E")!==-1)return a(i,h);if(i.charCodeAt(0)===36)return"$"+_(l,i.substr(i.charAt(1)==" "?2:1),h);var g,f,k,O,S=Math.abs(h),L=h<0?"-":"";if(i.match(/^00+$/))return L+A(S,i.length);if(i.match(/^[#?]+$/))return g=A(h,0),g==="0"&&(g=""),g.length>i.length?g:C(i.substr(0,i.length-g.length))+g;if(f=i.match(T))return o(f,S,L);if(i.match(/^#+0+$/))return L+A(S,i.length-i.indexOf("0"));if(f=i.match(y))return g=Q(h,f[1].length).replace(/^([^\.]+)$/,"$1."+C(f[1])).replace(/\.$/,"."+C(f[1])).replace(/\.(\d*)$/,function(V,ue){return"."+ue+s("0",C(f[1]).length-ue.length)}),i.indexOf("0.")!==-1?g:g.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),f=i.match(/^(0*)\.(#*)$/))return L+Q(S,f[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=i.match(/^#{1,3},##0(\.?)$/))return L+Z(A(S,0));if(f=i.match(/^#,##0\.([#0]*0)$/))return h<0?"-"+_(l,i,-h):Z(""+(Math.floor(h)+_e(h,f[1].length)))+"."+c(te(h,f[1].length),f[1].length);if(f=i.match(/^#,#*,#0/))return _(l,i.replace(/^#,#*,/,""),h);if(f=i.match(/^([0#]+)(\\?-([0#]+))+$/))return g=e(_(l,i.replace(/[\\-]/g,""),h)),k=0,e(e(i.replace(/\\/g,"")).replace(/[0#]/g,function(V){return k<g.length?g.charAt(k++):V==="0"?"0":""}));if(i.match(w))return g=_(l,"##########",h),"("+g.substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var R="";if(f=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(f[4].length,7),O=le(S,Math.pow(10,k)-1,!1),g=""+L,R=W("n",f[1],O[1]),R.charAt(R.length-1)==" "&&(R=R.substr(0,R.length-1)+"0"),g+=R+f[2]+"/"+f[3],R=v(O[2],k),R.length<f[4].length&&(R=C(f[4].substr(f[4].length-R.length))+R),g+=R,g;if(f=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max(f[1].length,f[4].length),7),O=le(S,Math.pow(10,k)-1,!0),L+(O[0]||(O[1]?"":"0"))+" "+(O[1]?m(O[1],k)+f[2]+"/"+f[3]+v(O[2],k):s(" ",2*k+1+f[2].length+f[3].length));if(f=i.match(/^[#0?]+$/))return g=A(h,0),i.length<=g.length?g:C(i.substr(0,i.length-g.length))+g;if(f=i.match(/^([#0?]+)\.([#0]+)$/)){g=""+h.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),k=g.indexOf(".");var oe=i.indexOf(".")-k,Oe=i.length-g.length-oe;return C(i.substr(0,oe)+g+i.substr(i.length-Oe))}if(f=i.match(/^00,000\.([#0]*0)$/))return k=te(h,f[1].length),h<0?"-"+_(l,i,-h):Z(j(h)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(V){return"00,"+(V.length<3?c(0,3-V.length):"")+V})+"."+c(k,f[1].length);switch(i){case"###,##0.00":return _(l,"#,##0.00",h);case"###,###":case"##,###":case"#,###":var he=Z(A(S,0));return he!=="0"?L+he:"";case"###,###.00":return _(l,"###,##0.00",h).replace(/^0\./,".");case"#,###.00":return _(l,"#,##0.00",h).replace(/^0\./,".");default:}throw new Error("unsupported format |"+i+"|")}function se(l,i,h){for(var x=i.length-1;i.charCodeAt(x-1)===44;)--x;return W(l,i.substr(0,x),h/Math.pow(10,3*(i.length-x)))}function fe(l,i,h){var x=i.replace(t,""),g=i.length-x.length;return W(l,x,h*Math.pow(10,2*g))+s("%",g)}function G(l,i){var h,x=l.indexOf("E")-l.indexOf(".")-1;if(l.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+G(l,-i);var g=l.indexOf(".");g===-1&&(g=l.indexOf("E"));var f=Math.floor(Math.log(i)*Math.LOG10E)%g;if(f<0&&(f+=g),h=(i/Math.pow(10,f)).toPrecision(x+1+(g+f)%g),!h.match(/[Ee]/)){var k=Math.floor(Math.log(i)*Math.LOG10E);h.indexOf(".")===-1?h=h.charAt(0)+"."+h.substr(1)+"E+"+(k-h.length+f):h+="E+"+(k-f),h=h.replace(/\+-/,"-")}h=h.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(O,S,L,R){return S+L+R.substr(0,(g+f)%g)+"."+R.substr(f)+"E"})}else h=i.toExponential(x);return l.match(/E\+00$/)&&h.match(/e[+-]\d$/)&&(h=h.substr(0,h.length-1)+"0"+h.charAt(h.length-1)),l.match(/E\-/)&&h.match(/e\+/)&&(h=h.replace(/e\+/,"e")),h.replace("e","E")}function I(l,i,h){if(l.charCodeAt(0)===40&&!i.match(p)){var x=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return h>=0?I("n",x,h):"("+I("n",x,-h)+")"}if(i.charCodeAt(i.length-1)===44)return se(l,i,h);if(i.indexOf("%")!==-1)return fe(l,i,h);if(i.indexOf("E")!==-1)return G(i,h);if(i.charCodeAt(0)===36)return"$"+I(l,i.substr(i.charAt(1)==" "?2:1),h);var g,f,k,O,S=Math.abs(h),L=h<0?"-":"";if(i.match(/^00+$/))return L+c(S,i.length);if(i.match(/^[#?]+$/))return g=""+h,h===0&&(g=""),g.length>i.length?g:C(i.substr(0,i.length-g.length))+g;if(f=i.match(T))return d(f,S,L);if(i.match(/^#+0+$/))return L+c(S,i.length-i.indexOf("0"));if(f=i.match(y))return g=(""+h).replace(/^([^\.]+)$/,"$1."+C(f[1])).replace(/\.$/,"."+C(f[1])),g=g.replace(/\.(\d*)$/,function(V,ue){return"."+ue+s("0",C(f[1]).length-ue.length)}),i.indexOf("0.")!==-1?g:g.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),f=i.match(/^(0*)\.(#*)$/))return L+(""+S).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=i.match(/^#{1,3},##0(\.?)$/))return L+Z(""+S);if(f=i.match(/^#,##0\.([#0]*0)$/))return h<0?"-"+I(l,i,-h):Z(""+h)+"."+s("0",f[1].length);if(f=i.match(/^#,#*,#0/))return I(l,i.replace(/^#,#*,/,""),h);if(f=i.match(/^([0#]+)(\\?-([0#]+))+$/))return g=e(I(l,i.replace(/[\\-]/g,""),h)),k=0,e(e(i.replace(/\\/g,"")).replace(/[0#]/g,function(V){return k<g.length?g.charAt(k++):V==="0"?"0":""}));if(i.match(w))return g=I(l,"##########",h),"("+g.substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var R="";if(f=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(f[4].length,7),O=le(S,Math.pow(10,k)-1,!1),g=""+L,R=W("n",f[1],O[1]),R.charAt(R.length-1)==" "&&(R=R.substr(0,R.length-1)+"0"),g+=R+f[2]+"/"+f[3],R=v(O[2],k),R.length<f[4].length&&(R=C(f[4].substr(f[4].length-R.length))+R),g+=R,g;if(f=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max(f[1].length,f[4].length),7),O=le(S,Math.pow(10,k)-1,!0),L+(O[0]||(O[1]?"":"0"))+" "+(O[1]?m(O[1],k)+f[2]+"/"+f[3]+v(O[2],k):s(" ",2*k+1+f[2].length+f[3].length));if(f=i.match(/^[#0?]+$/))return g=""+h,i.length<=g.length?g:C(i.substr(0,i.length-g.length))+g;if(f=i.match(/^([#0]+)\.([#0]+)$/)){g=""+h.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),k=g.indexOf(".");var oe=i.indexOf(".")-k,Oe=i.length-g.length-oe;return C(i.substr(0,oe)+g+i.substr(i.length-Oe))}if(f=i.match(/^00,000\.([#0]*0)$/))return h<0?"-"+I(l,i,-h):Z(""+h).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(V){return"00,"+(V.length<3?c(0,3-V.length):"")+V})+"."+c(0,f[1].length);switch(i){case"###,###":case"##,###":case"#,###":var he=Z(""+S);return he!=="0"?L+he:"";default:if(i.match(/\.[0#?]*$/))return I(l,i.slice(0,i.lastIndexOf(".")),h)+C(i.slice(i.lastIndexOf(".")))}throw new Error("unsupported format |"+i+"|")}return function(i,h,x){return(x|0)===x?I(i,h,x):_(i,h,x)}}();function Be(n){for(var t=[],r=!1,E=0,a=0;E<n.length;++E)switch(n.charCodeAt(E)){case 34:r=!r;break;case 95:case 42:case 92:++E;break;case 59:t[t.length]=n.substr(a,E-a),a=E+1}if(t[t.length]=n.substr(a),r===!0)throw new Error("Format |"+n+"| unterminated string ");return t}u._split=Be;var Xe=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Qe(n){for(var t=0,r="",E="";t<n.length;)switch(r=n.charAt(t)){case"G":$(n,t)&&(t+=6),t++;break;case'"':for(;n.charCodeAt(++t)!==34&&t<n.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(n.charAt(t+1)==="1"||n.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(n.substr(t,3).toUpperCase()==="A/P"||n.substr(t,5).toUpperCase()==="AM/PM"||n.substr(t,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++t;break;case"[":for(E=r;n.charAt(t++)!=="]"&&t<n.length;)E+=n.charAt(t);if(E.match(Xe))return!0;break;case".":case"0":case"#":for(;t<n.length&&("0#?.,E+-%".indexOf(r=n.charAt(++t))>-1||r=="\\"&&n.charAt(t+1)=="-"&&"0#".indexOf(n.charAt(t+2))>-1););break;case"?":for(;n.charAt(++t)===r;);break;case"*":++t,(n.charAt(t)==" "||n.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<n.length&&"0123456789".indexOf(n.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}u.is_date=Qe;function je(n,t,r,E){for(var a=[],T="",o=0,d="",y="t",p,w,C,Q="H";o<n.length;)switch(d=n.charAt(o)){case"G":if(!$(n,o))throw new Error("unrecognized character "+d+" in "+n);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(T="";(C=n.charCodeAt(++o))!==34&&o<n.length;)T+=String.fromCharCode(C);a[a.length]={t:"t",v:T},++o;break;case"\\":var te=n.charAt(++o),_e=te==="("||te===")"?te:"t";a[a.length]={t:_e,v:te},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(n.charAt(o+1)==="1"||n.charAt(o+1)==="2"){if(p==null&&(p=ee(t,r,n.charAt(o+1)==="2"),p==null))return"";a[a.length]={t:"X",v:n.substr(o,2)},y=d,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||p==null&&(p=ee(t,r),p==null))return"";for(T=d;++o<n.length&&n.charAt(o).toLowerCase()===d;)T+=d;d==="m"&&y.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=Q),a[a.length]={t:d,v:T},y=d;break;case"A":case"a":case"\u4E0A":var j={t:d,v:d};if(p==null&&(p=ee(t,r)),n.substr(o,3).toUpperCase()==="A/P"?(p!=null&&(j.v=p.H>=12?n.charAt(o+2):d),j.t="T",Q="h",o+=3):n.substr(o,5).toUpperCase()==="AM/PM"?(p!=null&&(j.v=p.H>=12?"PM":"AM"),j.t="T",o+=5,Q="h"):n.substr(o,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(p!=null&&(j.v=p.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),j.t="T",o+=5,Q="h"):(j.t="t",++o),p==null&&j.t==="T")return"";a[a.length]=j,y=d;break;case"[":for(T=d;n.charAt(o++)!=="]"&&o<n.length;)T+=n.charAt(o);if(T.slice(-1)!=="]")throw'unterminated "[" block: |'+T+"|";if(T.match(Xe)){if(p==null&&(p=ee(t,r),p==null))return"";a[a.length]={t:"Z",v:T.toLowerCase()},y=T.charAt(1)}else T.indexOf("$")>-1&&(T=(T.match(/\$([^-\[\]]*)/)||[])[1]||"$",Qe(n)||(a[a.length]={t:"t",v:T}));break;case".":if(p!=null){for(T=d;++o<n.length&&(d=n.charAt(o))==="0";)T+=d;a[a.length]={t:"s",v:T};break}case"0":case"#":for(T=d;++o<n.length&&"0#?.,E+-%".indexOf(d=n.charAt(o))>-1;)T+=d;a[a.length]={t:"n",v:T};break;case"?":for(T=d;n.charAt(++o)===d;)T+=d;a[a.length]={t:d,v:T},y=d;break;case"*":++o,(n.charAt(o)==" "||n.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:E===1?"t":d,v:d},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(T=d;o<n.length&&"0123456789".indexOf(n.charAt(++o))>-1;)T+=n.charAt(o);a[a.length]={t:"D",v:T};break;case" ":a[a.length]={t:d,v:d},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+n);a[a.length]={t:"t",v:d},++o;break}var _=0,se=0,fe;for(o=a.length-1,y="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=Q,y="h",_<1&&(_=1);break;case"s":(fe=a[o].v.match(/\.0+$/))&&(se=Math.max(se,fe[0].length-1),_=4),_<3&&(_=3);case"d":case"y":case"e":y=a[o].t;break;case"M":y=a[o].t,_<2&&(_=2);break;case"m":y==="s"&&(a[o].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[o].v.match(/[Hh]/)&&(_=1),_<2&&a[o].v.match(/[Mm]/)&&(_=2),_<3&&a[o].v.match(/[Ss]/)&&(_=3)}var G;switch(_){case 0:break;case 1:case 2:case 3:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H),p.H>=24&&(p.H=0,++p.D,G=ee(p.D),G.u=p.u,G.S=p.S,G.M=p.M,G.H=p.H,p=G);break;case 4:switch(se){case 1:p.u=Math.round(p.u*10)/10;break;case 2:p.u=Math.round(p.u*100)/100;break;case 3:p.u=Math.round(p.u*1e3)/1e3;break}p.u>=1&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H),p.H>=24&&(p.H=0,++p.D,G=ee(p.D),G.u=p.u,G.S=p.S,G.M=p.M,G.H=p.H,p=G);break}var I="",l;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=wt(a[o].t.charCodeAt(0),a[o].v,p,se),a[o].t="t";break;case"n":case"?":for(l=o+1;a[l]!=null&&((d=a[l].t)==="?"||d==="D"||(d===" "||d==="t")&&a[l+1]!=null&&(a[l+1].t==="?"||a[l+1].t==="t"&&a[l+1].v==="/")||a[o].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(a[l].v==="/"||a[l].v===" "&&a[l+1]!=null&&a[l+1].t=="?"));)a[o].v+=a[l].v,a[l]={v:"",t:";"},++l;I+=a[o].v,o=l-1;break;case"G":a[o].t="t",a[o].v=pe(t,r);break}var i="",h,x;if(I.length>0){I.charCodeAt(0)==40?(h=t<0&&I.charCodeAt(0)===45?-t:t,x=W("n",I,h)):(h=t<0&&E>1?-t:t,x=W("n",I,h),h<0&&a[0]&&a[0].t=="t"&&(x=x.substr(1),a[0].v="-"+a[0].v)),l=x.length-1;var g=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){g=o;break}var f=a.length;if(g===a.length&&x.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(l>=a[o].v.length-1?(l-=a[o].v.length,a[o].v=x.substr(l+1,a[o].v.length)):l<0?a[o].v="":(a[o].v=x.substr(0,l+1),l=-1),a[o].t="t",f=o);l>=0&&f<a.length&&(a[f].v=x.substr(0,l+1)+a[f].v)}else if(g!==a.length&&x.indexOf("E")===-1){for(l=x.indexOf(".")-1,o=g;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(w=a[o].v.indexOf(".")>-1&&o===g?a[o].v.indexOf(".")-1:a[o].v.length-1,i=a[o].v.substr(w+1);w>=0;--w)l>=0&&(a[o].v.charAt(w)==="0"||a[o].v.charAt(w)==="#")&&(i=x.charAt(l--)+i);a[o].v=i,a[o].t="t",f=o}for(l>=0&&f<a.length&&(a[f].v=x.substr(0,l+1)+a[f].v),l=x.indexOf(".")+1,o=g;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==g)){for(w=a[o].v.indexOf(".")>-1&&o===g?a[o].v.indexOf(".")+1:0,i=a[o].v.substr(0,w);w<a[o].v.length;++w)l<x.length&&(i+=x.charAt(l++));a[o].v=i,a[o].t="t",f=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(h=E>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=W(a[o].t,a[o].v,h),a[o].t="t");var k="";for(o=0;o!==a.length;++o)a[o]!=null&&(k+=a[o].v);return k}u._eval=je;var Ke=/\[[=<>]/,ze=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Je(n,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(n==r)return!0;break;case">":if(n>r)return!0;break;case"<":if(n<r)return!0;break;case"<>":if(n!=r)return!0;break;case">=":if(n>=r)return!0;break;case"<=":if(n<=r)return!0;break}return!1}function We(n,t){var r=Be(n),E=r.length,a=r[E-1].indexOf("@");if(E<4&&a>-1&&--E,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break;case 4:break}var T=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[E,T];if(r[0].match(Ke)!=null||r[1].match(Ke)!=null){var o=r[0].match(ze),d=r[1].match(ze);return Je(t,o)?[E,r[0]]:Je(t,d)?[E,r[1]]:[E,r[o!=null&&d!=null?2:1]]}return[E,T]}function Ze(n,t,r){r==null&&(r={});var E="";switch(typeof n){case"string":n=="m/d/yy"&&r.dateNF?E=r.dateNF:E=n;break;case"number":n==14&&r.dateNF?E=r.dateNF:E=(r.table!=null?r.table:z)[n],E==null&&(E=r.table&&r.table[H[n]]||z[H[n]]),E==null&&(E=Tt[n]||"General");break}if($(E,0))return pe(t,r);t instanceof Date&&(t=He(t,r.date1904));var a=We(E,t);if($(a[1]))return pe(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return je(a[1],t,r,a[0])}function qe(n,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(z[r]==null){t<0&&(t=r);continue}if(z[r]==n){t=r;break}}t<0&&(t=391)}return z[t]=n,t}u.load=qe,u._table=z,u.get_table=function(){return z},u.load_table=function(t){for(var r=0;r!=392;++r)t[r]!==void 0&&qe(t[r],r)},u.init_table=Re,u.format=Ze,u.choose_format=We}nr(xt);typeof Fe<"u"&&typeof DO_NOT_EXPORT_SSF>"u"&&(Fe.exports=xt)});var J=class{constructor(e,s){this.type=e,this.value=s}toString(){return this.value}};var M=class extends Error{constructor(e){super(e),this.value=e}};function P(u,e="#VALUE!"){if(!u)throw new M(e)}function ge(u){P(u.length===1);let[e]=u;return e}function ae(u){let e=ge(u);return P(typeof e=="string"),e}function U(u){let e=ge(u),[s,c]=re(e);return P(s),c}function $e(u){P(u.length===0)}function de(u){let e=u.toUpperCase();return/^[A-Z]+\d+$/.test(e)||/^[A-Z]+$/.test(e)}var vt=(...u)=>{let e=ge(u);return typeof e=="string"?e:""},Rt=(...u)=>ae(u).toLowerCase(),ut=(...u)=>{let e=U(u);return String.fromCharCode(e)},ct=(...u)=>ae(u).charCodeAt(0),_t=(...u)=>ae(u).length,Ot=(...u)=>{P(u.length===2);let[e,s]=u;return P(typeof e=="string"),P(typeof s=="string"),e.split(s)},St=(...u)=>ae(u).toUpperCase(),Lt=(...u)=>ae(u).replace(/ +/g," ").trim(),lt=(...u)=>(P(u.length<=ce),u.join("")),Nt={CONCAT:lt,CONCATENATE:lt,SPLIT:Ot,CHAR:ut,CODE:ct,UNICHAR:ut,UNICODE:ct,LEN:_t,LOWER:Rt,UPPER:St,TRIM:Lt,T:vt},pt=Nt;function ft(u){let e=[];for(let s=0;s<u.length;s++){let[c,m]=re(u[s]);c&&e.push(m)}return e}var $t=(...u)=>{let e=U(u);return Math.abs(e)},It=(...u)=>{let e=U(u);return Math.acos(e)},Ut=(...u)=>{let e=U(u);return Math.log(e+Math.sqrt(e*e-1))},Dt=(...u)=>{let e=U(u);return Math.atan(1/e)},Ft=(...u)=>{let e=U(u);return .5*Math.log((e+1)/(e-1))},Gt=(...u)=>{let e=U(u);return Math.asin(e)},Pt=(...u)=>{let e=U(u);return Math.log(e+Math.sqrt(e*e+1))},Ht=(...u)=>{let e=U(u);return Math.atan(e)},Vt=(...u)=>{P(u.length===2);let[e,s]=u;return P(typeof e=="number"),P(typeof s=="number"),Math.atan2(e,s)},Bt=(...u)=>{let e=U(u);return Math.log((1+e)/(e+1))/2},Xt=(...u)=>{let e=ft(u);return P(e.length<=ce&&e.length>=1),e.reduce((s,c)=>s+c,0)/e.length},Qt=(...u)=>{let e=U(u);return Math.cos(e)},jt=(...u)=>{let e=U(u);return 1/Math.tan(e)};var Kt=(...u)=>{let e=U(u);return Math.exp(e)},zt=(...u)=>{let e=U(u);return Math.floor(e)};var Jt=(...u)=>($e(u),Math.PI),Wt=(...u)=>($e(u),Math.E),Zt=(...u)=>{let e=U(u);return Math.sin(e)},qt=(...u)=>{let e=ft(u);return P(e.length<=ce),e.reduce((s,c)=>s+c,0)},Yt={ABS:$t,ACOS:It,ACOSH:Ut,ACOT:Dt,ACOTH:Ft,ASIN:Gt,ASINH:Pt,ATAN:Ht,ATAN2:Vt,ATANH:Bt,AVERAGE:Xt,COT:jt,COS:Qt,EXP:Kt,INT:zt,PI:Jt,E:Wt,SIN:Zt,SUM:qt},gt=Yt;function dt(u){let e=String(u),s=/[.](\d*)/.exec(e);if(s&&s[1]){let c=Math.pow(10,Math.min(s[1].length,Se)),m=e.split("."),v=m[0]+m[1].slice(0,Se);return Number(v)/c}else return u}var er={...pt,...gt},Ee=er;var Et="",tr=new Map([["TRUE",20],["FALSE",21]]),xe=class{constructor(e){this.current=0;this.start=0;this.tokens=[];this.list=[...e]}scan(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();return this.tokens.push(new J(31,"")),this.tokens.length>0&&this.tokens[0].type===0&&this.tokens.shift(),this.tokens}peek(){return this.isAtEnd()?Et:this.list[this.current]}match(e){return this.peek()!==e?!1:(this.next(),!0)}next(){return this.isAtEnd()?Et:this.list[this.current++]}isAtEnd(){return this.current>=this.list.length}addToken(e){let s=this.list.slice(this.start,this.current).join("");this.tokens.push(new J(e,s))}string(e){for(;!this.isAtEnd()&&this.peek()!==e;)this.next();if(this.peek()!==e)throw new M("#VALUE!");this.next();let s=this.list.slice(this.start+1,this.current-1).join("");this.tokens.push(new J(17,s))}getDigits(){for(;!this.isAtEnd()&&q(this.peek());)this.next()}getAlphas(){for(;!this.isAtEnd()&&Ne(this.peek());)this.next()}matchR1C1(){if(this.match("[")){if(this.match("-"),q(this.peek()))this.getDigits();else throw new M("#VALUE!");if(this.peek()!=="]")throw new M("#VALUE!");this.next()}else this.getDigits()}matchScientificCounting(e){if(this.match("E")||this.match("e")){if(this.match("+")||this.match("-"))return this.getDigits(),this.addToken(e?18:19),!0;if(q(this.peek()))return this.getDigits(),this.addToken(e?18:19),!0;throw new M("#VALUE!")}return!1}number(){if(this.getDigits(),this.matchScientificCounting(!1))return;let s=!1;this.match(".")&&(s=!0,this.getDigits()),!this.matchScientificCounting(!0)&&this.addToken(s?18:19)}addIdentifier(){for(;!this.isAtEnd()&&this.anyChar(this.peek());)this.next();let e=this.list.slice(this.start,this.current).join(""),s=e.toUpperCase(),c=tr.get(s),m=16;c&&(e=s,m=c),/^[A-Z]+\$\d+$/.test(s)&&(e=s,m=29),this.tokens.push(new J(m,e))}scanToken(){let e=this.next();switch(e){case"$":{Ne(this.peek())?(this.getAlphas(),this.match("$")?q(this.peek())?(this.getDigits(),this.addToken(30)):this.addIdentifier():q(this.peek())?(this.getDigits(),this.addToken(29)):this.addToken(30)):q(this.peek())?(this.getDigits(),this.addToken(30)):this.addIdentifier();break}case"r":case"R":{if(this.matchR1C1(),this.match("C")||this.match("c")){this.matchR1C1();let s=this.list.slice(this.start,this.current).join("").toUpperCase();this.tokens.push(new J(28,s))}else this.addIdentifier();break}case"(":this.addToken(22);break;case")":this.addToken(23);break;case",":this.addToken(11);break;case":":this.addToken(10);break;case Ye:this.addToken(0);break;case"<":this.match(">")?this.addToken(1):this.match("=")?this.addToken(15):this.addToken(14);break;case">":this.match("=")?this.addToken(8):this.addToken(7);break;case"+":this.addToken(2);break;case"-":this.addToken(3);break;case"*":this.addToken(4);break;case"/":this.addToken(5);break;case"^":this.addToken(6);break;case"&":this.addToken(9);break;case"%":this.addToken(13);break;case'"':this.string(e);break;case"'":this.string(e);break;case"!":this.addToken(27);break;case";":this.addToken(26);break;case"{":this.addToken(24);break;case"}":this.addToken(25);break;case" ":break;case"\r":case"	":case`
`:break;default:q(e)?this.number():this.addIdentifier();break}}anyChar(e){return!'(),:=<>+-*/^&%"{}!'.includes(e)&&!this.isWhiteSpace(e)}isWhiteSpace(e){return e===" "||e==="\r"||e===`
`||e==="	"}};var Y=class{constructor(e,s,c){this.left=e,this.operator=s,this.right=c}accept(e){return e.visitBinaryExpression(this)}handleConcatenate(e){let s=e.toString();return this.operator.type===9&&e instanceof ne&&e.value.type===17?JSON.stringify(s):s}toString(){let e=this.handleConcatenate(this.left),s=this.handleConcatenate(this.right);return`${e}${this.operator.toString()}${s}`}},me=class{constructor(e,s){this.operator=e,this.right=s}accept(e){return e.visitUnaryExpression(this)}toString(){return this.operator.toString()+this.right.toString()}},Te=class{constructor(e,s){this.operator=e,this.left=s}accept(e){return e.visitPostUnaryExpression(this)}toString(){return this.left.toString()+this.operator.toString()}},ne=class{constructor(e){this.value=e}accept(e){return e.visitLiteralExpression(this)}toString(){return this.value.toString()}},be=class{constructor(e){this.value=e}accept(e){return e.visitR1C1Expression(this)}toString(){return this.value.toString()}},K=class{constructor(e,s,c){this.value=e,this.sheetName=c,this.type=s}accept(e){return e.visitCellExpression(this)}toString(){let e=this.value.toString().toUpperCase();if(this.sheetName){let s=this.sheetName.toString();return s.includes(" ")&&(s=`'${s}'`),`${s}!${e}`}else return e}},ye=class{constructor(e,s){this.name=e,this.params=s}accept(e){return e.visitCallExpression(this)}toString(){return`${this.name.toString().toUpperCase()}(${this.params.map(e=>e.toString()).join(",")})`}},ke=class{constructor(e,s,c){this.left=e,this.operator=s,this.right=c}accept(e){return e.visitCellRangeExpression(this)}toString(){return this.left.toString()+this.operator.toString()+this.right.toString()}},Ae=class{constructor(e){this.value=e}accept(e){return e.visitGroupExpression(this)}toString(){return`(${this.value.toString()})`}},ie=class{constructor(e){this.value=e}accept(e){return e.visitTokenExpression(this)}toString(){return this.value.toString()}},we=class{constructor(e){this.value=e}accept(e){return e.visitArrayExpression(this)}toString(){return`{${this.value.map(s=>s.toString()).join(",")}}`}};var Ce=class{constructor(e){this.current=0;this.tokens=e}parse(){let e=[];for(;!this.isAtEnd();)e.push(this.expression());return e}expression(){return this.comparison()}comparison(){let e=this.concatenate();for(;this.match(0,1,7,8,14,15);){let s=this.previous(),c=this.concatenate();e=new Y(e,s,c)}return e}concatenate(){let e=this.term();for(;this.match(9);){let s=this.previous(),c=this.term();e=new Y(e,s,c)}return e}term(){let e=this.factor();for(;this.match(2,3);){let s=this.previous(),c=this.factor();e=new Y(e,s,c)}return e}factor(){let e=this.expo();for(;this.match(5,4);){let s=this.previous(),c=this.expo();e=new Y(e,s,c)}return e}expo(){let e=this.unary();for(;this.match(6);){let s=this.previous(),c=this.unary();e=new Y(e,s,c)}return e}unary(){if(this.match(2,3)){let e=this.previous(),s=this.unary();return new me(e,s)}return this.postUnary()}postUnary(){let e=this.cellRange();if(this.match(13)){let s=this.previous();e=new Te(s,e)}return e}cellRange(){let e=this.sheetRange();for(;this.match(10);){let s=this.previous(),c=this.sheetRange(),m=this.convertToCellExpression(c),v=this.convertToCellExpression(e);e=new ke(v,s,m)}return e}convertToCellExpression(e){if(e instanceof K)return e;if(e instanceof ie&&de(e.value.value))return new K(e.value,"relative",void 0);if(e instanceof ne&&e.value.type===19)return new K(e.value,"relative",void 0);throw new M("#NAME?")}sheetRange(){let e=this.call();if(this.match(27)){let s=this.call();if(e instanceof ie||e instanceof ne){let c=this.convertToCellExpression(s);return new K(c.value,c.type,e.value)}}return e}call(){let e=this.primary();for(;this.match(22);)e=this.finishCall(e);return e}finishCall(e){let s=[];if(!this.check(23))do{if(this.peek().type==23)break;s.push(this.expression())}while(this.match(11));return this.expect(23),new ye(e,s)}primary(){if(this.match(24)){let e=[];do{if(this.peek().type==25)break;e.push(this.expression())}while(this.match(11));return this.expect(25),new we(e)}if(this.match(22)){let e=this.expression();return this.expect(23),new Ae(e)}if(this.match(19,18,17,20,21))return new ne(this.previous());if(this.match(30)){let e=this.previous();return new K(e,"absolute",void 0)}if(this.match(29)){let e=this.previous();return new K(e,"mixed",void 0)}if(this.match(16)){let e=this.previous(),s=e.value.toUpperCase();if(tt.has(s))throw new M(s);return new ie(e)}if(this.match(28))return new be(this.previous());throw new M("#VALUE!")}match(...e){let{type:s}=this.peek();return e.includes(s)?(this.next(),!0):!1}previous(){return this.tokens[this.current-1]}check(e){return this.peek().type===e}expect(e){if(this.check(e))return this.next(),this.previous();throw new M("#VALUE!")}next(){this.current++}isAtEnd(){return this.peek().type===31}peek(){return this.current<this.tokens.length?this.tokens[this.current]:new J(31,"")}};var Me=class{constructor(e,s,c){this.expressions=e,this.cellDataMap=c,this.currentCoord=s}interpret(){let e=[];for(let s of this.expressions){let c=this.evaluate(s),m=this.getRangeCellValue(c);Array.isArray(m)?e=e.concat(m):e.push(m)}return e}visitBinaryExpression(e){let s=this.evaluate(e.left),c=this.evaluate(e.right);switch(s=this.getOneValue(s),c=this.getOneValue(c),[3,2,5,4,6].includes(e.operator.type)&&(s=this.parseNumber(s),c=this.parseNumber(c)),e.operator.type){case 3:return s-c;case 2:return s+c;case 5:{if(c===0)throw new M("#DIV/0!");return s/c}case 4:return s*c;case 6:return Math.pow(s,c);case 0:return s===c;case 1:return s!==c;case 7:return s>c;case 8:return s>=c;case 14:return s<c;case 15:return s<=c;case 9:return`${s}${c}`;default:throw new M("#TEXT")}}visitCallExpression(e){let s=this.evaluate(e.name);if(s&&typeof s=="function"){let c=[];for(let m of e.params){let v=this.evaluate(m);if(v instanceof Le){let N=this.getCellValue(v,!1);c=c.concat(N)}else c.push(v)}return s(...c)}throw new M("#NAME?")}visitR1C1Expression(e){let s=ht(e.value.value,this.currentCoord);if(!s)throw new M("#NAME?");return s}visitCellExpression(e){let s="";if(e.sheetName){let m=this.cellDataMap.getSheetInfo("",e.sheetName.value);if(!m)throw new M("#REF!");s=m.sheetId}let c=it(e.value.value);if(!c)throw new M("#NAME?");return s&&(c.sheetId=s),c}visitLiteralExpression(e){let{type:s,value:c}=e.value;switch(s){case 17:return c;case 18:case 19:{let[m,v]=re(c);if(m)return v;throw new M("#VALUE!")}case 20:return!0;case 21:return!1;default:throw new M("#VALUE!")}}visitTokenExpression(e){let{value:s}=e.value,c=s.toLowerCase();if(this.cellDataMap.getDefinedName(c)){let v=this.cellDataMap.getDefinedName(c);return this.getCellValue(v,!0)}let m=this.cellDataMap.getFunction(s.toUpperCase());if(m)return m;if(de(s))return this.visitCellExpression(new K(e.value,"relative",void 0));throw new M("#NAME?")}visitUnaryExpression(e){let s=this.evaluate(e.right),c=this.parseNumber(this.getOneValue(s));switch(e.operator.type){case 3:return-c;case 2:return c;default:throw new M("#VALUE!")}}visitCellRangeExpression(e){switch(e.operator.type){case 10:{let s=this.visitCellExpression(e.left),c=this.visitCellExpression(e.right),m=ot(s,c);if(!m)throw new M("#NAME?");return m}default:throw new M("#NAME?")}}visitGroupExpression(e){return this.evaluate(e.value)}visitArrayExpression(e){let s=[];for(let c of e.value)s.push(this.evaluate(c));return s}visitPostUnaryExpression(e){let s=this.evaluate(e.left),c=this.parseNumber(this.getOneValue(s));switch(e.operator.type){case 13:return c*.01;default:throw new M("#VALUE!")}}evaluate(e){return e.accept(this)}getRangeCellValue(e){if(e instanceof Le){if(e.colCount===e.rowCount&&e.colCount===1)return this.getCellValue(e,!0);throw new M("#REF!")}return e}getOneValue(e){let s=this.getRangeCellValue(e);return Array.isArray(s)?s[0]:s}parseNumber(e){let[s,c]=re(e);if(!s)throw new M("#VALUE!");return c}getCellValue(e,s){let c=[];if(s){let F=this.cellDataMap.getCell(e),A=this.cellDataMap.handleCell(F,{row:e.row,col:e.col});return c=c.concat(A),c}let{row:m,col:v,sheetId:N}=e,D=this.cellDataMap.getSheetInfo(N);if(!D||m>=D.rowCount||v>=D.colCount)throw new M("#REF!");return at(e,D,(F,A)=>{let $=this.cellDataMap.getCell({row:F,col:A,rowCount:1,colCount:1,sheetId:N}),B=this.cellDataMap.handleCell($,{row:F,col:A});return c=c.concat(B),!1}),c}};function De(u,e={row:0,col:0},s=new ve,c=new Map){if(c.has(u))return c.get(u);try{s.handleCell=(A,$)=>A?A.formula?De(A.formula,$,s,c).result:[A.value]:[];let m={result:[],expressionStr:""};c.set(u,m);let v=new xe(u).scan(),N=new Ce(v).parse(),D=new Me(N,e,s).interpret(),F=[];for(let A of N)F.push(A.toString());m.expressionStr=F.join("");for(let A of D)typeof A=="number"&&!isNaN(A)?m.result.push(dt(A)):m.result.push(A);return m}catch(m){if(m instanceof M){let v={result:[m.value]};return c.set(u,v),v}throw m}}var Ue="_test_",ve=class{constructor(){this.map=new Map;this.definedNameMap=new Map;this.currentSheetId=Ue;this.sheetList=[{sheetId:Ue,name:"_test_",rowCount:200,colCount:30,isHide:!1,sort:1}];this.getFunction=e=>Ee[e];this.handleCell=(e,s)=>e?[e.value]:[]}getKey(e,s,c){return`${e}_${s}_${c||Ue}`}setSheetList(e){this.sheetList=e}set(e,s){let{row:c,col:m,sheetId:v}=e;for(let N=0;N<s.length;N++)for(let D=0;D<s[N].length;D++){let F=this.getKey(c+N,m+D,v),A=s[N][D];typeof A=="string"&&st(A)?this.map.set(F,{formula:A,value:""}):this.map.set(F,{value:A})}}getCell(e){let{row:s,col:c,sheetId:m}=e,v=this.getKey(s,c,m);return this.map.get(v)}getSheetInfo(e,s){if(s)return this.sheetList.find(m=>m.name===s);let c=e||this.currentSheetId;return this.sheetList.find(m=>m.sheetId===c)}setDefinedName(e,s){this.definedNameMap.set(e,s)}getDefinedName(e){return this.definedNameMap.get(e)}};function rr(u){let{currentSheetId:e,worksheets:s,workbook:c,definedNames:m}=u,v=new Map,N=s[e]||{},D=[],F={handleCell:()=>[],getFunction:A=>Ee[A],getCell:A=>{let{row:$,col:B,sheetId:X}=A,z=s[X||e]||{},H=rt($,B);return z[H]},set:()=>{throw new M("#REF!")},getSheetInfo:(A,$)=>{if($)return c.find(X=>X.name===$);let B=A||e;return c.find(X=>X.sheetId===B)},setDefinedName:()=>{throw new M("#REF!")},getDefinedName:A=>m[A]};for(let[A,$]of Object.entries(N)){if(!$?.formula)continue;let B=De($?.formula,nt(A),F,v);if(!B)continue;let X=B.result[0];X!==$.value&&D.push({key:A,newValue:X,sheetId:e})}return D}var Ge=Mt(mt());function dn(u,e,s={}){return Ge.default.format(e||et,u,s)}function En(u){return u?Ge.default.is_date(u):!1}function xn(u,e){let s=new Date(1899,11,31,0,0,0),c=s.getTime(),m=new Date(1900,2,1,0,0,0),v=u.getTime();return e?v-=1461*24*60*60*1e3:u>=m&&(v+=24*60*60*1e3),(v-(c+(u.getTimezoneOffset()-s.getTimezoneOffset())*6e4))/(24*60*60*1e3)}export{M as a,Ee as b,De as c,rr as d,dn as e,En as f,xn as g};
//# sourceMappingURL=chunk-R7J4CDNN.js.map
