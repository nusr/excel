{
  "version": 3,
  "sources": ["external-package:react-dom", "../node_modules/react-dom/client.js", "../src/util/constant.ts", "../src/util/util.ts", "../src/util/lodash.ts", "../src/util/theme/size.ts", "../src/util/theme/zIndex.ts", "../src/util/theme/convert.ts", "../src/util/theme/color.ts", "../src/util/theme/index.ts", "../src/util/dpr.ts", "../src/util/style.ts", "../src/containers/components/Button/index.tsx", "../src/containers/components/Button/index.module.css", "../src/containers/components/Github/index.tsx", "../src/containers/components/Github/index.module.css", "../src/containers/components/BaseIcon/icon.ts", "../src/containers/components/BaseIcon/BaseIcon.module.css", "../src/containers/components/BaseIcon/BaseIcon.tsx", "../src/containers/components/BaseIcon/FillColorIcon.tsx", "../src/containers/components/BaseIcon/index.tsx", "../src/containers/components/Select/index.tsx", "../src/containers/components/Select/index.module.css", "../src/containers/components/Dialog/index.tsx", "../src/containers/components/Dialog/index.module.css", "../src/i18n/lang/en.json", "../src/i18n/lang/zh.json", "../src/i18n/index.ts", "../src/containers/components/Menu/index.tsx", "../src/containers/components/Menu/index.module.css", "../src/containers/hooks/useClickOutSide.ts", "../src/containers/hooks/useEventCallback.ts", "../src/containers/components/Toast/index.tsx", "../src/containers/components/Toast/index.module.css", "../src/containers/components/Loading/index.tsx", "../src/containers/components/Loading/index.module.css", "../src/containers/components/ColorPicker/index.tsx", "../src/containers/components/ColorPicker/index.module.css", "../src/containers/components/ColorPicker/ColorPickerPanel.tsx", "../src/containers/components/ColorPicker/Hue.tsx", "../src/containers/components/ColorPicker/Interactive.tsx", "../src/containers/components/ColorPicker/clamp.ts", "../src/containers/components/ColorPicker/panel.module.css", "../src/containers/components/ColorPicker/Pointer.tsx", "../src/containers/components/ColorPicker/round.ts", "../src/containers/components/ColorPicker/convert.ts", "../src/containers/components/ColorPicker/Saturation.tsx", "../src/containers/components/ColorPicker/useColorManipulation.ts", "../src/containers/components/ColorPicker/color.ts", "../src/util/assert.ts", "../src/util/convert.ts", "../src/util/classnames.ts", "../src/util/range.ts", "../src/util/reference.ts", "../src/util/debug.ts", "../src/util/font.ts", "../src/util/isSupportFontFamily.ts", "../src/util/copy.ts", "../src/util/event.ts", "../src/util/saveAs.ts", "../src/util/color.ts"],
  "sourcesContent": ["module.exports = window.ReactDOM", "'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n", "import { ErrorTypes, NumberFormatItem, LanguageType } from '@/types';\n\nexport const LANGUAGE_LIST: LanguageType[] = ['en', 'zh'];\nexport const SHEET_NAME_PREFIX = 'Sheet';\nexport const DEFAULT_ROW_COUNT = 200;\nexport const DEFAULT_COL_COUNT = 30;\nexport const TEST_ID_KEY = 'data-testid';\nexport const SCROLL_SIZE = 30;\nexport const BOTTOM_BUFF = 200;\nexport const DEFAULT_POSITION = -999;\nexport const FORMULA_PREFIX = '=';\nexport const SPLITTER = '_';\nexport const DEBUG_COLOR_LIST = [\n  '#0000CC',\n  '#0000FF',\n  '#0033CC',\n  '#0033FF',\n  '#0066CC',\n  '#0066FF',\n  '#0099CC',\n  '#0099FF',\n  '#00CC00',\n  '#00CC33',\n  '#00CC66',\n  '#00CC99',\n  '#00CCCC',\n  '#00CCFF',\n  '#3300CC',\n  '#3300FF',\n  '#3333CC',\n  '#3333FF',\n  '#3366CC',\n  '#3366FF',\n  '#3399CC',\n  '#3399FF',\n  '#33CC00',\n  '#33CC33',\n  '#33CC66',\n  '#33CC99',\n  '#33CCCC',\n  '#33CCFF',\n  '#6600CC',\n  '#6600FF',\n  '#6633CC',\n  '#6633FF',\n  '#66CC00',\n  '#66CC33',\n  '#9900CC',\n  '#9900FF',\n  '#9933CC',\n  '#9933FF',\n  '#99CC00',\n  '#99CC33',\n  '#CC0000',\n  '#CC0033',\n  '#CC0066',\n  '#CC0099',\n  '#CC00CC',\n  '#CC00FF',\n  '#CC3300',\n  '#CC3333',\n  '#CC3366',\n  '#CC3399',\n  '#CC33CC',\n  '#CC33FF',\n  '#CC6600',\n  '#CC6633',\n  '#CC9900',\n  '#CC9933',\n  '#CCCC00',\n  '#CCCC33',\n  '#FF0000',\n  '#FF0033',\n  '#FF0066',\n  '#FF0099',\n  '#FF00CC',\n  '#FF00FF',\n  '#FF3300',\n  '#FF3333',\n  '#FF3366',\n  '#FF3399',\n  '#FF33CC',\n  '#FF33FF',\n  '#FF6600',\n  '#FF6633',\n  '#FF9900',\n  '#FF9933',\n  '#FFCC00',\n  '#FFCC33',\n];\nexport const MAX_PARAMS_COUNT = 256;\n\nexport const ERROR_SET = new Set<ErrorTypes>([\n  '#ERROR!',\n  '#DIV/0!',\n  '#NULL!',\n  '#NUM!',\n  '#REF!',\n  '#VALUE!',\n  '#N/A',\n  '#NAME?',\n]);\n\nexport const NUMBER_FORMAT_LIST: NumberFormatItem[] = [\n  { formatCode: 'general', label: '', id: 0 },\n  { formatCode: '0', label: '', id: 1 },\n  { formatCode: '0.00', label: '', id: 2 },\n  { formatCode: '#,##0', label: '', id: 3 },\n  { formatCode: '#,##0.00', label: '', id: 4 },\n  { formatCode: '0%', label: '', id: 9 },\n  { formatCode: '0.00%', label: '', id: 10 },\n  { formatCode: '0.00E+00', label: '', id: 11 },\n  { formatCode: '# ?/?', label: '', id: 12 },\n  { formatCode: '# ??/??', label: '', id: 13 },\n  { formatCode: 'mm-dd-yy', label: '', id: 14 },\n  { formatCode: 'd-mmm-yy', label: '', id: 15 },\n  { formatCode: 'd-mmm', label: '', id: 16 },\n  { formatCode: 'mmm-yy', label: '', id: 17 },\n  { formatCode: 'h:mm AM/PM', label: '', id: 18 },\n  { formatCode: 'h:mm:ss AM/PM', label: '', id: 19 },\n  { formatCode: 'hh:mm', label: '', id: 20 },\n  { formatCode: 'hh:mm:ss', label: '', id: 21 },\n  { formatCode: 'm/d/yy hh:mm', label: '', id: 22 },\n  { formatCode: '#,##0 ;(#,##0)', label: '', id: 37 },\n  { formatCode: '#,##0 ;[red](#,##0)', label: '', id: 38 },\n  { formatCode: '#,##0.00 ;(#,##0.00)', label: '', id: 39 },\n  { formatCode: '#,##0.00 ;[red](#,##0.00)', label: '', id: 40 },\n  {\n    formatCode: '_(* #,##0_);_(* \\\\(#,##0\\\\);_(* \"-\"_);_(@_)',\n    label: '',\n    id: 41,\n  },\n  {\n    formatCode: '_(\"$\"* #,##0_);_(\"$\"* \\\\(#,##0\\\\);_(\"$\"* \"-\"_);_(@_)',\n    label: '',\n    id: 42,\n  },\n  {\n    formatCode: '_(* #,##0.00_);_(* \\\\(#,##0.00\\\\);_(* \"-\"??_);_(@_)',\n    label: '',\n    id: 43,\n  },\n  {\n    formatCode: '_(\"$\"* #,##0.00_);_(\"$\"* \\\\(#,##0.00\\\\);_(\"$\"* \"-\"??_);_(@_)',\n    label: '',\n    id: 44,\n  },\n  { formatCode: 'mm:ss', label: '', id: 45 },\n  { formatCode: '[h]:mm:ss', label: '', id: 46 },\n  { formatCode: 'mm:ss.0', label: '', id: 47 },\n  { formatCode: '##0.0E+0', label: '', id: 48 },\n  { formatCode: '@', label: '', id: 49 },\n];\nexport const CELL_HEIGHT = 24;\nexport const CELL_WIDTH = 68;\nexport const HIDE_CELL = 0;\nexport const XLSX_MAX_COL_COUNT = 16384; // XFD\nexport const XLSX_MAX_ROW_COUNT = 1048576;\n", "import { SHEET_NAME_PREFIX, SPLITTER } from './constant';\nimport type { WorksheetType, ResultType, Coordinate } from '@/types';\n\nexport function isNumber(value: any): boolean {\n  if (typeof value === 'number' && !window.isNaN(value)) {\n    return true;\n  }\n  if (typeof value !== 'string') {\n    return false;\n  }\n  const temp = parseFloat(value);\n  return !window.isNaN(temp);\n}\n\nexport function parseNumber(value: any): number {\n  if (isNumber(value)) {\n    return Number(value);\n  }\n  return 0;\n}\n\nexport function parseNumberArray(list: any[]): number[] {\n  const result: number[] = [];\n  for (let i = 0; i < list.length; i++) {\n    const temp = parseNumber(list[i]);\n    if (!window.isNaN(temp)) {\n      result.push(temp);\n    }\n  }\n  return result;\n}\n\nexport function getListMaxNum(list: string[] = []): number {\n  const idList: number[] = list\n    .map((item) => {\n      if (isNumber(item)) {\n        return parseInt(item, 10);\n      }\n      return 0;\n    })\n    .filter((v) => !isNaN(v));\n  return Math.max(Math.max(...idList), 0);\n}\n\nexport function getDefaultSheetInfo(\n  list: WorksheetType[] = [],\n): Pick<WorksheetType, 'name' | 'sheetId'> {\n  const sheetId = getListMaxNum(list.map((item) => item.sheetId)) + 1;\n  return {\n    name: `${SHEET_NAME_PREFIX}${sheetId}`,\n    sheetId: String(sheetId),\n  };\n}\n\nexport function splitToWords(str: string): string[] {\n  if (!str) {\n    return [];\n  }\n  // unicode\n  if (!Intl || !Intl.Segmenter) {\n    // firefox\n    return [...str];\n  }\n  // graphemer\n  const list = new Intl.Segmenter([], { granularity: 'word' }).segment(str);\n  const arr = [...list];\n  return arr.map((x) => x.segment);\n}\n\nexport function convertResultTypeToString(value: ResultType): string {\n  let text = String(value);\n  if (\n    typeof value === 'boolean' ||\n    ['TRUE', 'FALSE'].includes(text.toUpperCase())\n  ) {\n    text = text.toUpperCase();\n  } else if (value === undefined || value === null) {\n    text = '';\n  }\n  return text;\n}\n\nexport function coordinateToString(\n  row: number,\n  col: number,\n): `${number}_${number}` {\n  return `${row}${SPLITTER}${col}`;\n}\n\nexport function stringToCoordinate(key: string): Coordinate {\n  const [row, col] = key.split(SPLITTER);\n  const r = parseInt(row, 10);\n  const c = parseInt(col, 10);\n  return {\n    row: isNaN(r) ? 0 : r,\n    col: isNaN(c) ? 0 : c,\n  };\n}\n\nexport function getCustomWidthOrHeightKey(\n  sheetId: string,\n  rowOrCol: number,\n): `${string}_${number}` {\n  return `${sheetId}${SPLITTER}${rowOrCol}`;\n}\n\nexport function generateUUID() {\n  if (typeof crypto === 'object' && typeof crypto.randomUUID === 'function') {\n    return crypto.randomUUID();\n  }\n\n  let d = new Date().getTime();\n\n  const uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(\n    /[xy]/g,\n    function (c) {\n      const r = (d + Math.random() * 16) % 16 | 0;\n      d = Math.floor(d / 16);\n      return (c === 'x' ? r : (r & 0x3) | 0x8).toString(16);\n    },\n  );\n\n  return uuid;\n}\n\nexport function isMobile() {\n  const matchList = [\n    /Android/i,\n    /webOS/i,\n    /iPhone/i,\n    /iPad/i,\n    /iPod/i,\n    /BlackBerry/i,\n    /Windows Phone/i,\n  ];\n  const ua = navigator.userAgent;\n  return matchList.some((v) => ua.match(v));\n}\n", "type Params = any[];\nexport const debounce = (\n  fn: (...params: Params) => void,\n  wait: number = 500,\n) => {\n  let timer: ReturnType<typeof setTimeout> | null = null;\n  return function (...rest: Params) {\n    if (timer) {\n      clearTimeout(timer);\n    }\n    timer = setTimeout(() => {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      fn.apply(this, rest);\n      timer = null;\n    }, wait);\n  };\n};\nexport function throttle(fn: (...params: Params) => void, wait: number = 500) {\n  let check = false;\n  let lastArgs: Params | null = null;\n  return function (...args: Params) {\n    if (check) {\n      lastArgs = args;\n    } else {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      fn.apply(this, args);\n      setTimeout(() => {\n        if (lastArgs) {\n          // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n          // @ts-ignore\n          fn.apply(this, lastArgs);\n        }\n        check = false;\n      }, wait);\n    }\n  };\n}\n\nexport function get<T>(\n  obj: Record<string, any> | null | undefined,\n  path: string,\n  defaultValue?: T,\n): T {\n  const result =\n    obj == null\n      ? undefined\n      : path\n          .replace(/\\[/g, '.')\n          .replace(/\\]/g, '')\n          .split('.')\n          .reduce((res, key) => {\n            return res == null ? res : res[key];\n          }, obj);\n  return (result === undefined ? defaultValue : result) as T;\n}\n\nexport function isEmpty(value: unknown): boolean {\n  const temp: any = value || {};\n  return (\n    [Object, Array].includes(temp.constructor) && !Object.entries(temp).length\n  );\n}\n\nexport function setWith<ValueType>(\n  obj: Record<string, any> | null | undefined,\n  path: string,\n  value: ValueType,\n): Record<string, any> | null | undefined {\n  if (obj == null || typeof obj !== 'object') {\n    return obj;\n  }\n  path\n    .replace(/\\[/g, '.')\n    .replace(/\\]/g, '')\n    .split('.')\n    .reduce((res, key, index, arr) => {\n      if (index === arr.length - 1) {\n        res[key] = value;\n      } else if (res[key] === null || res[key] === undefined) {\n        res[key] = {};\n      }\n      return res[key];\n    }, obj);\n  return obj;\n}\n\nexport function deepEqual(x: any, y: any) {\n  if (x === y) {\n    return true;\n  }\n  if (x && typeof x === 'object' && y && typeof y === 'object') {\n    if (Object.keys(x).length !== Object.keys(y).length) {\n      return false;\n    }\n    const keys1 = Object.keys(x);\n    const keys2 = Object.keys(y);\n    for (let i = 0; i < keys1.length; i++) {\n      const key1 = keys1[i];\n      const key2 = keys2[i];\n      if (key1 !== key2 || !deepEqual(x[key1], y[key2])) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return false;\n}\n\nexport function camelCase(str: string) {\n  const a = str\n    .toLowerCase()\n    .replace(/[-_\\s.]+(.)?/g, (_, c) => (c ? c.toUpperCase() : ''));\n  return a.substring(0, 1).toLowerCase() + a.substring(1);\n}\n", "const size = {\n  smallFont: '10px',\n  font: '12px',\n  largeFont: '14px',\n  padding: '12px',\n  lineHeight: 1.5,\n  mediumPadding: '8px',\n  largePadding: '20px',\n  borderRadius: '4px',\n  borderLargeRadius: '8px',\n  tinyPadding: '4px',\n  scrollBarSize: '18px',\n};\nexport default size;\n", "const zIndex = {\n  lowZIndex: 2,\n  middleZIndex: 3,\n  highZIndex: 4,\n  highestZIndex: 9,\n};\nexport default zIndex;\n", "function hslaToHex(h: number, s: number, l: number, alpha: number) {\n  s = s / 100; // Convert percentage to decimal\n  l = l / 100; // Convert percentage to decimal\n\n  // Convert HSL to RGB\n  const c = (1 - Math.abs(2 * l - 1)) * s;\n  const x = c * (1 - Math.abs(((h / 60) % 2) - 1));\n  const m = l - c / 2;\n\n  let r, g, b;\n\n  if (h >= 0 && h < 60) {\n    r = c;\n    g = x;\n    b = 0;\n  } else if (h >= 60 && h < 120) {\n    r = x;\n    g = c;\n    b = 0;\n  } else if (h >= 120 && h < 180) {\n    r = 0;\n    g = c;\n    b = x;\n  } else if (h >= 180 && h < 240) {\n    r = 0;\n    g = x;\n    b = c;\n  } else if (h >= 240 && h < 300) {\n    r = x;\n    g = 0;\n    b = c;\n  } else {\n    r = c;\n    g = 0;\n    b = x;\n  }\n  if (alpha !== 1) {\n    return `rgba(${r},${g},${b},${alpha})`;\n  }\n\n  // Adjust RGB values and convert to HEX\n  const toHex = (value: number) =>\n    Math.round(value * 255)\n      .toString(16)\n      .padStart(2, '0');\n  const hexR = toHex(r + m);\n  const hexG = toHex(g + m);\n  const hexB = toHex(b + m);\n\n  // Combine the values and return the HEX color\n  return `#${hexR}${hexG}${hexB}`;\n}\n\nconst RGBToHSL = (red: number, green: number, blue: number) => {\n  // Make r, g, and b fractions of 1\n  const r = red / 255;\n  const g = green / 255;\n  const b = blue / 255;\n\n  // Find greatest and smallest channel values\n  const cmin = Math.min(r, g, b);\n  const cmax = Math.max(r, g, b);\n  const delta = cmax - cmin;\n  const hue = getHue(r, g, b);\n  const lightness = getLightness(cmax, cmin);\n  const saturation = getSaturation(delta, lightness);\n\n  return [hue, saturation * 100, lightness * 100];\n};\n\nconst getHue = (r: number, g: number, b: number) => {\n  const max = Math.max(r, g, b);\n  const min = Math.min(r, g, b);\n  const c = max - min;\n  let hue: number = 0;\n  if (c == 0) {\n    hue = 0;\n  } else {\n    switch (max) {\n      case r: {\n        let segment = (g - b) / c;\n        let shift = 0; // R\u00B0 / (360\u00B0 / hex sides)\n        if (segment < 0) {\n          // hue > 180, full rotation\n          shift = 360 / 60; // R\u00B0 / (360\u00B0 / hex sides)\n        }\n        hue = segment + shift;\n        break;\n      }\n\n      case g: {\n        let segment = (b - r) / c;\n        let shift = 120 / 60; // G\u00B0 / (360\u00B0 / hex sides)\n        hue = segment + shift;\n        break;\n      }\n\n      case b:\n        let segment = (r - g) / c;\n        let shift = 240 / 60; // B\u00B0 / (360\u00B0 / hex sides)\n        hue = segment + shift;\n        break;\n    }\n  }\n  return hue * 60; // hue is in [0,6], scale it up\n};\n\nconst getSaturation = (delta: number, lightness: number) =>\n  delta == 0 ? 0 : delta / (1 - Math.abs(2 * lightness - 1));\n\nconst getLightness = (cmax: number, cmin: number) => (cmax + cmin) / 2;\n\nconst fullDarkMode = ([red, green, blue, alpha]: number[]) => {\n  const [hue, saturation, lightness] = RGBToHSL(red, green, blue);\n  return hslaToHex(hue, saturation * 0.9, 100 - lightness, alpha);\n};\n\nfunction hexToRgba(hex: string) {\n  if (hex.startsWith('#')) {\n    hex = hex.slice(1);\n  }\n\n  let r = parseInt(hex.substring(0, 2), 16);\n  let g = parseInt(hex.substring(2, 4), 16);\n  let b = parseInt(hex.substring(4, 6), 16);\n  let a = parseInt(hex.substring(6, 8) || 'ff', 16);\n  return [r, g, b, a / 255];\n}\n\nexport const convertColorToDark = (color: string) => {\n  if (color.startsWith('rgb')) {\n    const t = color\n      .replace('rgb', '')\n      .replace('a', '')\n      .replace('(', '')\n      .replace(')', '');\n    const list = t.split(',').map(Number);\n    if (list.length <= 3) {\n      list.push(1);\n    }\n    return fullDarkMode(list);\n  } else {\n    return fullDarkMode(hexToRgba(color));\n  }\n};\n", "import { convertColorToDark } from './convert';\n\nexport const lightColor = Object.freeze({\n  primaryColor: '#217346',\n  buttonActiveColor: '#c6c6c6',\n  selectionColor: 'rgba(198,198,198,0.3)',\n  backgroundColor: '#e6e6e6',\n  hoverColor: 'rgba(0, 0, 0, 0.04)',\n  scrollbarColor: 'rgba(0, 0, 0, 0.1)',\n  scrollbarHoveColor: 'rgba(0, 0, 0, 0.2)',\n  dialogBackground: 'rgba(0, 0, 0, 0.6)',\n  white: '#ffffff',\n  black: '#000000',\n  triangleFillColor: '#dddddd',\n  contentColor: '#333333',\n  borderColor: '#cccccc',\n  activeBorderColor: '#808080',\n  errorFormulaColor: '#ff0000',\n});\n\nexport const darkColor = Object.freeze(\n  Object.fromEntries(\n    Object.entries(lightColor).map(([k, v]) => [k, convertColorToDark(v)]),\n  ),\n);\n", "import { ThemeType } from '@/types';\nimport size from './size';\nimport zIndex from './zIndex';\n\nimport { lightColor, darkColor } from './color';\nexport const sizeConfig = {\n  ...size,\n  ...zIndex,\n};\n\nexport { darkColor, lightColor };\nconst themeKey = 'data-theme' as const;\n\nexport function setTheme(value: ThemeType) {\n  sessionStorage.setItem(themeKey, value);\n  document.documentElement.setAttribute(themeKey, value);\n}\nexport function getTheme(): ThemeType {\n  const l = sessionStorage.getItem(themeKey);\n  if (l && (l === 'dark' || l === 'light')) {\n    return l as ThemeType;\n  }\n  if (window.matchMedia && typeof window.matchMedia === 'function') {\n    return window.matchMedia('(prefers-color-scheme: dark)').matches\n      ? 'dark'\n      : 'light';\n  }\n  return 'light';\n}\n\nexport function getThemeColor(key: keyof typeof lightColor) {\n  if (getTheme() === 'dark') {\n    return darkColor[key];\n  } else {\n    return lightColor[key];\n  }\n}\n", "export function dpr(data = window.devicePixelRatio): number {\n  return Math.max(Math.floor(data || 1), 1);\n}\n\nexport function npx(px: number): number {\n  return Math.floor(px * dpr());\n}\n\nexport function thinLineWidth(): number {\n  return 1;\n}\n\nexport function isMac() {\n  return navigator.userAgent.indexOf('Mac OS X') > -1;\n}\n", "/**\n * font-style:  none | normal | italic | oblique\n * font-variant none | normal | small-caps // \u4F5C\u7528\u4E0D\u5927\n * font-weight  none | normal | bold | \u6570\u5B57\n * font-size\n * line-height\n * font-family\n * e.g italic bold 14px/16px sans-serif;\n */\nimport { npx } from './dpr';\nimport { EUnderLine, StyleType } from '@/types';\n\nexport const DEFAULT_FONT_SIZE = 11;\nexport const MUST_FONT_FAMILY = 'sans-serif';\n\nexport const FONT_SIZE_LIST = [\n  6,\n  8,\n  9,\n  10,\n  DEFAULT_FONT_SIZE,\n  12,\n  14,\n  16,\n  18,\n  20,\n  22,\n  24,\n  26,\n  28,\n  36,\n  48,\n  72,\n];\n\nexport function makeFont(\n  fontStyle: 'none' | 'normal' | 'italic' | 'oblique' = 'normal',\n  fontWeight = 'normal',\n  fontSize = 12,\n  fontFamily = '',\n): string {\n  const temp = `${fontStyle} ${fontWeight} ${fontSize}px `;\n  if (!fontFamily) {\n    return temp + MUST_FONT_FAMILY;\n  }\n  return `${temp}${fontFamily},${MUST_FONT_FAMILY}`;\n}\n\nexport const DEFAULT_FONT_CONFIG = makeFont(\n  undefined,\n  '500',\n  npx(DEFAULT_FONT_SIZE),\n);\n\nexport function convertToCssString(style: Partial<StyleType>): string {\n  let result = '';\n  if (style.fontColor) {\n    result += `color:${style.fontColor};`;\n  }\n  if (style.fillColor) {\n    result += `background-color:${style.fillColor};`;\n  }\n  if (style.fontSize) {\n    result += `font-size:${style.fontSize}pt;`;\n  }\n  if (style.fontFamily) {\n    result += `font-family:${style.fontFamily};`;\n  }\n  if (style.isItalic) {\n    result += 'font-style:italic;';\n  }\n  if (style.isBold) {\n    result += 'font-weight:700;';\n  }\n  if (style.isWrapText) {\n    result += 'white-space:normal;';\n  }\n  if (style.underline && style.isStrike) {\n    result += 'text-decoration-line:underline line-through;';\n  } else if (style.underline) {\n    result += 'text-decoration-line:underline;';\n  } else if (style.isStrike) {\n    result += 'text-decoration-line:line-through;';\n  }\n  if (style.underline === EUnderLine.DOUBLE) {\n    result += 'text-decoration-style: double;';\n  }\n\n  return result;\n}\n\nfunction pickCSSStyle(style: Partial<CSSStyleDeclaration>): Partial<StyleType> {\n  const {\n    color,\n    backgroundColor,\n    fontSize,\n    fontFamily,\n    fontStyle,\n    fontWeight,\n    whiteSpace,\n    textDecorationLine,\n    textDecorationStyle,\n  } = style;\n  const result: Partial<StyleType> = {};\n  if (color) {\n    result.fontColor = color;\n  }\n  if (backgroundColor) {\n    result.fillColor = backgroundColor;\n  }\n  if (fontSize) {\n    const size = parseInt(fontSize, 10);\n    if (!isNaN(size)) {\n      result.fontSize = size;\n    }\n  }\n  if (fontFamily) {\n    result.fontFamily = fontFamily;\n  }\n  if (fontStyle === 'italic') {\n    result.isItalic = true;\n  }\n  if (fontWeight && ['700', '800', '900', 'bold'].includes(fontWeight)) {\n    result.isBold = true;\n  }\n  if (\n    whiteSpace &&\n    [\n      'normal',\n      'pre-wrap',\n      'pre-line',\n      'break-spaces',\n      'revert',\n      'unset',\n    ].includes(whiteSpace)\n  ) {\n    result.isWrapText = true;\n  }\n  if (textDecorationLine?.includes('underline')) {\n    result.underline = EUnderLine.SINGLE;\n    if (textDecorationStyle === 'double') {\n      result.underline = EUnderLine.DOUBLE;\n    }\n  }\n  if (textDecorationLine?.includes('line-through')) {\n    result.isStrike = true;\n  }\n  return result;\n}\n\nfunction parseStyle(\n  styleMap: Record<string, CSSStyleDeclaration>,\n  style: CSSStyleDeclaration,\n  className: string,\n  tagName: string,\n): Partial<StyleType> {\n  let result: Partial<StyleType> = {};\n  const t = styleMap[tagName] || styleMap[tagName.toLowerCase()];\n  if (t) {\n    result = pickCSSStyle(t);\n  }\n  if (styleMap[className]) {\n    result = Object.assign(result, pickCSSStyle(styleMap[className]));\n  }\n\n  result = Object.assign(result, pickCSSStyle(style));\n\n  if (tagName === 's' || tagName === 'strike') {\n    result.isStrike = true;\n  } else if (tagName === 'i') {\n    result.isItalic = true;\n  } else if (tagName === 'b' || tagName === 'strong') {\n    result.isBold = true;\n  } else if (tagName === 'u') {\n    result.underline = EUnderLine.SINGLE;\n  }\n  return result;\n}\n\nfunction convertToCssStyleDeclaration(cssStr: string) {\n  const str = cssStr.replace(/\\s+/g, '').replace('<!--', '');\n  const regex = /([^{}]+)\\s*\\{([^}]*)\\}/g;\n  const matches: Record<string, Partial<CSSStyleDeclaration>> = {};\n  let match;\n  while ((match = regex.exec(str)) !== null) {\n    let div: HTMLDivElement | null = document.createElement('div');\n    div.style.cssText = match[2];\n    const key = match[1].trim();\n    matches[key] = div.style;\n    div = null;\n  }\n  return matches;\n}\n\nexport function parseHTML(html: string) {\n  let template: HTMLTemplateElement | null = document.createElement('template');\n  template.innerHTML = html;\n  const doc = template.content;\n  const styleMap: Record<string, CSSStyleDeclaration> = {};\n  for (const item of doc.querySelectorAll('style')) {\n    const temp = convertToCssStyleDeclaration(item.textContent || '');\n    for (const [key, value] of Object.entries(temp)) {\n      styleMap[key] = Object.assign(styleMap[key] || {}, value);\n    }\n  }\n  const textList: string[][] = [];\n  const styleList: Array<Array<Partial<StyleType>>> = [];\n  // TODO col width and row height\n  // const colList = doc.querySelectorAll('col');\n  const trList = doc.querySelectorAll('tr');\n  for (const tr of trList) {\n    const texts: string[] = [];\n    const list: Array<Partial<StyleType>> = [];\n    for (const td of tr.children) {\n      if (td.tagName !== 'TD') {\n        continue;\n      }\n      let temp = td as HTMLElement;\n      let itemStyle: Partial<StyleType> = {};\n      while (temp.nodeType !== Node.TEXT_NODE) {\n        const style = parseStyle(\n          styleMap,\n          temp.style,\n          temp.className ? `.${temp.className}` : '',\n          temp.tagName,\n        );\n        itemStyle = Object.assign(itemStyle, style);\n        if (temp.firstChild) {\n          temp = temp.firstChild as HTMLElement;\n        } else {\n          break;\n        }\n      }\n      list.push(itemStyle);\n      texts.push(temp.textContent || '');\n    }\n    textList.push(texts);\n    styleList.push(list);\n  }\n  template = null;\n  return {\n    textList,\n    styleList,\n  };\n}\n", "import React, { FunctionComponent, CSSProperties } from 'react';\nimport { classnames } from '@/util';\nimport styles from './index.module.css';\n\nexport interface ButtonProps {\n  type?: 'normal' | 'circle' | 'plain' | 'primary';\n  style?: CSSProperties;\n  active?: boolean;\n  disabled?: boolean;\n  onClick?: React.MouseEventHandler<HTMLButtonElement>;\n  className?: string;\n  title?: string;\n  testId?: string;\n  dataType?: string;\n  buttonType?: React.ButtonHTMLAttributes<string>['type'];\n}\n\nexport const Button: FunctionComponent<React.PropsWithChildren<ButtonProps>> = (\n  props,\n) => {\n  const {\n    className = '',\n    onClick = () => {},\n    disabled = false,\n    active = false,\n    type = 'normal',\n    style = {},\n    testId = undefined,\n    title,\n    dataType,\n    buttonType,\n    children,\n  } = props;\n  const cls = classnames(styles.buttonWrapper, className, {\n    [styles['disabled']]: disabled,\n    [styles['active']]: active,\n    [styles['circle']]: type === 'circle',\n    [styles['plain']]: type === 'plain',\n    [styles['primary']]: type === 'primary',\n  });\n  return (\n    <button\n      onClick={onClick}\n      style={style}\n      title={title}\n      className={cls}\n      data-testid={testId}\n      data-type={dataType}\n      type={buttonType}\n    >\n      {children}\n    </button>\n  );\n};\nButton.displayName = 'Button';\n", ".buttonWrapper {\n  padding: 0 4px;\n  min-width: 20px;\n  height: 20px;\n  line-height: 20px;\n  text-align: center;\n  box-sizing: border-box;\n  cursor: pointer;\n  border-radius: var(--borderRadius);\n  border: 1px solid var(--activeBorderColor);\n  display: block;\n  background-color: var(--white);\n  color: var(--black);\n}\n\n.buttonWrapper.circle {\n  border-radius: 50%;\n}\n.buttonWrapper.disabled {\n  cursor: not-allowed;\n  opacity: 0.35;\n}\n.buttonWrapper:hover,\n.buttonWrapper.active {\n  background-color: var(--buttonActiveColor);\n}\n.buttonWrapper.plain {\n  border: none;\n}\n.buttonWrapper.primary {\n  background-color: var(--primaryColor);\n  color: var(--white);\n}\n", "import React, { FunctionComponent } from 'react';\n\nimport styles from './index.module.css';\n\nconst pathStyle = {\n  transformOrigin: '130px 106px',\n};\n\nexport const Github: FunctionComponent = () => {\n  return (\n    <a\n      href=\"https://github.com/nusr/excel\"\n      aria-label=\"View source on Github\"\n      target=\"_blank\"\n      title=\"github link\"\n      rel=\"noreferrer\"\n    >\n      <svg className={styles.githubWrapper} viewBox=\"0 0 250 250\" aria-hidden>\n        <path d=\"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z\" />\n        <path\n          d=\"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2\"\n          fill=\"currentColor\"\n          style={pathStyle}\n        />\n        <path\n          d=\"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z\"\n          fill=\"currentColor\"\n          style={pathStyle}\n        />\n      </svg>\n    </a>\n  );\n};\nGithub.displayName = 'Github';\n", ".githubWrapper {\n  color: var(--white);\n  position: absolute;\n  top: 0;\n  border: 0;\n  right: 0;\n  fill: var(--primaryColor);\n  height: 40px;\n  width: 40px;\n}\n", "export type BaseIconName =\n  | 'alignCenter'\n  | 'alignLeft'\n  | 'alignRight'\n  | 'bold'\n  | 'fontColor'\n  | 'italic'\n  | 'middleAlign'\n  | 'plus'\n  | 'redo'\n  | 'underline'\n  | 'undo'\n  | 'success'\n  | 'info'\n  | 'warning'\n  | 'error'\n  | 'rotate'\n  | 'moon'\n  | 'sun';\n\nconst icon: Record<BaseIconName, string[]> = {\n  alignCenter: [\n    'M142.2 227.6h739.6v56.9H142.2zM142.2 568.9h739.6v56.9H142.2zM256 398.2h512v56.9H256zM256 739.6h512v56.9H256z',\n  ],\n  alignLeft: [\n    'M627.712 788.48c11.305 0 20.48-9.155 20.48-20.48s-9.175-20.48-20.48-20.48H218.46c-11.305 0-20.48 9.155-20.48 20.48s9.175 20.48 20.48 20.48h409.252zM832.86 583.68h-614.4c-11.305 0-20.48 9.155-20.48 20.48s9.175 20.48 20.48 20.48h614.4c11.305 0 20.48-9.155 20.48-20.48s-9.175-20.48-20.48-20.48zM832.86 256h-614.4c-11.305 0-20.48 9.155-20.48 20.48s9.175 20.48 20.48 20.48h614.4c11.305 0 20.48-9.155 20.48-20.48S844.165 256 832.86 256zM218.46 460.8h409.252c11.305 0 20.48-9.155 20.48-20.48s-9.175-20.48-20.48-20.48H218.46c-11.305 0-20.48 9.155-20.48 20.48s9.155 20.48 20.48 20.48z',\n  ],\n  alignRight: [\n    'M832.86 747.52H423.588a20.48 20.48 0 1 0 0 40.96H832.84a20.48 20.48 0 0 0 0.02-40.96z m20.48-143.36a20.48 20.48 0 0 0-20.48-20.48h-614.4a20.48 20.48 0 1 0 0 40.96h614.4a20.48 20.48 0 0 0 20.48-20.48zM832.86 256h-614.4a20.48 20.48 0 1 0 0 40.96h614.4a20.48 20.48 0 1 0 0-40.96z m0 163.84H423.588a20.48 20.48 0 1 0 0 40.96H832.84a20.48 20.48 0 0 0 0.02-40.96z',\n  ],\n  bold: [\n    'M724.342857 477.028571c38.4-40 61.942857-94.057143 61.942857-153.485714v-11.657143C786.285714 188.914286 685.6 89.142857 561.485714 89.142857H223.314286c-17.257143 0-31.314286 14.057143-31.314286 31.314286v776.114286c0 18.628571 15.085714 33.714286 33.714286 33.714285h364.228571c133.714286 0 242.057143-107.657143 242.057143-240.571428v-12.571429c0-83.428571-42.742857-156.914286-107.657143-200.114286zM301.714286 198.857143h256.8c65.257143 0 118.057143 50.742857 118.057143 113.485714v10.857143c0 62.628571-52.914286 113.485714-118.057143 113.485714H301.714286V198.857143z m418.971428 490.742857c0 71.885714-59.085714 130.171429-132 130.171429H301.714286V547.085714h286.971428c72.914286 0 132 58.285714 132 130.171429v12.342857z',\n  ],\n  fontColor: [\n    'M650.496 597.333333H373.504l-68.266667 170.666667H213.333333l256-640h85.333334l256 640h-91.904l-68.266667-170.666667z m-34.133333-85.333333L512 251.093333 407.637333 512h208.725334zM128 853.333333h768v85.333334H128v-85.333334z',\n  ],\n  italic: [\n    'M219.428571 949.714286l9.714286-48.571429q3.428571-1.142857 46.571429-12.285714t63.714286-21.428571q16-20 23.428571-57.714286 0.571429-4 35.428571-165.142857t65.142857-310.571429 29.714286-169.428571l0-14.285714q-13.714286-7.428571-31.142857-10.571429t-39.714286-4.571429-33.142857-3.142857l10.857143-58.857143q18.857143 1.142857 68.571429 3.714286t85.428571 4 68.857143 1.428571q27.428571 0 56.285714-1.428571t69.142857-4 56.285714-3.714286q-2.857143 22.285714-10.857143 50.857143-17.142857 5.714286-58 16.285714t-62 19.142857q-4.571429 10.857143-8 24.285714t-5.142857 22.857143-4.285714 26-3.714286 24q-15.428571 84.571429-50 239.714286t-44.285714 203.142857q-1.142857 5.142857-7.428571 33.142857t-11.428571 51.428571-9.142857 47.714286-3.428571 32.857143l0.571429 10.285714q9.714286 2.285714 105.714286 17.714286-1.714286 25.142857-9.142857 56.571429-6.285714 0-18.571429 0.857143t-18.571429 0.857143q-16.571429 0-49.714286-5.714286t-49.142857-5.714286q-78.857143-1.142857-117.714286-1.142857-29.142857 0-81.714286 5.142857t-69.142857 6.285714z',\n  ],\n  middleAlign: [\n    'M740.43392 788.48c11.30496 0 20.48-9.15456 20.48-20.48s-9.17504-20.48-20.48-20.48L331.18208 747.52c-11.30496 0-20.48 9.15456-20.48 20.48s9.17504 20.48 20.48 20.48L740.43392 788.48zM863.49824 604.16c0-11.32544-9.17504-20.48-20.48-20.48l-614.4 0c-11.30496 0-20.48 9.15456-20.48 20.48s9.17504 20.48 20.48 20.48l614.4 0C854.3232 624.64 863.49824 615.48544 863.49824 604.16zM208.13824 276.48c0 11.32544 9.17504 20.48 20.48 20.48l614.4 0c11.30496 0 20.48-9.15456 20.48-20.48s-9.17504-20.48-20.48-20.48l-614.4 0C217.2928 256 208.13824 265.15456 208.13824 276.48zM740.43392 460.8c11.30496 0 20.48-9.15456 20.48-20.48s-9.17504-20.48-20.48-20.48L331.18208 419.84c-11.30496 0-20.48 9.15456-20.48 20.48s9.17504 20.48 20.48 20.48L740.43392 460.8z',\n  ],\n  plus: [\n    'M896 468.571429H555.428571V100.571429h-86.857142v368H128c-5.028571 0-9.142857 4.114286-9.142857 9.142857v68.571428c0 5.028571 4.114286 9.142857 9.142857 9.142857h340.571429v368h86.857142V555.428571h340.571429c5.028571 0 9.142857-4.114286 9.142857-9.142857v-68.571428c0-5.028571-4.114286-9.142857-9.142857-9.142857z',\n  ],\n  redo: [\n    'M611.783111 569.344L549.622519 644.740741h284.444444l-65.498074-265.481482-59.922963 72.666074c-35.422815-28.48237-108.278519-68.342519-238.667852-68.342518-202.827852 0-280.651852 206.01363-280.651852 206.013629s116.318815-132.778667 246.215111-132.778666c97.204148-0.037926 153.865481 74.827852 176.241778 112.526222z',\n  ],\n  underline: [\n    'M512 725.333333c166.4 0 298.666667-132.266667 298.666667-298.666666V128c0-25.6-17.066667-42.666667-42.666667-42.666667s-42.666667 17.066667-42.666667 42.666667v298.666667c0 119.466667-93.866667 213.333333-213.333333 213.333333s-213.333333-93.866667-213.333333-213.333333V128c0-25.6-17.066667-42.666667-42.666667-42.666667s-42.666667 17.066667-42.666667 42.666667v298.666667c0 166.4 132.266667 298.666667 298.666667 298.666666zM853.333333 853.333333H170.666667c-25.6 0-42.666667 17.066667-42.666667 42.666667s17.066667 42.666667 42.666667 42.666667h682.666666c25.6 0 42.666667-17.066667 42.666667-42.666667s-17.066667-42.666667-42.666667-42.666667z',\n  ],\n  undo: [\n    'M489.244444 568.888889l60.681482 75.851852H265.481481l64.474075-265.481482 60.681481 72.05926c34.133333-30.340741 109.985185-68.266667 238.933333-68.266667 201.007407 0 280.651852 204.8 280.651852 204.8S792.651852 455.111111 663.703704 455.111111c-98.607407 0-155.496296 75.851852-174.45926 113.777778z',\n  ],\n  success: [\n    'M666.272 472.288l-175.616 192a31.904 31.904 0 0 1-23.616 10.4h-0.192a32 32 0 0 1-23.68-10.688l-85.728-96a32 32 0 1 1 47.744-42.624l62.144 69.6 151.712-165.888a32 32 0 1 1 47.232 43.2m-154.24-344.32C300.224 128 128 300.32 128 512c0 211.776 172.224 384 384 384 211.68 0 384-172.224 384-384 0-211.68-172.32-384-384-384',\n  ],\n  info: [\n    'M512 97.52381c228.912762 0 414.47619 185.563429 414.47619 414.47619s-185.563429 414.47619-414.47619 414.47619S97.52381 740.912762 97.52381 512 283.087238 97.52381 512 97.52381z m36.571429 341.333333h-73.142858v292.571428h73.142858V438.857143z m0-121.904762h-73.142858v73.142857h73.142858v-73.142857z',\n  ],\n  warning: [\n    'M512 64q190.016 4.992 316.512 131.488T960 512q-4.992 190.016-131.488 316.512T512 960q-190.016-4.992-316.512-131.488T64 512q4.992-190.016 131.488-316.512T512 64z m0 192q-26.016 0-43.008 19.008T453.984 320l23.008 256q2.016 14.016 11.488 22.496t23.488 8.512 23.488-8.512 11.488-22.496l23.008-256q2.016-26.016-15.008-44.992T511.936 256z m0 512q22.016-0.992 36.512-15.008t14.496-36-14.496-36.512T512 665.984t-36.512 14.496-14.496 36.512 14.496 36T512 768z',\n  ],\n  error: [\n    'M512 97.52381c228.912762 0 414.47619 185.563429 414.47619 414.47619s-185.563429 414.47619-414.47619 414.47619S97.52381 740.912762 97.52381 512 283.087238 97.52381 512 97.52381z m129.29219 233.447619l-129.267809 129.29219-129.316571-129.29219-51.736381 51.736381 129.316571 129.267809-129.316571 129.316571 51.736381 51.736381L512 563.687619l129.29219 129.316571 51.736381-51.73638L563.687619 512l129.316571-129.29219-51.73638-51.736381z',\n  ],\n  rotate: [\n    'M934.08 416.448h-220.352a46.4 46.4 0 0 1-47.232-47.232c0-26.752 20.48-47.232 47.232-47.232h173.184V148.8c0-26.752 20.48-47.168 47.168-47.168 26.816 0 47.232 20.48 47.232 47.168V369.28a47.36 47.36 0 0 1-47.232 47.232z',\n    'M509.056 978.432A470.976 470.976 0 0 1 38.4 507.712 470.976 470.976 0 0 1 509.056 37.12a472.32 472.32 0 0 1 434.56 288.064c9.408 23.68-1.6 51.968-25.216 61.44-23.68 9.408-51.968-1.6-61.44-25.216a377.92 377.92 0 0 0-347.904-229.824 376.192 376.192 0 1 0 0 752.448c190.528 0 351.104-141.696 373.12-328.96a47.36 47.36 0 0 1 51.904-40.96 47.36 47.36 0 0 1 40.96 51.904 469.504 469.504 0 0 1-465.92 412.48z',\n  ],\n  moon: [\n    'M735.996 244.2C693.136 221.106 644.1 208 592 208c-167.894 0-304 136.106-304 304s136.106 304 304 304c52.1 0 101.136-13.106 143.996-36.2C621.368 744.742 538 638.108 538 512s83.368-232.742 197.996-267.8z m26.32 86.064C683.17 354.472 628 427.888 628 512s55.168 157.528 134.318 181.736c76.442 23.378 86.74 127.376 16.37 165.294C721.764 889.702 657.958 906 592 906c-217.6 0-394-176.4-394-394S374.4 118 592 118c65.96 0 129.764 16.298 186.688 46.97 70.372 37.918 60.072 141.916-16.37 165.294z',\n  ],\n  sun: [\n    'M512 768c-140.8 0-256-115.2-256-256s115.2-256 256-256 256 115.2 256 256-115.2 256-256 256z m0-426.666667c-93.866667 0-170.666667 76.8-170.666667 170.666667s76.8 170.666667 170.666667 170.666667 170.666667-76.8 170.666667-170.666667-76.8-170.666667-170.666667-170.666667zM512 170.666667c-25.6 0-42.666667-17.066667-42.666667-42.666667V42.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667v85.333333c0 25.6-17.066667 42.666667-42.666667 42.666667zM512 1024c-25.6 0-42.666667-17.066667-42.666667-42.666667v-85.333333c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667v85.333333c0 25.6-17.066667 42.666667-42.666667 42.666667zM238.933333 281.6c-12.8 0-21.333333-4.266667-29.866666-12.8L149.333333 209.066667c-17.066667-17.066667-17.066667-42.666667 0-59.733334s42.666667-17.066667 59.733334 0l59.733333 59.733334c17.066667 17.066667 17.066667 42.666667 0 59.733333-4.266667 8.533333-17.066667 12.8-29.866667 12.8zM844.8 887.466667c-12.8 0-21.333333-4.266667-29.866667-12.8l-59.733333-59.733334c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l59.733334 59.733333c17.066667 17.066667 17.066667 42.666667 0 59.733334-8.533333 8.533333-21.333333 12.8-29.866667 12.8zM128 554.666667H42.666667c-25.6 0-42.666667-17.066667-42.666667-42.666667s17.066667-42.666667 42.666667-42.666667h85.333333c25.6 0 42.666667 17.066667 42.666667 42.666667s-17.066667 42.666667-42.666667 42.666667zM981.333333 554.666667h-85.333333c-25.6 0-42.666667-17.066667-42.666667-42.666667s17.066667-42.666667 42.666667-42.666667h85.333333c25.6 0 42.666667 17.066667 42.666667 42.666667s-17.066667 42.666667-42.666667 42.666667zM179.2 887.466667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733334l59.733334-59.733333c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-59.733333 59.733334c-8.533333 8.533333-17.066667 12.8-29.866667 12.8zM785.066667 281.6c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l59.733333-59.733334c17.066667-17.066667 42.666667-17.066667 59.733334 0s17.066667 42.666667 0 59.733334l-59.733334 59.733333c-8.533333 8.533333-21.333333 12.8-29.866666 12.8z',\n  ],\n};\n\nexport default icon;\n", ".baseIcon {\n  width: 1em;\n  height: 1em;\n  fill: currentcolor;\n  overflow: hidden;\n}\n", "import { classnames } from '@/util';\nimport styles from './BaseIcon.module.css';\nimport React, { FunctionComponent } from 'react';\n\ninterface PathItem {\n  d: string;\n  'fill-opacity'?: string;\n}\n\nexport interface BaseIconProps {\n  className?: string;\n  paths: PathItem[];\n  fill?: string;\n}\n\nexport const BaseIcon: FunctionComponent<BaseIconProps> = ({\n  className = '',\n  paths = [],\n  fill = 'currentcolor',\n}) => {\n  return (\n    <svg\n      fill={fill}\n      className={classnames(styles.baseIcon, className)}\n      viewBox=\"0 0 1137 1024\"\n      aria-hidden\n    >\n      {paths.map((item, i) => (\n        <path d={item.d} key={i} fillOpacity={item['fill-opacity']} />\n      ))}\n    </svg>\n  );\n};\nBaseIcon.displayName = 'BaseIcon';\n", "import { BaseIcon } from './BaseIcon';\n\nexport const FillColorIcon = ({ fill }: { fill?: string }) => {\n  return BaseIcon({\n    fill,\n    paths: [\n      {\n        d: 'M0 0h1024v1024H0z',\n        'fill-opacity': '.01',\n      },\n      {\n        d: 'M496.512 32a128 128 0 0 1 127.84 121.6l0.16 6.4-0.032 113.504 264.256 264.256a32 32 0 0 1-8.16 51.2l-144.064 72.96-269.12 269.12a64 64 0 0 1-90.496 0l-294.144-294.176a64 64 0 0 1 0-90.496l286.016-286.08-0.192-2.048-0.064-2.08V160a128 128 0 0 1 128-128z m-6.464 197.568L128 591.616l294.144 294.144 276.32-276.32 113.792-57.632-187.776-187.776V416a32 32 0 0 1-28.256 31.776l-3.712 0.224a32 32 0 0 1-31.808-28.256L560.512 416l-0.032-115.968-70.432-70.464z m402.016 395.936l1.792 2.24 5.472 8.416c30.112 46.752 45.184 80.032 45.184 99.84a64 64 0 1 1-128 0c0-20.96 16.864-57.024 50.624-108.224a16 16 0 0 1 24.928-2.24zM496.512 96a64 64 0 0 0-63.84 59.2l-0.16 4.8-0.032 36.576 34.944-34.88a32 32 0 0 1 45.248 0l47.808 47.808V160a64 64 0 0 0-59.2-63.84L496.48 96z',\n      },\n    ],\n  });\n};\nFillColorIcon.displayName = 'FillColorIcon';\n", "import { FunctionComponent } from 'react';\nimport iconConfig from './icon';\nimport type { BaseIconName } from './icon';\nimport { BaseIcon, BaseIconProps } from './BaseIcon';\n\nexport interface IconProps {\n  name: BaseIconName;\n  className?: string;\n  fill?: string;\n}\n\nexport const Icon: FunctionComponent<IconProps> = ({\n  name,\n  className = '',\n  fill,\n}) => {\n  const paths = iconConfig[name].map((item) => ({ d: item }));\n  return BaseIcon({ className, paths, fill });\n};\nIcon.displayName = 'Icon';\n\nexport { BaseIcon, BaseIconProps };\n\nexport { FillColorIcon } from './FillColorIcon';\n", "import React, { CSSProperties, FunctionComponent } from 'react';\nimport { classnames } from '@/util';\nimport { OptionItem } from '@/types';\nimport styles from './index.module.css';\n\nexport interface SelectProps {\n  value?: string | number;\n  defaultValue?: string | number;\n  style?: CSSProperties;\n  data: Array<string | number | OptionItem>;\n  getItemStyle?: (value: string | number) => CSSProperties;\n  onChange: (value: string | number) => void;\n  title?: string;\n}\n\nexport const Select: FunctionComponent<SelectProps> = (props) => {\n  const {\n    data,\n    value: activeValue,\n    style = {},\n    onChange,\n    getItemStyle = () => ({}),\n    title,\n    defaultValue,\n  } = props;\n  const handleChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    onChange(event.currentTarget.value);\n  };\n  return (\n    <select\n      onChange={handleChange}\n      value={activeValue}\n      style={style}\n      defaultValue={defaultValue}\n      name=\"select\"\n      className={styles.selectList}\n      title={title}\n    >\n      {data.map((item) => {\n        const value = typeof item === 'object' ? item.value : item;\n        const label = typeof item === 'object' ? item.label : item;\n        const disabled = typeof item === 'object' ? item.disabled : false;\n        const itemStyle = getItemStyle(value);\n        const cls = classnames(styles.selectItem, {\n          [styles['disabled']]: disabled,\n        });\n        return (\n          <option\n            key={value}\n            value={value}\n            disabled={!!disabled}\n            className={cls}\n            style={itemStyle}\n          >\n            {label}\n          </option>\n        );\n      })}\n    </select>\n  );\n};\nSelect.displayName = 'Select';\n", ".selectList {\n  background-color: var(--white);\n  color: var(--black);\n}\n.selectItem {\n  font-size: var(--font);\n  cursor: pointer;\n}\n.selectItem.disabled {\n  background-color: var(--white);\n  cursor: not-allowed;\n  color: var(--borderColor);\n}\n.selectItem.disabled:hover {\n  background-color: var(--white);\n}\n", "import React, { FunctionComponent, CSSProperties } from 'react';\nimport { createPortal } from 'react-dom';\nimport { createRoot, Root } from 'react-dom/client';\nimport { Button } from '../Button';\nimport styles from './index.module.css';\nimport { classnames } from '@/util';\nimport { $ } from '@/i18n';\n\ninterface DialogProps {\n  title: string;\n  dialogStyle?: CSSProperties;\n  visible: boolean;\n  children?: React.ReactNode;\n  getContainer?: () => HTMLElement;\n  onOk?: React.MouseEventHandler<HTMLButtonElement>;\n  onCancel?: React.MouseEventHandler<HTMLButtonElement>;\n}\n\nexport const Dialog: FunctionComponent<DialogProps> = (props) => {\n  const {\n    children,\n    title,\n    dialogStyle,\n    onCancel,\n    onOk,\n    visible,\n    getContainer = () => document.body,\n  } = props;\n  if (!visible) {\n    return null;\n  }\n  return createPortal(\n    <div className={classnames(styles['dialog-modal'])}>\n      <div className={styles['dialog-container']} style={dialogStyle}>\n        <div className={styles['dialog-title']}>{title}</div>\n        <div className={styles['dialog-content']}>{children}</div>\n        <div className={styles['dialog-button']}>\n          <Button onClick={onCancel}>{$('cancel')}</Button>\n          <Button\n            onClick={onOk}\n            className={styles['dialog-cancel']}\n            type=\"primary\"\n          >\n            {$('confirm')}\n          </Button>\n        </div>\n      </div>\n    </div>,\n    getContainer(),\n  );\n};\nDialog.displayName = 'Dialog';\n\nexport function info(props: DialogProps) {\n  const container = document.createDocumentFragment();\n  let root: Root | null = null;\n  function close() {\n    root?.unmount();\n    root = null;\n  }\n\n  function render(modalProps: DialogProps) {\n    root = root || createRoot(container);\n    root.render(\n      <Dialog\n        visible={modalProps.visible}\n        title={modalProps.title}\n        dialogStyle={modalProps.dialogStyle}\n        onCancel={(event) => {\n          event.stopPropagation();\n          if (modalProps.onCancel) {\n            modalProps.onCancel(event);\n          }\n          close();\n        }}\n        onOk={(event) => {\n          event.stopPropagation();\n          if (modalProps.onOk) {\n            modalProps.onOk(event);\n          }\n          close();\n        }}\n      >\n        {modalProps.children}\n      </Dialog>,\n    );\n  }\n  function update(modalProps: DialogProps) {\n    render(modalProps);\n  }\n\n  render(props);\n\n  return {\n    close,\n    update,\n  };\n}\n", ".dialog-modal {\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  z-index: var(--highestZIndex);\n  background-color: var(--dialogBackground);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.dialog-container {\n  background-color: var(--white);\n  padding: var(--padding);\n  border: 1px solid var(--borderColor);\n  border-radius: var(--borderRadius);\n}\n\n.dialog-title {\n  font-weight: bold;\n  font-size: var(--largeFont);\n}\n\n.dialog-content {\n  padding-top: var(--mediumPadding);\n}\n\n.dialog-button {\n  padding-top: var(--mediumPadding);\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n}\n\n.dialog-cancel {\n  margin-left: var(--mediumPadding);\n}\n", "{\n  \"copy\": \"Copy\",\n  \"cut\": \"Cut\",\n  \"paste\": \"Paste\",\n  \"delete\": \"Delete\",\n  \"add\": \"Add\",\n  \"rows\": \"Rows\",\n  \"menu\": \"Menu\",\n  \"insert\": \"Insert\",\n  \"rename\": \"Rename\",\n  \"reset\": \"Reset\",\n  \"hide\": \"Hide\",\n  \"unhide\": \"Unhide\",\n  \"cancel\": \"Cancel\",\n  \"line-chart\": \"Line Chart\",\n  \"bar-chart\": \"Bar Chart\",\n  \"pie-chart\": \"Pie Chart\",\n  \"scatter-chart\": \"Scatter Chart\",\n  \"radar-chart\": \"Radar Chart\",\n  \"polar-area-chart\": \"PolarArea Chart\",\n  \"confirm\": \"Confirm\",\n  \"tab-color\": \"Tab Color\",\n  \"unhide-sheet\": \"Unhide sheet:\",\n  \"wrap-text\": \"Wrap Text\",\n  \"import-xlsx\": \"import XLSX\",\n  \"export-xlsx\": \"Export XLSX\",\n  \"export-csv\": \"Export CSV\",\n  \"floating-picture\": \"Floating Picture\",\n  \"chart\": \"Chart\",\n  \"duplicate\": \"Duplicate\",\n  \"select-data\": \"Select Data\",\n  \"change-chart-title\": \"Change Chart Title\",\n  \"change-chart-type\": \"Change Chart Type\",\n  \"save-as-picture\": \"Save as Picture\",\n  \"reset-size\": \"Reset Size\",\n  \"add-at-the-bottom\": \"Add at the bottom\",\n  \"row-height\": \"Row Height\",\n  \"column-width\": \"Column Width\",\n  \"greater-than-zero\": \"The value must be greater than or equal to 0\",\n  \"insert-columns\": \"Insert Columns\",\n  \"delete-columns\": \"Delete Columns\",\n  \"hide-columns\": \"Hide Columns\",\n  \"insert-rows\": \"Insert Rows\",\n  \"delete-rows\": \"Delete Rows\",\n  \"hide-rows\": \"Hide rows\",\n  \"reference-is-empty\": \"The reference is empty\",\n  \"reference-is-not-valid\": \"The reference is not valid\",\n  \"the-value-cannot-be-empty\": \"The value cannot be empty\",\n  \"edit-data-source\": \"Edit Data Source\",\n  \"sheet-id-is-duplicate\": \"The sheet id is duplicate\",\n  \"a-workbook-must-contains-at-least-one-visible-worksheet\": \"A workbook must contains at least one visible worksheet\",\n  \"sheet-name-is-duplicate\": \"The sheet name is duplicate\",\n  \"uuid-is-duplicate\": \"The uuid is duplicate\",\n  \"cells-must-contain-data\": \"The selected cells must contain the data\",\n  \"image-source-is-empty\": \"The image source is empty\",\n  \"merging-cell-is-duplicate\": \"The merging cell is duplicate\"\n}\n", "{\n  \"copy\": \"\u590D\u5236\",\n  \"cut\": \"\u526A\u5207\",\n  \"paste\": \"\u7C98\u8D34\",\n  \"delete\": \"\u5220\u9664\",\n  \"add\": \"\u6DFB\u52A0\",\n  \"rows\": \"\u884C\",\n  \"menu\": \"\u83DC\u5355\",\n  \"insert\": \"\u63D2\u5165\",\n  \"rename\": \"\u91CD\u547D\u540D\",\n  \"reset\": \"\u91CD\u7F6E\",\n  \"hide\": \"\u9690\u85CF\",\n  \"unhide\": \"\u663E\u793A\",\n  \"cancel\": \"\u53D6\u6D88\",\n  \"line-chart\": \"\u6298\u7EBF\u56FE\",\n  \"bar-chart\": \"\u67F1\u72B6\u56FE\",\n  \"pie-chart\": \"\u997C\u56FE\",\n  \"scatter-chart\": \"\u6563\u70B9\u56FE\",\n  \"radar-chart\": \"\u96F7\u8FBE\u56FE\",\n  \"polar-area-chart\": \"\u6781\u533A\u56FE\",\n  \"confirm\": \"\u786E\u8BA4\",\n  \"tab-color\": \"\u9009\u9879\u5361\u989C\u8272\",\n  \"unhide-sheet\": \"\u663E\u793A\u5DE5\u4F5C\u8868:\",\n  \"wrap-text\": \"\u81EA\u52A8\u6362\u884C\",\n  \"import-xlsx\": \"\u5BFC\u5165 XLSX\",\n  \"export-xlsx\": \"\u5BFC\u51FA XLSX\",\n  \"export-csv\": \"\u5BFC\u51FA CSV\",\n  \"floating-picture\": \"\u6D6E\u52A8\u56FE\u7247\",\n  \"chart\": \"\u56FE\u8868\",\n  \"duplicate\": \"\u590D\u5236\",\n  \"select-data\": \"\u9009\u62E9\u6570\u636E\",\n  \"change-chart-title\": \"\u66F4\u6539\u56FE\u8868\u6807\u9898\",\n  \"change-chart-type\": \"\u66F4\u6539\u56FE\u8868\u7C7B\u578B\",\n  \"save-as-picture\": \"\u4FDD\u5B58\u4E3A\u56FE\u7247\",\n  \"reset-size\": \"\u91CD\u7F6E\u5927\u5C0F\",\n  \"add-at-the-bottom\": \"\u5728\u5E95\u90E8\u6DFB\u52A0\",\n  \"row-height\": \"\u884C\u9AD8\",\n  \"column-width\": \"\u5217\u5BBD\",\n  \"greater-than-zero\": \"\u503C\u5FC5\u987B\u5927\u4E8E\u6216\u7B49\u4E8E 0\",\n  \"insert-columns\": \"\u63D2\u5165\u5217\",\n  \"delete-columns\": \"\u5220\u9664\u5217\",\n  \"hide-columns\": \"\u9690\u85CF\u5217\",\n  \"insert-rows\": \"\u63D2\u5165\u884C\",\n  \"delete-rows\": \"\u5220\u9664\u884C\",\n  \"hide-rows\": \"\u9690\u85CF\u884C\",\n  \"reference-is-empty\": \"\u5F15\u7528\u4E3A\u7A7A\",\n  \"reference-is-not-valid\": \"\u5F15\u7528\u65E0\u6548\",\n  \"the-value-cannot-be-empty\": \"\u503C\u4E0D\u80FD\u4E3A\u7A7A\",\n  \"edit-data-source\": \"\u7F16\u8F91\u6570\u636E\u6E90\",\n  \"sheet-id-is-duplicate\": \"\u5DE5\u4F5C\u8868 ID \u91CD\u590D\",\n  \"a-workbook-must-contains-at-least-one-visible-worksheet\": \"\u5DE5\u4F5C\u7C3F\u5FC5\u987B\u81F3\u5C11\u5305\u542B\u4E00\u4E2A\u53EF\u89C1\u5DE5\u4F5C\u8868\",\n  \"sheet-name-is-duplicate\": \"\u5DE5\u4F5C\u8868\u540D\u79F0\u91CD\u590D\",\n  \"uuid-is-duplicate\": \"UUID \u91CD\u590D\",\n  \"cells-must-contain-data\": \"\u6240\u9009\u5355\u5143\u683C\u5FC5\u987B\u5305\u542B\u6570\u636E\",\n  \"image-source-is-empty\": \"\u56FE\u50CF\u6E90\u4E3A\u7A7A\",\n  \"merging-cell-is-duplicate\": \"\u5408\u5E76\u5355\u5143\u683C\u91CD\u590D\"\n}\n", "import { LanguageType } from '@/types';\nimport { LANGUAGE_LIST } from '@/util';\nimport en from './lang/en.json';\nimport zh from './lang/zh.json';\n\nlet languageKey = 'language';\n\nexport function getLanguage(): LanguageType {\n  const l = localStorage.getItem(languageKey);\n  if (l && LANGUAGE_LIST.some((v) => v === l)) {\n    return l as LanguageType;\n  }\n  const lang = navigator?.language || '';\n  const item = LANGUAGE_LIST.find((v) => lang.includes(v));\n  return item || 'en';\n}\n\nexport function setLanguage(lang: LanguageType) {\n  localStorage.setItem(languageKey, lang);\n}\n\nexport function $(key: keyof typeof en) {\n  if (getLanguage() === 'en') {\n    return en[key];\n  } else {\n    return zh[key];\n  }\n}\n", "import React, { FunctionComponent, useState } from 'react';\nimport styles from './index.module.css';\nimport { classnames } from '@/util';\nimport { useClickOutside } from '../../hooks';\n\ntype MenuItemProps = {\n  onClick?: () => void;\n  testId?: string;\n};\ntype SubMenuProps = {\n  label: string;\n  style?: React.CSSProperties;\n  testId?: string;\n  className?: string;\n};\ntype MenuProps = {\n  menuButton: React.ReactElement;\n  style?: React.CSSProperties;\n  testId?: string;\n  className?: string;\n};\nexport const MenuItem: FunctionComponent<\n  React.PropsWithChildren<MenuItemProps>\n> = ({ onClick, children, testId }) => {\n  return (\n    <li className={styles.menuItem} onClick={onClick} data-testid={testId}>\n      {children}\n    </li>\n  );\n};\n\nexport const SubMenu: FunctionComponent<\n  React.PropsWithChildren<SubMenuProps>\n> = ({ label, children, style, testId, className }) => {\n  const [open, setOpen] = useState(false);\n  const handleClick = () => {\n    setOpen((v) => !v);\n  };\n\n  return (\n    <li\n      className={classnames(styles.menuItem, className)}\n      onClick={handleClick}\n      data-testid={testId}\n    >\n      <div>{label}</div>\n      {open && (\n        <div\n          className={classnames(styles.subMenuContainer, styles.portal)}\n          style={style}\n        >\n          <ul className={styles.menu}>{children}</ul>\n        </div>\n      )}\n    </li>\n  );\n};\n\nexport const Menu: FunctionComponent<React.PropsWithChildren<MenuProps>> = ({\n  menuButton,\n  children,\n  style,\n  testId,\n  className,\n}) => {\n  const [open, setOpen] = useState(false);\n  const handleClick = () => {\n    setOpen((v) => !v);\n  };\n  const [ref] = useClickOutside(() => setOpen(false));\n  return (\n    <div className={classnames(styles.container, className)} ref={ref}>\n      <div onClick={handleClick} data-testid={testId}>\n        {menuButton}\n      </div>\n      {open && (\n        <div\n          className={classnames(styles.menuContainer, styles.portal)}\n          style={style}\n        >\n          <ul className={styles.menu}>{children}</ul>\n        </div>\n      )}\n    </div>\n  );\n};\n", ".container {\n  position: relative;\n}\n.portal {\n  border-radius: var(--borderRadius);\n  position: absolute;\n  z-index: var(--highestZIndex);\n  background-color: var(--white);\n  border: 1px solid var(--borderColor);\n  transition: all 1s ease-out;\n}\n.menuContainer {\n  left: 0;\n}\n\n.subMenuContainer {\n  top: 0;\n  left: 100%;\n}\n.menu {\n  list-style: none;\n  margin: 0px;\n  padding: 0;\n  outline: 0px;\n  width: 100%;\n  box-sizing: border-box;\n  text-align: center;\n}\n.menuItem {\n  padding: 6px 16px;\n  position: relative;\n  width: 100%;\n  box-sizing: border-box;\n  text-align: center;\n  user-select: none;\n}\n\n.menuItem + .menuItem {\n  border-top: 1px solid var(--borderColor);\n}\n\n.menuItem:hover {\n  background-color: var(--hoverColor);\n}\n", "import { useState, useRef, useEffect } from 'react';\n\nexport function useClickOutside(\n  callback: () => void,\n): [ref: React.RefObject<HTMLDivElement>, clickedOutSide: boolean] {\n  const ref = useRef<HTMLDivElement>(null);\n  const [clickedOutSide, setState] = useState(false);\n\n  function handleEvent(event: Event) {\n    if (ref && ref.current) {\n      if (ref.current.contains(event.target! as Node)) {\n        setState(false);\n      } else {\n        setState(true);\n        callback();\n      }\n    }\n  }\n\n  useEffect(() => {\n    document.addEventListener('pointerdown', handleEvent);\n\n    return () => {\n      document.removeEventListener('pointerdown', handleEvent);\n    };\n  }, []);\n\n  return [ref, clickedOutSide];\n}\n", "import { useRef } from \"react\";\n\n// Saves incoming handler to the ref in order to avoid \"useCallback hell\"\nexport function useEventCallback<T>(handler?: (value: T) => void): (value: T) => void {\n  const callbackRef = useRef(handler);\n  const fn = useRef((value: T) => {\n    callbackRef.current && callbackRef.current(value);\n  });\n  callbackRef.current = handler;\n\n  return fn.current;\n}\n", "import React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport styles from './index.module.css';\nimport { classnames } from '@/util';\nimport { Icon } from '../BaseIcon';\n\ntype MessageType = 'success' | 'error' | 'info' | 'warning';\ntype Props = {\n  message: string;\n  type: MessageType;\n  duration?: number; // second\n};\n\nconst Toast: React.FunctionComponent<Pick<Props, 'message' | 'type'>> = ({\n  message,\n  type,\n}) => {\n  return (\n    <div className={classnames(styles['toast'], styles[type])}>\n      <Icon\n        name={type}\n        className={classnames(styles[`${type}_icon`], styles['icon'])}\n      />\n      <div className={styles['content']}>{message}</div>\n    </div>\n  );\n};\n\nexport function toast(props: Props) {\n  const { duration = 3, ...rest } = props;\n  let container: HTMLDivElement | null = document.createElement('div');\n  container.className = styles['container'];\n  document.body.appendChild(container);\n  const root = createRoot(container);\n  root.render(<Toast {...rest} />);\n\n  function close() {\n    if (!container) {\n      return;\n    }\n    root.unmount();\n    document.body.removeChild(container!);\n    container = null;\n  }\n\n  setTimeout(close, duration * 1000);\n  return close;\n}\n", ".container {\n  position: fixed;\n  top: 50px;\n  left: 50%;\n  z-index: var(--highestZIndex);\n}\n.content {\n  padding-left: var(--mediumPadding);\n}\n.toast {\n  padding: var(--mediumPadding) var(--padding);\n  border-radius: var(--borderLargeRadius);\n  display: flex;\n  align-items: center;\n  word-wrap: break-word;\n  min-width: 200px;\n  font-size: var(--largeFont);\n}\n.icon {\n  font-size: 20px;\n}\n.success {\n  border: 1px solid rgb(183, 235, 143);\n  background-color: rgb(183, 235, 143);\n}\n.success_icon {\n  color: #52c41a;\n}\n.error {\n  border: 1px solid rgb(255, 204, 199);\n  background-color: rgb(255, 204, 199);\n}\n.error_icon {\n  color: #ff4d4f;\n}\n.info {\n  border: 1px solid rgb(145, 202, 255);\n  background-color: rgb(145, 202, 255);\n}\n.info_icon {\n  color: #1677ff;\n}\n.warning {\n  border: 1px solid rgb(255, 229, 143);\n  background-color: rgb(255, 229, 143);\n}\n.warning_icon {\n  color: #faad14;\n}\n", "import React, { FunctionComponent } from 'react';\nimport styles from './index.module.css';\n\nexport const Loading: FunctionComponent = () => {\n  return (\n    <div className={styles['container']}>\n      <div className={styles['loading']}></div>\n    </div>\n  );\n};\nLoading.displayName = 'Loading';\n", ".container {\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: var(--white);\n}\n.loading {\n  width: 48px;\n  height: 48px;\n  border: 5px solid var(--primaryColor);\n  border-bottom-color: transparent;\n  border-radius: 50%;\n  box-sizing: border-box;\n  animation: rotation 1s linear infinite;\n}\n\n@keyframes rotation {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n", "import React, { FunctionComponent, CSSProperties, useState } from 'react';\nimport { classnames } from '@/util';\nimport styles from './index.module.css';\nimport { ColorPickerPanel } from './ColorPickerPanel';\nimport { COLOR_LIST } from './color';\nimport { Button } from '../Button';\nimport { useClickOutside } from '../../hooks';\nimport { $ } from '@/i18n';\n\nexport interface ColorPickerProps {\n  color: string;\n  style?: CSSProperties;\n  onChange: (value: string) => void;\n  position?: 'top' | 'bottom';\n}\n\nexport const ColorPicker: FunctionComponent<\n  React.PropsWithChildren<ColorPickerProps>\n> = (props) => {\n  const { style = {}, onChange, children, color, position = 'bottom' } = props;\n  const [visible, setVisible] = useState(false);\n  const [ref] = useClickOutside(() => {\n    setVisible(false);\n  });\n  return (\n    <div\n      className={classnames(\n        styles['color-picker'],\n        position === 'top' ? styles['top'] : '',\n      )}\n      style={style}\n      ref={ref}\n    >\n      <div\n        className={styles['color-picker-trigger']}\n        style={{ color }}\n        onClick={() => setVisible(true)}\n      >\n        {children}\n      </div>\n      <div\n        className={classnames(styles['color-picker-wrapper'], {\n          [styles['show']]: visible,\n        })}\n      >\n        <div className={styles['color-picker-list']}>\n          {COLOR_LIST.map((item) => {\n            return (\n              <div\n                key={item}\n                className={styles['color-picker-item']}\n                style={{ backgroundColor: item }}\n                onClick={() => {\n                  onChange(item);\n                }}\n              ></div>\n            );\n          })}\n        </div>\n        <div>\n          <ColorPickerPanel\n            color={color}\n            onChange={(c) => {\n              onChange(c);\n            }}\n          />\n        </div>\n        <div>\n          <Button\n            type=\"normal\"\n            className={styles.reset}\n            onClick={() => {\n              onChange('');\n            }}\n          >\n            {$('reset')}\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n};\nColorPicker.displayName = 'ColorPicker';\n", ".color-picker {\n  position: relative;\n}\n\n.color-picker-wrapper {\n  width: 260px;\n  position: absolute;\n  top: 22px;\n  left: 0;\n  display: none;\n  z-index: var(--highestZIndex);\n  padding: var(--padding);\n  background-color: var(--white);\n  border-radius: var(--borderRadius);\n  border: 1px solid var(--borderColor);\n}\n.color-picker.top .color-picker-wrapper {\n  transform: translate(0, -100%);\n  left: 100%;\n}\n.color-picker-wrapper.show {\n  display: block;\n}\n\n.color-picker-list {\n  display: grid;\n  grid-template-columns: repeat(10, 1fr);\n  grid-template-rows: repeat(9, 1fr);\n  gap: 4px;\n}\n.color-picker-item {\n  width: 18px;\n  height: 18px;\n  cursor: pointer;\n  border-radius: var(--borderRadius);\n  border: 1px solid var(--borderColor);\n}\n.no-fill.color-picker-item {\n  width: auto;\n  padding: 0 2px;\n}\n.color-picker-item:hover {\n  border-color: var(--primaryColor);\n}\n.reset {\n  width: 100%;\n  margin-top: var(--padding);\n  background-color: var(--white);\n}\n", "import React, { memo } from 'react';\n\nimport { Hue } from './Hue';\nimport { Saturation } from './Saturation';\n\nimport { ColorModel, ColorPickerBaseProps, AnyColor } from './types';\nimport { useColorManipulation } from './useColorManipulation';\nimport { classnames, convertColorToHex } from '@/util';\nimport { hexToHsva, hsvaToHex } from './convert';\nimport styles from './panel.module.css';\n\ninterface Props<T extends AnyColor> extends Partial<ColorPickerBaseProps<T>> {\n  colorModel: ColorModel<T>;\n}\n\nconst ColorPicker = <T extends AnyColor>({\n  className,\n  colorModel,\n  color = colorModel.defaultColor,\n  onChange,\n}: Props<T>): JSX.Element => {\n  const [hsva, updateHsva] = useColorManipulation<T>(\n    colorModel,\n    color,\n    onChange,\n  );\n\n  return (\n    <div className={classnames(styles['color-picker-panel'], className)}>\n      <Saturation hsva={hsva} onChange={updateHsva} />\n      <Hue\n        hue={hsva.h}\n        onChange={updateHsva}\n        className={styles['color-picker-panel__last-control']}\n      />\n    </div>\n  );\n};\n\nconst colorModel: ColorModel<string> = {\n  defaultColor: '000',\n  toHsva: hexToHsva,\n  fromHsva: ({ h, s, v }) => hsvaToHex({ h, s, v, a: 1 }),\n  equal: (first, second) => {\n    const a = convertColorToHex(first);\n    const b = convertColorToHex(second);\n    return a === b;\n  },\n};\n\nexport const ColorPickerPanel = memo(\n  (props: Partial<ColorPickerBaseProps<string>>): JSX.Element => (\n    <ColorPicker\n      className={props.className}\n      color={props.color}\n      onChange={props.onChange}\n      colorModel={colorModel}\n    />\n  ),\n);\n", "import React from 'react';\n\nimport { Interactive, Interaction } from './Interactive';\nimport { Pointer } from './Pointer';\n\nimport { hsvaToHslString } from './convert';\nimport { clamp } from './clamp';\nimport { round } from './round';\nimport { classnames } from '@/util';\nimport styles from './panel.module.css';\n\ninterface Props {\n  className?: string;\n  hue: number;\n  onChange: (newHue: { h: number }) => void;\n}\n\nconst HueBase = ({ className, hue, onChange }: Props) => {\n  const handleMove = (interaction: Interaction) => {\n    onChange({ h: 360 * interaction.left });\n  };\n\n  const handleKey = (offset: Interaction) => {\n    // Hue measured in degrees of the color circle ranging from 0 to 360\n    onChange({\n      h: clamp(hue + offset.left * 360, 0, 360),\n    });\n  };\n\n  return (\n    <div className={classnames(styles['color-picker-panel__hue'], className)}>\n      <Interactive\n        onMove={handleMove}\n        onKey={handleKey}\n        aria-label=\"Hue\"\n        aria-valuenow={round(hue)}\n        aria-valuemax=\"360\"\n        aria-valuemin=\"0\"\n      >\n        <Pointer\n          className={styles['color-picker-panel__hue-pointer']}\n          left={hue / 360}\n          color={hsvaToHslString({ h: hue, s: 100, v: 100, a: 1 })}\n        />\n      </Interactive>\n    </div>\n  );\n};\n\nexport const Hue = React.memo(HueBase);\n", "import React, { useRef, useMemo, useEffect } from 'react';\n\nimport { useEventCallback } from '../../hooks';\nimport { clamp } from './clamp';\nimport styles from './panel.module.css';\n\nexport interface Interaction {\n  left: number;\n  top: number;\n}\n\n// Check if an event was triggered by touch\nconst isTouch = (event: MouseEvent | TouchEvent): event is TouchEvent =>\n  'touches' in event;\n\n// Finds a proper touch point by its identifier\nconst getTouchPoint = (touches: TouchList, touchId: null | number): Touch => {\n  for (let i = 0; i < touches.length; i++) {\n    if (touches[i].identifier === touchId) return touches[i];\n  }\n  return touches[0];\n};\n\n// Finds the proper window object to fix iframe embedding issues\nconst getParentWindow = (node?: HTMLDivElement | null): Window => {\n  return (node && node.ownerDocument.defaultView) || self;\n};\n\n// Returns a relative position of the pointer inside the node's bounding box\nconst getRelativePosition = (\n  node: HTMLDivElement,\n  event: MouseEvent | TouchEvent,\n  touchId: null | number,\n): Interaction => {\n  const rect = node.getBoundingClientRect();\n\n  // Get user's pointer position from `touches` array if it's a `TouchEvent`\n  const pointer = isTouch(event)\n    ? getTouchPoint(event.touches, touchId)\n    : (event as MouseEvent);\n\n  return {\n    left: clamp(\n      (pointer.pageX - (rect.left + getParentWindow(node).pageXOffset)) /\n        rect.width,\n    ),\n    top: clamp(\n      (pointer.pageY - (rect.top + getParentWindow(node).pageYOffset)) /\n        rect.height,\n    ),\n  };\n};\n\n// Browsers introduced an intervention, making touch events passive by default.\n// This workaround removes `preventDefault` call from the touch handlers.\n// https://github.com/facebook/react/issues/19651\nconst preventDefaultMove = (event: MouseEvent | TouchEvent): void => {\n  !isTouch(event) && event.preventDefault();\n};\n\n// Prevent mobile browsers from handling mouse events (conflicting with touch ones).\n// If we detected a touch interaction before, we prefer reacting to touch events only.\nconst isInvalid = (\n  event: MouseEvent | TouchEvent,\n  hasTouch: boolean,\n): boolean => {\n  return hasTouch && !isTouch(event);\n};\n\ninterface Props {\n  onMove: (interaction: Interaction) => void;\n  onKey: (offset: Interaction) => void;\n  children: React.ReactNode;\n}\n\nconst InteractiveBase = ({ onMove, onKey, ...rest }: Props) => {\n  const container = useRef<HTMLDivElement>(null);\n  const onMoveCallback = useEventCallback<Interaction>(onMove);\n  const onKeyCallback = useEventCallback<Interaction>(onKey);\n  const touchId = useRef<null | number>(null);\n  const hasTouch = useRef(false);\n\n  const [handleMoveStart, handleKeyDown, toggleDocumentEvents] = useMemo(() => {\n    const handleMoveStart = ({\n      nativeEvent,\n    }: React.MouseEvent | React.TouchEvent) => {\n      const el = container.current;\n      if (!el) return;\n\n      // Prevent text selection\n      preventDefaultMove(nativeEvent);\n\n      if (isInvalid(nativeEvent, hasTouch.current) || !el) return;\n\n      if (isTouch(nativeEvent)) {\n        hasTouch.current = true;\n        const changedTouches = nativeEvent.changedTouches || [];\n        if (changedTouches.length)\n          touchId.current = changedTouches[0].identifier;\n      }\n\n      el.focus();\n      onMoveCallback(getRelativePosition(el, nativeEvent, touchId.current));\n      toggleDocumentEvents(true);\n    };\n\n    const handleMove = (event: MouseEvent | TouchEvent) => {\n      // Prevent text selection\n      preventDefaultMove(event);\n\n      // If user moves the pointer outside of the window or iframe bounds and release it there,\n      // `mouseup`/`touchend` won't be fired. In order to stop the picker from following the cursor\n      // after the user has moved the mouse/finger back to the document, we check `event.buttons`\n      // and `event.touches`. It allows us to detect that the user is just moving his pointer\n      // without pressing it down\n      const isDown = isTouch(event)\n        ? event.touches.length > 0\n        : event.buttons > 0;\n\n      if (isDown && container.current) {\n        onMoveCallback(\n          getRelativePosition(container.current, event, touchId.current),\n        );\n      } else {\n        toggleDocumentEvents(false);\n      }\n    };\n\n    const handleMoveEnd = () => toggleDocumentEvents(false);\n\n    const handleKeyDown = (event: React.KeyboardEvent) => {\n      const keyCode = event.which || event.keyCode;\n\n      // Ignore all keys except arrow ones\n      if (keyCode < 37 || keyCode > 40) return;\n      // Do not scroll page by arrow keys when document is focused on the element\n      event.preventDefault();\n      // Send relative offset to the parent component.\n      // We use codes (37\u2190, 38\u2191, 39\u2192, 40\u2193) instead of keys ('ArrowRight', 'ArrowDown', etc)\n      // to reduce the size of the library\n      onKeyCallback({\n        left: keyCode === 39 ? 0.05 : keyCode === 37 ? -0.05 : 0,\n        top: keyCode === 40 ? 0.05 : keyCode === 38 ? -0.05 : 0,\n      });\n    };\n\n    function toggleDocumentEvents(state?: boolean) {\n      const touch = hasTouch.current;\n      const el = container.current;\n      const parentWindow = getParentWindow(el);\n\n      // Add or remove additional pointer event listeners\n      const toggleEvent = state\n        ? parentWindow.addEventListener\n        : parentWindow.removeEventListener;\n      toggleEvent(touch ? 'touchmove' : 'mousemove', handleMove);\n      toggleEvent(touch ? 'touchend' : 'mouseup', handleMoveEnd);\n    }\n\n    return [handleMoveStart, handleKeyDown, toggleDocumentEvents];\n  }, [onKeyCallback, onMoveCallback]);\n\n  // Remove window event listeners before unmounting\n  useEffect(() => toggleDocumentEvents, [toggleDocumentEvents]);\n\n  return (\n    <div\n      {...rest}\n      onTouchStart={handleMoveStart}\n      onMouseDown={handleMoveStart}\n      className={styles['color-picker-panel__interactive']}\n      ref={container}\n      onKeyDown={handleKeyDown}\n      tabIndex={0}\n      role=\"slider\"\n    />\n  );\n};\n\nexport const Interactive = React.memo(InteractiveBase);\n", "// Clamps a value between an upper and lower bound.\n// We use ternary operators because it makes the minified code\n// 2 times shorter then `Math.min(Math.max(a,b),c)`\nexport const clamp = (number: number, min = 0, max = 1): number => {\n  return number > max ? max : number < min ? min : number;\n};\n", ".color-picker-panel {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 200px;\n  user-select: none;\n  cursor: default;\n}\n\n.color-picker-panel__saturation {\n  margin: var(--padding) 0;\n  position: relative;\n  flex-grow: 1;\n  border-color: transparent;\n  border-bottom: 12px solid #000;\n  border-radius: var(--borderRadius);\n  background-image: linear-gradient(to top, #000, rgba(0, 0, 0, 0)),\n    linear-gradient(to right, #fff, rgba(255, 255, 255, 0));\n}\n\n.color-picker-panel__pointer-fill {\n  content: '';\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  pointer-events: none;\n  border-radius: inherit;\n}\n\n.color-picker-panel__saturation {\n  box-shadow: inset 0 0 0 1px var(--hoverColor);\n  border: 1px solid var(--borderColor);\n}\n\n.color-picker-panel__hue {\n  position: relative;\n  height: 16px;\n}\n\n.color-picker-panel__hue {\n  background: linear-gradient(\n    to right,\n    #f00 0%,\n    #ff0 17%,\n    #0f0 33%,\n    #0ff 50%,\n    #00f 67%,\n    #f0f 83%,\n    #f00 100%\n  );\n}\n\n.color-picker-panel__last-control {\n  border-radius: var(--borderLargeRadius);\n}\n\n.color-picker-panel__interactive {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  border-radius: inherit;\n  outline: none;\n  touch-action: none;\n}\n\n.color-picker-panel__pointer {\n  position: absolute;\n  z-index: 1;\n  box-sizing: border-box;\n  width: 20px;\n  height: 20px;\n  transform: translate(-50%, -50%);\n  background-color: var(--white);\n  border: 1px solid var(--borderColor);\n  border-radius: 50%;\n  box-shadow: 0 2px 4px var(--scrollbarHoveColor);\n}\n\n.color-picker-panel__interactive:focus .color-picker-panel__pointer {\n  transform: translate(-50%, -50%) scale(1.1);\n}\n\n.color-picker-panel__saturation-pointer {\n  z-index: 3;\n}\n\n.color-picker-panel__hue-pointer {\n  z-index: 2;\n}\n", "import React from 'react';\nimport { classnames } from '@/util';\nimport styles from './panel.module.css';\n\ninterface Props {\n  className?: string;\n  top?: number;\n  left: number;\n  color: string;\n}\n\nexport const Pointer = ({\n  className,\n  color,\n  left,\n  top = 0.5,\n}: Props): JSX.Element => {\n  const style = {\n    top: `${top * 100}%`,\n    left: `${left * 100}%`,\n  };\n\n  return (\n    <div\n      className={classnames(styles['color-picker-panel__pointer'], className)}\n      style={style}\n    >\n      <div\n        className={styles['color-picker-panel__pointer-fill']}\n        style={{ backgroundColor: color }}\n      />\n    </div>\n  );\n};\n", "export const round = (number: number, digits = 0, base = Math.pow(10, digits)): number => {\n  return Math.round(base * number) / base;\n};\n", "import { round } from \"./round\";\nimport { RgbaColor, RgbColor, HslaColor, HslColor, HsvaColor, HsvColor } from \"./types\";\n\n/**\n * Valid CSS <angle> units.\n * https://developer.mozilla.org/en-US/docs/Web/CSS/angle\n */\nconst angleUnits: Record<string, number> = {\n  grad: 360 / 400,\n  turn: 360,\n  rad: 360 / (Math.PI * 2),\n};\n\nexport const hexToHsva = (hex: string): HsvaColor => rgbaToHsva(hexToRgba(hex));\n\nexport const hexToRgba = (hex: string): RgbaColor => {\n  if (hex[0] === \"#\") hex = hex.substring(1);\n\n  if (hex.length < 6) {\n    return {\n      r: parseInt(hex[0] + hex[0], 16),\n      g: parseInt(hex[1] + hex[1], 16),\n      b: parseInt(hex[2] + hex[2], 16),\n      a: hex.length === 4 ? round(parseInt(hex[3] + hex[3], 16) / 255, 2) : 1,\n    };\n  }\n\n  return {\n    r: parseInt(hex.substring(0, 2), 16),\n    g: parseInt(hex.substring(2, 4), 16),\n    b: parseInt(hex.substring(4, 6), 16),\n    a: hex.length === 8 ? round(parseInt(hex.substring(6, 8), 16) / 255, 2) : 1,\n  };\n};\n\nexport const parseHue = (value: string, unit = \"deg\"): number => {\n  return Number(value) * (angleUnits[unit] || 1);\n};\n\nexport const hslaStringToHsva = (hslString: string): HsvaColor => {\n  const matcher = /hsla?\\(?\\s*(-?\\d*\\.?\\d+)(deg|rad|grad|turn)?[,\\s]+(-?\\d*\\.?\\d+)%?[,\\s]+(-?\\d*\\.?\\d+)%?,?\\s*[/\\s]*(-?\\d*\\.?\\d+)?(%)?\\s*\\)?/i;\n  const match = matcher.exec(hslString);\n\n  if (!match) return { h: 0, s: 0, v: 0, a: 1 };\n\n  return hslaToHsva({\n    h: parseHue(match[1], match[2]),\n    s: Number(match[3]),\n    l: Number(match[4]),\n    a: match[5] === undefined ? 1 : Number(match[5]) / (match[6] ? 100 : 1),\n  });\n};\n\nexport const hslStringToHsva = hslaStringToHsva;\n\nexport const hslaToHsva = ({ h, s, l, a }: HslaColor): HsvaColor => {\n  s *= (l < 50 ? l : 100 - l) / 100;\n\n  return {\n    h: h,\n    s: s > 0 ? ((2 * s) / (l + s)) * 100 : 0,\n    v: l + s,\n    a,\n  };\n};\n\nexport const hsvaToHex = (hsva: HsvaColor): string => rgbaToHex(hsvaToRgba(hsva));\n\nexport const hsvaToHsla = ({ h, s, v, a }: HsvaColor): HslaColor => {\n  const hh = ((200 - s) * v) / 100;\n\n  return {\n    h: round(h),\n    s: round(hh > 0 && hh < 200 ? ((s * v) / 100 / (hh <= 100 ? hh : 200 - hh)) * 100 : 0),\n    l: round(hh / 2),\n    a: round(a, 2),\n  };\n};\n\nexport const hsvaToHslString = (hsva: HsvaColor): string => {\n  const { h, s, l } = hsvaToHsla(hsva);\n  return `hsl(${h}, ${s}%, ${l}%)`;\n};\n\nexport const hsvaToHsvString = (hsva: HsvaColor): string => {\n  const { h, s, v } = roundHsva(hsva);\n  return `hsv(${h}, ${s}%, ${v}%)`;\n};\n\nexport const hsvaToHsvaString = (hsva: HsvaColor): string => {\n  const { h, s, v, a } = roundHsva(hsva);\n  return `hsva(${h}, ${s}%, ${v}%, ${a})`;\n};\n\nexport const hsvaToHslaString = (hsva: HsvaColor): string => {\n  const { h, s, l, a } = hsvaToHsla(hsva);\n  return `hsla(${h}, ${s}%, ${l}%, ${a})`;\n};\n\nexport const hsvaToRgba = ({ h, s, v, a }: HsvaColor): RgbaColor => {\n  h = (h / 360) * 6;\n  s = s / 100;\n  v = v / 100;\n\n  const hh = Math.floor(h),\n    b = v * (1 - s),\n    c = v * (1 - (h - hh) * s),\n    d = v * (1 - (1 - h + hh) * s),\n    module = hh % 6;\n\n  return {\n    r: round([v, c, b, b, d, v][module] * 255),\n    g: round([d, v, v, c, b, b][module] * 255),\n    b: round([b, b, d, v, v, c][module] * 255),\n    a: round(a, 2),\n  };\n};\n\nexport const hsvaToRgbString = (hsva: HsvaColor): string => {\n  const { r, g, b } = hsvaToRgba(hsva);\n  return `rgb(${r}, ${g}, ${b})`;\n};\n\nexport const hsvaToRgbaString = (hsva: HsvaColor): string => {\n  const { r, g, b, a } = hsvaToRgba(hsva);\n  return `rgba(${r}, ${g}, ${b}, ${a})`;\n};\n\nexport const hsvaStringToHsva = (hsvString: string): HsvaColor => {\n  const matcher = /hsva?\\(?\\s*(-?\\d*\\.?\\d+)(deg|rad|grad|turn)?[,\\s]+(-?\\d*\\.?\\d+)%?[,\\s]+(-?\\d*\\.?\\d+)%?,?\\s*[/\\s]*(-?\\d*\\.?\\d+)?(%)?\\s*\\)?/i;\n  const match = matcher.exec(hsvString);\n\n  if (!match) return { h: 0, s: 0, v: 0, a: 1 };\n\n  return roundHsva({\n    h: parseHue(match[1], match[2]),\n    s: Number(match[3]),\n    v: Number(match[4]),\n    a: match[5] === undefined ? 1 : Number(match[5]) / (match[6] ? 100 : 1),\n  });\n};\n\nexport const hsvStringToHsva = hsvaStringToHsva;\n\nexport const rgbaStringToHsva = (rgbaString: string): HsvaColor => {\n  const matcher = /rgba?\\(?\\s*(-?\\d*\\.?\\d+)(%)?[,\\s]+(-?\\d*\\.?\\d+)(%)?[,\\s]+(-?\\d*\\.?\\d+)(%)?,?\\s*[/\\s]*(-?\\d*\\.?\\d+)?(%)?\\s*\\)?/i;\n  const match = matcher.exec(rgbaString);\n\n  if (!match) return { h: 0, s: 0, v: 0, a: 1 };\n\n  return rgbaToHsva({\n    r: Number(match[1]) / (match[2] ? 100 / 255 : 1),\n    g: Number(match[3]) / (match[4] ? 100 / 255 : 1),\n    b: Number(match[5]) / (match[6] ? 100 / 255 : 1),\n    a: match[7] === undefined ? 1 : Number(match[7]) / (match[8] ? 100 : 1),\n  });\n};\n\nexport const rgbStringToHsva = rgbaStringToHsva;\n\nconst format = (number: number) => {\n  const hex = number.toString(16);\n  return hex.length < 2 ? \"0\" + hex : hex;\n};\n\nexport const rgbaToHex = ({ r, g, b, a }: RgbaColor): string => {\n  const alphaHex = a < 1 ? format(round(a * 255)) : \"\";\n  return \"#\" + format(r) + format(g) + format(b) + alphaHex;\n};\n\nexport const rgbaToHsva = ({ r, g, b, a }: RgbaColor): HsvaColor => {\n  const max = Math.max(r, g, b);\n  const delta = max - Math.min(r, g, b);\n\n  // prettier-ignore\n  const hh = delta\n    ? max === r\n      ? (g - b) / delta\n      : max === g\n        ? 2 + (b - r) / delta\n        : 4 + (r - g) / delta\n    : 0;\n\n  return {\n    h: round(60 * (hh < 0 ? hh + 6 : hh)),\n    s: round(max ? (delta / max) * 100 : 0),\n    v: round((max / 255) * 100),\n    a,\n  };\n};\n\nexport const roundHsva = (hsva: HsvaColor): HsvaColor => ({\n  h: round(hsva.h),\n  s: round(hsva.s),\n  v: round(hsva.v),\n  a: round(hsva.a, 2),\n});\n\nexport const rgbaToRgb = ({ r, g, b }: RgbaColor): RgbColor => ({ r, g, b });\n\nexport const hslaToHsl = ({ h, s, l }: HslaColor): HslColor => ({ h, s, l });\n\nexport const hsvaToHsv = (hsva: HsvaColor): HsvColor => {\n  const { h, s, v } = roundHsva(hsva);\n  return { h, s, v };\n};\n", "import React from 'react';\nimport { Interactive, Interaction } from './Interactive';\nimport { Pointer } from './Pointer';\nimport { HsvaColor } from './types';\nimport { hsvaToHslString } from './convert';\nimport { clamp } from './clamp';\nimport { round } from './round';\nimport styles from './panel.module.css';\n\ninterface Props {\n  hsva: HsvaColor;\n  onChange: (newColor: { s: number; v: number }) => void;\n}\n\nconst SaturationBase = ({ hsva, onChange }: Props) => {\n  const handleMove = (interaction: Interaction) => {\n    onChange({\n      s: interaction.left * 100,\n      v: 100 - interaction.top * 100,\n    });\n  };\n\n  const handleKey = (offset: Interaction) => {\n    // Saturation and brightness always fit into [0, 100] range\n    onChange({\n      s: clamp(hsva.s + offset.left * 100, 0, 100),\n      v: clamp(hsva.v - offset.top * 100, 0, 100),\n    });\n  };\n\n  const containerStyle = {\n    backgroundColor: hsvaToHslString({ h: hsva.h, s: 100, v: 100, a: 1 }),\n  };\n\n  return (\n    <div\n      className={styles['color-picker-panel__saturation']}\n      style={containerStyle}\n    >\n      <Interactive\n        onMove={handleMove}\n        onKey={handleKey}\n        aria-label=\"Color\"\n        aria-valuetext={`Saturation ${round(hsva.s)}%, Brightness ${round(\n          hsva.v,\n        )}%`}\n      >\n        <Pointer\n          className={styles['color-picker-panel__saturation-pointer']}\n          top={1 - hsva.v / 100}\n          left={hsva.s / 100}\n          color={hsvaToHslString(hsva)}\n        />\n      </Interactive>\n    </div>\n  );\n};\n\nexport const Saturation = React.memo(SaturationBase);\n", "import { useState, useEffect, useCallback, useRef } from \"react\";\nimport { ColorModel, AnyColor, HsvaColor } from \"./types\";\nimport { useEventCallback } from \"../../hooks/useEventCallback\";\nimport { deepEqual } from '@/util'\n\nexport function useColorManipulation<T extends AnyColor>(\n  colorModel: ColorModel<T>,\n  color: T,\n  onChange?: (color: T) => void\n): [HsvaColor, (color: Partial<HsvaColor>) => void] {\n  // Save onChange callback in the ref for avoiding \"useCallback hell\"\n  const onChangeCallback = useEventCallback<T>(onChange);\n\n  // No matter which color model is used (HEX, RGB(A) or HSL(A)),\n  // all internal calculations are based on HSVA model\n  const [hsva, updateHsva] = useState<HsvaColor>(() => colorModel.toHsva(color));\n\n  // By using this ref we're able to prevent extra updates\n  // and the effects recursion during the color conversion\n  const cache = useRef({ color, hsva });\n\n  // Update local HSVA-value if `color` property value is changed,\n  // but only if that's not the same color that we just sent to the parent\n  useEffect(() => {\n    if (!colorModel.equal(color, cache.current.color)) {\n      const newHsva = colorModel.toHsva(color);\n      cache.current = { hsva: newHsva, color };\n      updateHsva(newHsva);\n    }\n  }, [color, colorModel]);\n\n  // Trigger `onChange` callback only if an updated color is different from cached one;\n  // save the new color to the ref to prevent unnecessary updates\n  useEffect(() => {\n    let newColor;\n    if (\n      !deepEqual(hsva, cache.current.hsva) &&\n      !colorModel.equal((newColor = colorModel.fromHsva(hsva)), cache.current.color)\n    ) {\n      cache.current = { hsva, color: newColor };\n      onChangeCallback(newColor);\n    }\n  }, [hsva, colorModel, onChangeCallback]);\n\n  // Merge the current HSVA color object with updated params.\n  // For example, when a child component sends `h` or `s` only\n  const handleChange = useCallback((params: Partial<HsvaColor>) => {\n    updateHsva((current) => Object.assign({}, current, params));\n  }, []);\n\n  return [hsva, handleChange];\n}\n", "export const COLOR_LIST = [\n  '#35322B',\n  '#505050',\n  '#606060',\n  '#6F6F6F',\n  '#8B8B8B',\n  '#B2B2B2',\n  '#CCCCCC',\n  '#E5E5E5',\n  '#F5F5F5',\n  '#FFFFFF',\n  '#9D0000',\n  '#B20000',\n  '#CD0F0F',\n  '#E30909',\n  '#F30B0B',\n  '#FE4B4B',\n  '#FA7979',\n  '#FB9D9D',\n  '#FDCECE',\n  '#FEE7E7',\n  '#B24000',\n  '#CC4F10',\n  '#DF5D00',\n  '#F96800',\n  '#FB8937',\n  '#FF8C51',\n  '#FCA669',\n  '#FDC49B',\n  '#FEE1CD',\n  '#FEF0E6',\n  '#B19401',\n  '#C5A300',\n  '#D8B300',\n  '#EBC301',\n  '#F9D700',\n  '#FBE137',\n  '#FCE869',\n  '#FDF09B',\n  '#FEF7CD',\n  '#FEFBE6',\n  '#58770A',\n  '#688C0D',\n  '#7AA017',\n  '#8BBB11',\n  '#A4DC16',\n  '#BEEE44',\n  '#CEF273',\n  '#DEF6A2',\n  '#EFFBD0',\n  '#F7FDE8',\n  '#007676',\n  '#008A8A',\n  '#009E9E',\n  '#00BBBB',\n  '#1CD8D8',\n  '#2AEAEA',\n  '#76EFEF',\n  '#A3F5F5',\n  '#D1FAFA',\n  '#E8FCFC',\n  '#001F9C',\n  '#0025B7',\n  '#012BD2',\n  '#133DE3',\n  '#2F55EB',\n  '#4567ED',\n  '#738DF2',\n  '#A2B3F6',\n  '#D0D9FB',\n  '#E8ECFD',\n  '#3F0198',\n  '#510EB0',\n  '#6721CB',\n  '#7735D4',\n  '#894EDE',\n  '#9E6DE3',\n  '#AA82E3',\n  '#C7ABED',\n  '#E3D5F6',\n  '#F1EAFA',\n  '#8F0550',\n  '#A1095C',\n  '#C1026B',\n  '#D4157E',\n  '#E7258F',\n  '#F248A6',\n  '#F273B9',\n  '#F6A2D0',\n  '#FBD0E8',\n  '#FDE8F3',\n];", "import { toast } from '../containers/components';\nexport function assert(\n  condition: boolean,\n  message = 'assert error',\n  env = process.env.NODE_ENV,\n): asserts condition {\n  if (!condition) {\n    if (env !== 'test') {\n      toast({ type: 'error', message: message, duration: 5 });\n    }\n    throw new Error(message);\n  }\n}\n", "/**\n * convert column name to number. e.g A -> 0, a -> 0\n * @param { string } columnName\n */\nexport function columnNameToInt(columnName = ''): number {\n  const temp = columnName.toUpperCase();\n  let num = 0;\n  for (let i = 0; i < temp.length; i++) {\n    num = temp.charCodeAt(i) - 64 + num * 26;\n  }\n  return num - 1;\n}\n/**\n * convert number to column name 0 -> A\n * @param { string } number\n */\nexport function intToColumnName(temp: number): string {\n  const num = temp + 1;\n  let columnName = '';\n  let dividend = Math.floor(Math.abs(num));\n  let rest;\n\n  while (dividend > 0) {\n    rest = (dividend - 1) % 26;\n    columnName = String.fromCharCode(65 + rest) + columnName;\n    dividend = Math.floor((dividend - rest) / 26);\n  }\n  return columnName.toUpperCase();\n}\n\nexport function rowLabelToInt(label: string): number {\n  let result = parseInt(label, 10);\n  if (window.isNaN(result)) {\n    result = -1;\n  } else {\n    result = Math.max(result - 1, -1);\n  }\n  return result;\n}\n\nexport function intToRowLabel(row: number): string {\n  if (row >= 0) {\n    return `${row + 1}`;\n  }\n  return '';\n}\n", "export function classnames(\n  ...rest: Array<string | Record<string, unknown> | undefined>\n): string {\n  let result = '';\n  for (const temp of rest) {\n    if (temp === undefined) {\n      continue;\n    }\n    if (typeof temp === 'string' && temp) {\n      result += `${temp} `;\n    }\n    if (typeof temp === 'object') {\n      for (const key of Object.keys(temp)) {\n        if (temp[key]) {\n          result += `${key} `;\n        }\n      }\n    }\n  }\n  return result.trim();\n}\n", "import { IRange } from '@/types';\n\nexport function isSheet(range: IRange): boolean {\n  return isRow(range) && isCol(range);\n}\nexport function isRow(range: IRange): boolean {\n  return range.colCount === 0;\n}\nexport function isCol(range: IRange): boolean {\n  return range.rowCount === 0;\n}\n\nexport function isSameRange(oldRange?: IRange, newRange?: IRange): boolean {\n  if (!oldRange || !newRange) {\n    return false;\n  }\n  return (\n    oldRange.col === newRange.col &&\n    oldRange.row === newRange.row &&\n    oldRange.colCount === newRange.colCount &&\n    oldRange.rowCount === newRange.rowCount &&\n    oldRange.sheetId === newRange.sheetId\n  );\n}\n\nexport function containRange(row: number, col: number, range: IRange): boolean {\n  return (\n    row >= range.row &&\n    row < range.row + range.rowCount &&\n    col >= range.col &&\n    col < range.col + range.colCount\n  );\n}\n\nexport class Range implements IRange {\n  row = 0;\n  col = 0;\n  colCount = 0;\n  rowCount = 0;\n  sheetId = '';\n  constructor(\n    row: number,\n    col: number,\n    rowCount: number,\n    colCount: number,\n    sheetId: string,\n  ) {\n    this.row = row;\n    this.col = col;\n    this.colCount = colCount;\n    this.rowCount = rowCount;\n    this.sheetId = sheetId;\n  }\n\n  isValid(): boolean {\n    return (\n      this.row >= 0 && this.col >= 0 && this.colCount >= 0 && this.rowCount >= 0\n    );\n  }\n  static makeRange(range: IRange): Range {\n    return new Range(\n      range.row,\n      range.col,\n      range.rowCount,\n      range.colCount,\n      range.sheetId,\n    );\n  }\n  toIRange(): IRange {\n    return {\n      row: this.row,\n      col: this.col,\n      rowCount: this.rowCount,\n      colCount: this.colCount,\n      sheetId: this.sheetId,\n    };\n  }\n}\n", "import { columnNameToInt, rowLabelToInt, intToColumnName } from './convert';\nimport { IRange, ReferenceType } from '@/types';\nimport { Range } from './range';\nimport { DEFAULT_ROW_COUNT, DEFAULT_COL_COUNT } from './constant';\n\nconst isCharacter = (char: string) =>\n  (char >= 'a' && char <= 'z') || (char >= 'A' && char <= 'Z');\nconst isNum = (char: string) => char >= '0' && char <= '9';\n\nfunction convertSheetNameToSheetId(value: string) {\n  return value;\n}\n\nfunction parseCell(\n  ref: string,\n  convertSheetName = convertSheetNameToSheetId,\n): Range | null {\n  if (typeof ref !== 'string' || !ref) {\n    return null;\n  }\n  const realRef = ref.trim();\n  let [sheetName, other = ''] = realRef.split('!');\n  if (!realRef.includes('!')) {\n    sheetName = '';\n    other = realRef;\n  }\n  let i = 0;\n  let rowText = '';\n  let colText = '';\n  if (other[i] === '$') {\n    i++;\n  }\n  while (isCharacter(other[i])) {\n    colText += other[i++];\n  }\n  if (other[i] === '$') {\n    i++;\n  }\n  while (isNum(other[i])) {\n    rowText += other[i++];\n  }\n  if (i !== other.length) {\n    return null;\n  }\n  if (!rowText && !colText) {\n    return null;\n  }\n\n  let rowCount = 1;\n  let colCount = 1;\n  let row = 0;\n  let col = 0;\n  if (rowText === '') {\n    colCount = 0;\n    rowCount = DEFAULT_ROW_COUNT;\n  } else {\n    row = rowLabelToInt(rowText);\n  }\n  if (colText === '') {\n    colCount = DEFAULT_COL_COUNT;\n    rowCount = 0;\n  } else {\n    col = columnNameToInt(colText);\n  }\n  if (row === -1 || col === -1) {\n    return null;\n  }\n  const range = new Range(\n    row,\n    col,\n    rowCount,\n    colCount,\n    convertSheetName(sheetName),\n  );\n  return range;\n}\n\nexport function parseReference(\n  text: string,\n  convertSheetName = convertSheetNameToSheetId,\n): Range | null {\n  const [cell1, cell2] = text.split(':');\n  const startCell = parseCell(cell1, convertSheetName);\n  if (!startCell) {\n    return null;\n  }\n  const endCell = parseCell(cell2, convertSheetName);\n  if (!endCell) {\n    return startCell;\n  }\n  endCell.sheetId = startCell.sheetId;\n  return mergeRange(startCell, endCell);\n}\n\nexport function mergeRange(start: Range, end: Range): Range | null {\n  if (start.sheetId !== end.sheetId) {\n    return null;\n  }\n  if (\n    start.row === end.row &&\n    start.col === end.col &&\n    start.rowCount === end.rowCount &&\n    start.colCount === end.colCount\n  ) {\n    return start;\n  }\n  if (start.rowCount === 0 || end.rowCount === 0) {\n    if (end.rowCount !== 0 || end.rowCount !== 0) {\n      return null;\n    }\n  }\n\n  if (start.colCount === 0 || end.colCount === 0) {\n    if (end.colCount !== 0 || end.colCount !== 0) {\n      return null;\n    }\n  }\n\n  const rowCount = Math.abs(start.row - end.row) + 1;\n  const colCount = Math.abs(start.col - end.col) + 1;\n  const row = start.row < end.row ? start.row : end.row;\n  const col = start.col < end.col ? start.col : end.col;\n\n  return new Range(row, col, rowCount, colCount, start.sheetId);\n}\n\nfunction convertCell(row: number, col: number, referenceType: ReferenceType) {\n  const first = referenceType === 'absolute';\n  const second = referenceType === 'absolute';\n  return `${first ? '$' : ''}${intToColumnName(col)}${second ? '$' : ''}${\n    row + 1\n  }`;\n}\n\nexport function convertToReference(\n  range: IRange,\n  referenceType: ReferenceType = 'relative',\n  convertSheetIdToSheetName = convertSheetNameToSheetId,\n) {\n  let result = convertCell(range.row, range.col, referenceType);\n  let sheetName = convertSheetIdToSheetName(range.sheetId);\n  sheetName = sheetName ? `${sheetName}!` : '';\n  if (range.colCount > 1 && range.rowCount > 1) {\n    const end = convertCell(\n      range.row + range.rowCount,\n      range.col + range.colCount,\n      referenceType,\n    );\n    result = `${result}:${end}`;\n  }\n  return sheetName + result;\n}\n", "import { DEBUG_COLOR_LIST } from './constant';\n\ntype NameSpaceType = 'react' | 'controller' | 'canvas' | 'model';\n\nclass Debug {\n  namespace: NameSpaceType;\n\n  static readonly colorMap: Map<NameSpaceType, string> = new Map<\n    NameSpaceType,\n    string\n  >();\n  static readonly enableMap: Map<NameSpaceType, boolean> = new Map<\n    NameSpaceType,\n    boolean\n  >([]);\n  constructor(namespace: NameSpaceType) {\n    this.namespace = namespace;\n  }\n  init = () => {\n    this.setColor();\n    return this.log;\n  };\n  log = (...rest: unknown[]): void => {\n    if (!this.enable()) {\n      return;\n    }\n    const { namespace } = this;\n    const color = Debug.colorMap.get(namespace);\n    const result = [`%c ${namespace}:`, `color:${color};`, ...rest];\n    console.log(...result);\n  };\n  getRandomColor = (): string => {\n    const index = Math.floor(Math.random() * DEBUG_COLOR_LIST.length);\n    return DEBUG_COLOR_LIST[index];\n  };\n  enable() {\n    return this.checkEnable() && Debug.enableMap.get(this.namespace) !== false;\n  }\n  checkEnable(storage = window.localStorage) {\n    return storage.getItem('debug') === '*';\n  }\n  setColor() {\n    if (!Debug.colorMap.has(this.namespace)) {\n      Debug.colorMap.set(this.namespace, this.getRandomColor());\n    }\n  }\n  static disable(key: NameSpaceType) {\n    Debug.enableMap.set(key, false);\n  }\n}\n\nexport const controllerLog = new Debug('controller').init();\nexport const canvasLog = new Debug('canvas').init();\nexport const modelLog = new Debug('model').init();\n", "/**\n * query all installed fonts\n * window.queryLocalFonts()\n */\nexport const QUERY_ALL_LOCAL_FONT = 'QUERY_ALL_LOCAL_FONT';\nexport const LOCAL_FONT_KEY = 'LOCAL_FONT_KEY';\nexport const FONT_FAMILY_LIST = [\n  '\u7B49\u7EBF',\n  '\u7B49\u7EBF Light',\n  '\u65B9\u6B63\u8212\u4F53',\n  '\u65B9\u6B63\u59DA\u4F53',\n  '\u4EFF\u5B8B',\n  '\u9ED1\u4F53',\n  '\u534E\u6587\u5F69\u4E91',\n  '\u534E\u6587\u4EFF\u5B8B',\n  '\u534E\u6587\u7425\u73C0',\n  '\u534E\u6587\u6977\u4F53',\n  '\u534E\u6587\u96B6\u4E66',\n  '\u534E\u6587\u5B8B\u4F53',\n  '\u534E\u6587\u7EC6\u9ED1',\n  '\u534E\u6587\u65B0\u9B4F',\n  '\u534E\u6587\u884C\u6977',\n  '\u534E\u6587\u4E2D\u5B8B',\n  '\u6977\u4F53',\n  '\u96B6\u4E66',\n  '\u5B8B\u4F53',\n  '\u5FAE\u8F6F\u96C5\u9ED1',\n  '\u5FAE\u8F6F\u96C5\u9ED1 Light',\n  '\u65B0\u5B8B\u4F53',\n  '\u5E7C\u5706',\n  'Arial',\n  'Arial Narrow',\n  'Cascadia Code',\n  'Cascadia Code ExtraLight',\n  'Cascadia Code Light',\n  'Cascadia Code PL',\n  'Cascadia Code PL ExtraLight',\n  'Cascadia Code PL Light',\n  'Cascadia Code PL SemiBold',\n  'Cascadia Code SemiBold',\n  'Cascadia Mono',\n  'Cascadia Mono ExtraLight',\n  'Cascadia Mono Light',\n  'Cascadia Mono PL',\n  'Cascadia Mono PL ExtraLight',\n  'Cascadia Mono PL Light',\n  'Cascadia Mono PL SemiBold',\n  'Cascadia Mono SemiBold',\n  'Microsoft JhengHei',\n  'Microsoft JhengHei Light',\n  'Microsoft JhengHei UI',\n  'Microsoft JhengHei UI Light',\n  'Microsoft New Tai Lue',\n  'Microsoft PhagsPa',\n  'Microsoft Sans Serif',\n  'Microsoft Tai Le',\n  'Microsoft Yahei UI',\n  'Microsoft YaHei UI Light',\n  'Microsoft Yi Baiti',\n  'SimSun-ExtB',\n  'Times New Roman',\n  'Yu Gothic Light',\n  'Yu Gothic Medium',\n  'Yu Gothic Regular',\n  'Yu Gothic UI Light',\n  'Yu Gothic UI Regular',\n  'Yu Gothic UI Semibold',\n];\n", "import { MUST_FONT_FAMILY } from './style';\nimport { OptionItem } from '@/types';\nimport { FONT_FAMILY_LIST, LOCAL_FONT_KEY, QUERY_ALL_LOCAL_FONT } from './font';\n\nexport function SupportFontFamilyFactory() {\n  // a font will be compared against all the three default fonts.\n  // and if it doesn't match all 3 then that font is not available.\n  const baseFonts = ['monospace', MUST_FONT_FAMILY, 'serif'];\n\n  //we use m or w because these two characters take up the maximum width.\n  // And we use a LLi so that the same matching fonts can get separated\n  const testString = 'mmmmmmmmmmlli';\n\n  //we test using 72px font size, we may use any size. I guess larger the better.\n  const testSize = '72px';\n\n  const h = document.getElementsByTagName('body')[0];\n\n  // create a SPAN in the document to get the width of the text we use to test\n  const s = document.createElement('span');\n  s.style.fontSize = testSize;\n  s.innerHTML = testString;\n  const defaultWidth: Record<string, number> = {};\n  const defaultHeight: Record<string, number> = {};\n  for (const item of baseFonts) {\n    //get the default width for the three base fonts\n    s.style.fontFamily = item;\n    h.appendChild(s);\n    defaultWidth[item] = s.offsetWidth; //width for the default font\n    defaultHeight[item] = s.offsetHeight; //height for the defualt font\n    h.removeChild(s);\n  }\n\n  function detect(font: string) {\n    let detected = false;\n    for (const item of baseFonts) {\n      s.style.fontFamily = font + ',' + item; // name of the font along with the base font for fallback.\n      h.appendChild(s);\n      const matched =\n        s.offsetWidth != defaultWidth[item] ||\n        s.offsetHeight != defaultHeight[item];\n      h.removeChild(s);\n      detected = detected || matched;\n    }\n    return detected;\n  }\n\n  return detect;\n}\n\nconst isSupportFontFamily = SupportFontFamilyFactory();\nexport { isSupportFontFamily };\n\nexport function initFontFamilyList(fontList = FONT_FAMILY_LIST): OptionItem[] {\n  const cacheFont = localStorage.getItem(LOCAL_FONT_KEY);\n  if (cacheFont) {\n    const list = JSON.parse(cacheFont) as string[];\n    return list.map((v) => ({ value: v, label: v, disabled: false }));\n  }\n  const list = fontList\n    .map((v) => ({\n      label: v,\n      value: v,\n      disabled: !isSupportFontFamily(v),\n    }))\n    .filter((v) => !v.disabled);\n  if ((window as any).queryLocalFonts) {\n    list.push({\n      value: QUERY_ALL_LOCAL_FONT,\n      label: '--> get all local installed fonts',\n      disabled: false,\n    });\n  }\n  return list;\n}\n", "import type { ClipboardType, ClipboardData } from '@/types';\n\nexport const PLAIN_FORMAT = 'text/plain';\nexport const HTML_FORMAT = 'text/html';\n\nfunction select(element: HTMLTextAreaElement) {\n  const isReadOnly = element.hasAttribute('readonly');\n  if (!isReadOnly) {\n    element.setAttribute('readonly', '');\n  }\n  element.select();\n  element.setSelectionRange(0, element.value.length);\n\n  if (!isReadOnly) {\n    element.removeAttribute('readonly');\n  }\n  return element.value;\n}\n\nfunction createFakeElement(value: string) {\n  const isRTL = document.documentElement.getAttribute('dir') === 'rtl';\n  const fakeElement = document.createElement('textarea');\n  // Prevent zooming on iOS\n  fakeElement.style.fontSize = '12pt';\n  // Reset box model\n  fakeElement.style.border = '0';\n  fakeElement.style.padding = '0';\n  fakeElement.style.margin = '0';\n  // Move element out of screen horizontally\n  fakeElement.style.position = 'absolute';\n  fakeElement.style[isRTL ? 'right' : 'left'] = '-9999px';\n  // Move element to the same position vertically\n  const yPosition = window.pageYOffset || document.documentElement.scrollTop;\n  fakeElement.style.top = `${yPosition}px`;\n\n  fakeElement.setAttribute('readonly', '');\n  fakeElement.value = value;\n\n  return fakeElement;\n}\n\nfunction writeDataToClipboard(textData: ClipboardData) {\n  const result: Record<string, Blob> = {};\n  const keyList = Object.keys(textData) as ClipboardType[];\n  for (const key of keyList) {\n    result[key] = new Blob([textData[key]], { type: key });\n  }\n  const data = [new ClipboardItem(result)];\n  return navigator?.clipboard?.write(data);\n}\n\nasync function readDataFromClipboard(): Promise<ClipboardData> {\n  const result: ClipboardData = {\n    [HTML_FORMAT]: '',\n    [PLAIN_FORMAT]: '',\n  };\n  const list = (await navigator?.clipboard?.read()) || [];\n  for (const item of list) {\n    if (item.types.includes(PLAIN_FORMAT)) {\n      const buf = await item.getType(PLAIN_FORMAT);\n      result[PLAIN_FORMAT] = await buf.text();\n    }\n    if (item.types.includes(HTML_FORMAT)) {\n      const buf = await item.getType(HTML_FORMAT);\n      result[HTML_FORMAT] = await buf.text();\n    }\n  }\n  return result;\n}\n\nconst fakeCopyAction = (\n  value: string,\n  container: HTMLElement,\n  type: 'copy' | 'cut',\n) => {\n  let fakeElement: HTMLTextAreaElement | null = createFakeElement(value);\n  container.appendChild(fakeElement);\n  const selectedText = select(fakeElement);\n  document.execCommand(type);\n  fakeElement.remove();\n  fakeElement = null;\n  return selectedText;\n};\n\nexport async function copyOrCut(\n  textData: ClipboardData,\n  type: 'cut' | 'copy',\n): Promise<string> {\n  try {\n    await writeDataToClipboard(textData);\n    return textData[PLAIN_FORMAT];\n  } catch (error) {\n    console.error(error);\n    return fakeCopyAction(textData[PLAIN_FORMAT], document.body, type);\n  }\n}\n\nexport async function paste(): Promise<ClipboardData> {\n  try {\n    return readDataFromClipboard();\n  } catch (error) {\n    console.error(error);\n    const result = (await navigator?.clipboard?.readText()) || '';\n    return {\n      [HTML_FORMAT]: '',\n      [PLAIN_FORMAT]: result,\n    };\n  }\n}\n\nexport function generateHTML(style: string, content: string): string {\n  return `<html\n  xmlns:v=\"urn:schemas-microsoft-com:vml\"\n  xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n  xmlns:x=\"urn:schemas-microsoft-com:office:excel\"\n  xmlns=\"http://www.w3.org/TR/REC-html40\"\n>\n  <head>\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n    <meta name=\"ProgId\" content=\"Excel.Sheet\" />\n    <meta name=\"Generator\" content=\"Microsoft Excel 15\" />\n    <style>\n      ${style}\n    </style>\n  </head>\n\n  <body >\n    <table\n    >\n      ${content}\n    </table>\n  </body>\n</html>`;\n}\n", "import type { IController } from '@/types';\n\ntype HitInfoResult = {\n  row: number;\n  col: number;\n  marginX: number;\n  marginY: number;\n};\n\nexport function stopPropagation(event: Event) {\n  event.preventDefault();\n  event.stopPropagation();\n}\n\nexport function getHitInfo(\n  controller: IController,\n  x: number,\n  y: number,\n): HitInfoResult | null {\n  if (x < 0 || y < 0) {\n    return null;\n  }\n  const sheetInfo = controller.getSheetInfo(controller.getCurrentSheetId());\n  if (!sheetInfo) {\n    return null;\n  }\n  const scroll = controller.getScroll();\n  const headerSize = controller.getHeaderSize();\n  let resultX = headerSize.width;\n  let resultY = headerSize.height;\n  let marginX = x - headerSize.width;\n  let marginY = y - headerSize.height;\n  let { row, col } = scroll;\n  while (resultX + controller.getColWidth(col).len <= x) {\n    const t = controller.getColWidth(col).len;\n    resultX += t;\n    marginX -= t;\n    col++;\n  }\n  while (resultY + controller.getRowHeight(row).len <= y) {\n    const t = controller.getRowHeight(row).len;\n    resultY += t;\n    marginY -= t;\n    row++;\n  }\n  if (row >= sheetInfo.rowCount || col >= sheetInfo.colCount) {\n    return null;\n  }\n  return { row, col, marginX, marginY };\n}\n", "export function saveAs(blob: Blob | string, fileName: string): void {\n  let link: HTMLAnchorElement | null = document.createElement('a');\n  link.download = fileName || 'download';\n  link.rel = 'noopener';\n  link.target = '_blank';\n  if (typeof blob === 'string') {\n    link.href = blob;\n  } else {\n    link.href = URL.createObjectURL(blob);\n  }\n  link.dispatchEvent(new MouseEvent('click'));\n  link = null;\n}\n", "const colorMap: Record<string, string> = {\n  maroon: '#800000',\n  red: '#ff0000',\n  orange: '#ffA500',\n  yellow: '#ffff00',\n  olive: '#808000',\n  purple: '#800080',\n  fuchsia: '#ff00ff',\n  white: '#ffffff',\n  lime: '#00ff00',\n  green: '#008000',\n  navy: '#000080',\n  blue: '#0000ff',\n  aqua: '#00ffff',\n  teal: '#008080',\n  black: '#000000',\n  silver: '#c0c0c0',\n  gray: '#808080',\n  transparent: '#0000',\n};\n\nconst hexStr = '(?:#([a-f0-9]{3,8}))';\nconst numberStr = '\\\\s*([.\\\\d%]+)\\\\s*';\nconst sopStr = '(?:,\\\\s*([.\\\\d]+)\\\\s*)?';\nconst listStr = `\\\\(${[numberStr, numberStr, numberStr]}${sopStr}\\\\)`;\nconst rgbStr = '(?:rgb)a?';\nconst hslStr = '(?:hsl)a?';\n\nconst hexReg = RegExp(hexStr, 'i');\nconst rgbReg = RegExp(rgbStr + listStr, 'i');\nconst hslReg = RegExp(hslStr + listStr, 'i');\n\nfunction padZero(a: string) {\n  if (a.length === 1) {\n    return `0${a}`;\n  }\n  return a;\n}\nfunction RGBAToHex(r: number, g: number, b: number, a: number) {\n  const list = [r, g, b, a * 255];\n  return `#${list\n    .map((item) => padZero(Math.round(item).toString(16)))\n    .join('')}`;\n}\nfunction RGBtoHEX(r: string, g: string, b: string, a: string): string {\n  let alpha = 1;\n  if (a) {\n    alpha = parseFloat(a);\n  }\n  const red = parseFloat(r);\n  const green = parseFloat(g);\n  const blue = parseFloat(b);\n  if (\n    !(\n      red <= 255 &&\n      red >= 0 &&\n      green <= 255 &&\n      green >= 0 &&\n      blue <= 255 &&\n      blue >= 0 &&\n      alpha <= 1 &&\n      alpha >= 0\n    )\n  ) {\n    return '';\n  }\n  return RGBAToHex(red, green, blue, alpha);\n}\n\nfunction HUEtoRGB(p: number, q: number, t: number) {\n  if (t < 0) t += 1;\n  if (t > 1) t -= 1;\n  if (t < 1 / 6) return p + (q - p) * 6 * t;\n  if (t < 1 / 2) return q;\n  if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n  return p;\n}\n\nfunction HSLAtoHEX(x: string, y: string, z: string, a: string) {\n  let alpha = 1;\n  if (a) {\n    alpha = parseFloat(a) / 1;\n  }\n  const h = parseFloat(x) / 360;\n  const s = parseFloat(y) / 360;\n  const l = parseFloat(z) / 360;\n  if (\n    h > 1 ||\n    h < 0 ||\n    s > 1 ||\n    s < 0 ||\n    l > 1 ||\n    l < 0 ||\n    alpha > 1 ||\n    alpha < 0\n  ) {\n    return '';\n  }\n  let r: number;\n  let g: number;\n  let b: number;\n  if (s === 0) {\n    r = l;\n    g = l;\n    b = l;\n  } else {\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n    r = HUEtoRGB(p, q, h + 1 / 3);\n    g = HUEtoRGB(p, q, h);\n    b = HUEtoRGB(p, q, h - 1 / 3);\n  }\n  return RGBAToHex(r * 255, g * 255, b * 255, alpha);\n}\n\nfunction padHex(color: string) {\n  if (!hexReg.test(color)) {\n    return '';\n  }\n  if (color.length === 9) {\n    return color.toUpperCase();\n  }\n  if (color.length === 7) {\n    const t = `${color}ff`;\n    return t.toUpperCase();\n  }\n  if (color.length === 5) {\n    const [, a, b, c, d] = color;\n    const t = `#${a}${a}${b}${b}${c}${c}${d}${d}`;\n    return t.toUpperCase();\n  }\n  if (color.length === 4) {\n    const [, a, b, c] = color;\n    const t = `#${a}${a}${b}${b}${c}${c}ff`;\n    return t.toUpperCase();\n  }\n  return '';\n}\nexport function convertColorToHex(color: string): string {\n  if (!color) {\n    return '';\n  }\n  if (colorMap[color]) {\n    return padHex(colorMap[color]);\n  }\n  if (hexReg.test(color)) {\n    return padHex(color);\n  }\n  if (rgbReg.test(color)) {\n    const [, r, g, b, a] = color.match(rgbReg)!;\n    return padHex(RGBtoHEX(r, g, b, a));\n  }\n  if (hslReg.test(color)) {\n    const [, h, s, l, a] = color.match(hslReg)!;\n    return padHex(HSLAtoHEX(h, s, l, a));\n  }\n  return '';\n}\n"],
  "mappings": "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AAO,kCAAkC,EACtD,CACF,CAEJ,EAEMR,GAAiC,CACrC,aAAc,MACd,OAAQW,GACR,SAAU,CAAC,CAAE,EAAAC,EAAG,EAAAC,EAAG,EAAAC,CAAE,IAAMC,GAAU,CAAE,EAAAH,EAAG,EAAAC,EAAG,EAAAC,EAAG,EAAG,CAAE,CAAC,EACtD,MAAO,CAACE,EAAOC,IAAW,CACxB,IAAMC,EAAIC,GAAkBH,CAAK,EAC3BI,EAAID,GAAkBF,CAAM,EAClC,OAAOC,IAAME,CACf,CACF,EAEaC,MAAmB,QAC7BC,GACC,EAAAhB,QAAA,cAACR,GAAA,CACC,UAAWwB,EAAM,UACjB,MAAOA,EAAM,MACb,SAAUA,EAAM,SAChB,WAAYtB,GACd,CAEJ,EU3DO,IAAMuB,GAAa,CACxB,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,SACF,EZ3EO,IAAMC,GAERC,GAAU,CACb,GAAM,CAAE,MAAAC,EAAQ,CAAC,EAAG,SAAAC,EAAU,SAAAC,EAAU,MAAAC,EAAO,SAAAC,EAAW,QAAS,EAAIL,EACjE,CAACM,EAASC,CAAU,KAAI,YAAS,EAAK,EACtC,CAACC,CAAG,EAAIC,EAAgB,IAAM,CAClCF,EAAW,EAAK,CAClB,CAAC,EACD,OACE,EAAAG,QAAA,cAAC,OACC,UAAWC,EACTC,EAAO,cAAc,EACrBP,IAAa,MAAQO,EAAO,IAAS,EACvC,EACA,MAAOX,EACP,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",
  "names": ["require_react_dom", "__commonJSMin", "exports", "module", "require_client", "__commonJSMin", "exports", "m", "i", "LANGUAGE_LIST", "SHEET_NAME_PREFIX", "DEFAULT_ROW_COUNT", "DEFAULT_COL_COUNT", "SCROLL_SIZE", "BOTTOM_BUFF", "DEFAULT_POSITION", "FORMULA_PREFIX", "SPLITTER", "DEBUG_COLOR_LIST", "MAX_PARAMS_COUNT", "ERROR_SET", "NUMBER_FORMAT_LIST", "CELL_HEIGHT", "CELL_WIDTH", "HIDE_CELL", "XLSX_MAX_COL_COUNT", "XLSX_MAX_ROW_COUNT", "isNumber", "value", "temp", "parseNumber", "parseNumberArray", "list", "result", "i", "getListMaxNum", "idList", "item", "v", "getDefaultSheetInfo", "sheetId", "SHEET_NAME_PREFIX", "splitToWords", "str", "x", "convertResultTypeToString", "text", "coordinateToString", "row", "col", "SPLITTER", "stringToCoordinate", "key", "c", "getCustomWidthOrHeightKey", "rowOrCol", "generateUUID", "d", "isMobile", "matchList", "ua", "throttle", "fn", "wait", "check", "lastArgs", "args", "get", "obj", "path", "defaultValue", "result", "res", "key", "isEmpty", "value", "temp", "deepEqual", "x", "y", "keys1", "keys2", "i", "key1", "key2", "size", "size_default", "zIndex", "zIndex_default", "hslaToHex", "h", "s", "l", "alpha", "c", "x", "m", "r", "g", "b", "toHex", "value", "hexR", "hexG", "hexB", "RGBToHSL", "red", "green", "blue", "cmin", "cmax", "delta", "hue", "getHue", "lightness", "getLightness", "saturation", "getSaturation", "max", "min", "segment", "shift", "fullDarkMode", "hexToRgba", "hex", "a", "convertColorToDark", "color", "list", "lightColor", "darkColor", "k", "v", "convertColorToDark", "sizeConfig", "size_default", "zIndex_default", "themeKey", "setTheme", "value", "getTheme", "l", "getThemeColor", "key", "darkColor", "lightColor", "dpr", "data", "npx", "px", "thinLineWidth", "isMac", "DEFAULT_FONT_SIZE", "MUST_FONT_FAMILY", "FONT_SIZE_LIST", "makeFont", "fontStyle", "fontWeight", "fontSize", "fontFamily", "temp", "DEFAULT_FONT_CONFIG", "npx", "convertToCssString", "style", "result", "pickCSSStyle", "color", "backgroundColor", "whiteSpace", "textDecorationLine", "textDecorationStyle", "size", "parseStyle", "styleMap", "className", "tagName", "t", "convertToCssStyleDeclaration", "cssStr", "str", "regex", "matches", "match", "div", "key", "parseHTML", "html", "template", "doc", "item", "value", "textList", "styleList", "trList", "tr", "texts", "list", "td", "itemStyle", "import_react", "Button_default", "buttonWrapper", "circle", "disabled", "active", "plain", "primary", "Button", "props", "className", "onClick", "disabled", "active", "type", "style", "testId", "title", "dataType", "buttonType", "children", "cls", "classnames", "Button_default", "React", "import_react", "Github_default", "githubWrapper", "pathStyle", "Github", "React", "Github_default", "icon", "icon_default", "BaseIcon_default", "baseIcon", "import_react", "BaseIcon", "className", "paths", "fill", "React", "classnames", "BaseIcon_default", "item", "i", "FillColorIcon", "fill", "BaseIcon", "Icon", "name", "className", "fill", "paths", "icon_default", "item", "BaseIcon", "import_react", "Select_default", "selectList", "selectItem", "disabled", "Select", "props", "data", "activeValue", "style", "onChange", "getItemStyle", "title", "defaultValue", "React", "event", "Select_default", "item", "value", "label", "disabled", "itemStyle", "cls", "classnames", "import_react", "import_react_dom", "import_client", "Dialog_default", "dialog-modal", "dialog-container", "dialog-title", "dialog-content", "dialog-button", "dialog-cancel", "en_default", "zh_default", "languageKey", "getLanguage", "l", "LANGUAGE_LIST", "v", "lang", "setLanguage", "$", "key", "en_default", "zh_default", "Dialog", "props", "children", "title", "dialogStyle", "onCancel", "onOk", "visible", "getContainer", "React", "classnames", "Dialog_default", "Button", "$", "info", "container", "root", "close", "render", "modalProps", "event", "update", "import_react", "Menu_default", "container", "portal", "menuContainer", "subMenuContainer", "menu", "menuItem", "import_react", "useClickOutside", "callback", "ref", "clickedOutSide", "setState", "handleEvent", "event", "import_react", "useEventCallback", "handler", "callbackRef", "fn", "value", "MenuItem", "onClick", "children", "testId", "React", "Menu_default", "SubMenu", "label", "style", "className", "open", "setOpen", "handleClick", "v", "classnames", "Menu", "menuButton", "ref", "useClickOutside", "import_react", "import_client", "Toast_default", "container", "content", "toast", "icon", "success", "success_icon", "error", "error_icon", "info", "info_icon", "warning", "warning_icon", "Toast", "message", "type", "React", "classnames", "Toast_default", "Icon", "toast", "props", "duration", "rest", "container", "root", "close", "import_react", "Loading_default", "container", "loading", "rotation", "Loading", "React", "Loading_default", "import_react", "ColorPicker_default", "color-picker", "color-picker-wrapper", "top", "show", "color-picker-list", "color-picker-item", "no-fill", "reset", "import_react", "import_react", "import_react", "clamp", "number", "min", "max", "panel_default", "color-picker-panel", "color-picker-panel__saturation", "color-picker-panel__pointer-fill", "color-picker-panel__hue", "color-picker-panel__last-control", "color-picker-panel__interactive", "color-picker-panel__pointer", "color-picker-panel__saturation-pointer", "color-picker-panel__hue-pointer", "isTouch", "event", "getTouchPoint", "touches", "touchId", "i", "getParentWindow", "node", "getRelativePosition", "rect", "pointer", "clamp", "preventDefaultMove", "isInvalid", "hasTouch", "InteractiveBase", "onMove", "onKey", "rest", "container", "onMoveCallback", "useEventCallback", "onKeyCallback", "handleMoveStart", "handleKeyDown", "toggleDocumentEvents", "nativeEvent", "el", "changedTouches", "handleMove", "handleMoveEnd", "keyCode", "state", "touch", "parentWindow", "toggleEvent", "React", "panel_default", "Interactive", "import_react", "Pointer", "className", "color", "left", "top", "style", "React", "classnames", "panel_default", "round", "number", "digits", "base", "angleUnits", "hexToHsva", "hex", "rgbaToHsva", "hexToRgba", "round", "hsvaToHex", "hsva", "rgbaToHex", "hsvaToRgba", "hsvaToHsla", "h", "s", "v", "a", "hh", "round", "hsvaToHslString", "l", "hsvaToRgba", "h", "s", "v", "a", "hh", "b", "c", "d", "module", "round", "format", "number", "hex", "rgbaToHex", "r", "g", "b", "a", "alphaHex", "round", "rgbaToHsva", "max", "delta", "hh", "HueBase", "className", "hue", "onChange", "handleMove", "interaction", "handleKey", "offset", "clamp", "React", "classnames", "panel_default", "Interactive", "round", "Pointer", "hsvaToHslString", "Hue", "import_react", "SaturationBase", "hsva", "onChange", "handleMove", "interaction", "handleKey", "offset", "clamp", "containerStyle", "hsvaToHslString", "React", "panel_default", "Interactive", "round", "Pointer", "Saturation", "import_react", "useColorManipulation", "colorModel", "color", "onChange", "onChangeCallback", "useEventCallback", "hsva", "updateHsva", "cache", "newHsva", "newColor", "deepEqual", "handleChange", "params", "current", "ColorPicker", "className", "colorModel", "color", "onChange", "hsva", "updateHsva", "useColorManipulation", "React", "classnames", "panel_default", "Saturation", "Hue", "hexToHsva", "h", "s", "v", "hsvaToHex", "first", "second", "a", "convertColorToHex", "b", "ColorPickerPanel", "props", "COLOR_LIST", "ColorPicker", "props", "style", "onChange", "children", "color", "position", "visible", "setVisible", "ref", "useClickOutside", "React", "classnames", "ColorPicker_default", "COLOR_LIST", "item", "ColorPickerPanel", "c", "Button", "$", "assert", "condition", "message", "env", "toast", "columnNameToInt", "columnName", "temp", "num", "i", "intToColumnName", "dividend", "rest", "rowLabelToInt", "label", "result", "classnames", "rest", "result", "temp", "key", "isSheet", "range", "isRow", "isCol", "isSameRange", "oldRange", "newRange", "containRange", "row", "col", "Range", "_Range", "rowCount", "colCount", "sheetId", "isCharacter", "char", "isNum", "convertSheetNameToSheetId", "value", "parseCell", "ref", "convertSheetName", "realRef", "sheetName", "other", "rowText", "colText", "rowCount", "colCount", "row", "col", "DEFAULT_ROW_COUNT", "rowLabelToInt", "DEFAULT_COL_COUNT", "columnNameToInt", "Range", "parseReference", "text", "cell1", "cell2", "startCell", "endCell", "mergeRange", "start", "end", "convertCell", "referenceType", "first", "second", "intToColumnName", "convertToReference", "range", "convertSheetIdToSheetName", "result", "Debug", "_Debug", "namespace", "rest", "color", "result", "index", "DEBUG_COLOR_LIST", "storage", "key", "controllerLog", "canvasLog", "modelLog", "QUERY_ALL_LOCAL_FONT", "LOCAL_FONT_KEY", "FONT_FAMILY_LIST", "SupportFontFamilyFactory", "baseFonts", "MUST_FONT_FAMILY", "testString", "testSize", "h", "s", "defaultWidth", "defaultHeight", "item", "detect", "font", "detected", "matched", "isSupportFontFamily", "initFontFamilyList", "fontList", "FONT_FAMILY_LIST", "cacheFont", "LOCAL_FONT_KEY", "v", "list", "isSupportFontFamily", "QUERY_ALL_LOCAL_FONT", "PLAIN_FORMAT", "HTML_FORMAT", "select", "element", "isReadOnly", "createFakeElement", "value", "isRTL", "fakeElement", "yPosition", "writeDataToClipboard", "textData", "result", "keyList", "key", "data", "readDataFromClipboard", "list", "item", "buf", "fakeCopyAction", "container", "type", "selectedText", "copyOrCut", "error", "paste", "generateHTML", "style", "content", "getHitInfo", "controller", "x", "y", "sheetInfo", "scroll", "headerSize", "resultX", "resultY", "marginX", "marginY", "row", "col", "t", "saveAs", "blob", "fileName", "link", "colorMap", "hexStr", "numberStr", "sopStr", "listStr", "rgbStr", "hslStr", "hexReg", "rgbReg", "hslReg", "padZero", "a", "RGBAToHex", "r", "g", "b", "item", "RGBtoHEX", "alpha", "red", "green", "blue", "HUEtoRGB", "p", "q", "t", "HSLAtoHEX", "x", "y", "z", "h", "s", "l", "padHex", "color", "c", "d", "convertColorToHex"]
}
