/* 
MIT License

Copyright (c) 2020 Steve Xu

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/
import{b as Zr,c as qr}from"./chunk-AI5EXC2Q.js";var Wr=Zr((Bs,Pt)=>{"use strict";var Hr={};function ro(t){t.version="0.11.3";function e(l){for(var s="",a=l.length-1;a>=0;)s+=l.charAt(a--);return s}function r(l,s){for(var a="";a.length<s;)a+=l;return a}function n(l,s){var a=""+l;return a.length>=s?a:r("0",s-a.length)+a}function o(l,s){var a=""+l;return a.length>=s?a:r(" ",s-a.length)+a}function i(l,s){var a=""+l;return a.length>=s?a:a+r(" ",s-a.length)}function h(l,s){var a=""+Math.round(l);return a.length>=s?a:r("0",s-a.length)+a}function m(l,s){var a=""+l;return a.length>=s?a:r("0",s-a.length)+a}var x=Math.pow(2,32);function d(l,s){if(l>x||l<-x)return h(l,s);var a=Math.round(l);return m(a,s)}function g(l,s){return s=s||0,l.length>=7+s&&(l.charCodeAt(s)|32)===103&&(l.charCodeAt(s+1)|32)===101&&(l.charCodeAt(s+2)|32)===110&&(l.charCodeAt(s+3)|32)===101&&(l.charCodeAt(s+4)|32)===114&&(l.charCodeAt(s+5)|32)===97&&(l.charCodeAt(s+6)|32)===108}var R=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],v=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function A(l){l[0]="General",l[1]="0",l[2]="0.00",l[3]="#,##0",l[4]="#,##0.00",l[9]="0%",l[10]="0.00%",l[11]="0.00E+00",l[12]="# ?/?",l[13]="# ??/??",l[14]="m/d/yy",l[15]="d-mmm-yy",l[16]="d-mmm",l[17]="mmm-yy",l[18]="h:mm AM/PM",l[19]="h:mm:ss AM/PM",l[20]="h:mm",l[21]="h:mm:ss",l[22]="m/d/yy h:mm",l[37]="#,##0 ;(#,##0)",l[38]="#,##0 ;[Red](#,##0)",l[39]="#,##0.00;(#,##0.00)",l[40]="#,##0.00;[Red](#,##0.00)",l[45]="mm:ss",l[46]="[h]:mm:ss",l[47]="mmss.0",l[48]="##0.0E+0",l[49]="@",l[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'}var k={};A(k);var D=[],y=0;for(y=5;y<=8;++y)D[y]=32+y;for(y=23;y<=26;++y)D[y]=0;for(y=27;y<=31;++y)D[y]=14;for(y=50;y<=58;++y)D[y]=14;for(y=59;y<=62;++y)D[y]=y-58;for(y=67;y<=68;++y)D[y]=y-58;for(y=72;y<=75;++y)D[y]=y-58;for(y=67;y<=68;++y)D[y]=y-57;for(y=76;y<=78;++y)D[y]=y-56;for(y=79;y<=81;++y)D[y]=y-34;var G={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function K(l,s,a){for(var I=l<0?-1:1,c=l*I,M=0,p=1,T=0,_=1,E=0,N=0,F=Math.floor(c);E<s&&(F=Math.floor(c),T=F*p+M,N=F*E+_,!(c-F<5e-8));)c=1/(c-F),M=p,p=T,_=E,E=N;if(N>s&&(E>s?(N=_,T=M):(N=E,T=p)),!a)return[0,I*T,N];var ne=Math.floor(I*T/N);return[ne,I*T-ne*N,N]}function re(l){var s=l.toPrecision(16);if(s.indexOf("e")>-1){var a=s.slice(0,s.indexOf("e"));return a=a.indexOf(".")>-1?a.slice(0,a.slice(0,2)=="0."?17:16):a.slice(0,15)+r("0",a.length-15),a+s.slice(s.indexOf("e"))}var I=s.indexOf(".")>-1?s.slice(0,s.slice(0,2)=="0."?17:16):s.slice(0,15)+r("0",s.length-15);return Number(I)}function V(l,s,a){if(l>2958465||l<0)return null;l=re(l);var I=l|0,c=Math.floor(86400*(l-I)),M=0,p=[],T={D:I,T:c,u:86400*(l-I)-c,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(T.u)<1e-6&&(T.u=0),s&&s.date1904&&(I+=1462),T.u>.9999&&(T.u=0,++c==86400&&(T.T=c=0,++I,++T.D)),I===60)p=a?[1317,10,29]:[1900,2,29],M=3;else if(I===0)p=a?[1317,8,29]:[1900,1,0],M=6;else{I>60&&--I;var _=new Date(1900,0,1);_.setDate(_.getDate()+I-1),p=[_.getFullYear(),_.getMonth()+1,_.getDate()],M=_.getDay(),I<60&&(M=(M+6)%7),a&&(M=Kr(_,p))}return T.y=p[0],T.m=p[1],T.d=p[2],T.S=c%60,c=Math.floor(c/60),T.M=c%60,c=Math.floor(c/60),T.H=c,T.q=M,T}t.parse_date_code=V;var pe=new Date(1899,11,31,0,0,0),Y=pe.getTime(),Q=new Date(1900,2,1,0,0,0);function de(l,s){var a=l.getTime();return s?a-=1461*24*60*60*1e3:l>=Q&&(a+=24*60*60*1e3),(a-(Y+(l.getTimezoneOffset()-pe.getTimezoneOffset())*6e4))/(24*60*60*1e3)}var Me=function(){var s=/(?:\.0*|(\.\d*[1-9])0+)$/;function a(E){return E.indexOf(".")==-1?E:E.replace(s,"$1")}var I=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,c=/(E[+-])(\d)$/;function M(E){return E.indexOf("E")==-1?E:E.replace(I,"$1E").replace(c,"$10$2")}function p(E){var N=E<0?12:11,F=a(E.toFixed(12));return F.length<=N||(F=E.toPrecision(10),F.length<=N)?F:E.toExponential(5)}function T(E){var N=a(E.toFixed(11));return N.length>(E<0?12:11)||N==="0"||N==="-0"?E.toPrecision(6):N}function _(E){var N=Math.floor(Math.log(Math.abs(E))*Math.LOG10E),F;return N>=-4&&N<=-1?F=E.toPrecision(10+N):Math.abs(N)<=9?F=p(E):N===10?F=E.toFixed(10).substr(0,12):F=T(E),a(M(F.toUpperCase()))}return _}();t._general_num=Me;function Pe(l,s){switch(typeof l){case"string":return l;case"boolean":return l?"TRUE":"FALSE";case"number":return(l|0)===l?l.toString(10):Me(l);case"undefined":return"";case"object":if(l==null)return"";if(l instanceof Date)return qt(14,de(l,s&&s.date1904),s)}throw new Error("unsupported value in General format: "+l)}t._general=Pe;function Kr(l,s){s[0]-=581;var a=l.getDay();return l<60&&(a=(a+6)%7),a}var lo="\u0E50\u0E51\u0E52\u0E53\u0E54\u0E55\u0E56\u0E57\u0E58\u0E59".split("");function Qr(l,s,a,I){var c="",M=0,p=0,T=a.y,_,E=0;switch(l){case 98:T=a.y+543;case 121:switch(s.length){case 1:case 2:_=T%100,E=2;break;default:_=T%1e4,E=4;break}break;case 109:switch(s.length){case 1:case 2:_=a.m,E=s.length;break;case 3:return v[a.m-1][1];case 5:return v[a.m-1][0];default:return v[a.m-1][2]}break;case 100:switch(s.length){case 1:case 2:_=a.d,E=s.length;break;case 3:return R[a.q][0];default:return R[a.q][1]}break;case 104:switch(s.length){case 1:case 2:_=1+(a.H+11)%12,E=s.length;break;default:throw"bad hour format: "+s}break;case 72:switch(s.length){case 1:case 2:_=a.H,E=s.length;break;default:throw"bad hour format: "+s}break;case 77:switch(s.length){case 1:case 2:_=a.M,E=s.length;break;default:throw"bad minute format: "+s}break;case 115:if(s!="s"&&s!="ss"&&s!=".0"&&s!=".00"&&s!=".000")throw"bad second format: "+s;return a.u===0&&(s=="s"||s=="ss")?n(a.S,s.length):(I>=2?p=I===3?1e3:100:p=I===1?10:1,M=Math.round(p*(a.S+a.u)),M>=60*p&&(M=0),s==="s"?M===0?"0":""+M/p:(c=n(M,2+I),s==="ss"?c.substr(0,2):"."+c.substr(2,s.length-1)));case 90:switch(s){case"[h]":case"[hh]":_=a.D*24+a.H;break;case"[m]":case"[mm]":_=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":_=((a.D*24+a.H)*60+a.M)*60+(I==0?Math.round(a.S+a.u):a.S);break;default:throw"bad abstime format: "+s}E=s.length===3?1:2;break;case 101:_=T,E=1;break}var N=E>0?n(_,E):"";return N}function fe(l){var s=3;if(l.length<=s)return l;for(var a=l.length%s,I=l.substr(0,a);a!=l.length;a+=s)I+=(I.length>0?",":"")+l.substr(a,s);return I}var le=function(){var s=/%/g;function a(C,u,f){var S=u.replace(s,""),w=u.length-S.length;return le(C,S,f*Math.pow(10,2*w))+r("%",w)}function I(C,u,f){for(var S=u.length-1;u.charCodeAt(S-1)===44;)--S;return le(C,u.substr(0,S),f/Math.pow(10,3*(u.length-S)))}function c(C,u){var f,S=C.indexOf("E")-C.indexOf(".")-1;if(C.match(/^#+0.0E\+0$/)){if(u==0)return"0.0E+0";if(u<0)return"-"+c(C,-u);var w=C.indexOf(".");w===-1&&(w=C.indexOf("E"));var b=Math.floor(Math.log(u)*Math.LOG10E)%w;if(b<0&&(b+=w),f=(u/Math.pow(10,b)).toPrecision(S+1+(w+b)%w),f.indexOf("e")===-1){var L=Math.floor(Math.log(u)*Math.LOG10E);for(f.indexOf(".")===-1?f=f.charAt(0)+"."+f.substr(1)+"E+"+(L-f.length+b):f+="E+"+(L-b);f.substr(0,2)==="0.";)f=f.charAt(0)+f.substr(2,w)+"."+f.substr(2+w),f=f.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");f=f.replace(/\+-/,"-")}f=f.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(W,B,z,U){return B+z+U.substr(0,(w+b)%w)+"."+U.substr(b)+"E"})}else f=u.toExponential(S);return C.match(/E\+00$/)&&f.match(/e[+-]\d$/)&&(f=f.substr(0,f.length-1)+"0"+f.charAt(f.length-1)),C.match(/E\-/)&&f.match(/e\+/)&&(f=f.replace(/e\+/,"e")),f.replace("e","E")}var M=/# (\?+)( ?)\/( ?)(\d+)/;function p(C,u,f){var S=parseInt(C[4],10),w=Math.round(u*S),b=Math.floor(w/S),L=w-b*S,W=S;return f+(b===0?"":""+b)+" "+(L===0?r(" ",C[1].length+1+C[4].length):o(L,C[1].length)+C[2]+"/"+C[3]+n(W,C[4].length))}function T(C,u,f){return f+(u===0?"":""+u)+r(" ",C[1].length+2+C[4].length)}var _=/^#*0*\.([0#]+)/,E=/\).*[0#]/,N=/\(###\) ###\\?-####/;function F(C){for(var u="",f,S=0;S!=C.length;++S)switch(f=C.charCodeAt(S)){case 35:break;case 63:u+=" ";break;case 48:u+="0";break;default:u+=String.fromCharCode(f)}return u}function ne(C,u){var f=Math.pow(10,u);return""+Math.round(C*f)/f}function xe(C,u){var f=C-Math.floor(C),S=Math.pow(10,u);return u<(""+Math.round(f*S)).length?0:Math.round(f*S)}function mt(C,u){return u<(""+Math.round((C-Math.floor(C))*Math.pow(10,u))).length?1:0}function oe(C){return C<2147483647&&C>-2147483648?""+(C>=0?C|0:C-1|0):""+Math.floor(C)}function H(C,u,f){if(C.charCodeAt(0)===40&&!u.match(E)){var S=u.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return f>=0?H("n",S,f):"("+H("n",S,-f)+")"}if(u.charCodeAt(u.length-1)===44)return I(C,u,f);if(u.indexOf("%")!==-1)return a(C,u,f);if(u.indexOf("E")!==-1)return c(u,f);if(u.charCodeAt(0)===36)return"$"+H(C,u.substr(u.charAt(1)==" "?2:1),f);var w,b,L,W,B=Math.abs(f),z=f<0?"-":"";if(u.match(/^00+$/))return z+d(B,u.length);if(u.match(/^[#?]+$/))return w=d(f,0),w==="0"&&(w=""),w.length>u.length?w:F(u.substr(0,u.length-w.length))+w;if(b=u.match(M))return p(b,B,z);if(u.match(/^#+0+$/))return z+d(B,u.length-u.indexOf("0"));if(b=u.match(_))return w=ne(f,b[1].length).replace(/^([^\.]+)$/,"$1."+F(b[1])).replace(/\.$/,"."+F(b[1])).replace(/\.(\d*)$/,function(ee,De){return"."+De+r("0",F(b[1]).length-De.length)}),u.indexOf("0.")!==-1?w:w.replace(/^0\./,".");if(u=u.replace(/^#+([0.])/,"$1"),b=u.match(/^(0*)\.(#*)$/))return z+ne(B,b[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,b[1].length?"0.":".");if(b=u.match(/^#{1,3},##0(\.?)$/))return z+fe(d(B,0));if(b=u.match(/^#,##0\.([#0]*0)$/))return f<0?"-"+H(C,u,-f):fe(""+(Math.floor(f)+mt(f,b[1].length)))+"."+n(xe(f,b[1].length),b[1].length);if(b=u.match(/^#,#*,#0/))return H(C,u.replace(/^#,#*,/,""),f);if(b=u.match(/^([0#]+)(\\?-([0#]+))+$/))return w=e(H(C,u.replace(/[\\-]/g,""),f)),L=0,e(e(u.replace(/\\/g,"")).replace(/[0#]/g,function(ee){return L<w.length?w.charAt(L++):ee==="0"?"0":""}));if(u.match(N))return w=H(C,"##########",f),"("+w.substr(0,3)+") "+w.substr(3,3)+"-"+w.substr(6);var U="";if(b=u.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return L=Math.min(b[4].length,7),W=K(B,Math.pow(10,L)-1,!1),w=""+z,U=le("n",b[1],W[1]),U.charAt(U.length-1)==" "&&(U=U.substr(0,U.length-1)+"0"),w+=U+b[2]+"/"+b[3],U=i(W[2],L),U.length<b[4].length&&(U=F(b[4].substr(b[4].length-U.length))+U),w+=U,w;if(b=u.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return L=Math.min(Math.max(b[1].length,b[4].length),7),W=K(B,Math.pow(10,L)-1,!0),z+(W[0]||(W[1]?"":"0"))+" "+(W[1]?o(W[1],L)+b[2]+"/"+b[3]+i(W[2],L):r(" ",2*L+1+b[2].length+b[3].length));if(b=u.match(/^[#0?]+$/))return w=d(f,0),u.length<=w.length?w:F(u.substr(0,u.length-w.length))+w;if(b=u.match(/^([#0?]+)\.([#0]+)$/)){w=""+f.toFixed(Math.min(b[2].length,10)).replace(/([^0])0+$/,"$1"),L=w.indexOf(".");var Ae=u.indexOf(".")-L,xt=u.length-w.length-Ae;return F(u.substr(0,Ae)+w+u.substr(u.length-xt))}if(b=u.match(/^00,000\.([#0]*0)$/))return L=xe(f,b[1].length),f<0?"-"+H(C,u,-f):fe(oe(f)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(ee){return"00,"+(ee.length<3?n(0,3-ee.length):"")+ee})+"."+n(L,b[1].length);switch(u){case"###,##0.00":return H(C,"#,##0.00",f);case"###,###":case"##,###":case"#,###":var ke=fe(d(B,0));return ke!=="0"?z+ke:"";case"###,###.00":return H(C,"###,##0.00",f).replace(/^0\./,".");case"#,###.00":return H(C,"#,##0.00",f).replace(/^0\./,".");default:}throw new Error("unsupported format |"+u+"|")}function be(C,u,f){for(var S=u.length-1;u.charCodeAt(S-1)===44;)--S;return le(C,u.substr(0,S),f/Math.pow(10,3*(u.length-S)))}function $e(C,u,f){var S=u.replace(s,""),w=u.length-S.length;return le(C,S,f*Math.pow(10,2*w))+r("%",w)}function Z(C,u){var f,S=C.indexOf("E")-C.indexOf(".")-1;if(C.match(/^#+0.0E\+0$/)){if(u==0)return"0.0E+0";if(u<0)return"-"+Z(C,-u);var w=C.indexOf(".");w===-1&&(w=C.indexOf("E"));var b=Math.floor(Math.log(u)*Math.LOG10E)%w;if(b<0&&(b+=w),f=(u/Math.pow(10,b)).toPrecision(S+1+(w+b)%w),!f.match(/[Ee]/)){var L=Math.floor(Math.log(u)*Math.LOG10E);f.indexOf(".")===-1?f=f.charAt(0)+"."+f.substr(1)+"E+"+(L-f.length+b):f+="E+"+(L-b),f=f.replace(/\+-/,"-")}f=f.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(W,B,z,U){return B+z+U.substr(0,(w+b)%w)+"."+U.substr(b)+"E"})}else f=u.toExponential(S);return C.match(/E\+00$/)&&f.match(/e[+-]\d$/)&&(f=f.substr(0,f.length-1)+"0"+f.charAt(f.length-1)),C.match(/E\-/)&&f.match(/e\+/)&&(f=f.replace(/e\+/,"e")),f.replace("e","E")}function j(C,u,f){if(C.charCodeAt(0)===40&&!u.match(E)){var S=u.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return f>=0?j("n",S,f):"("+j("n",S,-f)+")"}if(u.charCodeAt(u.length-1)===44)return be(C,u,f);if(u.indexOf("%")!==-1)return $e(C,u,f);if(u.indexOf("E")!==-1)return Z(u,f);if(u.charCodeAt(0)===36)return"$"+j(C,u.substr(u.charAt(1)==" "?2:1),f);var w,b,L,W,B=Math.abs(f),z=f<0?"-":"";if(u.match(/^00+$/))return z+n(B,u.length);if(u.match(/^[#?]+$/))return w=""+f,f===0&&(w=""),w.length>u.length?w:F(u.substr(0,u.length-w.length))+w;if(b=u.match(M))return T(b,B,z);if(u.match(/^#+0+$/))return z+n(B,u.length-u.indexOf("0"));if(b=u.match(_))return w=(""+f).replace(/^([^\.]+)$/,"$1."+F(b[1])).replace(/\.$/,"."+F(b[1])),w=w.replace(/\.(\d*)$/,function(ee,De){return"."+De+r("0",F(b[1]).length-De.length)}),u.indexOf("0.")!==-1?w:w.replace(/^0\./,".");if(u=u.replace(/^#+([0.])/,"$1"),b=u.match(/^(0*)\.(#*)$/))return z+(""+B).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,b[1].length?"0.":".");if(b=u.match(/^#{1,3},##0(\.?)$/))return z+fe(""+B);if(b=u.match(/^#,##0\.([#0]*0)$/))return f<0?"-"+j(C,u,-f):fe(""+f)+"."+r("0",b[1].length);if(b=u.match(/^#,#*,#0/))return j(C,u.replace(/^#,#*,/,""),f);if(b=u.match(/^([0#]+)(\\?-([0#]+))+$/))return w=e(j(C,u.replace(/[\\-]/g,""),f)),L=0,e(e(u.replace(/\\/g,"")).replace(/[0#]/g,function(ee){return L<w.length?w.charAt(L++):ee==="0"?"0":""}));if(u.match(N))return w=j(C,"##########",f),"("+w.substr(0,3)+") "+w.substr(3,3)+"-"+w.substr(6);var U="";if(b=u.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return L=Math.min(b[4].length,7),W=K(B,Math.pow(10,L)-1,!1),w=""+z,U=le("n",b[1],W[1]),U.charAt(U.length-1)==" "&&(U=U.substr(0,U.length-1)+"0"),w+=U+b[2]+"/"+b[3],U=i(W[2],L),U.length<b[4].length&&(U=F(b[4].substr(b[4].length-U.length))+U),w+=U,w;if(b=u.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return L=Math.min(Math.max(b[1].length,b[4].length),7),W=K(B,Math.pow(10,L)-1,!0),z+(W[0]||(W[1]?"":"0"))+" "+(W[1]?o(W[1],L)+b[2]+"/"+b[3]+i(W[2],L):r(" ",2*L+1+b[2].length+b[3].length));if(b=u.match(/^[#0?]+$/))return w=""+f,u.length<=w.length?w:F(u.substr(0,u.length-w.length))+w;if(b=u.match(/^([#0]+)\.([#0]+)$/)){w=""+f.toFixed(Math.min(b[2].length,10)).replace(/([^0])0+$/,"$1"),L=w.indexOf(".");var Ae=u.indexOf(".")-L,xt=u.length-w.length-Ae;return F(u.substr(0,Ae)+w+u.substr(u.length-xt))}if(b=u.match(/^00,000\.([#0]*0)$/))return f<0?"-"+j(C,u,-f):fe(""+f).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(ee){return"00,"+(ee.length<3?n(0,3-ee.length):"")+ee})+"."+n(0,b[1].length);switch(u){case"###,###":case"##,###":case"#,###":var ke=fe(""+B);return ke!=="0"?z+ke:"";default:if(u.match(/\.[0#?]*$/))return j(C,u.slice(0,u.lastIndexOf(".")),f)+F(u.slice(u.lastIndexOf(".")))}throw new Error("unsupported format |"+u+"|")}return function(u,f,S){return(S|0)===S?j(u,f,S):H(u,f,S)}}();function Gt(l){for(var s=[],a=!1,I=0,c=0;I<l.length;++I)switch(l.charCodeAt(I)){case 34:a=!a;break;case 95:case 42:case 92:++I;break;case 59:s[s.length]=l.substr(c,I-c),c=I+1}if(s[s.length]=l.substr(c),a===!0)throw new Error("Format |"+l+"| unterminated string ");return s}t._split=Gt;var Vt=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Xt(l){for(var s=0,a="",I="";s<l.length;)switch(a=l.charAt(s)){case"G":g(l,s)&&(s+=6),s++;break;case'"':for(;l.charCodeAt(++s)!==34&&s<l.length;);++s;break;case"\\":s+=2;break;case"_":s+=2;break;case"@":++s;break;case"B":case"b":if(l.charAt(s+1)==="1"||l.charAt(s+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(l.substr(s,3).toUpperCase()==="A/P"||l.substr(s,5).toUpperCase()==="AM/PM"||l.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++s;break;case"[":for(I=a;l.charAt(s++)!=="]"&&s<l.length;)I+=l.charAt(s);if(I.match(Vt))return!0;break;case".":case"0":case"#":for(;s<l.length&&("0#?.,E+-%".indexOf(a=l.charAt(++s))>-1||a=="\\"&&l.charAt(s+1)=="-"&&"0#".indexOf(l.charAt(s+2))>-1););break;case"?":for(;l.charAt(++s)===a;);break;case"*":++s,(l.charAt(s)==" "||l.charAt(s)=="*")&&++s;break;case"(":case")":++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;s<l.length&&"0123456789".indexOf(l.charAt(++s))>-1;);break;case" ":++s;break;default:++s;break}return!1}t.is_date=Xt;function jt(l,s,a,I){for(var c=[],M="",p=0,T="",_="t",E,N,F,ne="H";p<l.length;)switch(T=l.charAt(p)){case"G":if(!g(l,p))throw new Error("unrecognized character "+T+" in "+l);c[c.length]={t:"G",v:"General"},p+=7;break;case'"':for(M="";(F=l.charCodeAt(++p))!==34&&p<l.length;)M+=String.fromCharCode(F);c[c.length]={t:"t",v:M},++p;break;case"\\":var xe=l.charAt(++p),mt=xe==="("||xe===")"?xe:"t";c[c.length]={t:mt,v:xe},++p;break;case"_":c[c.length]={t:"t",v:" "},p+=2;break;case"@":c[c.length]={t:"T",v:s},++p;break;case"B":case"b":if(l.charAt(p+1)==="1"||l.charAt(p+1)==="2"){if(E==null&&(E=V(s,a,l.charAt(p+1)==="2"),E==null))return"";c[c.length]={t:"X",v:l.substr(p,2)},_=T,p+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":T=T.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(s<0||E==null&&(E=V(s,a),E==null))return"";for(M=T;++p<l.length&&l.charAt(p).toLowerCase()===T;)M+=T;T==="m"&&_.toLowerCase()==="h"&&(T="M"),T==="h"&&(T=ne),c[c.length]={t:T,v:M},_=T;break;case"A":case"a":case"\u4E0A":var oe={t:T,v:T};if(E==null&&(E=V(s,a)),l.substr(p,3).toUpperCase()==="A/P"?(E!=null&&(oe.v=E.H>=12?l.charAt(p+2):T),oe.t="T",ne="h",p+=3):l.substr(p,5).toUpperCase()==="AM/PM"?(E!=null&&(oe.v=E.H>=12?"PM":"AM"),oe.t="T",p+=5,ne="h"):l.substr(p,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(E!=null&&(oe.v=E.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),oe.t="T",p+=5,ne="h"):(oe.t="t",++p),E==null&&oe.t==="T")return"";c[c.length]=oe,_=T;break;case"[":for(M=T;l.charAt(p++)!=="]"&&p<l.length;)M+=l.charAt(p);if(M.slice(-1)!=="]")throw'unterminated "[" block: |'+M+"|";if(M.match(Vt)){if(E==null&&(E=V(s,a),E==null))return"";c[c.length]={t:"Z",v:M.toLowerCase()},_=M.charAt(1)}else M.indexOf("$")>-1&&(M=(M.match(/\$([^-\[\]]*)/)||[])[1]||"$",Xt(l)||(c[c.length]={t:"t",v:M}));break;case".":if(E!=null){for(M=T;++p<l.length&&(T=l.charAt(p))==="0";)M+=T;c[c.length]={t:"s",v:M};break}case"0":case"#":for(M=T;++p<l.length&&"0#?.,E+-%".indexOf(T=l.charAt(p))>-1;)M+=T;c[c.length]={t:"n",v:M};break;case"?":for(M=T;l.charAt(++p)===T;)M+=T;c[c.length]={t:T,v:M},_=T;break;case"*":++p,(l.charAt(p)==" "||l.charAt(p)=="*")&&++p;break;case"(":case")":c[c.length]={t:I===1?"t":T,v:T},++p;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(M=T;p<l.length&&"0123456789".indexOf(l.charAt(++p))>-1;)M+=l.charAt(p);c[c.length]={t:"D",v:M};break;case" ":c[c.length]={t:T,v:T},++p;break;case"$":c[c.length]={t:"t",v:"$"},++p;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(T)===-1)throw new Error("unrecognized character "+T+" in "+l);c[c.length]={t:"t",v:T},++p;break}var H=0,be=0,$e;for(p=c.length-1,_="t";p>=0;--p)switch(c[p].t){case"h":case"H":c[p].t=ne,_="h",H<1&&(H=1);break;case"s":($e=c[p].v.match(/\.0+$/))&&(be=Math.max(be,$e[0].length-1),H=4),H<3&&(H=3);case"d":case"y":case"e":_=c[p].t;break;case"M":_=c[p].t,H<2&&(H=2);break;case"m":_==="s"&&(c[p].t="M",H<2&&(H=2));break;case"X":break;case"Z":H<1&&c[p].v.match(/[Hh]/)&&(H=1),H<2&&c[p].v.match(/[Mm]/)&&(H=2),H<3&&c[p].v.match(/[Ss]/)&&(H=3)}var Z;switch(H){case 0:break;case 1:case 2:case 3:E.u>=.5&&(E.u=0,++E.S),E.S>=60&&(E.S=0,++E.M),E.M>=60&&(E.M=0,++E.H),E.H>=24&&(E.H=0,++E.D,Z=V(E.D),Z.u=E.u,Z.S=E.S,Z.M=E.M,Z.H=E.H,E=Z);break;case 4:switch(be){case 1:E.u=Math.round(E.u*10)/10;break;case 2:E.u=Math.round(E.u*100)/100;break;case 3:E.u=Math.round(E.u*1e3)/1e3;break}E.u>=1&&(E.u=0,++E.S),E.S>=60&&(E.S=0,++E.M),E.M>=60&&(E.M=0,++E.H),E.H>=24&&(E.H=0,++E.D,Z=V(E.D),Z.u=E.u,Z.S=E.S,Z.M=E.M,Z.H=E.H,E=Z);break}var j="",C;for(p=0;p<c.length;++p)switch(c[p].t){case"t":case"T":case" ":case"D":break;case"X":c[p].v="",c[p].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":c[p].v=Qr(c[p].t.charCodeAt(0),c[p].v,E,be),c[p].t="t";break;case"n":case"?":for(C=p+1;c[C]!=null&&((T=c[C].t)==="?"||T==="D"||(T===" "||T==="t")&&c[C+1]!=null&&(c[C+1].t==="?"||c[C+1].t==="t"&&c[C+1].v==="/")||c[p].t==="("&&(T===" "||T==="n"||T===")")||T==="t"&&(c[C].v==="/"||c[C].v===" "&&c[C+1]!=null&&c[C+1].t=="?"));)c[p].v+=c[C].v,c[C]={v:"",t:";"},++C;j+=c[p].v,p=C-1;break;case"G":c[p].t="t",c[p].v=Pe(s,a);break}var u="",f,S;if(j.length>0){j.charCodeAt(0)==40?(f=s<0&&j.charCodeAt(0)===45?-s:s,S=le("n",j,f)):(f=s<0&&I>1?-s:s,S=le("n",j,f),f<0&&c[0]&&c[0].t=="t"&&(S=S.substr(1),c[0].v="-"+c[0].v)),C=S.length-1;var w=c.length;for(p=0;p<c.length;++p)if(c[p]!=null&&c[p].t!="t"&&c[p].v.indexOf(".")>-1){w=p;break}var b=c.length;if(w===c.length&&S.indexOf("E")===-1){for(p=c.length-1;p>=0;--p)c[p]==null||"n?".indexOf(c[p].t)===-1||(C>=c[p].v.length-1?(C-=c[p].v.length,c[p].v=S.substr(C+1,c[p].v.length)):C<0?c[p].v="":(c[p].v=S.substr(0,C+1),C=-1),c[p].t="t",b=p);C>=0&&b<c.length&&(c[b].v=S.substr(0,C+1)+c[b].v)}else if(w!==c.length&&S.indexOf("E")===-1){for(C=S.indexOf(".")-1,p=w;p>=0;--p)if(!(c[p]==null||"n?".indexOf(c[p].t)===-1)){for(N=c[p].v.indexOf(".")>-1&&p===w?c[p].v.indexOf(".")-1:c[p].v.length-1,u=c[p].v.substr(N+1);N>=0;--N)C>=0&&(c[p].v.charAt(N)==="0"||c[p].v.charAt(N)==="#")&&(u=S.charAt(C--)+u);c[p].v=u,c[p].t="t",b=p}for(C>=0&&b<c.length&&(c[b].v=S.substr(0,C+1)+c[b].v),C=S.indexOf(".")+1,p=w;p<c.length;++p)if(!(c[p]==null||"n?(".indexOf(c[p].t)===-1&&p!==w)){for(N=c[p].v.indexOf(".")>-1&&p===w?c[p].v.indexOf(".")+1:0,u=c[p].v.substr(0,N);N<c[p].v.length;++N)C<S.length&&(u+=S.charAt(C++));c[p].v=u,c[p].t="t",b=p}}}for(p=0;p<c.length;++p)c[p]!=null&&"n?".indexOf(c[p].t)>-1&&(f=I>1&&s<0&&p>0&&c[p-1].v==="-"?-s:s,c[p].v=le(c[p].t,c[p].v,f),c[p].t="t");var L="";for(p=0;p!==c.length;++p)c[p]!=null&&(L+=c[p].v);return L}t._eval=jt;var Jt=/\[[=<>]/,Kt=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Qt(l,s){if(s==null)return!1;var a=parseFloat(s[2]);switch(s[1]){case"=":if(l==a)return!0;break;case">":if(l>a)return!0;break;case"<":if(l<a)return!0;break;case"<>":if(l!=a)return!0;break;case">=":if(l>=a)return!0;break;case"<=":if(l<=a)return!0;break}return!1}function Zt(l,s){var a=Gt(l),I=a.length,c=a[I-1].indexOf("@");if(I<4&&c>-1&&--I,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof s!="number")return[4,a.length===4||c>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=c>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=c>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=c>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break;case 4:break}var M=s>0?a[0]:s<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[I,M];if(a[0].match(Jt)!=null||a[1].match(Jt)!=null){var p=a[0].match(Kt),T=a[1].match(Kt);return Qt(s,p)?[I,a[0]]:Qt(s,T)?[I,a[1]]:[I,a[p!=null&&T!=null?2:1]]}return[I,M]}function qt(l,s,a){a==null&&(a={});var I="";switch(typeof l){case"string":l=="m/d/yy"&&a.dateNF?I=a.dateNF:I=l;break;case"number":l==14&&a.dateNF?I=a.dateNF:I=(a.table!=null?a.table:k)[l],I==null&&(I=a.table&&a.table[D[l]]||k[D[l]]),I==null&&(I=G[l]||"General");break}if(g(I,0))return Pe(s,a);s instanceof Date&&(s=de(s,a.date1904));var c=Zt(I,s);if(g(c[1]))return Pe(s,a);if(s===!0)s="TRUE";else if(s===!1)s="FALSE";else if(s===""||s==null)return"";return jt(c[1],s,a,c[0])}function Yt(l,s){if(typeof s!="number"){s=+s||-1;for(var a=0;a<392;++a){if(k[a]==null){s<0&&(s=a);continue}if(k[a]==l){s=a;break}}s<0&&(s=391)}return k[s]=l,s}t.load=Yt,t._table=k,t.get_table=function(){return k},t.load_table=function(s){for(var a=0;a!=392;++a)s[a]!==void 0&&Yt(s[a],a)},t.init_table=A,t.format=qt,t.choose_format=Zt}ro(Hr);typeof Pt<"u"&&typeof DO_NOT_EXPORT_SSF>"u"&&(Pt.exports=Hr)});var tr=Symbol("Comlink.proxy"),Yr=Symbol("Comlink.endpoint"),en=Symbol("Comlink.releaseProxy"),Ct=Symbol("Comlink.finalizer"),He=Symbol("Comlink.thrown"),rr=t=>typeof t=="object"&&t!==null||typeof t=="function",tn={canHandle:t=>rr(t)&&t[tr],serialize(t){let{port1:e,port2:r}=new MessageChannel;return or(t,e),[r,[r]]},deserialize(t){return t.start(),sn(t)}},rn={canHandle:t=>rr(t)&&He in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},nr=new Map([["proxy",tn],["throw",rn]]);function nn(t,e){for(let r of t)if(e===r||r==="*"||r instanceof RegExp&&r.test(e))return!0;return!1}function or(t,e=globalThis,r=["*"]){e.addEventListener("message",function n(o){if(!o||!o.data)return;if(!nn(r,o.origin)){console.warn(`Invalid origin '${o.origin}' for comlink proxy`);return}let{id:i,type:h,path:m}=Object.assign({path:[]},o.data),x=(o.data.argumentList||[]).map(Ce),d;try{let g=m.slice(0,-1).reduce((v,A)=>v[A],t),R=m.reduce((v,A)=>v[A],t);switch(h){case"GET":d=R;break;case"SET":g[m.slice(-1)[0]]=Ce(o.data.value),d=!0;break;case"APPLY":d=R.apply(g,x);break;case"CONSTRUCT":{let v=new R(...x);d=hn(v)}break;case"ENDPOINT":{let{port1:v,port2:A}=new MessageChannel;or(t,A),d=un(v,[v])}break;case"RELEASE":d=void 0;break;default:return}}catch(g){d={value:g,[He]:0}}Promise.resolve(d).catch(g=>({value:g,[He]:0})).then(g=>{let[R,v]=ze(g);e.postMessage(Object.assign(Object.assign({},R),{id:i}),v),h==="RELEASE"&&(e.removeEventListener("message",n),ir(e),Ct in t&&typeof t[Ct]=="function"&&t[Ct]())}).catch(g=>{let[R,v]=ze({value:new TypeError("Unserializable return value"),[He]:0});e.postMessage(Object.assign(Object.assign({},R),{id:i}),v)})}),e.start&&e.start()}function on(t){return t.constructor.name==="MessagePort"}function ir(t){on(t)&&t.close()}function sn(t,e){return Et(t,[],e)}function Ue(t){if(t)throw new Error("Proxy has been released and is not useable")}function sr(t){return we(t,{type:"RELEASE"}).then(()=>{ir(t)})}var We=new WeakMap,Be="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{let e=(We.get(t)||0)-1;We.set(t,e),e===0&&sr(t)});function an(t,e){let r=(We.get(e)||0)+1;We.set(e,r),Be&&Be.register(t,e,t)}function ln(t){Be&&Be.unregister(t)}function Et(t,e=[],r=function(){}){let n=!1,o=new Proxy(r,{get(i,h){if(Ue(n),h===en)return()=>{ln(o),sr(t),n=!0};if(h==="then"){if(e.length===0)return{then:()=>o};let m=we(t,{type:"GET",path:e.map(x=>x.toString())}).then(Ce);return m.then.bind(m)}return Et(t,[...e,h])},set(i,h,m){Ue(n);let[x,d]=ze(m);return we(t,{type:"SET",path:[...e,h].map(g=>g.toString()),value:x},d).then(Ce)},apply(i,h,m){Ue(n);let x=e[e.length-1];if(x===Yr)return we(t,{type:"ENDPOINT"}).then(Ce);if(x==="bind")return Et(t,e.slice(0,-1));let[d,g]=er(m);return we(t,{type:"APPLY",path:e.map(R=>R.toString()),argumentList:d},g).then(Ce)},construct(i,h){Ue(n);let[m,x]=er(h);return we(t,{type:"CONSTRUCT",path:e.map(d=>d.toString()),argumentList:m},x).then(Ce)}});return an(o,t),o}function cn(t){return Array.prototype.concat.apply([],t)}function er(t){let e=t.map(ze);return[e.map(r=>r[0]),cn(e.map(r=>r[1]))]}var ar=new WeakMap;function un(t,e){return ar.set(t,e),t}function hn(t){return Object.assign(t,{[tr]:!0})}function ze(t){for(let[e,r]of nr)if(r.canHandle(t)){let[n,o]=r.serialize(t);return[{type:"HANDLER",name:e,value:n},o]}return[{type:"RAW",value:t},ar.get(t)||[]]}function Ce(t){switch(t.type){case"HANDLER":return nr.get(t.name).deserialize(t.value);case"RAW":return t.value}}function we(t,e,r){return new Promise(n=>{let o=pn();t.addEventListener("message",function i(h){!h.data||!h.data.id||h.data.id!==o||(t.removeEventListener("message",i),n(h.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:o},e),r)})}function pn(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var ge=12,lr="sans-serif",cr="Sheet",Ge=22,Ve=76,uo=Ge,ho=Ve/2,bt=0,po=10,Oe="&#10;",fo=`
`,go=",",wt=16384,Rt=1048576,mo=200,xo=200,Co=30,Eo=-999,bo="__sheet_item_",Xe="=",_e="_",wo=35,Le=256,Ro=/^[a-zA-Z_][a-zA-Z0-9_.]*$/,yt=9,yo="__FORMULA_EDITOR_ROLE__",Ne="General",To="@",je=new Set(["#GETTING_DATA","#DIV/0!","#NULL!","#NUM!","#REF!","#VALUE!","#N/A","#NAME?"]),O=1,Je={thin:O,hair:O,dotted:O,dashed:O,dashDot:O,dashDotDot:O,double:O,medium:O*2,mediumDashed:O*2,mediumDashDot:O*2,mediumDashDotDot:O*2,thick:O*4},vo=["#35322B","#505050","#606060","#6F6F6F","#8B8B8B","#B2B2B2","#CCCCCC","#E5E5E5","#F5F5F5","#FFFFFF","#9D0000","#B20000","#CD0F0F","#E30909","#F30B0B","#FE4B4B","#FA7979","#FB9D9D","#FDCECE","#FEE7E7","#B24000","#CC4F10","#DF5D00","#F96800","#FB8937","#FF8C51","#FCA669","#FDC49B","#FEE1CD","#FEF0E6","#B19401","#C5A300","#D8B300","#EBC301","#F9D700","#FBE137","#FCE869","#FDF09B","#FEF7CD","#FEFBE6","#58770A","#688C0D","#7AA017","#8BBB11","#A4DC16","#BEEE44","#CEF273","#DEF6A2","#EFFBD0","#F7FDE8","#007676","#008A8A","#009E9E","#00BBBB","#1CD8D8","#2AEAEA","#76EFEF","#A3F5F5","#D1FAFA","#E8FCFC","#001F9C","#0025B7","#012BD2","#133DE3","#2F55EB","#4567ED","#738DF2","#A2B3F6","#D0D9FB","#E8ECFD","#3F0198","#510EB0","#6721CB","#7735D4","#894EDE","#9E6DE3","#AA82E3","#C7ABED","#E3D5F6","#F1EAFA","#8F0550","#A1095C","#C1026B","#D4157E","#E7258F","#F248A6","#F273B9","#F6A2D0","#FBD0E8","#FDE8F3"];function ie(t){if(typeof t=="boolean")return[!0,Number(t)];if(typeof t=="number"&&!isNaN(t))return[!0,t];if(typeof t!="string")return[!1,0];if(t.length>12)return[!1,0];let e=Number(t);return isNaN(e)?[!1,0]:[!0,e]}function dn(t=[]){let e=t.map(r=>ie(r)[1]).filter(r=>!isNaN(r));return Math.max(Math.max(...e),0)}function Mo(t=[]){let e=Math.ceil(dn(t.map(r=>r.sheetId)))+1;return{name:`${cr}${e}`,sheetId:String(e),sort:e}}function Ao(t){if(typeof t=="string"){let n=t.toUpperCase();if(["TRUE","FALSE"].includes(n))return n==="TRUE"}if(typeof t=="boolean")return t;if(t==="")return"";let[e,r]=ie(t);return e?r:t}function Ke(t,e){return`${t}${_e}${e}`}function ur(t){let[e,r]=t.split(_e),n=parseInt(e,10),o=parseInt(r,10);return{row:isNaN(n)?-1:n,col:isNaN(o)?-1:o}}function Tt(t,e){return`${t}${_e}${e}`}function ko(t){let[e,r]=t.split(_e),n=parseInt(r,10);return{sheetId:e,rowOrCol:isNaN(n)?-1:n}}function Do(){let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){let n=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(r==="x"?n:n&3|8).toString(16)})}function Oo(){let t=[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i],e=navigator.userAgent;return t.some(r=>e.match(r))}function _o(t){let e=new Set;for(let r of t){let n=r.type;e.add(n),n==="worksheets"?r.key.includes("style")?e.add("cellStyle"):r.key.includes("value")||r.key.includes("formula")?e.add("cellValue"):(e.add("cellValue"),e.add("cellStyle")):n==="workbook"?(r.key.includes("rowCount")&&e.add("row"),r.key.includes("colCount")&&e.add("col")):n==="customHeight"?e.add("row"):n==="customWidth"&&e.add("col")}return e}function hr(){return!1}function Lo(){return navigator.userAgent.indexOf("Mac OS X")>-1}function pr(t){return!!(typeof t=="string"&&t&&t.startsWith(Xe)&&t.length>1)}function dr(t,e){return t&&e.includes(Oe)}function No(t){return t.length===1&&t[0]==="#TEXT"}var $=class extends Error{constructor(e){super(e),this.value=e}};function q(t,e="#VALUE!"){if(!t)throw new $(e)}function Qe(t){q(t.length===1);let[e]=t;return e}function Re(t){let e=Qe(t);return q(typeof e=="string"),e}function J(t){let e=Qe(t),[r,n]=ie(e);return q(r),n}function vt(t){q(t.length===0)}function Ze(t){let e=t.toUpperCase();return/^[A-Z]+\d+$/.test(e)||/^[A-Z]+$/.test(e)}var fn=(...t)=>{let e=Qe(t);return typeof e=="string"?e:""},gn=(...t)=>Re(t).toLowerCase(),fr=(...t)=>{let e=J(t);return String.fromCharCode(e)},gr=(...t)=>Re(t).charCodeAt(0),mn=(...t)=>Re(t).length,xn=(...t)=>{q(t.length===2);let[e,r]=t;return q(typeof e=="string"),q(typeof r=="string"),e.split(r)},Cn=(...t)=>Re(t).toUpperCase(),En=(...t)=>Re(t).replace(/ +/g," ").trim(),mr=(...t)=>(q(t.length<=Le),t.join("")),bn={CONCAT:mr,CONCATENATE:mr,SPLIT:xn,CHAR:fr,CODE:gr,UNICHAR:fr,UNICODE:gr,LEN:mn,LOWER:gn,UPPER:Cn,TRIM:En,T:fn},xr=bn;function Cr(t){let e=[];for(let r=0;r<t.length;r++){let[n,o]=ie(t[r]);n&&e.push(o)}return e}var wn=(...t)=>{let e=J(t);return Math.abs(e)},Rn=(...t)=>{let e=J(t);return Math.acos(e)},yn=(...t)=>{let e=J(t);return Math.log(e+Math.sqrt(e*e-1))},Tn=(...t)=>{let e=J(t);return Math.atan(1/e)},vn=(...t)=>{let e=J(t);return .5*Math.log((e+1)/(e-1))},In=(...t)=>{let e=J(t);return Math.asin(e)},Sn=(...t)=>{let e=J(t);return Math.log(e+Math.sqrt(e*e+1))},Mn=(...t)=>{let e=J(t);return Math.atan(e)},An=(...t)=>{q(t.length===2);let[e,r]=t;return q(typeof e=="number"),q(typeof r=="number"),Math.atan2(e,r)},kn=(...t)=>{let e=J(t);return Math.log((1+e)/(e+1))/2},Dn=(...t)=>{let e=Cr(t);return q(e.length<=Le&&e.length>=1),e.reduce((r,n)=>r+n,0)/e.length},On=(...t)=>{let e=J(t);return Math.cos(e)},_n=(...t)=>{let e=J(t);return 1/Math.tan(e)};var Ln=(...t)=>{let e=J(t);return Math.exp(e)},Nn=(...t)=>{let e=J(t);return Math.floor(e)};var Fn=(...t)=>(vt(t),Math.PI),Pn=(...t)=>(vt(t),Math.E),$n=(...t)=>{let e=J(t);return Math.sin(e)},Un=(...t)=>{let e=Cr(t);return q(e.length<=Le),e.reduce((r,n)=>r+n,0)},Hn={ABS:wn,ACOS:Rn,ACOSH:yn,ACOT:Tn,ACOTH:vn,ASIN:In,ASINH:Sn,ATAN:Mn,ATAN2:An,ATANH:kn,AVERAGE:Dn,COT:_n,COS:On,EXP:Ln,INT:Nn,PI:Fn,E:Pn,SIN:$n,SUM:Un},Er=Hn;function br(t){let e=String(t),r=/[.](\d*)/.exec(e);if(r&&r[1]){let n=Math.pow(10,Math.min(r[1].length,yt)),o=e.split("."),i=o[0]+o[1].slice(0,yt);return Number(i)/n}else return t}var Wn={...xr,...Er},qe=Wn;var ae=class{constructor(e,r){this.type=e,this.value=r}toString(){return this.value}};function wr(t){let e=t.toUpperCase(),r=0;for(let n=0;n<e.length;n++)r=e.charCodeAt(n)-64+r*26;return r-1}function Ye(t){let e=t+1,r="",n=Math.floor(Math.abs(e)),o;for(;n>0;)o=(n-1)%26,r=String.fromCharCode(65+o)+r,n=Math.floor((n-o)/26);return r.toUpperCase()}function Rr(t){let e=parseInt(t,10);return isNaN(e)?e=-1:e=Math.max(e-1,-1),e}function ye(t){return Te(t)&&ve(t)}function Te(t){return t.colCount===0}function ve(t){return t.rowCount===0}function mi(t,e){return t.col===e.col&&t.row===e.row&&t.colCount===e.colCount&&t.rowCount===e.rowCount&&t.sheetId===e.sheetId}function yr(t,e){if(t.colCount===0&&e.colCount!==0||t.rowCount===0&&e.rowCount!==0)return!1;if(e.colCount===0&&e.row===t.row||e.rowCount===0&&e.col===t.col)return!0;let{row:r,col:n}=t;return r>=e.row&&r<e.row+e.rowCount&&n>=e.col&&n<e.col+e.colCount}var ce=class t{constructor(e,r,n,o,i){this.row=0;this.col=0;this.colCount=0;this.rowCount=0;this.sheetId="";this.row=e,this.col=r,this.colCount=o,this.rowCount=n,this.sheetId=i}static makeRange(e){return new t(e.row,e.col,e.rowCount,e.colCount,e.sheetId)}toIRange(){return{row:this.row,col:this.col,rowCount:this.rowCount,colCount:this.colCount,sheetId:this.sheetId}}};function Tr(t,e,r){let{row:n,col:o,rowCount:i,colCount:h}=t;if(!e)return;if(ye(t)){for(let d=0;d<e.rowCount;d++)for(let g=0;g<e.colCount;g++)if(r(d,g))return;return}if(Te(t)){for(let d=0;d<e.colCount;d++)if(r(n,d))return;return}if(ve(t)){for(let d=0;d<e.rowCount;d++)if(r(d,o))return;return}let m=n+i,x=o+h;for(let d=n;d<m;d++)for(let g=o;g<x;g++)if(r(d,g))return}var et=t=>t>="a"&&t<="z"||t>="A"&&t<="Z",ue=t=>t>="0"&&t<="9";function Mr(t){return t}function vr(t,e){if(!t)return;let r=t.trim(),[n,o=""]=r.split("!");r.includes("!")||(n="",o=r),n&&n[0]==="'"&&n[n.length-1]==="'"&&(n=n.slice(1,-1));let i=0,h="",m="";for(o[i]==="$"&&i++;i<o.length&&et(o[i]);)m+=o[i++];for(o[i]==="$"&&i++;i<o.length&&ue(o[i]);)h+=o[i++];if(i!==o.length||!h&&!m)return;let x=1,d=1,g=-1,R=-1;return h===""?(x=0,g=0):g=Rr(h),m===""?(d=0,R=0):R=wr(m),g<0||R<0||R>=wt||g>=Rt?void 0:new ce(g,R,x,d,e(n))}function Ar(t,e=Mr){let[r,n]=t.split(":"),o=vr(r,e);if(!o)return;let i=vr(n,e);return i?(i.sheetId=o.sheetId,It(o,i)):o}function It(t,e){if(t.sheetId!==e.sheetId)return;if(t.row===e.row&&t.col===e.col&&t.rowCount===e.rowCount&&t.colCount===e.colCount)return t;if(t.rowCount===0&&e.rowCount!==0||t.rowCount!==0&&e.rowCount===0||t.colCount===0&&e.colCount!==0||t.colCount!==0&&e.colCount===0)return;let r=Math.abs(t.row-e.row)+1,n=Math.abs(t.col-e.col)+1,o=t.row<e.row?t.row:e.row,i=t.col<e.col?t.col:e.col;return new ce(o,i,r,n,t.sheetId)}function Ir(t,e,r){let n=r==="absolute"||r==="mixed",o=r==="absolute";return`${n?"$":""}${Ye(e)}${o?"$":""}${t+1}`}function wi(t,e="relative",r=Mr){let n=Ir(t.row,t.col,e),o=r(t.sheetId);if(o=o?`${o}!`:"",t.colCount>1&&t.rowCount>1){let i=Ir(t.row+t.rowCount-1,t.col+t.colCount-1,e);n=`${n}:${i}`}return o+n}function Sr(t,e){let r=-1;if(t.startsWith("[")){let n=parseInt(t.slice(1,-1),10);isNaN(n)||(r=e+n)}else{let n=parseInt(t,10);isNaN(n)||(r=n-1)}return isNaN(r)?-1:r}function kr(t,e={row:-1,col:-1}){let r=t.toUpperCase();if(r[0]!=="R")return;let n=r.slice(1).split("C");if(n.length!==2)return;let[o,i]=n,h=-1,m=-1;return o?h=Sr(o,e.row):h=e.row,i?m=Sr(i,e.col):m=e.col,m>=wt||h>=Rt||h<0||m<0?void 0:new ce(h,m,1,1,"")}var Dr="",Bn=new Map([["TRUE",20],["FALSE",21]]),tt=class{constructor(e){this.current=0;this.start=0;this.tokens=[];this.list=[...e]}scan(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();return this.tokens.push(new ae(31,"")),this.tokens.length>0&&this.tokens[0].type===0&&this.tokens.shift(),this.tokens}peek(){return this.isAtEnd()?Dr:this.list[this.current]}match(e){return this.peek()!==e?!1:(this.next(),!0)}next(){return this.isAtEnd()?Dr:this.list[this.current++]}isAtEnd(){return this.current>=this.list.length}addToken(e){let r=this.list.slice(this.start,this.current).join("");this.tokens.push(new ae(e,r))}string(e){for(;!this.isAtEnd()&&this.peek()!==e;)this.next();if(this.peek()!==e)throw new $("#VALUE!");this.next();let r=this.list.slice(this.start+1,this.current-1).join("");this.tokens.push(new ae(17,r))}getDigits(){for(;!this.isAtEnd()&&ue(this.peek());)this.next()}getAlphas(){for(;!this.isAtEnd()&&et(this.peek());)this.next()}matchR1C1(){if(this.match("[")){if(this.match("-"),ue(this.peek()))this.getDigits();else throw new $("#VALUE!");if(this.peek()!=="]")throw new $("#VALUE!");this.next()}else this.getDigits()}matchScientificCounting(e){if(this.match("E")||this.match("e")){if(this.match("+")||this.match("-"))return this.getDigits(),this.addToken(e?18:19),!0;if(ue(this.peek()))return this.getDigits(),this.addToken(e?18:19),!0;throw new $("#VALUE!")}return!1}number(){if(this.getDigits(),this.matchScientificCounting(!1))return;let r=!1;this.match(".")&&(r=!0,this.getDigits()),!this.matchScientificCounting(!0)&&this.addToken(r?18:19)}addIdentifier(){for(;!this.isAtEnd()&&this.anyChar(this.peek());)this.next();let e=this.list.slice(this.start,this.current).join(""),r=e.toUpperCase(),n=Bn.get(r),o=16;n&&(e=r,o=n),/^[A-Z]+\$\d+$/.test(r)&&(e=r,o=29),this.tokens.push(new ae(o,e))}scanToken(){let e=this.next();switch(e){case"$":{et(this.peek())?(this.getAlphas(),this.match("$")?ue(this.peek())?(this.getDigits(),this.addToken(30)):this.addIdentifier():ue(this.peek())?(this.getDigits(),this.addToken(29)):this.addToken(30)):ue(this.peek())?(this.getDigits(),this.addToken(30)):this.addIdentifier();break}case"r":case"R":{if(this.matchR1C1(),this.match("C")||this.match("c")){this.matchR1C1();let r=this.list.slice(this.start,this.current).join("").toUpperCase();this.tokens.push(new ae(28,r))}else this.addIdentifier();break}case"(":this.addToken(22);break;case")":this.addToken(23);break;case",":this.addToken(11);break;case":":this.addToken(10);break;case Xe:this.addToken(0);break;case"<":this.match(">")?this.addToken(1):this.match("=")?this.addToken(15):this.addToken(14);break;case">":this.match("=")?this.addToken(8):this.addToken(7);break;case"+":this.addToken(2);break;case"-":this.addToken(3);break;case"*":this.addToken(4);break;case"/":this.addToken(5);break;case"^":this.addToken(6);break;case"&":this.addToken(9);break;case"%":this.addToken(13);break;case'"':this.string(e);break;case"'":this.string(e);break;case"!":this.addToken(27);break;case";":this.addToken(26);break;case"{":this.addToken(24);break;case"}":this.addToken(25);break;case" ":break;case"\r":case"	":case`
`:break;default:ue(e)?this.number():this.addIdentifier();break}}anyChar(e){return!'(),:=<>+-*/^&%"{}!'.includes(e)&&!this.isWhiteSpace(e)}isWhiteSpace(e){return e===" "||e==="\r"||e===`
`||e==="	"}};var me=class{constructor(e,r,n){this.left=e,this.operator=r,this.right=n}accept(e){return e.visitBinaryExpression(this)}handleConcatenate(e){let r=e.toString();return this.operator.type===9&&e instanceof Ee&&e.value.type===17?JSON.stringify(r):r}toString(){let e=this.handleConcatenate(this.left),r=this.handleConcatenate(this.right);return`${e}${this.operator.toString()}${r}`}},rt=class{constructor(e,r){this.operator=e,this.right=r}accept(e){return e.visitUnaryExpression(this)}toString(){return this.operator.toString()+this.right.toString()}},nt=class{constructor(e,r){this.operator=e,this.left=r}accept(e){return e.visitPostUnaryExpression(this)}toString(){return this.left.toString()+this.operator.toString()}},Ee=class{constructor(e){this.value=e}accept(e){return e.visitLiteralExpression(this)}toString(){return this.value.toString()}},ot=class{constructor(e){this.value=e}accept(e){return e.visitR1C1Expression(this)}toString(){return this.value.toString()}},se=class{constructor(e,r,n){this.value=e,this.sheetName=n,this.type=r}accept(e){return e.visitCellExpression(this)}toString(){let e=this.value.toString().toUpperCase();if(this.sheetName){let r=this.sheetName.toString();return r.includes(" ")&&(r=`'${r}'`),`${r}!${e}`}else return e}},it=class{constructor(e,r){this.name=e,this.params=r}accept(e){return e.visitCallExpression(this)}toString(){return`${this.name.toString().toUpperCase()}(${this.params.map(e=>e.toString()).join(",")})`}},st=class{constructor(e,r,n){this.left=e,this.operator=r,this.right=n}accept(e){return e.visitCellRangeExpression(this)}toString(){return this.left.toString()+this.operator.toString()+this.right.toString()}},at=class{constructor(e){this.value=e}accept(e){return e.visitGroupExpression(this)}toString(){return`(${this.value.toString()})`}},Ie=class{constructor(e){this.value=e}accept(e){return e.visitTokenExpression(this)}toString(){return this.value.toString()}},lt=class{constructor(e){this.value=e}accept(e){return e.visitArrayExpression(this)}toString(){return`{${this.value.map(r=>r.toString()).join(",")}}`}};var ct=class{constructor(e){this.current=0;this.tokens=e}parse(){let e=[];for(;!this.isAtEnd();)e.push(this.expression());return e}expression(){return this.comparison()}comparison(){let e=this.concatenate();for(;this.match(0,1,7,8,14,15);){let r=this.previous(),n=this.concatenate();e=new me(e,r,n)}return e}concatenate(){let e=this.term();for(;this.match(9);){let r=this.previous(),n=this.term();e=new me(e,r,n)}return e}term(){let e=this.factor();for(;this.match(2,3);){let r=this.previous(),n=this.factor();e=new me(e,r,n)}return e}factor(){let e=this.expo();for(;this.match(5,4);){let r=this.previous(),n=this.expo();e=new me(e,r,n)}return e}expo(){let e=this.unary();for(;this.match(6);){let r=this.previous(),n=this.unary();e=new me(e,r,n)}return e}unary(){if(this.match(2,3)){let e=this.previous(),r=this.unary();return new rt(e,r)}return this.postUnary()}postUnary(){let e=this.cellRange();if(this.match(13)){let r=this.previous();e=new nt(r,e)}return e}cellRange(){let e=this.sheetRange();for(;this.match(10);){let r=this.previous(),n=this.sheetRange(),o=this.convertToCellExpression(n),i=this.convertToCellExpression(e);e=new st(i,r,o)}return e}convertToCellExpression(e){if(e instanceof se)return e;if(e instanceof Ie&&Ze(e.value.value))return new se(e.value,"relative",void 0);if(e instanceof Ee&&e.value.type===19)return new se(e.value,"relative",void 0);throw new $("#NAME?")}sheetRange(){let e=this.call();if(this.match(27)){let r=this.call();if(e instanceof Ie||e instanceof Ee){let n=this.convertToCellExpression(r);return new se(n.value,n.type,e.value)}}return e}call(){let e=this.primary();for(;this.match(22);)e=this.finishCall(e);return e}finishCall(e){let r=[];if(!this.check(23))do{if(this.peek().type==23)break;r.push(this.expression())}while(this.match(11));return this.expect(23),new it(e,r)}primary(){if(this.match(24)){let e=[];do{if(this.peek().type==25)break;e.push(this.expression())}while(this.match(11));return this.expect(25),new lt(e)}if(this.match(22)){let e=this.expression();return this.expect(23),new at(e)}if(this.match(19,18,17,20,21))return new Ee(this.previous());if(this.match(30)){let e=this.previous();return new se(e,"absolute",void 0)}if(this.match(29)){let e=this.previous();return new se(e,"mixed",void 0)}if(this.match(16)){let e=this.previous(),r=e.value.toUpperCase();if(je.has(r))throw new $(r);return new Ie(e)}if(this.match(28))return new ot(this.previous());throw new $("#VALUE!")}match(...e){let{type:r}=this.peek();return e.includes(r)?(this.next(),!0):!1}previous(){return this.tokens[this.current-1]}check(e){return this.peek().type===e}expect(e){if(this.check(e))return this.next(),this.previous();throw new $("#VALUE!")}next(){this.current++}isAtEnd(){return this.peek().type===31}peek(){return this.current<this.tokens.length?this.tokens[this.current]:new ae(31,"")}};var ut=class{constructor(e,r,n){this.expressions=e,this.cellDataMap=n,this.currentCoord=r}interpret(){let e=[];for(let r of this.expressions){let n=this.evaluate(r),o=this.getRangeCellValue(n);Array.isArray(o)?e=e.concat(o):e.push(o)}return e}visitBinaryExpression(e){let r=this.evaluate(e.left),n=this.evaluate(e.right);switch(r=this.getOneValue(r),n=this.getOneValue(n),[3,2,5,4,6].includes(e.operator.type)&&(r=this.parseNumber(r),n=this.parseNumber(n)),e.operator.type){case 3:return r-n;case 2:return r+n;case 5:{if(n===0)throw new $("#DIV/0!");return r/n}case 4:return r*n;case 6:return Math.pow(r,n);case 0:return r===n;case 1:return r!==n;case 7:return r>n;case 8:return r>=n;case 14:return r<n;case 15:return r<=n;case 9:return`${r}${n}`;default:throw new $("#TEXT")}}visitCallExpression(e){let r=this.evaluate(e.name);if(r&&typeof r=="function"){let n=[];for(let o of e.params){let i=this.evaluate(o);if(i instanceof ce){let h=this.getCellValue(i,!1);n=n.concat(h)}else n.push(i)}return r(...n)}throw new $("#NAME?")}visitR1C1Expression(e){let r=kr(e.value.value,this.currentCoord);if(!r)throw new $("#NAME?");return r}visitCellExpression(e){let r="";if(e.sheetName){let o=this.cellDataMap.getSheetInfo("",e.sheetName.value);if(!o)throw new $("#REF!");r=o.sheetId}let n=Ar(e.value.value);if(!n)throw new $("#NAME?");return r&&(n.sheetId=r),n}visitLiteralExpression(e){let{type:r,value:n}=e.value;switch(r){case 17:return n;case 18:case 19:{let[o,i]=ie(n);if(o)return i;throw new $("#VALUE!")}case 20:return!0;case 21:return!1;default:throw new $("#VALUE!")}}visitTokenExpression(e){let{value:r}=e.value,n=r.toLowerCase();if(this.cellDataMap.getDefinedName(n)){let i=this.cellDataMap.getDefinedName(n);return this.getCellValue(i,!0)}let o=this.cellDataMap.getFunction(r.toUpperCase());if(o)return o;if(Ze(r))return this.visitCellExpression(new se(e.value,"relative",void 0));throw new $("#NAME?")}visitUnaryExpression(e){let r=this.evaluate(e.right),n=this.parseNumber(this.getOneValue(r));switch(e.operator.type){case 3:return-n;case 2:return n;default:throw new $("#VALUE!")}}visitCellRangeExpression(e){switch(e.operator.type){case 10:{let r=this.visitCellExpression(e.left),n=this.visitCellExpression(e.right),o=It(r,n);if(!o)throw new $("#NAME?");return o}default:throw new $("#NAME?")}}visitGroupExpression(e){return this.evaluate(e.value)}visitArrayExpression(e){let r=[];for(let n of e.value)r.push(this.evaluate(n));return r}visitPostUnaryExpression(e){let r=this.evaluate(e.left),n=this.parseNumber(this.getOneValue(r));switch(e.operator.type){case 13:return n*.01;default:throw new $("#VALUE!")}}evaluate(e){return e.accept(this)}getRangeCellValue(e){if(e instanceof ce){if(e.colCount===e.rowCount&&e.colCount===1)return this.getCellValue(e,!0);throw new $("#REF!")}return e}getOneValue(e){let r=this.getRangeCellValue(e);return Array.isArray(r)?r[0]:r}parseNumber(e){let[r,n]=ie(e);if(!r)throw new $("#VALUE!");return n}getCellValue(e,r){let n=[];if(r){let x=this.cellDataMap.getCell(e),d=this.cellDataMap.handleCell(x,{row:e.row,col:e.col});return n=n.concat(d),n}let{row:o,col:i,sheetId:h}=e,m=this.cellDataMap.getSheetInfo(h);if(!m||o>=m.rowCount||i>=m.colCount)throw new $("#REF!");return Tr(e,m,(x,d)=>{let g=this.cellDataMap.getCell({row:x,col:d,rowCount:1,colCount:1,sheetId:h}),R=this.cellDataMap.handleCell(g,{row:x,col:d});return n=n.concat(R),!1}),n}};function At(t,e={row:0,col:0},r=new ht,n=new Map){if(n.has(t))return n.get(t);try{r.handleCell=(d,g)=>d?d.formula?At(d.formula,g,r,n).result:[d.value]:[];let o={result:[],expressionStr:""};n.set(t,o);let i=new tt(t).scan(),h=new ct(i).parse(),m=new ut(h,e,r).interpret(),x=[];for(let d of h)x.push(d.toString());o.expressionStr=x.join("");for(let d of m)typeof d=="number"&&!isNaN(d)?o.result.push(br(d)):o.result.push(d);return o}catch(o){if(o instanceof $){let i={result:[o.value]};return n.set(t,i),i}throw o}}var Mt="_test_",ht=class{constructor(){this.map=new Map;this.definedNameMap=new Map;this.currentSheetId=Mt;this.sheetList=[{sheetId:Mt,name:"_test_",rowCount:200,colCount:30,isHide:!1,sort:1}];this.getFunction=e=>qe[e];this.handleCell=(e,r)=>e?[e.value]:[]}getKey(e,r,n){return`${e}_${r}_${n||Mt}`}setSheetList(e){this.sheetList=e}set(e,r){let{row:n,col:o,sheetId:i}=e;for(let h=0;h<r.length;h++)for(let m=0;m<r[h].length;m++){let x=this.getKey(n+h,o+m,i),d=r[h][m];typeof d=="string"&&pr(d)?this.map.set(x,{formula:d,value:""}):this.map.set(x,{value:d})}}getCell(e){let{row:r,col:n,sheetId:o}=e,i=this.getKey(r,n,o);return this.map.get(i)}getSheetInfo(e,r){if(r)return this.sheetList.find(o=>o.name===r);let n=e||this.currentSheetId;return this.sheetList.find(o=>o.sheetId===n)}setDefinedName(e,r){this.definedNameMap.set(e,r)}getDefinedName(e){return this.definedNameMap.get(e)}};function kt(t){let{currentSheetId:e,worksheets:r,workbook:n,definedNames:o}=t,i=new Map,h=r[e]||{},m=[],x={handleCell:()=>[],getFunction:d=>qe[d],getCell:d=>{let{row:g,col:R,sheetId:v}=d,k=r[v||e]||{},D=Ke(g,R);return k[D]},set:()=>{throw new $("#REF!")},getSheetInfo:(d,g)=>{if(g)return n.find(v=>v.name===g);let R=d||e;return n.find(v=>v.sheetId===R)},setDefinedName:()=>{throw new $("#REF!")},getDefinedName:d=>o[d]};for(let[d,g]of Object.entries(h)){if(!g?.formula)continue;let R=At(g?.formula,ur(d),x,i);if(!R)continue;let v=R.result[0];v!==g.value&&m.push({key:d,newValue:v,sheetId:e})}return m}function Dt(t){return t?typeof Intl>"u"||typeof Intl.Segmenter!="function"?[...t]:[...new Intl.Segmenter([],{granularity:"word"}).segment(t)].map(n=>n.segment):[]}var zn={smallFont:"10px",font:"12px",largeFont:"14px",padding:"12px",lineHeight:1.5,mediumPadding:"8px",largePadding:"20px",borderRadius:"4px",borderLargeRadius:"8px",tinyPadding:"4px",scrollBarContent:"30px",formulaBarHeight:"25px"},Or=zn;var Gn={lowZIndex:2,middleZIndex:3,highZIndex:4,highestZIndex:9},_r=Gn;function Vn(t,e,r,n){e=e/100,r=r/100;let o=(1-Math.abs(2*r-1))*e,i=o*(1-Math.abs(t/60%2-1)),h=r-o/2,m,x,d;if(t>=0&&t<60?(m=o,x=i,d=0):t>=60&&t<120?(m=i,x=o,d=0):t>=120&&t<180?(m=0,x=o,d=i):t>=180&&t<240?(m=0,x=i,d=o):t>=240&&t<300?(m=i,x=0,d=o):(m=o,x=0,d=i),n!==1)return`rgba(${m},${x},${d},${n})`;let g=k=>Math.round(k*255).toString(16).padStart(2,"0"),R=g(m+h),v=g(x+h),A=g(d+h);return`#${R}${v}${A}`}var Xn=(t,e,r)=>{let n=t/255,o=e/255,i=r/255,h=Math.min(n,o,i),m=Math.max(n,o,i),x=m-h,d=jn(n,o,i),g=Kn(m,h),R=Jn(x,g);return[d,R*100,g*100]},jn=(t,e,r)=>{let n=Math.max(t,e,r),o=Math.min(t,e,r),i=n-o,h=0;if(i==0)h=0;else switch(n){case t:{let d=(e-r)/i,g=0;d<0&&(g=360/60),h=d+g;break}case e:{let d=(r-t)/i,g=120/60;h=d+g;break}case r:let m=(t-e)/i,x=240/60;h=m+x;break}return h*60},Jn=(t,e)=>t==0?0:t/(1-Math.abs(2*e-1)),Kn=(t,e)=>(t+e)/2,Lr=([t,e,r,n])=>{let[o,i,h]=Xn(t,e,r);return Vn(o,i*.9,100-h,n)};function Qn(t){t.startsWith("#")&&(t=t.slice(1));let e=parseInt(t.substring(0,2),16),r=parseInt(t.substring(2,4),16),n=parseInt(t.substring(4,6),16),o=parseInt(t.substring(6,8)||"ff",16);return[e,r,n,o/255]}var Ot=t=>{if(t.startsWith("rgb")){let r=t.replace("rgb","").replace("a","").replace("(","").replace(")","").split(",").map(Number);return r.length<=3&&r.push(1),Lr(r)}else return Lr(Qn(t))};var _t=Object.freeze({primaryColor:"#217346",buttonActiveColor:"#c6c6c6",selectionColor:"rgba(198,198,198,0.3)",backgroundColor:"#e6e6e6",hoverColor:"rgba(0, 0, 0, 0.04)",scrollbarColor:"rgba(0, 0, 0, 0.1)",scrollbarHoveColor:"rgba(0, 0, 0, 0.2)",dialogBackground:"rgba(0, 0, 0, 0.6)",white:"#ffffff",black:"#000000",triangleFillColor:"#dddddd",contentColor:"#333333",borderColor:"#cccccc",activeBorderColor:"#808080",errorFormulaColor:"#ff0000"}),Nr=Object.freeze(Object.fromEntries(Object.entries(_t).map(([t,e])=>[t,Ot(e)])));var pt={...Or,..._r},Lt="data-theme";function ys(t){sessionStorage.setItem(Lt,t),document.documentElement.setAttribute(Lt,t)}function Zn(){if(typeof sessionStorage<"u"){let t=sessionStorage.getItem(Lt);if(t&&(t==="dark"||t==="light"))return t}return typeof matchMedia=="function"&&matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function X(t,e){return e==="dark"||Zn()==="dark"?Nr[t]:_t[t]}var Nt;function Se(t=typeof devicePixelRatio>"u"?void 0:devicePixelRatio){return typeof Nt=="number"?Nt:Math.max(Math.floor(t||1),1)}function P(t){return Math.floor(t*Se())}function Fr(t){Nt=Math.max(Math.floor(t||1),1)}function Is(t,e){let r=!1,n;return function(...o){r?n=o:(t.apply(this,o),setTimeout(()=>{n&&t.apply(this,n),r=!1},e))}}function Ss(t,e,r){let n=t==null?void 0:e.replace(/\[/g,".").replace(/\]/g,"").split(".").reduce((o,i)=>o==null?o:o[i],t);return n===void 0?r:n}function Pr(t){let e=t||{};return[Object,Array].includes(e.constructor)&&!Object.entries(e).length}function qn(t,e){if(t===e)return!0;if(t&&typeof t=="object"&&e&&typeof e=="object"){if(Object.keys(t).length!==Object.keys(e).length)return!1;let r=Object.keys(t),n=Object.keys(e);for(let o=0;o<r.length;o++){let i=r[o],h=n[o];if(i!==h||!qn(t[i],e[h]))return!1}return!0}return!1}function Ms(){}function $r(t){let e=t.toLowerCase().replace(/[-_\s.]+(.)?/g,(r,n)=>n?n.toUpperCase():"");return e.substring(0,1).toLowerCase()+e.substring(1)}var Fs=[6,8,9,10,ge,14,16,18,20,22,24,26,28,36,48,72];function dt(t="normal",e="normal",r=ge,n=""){let o=`${t} ${e} ${r}px `,i=[lr];return hr()&&i.unshift("Source Code Pro"),n&&i.unshift(n),o+i.join(",")}function Ps(t){let e="";return t.fontColor&&(e+=`color:${t.fontColor};`),t.fillColor&&(e+=`background-color:${t.fillColor};`),t.fontSize&&(e+=`font-size:${t.fontSize}pt;`),t.fontFamily&&(e+=`font-family:${t.fontFamily};`),t.isItalic&&(e+="font-style:italic;"),t.isBold&&(e+="font-weight:700;"),t.isWrapText&&(e+="white-space:normal;"),t.underline&&t.isStrike?e+="text-decoration-line:underline line-through;":t.underline?e+="text-decoration-line:underline;":t.isStrike&&(e+="text-decoration-line:line-through;"),t.underline===2&&(e+="text-decoration-style: double;"),e}function Ft(t){let{color:e,backgroundColor:r,fontSize:n,fontFamily:o,fontStyle:i,fontWeight:h,whiteSpace:m,textDecorationLine:x,textDecorationStyle:d}=t,g={};if(e&&(g.fontColor=e),r&&(g.fillColor=r),n){let R=parseInt(n,10);isNaN(R)||(g.fontSize=R)}return o&&(g.fontFamily=o),i==="italic"&&(g.isItalic=!0),h&&[700,800,900,"bold"].includes(h)&&(g.isBold=!0),m&&["normal","pre-wrap","pre-line","break-spaces","revert","unset"].includes(m)&&(g.isWrapText=!0),x?.includes("underline")&&(g.underline=1,d==="double"&&(g.underline=2)),x?.includes("line-through")&&(g.isStrike=!0),g}function eo(t,e,r,n){let o={},i=n.toLowerCase(),h=t[n]||t[i];return h&&(o=Ft(h)),t[r]&&(o=Object.assign(o,Ft(t[r]))),o=Object.assign(o,Ft(e)),i==="s"||i==="strike"?o.isStrike=!0:i==="i"?o.isItalic=!0:i==="b"||i==="strong"?o.isBold=!0:i==="u"&&(o.underline=1),o}function to(t){let e=t.replace(/\s+/g,"").replace("<!--",""),r=/([^{}]+)\s*\{([^}]*)\}/g,n={},o;for(;(o=r.exec(e))!==null;){let i=(o[1]||"").trim(),h=(o[2]||"").trim();if(!i||!h)continue;n[i]={};let m=h.split(";");for(let x of m){let[d,g]=x.split(":").map(D=>D.trim());if(!g||!d)continue;let R=$r(d),[v,A]=ie(g),k=v?A:g;n[i][R]=k}}return n}function Ur(t){let e=parseInt(t,10);return isNaN(e)?-1:t.endsWith("pt")?Math.ceil(e*96/72):e}function $s(t,e="pt"){let r=Math.floor(t*72/96);return String(r)+e}function Us(t,e="	"){let r;t.indexOf(`\r
`)>=0?r=t.split(`\r
`):r=t.split(`
`);let n=r.map(i=>i.trim()).filter(i=>i).map(i=>i.split(e).map(h=>h.trim()).filter(h=>h)),o=[];for(let i of n)i.length!==0&&o.push(i);return o}function Hs(t){let e=document.createElement("template");e.innerHTML=t;let r=e.content,n={};for(let g of r.querySelectorAll("style")){let R=to(g.textContent||"");for(let[v,A]of Object.entries(R))n[v]=Object.assign(n[v]||{},A)}let o=[],i=[],h=r.querySelectorAll("tr"),m=new Map,x=new Map,d=0;for(let g of h){let R=Ur(g.style.height);R>0&&x.set(d++,R);let v=[],A=[],k=0;for(let D of g.children){if(D.tagName!=="TD")continue;let y=D,G=Ur(y.style.width);G>0&&!m.has(k)&&m.set(k++,G);let K={};for(;y.nodeType!==Node.TEXT_NODE;){let re=eo(n,y.style,y.className?`.${y.className}`:"",y.tagName);if(K=Object.assign(K,re),y.firstChild)y=y.firstChild;else break}A.push(K),v.push((y.textContent??"").trim())}o.push(v),i.push(A)}return e=void 0,{textList:o,styleList:i,rowMap:x,colMap:m}}var $t=qr(Wr());function Br(t,e,r={}){return $t.default.format(e||Ne,t,r)}function zr(t){return t?$t.default.is_date(t):!1}function Gs(t,e){let r=new Date(1899,11,31,0,0,0),n=r.getTime(),o=new Date(1900,2,1,0,0,0),i=t.getTime();return e?i-=1461*24*60*60*1e3:t>=o&&(i+=24*60*60*1e3),(i-(n+(t.getTimezoneOffset()-r.getTimezoneOffset())*6e4))/(24*60*60*1e3)}var Ut=new Map;function no(t,e){let r=`${e}__${t.font}`;if(Ut.has(r))return Ut.get(r);let n=t.measureText(e),{actualBoundingBoxAscent:o,actualBoundingBoxDescent:i}=n,h=o+i,m=n.width,x=Math.ceil(m/Se()),d=Math.ceil(h/Se()),g={width:x,height:d};return Ut.set(r,g),g}function te(t,e,r,n,o){t.fillRect(P(e),P(r),P(n),P(o))}function Ht(t,e,r,n,o){t.strokeRect(P(e),P(r),P(n),P(o))}function Wt(t,e,r,n,o){t.clearRect(P(e),P(r),P(n),P(o))}function ft(t,e,r,n){t.fillText(e,P(r),P(n))}function he(t,e){if(e.length!==0){t.beginPath();for(let r=0;r<e.length;r+=2){let n=e[r],o=e[r+1];t.moveTo(P(n[0]),P(n[1])),t.lineTo(P(o[0]),P(o[1]))}t.stroke()}}function Gr(t,e,r,n){t.beginPath(),t.moveTo(P(e[0]),P(e[1])),t.lineTo(P(r[0]),P(r[1])),t.lineTo(P(n[0]),P(n[1])),t.fill()}function Vr(t,e,r){let n=t.slice(),[o,i]=t,h=O*2,m=r?h:0;return e==="bottom"?n.push([o[0]+m,o[1]-h],[i[0]-m,i[1]-h]):e==="top"?n.push([o[0]+m,o[1]+h],[i[0]-m,i[1]+h]):e==="left"?n.push([o[0]+h,o[1]+m],[i[0]+h,i[1]-m]):e==="right"&&n.push([o[0]-h,o[1]+m],[i[0]-h,i[1]-m]),n}function oo(t,e,r){return r?e?t.split(Oe):Dt(t.replaceAll(Oe,"")):Dt(t)}function Xr(t,e,r,n,o){t.setLineDash([P(8),P(6)]);let i=O;Ht(t,e+i,r+i,n-i*2,o-i*2),t.setLineDash([])}function io(t){let e=[];return t==="hair"?e=[O,O]:t==="dotted"||t==="mediumDashed"?e=[O*2,O*2]:t==="dashed"?e=[O*4,O*4]:t==="dashDot"||t==="mediumDashDot"?e=[O*4,O*4,O*8,O*4]:(t==="dashDotDot"||t==="mediumDashDotDot")&&(e=[O*4,O*4,O*8,O*4,O*4,O*4]),e}function Fe(t,e,r,n,o){if(!r)return;let{top:i,left:h,width:m,height:x}=e,d=[];n==="top"?d=[[h,i],[h+m,i]]:n==="bottom"?d=[[h,i+x],[h+m,i+x]]:n==="left"?d=[[h,i],[h,i+x]]:n==="right"&&(d=[[h+m,i],[h+m,i+x]]);let{type:g,color:R}=r;t.lineWidth=Je[g],t.strokeStyle=R||X("black",o);let v=io(g);g==="double"&&(d=Vr(d,n,!0)),v.length>0&&t.setLineDash(v.map(A=>P(A))),he(t,d),v.length>0&&t.setLineDash([])}function jr(t,e,r,n,o,i){let h={height:0,width:0};if(r===""&&Pr(n))return h;let m=n?.numberFormat||Ne,x=m===Ne&&typeof r=="number",d=Br(r,m),g=n?.fontSize?n.fontSize:ge,R=dt(n?.isItalic?"italic":"normal",n?.isBold?"bold":"500",P(g),n?.fontFamily);n?.fillColor&&(t.fillStyle=n?.fillColor,te(t,e.left,e.top,e.width,e.height));let v=n?.fontColor||X("contentColor",i);je.has(d)&&(v=X("errorFormulaColor",i)),t.font=R,t.fillStyle=v;let A=n?{...n}:{},k=A?.horizontalAlign;A?.horizontalAlign===void 0&&x&&(k=2),A.horizontalAlign=k;let G=(!A?.isWrapText&&zr(m)?[d]:oo(d,n?.isWrapText,o)).map(pe=>{let Y=no(t,pe);return{str:pe,width:Y.width,height:Y.height===0?g:Y.height}}),{width:K,height:re,resultList:V}=so(G,e,A,dr(!!o,d));if(K>0&&re>0){let pe=Math.ceil(g*(pt.lineHeight-1)/2),Y=[];for(let Q of V){if(ft(t,Q.text,Q.x,Q.y),A?.underline){t.strokeStyle=v;let de=Q.y+Q.height+pe/2,Me=[[Q.x,de],[Q.x+Q.width,de]];A?.underline===2?Y=Y.concat(Vr(Me,"bottom",!1)):Y=Y.concat(Me)}if(A?.isStrike){t.strokeStyle=v;let de=Q.y+Q.height/2+pe/2;Y=Y.concat([[Q.x,de],[Q.x+Q.width,de]])}}he(t,Y)}return h.height=Math.ceil(re),h.width=Math.ceil(K),h}function so(t,e,r,n){let o=r?.fontSize?r.fontSize:ge,i=Math.ceil(o*(pt.lineHeight-1)/2),h=r?.verticalAlign??1,{left:m,top:x,height:d}=e,g=Math.max(e.width,...t.map(k=>k.width)),R=[],v=0,A=0;if(r?.isWrapText&&n){let k=0;for(let D=0;D<t.length;D++){let y=t[D];v=Math.max(v,y.width);let G=y.height+i*2;A+=G,R.push({text:y.str,x:0,y:k,width:y.width,height:y.height}),k+=G}}else if(r?.isWrapText){let k=0;for(let D=0;D<t.length;){let y=g,G="",K=0,re=0;for(;D<t.length;){let V=t[D];if(y>=V.width)K+=V.width,re=Math.max(re,V.height),y-=V.width,G+=V.str,D++;else break}if(G){v=Math.max(v,K);let V=re+i*2;A+=V,R.push({text:G,x:0,y:k,width:K,height:re}),k+=V}}}else{let k="",D=g;for(let y=0;y<t.length;y++){let G=t[y];if(D>=G.width)v+=G.width,A=Math.max(A,G.height),k+=G.str,D-=G.width;else break}R.push({text:k,x:0,y:0,width:v,height:A})}if(A=Math.max(A,o*pt.lineHeight),v+=i,A+=i,v<=g&&A<=d){let k=m+i,D=x+(d-A)/2+i;h===0?D=x+i:h===2&&(D=x+(d-A)+i),r?.horizontalAlign===1?k=m+(g-v)/2:r?.horizontalAlign===2&&(k=m+(g-v)-i);for(let y of R)y.x=y.x+k,y.y=y.y+D}return{width:v,height:A,resultList:R}}function Bt(t){return{textAlign:"center",textBaseline:"middle",font:dt(void 0,"500",P(ge)),fillStyle:X("black",t),lineWidth:O,strokeStyle:X("borderColor",t)}}var Jr=Math.max(...Object.values(Je)),gt=class{constructor(e){this.width=0;this.height=0;this.isRendering=!1;this.rowMap={};this.colMap={};this.eventData={theme:"light",sheetData:{},canvasSize:{top:0,left:0,width:0,height:0},headerSize:{width:0,height:0},currentSheetInfo:{isHide:!1,rowCount:0,colCount:0,name:"",sheetId:"",tabColor:"",sort:1},scroll:{left:0,top:0,row:0,col:0,scrollLeft:0,scrollTop:0},range:{row:0,col:0,rowCount:1,colCount:1,sheetId:""},copyRange:void 0,customHeight:{},customWidth:{},currentMergeCells:[]};this.canvas=e,this.ctx=e.getContext("2d");let r=Se();this.ctx.scale(r,r)}render(e){if(e.changeSet.size===0||this.isRendering)return;this.isRendering=!0,this.eventData=e,this.clear();let{ctx:r}=this;r.strokeStyle=X("primaryColor",e.theme),r.fillStyle=X("white",e.theme),r.lineWidth=O*2;let{width:n,height:o}=this.eventData.canvasSize,i=this.eventData.headerSize,{endRow:h,contentHeight:m}=this.renderRowsHeader(o),{endCol:x,contentWidth:d}=this.renderColsHeader(n);this.renderGrid(n-i.width,o-i.height),this.renderTriangle(),this.renderMergeCell(),this.ctx.fillStyle=X("selectionColor",this.eventData.theme);let g=this.renderSelection({endRow:h,endCol:x,contentHeight:m,contentWidth:d});return this.renderAntLine(g),this.renderContent({endRow:h,endCol:x,contentHeight:m,contentWidth:d}),this.ctx.lineWidth=Jr,Ht(this.ctx,g.left,g.top,g.width,g.height),this.isRendering=!1,{rowMap:this.rowMap,colMap:this.colMap}}resize(e){this.width=e.width,this.height=e.height,this.canvas.width=P(e.width),this.canvas.height=P(e.height)}clear(){Wt(this.ctx,0,0,this.width,this.height)}renderRowsHeader(e){let{row:r}=this.eventData.scroll,n=this.eventData.headerSize,{rowCount:o}=this.eventData.currentSheetInfo;this.ctx.save();let i=this.eventData.range;te(this.ctx,0,n.height,n.width,e),Object.assign(this.ctx,Bt(this.eventData.theme));let h=[],m=n.height,x=r;for(;x<o&&m<e;x++){let g=this.getRowHeight(x),R=m;if(x===r&&(R+=O/2),h.push([0,R],[n.width,R]),g>0){let v=this.isHighlightRow(i,x);this.ctx.fillStyle=v?X("primaryColor",this.eventData.theme):X("black",this.eventData.theme),ft(this.ctx,String(x+1),n.width/2,R+g/2)}m+=g}h.push([0,m],[n.width,m]),h.push([0,0],[0,m]),he(this.ctx,h),this.ctx.restore();let d=x>=o?m:e;return{endRow:x,contentHeight:Math.floor(d)}}renderColsHeader(e){let{col:r}=this.eventData.scroll,n=this.eventData.headerSize,{colCount:o}=this.eventData.currentSheetInfo,i=this.eventData.range,h=[];this.ctx.save(),te(this.ctx,n.width,0,e,n.height),Object.assign(this.ctx,Bt());let m=n.width,x=r;for(;x<o&&m<=e;x++){let g=this.getColWidth(x),R=m;if(x===r&&(R+=O/2),h.push([R,0],[R,n.height]),g>0){let v=this.isHighlightCol(i,x);this.ctx.fillStyle=v?X("primaryColor",this.eventData.theme):X("black",this.eventData.theme),ft(this.ctx,Ye(x),R+g/2,n.height/2)}m+=g}h.push([m,0],[m,n.height]),h.push([0,0],[m,0]),he(this.ctx,h),this.ctx.restore();let d=x>=o?m:e;return{endCol:x,contentWidth:Math.floor(d)}}renderGrid(e,r){let n=this.eventData.headerSize,{row:o,col:i}=this.eventData.scroll,{rowCount:h,colCount:m}=this.eventData.currentSheetInfo;this.ctx.save(),this.ctx.lineWidth=O,this.ctx.strokeStyle=X("borderColor",this.eventData.theme),this.ctx.translate(P(n.width),P(n.height));let x=[],d=0,g=0;for(let R=o;R<h&&d<=r;R++){for(;R<h&&this.getRowHeight(R)===0;)R++;x.push([0,d],[e,d]);let v=this.getRowHeight(R);d+=v}for(let R=i;R<m&&g<=e;R++){for(;R<m&&this.getColWidth(R)===0;)R++;x.push([g,0],[g,d]);let v=this.getColWidth(R);g+=v}x.push([0,d],[g,d]),x.push([g,0],[g,d]),he(this.ctx,x),this.ctx.restore()}renderTriangle(){let e=this.eventData.headerSize;this.ctx.save(),te(this.ctx,0,0,e.width,e.height),this.ctx.fillStyle=X("triangleFillColor",this.eventData.theme);let r=2,n=Math.floor(r),o=Math.floor(e.height-r),i=Math.floor(e.width*.4),h=Math.floor(e.width-r);Gr(this.ctx,[h,n],[i,o],[h,o]),this.ctx.restore()}getRowHeight(e){let r=Tt(this.eventData.currentSheetInfo.sheetId,e),n=this.eventData.customHeight[r];return n?n.isHide?bt:n.len:Ge}getColWidth(e){let r=Tt(this.eventData.currentSheetInfo.sheetId,e),n=this.eventData.customWidth[r];return n?n.isHide?bt:n.len:Ve}isHighlightRow(e,r){return!!(ye(e)||ve(e)||r>=e.row&&r<e.row+e.rowCount)}isHighlightCol(e,r){return!!(ye(e)||Te(e)||r>=e.col&&r<e.col+e.colCount)}renderAntLine(e){let r=this.eventData.copyRange;!r||r.sheetId!==this.eventData.currentSheetInfo.sheetId||(this.ctx.lineWidth=Jr,this.ctx.strokeStyle=X("primaryColor",this.eventData.theme),Xr(this.ctx,e.left,e.top,e.width,e.height))}renderMergeCell(){let e=this.eventData.currentMergeCells;if(e.length===0)return;let r=this.eventData.range;for(let n of e)r.row===n.row&&r.col===n.col||this.clearRect(n)}getCellSize(e){let{row:r,col:n,colCount:o,rowCount:i}=e,h=r,m=n,x=r+i,d=n+o,g=this.eventData.currentSheetInfo;ye(e)?(m=0,d=g.colCount,h=0,x=g.rowCount):ve(e)?(h=0,x=g.rowCount):Te(e)&&(m=0,d=g.colCount);let R=0,v=0;for(;h<x;h++)v+=this.getRowHeight(h);for(;m<d;m++)R+=this.getColWidth(m);return{width:R,height:v}}computeCellPosition(e){let{row:r,col:n}=e,o=this.eventData.headerSize,i=this.eventData.scroll,h=o.width,m=o.height,x=i.row,d=i.col;if(n>=i.col)for(;d<n;)h+=this.getColWidth(d),d++;else for(h=-o.width;d>n;)h-=this.getColWidth(d),d--;if(r>=i.row)for(;x<r;)m+=this.getRowHeight(x),x++;else for(m=-o.height;x>r;)m-=this.getRowHeight(x),x--;return{top:m,left:h}}getActiveRange(e){let r=e||this.eventData.range,n=this.eventData.currentMergeCells;for(let o of n)if(yr(r,o))return{range:{...o,sheetId:o.sheetId},isMerged:!0};return{range:r,isMerged:!1}}clearRect(e){let r=this.getCellSize(e);if(r.width<=0||r.height<=0)return;let n=this.computeCellPosition(e),o=O;Wt(this.ctx,n.left+o,n.top+o,r.width-o*2,r.height-o*2)}renderContent(e){let{endCol:r,endRow:n,contentHeight:o,contentWidth:i}=e,{ctx:h}=this;h.textAlign="left",h.textBaseline="top",h.lineWidth=O*2;let m=this.eventData.headerSize,{row:x,col:d}=this.eventData.scroll,g=Math.floor(i-m.width),R=Math.floor(o-m.height);h.save(),this.rowMap={},this.colMap={};let v=this.eventData.currentMergeCells;for(let A=x;A<n;A++)for(let k=d;k<r;k++){let D=v.find(y=>y.row===A&&y.col===k);this.renderCell(A,k,D,g,R)}h.restore()}renderCell(e,r,n,o,i){let{ctx:h}=this,m={row:e,col:r,rowCount:1,colCount:1,sheetId:""},x=Ke(e,r),d=this.eventData.sheetData[x];if(!d)return;let g=this.getCellSize(n||m);if(g.width<=0||g.height<=0)return;let R=this.computeCellPosition(m);h.lineWidth=O*2;let v=this.eventData.theme,A=jr(h,{top:R.top,left:R.left,width:Math.min(g.width,o),height:Math.min(g.height,i)},d.value,d.style,!!n,v),k=Math.max(this.rowMap[e]??0,A.height),D=Math.max(this.colMap[r]??0,A.width);k>=Ge&&(this.rowMap[e]=k),D>=Ve&&(this.colMap[r]=D);let y={top:R.top,left:R.left,height:Math.max(k,g.height),width:Math.max(D,g.width)};Fe(h,y,d.style?.borderTop,"top",v),Fe(h,y,d.style?.borderBottom,"bottom",v),Fe(h,y,d.style?.borderLeft,"left",v),Fe(h,y,d.style?.borderRight,"right",v)}renderSelection(e){let r=this.eventData.range;return ye(r)?this.renderSelectAll(e):ve(r)?this.renderSelectCol(e):Te(r)?this.renderSelectRow(e):this.renderSelectRange()}renderSelectRange(){let e=this.eventData.headerSize,r=this.eventData.range,n=this.computeCellPosition({row:r.row,col:r.col,rowCount:1,colCount:1,sheetId:""}),o=r.row+r.rowCount-1,i=r.col+r.colCount-1,h={row:o,col:i,rowCount:1,colCount:1,sheetId:""},m=this.computeCellPosition(h),x=this.getCellSize(h),d=m.left+x.width-n.left,g=m.top+x.height-n.top;te(this.ctx,n.left,0,d,e.height),te(this.ctx,0,n.top,e.width,g);let R=r.rowCount>1||r.colCount>1;R&&te(this.ctx,n.left,n.top,d,g);let v=[[n.left,e.height],[n.left+d,e.height]];return v.push([e.width,n.top],[e.width,n.top+g]),he(this.ctx,v),R&&this.renderActiveCell(),{left:n.left,top:n.top,width:d,height:g}}renderSelectAll(e){let{contentHeight:r,contentWidth:n}=e,o=this.eventData.headerSize;te(this.ctx,0,0,n,r),this.renderActiveCell();let i=n-o.width,h=r-o.height;return{left:o.width,top:o.height,width:i,height:h}}renderSelectCol({contentHeight:e}){let r=this.eventData.headerSize,n=this.eventData.range,o=this.computeCellPosition(n),i=0;for(let x=n.col,d=n.col+n.colCount;x<d;x++)i+=this.getColWidth(x);let h=e-r.height;te(this.ctx,o.left,0,i,e),te(this.ctx,0,o.top,r.width,h);let m=[[r.width,r.height],[r.width,e]];return he(this.ctx,m),this.renderActiveCell(),{left:o.left,top:r.height,width:i,height:h}}renderSelectRow({contentWidth:e}){let r=this.eventData.headerSize,n=this.eventData.range,o=this.computeCellPosition(n),i=0;for(let x=n.row,d=n.row+n.rowCount;x<d;x++)i+=this.getRowHeight(x);let h=e-r.width-O;te(this.ctx,o.left,0,h,r.height),te(this.ctx,0,o.top,e,i);let m=[[o.left,r.height],[e,r.height]];return he(this.ctx,m),this.renderActiveCell(),{left:r.width,top:o.top,width:h,height:i}}renderActiveCell(){let e=this.eventData.range,r=this.getActiveRange({row:e.row,col:e.col,rowCount:1,colCount:1,sheetId:e.sheetId}).range;this.clearRect(r)}};var zt=null,ao={init(t){zt=new gt(t.canvas),Fr(t.dpr)},resize(t){zt?.resize(t)},async render(t,e){let r=zt?.render(t);r&&await e(r)},async computeFormulas(t,e){let n={list:kt(t)};await e(n)}},ka=ao;export{ge as a,lr as b,Ge as c,Ve as d,uo as e,ho as f,bt as g,po as h,Oe as i,fo as j,go as k,wt as l,Rt as m,mo as n,xo as o,Co as p,Eo as q,bo as r,Xe as s,wo as t,Le as u,Ro as v,yo as w,Ne as x,To as y,Je as z,vo as A,Is as B,Ss as C,Pr as D,qn as E,Ms as F,ie as G,Mo as H,Ao as I,Ke as J,ur as K,Tt as L,ko as M,Do as N,Oo as O,_o as P,hr as Q,Lo as R,pr as S,dr as T,No as U,Fs as V,Ps as W,$s as X,Us as Y,Hs as Z,Se as _,ye as $,Te as aa,ve as ba,mi as ca,yr as da,Tr as ea,Ar as fa,It as ga,wi as ha,_t as ia,Nr as ja,pt as ka,ys as la,Zn as ma,X as na,or as oa,sn as pa,un as qa,hn as ra,$ as sa,qe as ta,At as ua,Br as va,zr as wa,Gs as xa,ka as ya};
/*! Bundled license information:

comlink/dist/esm/comlink.mjs:
  (**
   * @license
   * Copyright 2019 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   *)
*/
//# sourceMappingURL=chunk-MCLWZ5T7.js.map
