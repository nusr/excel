import{r as a,e as ge,g as be,f as K,j as t,B as i,$ as n,h as $,k as q,l as ue,m as f,C as Y,n as me,o as he,I as x,q as M,E as j,s as R,t as N,u as W,v as Ce,w as pe,S as Q,x as H,G as fe}from"./index-C8wO7Npz.js";import{f as O,Q as V,i as xe,L as ye}from"./isSupportFontFamily-99rcqzmO.js";import{c as X,s as J}from"./style-BzKcKm9k.js";const ve="_border_196ac_17",Ie="_fontFamily_196ac_35",ke="_bold_196ac_38",Se="_italic_196ac_41",je="_strike_196ac_44",s={"toolbar-wrapper":"_toolbar-wrapper_196ac_1","merge-cell":"_merge-cell_196ac_13",border:ve,"merge-cell-button":"_merge-cell-button_196ac_21","number-format":"_number-format_196ac_26","number-format-value":"_number-format-value_196ac_30",fontFamily:Ie,bold:ke,italic:Se,strike:je,"wrap-text":"_wrap-text_196ac_48","icon-center":"_icon-center_196ac_52"},Z=a.memo(({controller:e})=>{const c=a.useRef(null),l=a.useCallback(async T=>{var A;const S=(A=T.target.files)==null?void 0:A[0];if(!S)return;let h=S.name;const b=S.type.slice(6);h=h.slice(0,-(b.length+1));const g=await ge(S,!0);if(c.current&&(c.current.value="",c.current.blur()),!g)return;const u=await be(g),C=e.getActiveRange().range;await e.addDrawing({width:u.width,height:u.height,originHeight:u.height,originWidth:u.width,title:h,type:"floating-picture",uuid:K(),imageSrc:g,sheetId:C.sheetId,fromRow:C.row,fromCol:C.col,marginX:0,marginY:0})},[]);return t.jsxs(i,{testId:"toolbar-floating-picture",title:"Floating Picture",children:[t.jsx("input",{type:"file",hidden:!0,onChange:l,accept:"image/*",ref:c,id:"upload_float_image","data-testid":"toolbar-floating-picture-input"}),t.jsx("label",{htmlFor:"upload_float_image",children:n("floating-picture")})]})});Z.displayName="InsertFloatingPicture";const ee=a.memo(({controller:e})=>{const c=a.useCallback(async()=>{const l=e.getActiveRange().range;await e.addDrawing({width:400,height:300,originHeight:300,originWidth:400,title:n("chart-title"),type:"chart",uuid:K(),sheetId:l.sheetId,fromRow:l.row,fromCol:l.col,chartRange:l,chartType:"line",marginX:0,marginY:0})},[]);return t.jsx(i,{testId:"toolbar-chart",onClick:c,title:"Chart",children:n("chart")})});ee.displayName="InsertChart";const _e="_container_11gw9_1",Te="_trigger_11gw9_9",Ae="_main_11gw9_14",Re="_menu_11gw9_19",Ne="_portal_11gw9_24",U={container:_e,trigger:Te,main:Ae,menu:Re,portal:Ne},te=a.memo(({controller:e})=>{const[c,l]=a.useState(""),[T,S]=a.useState("thin"),[h,b]=a.useState("all-borders"),g=a.useRef({color:c,borderType:T,type:h}),u=()=>({color:g.current.color,type:g.current.borderType}),C=()=>{b("all-borders");const o=u();e.updateCellStyle({borderLeft:o,borderRight:o,borderTop:o,borderBottom:o},e.getActiveRange().range)},A=o=>{g.current.color=o,l(o),C()},G=o=>{g.current.borderType=o,S(o),C()},z=()=>{b("no-border"),e.updateCellStyle({borderLeft:void 0,borderRight:void 0,borderTop:void 0,borderBottom:void 0},e.getActiveRange().range)},w=()=>{b("bottom-border");const o=e.getActiveRange().range,y=u(),{row:v,col:I,colCount:k,rowCount:_}=o;e.updateCellStyle({borderBottom:y},{row:v+_-1,rowCount:1,colCount:k,col:$(o)?0:I,sheetId:""})},F=()=>{b("top-border");const o=e.getActiveRange().range,y=u(),{row:v,col:I,colCount:k}=o,_={row:v,rowCount:1,colCount:k,col:$(o)?0:I,sheetId:""};e.updateCellStyle({borderTop:y},_)},E=()=>{b("left-border");const o=e.getActiveRange().range,y=u(),{row:v,col:I,rowCount:k}=o;e.updateCellStyle({borderLeft:y},{row:q(o)?0:v,rowCount:k,colCount:1,col:I,sheetId:""})},B=()=>{b("right-border");const o=e.getActiveRange().range,y=u(),{row:v,col:I,rowCount:k,colCount:_}=o;e.updateCellStyle({borderRight:y},{row:q(o)?0:v,rowCount:k,colCount:1,col:I+_-1,sheetId:""})},L=()=>{F(),B(),w(),E(),b("outside-borders")},D=()=>{const o=g.current.borderType;g.current.borderType="medium",L(),g.current.borderType=o,b("thick-box-border")},P=()=>{({"all-borders":C,"no-border":z,"bottom-border":w,"top-border":F,"left-border":E,"right-border":B,"thick-box-border":D,"outside-borders":L})[h]()};return t.jsxs("div",{className:U.container,children:[t.jsx(i,{onClick:P,type:"plain",className:U.main,testId:"toolbar-border-shortcut",title:n(h),children:n(h)}),t.jsxs(ue,{className:U.menu,label:t.jsx(x,{name:"down"}),isPlain:!0,testId:"toolbar-border",position:"bottom",size:"small",portalClassName:U.portal,children:[t.jsx(f,{onClick:z,testId:"toolbar-no-border",children:n("no-border")}),t.jsx(f,{onClick:C,testId:"toolbar-all-borders",children:n("all-borders")}),t.jsx(f,{onClick:L,testId:"toolbar-outside-borders",children:n("outside-borders")}),t.jsx(f,{onClick:D,testId:"toolbar-thick-box-border",children:n("thick-box-border")}),t.jsx(f,{onClick:w,testId:"toolbar-bottom-border",children:n("bottom-border")}),t.jsx(f,{onClick:F,testId:"toolbar-top-border",children:n("top-border")}),t.jsx(f,{onClick:E,testId:"toolbar-left-border",children:n("left-border")}),t.jsx(f,{onClick:B,testId:"toolbar-right-border",children:n("right-border")}),t.jsx(f,{children:t.jsx(Y,{color:c,onChange:A,position:"right",testId:"toolbar-border-color",children:t.jsxs("span",{style:{color:c},children:[n("line-color")," >"]})})}),t.jsx(me,{label:`${n("line-style")} >`,testId:"toolbar-border-style",children:Object.keys(he).map(o=>t.jsx(f,{onClick:()=>G(o),testId:`toolbar-border-style-${o}`,active:T===o,children:o},o))})]})]})});te.displayName="BorderToolBar";const we=[{value:j.NONE,label:n("none"),disabled:!1},{value:j.SINGLE,label:n("single-underline"),disabled:!1},{value:j.DOUBLE,label:n("double-underline"),disabled:!1}],Fe=[{value:H.MERGE_CENTER,label:n("merge-and-center"),disabled:!1},{value:H.MERGE_CELL,label:n("merge-cells"),disabled:!1},{value:H.MERGE_CONTENT,label:n("merge-content"),disabled:!1}],Ee=a.memo(({controller:e})=>{const c=a.useSyncExternalStore(X.subscribe,X.getSnapshot),l=a.useSyncExternalStore(J.subscribe,J.getSnapshot),T=a.useSyncExternalStore(O.subscribe,O.getSnapshot),S=a.useMemo(()=>({color:l.fillColor}),[l.fillColor]),h=a.useMemo(()=>({color:l.fontColor}),[l.fontColor]),[b,g]=a.useMemo(()=>{let r=M[0];if(l.numberFormat){const m=M.find(d=>d.value===l.numberFormat);m?r=m:r=M[M.length-1]}return[r.label,String(r.value)]},[l.numberFormat]),u=a.useCallback(r=>({fontFamily:String(r)}),[]),C=a.useCallback(r=>{String(r)===V&&typeof window.queryLocalFonts=="function"?window.queryLocalFonts().then(m=>{let d=m.map(p=>p.fullName);d=Array.from(new Set(d)).filter(p=>xe(p)),d.sort((p,de)=>p.localeCompare(de));const ce=d.map(p=>({label:p,value:p,disabled:!1}));d.length>0?(O.setState(ce),localStorage.setItem(ye,JSON.stringify(d))):O.setState(O.getSnapshot().filter(p=>p.value!==V))}):e.updateCellStyle({fontFamily:String(r)},e.getActiveRange().range)},[]),A=a.useCallback(()=>{e.undo()},[]),G=a.useCallback(()=>{e.redo()},[]),z=a.useCallback(()=>{e.copy()},[]),w=a.useCallback(()=>{e.cut()},[]),F=a.useCallback(()=>{e.paste()},[]),E=a.useCallback(r=>{e.updateCellStyle({fontSize:Number(r)},e.getActiveRange().range)},[]),B=a.useCallback(()=>{e.updateCellStyle({isBold:!l.isBold},e.getActiveRange().range)},[l.isBold]),L=a.useCallback(()=>{e.updateCellStyle({isItalic:!l.isItalic},e.getActiveRange().range)},[l.isItalic]),D=a.useCallback(()=>{e.updateCellStyle({isStrike:!l.isStrike},e.getActiveRange().range)},[l.isStrike]),P=a.useCallback(r=>{const m=Number(r);let d=j.NONE;m===j.SINGLE?d=j.SINGLE:m===j.DOUBLE&&(d=j.DOUBLE),e.updateCellStyle({underline:d},e.getActiveRange().range)},[]),o=a.useCallback(r=>{e.updateCellStyle({fillColor:r},e.getActiveRange().range)},[]),y=a.useCallback(r=>{e.updateCellStyle({fontColor:r},e.getActiveRange().range)},[]),v=a.useCallback(()=>{e.updateCellStyle({isWrapText:!l.isWrapText},e.getActiveRange().range)},[l.isWrapText]),I=a.useCallback(()=>{const{range:r,isMerged:m}=e.getActiveRange();m?e.deleteMergeCell(r):e.addMergeCell(r)},[]),k=a.useCallback(r=>{if(!r)return;const{range:m,isMerged:d}=e.getActiveRange();d?e.deleteMergeCell(m):e.addMergeCell(m,Number(r))},[]),_=a.useCallback(r=>{r&&e.updateCellStyle({numberFormat:r},e.getActiveRange().range)},[]),ae=a.useCallback(()=>{e.updateCellStyle({horizontalAlign:R.LEFT},e.getActiveRange().range)},[]),le=a.useCallback(()=>{e.updateCellStyle({horizontalAlign:R.CENTER},e.getActiveRange().range)},[]),oe=a.useCallback(()=>{e.updateCellStyle({horizontalAlign:R.RIGHT},e.getActiveRange().range)},[]),re=a.useCallback(()=>{e.updateCellStyle({verticalAlign:N.TOP},e.getActiveRange().range)},[]),ne=a.useCallback(()=>{e.updateCellStyle({verticalAlign:N.MIDDLE},e.getActiveRange().range)},[]),ie=a.useCallback(()=>{e.updateCellStyle({verticalAlign:N.BOTTOM},e.getActiveRange().range)},[]),se=a.useCallback(()=>{e.getFilter()?e.deleteFilter():e.addFilter(e.getActiveRange().range)},[]);return t.jsxs("div",{className:s["toolbar-wrapper"],"data-testid":"toolbar",children:[t.jsx(i,{disabled:!c.canUndo,onClick:A,testId:"toolbar-undo",title:"Undo",className:s["icon-center"],children:t.jsx(x,{name:"undo"})}),t.jsx(i,{disabled:!c.canRedo,onClick:G,testId:"toolbar-redo",title:"Redo",className:s["icon-center"],children:t.jsx(x,{name:"redo"})}),t.jsx(i,{onClick:z,testId:"toolbar-copy",title:"Copy",children:n("copy")}),t.jsx(i,{onClick:w,testId:"toolbar-cut",title:"Cut",children:n("cut")}),t.jsx(i,{onClick:F,testId:"toolbar-paste",title:"Paste",children:n("paste")}),t.jsx(W,{data:T,value:l.fontFamily,getItemStyle:u,onChange:C,testId:"toolbar-font-family",className:s.fontFamily}),t.jsx(W,{data:Ce,value:l.fontSize,onChange:E,testId:"toolbar-font-size"}),t.jsx(i,{active:l.isBold,onClick:B,testId:"toolbar-bold",title:"Bold",children:t.jsx("span",{className:s.bold,children:"B"})}),t.jsx(i,{active:l.isItalic,onClick:L,testId:"toolbar-italic",title:"Italic",children:t.jsx("span",{className:s.italic,children:"I"})}),t.jsx(i,{active:l.isStrike,onClick:D,testId:"toolbar-strike",title:"Strike",children:t.jsx("span",{className:s.strike,children:"A"})}),t.jsx(W,{data:we,value:l.underline,title:"Underline",onChange:P,testId:"toolbar-underline"}),t.jsx(te,{controller:e}),t.jsx(Y,{color:l.fillColor,onChange:o,testId:"toolbar-fill-color",children:t.jsx(i,{style:S,testId:"toolbar-fill-color",className:s["icon-center"],title:"Fill Color",children:t.jsx(pe,{})})},"fill-color"),t.jsx(Y,{color:l.fontColor,onChange:y,testId:"toolbar-font-color",children:t.jsx(i,{style:h,testId:"toolbar-font-color",className:s["icon-center"],title:"Font Color",children:t.jsx(x,{name:"fontColor"})})},"font-color"),t.jsx(i,{active:l.verticalAlign===N.TOP,onClick:re,testId:"toolbar-vertical-top",className:s["icon-center"],title:"Top Align",children:t.jsx(x,{name:"verticalTop"})}),t.jsx(i,{active:l.verticalAlign===N.MIDDLE,onClick:ne,testId:"toolbar-vertical-middle",className:s["icon-center"],title:"Middle Align",children:t.jsx(x,{name:"verticalMiddle"})}),t.jsx(i,{active:l.verticalAlign===N.BOTTOM,onClick:ie,testId:"toolbar-vertical-bottom",className:s["icon-center"],title:"Bottom Align",children:t.jsx(x,{name:"verticalBottom"})}),t.jsx(i,{active:l.horizontalAlign===R.LEFT,onClick:ae,testId:"toolbar-horizontal-left",className:s["icon-center"],title:"Align Text Left",children:t.jsx(x,{name:"horizontalLeft"})}),t.jsx(i,{active:l.horizontalAlign===R.CENTER,onClick:le,testId:"toolbar-horizontal-center",className:s["icon-center"],title:"Align Text Center",children:t.jsx(x,{name:"horizontalCenter"})}),t.jsx(i,{active:l.horizontalAlign===R.RIGHT,onClick:oe,testId:"toolbar-horizontal-right",className:s["icon-center"],title:"Align Text Right",children:t.jsx(x,{name:"horizontalRight"})}),t.jsx(i,{active:l.isWrapText,onClick:v,testId:"toolbar-wrap-text",className:s["wrap-text"],title:"Wrap Text",children:n("wrap-text")}),t.jsx(Q,{data:Fe,value:l.mergeType,onChange:k,className:s["merge-cell"],testId:"toolbar-merge-cell-select",children:t.jsx(i,{active:l.isMergeCell,onClick:I,testId:"toolbar-merge-cell",className:s["merge-cell-button"],type:"plain",title:"Merge And Center",children:n("merge-and-center")})}),t.jsx(Q,{data:M,value:g,onChange:_,className:s["number-format"],testId:"toolbar-number-format",children:t.jsx("div",{className:s["number-format-value"],"data-testid":"toolbar-number-format-value",children:b})}),t.jsx(i,{active:c.isFilter,onClick:se,testId:"toolbar-filter",className:s["wrap-text"],title:"Filter",children:n("filter")}),t.jsx(Z,{controller:e}),t.jsx(ee,{controller:e}),t.jsx(fe,{})]})});Ee.displayName="ToolbarContainer";export{Ee as ToolbarContainer,Ee as default};
//# sourceMappingURL=index-Btv2UAc0.js.map
