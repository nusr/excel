var Wn=Object.defineProperty;var zn=(ft,ut,St)=>ut in ft?Wn(ft,ut,{enumerable:!0,configurable:!0,writable:!0,value:St}):ft[ut]=St;var x=(ft,ut,St)=>zn(ft,typeof ut!="symbol"?ut+"":ut,St);(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ft=Symbol("Comlink.proxy"),ut=Symbol("Comlink.endpoint"),St=Symbol("Comlink.releaseProxy"),Jt=Symbol("Comlink.finalizer"),Pt=Symbol("Comlink.thrown"),Ee=e=>typeof e=="object"&&e!==null||typeof e=="function",Er={canHandle:e=>Ee(e)&&e[ft],serialize(e){const{port1:t,port2:r}=new MessageChannel;return qt(e,t),[r,[r]]},deserialize(e){return e.start(),pr(e)}},gr={canHandle:e=>Ee(e)&&Pt in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},ge=new Map([["proxy",Er],["throw",gr]]);function Cr(e,t){for(const r of e)if(t===r||r==="*"||r instanceof RegExp&&r.test(t))return!0;return!1}function qt(e,t=globalThis,r=["*"]){t.addEventListener("message",function n(s){if(!s||!s.data)return;if(!Cr(r,s.origin)){console.warn(`Invalid origin '${s.origin}' for comlink proxy`);return}const{id:o,type:d,path:C}=Object.assign({path:[]},s.data),p=(s.data.argumentList||[]).map(wt);let f;try{const g=C.slice(0,-1).reduce((O,I)=>O[I],e),M=C.reduce((O,I)=>O[I],e);switch(d){case"GET":f=M;break;case"SET":g[C.slice(-1)[0]]=wt(s.data.value),f=!0;break;case"APPLY":f=M.apply(g,p);break;case"CONSTRUCT":{const O=new M(...p);f=Mr(O)}break;case"ENDPOINT":{const{port1:O,port2:I}=new MessageChannel;qt(e,I),f=Sr(O,[O])}break;case"RELEASE":f=void 0;break;default:return}}catch(g){f={value:g,[Pt]:0}}Promise.resolve(f).catch(g=>({value:g,[Pt]:0})).then(g=>{const[M,O]=yt(g);t.postMessage(Object.assign(Object.assign({},M),{id:o}),O),d==="RELEASE"&&(t.removeEventListener("message",n),Ce(t),Jt in e&&typeof e[Jt]=="function"&&e[Jt]())}).catch(g=>{const[M,O]=yt({value:new TypeError("Unserializable return value"),[Pt]:0});t.postMessage(Object.assign(Object.assign({},M),{id:o}),O)})}),t.start&&t.start()}function Ar(e){return e.constructor.name==="MessagePort"}function Ce(e){Ar(e)&&e.close()}function pr(e,t){const r=new Map;return e.addEventListener("message",function(s){const{data:o}=s;if(!o||!o.id)return;const d=r.get(o.id);if(d)try{d(o)}finally{r.delete(o.id)}}),te(e,r,[],t)}function $t(e){if(e)throw new Error("Proxy has been released and is not useable")}function Ae(e){return Mt(e,new Map,{type:"RELEASE"}).then(()=>{Ce(e)})}const Bt=new WeakMap,Ht="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(Bt.get(e)||0)-1;Bt.set(e,t),t===0&&Ae(e)});function wr(e,t){const r=(Bt.get(t)||0)+1;Bt.set(t,r),Ht&&Ht.register(e,t,e)}function mr(e){Ht&&Ht.unregister(e)}function te(e,t,r=[],n=function(){}){let s=!1;const o=new Proxy(n,{get(d,C){if($t(s),C===St)return()=>{mr(o),Ae(e),t.clear(),s=!0};if(C==="then"){if(r.length===0)return{then:()=>o};const p=Mt(e,t,{type:"GET",path:r.map(f=>f.toString())}).then(wt);return p.then.bind(p)}return te(e,t,[...r,C])},set(d,C,p){$t(s);const[f,g]=yt(p);return Mt(e,t,{type:"SET",path:[...r,C].map(M=>M.toString()),value:f},g).then(wt)},apply(d,C,p){$t(s);const f=r[r.length-1];if(f===ut)return Mt(e,t,{type:"ENDPOINT"}).then(wt);if(f==="bind")return te(e,t,r.slice(0,-1));const[g,M]=pe(p);return Mt(e,t,{type:"APPLY",path:r.map(O=>O.toString()),argumentList:g},M).then(wt)},construct(d,C){$t(s);const[p,f]=pe(C);return Mt(e,t,{type:"CONSTRUCT",path:r.map(g=>g.toString()),argumentList:p},f).then(wt)}});return wr(o,e),o}function Rr(e){return Array.prototype.concat.apply([],e)}function pe(e){const t=e.map(yt);return[t.map(r=>r[0]),Rr(t.map(r=>r[1]))]}const we=new WeakMap;function Sr(e,t){return we.set(e,t),e}function Mr(e){return Object.assign(e,{[ft]:!0})}function yt(e){for(const[t,r]of ge)if(r.canHandle(e)){const[n,s]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},s]}return[{type:"RAW",value:e},we.get(e)||[]]}function wt(e){switch(e.type){case"HANDLER":return ge.get(e.name).deserialize(e.value);case"RAW":return e.value}}function Mt(e,t,r,n){return new Promise(s=>{const o=Nr();t.set(o,s),e.start&&e.start(),e.postMessage(Object.assign({id:o},r),n)})}function Nr(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var Gt=(e=>(e[e.TOP=0]="TOP",e[e.MIDDLE=1]="MIDDLE",e[e.BOTTOM=2]="BOTTOM",e))(Gt||{}),Vt=(e=>(e[e.LEFT=0]="LEFT",e[e.CENTER=1]="CENTER",e[e.RIGHT=2]="RIGHT",e))(Vt||{}),me=(e=>(e[e.NONE=0]="NONE",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE",e))(me||{}),A=(e=>(e[e.EQUAL=0]="EQUAL",e[e.NOT_EQUAL=1]="NOT_EQUAL",e[e.PLUS=2]="PLUS",e[e.MINUS=3]="MINUS",e[e.STAR=4]="STAR",e[e.SLASH=5]="SLASH",e[e.EXPONENT=6]="EXPONENT",e[e.GREATER=7]="GREATER",e[e.GREATER_EQUAL=8]="GREATER_EQUAL",e[e.CONCATENATE=9]="CONCATENATE",e[e.COLON=10]="COLON",e[e.COMMA=11]="COMMA",e[e.EMPTY_CHAR=12]="EMPTY_CHAR",e[e.PERCENT=13]="PERCENT",e[e.LESS=14]="LESS",e[e.LESS_EQUAL=15]="LESS_EQUAL",e[e.STRING=16]="STRING",e[e.NUMBER=17]="NUMBER",e[e.BOOL=18]="BOOL",e[e.ERROR=19]="ERROR",e[e.ERROR_REF=20]="ERROR_REF",e[e.LEFT_BRACKET=21]="LEFT_BRACKET",e[e.RIGHT_BRACKET=22]="RIGHT_BRACKET",e[e.lEFT_BRACE=23]="lEFT_BRACE",e[e.RIGHT_BRACE=24]="RIGHT_BRACE",e[e.SEMICOLON=25]="SEMICOLON",e[e.EXCLAMATION=26]="EXCLAMATION",e[e.R1C1=27]="R1C1",e[e.SHEET_NAME=28]="SHEET_NAME",e[e.CELL=29]="CELL",e[e.COLUMN=30]="COLUMN",e[e.ROW=31]="ROW",e[e.DEFINED_NAME=32]="DEFINED_NAME",e[e.EXCEL_FUNCTION=33]="EXCEL_FUNCTION",e[e.REF_FUNCTION=34]="REF_FUNCTION",e[e.REF_FUNCTION_COND=35]="REF_FUNCTION_COND",e[e.EOF=36]="EOF",e))(A||{});class ot{constructor(t,r){x(this,"type");x(this,"value");this.type=t,this.value=r}toString(){return this.value}}const Xt=12,Or="sans-serif",Re=22,Se=76,Me=0,ee="&#10;",Ne=16384,Oe=1048576,Ir=16,Ie="=",It="_",re=256,Te=9,Wt="General",Tr="@",be=new Set(["#GETTING_DATA","#DIV/0!","#NULL!","#NUM!","#REF!","#VALUE!","#N/A","#NAME?"]),F=1,De={thin:F,hair:F,dotted:F,dashed:F,dashDot:F,dashDotDot:F,double:F,medium:F*2,mediumDashed:F*2,mediumDashDot:F*2,mediumDashDotDot:F*2,thick:F*4},Le=["#35322B","#505050","#606060","#6F6F6F","#8B8B8B","#B2B2B2","#CCCCCC","#E5E5E5","#F5F5F5","#FFFFFF","#9D0000","#B20000","#CD0F0F","#E30909","#F30B0B","#FE4B4B","#FA7979","#FB9D9D","#FDCECE","#FEE7E7","#B24000","#CC4F10","#DF5D00","#F96800","#FB8937","#FF8C51","#FCA669","#FDC49B","#FEE1CD","#FEF0E6","#B19401","#C5A300","#D8B300","#EBC301","#F9D700","#FBE137","#FCE869","#FDF09B","#FEF7CD","#FEFBE6","#58770A","#688C0D","#7AA017","#8BBB11","#A4DC16","#BEEE44","#CEF273","#DEF6A2","#EFFBD0","#F7FDE8","#007676","#008A8A","#009E9E","#00BBBB","#1CD8D8","#2AEAEA","#76EFEF","#A3F5F5","#D1FAFA","#E8FCFC","#001F9C","#0025B7","#012BD2","#133DE3","#2F55EB","#4567ED","#738DF2","#A2B3F6","#D0D9FB","#E8ECFD","#3F0198","#510EB0","#6721CB","#7735D4","#894EDE","#9E6DE3","#AA82E3","#C7ABED","#E3D5F6","#F1EAFA","#8F0550","#A1095C","#C1026B","#D4157E","#E7258F","#F248A6","#F273B9","#F6A2D0","#FBD0E8","#FDE8F3"],br=/^[$]?[A-Za-z]{1,3}[$]?[1-9][0-9]*$/,Dr=/^[$]?[A-Za-z]{1,3}$/,Lr=/^\$[1-9][0-9]*$/,xr=/^[a-zA-Z_][a-zA-Z0-9_.?]*$/,_r=new Set(["ABS","ACCRINT","ACCRINTM","ACOS","ACOSH","ACOT","ACOTH","ADDRESS","AGGREGATE","AMORDEGRC","AMORLINC","AND","ARABIC","AREAS","ARRAYTOTEXT","ASC","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BAHTTEXT","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CALL","CEILING","CEILING.MATH","CEILING.PRECISE","CELL","CHAR","CHIDIST","CHIINV","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHISQ.TEST","CHITEST","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCAT","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUPDAYBS","COUPDAYS","COUPDAYSNC","COUPNCD","COUPNUM","COUPPCD","COVAR","COVARIANCE.P","COVARIANCE.S","CRITBINOM","CSC","CSCH","CUBEKPIMEMBER","CUBEMEMBER","CUBEMEMBERPROPERTY","CUBERANKEDMEMBER","CUBESET","CUBESETCOUNT","CUBEVALUE","CUMIPMT","CUMPRINC","DATE","DATEDIF","DATEVALUE","DAVERAGE","DAY","DAYS","DAYS360","DB","DBCS","DCOUNT","DCOUNTA","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DGET","DISC","DMAX","DMIN","DOLLAR","DOLLARDE","DOLLARFR","DPRODUCT","DSTDEV","DSTDEVP","DSUM","DURATION","DVAR","DVARP","EDATE","EFFECT","ENCODEURL","EOMONTH","ERF","ERF.PRECISE","ERFC","ERFC.PRECISE","ERROR.TYPE","EUROCONVERT","EVEN","EXACT","EXP","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","F.TEST","FACT","FACTDOUBLE","FALSE","FDIST","FILTER","FILTERXML","FIND","FINDB","FINV","FISHER","FISHERINV","FIXED","FLOOR","FLOOR.MATH","FLOOR.PRECISE","FORECAST","FORECAST.ETS","FORECAST.ETS.CONFINT","FORECAST.ETS.SEASONALITY","FORECAST.ETS.STAT","FORECAST.LINEAR","FORMULATEXT","FREQUENCY","FTEST","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GETPIVOTDATA","GROWTH","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HLOOKUP","HOUR","HYPERLINK","HYPGEOM.DIST","HYPGEOMDIST","IFERROR","IFNA","IFS","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INFO","INT","INTERCEPT","INTRATE","IPMT","IRR","ISBLANK","ISERR","ISERROR","ISEVEN","ISFORMULA","ISLOGICAL","ISNA","ISNONTEXT","ISNUMBER","ISO.CEILING","ISODD","ISOWEEKNUM","ISPMT","ISREF","ISTEXT","JIS","KURT","LARGE","LCM","LEFT","LEFTB","LEN","LENB","LET","LINEST","LN","LOG","LOG10","LOGEST","LOGINV","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOOKUP","LOWER","MATCH","MAX","MAXA","MAXIFS","MDETERM","MDURATION","MEDIAN","MID","MIDB","MIN","MINA","MINIFS","MINUTE","MINVERSE","MIRR","MMULT","MOD","MODE","MODE.MULT","MODE.SNGL","MONTH","MROUND","MULTINOMIAL","MUNIT","N","NA","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NETWORKDAYS.INTL","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERVALUE","OCT2BIN","OCT2DEC","OCT2HEX","ODD","ODDFPRICE","ODDFYIELD","ODDLPRICE","ODDLYIELD","OR","PDURATION","PEARSON","PERCENTILE","PERCENTILE.EXC","PERCENTILE.INC","PERCENTRANK","PERCENTRANK.EXC","PERCENTRANK.INC","PERMUT","PERMUTATIONA","PHI","PHONETIC","PI","PMT","POISSON","POISSON.DIST","POWER","PPMT","PRICE","PRICEDISC","PRICEMAT","PROB","PRODUCT","PROPER","PV","QUARTILE","QUARTILE.EXC","QUARTILE.INC","QUOTIENT","RADIANS","RAND","RANDARRAY","RANDBETWEEN","RANK","RANK.AVG","RANK.EQ","RATE","RECEIVED","REGISTER.ID","REPLACE","REPLACEB","REPT","RIGHT","RIGHTB","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","RTD","SEARCH","SEARCHB","SEC","SECH","SECOND","SEQUENCE","SERIESSUM","SHEET","SHEETS","SIGN","SIN","SINH","SKEW","SKEW.P","SLN","SLOPE","SMALL","SORT","SORTBY","SQRT","SQRTPI","STANDARDIZE","STDEV","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","T.TEST","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TEXT","TEXTJOIN","TIME","TIMEVALUE","TINV","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","TTEST","TYPE","UNICHAR","UNICODE","UNIQUE","UPPER","VALUE","VALUETOTEXT","VAR","VAR.P","VAR.S","VARA","VARP","VARPA","VDB","VLOOKUP","WEBSERVICE","WEEKDAY","WEEKNUM","WEIBULL","WEIBULL.DIST","WORKDAY","WORKDAY.INTL","XIRR","XLOOKUP","XMATCH","XNPV","XOR","YEAR","YEARFRAC","YIELD","YIELDDISC","YIELDMAT","Z.TEST","ZTEST"]);function zt(e){if(typeof e=="boolean")return[!0,Number(e)];if(typeof e=="number"&&!isNaN(e))return[!0,e];if(typeof e!="string")return[!1,0];if(e.length>12)return[!1,0];const t=Number(e);return isNaN(t)?[!1,0]:[!0,t]}function vr(e){const[t,r]=e.split(It),n=parseInt(t,10),s=parseInt(r,10);return{row:isNaN(n)?-1:n,col:isNaN(s)?-1:s}}function xe(e,t,r){return`${e}${It}${t}${It}${r}`}function Fr(e){const[t,r,n]=e.split(It),s=parseInt(r,10),o=parseInt(n,10),d={row:isNaN(s)?-1:s,col:isNaN(o)?-1:o,sheetId:t};return d.row<0||d.col<0||!t?null:d}function _e(e,t){return`${e}${It}${t}`}function Ur(e){return!!(typeof e=="string"&&e&&e.startsWith(Ie)&&e.length>1)}function kr(e,t){return e&&t.includes(ee)}class G extends Error{constructor(r){super(r);x(this,"value");this.value=r}}function q(e,t="#VALUE!"){if(!e)throw new G(t)}function ne(e){q(e.length===1);const[t]=e;return t}function Tt(e){const t=ne(e);return q(typeof t=="string"),t}function tt(e){const t=ne(e),[r,n]=zt(t);return q(r),n}function Pr(e){q(e.length===0)}function $r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ve={exports:{}};(function(e){var t={};function r(n){n.version="0.11.3";function s(c){for(var i="",a=c.length-1;a>=0;)i+=c.charAt(a--);return i}function o(c,i){for(var a="";a.length<i;)a+=c;return a}function d(c,i){var a=""+c;return a.length>=i?a:o("0",i-a.length)+a}function C(c,i){var a=""+c;return a.length>=i?a:o(" ",i-a.length)+a}function p(c,i){var a=""+c;return a.length>=i?a:a+o(" ",i-a.length)}function f(c,i){var a=""+Math.round(c);return a.length>=i?a:o("0",i-a.length)+a}function g(c,i){var a=""+c;return a.length>=i?a:o("0",i-a.length)+a}var M=Math.pow(2,32);function O(c,i){if(c>M||c<-M)return f(c,i);var a=Math.round(c);return g(a,i)}function I(c,i){return i=i||0,c.length>=7+i&&(c.charCodeAt(i)|32)===103&&(c.charCodeAt(i+1)|32)===101&&(c.charCodeAt(i+2)|32)===110&&(c.charCodeAt(i+3)|32)===101&&(c.charCodeAt(i+4)|32)===114&&(c.charCodeAt(i+5)|32)===97&&(c.charCodeAt(i+6)|32)===108}var k=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],V=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function H(c){c[0]="General",c[1]="0",c[2]="0.00",c[3]="#,##0",c[4]="#,##0.00",c[9]="0%",c[10]="0.00%",c[11]="0.00E+00",c[12]="# ?/?",c[13]="# ??/??",c[14]="m/d/yy",c[15]="d-mmm-yy",c[16]="d-mmm",c[17]="mmm-yy",c[18]="h:mm AM/PM",c[19]="h:mm:ss AM/PM",c[20]="h:mm",c[21]="h:mm:ss",c[22]="m/d/yy h:mm",c[37]="#,##0 ;(#,##0)",c[38]="#,##0 ;[Red](#,##0)",c[39]="#,##0.00;(#,##0.00)",c[40]="#,##0.00;[Red](#,##0.00)",c[45]="mm:ss",c[46]="[h]:mm:ss",c[47]="mmss.0",c[48]="##0.0E+0",c[49]="@",c[56]='"上午/下午 "hh"時"mm"分"ss"秒 "'}var X={};H(X);var Z=[],L=0;for(L=5;L<=8;++L)Z[L]=32+L;for(L=23;L<=26;++L)Z[L]=0;for(L=27;L<=31;++L)Z[L]=14;for(L=50;L<=58;++L)Z[L]=14;for(L=59;L<=62;++L)Z[L]=L-58;for(L=67;L<=68;++L)Z[L]=L-58;for(L=72;L<=75;++L)Z[L]=L-58;for(L=67;L<=68;++L)Z[L]=L-57;for(L=76;L<=78;++L)Z[L]=L-56;for(L=79;L<=81;++L)Z[L]=L-34;var it={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function lt(c,i,a){for(var T=c<0?-1:1,h=c*T,D=0,u=1,N=0,_=1,m=0,U=0,P=Math.floor(h);m<i&&(P=Math.floor(h),N=P*u+D,U=P*m+_,!(h-P<5e-8));)h=1/(h-P),D=u,u=N,_=m,m=U;if(U>i&&(m>i?(U=_,N=D):(U=m,N=u)),!a)return[0,T*N,U];var at=Math.floor(T*N/U);return[at,T*N-at*U,U]}function rt(c){var i=c.toPrecision(16);if(i.indexOf("e")>-1){var a=i.slice(0,i.indexOf("e"));return a=a.indexOf(".")>-1?a.slice(0,a.slice(0,2)=="0."?17:16):a.slice(0,15)+o("0",a.length-15),a+i.slice(i.indexOf("e"))}var T=i.indexOf(".")>-1?i.slice(0,i.slice(0,2)=="0."?17:16):i.slice(0,15)+o("0",i.length-15);return Number(T)}function z(c,i,a){if(c>2958465||c<0)return null;c=rt(c);var T=c|0,h=Math.floor(86400*(c-T)),D=0,u=[],N={D:T,T:h,u:86400*(c-T)-h,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(N.u)<1e-6&&(N.u=0),i&&i.date1904&&(T+=1462),N.u>.9999&&(N.u=0,++h==86400&&(N.T=h=0,++T,++N.D)),T===60)u=a?[1317,10,29]:[1900,2,29],D=3;else if(T===0)u=a?[1317,8,29]:[1900,1,0],D=6;else{T>60&&--T;var _=new Date(1900,0,1);_.setDate(_.getDate()+T-1),u=[_.getFullYear(),_.getMonth()+1,_.getDate()],D=_.getDay(),T<60&&(D=(D+6)%7),a&&(D=Vn(_,u))}return N.y=u[0],N.m=u[1],N.d=u[2],N.S=h%60,h=Math.floor(h/60),N.M=h%60,h=Math.floor(h/60),N.H=h,N.q=D,N}n.parse_date_code=z;var At=new Date(1899,11,31,0,0,0),Qt=At.getTime(),Gn=new Date(1900,2,1,0,0,0);function rr(c,i){var a=c.getTime();return i?a-=1461*24*60*60*1e3:c>=Gn&&(a+=24*60*60*1e3),(a-(Qt+(c.getTimezoneOffset()-At.getTimezoneOffset())*6e4))/(24*60*60*1e3)}var nr=function(){var i=/(?:\.0*|(\.\d*[1-9])0+)$/;function a(m){return m.indexOf(".")==-1?m:m.replace(i,"$1")}var T=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,h=/(E[+-])(\d)$/;function D(m){return m.indexOf("E")==-1?m:m.replace(T,"$1E").replace(h,"$10$2")}function u(m){var U=m<0?12:11,P=a(m.toFixed(12));return P.length<=U||(P=m.toPrecision(10),P.length<=U)?P:m.toExponential(5)}function N(m){var U=a(m.toFixed(11));return U.length>(m<0?12:11)||U==="0"||U==="-0"?m.toPrecision(6):U}function _(m){var U=Math.floor(Math.log(Math.abs(m))*Math.LOG10E),P;return U>=-4&&U<=-1?P=m.toPrecision(10+U):Math.abs(U)<=9?P=u(m):U===10?P=m.toFixed(10).substr(0,12):P=N(m),a(D(P.toUpperCase()))}return _}();n._general_num=nr;function jt(c,i){switch(typeof c){case"string":return c;case"boolean":return c?"TRUE":"FALSE";case"number":return(c|0)===c?c.toString(10):nr(c);case"undefined":return"";case"object":if(c==null)return"";if(c instanceof Date)return dr(14,rr(c,i&&i.date1904),i)}throw new Error("unsupported value in General format: "+c)}n._general=jt;function Vn(c,i){i[0]-=581;var a=c.getDay();return c<60&&(a=(a+6)%7),a}function Xn(c,i,a,T){var h="",D=0,u=0,N=a.y,_,m=0;switch(c){case 98:N=a.y+543;case 121:switch(i.length){case 1:case 2:_=N%100,m=2;break;default:_=N%1e4,m=4;break}break;case 109:switch(i.length){case 1:case 2:_=a.m,m=i.length;break;case 3:return V[a.m-1][1];case 5:return V[a.m-1][0];default:return V[a.m-1][2]}break;case 100:switch(i.length){case 1:case 2:_=a.d,m=i.length;break;case 3:return k[a.q][0];default:return k[a.q][1]}break;case 104:switch(i.length){case 1:case 2:_=1+(a.H+11)%12,m=i.length;break;default:throw"bad hour format: "+i}break;case 72:switch(i.length){case 1:case 2:_=a.H,m=i.length;break;default:throw"bad hour format: "+i}break;case 77:switch(i.length){case 1:case 2:_=a.M,m=i.length;break;default:throw"bad minute format: "+i}break;case 115:if(i!="s"&&i!="ss"&&i!=".0"&&i!=".00"&&i!=".000")throw"bad second format: "+i;return a.u===0&&(i=="s"||i=="ss")?d(a.S,i.length):(T>=2?u=T===3?1e3:100:u=T===1?10:1,D=Math.round(u*(a.S+a.u)),D>=60*u&&(D=0),i==="s"?D===0?"0":""+D/u:(h=d(D,2+T),i==="ss"?h.substr(0,2):"."+h.substr(2,i.length-1)));case 90:switch(i){case"[h]":case"[hh]":_=a.D*24+a.H;break;case"[m]":case"[mm]":_=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":_=((a.D*24+a.H)*60+a.M)*60+(T==0?Math.round(a.S+a.u):a.S);break;default:throw"bad abstime format: "+i}m=i.length===3?1:2;break;case 101:_=N,m=1;break}var U=m>0?d(_,m):"";return U}function pt(c){var i=3;if(c.length<=i)return c;for(var a=c.length%i,T=c.substr(0,a);a!=c.length;a+=i)T+=(T.length>0?",":"")+c.substr(a,i);return T}var dt=function(){var i=/%/g;function a(w,l,E){var b=l.replace(i,""),S=l.length-b.length;return dt(w,b,E*Math.pow(10,2*S))+o("%",S)}function T(w,l,E){for(var b=l.length-1;l.charCodeAt(b-1)===44;)--b;return dt(w,l.substr(0,b),E/Math.pow(10,3*(l.length-b)))}function h(w,l){var E,b=w.indexOf("E")-w.indexOf(".")-1;if(w.match(/^#+0.0E\+0$/)){if(l==0)return"0.0E+0";if(l<0)return"-"+h(w,-l);var S=w.indexOf(".");S===-1&&(S=w.indexOf("E"));var R=Math.floor(Math.log(l)*Math.LOG10E)%S;if(R<0&&(R+=S),E=(l/Math.pow(10,R)).toPrecision(b+1+(S+R)%S),E.indexOf("e")===-1){var v=Math.floor(Math.log(l)*Math.LOG10E);for(E.indexOf(".")===-1?E=E.charAt(0)+"."+E.substr(1)+"E+"+(v-E.length+R):E+="E+"+(v-R);E.substr(0,2)==="0.";)E=E.charAt(0)+E.substr(2,S)+"."+E.substr(2+S),E=E.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");E=E.replace(/\+-/,"-")}E=E.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(W,Y,K,B){return Y+K+B.substr(0,(S+R)%S)+"."+B.substr(R)+"E"})}else E=l.toExponential(b);return w.match(/E\+00$/)&&E.match(/e[+-]\d$/)&&(E=E.substr(0,E.length-1)+"0"+E.charAt(E.length-1)),w.match(/E\-/)&&E.match(/e\+/)&&(E=E.replace(/e\+/,"e")),E.replace("e","E")}var D=/# (\?+)( ?)\/( ?)(\d+)/;function u(w,l,E){var b=parseInt(w[4],10),S=Math.round(l*b),R=Math.floor(S/b),v=S-R*b,W=b;return E+(R===0?"":""+R)+" "+(v===0?o(" ",w[1].length+1+w[4].length):C(v,w[1].length)+w[2]+"/"+w[3]+d(W,w[4].length))}function N(w,l,E){return E+(l===0?"":""+l)+o(" ",w[1].length+2+w[4].length)}var _=/^#*0*\.([0#]+)/,m=/\).*[0#]/,U=/\(###\) ###\\?-####/;function P(w){for(var l="",E,b=0;b!=w.length;++b)switch(E=w.charCodeAt(b)){case 35:break;case 63:l+=" ";break;case 48:l+="0";break;default:l+=String.fromCharCode(E)}return l}function at(w,l){var E=Math.pow(10,l);return""+Math.round(w*E)/E}function Rt(w,l){var E=w-Math.floor(w),b=Math.pow(10,l);return l<(""+Math.round(E*b)).length?0:Math.round(E*b)}function de(w,l){return l<(""+Math.round((w-Math.floor(w))*Math.pow(10,l))).length?1:0}function ct(w){return w<2147483647&&w>-2147483648?""+(w>=0?w|0:w-1|0):""+Math.floor(w)}function y(w,l,E){if(w.charCodeAt(0)===40&&!l.match(m)){var b=l.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return E>=0?y("n",b,E):"("+y("n",b,-E)+")"}if(l.charCodeAt(l.length-1)===44)return T(w,l,E);if(l.indexOf("%")!==-1)return a(w,l,E);if(l.indexOf("E")!==-1)return h(l,E);if(l.charCodeAt(0)===36)return"$"+y(w,l.substr(l.charAt(1)==" "?2:1),E);var S,R,v,W,Y=Math.abs(E),K=E<0?"-":"";if(l.match(/^00+$/))return K+O(Y,l.length);if(l.match(/^[#?]+$/))return S=O(E,0),S==="0"&&(S=""),S.length>l.length?S:P(l.substr(0,l.length-S.length))+S;if(R=l.match(D))return u(R,Y,K);if(l.match(/^#+0+$/))return K+O(Y,l.length-l.indexOf("0"));if(R=l.match(_))return S=at(E,R[1].length).replace(/^([^\.]+)$/,"$1."+P(R[1])).replace(/\.$/,"."+P(R[1])).replace(/\.(\d*)$/,function(nt,kt){return"."+kt+o("0",P(R[1]).length-kt.length)}),l.indexOf("0.")!==-1?S:S.replace(/^0\./,".");if(l=l.replace(/^#+([0.])/,"$1"),R=l.match(/^(0*)\.(#*)$/))return K+at(Y,R[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,R[1].length?"0.":".");if(R=l.match(/^#{1,3},##0(\.?)$/))return K+pt(O(Y,0));if(R=l.match(/^#,##0\.([#0]*0)$/))return E<0?"-"+y(w,l,-E):pt(""+(Math.floor(E)+de(E,R[1].length)))+"."+d(Rt(E,R[1].length),R[1].length);if(R=l.match(/^#,#*,#0/))return y(w,l.replace(/^#,#*,/,""),E);if(R=l.match(/^([0#]+)(\\?-([0#]+))+$/))return S=s(y(w,l.replace(/[\\-]/g,""),E)),v=0,s(s(l.replace(/\\/g,"")).replace(/[0#]/g,function(nt){return v<S.length?S.charAt(v++):nt==="0"?"0":""}));if(l.match(U))return S=y(w,"##########",E),"("+S.substr(0,3)+") "+S.substr(3,3)+"-"+S.substr(6);var B="";if(R=l.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return v=Math.min(R[4].length,7),W=lt(Y,Math.pow(10,v)-1,!1),S=""+K,B=dt("n",R[1],W[1]),B.charAt(B.length-1)==" "&&(B=B.substr(0,B.length-1)+"0"),S+=B+R[2]+"/"+R[3],B=p(W[2],v),B.length<R[4].length&&(B=P(R[4].substr(R[4].length-B.length))+B),S+=B,S;if(R=l.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return v=Math.min(Math.max(R[1].length,R[4].length),7),W=lt(Y,Math.pow(10,v)-1,!0),K+(W[0]||(W[1]?"":"0"))+" "+(W[1]?C(W[1],v)+R[2]+"/"+R[3]+p(W[2],v):o(" ",2*v+1+R[2].length+R[3].length));if(R=l.match(/^[#0?]+$/))return S=O(E,0),l.length<=S.length?S:P(l.substr(0,l.length-S.length))+S;if(R=l.match(/^([#0?]+)\.([#0]+)$/)){S=""+E.toFixed(Math.min(R[2].length,10)).replace(/([^0])0+$/,"$1"),v=S.indexOf(".");var Ft=l.indexOf(".")-v,fe=l.length-S.length-Ft;return P(l.substr(0,Ft)+S+l.substr(l.length-fe))}if(R=l.match(/^00,000\.([#0]*0)$/))return v=Rt(E,R[1].length),E<0?"-"+y(w,l,-E):pt(ct(E)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(nt){return"00,"+(nt.length<3?d(0,3-nt.length):"")+nt})+"."+d(v,R[1].length);switch(l){case"###,##0.00":return y(w,"#,##0.00",E);case"###,###":case"##,###":case"#,###":var Ut=pt(O(Y,0));return Ut!=="0"?K+Ut:"";case"###,###.00":return y(w,"###,##0.00",E).replace(/^0\./,".");case"#,###.00":return y(w,"#,##0.00",E).replace(/^0\./,".")}throw new Error("unsupported format |"+l+"|")}function Ot(w,l,E){for(var b=l.length-1;l.charCodeAt(b-1)===44;)--b;return dt(w,l.substr(0,b),E/Math.pow(10,3*(l.length-b)))}function Zt(w,l,E){var b=l.replace(i,""),S=l.length-b.length;return dt(w,b,E*Math.pow(10,2*S))+o("%",S)}function et(w,l){var E,b=w.indexOf("E")-w.indexOf(".")-1;if(w.match(/^#+0.0E\+0$/)){if(l==0)return"0.0E+0";if(l<0)return"-"+et(w,-l);var S=w.indexOf(".");S===-1&&(S=w.indexOf("E"));var R=Math.floor(Math.log(l)*Math.LOG10E)%S;if(R<0&&(R+=S),E=(l/Math.pow(10,R)).toPrecision(b+1+(S+R)%S),!E.match(/[Ee]/)){var v=Math.floor(Math.log(l)*Math.LOG10E);E.indexOf(".")===-1?E=E.charAt(0)+"."+E.substr(1)+"E+"+(v-E.length+R):E+="E+"+(v-R),E=E.replace(/\+-/,"-")}E=E.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(W,Y,K,B){return Y+K+B.substr(0,(S+R)%S)+"."+B.substr(R)+"E"})}else E=l.toExponential(b);return w.match(/E\+00$/)&&E.match(/e[+-]\d$/)&&(E=E.substr(0,E.length-1)+"0"+E.charAt(E.length-1)),w.match(/E\-/)&&E.match(/e\+/)&&(E=E.replace(/e\+/,"e")),E.replace("e","E")}function J(w,l,E){if(w.charCodeAt(0)===40&&!l.match(m)){var b=l.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return E>=0?J("n",b,E):"("+J("n",b,-E)+")"}if(l.charCodeAt(l.length-1)===44)return Ot(w,l,E);if(l.indexOf("%")!==-1)return Zt(w,l,E);if(l.indexOf("E")!==-1)return et(l,E);if(l.charCodeAt(0)===36)return"$"+J(w,l.substr(l.charAt(1)==" "?2:1),E);var S,R,v,W,Y=Math.abs(E),K=E<0?"-":"";if(l.match(/^00+$/))return K+d(Y,l.length);if(l.match(/^[#?]+$/))return S=""+E,E===0&&(S=""),S.length>l.length?S:P(l.substr(0,l.length-S.length))+S;if(R=l.match(D))return N(R,Y,K);if(l.match(/^#+0+$/))return K+d(Y,l.length-l.indexOf("0"));if(R=l.match(_))return S=(""+E).replace(/^([^\.]+)$/,"$1."+P(R[1])).replace(/\.$/,"."+P(R[1])),S=S.replace(/\.(\d*)$/,function(nt,kt){return"."+kt+o("0",P(R[1]).length-kt.length)}),l.indexOf("0.")!==-1?S:S.replace(/^0\./,".");if(l=l.replace(/^#+([0.])/,"$1"),R=l.match(/^(0*)\.(#*)$/))return K+(""+Y).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,R[1].length?"0.":".");if(R=l.match(/^#{1,3},##0(\.?)$/))return K+pt(""+Y);if(R=l.match(/^#,##0\.([#0]*0)$/))return E<0?"-"+J(w,l,-E):pt(""+E)+"."+o("0",R[1].length);if(R=l.match(/^#,#*,#0/))return J(w,l.replace(/^#,#*,/,""),E);if(R=l.match(/^([0#]+)(\\?-([0#]+))+$/))return S=s(J(w,l.replace(/[\\-]/g,""),E)),v=0,s(s(l.replace(/\\/g,"")).replace(/[0#]/g,function(nt){return v<S.length?S.charAt(v++):nt==="0"?"0":""}));if(l.match(U))return S=J(w,"##########",E),"("+S.substr(0,3)+") "+S.substr(3,3)+"-"+S.substr(6);var B="";if(R=l.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return v=Math.min(R[4].length,7),W=lt(Y,Math.pow(10,v)-1,!1),S=""+K,B=dt("n",R[1],W[1]),B.charAt(B.length-1)==" "&&(B=B.substr(0,B.length-1)+"0"),S+=B+R[2]+"/"+R[3],B=p(W[2],v),B.length<R[4].length&&(B=P(R[4].substr(R[4].length-B.length))+B),S+=B,S;if(R=l.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return v=Math.min(Math.max(R[1].length,R[4].length),7),W=lt(Y,Math.pow(10,v)-1,!0),K+(W[0]||(W[1]?"":"0"))+" "+(W[1]?C(W[1],v)+R[2]+"/"+R[3]+p(W[2],v):o(" ",2*v+1+R[2].length+R[3].length));if(R=l.match(/^[#0?]+$/))return S=""+E,l.length<=S.length?S:P(l.substr(0,l.length-S.length))+S;if(R=l.match(/^([#0]+)\.([#0]+)$/)){S=""+E.toFixed(Math.min(R[2].length,10)).replace(/([^0])0+$/,"$1"),v=S.indexOf(".");var Ft=l.indexOf(".")-v,fe=l.length-S.length-Ft;return P(l.substr(0,Ft)+S+l.substr(l.length-fe))}if(R=l.match(/^00,000\.([#0]*0)$/))return E<0?"-"+J(w,l,-E):pt(""+E).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(nt){return"00,"+(nt.length<3?d(0,3-nt.length):"")+nt})+"."+d(0,R[1].length);switch(l){case"###,###":case"##,###":case"#,###":var Ut=pt(""+Y);return Ut!=="0"?K+Ut:"";default:if(l.match(/\.[0#?]*$/))return J(w,l.slice(0,l.lastIndexOf(".")),E)+P(l.slice(l.lastIndexOf(".")))}throw new Error("unsupported format |"+l+"|")}return function(l,E,b){return(b|0)===b?J(l,E,b):y(l,E,b)}}();function sr(c){for(var i=[],a=!1,T=0,h=0;T<c.length;++T)switch(c.charCodeAt(T)){case 34:a=!a;break;case 95:case 42:case 92:++T;break;case 59:i[i.length]=c.substr(h,T-h),h=T+1}if(i[i.length]=c.substr(h),a===!0)throw new Error("Format |"+c+"| unterminated string ");return i}n._split=sr;var ir=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function or(c){for(var i=0,a="",T="";i<c.length;)switch(a=c.charAt(i)){case"G":I(c,i)&&(i+=6),i++;break;case'"':for(;c.charCodeAt(++i)!==34&&i<c.length;);++i;break;case"\\":i+=2;break;case"_":i+=2;break;case"@":++i;break;case"B":case"b":if(c.charAt(i+1)==="1"||c.charAt(i+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(c.substr(i,3).toUpperCase()==="A/P"||c.substr(i,5).toUpperCase()==="AM/PM"||c.substr(i,5).toUpperCase()==="上午/下午")return!0;++i;break;case"[":for(T=a;c.charAt(i++)!=="]"&&i<c.length;)T+=c.charAt(i);if(T.match(ir))return!0;break;case".":case"0":case"#":for(;i<c.length&&("0#?.,E+-%".indexOf(a=c.charAt(++i))>-1||a=="\\"&&c.charAt(i+1)=="-"&&"0#".indexOf(c.charAt(i+2))>-1););break;case"?":for(;c.charAt(++i)===a;);break;case"*":++i,(c.charAt(i)==" "||c.charAt(i)=="*")&&++i;break;case"(":case")":++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;i<c.length&&"0123456789".indexOf(c.charAt(++i))>-1;);break;case" ":++i;break;default:++i;break}return!1}n.is_date=or;function ar(c,i,a,T){for(var h=[],D="",u=0,N="",_="t",m,U,P,at="H";u<c.length;)switch(N=c.charAt(u)){case"G":if(!I(c,u))throw new Error("unrecognized character "+N+" in "+c);h[h.length]={t:"G",v:"General"},u+=7;break;case'"':for(D="";(P=c.charCodeAt(++u))!==34&&u<c.length;)D+=String.fromCharCode(P);h[h.length]={t:"t",v:D},++u;break;case"\\":var Rt=c.charAt(++u),de=Rt==="("||Rt===")"?Rt:"t";h[h.length]={t:de,v:Rt},++u;break;case"_":h[h.length]={t:"t",v:" "},u+=2;break;case"@":h[h.length]={t:"T",v:i},++u;break;case"B":case"b":if(c.charAt(u+1)==="1"||c.charAt(u+1)==="2"){if(m==null&&(m=z(i,a,c.charAt(u+1)==="2"),m==null))return"";h[h.length]={t:"X",v:c.substr(u,2)},_=N,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":N=N.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(i<0||m==null&&(m=z(i,a),m==null))return"";for(D=N;++u<c.length&&c.charAt(u).toLowerCase()===N;)D+=N;N==="m"&&_.toLowerCase()==="h"&&(N="M"),N==="h"&&(N=at),h[h.length]={t:N,v:D},_=N;break;case"A":case"a":case"上":var ct={t:N,v:N};if(m==null&&(m=z(i,a)),c.substr(u,3).toUpperCase()==="A/P"?(m!=null&&(ct.v=m.H>=12?c.charAt(u+2):N),ct.t="T",at="h",u+=3):c.substr(u,5).toUpperCase()==="AM/PM"?(m!=null&&(ct.v=m.H>=12?"PM":"AM"),ct.t="T",u+=5,at="h"):c.substr(u,5).toUpperCase()==="上午/下午"?(m!=null&&(ct.v=m.H>=12?"下午":"上午"),ct.t="T",u+=5,at="h"):(ct.t="t",++u),m==null&&ct.t==="T")return"";h[h.length]=ct,_=N;break;case"[":for(D=N;c.charAt(u++)!=="]"&&u<c.length;)D+=c.charAt(u);if(D.slice(-1)!=="]")throw'unterminated "[" block: |'+D+"|";if(D.match(ir)){if(m==null&&(m=z(i,a),m==null))return"";h[h.length]={t:"Z",v:D.toLowerCase()},_=D.charAt(1)}else D.indexOf("$")>-1&&(D=(D.match(/\$([^-\[\]]*)/)||[])[1]||"$",or(c)||(h[h.length]={t:"t",v:D}));break;case".":if(m!=null){for(D=N;++u<c.length&&(N=c.charAt(u))==="0";)D+=N;h[h.length]={t:"s",v:D};break}case"0":case"#":for(D=N;++u<c.length&&"0#?.,E+-%".indexOf(N=c.charAt(u))>-1;)D+=N;h[h.length]={t:"n",v:D};break;case"?":for(D=N;c.charAt(++u)===N;)D+=N;h[h.length]={t:N,v:D},_=N;break;case"*":++u,(c.charAt(u)==" "||c.charAt(u)=="*")&&++u;break;case"(":case")":h[h.length]={t:T===1?"t":N,v:N},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(D=N;u<c.length&&"0123456789".indexOf(c.charAt(++u))>-1;)D+=c.charAt(u);h[h.length]={t:"D",v:D};break;case" ":h[h.length]={t:N,v:N},++u;break;case"$":h[h.length]={t:"t",v:"$"},++u;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(N)===-1)throw new Error("unrecognized character "+N+" in "+c);h[h.length]={t:"t",v:N},++u;break}var y=0,Ot=0,Zt;for(u=h.length-1,_="t";u>=0;--u)switch(h[u].t){case"h":case"H":h[u].t=at,_="h",y<1&&(y=1);break;case"s":(Zt=h[u].v.match(/\.0+$/))&&(Ot=Math.max(Ot,Zt[0].length-1),y=4),y<3&&(y=3);case"d":case"y":case"e":_=h[u].t;break;case"M":_=h[u].t,y<2&&(y=2);break;case"m":_==="s"&&(h[u].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&h[u].v.match(/[Hh]/)&&(y=1),y<2&&h[u].v.match(/[Mm]/)&&(y=2),y<3&&h[u].v.match(/[Ss]/)&&(y=3)}var et;switch(y){case 0:break;case 1:case 2:case 3:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H),m.H>=24&&(m.H=0,++m.D,et=z(m.D),et.u=m.u,et.S=m.S,et.M=m.M,et.H=m.H,m=et);break;case 4:switch(Ot){case 1:m.u=Math.round(m.u*10)/10;break;case 2:m.u=Math.round(m.u*100)/100;break;case 3:m.u=Math.round(m.u*1e3)/1e3;break}m.u>=1&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H),m.H>=24&&(m.H=0,++m.D,et=z(m.D),et.u=m.u,et.S=m.S,et.M=m.M,et.H=m.H,m=et);break}var J="",w;for(u=0;u<h.length;++u)switch(h[u].t){case"t":case"T":case" ":case"D":break;case"X":h[u].v="",h[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":h[u].v=Xn(h[u].t.charCodeAt(0),h[u].v,m,Ot),h[u].t="t";break;case"n":case"?":for(w=u+1;h[w]!=null&&((N=h[w].t)==="?"||N==="D"||(N===" "||N==="t")&&h[w+1]!=null&&(h[w+1].t==="?"||h[w+1].t==="t"&&h[w+1].v==="/")||h[u].t==="("&&(N===" "||N==="n"||N===")")||N==="t"&&(h[w].v==="/"||h[w].v===" "&&h[w+1]!=null&&h[w+1].t=="?"));)h[u].v+=h[w].v,h[w]={v:"",t:";"},++w;J+=h[u].v,u=w-1;break;case"G":h[u].t="t",h[u].v=jt(i,a);break}var l="",E,b;if(J.length>0){J.charCodeAt(0)==40?(E=i<0&&J.charCodeAt(0)===45?-i:i,b=dt("n",J,E)):(E=i<0&&T>1?-i:i,b=dt("n",J,E),E<0&&h[0]&&h[0].t=="t"&&(b=b.substr(1),h[0].v="-"+h[0].v)),w=b.length-1;var S=h.length;for(u=0;u<h.length;++u)if(h[u]!=null&&h[u].t!="t"&&h[u].v.indexOf(".")>-1){S=u;break}var R=h.length;if(S===h.length&&b.indexOf("E")===-1){for(u=h.length-1;u>=0;--u)h[u]==null||"n?".indexOf(h[u].t)===-1||(w>=h[u].v.length-1?(w-=h[u].v.length,h[u].v=b.substr(w+1,h[u].v.length)):w<0?h[u].v="":(h[u].v=b.substr(0,w+1),w=-1),h[u].t="t",R=u);w>=0&&R<h.length&&(h[R].v=b.substr(0,w+1)+h[R].v)}else if(S!==h.length&&b.indexOf("E")===-1){for(w=b.indexOf(".")-1,u=S;u>=0;--u)if(!(h[u]==null||"n?".indexOf(h[u].t)===-1)){for(U=h[u].v.indexOf(".")>-1&&u===S?h[u].v.indexOf(".")-1:h[u].v.length-1,l=h[u].v.substr(U+1);U>=0;--U)w>=0&&(h[u].v.charAt(U)==="0"||h[u].v.charAt(U)==="#")&&(l=b.charAt(w--)+l);h[u].v=l,h[u].t="t",R=u}for(w>=0&&R<h.length&&(h[R].v=b.substr(0,w+1)+h[R].v),w=b.indexOf(".")+1,u=S;u<h.length;++u)if(!(h[u]==null||"n?(".indexOf(h[u].t)===-1&&u!==S)){for(U=h[u].v.indexOf(".")>-1&&u===S?h[u].v.indexOf(".")+1:0,l=h[u].v.substr(0,U);U<h[u].v.length;++U)w<b.length&&(l+=b.charAt(w++));h[u].v=l,h[u].t="t",R=u}}}for(u=0;u<h.length;++u)h[u]!=null&&"n?".indexOf(h[u].t)>-1&&(E=T>1&&i<0&&u>0&&h[u-1].v==="-"?-i:i,h[u].v=dt(h[u].t,h[u].v,E),h[u].t="t");var v="";for(u=0;u!==h.length;++u)h[u]!=null&&(v+=h[u].v);return v}n._eval=ar;var cr=/\[[=<>]/,hr=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function lr(c,i){if(i==null)return!1;var a=parseFloat(i[2]);switch(i[1]){case"=":if(c==a)return!0;break;case">":if(c>a)return!0;break;case"<":if(c<a)return!0;break;case"<>":if(c!=a)return!0;break;case">=":if(c>=a)return!0;break;case"<=":if(c<=a)return!0;break}return!1}function ur(c,i){var a=sr(c),T=a.length,h=a[T-1].indexOf("@");if(T<4&&h>-1&&--T,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof i!="number")return[4,a.length===4||h>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=h>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=h>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=h>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var D=i>0?a[0]:i<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[T,D];if(a[0].match(cr)!=null||a[1].match(cr)!=null){var u=a[0].match(hr),N=a[1].match(hr);return lr(i,u)?[T,a[0]]:lr(i,N)?[T,a[1]]:[T,a[u!=null&&N!=null?2:1]]}return[T,D]}function dr(c,i,a){a==null&&(a={});var T="";switch(typeof c){case"string":c=="m/d/yy"&&a.dateNF?T=a.dateNF:T=c;break;case"number":c==14&&a.dateNF?T=a.dateNF:T=(a.table!=null?a.table:X)[c],T==null&&(T=a.table&&a.table[Z[c]]||X[Z[c]]),T==null&&(T=it[c]||"General");break}if(I(T,0))return jt(i,a);i instanceof Date&&(i=rr(i,a.date1904));var h=ur(T,i);if(I(h[1]))return jt(i,a);if(i===!0)i="TRUE";else if(i===!1)i="FALSE";else if(i===""||i==null)return"";return ar(h[1],i,a,h[0])}function fr(c,i){if(typeof i!="number"){i=+i||-1;for(var a=0;a<392;++a){if(X[a]==null){i<0&&(i=a);continue}if(X[a]==c){i=a;break}}i<0&&(i=391)}return X[i]=c,i}n.load=fr,n._table=X,n.get_table=function(){return X},n.load_table=function(i){for(var a=0;a!=392;++a)i[a]!==void 0&&fr(i[a],a)},n.init_table=H,n.format=dr,n.choose_format=ur}r(t),typeof DO_NOT_EXPORT_SSF>"u"&&(e.exports=t)})(ve);var Br=ve.exports,Fe=$r(Br);function Ue(e,t,r={}){return Fe.format(t||Wt,e,r)}function Hr(e){return e?Fe.is_date(e):!1}const yr=(...e)=>{const t=ne(e);return typeof t=="string"?t:""},Gr=(...e)=>Tt(e).toLowerCase(),ke=(...e)=>{const t=tt(e);return String.fromCharCode(t)},Pe=(...e)=>Tt(e).charCodeAt(0),Vr=(...e)=>Tt(e).length,Xr=(...e)=>{q(e.length===2);const[t,r]=e;return q(typeof t=="string"),q(typeof r=="string"),t.split(r)},Wr=(...e)=>Tt(e).toUpperCase(),zr=(...e)=>{q(e.length===2);const[t,r]=e;return q(typeof t=="string"||typeof t=="number"),q(typeof r=="string"),Ue(t,r)},Yr=(...e)=>Tt(e).replace(/ +/g," ").trim(),$e=(...e)=>(q(e.length<=re),e.join("")),Kr={CONCAT:$e,CONCATENATE:$e,SPLIT:Xr,CHAR:ke,CODE:Pe,UNICHAR:ke,UNICODE:Pe,LEN:Vr,LOWER:Gr,UPPER:Wr,TRIM:Yr,TEXT:zr,T:yr};function Be(e){const t=[];for(let r=0;r<e.length;r++){const[n,s]=zt(e[r]);n&&t.push(s)}return t}const Qr={ABS:(...e)=>{const t=tt(e);return Math.abs(t)},ACOS:(...e)=>{const t=tt(e);return Math.acos(t)},ACOSH:(...e)=>{const t=tt(e);return Math.log(t+Math.sqrt(t*t-1))},ACOT:(...e)=>{const t=tt(e);return Math.atan(1/t)},ACOTH:(...e)=>{const t=tt(e);return .5*Math.log((t+1)/(t-1))},ASIN:(...e)=>{const t=tt(e);return Math.asin(t)},ASINH:(...e)=>{const t=tt(e);return Math.log(t+Math.sqrt(t*t+1))},ATAN:(...e)=>{const t=tt(e);return Math.atan(t)},ATAN2:(...e)=>{q(e.length===2);const[t,r]=e;return q(typeof t=="number"),q(typeof r=="number"),Math.atan2(t,r)},ATANH:(...e)=>{const t=tt(e);return Math.log((1+t)/(t+1))/2},AVERAGE:(...e)=>{const t=Be(e);return q(t.length<=re&&t.length>=1),t.reduce((r,n)=>r+n,0)/t.length},COT:(...e)=>{const t=tt(e);return 1/Math.tan(t)},COS:(...e)=>{const t=tt(e);return Math.cos(t)},EXP:(...e)=>{const t=tt(e);return Math.exp(t)},INT:(...e)=>{const t=tt(e);return Math.floor(t)},PI:(...e)=>(Pr(e),Math.PI),SIN:(...e)=>{const t=tt(e);return Math.sin(t)},SUM:(...e)=>{const t=Be(e);return q(t.length<=re),t.reduce((r,n)=>r+n,0)}};function jr(e){const t=String(e),r=/[.](\d*)/.exec(t);if(r&&r[1]){const n=Math.pow(10,Math.min(r[1].length,Te)),s=t.split("."),o=s[0]+s[1].slice(0,Te);return Number(o)/n}else return e}const He={...Kr,...Qr};function Zr(e){const t=e.toUpperCase();let r=0;for(let n=0;n<t.length;n++)r=t.charCodeAt(n)-64+r*26;return r-1}function Jr(e){const t=e+1;let r="",n=Math.floor(Math.abs(t)),s;for(;n>0;)s=(n-1)%26,r=String.fromCharCode(65+s)+r,n=Math.floor((n-s)/26);return r.toUpperCase()}function qr(e){let t=parseInt(e,10);return isNaN(t)?t=-1:t=Math.max(t-1,-1),t}function bt(e){return Dt(e)&&Lt(e)}function Dt(e){return e.colCount===0}function Lt(e){return e.rowCount===0}function tn(e,t){if(e.colCount===0&&t.colCount!==0||e.rowCount===0&&t.rowCount!==0)return!1;if(t.colCount===0&&t.row===e.row||t.rowCount===0&&t.col===e.col)return!0;const{row:r,col:n}=e;return r>=t.row&&r<t.row+t.rowCount&&n>=t.col&&n<t.col+t.colCount}class ht{constructor(t,r,n,s,o){x(this,"row",0);x(this,"col",0);x(this,"colCount",0);x(this,"rowCount",0);x(this,"sheetId","");this.row=t,this.col=r,this.colCount=s,this.rowCount=n,this.sheetId=o}static makeRange(t){return new ht(t.row,t.col,t.rowCount,t.colCount,t.sheetId)}toIRange(){return{row:this.row,col:this.col,rowCount:this.rowCount,colCount:this.colCount,sheetId:this.sheetId}}}function en(e,t,r,n){const{row:s,col:o,rowCount:d,colCount:C}=e;if(bt(e)){for(let g=0;g<t;g++)for(let M=0;M<r;M++)if(n(g,M))return;return}if(Dt(e)){for(let g=0;g<r;g++)if(n(s,g))return;return}if(Lt(e)){for(let g=0;g<t;g++)if(n(g,o))return;return}const p=s+d,f=o+C;for(let g=s;g<p;g++)for(let M=o;M<f;M++)if(n(g,M))return}const se=e=>e>="a"&&e<="z"||e>="A"&&e<="Z",Et=e=>e>="0"&&e<="9";function rn(e){return e}function ye(e,t){if(!e)return;const r=e.trim();let[n,s=""]=r.split("!");r.includes("!")||(n="",s=r),n&&n[0]==="'"&&n[n.length-1]==="'"&&(n=n.slice(1,-1));let o=0,d="",C="";for(s[o]==="$"&&o++;o<s.length&&se(s[o]);)C+=s[o++];for(s[o]==="$"&&o++;o<s.length&&Et(s[o]);)d+=s[o++];if(o!==s.length||!d&&!C)return;let p=1,f=1,g=-1,M=-1;return d===""?(p=0,g=0):g=qr(d),C===""?(f=0,M=0):M=Zr(C),g<0||M<0||M>=Ne||g>=Oe?void 0:new ht(g,M,p,f,t(n))}function nn(e,t=rn){const[r,n]=e.split(":"),s=ye(r,t);if(!s)return;const o=ye(n,t);return o?(o.sheetId=s.sheetId,Ge(s,o)):s}function Ge(e,t){if(e.sheetId!==t.sheetId)return;if(e.row===t.row&&e.col===t.col&&e.rowCount===t.rowCount&&e.colCount===t.colCount)return ht.makeRange(e);if(e.rowCount===0&&t.rowCount!==0||e.rowCount!==0&&t.rowCount===0||e.colCount===0&&t.colCount!==0||e.colCount!==0&&t.colCount===0)return;const r=Math.abs(e.row-t.row)+1,n=Math.abs(e.col-t.col)+1,s=e.row<t.row?e.row:t.row,o=e.col<t.col?e.col:t.col;return new ht(s,o,r,n,e.sheetId)}function Ve(e,t){let r=-1;if(e.startsWith("[")){const n=parseInt(e.slice(1,-1),10);isNaN(n)||(r=t+n)}else{const n=parseInt(e,10);isNaN(n)||(r=n-1)}return isNaN(r)?-1:r}function sn(e,t={row:-1,col:-1}){const r=e.toUpperCase();if(r[0]!=="R")return;const n=r.slice(1).split("C");if(n.length!==2)return;const[s,o]=n;let d=-1,C=-1;return s?d=Ve(s,t.row):d=t.row,o?C=Ve(o,t.col):C=t.col,C>=Ne||d>=Oe||d<0||C<0?void 0:new ht(d,C,1,1,"")}const Xe="";class on{constructor(t){x(this,"list");x(this,"current",0);x(this,"start",0);x(this,"tokens",[]);this.list=[...t]}scan(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();return this.tokens.push(new ot(A.EOF,"")),this.tokens.length>0&&this.tokens[0].type===A.EQUAL&&this.tokens.shift(),this.tokens}peek(){return this.isAtEnd()?Xe:this.list[this.current]}match(t){return this.peek()!==t?!1:(this.next(),!0)}next(){return this.isAtEnd()?Xe:this.list[this.current++]}isAtEnd(){return this.current>=this.list.length}addToken(t){const r=this.list.slice(this.start,this.current).join("");this.tokens.push(new ot(t,r))}string(t){for(;!this.isAtEnd()&&this.peek()!==t;)this.next();if(this.peek()!==t)throw new G("#VALUE!");this.next();const r=this.list.slice(this.start+1,this.current-1).join("");if(t==="'"&&this.match("!")){this.tokens.push(new ot(A.SHEET_NAME,r));return}this.tokens.push(new ot(A.STRING,r))}getDigits(){for(;!this.isAtEnd()&&Et(this.peek());)this.next()}getAlphas(){for(;!this.isAtEnd()&&se(this.peek());)this.next()}matchR1C1(){if(this.match("[")){if(this.match("-"),Et(this.peek()))this.getDigits();else throw new G("#VALUE!");if(this.peek()!=="]")throw new G("#VALUE!");this.next()}else this.getDigits()}matchScientificCounting(){if(this.match("E")||this.match("e")){if(this.match("+")||this.match("-"))return this.getDigits(),this.addToken(A.NUMBER),!0;if(Et(this.peek()))return this.getDigits(),this.addToken(A.NUMBER),!0;throw new G("#VALUE!")}return!1}number(){this.getDigits(),!(this.matchScientificCounting()||(this.match(".")&&this.getDigits(),this.matchScientificCounting()))&&this.addToken(A.NUMBER)}addIdentifier(){for(;!this.isAtEnd()&&this.anyChar(this.peek());)this.next();let t=this.list.slice(this.start,this.current).join("");const r=t.toUpperCase();if(_r.has(r)&&this.match("(")){this.tokens.push(new ot(A.EXCEL_FUNCTION,r));return}if(["IF","CHOOSE"].includes(r)&&this.match("(")){this.tokens.push(new ot(A.REF_FUNCTION_COND,r));return}if(["INDEX","OFFSET","INDIRECT"].includes(r)&&this.match("(")){this.tokens.push(new ot(A.REF_FUNCTION,r));return}if(this.match("!")){this.tokens.push(new ot(A.SHEET_NAME,t));return}let n=A.BOOL;if(r==="TRUE"||r==="FALSE")t=r,n=A.BOOL;else if(be.has(r))t=r,n=r==="#REF!"?A.ERROR_REF:A.ERROR;else if(br.test(r))n=A.CELL;else if(Dr.test(r))n=A.COLUMN;else if(Lr.test(r))n=A.ROW;else if(xr.test(r))n=A.DEFINED_NAME;else throw new G("#NAME?");this.tokens.push(new ot(n,t))}scanToken(){const t=this.next();switch(t){case"$":{se(this.peek())?(this.getAlphas(),this.match("$")?Et(this.peek())?(this.getDigits(),this.addToken(A.CELL)):this.addIdentifier():Et(this.peek())?(this.getDigits(),this.addToken(A.CELL)):this.addToken(A.COLUMN)):Et(this.peek())?(this.getDigits(),this.addToken(A.ROW)):this.addIdentifier();break}case"r":case"R":{if(this.matchR1C1(),this.match("C")||this.match("c")){this.matchR1C1();const r=this.list.slice(this.start,this.current).join("").toUpperCase();this.tokens.push(new ot(A.R1C1,r))}else this.addIdentifier();break}case"(":this.addToken(A.LEFT_BRACKET);break;case")":this.addToken(A.RIGHT_BRACKET);break;case",":this.addToken(A.COMMA);break;case":":this.addToken(A.COLON);break;case Ie:this.addToken(A.EQUAL);break;case"<":this.match(">")?this.addToken(A.NOT_EQUAL):this.match("=")?this.addToken(A.LESS_EQUAL):this.addToken(A.LESS);break;case">":this.match("=")?this.addToken(A.GREATER_EQUAL):this.addToken(A.GREATER);break;case"+":this.addToken(A.PLUS);break;case"-":this.addToken(A.MINUS);break;case"*":this.addToken(A.STAR);break;case"/":this.addToken(A.SLASH);break;case"^":this.addToken(A.EXPONENT);break;case"&":this.addToken(A.CONCATENATE);break;case"%":this.addToken(A.PERCENT);break;case'"':this.string(t);break;case"'":this.string(t);break;case"!":this.addToken(A.EXCLAMATION);break;case";":this.addToken(A.SEMICOLON);break;case"{":this.addToken(A.lEFT_BRACE);break;case"}":this.addToken(A.RIGHT_BRACE);break;case" ":break;case"\r":case"	":case`
`:break;default:Et(t)?this.number():this.addIdentifier();break}}anyChar(t){return!'(),:=<>+-*/^&%"{}!'.includes(t)&&!this.isWhiteSpace(t)}isWhiteSpace(t){return t===" "||t==="\r"||t===`
`||t==="	"}}class xt{constructor(t,r,n){x(this,"left");x(this,"right");x(this,"operator");this.left=t,this.operator=r,this.right=n}accept(t){return t.visitBinaryExpression(this)}handleConcatenate(t){const r=t.toString();return this.operator.type===A.CONCATENATE&&t instanceof ie&&t.value.type===A.STRING?JSON.stringify(r):r}toString(){const t=this.handleConcatenate(this.left),r=this.handleConcatenate(this.right);return`${t}${this.operator.toString()}${r}`}}class an{constructor(t,r){x(this,"right");x(this,"operator");this.operator=t,this.right=r}accept(t){return t.visitUnaryExpression(this)}toString(){return this.operator.toString()+this.right.toString()}}class cn{constructor(t,r){x(this,"left");x(this,"operator");this.operator=t,this.left=r}accept(t){return t.visitPostUnaryExpression(this)}toString(){return this.left.toString()+this.operator.toString()}}class ie{constructor(t){x(this,"value");this.value=t}accept(t){return t.visitLiteralExpression(this)}toString(){return this.value.toString()}}class _t{constructor(t,r){x(this,"value");x(this,"sheetName");this.value=t,this.sheetName=r}accept(t){return t.visitCellExpression(this)}toString(){const t=this.value.toString().toUpperCase();if(this.sheetName){let r=this.sheetName.toString();return r.includes(" ")&&(r=`'${r}'`),`${r}!${t}`}else return t}}class hn{constructor(t,r){x(this,"name");x(this,"params");this.name=t,this.params=r}accept(t){return t.visitCallExpression(this)}toString(){return`${this.name.toString()}(${this.params.map(t=>t.toString()).join(",")})`}}class ln{constructor(t,r,n){x(this,"right");x(this,"operator");x(this,"left");this.left=t,this.operator=r,this.right=n}accept(t){return t.visitCellRangeExpression(this)}toString(){return this.left.toString()+this.operator.toString()+this.right.toString()}}class un{constructor(t){x(this,"value");this.value=t}accept(t){return t.visitGroupExpression(this)}toString(){return`(${this.value.toString()})`}}class dn{constructor(t){x(this,"value");this.value=t}accept(t){return t.visitArrayExpression(this)}toString(){return`{${this.value.map(r=>r.toString()).join(",")}}`}}class fn{constructor(t){x(this,"tokens");x(this,"current",0);this.tokens=t}parse(){const t=[];for(;!this.isAtEnd();)t.push(this.expression());return t}expression(){return this.comparison()}comparison(){let t=this.concatenate();for(;this.match(A.EQUAL,A.NOT_EQUAL,A.GREATER,A.GREATER_EQUAL,A.LESS,A.LESS_EQUAL);){const r=this.previous(),n=this.concatenate();t=new xt(t,r,n)}return t}concatenate(){let t=this.term();for(;this.match(A.CONCATENATE);){const r=this.previous(),n=this.term();t=new xt(t,r,n)}return t}term(){let t=this.factor();for(;this.match(A.PLUS,A.MINUS);){const r=this.previous(),n=this.factor();t=new xt(t,r,n)}return t}factor(){let t=this.expo();for(;this.match(A.SLASH,A.STAR);){const r=this.previous(),n=this.expo();t=new xt(t,r,n)}return t}expo(){let t=this.unary();for(;this.match(A.EXPONENT);){const r=this.previous(),n=this.unary();t=new xt(t,r,n)}return t}unary(){if(this.match(A.PLUS,A.MINUS)){const t=this.previous(),r=this.unary();return new an(t,r)}return this.postUnary()}postUnary(){let t=this.cellRange();if(this.match(A.PERCENT)){const r=this.previous();t=new cn(r,t)}return t}cellRange(){let t=this.sheetRange();for(;this.match(A.COLON);){const r=this.previous(),n=this.sheetRange(),s=this.convertToCellExpression(n),o=this.convertToCellExpression(t);t=new ln(o,r,s)}return t}convertToCellExpression(t){if(t instanceof _t)return t;if(t instanceof ie&&t.value.type===A.NUMBER)return new _t(t.value,void 0);throw new G("#NAME?")}sheetRange(){if(this.match(A.SHEET_NAME)){const t=this.previous();let r=this.call();if(r instanceof _t)return new _t(r.value,t);throw new G("#REF!")}return this.call()}call(){for(;this.match(A.EXCEL_FUNCTION,A.REF_FUNCTION,A.REF_FUNCTION_COND);){const t=this.previous(),r=[];if(!this.check(A.RIGHT_BRACKET))do{if(this.peek().type==A.RIGHT_BRACKET)break;r.push(this.expression())}while(this.match(A.COMMA));return this.expect(A.RIGHT_BRACKET),new hn(t,r)}return this.primary()}primary(){if(this.match(A.lEFT_BRACE)){const t=[];do{if(this.peek().type==A.RIGHT_BRACE)break;t.push(this.expression())}while(this.match(A.COMMA));return this.expect(A.RIGHT_BRACE),new dn(t)}if(this.match(A.LEFT_BRACKET)){const t=this.expression();return this.expect(A.RIGHT_BRACKET),new un(t)}if(this.match(A.NUMBER,A.STRING,A.BOOL))return new ie(this.previous());if(this.match(A.CELL,A.COLUMN,A.ROW,A.DEFINED_NAME,A.R1C1)){const t=this.previous();return new _t(t,void 0)}throw this.match(A.ERROR,A.ERROR_REF)?new G(this.previous().value):new G("#VALUE!")}match(...t){const{type:r}=this.peek();return t.includes(r)?(this.next(),!0):!1}previous(){return this.tokens[this.current-1]}check(t){return this.peek().type===t}expect(t){if(this.check(t))return this.next(),this.previous();throw new G("#VALUE!")}next(){this.current++}isAtEnd(){return this.peek().type===A.EOF}peek(){return this.current<this.tokens.length?this.tokens[this.current]:new ot(A.EOF,"")}}class En{constructor(t,r,n){x(this,"expressions");x(this,"cellDataMap");x(this,"currentCoord");this.expressions=t,this.cellDataMap=n,this.currentCoord=r}interpret(){let t=[];for(const r of this.expressions){const n=this.evaluate(r),s=this.getRangeCellValue(n);Array.isArray(s)?t=t.concat(s):t.push(s)}return t}visitBinaryExpression(t){let r=this.evaluate(t.left),n=this.evaluate(t.right);switch(r=this.getOneValue(r),n=this.getOneValue(n),[A.MINUS,A.PLUS,A.SLASH,A.STAR,A.EXPONENT].includes(t.operator.type)&&(r=this.parseNumber(r),n=this.parseNumber(n)),t.operator.type){case A.MINUS:return r-n;case A.PLUS:return r+n;case A.SLASH:{if(n===0)throw new G("#DIV/0!");return r/n}case A.STAR:return r*n;case A.EXPONENT:return Math.pow(r,n);case A.EQUAL:return r===n;case A.NOT_EQUAL:return r!==n;case A.GREATER:return r>n;case A.GREATER_EQUAL:return r>=n;case A.LESS:return r<n;case A.LESS_EQUAL:return r<=n;case A.CONCATENATE:return`${r}${n}`;default:throw new G("#TEXT")}}visitCallExpression(t){const r=this.cellDataMap.getFunction(t.name.value);if(r&&typeof r=="function"){let n=[];for(const s of t.params){const o=this.evaluate(s);if(o instanceof ht){const d=this.getCellValue(o,!1);n=n.concat(d)}else n.push(o)}return r(...n)}throw new G("#NAME?")}visitCellExpression(t){let r="";if(t.sheetName){const s=this.cellDataMap.getSheetInfo("",t.sheetName.value);if(!(s!=null&&s.sheetId))throw new G("#REF!");r=s.sheetId}let n;if([A.DEFINED_NAME,A.CELL,A.COLUMN,A.R1C1].includes(t.value.type)&&(n=this.cellDataMap.getDefinedName(t.value.value)),n||(t.value.type===A.R1C1?n=sn(t.value.value,this.currentCoord):n=nn(t.value.value)),!n)throw new G("#REF!");return r&&(n.sheetId=r),n}visitLiteralExpression(t){const{type:r,value:n}=t.value;switch(r){case A.STRING:return n;case A.NUMBER:{const[s,o]=zt(n);if(s)return o;throw new G("#VALUE!")}case A.BOOL:return n==="TRUE";default:throw new G("#VALUE!")}}visitUnaryExpression(t){const r=this.evaluate(t.right),n=this.parseNumber(this.getOneValue(r));switch(t.operator.type){case A.MINUS:return-n;case A.PLUS:return n;default:throw new G("#VALUE!")}}visitCellRangeExpression(t){switch(t.operator.type){case A.COLON:{const r=this.visitCellExpression(t.left),n=this.visitCellExpression(t.right),s=Ge(r,n);if(!s)throw new G("#NAME?");return s}default:throw new G("#NAME?")}}visitGroupExpression(t){return this.evaluate(t.value)}visitArrayExpression(t){const r=[];for(const n of t.value)r.push(this.evaluate(n));return r}visitPostUnaryExpression(t){const r=this.evaluate(t.left),n=this.parseNumber(this.getOneValue(r));switch(t.operator.type){case A.PERCENT:return n*.01;default:throw new G("#VALUE!")}}evaluate(t){return t.accept(this)}getRangeCellValue(t){if(t instanceof ht){if(t.colCount===t.rowCount&&t.colCount===1)return this.getCellValue(t,!0);throw new G("#REF!")}return t}getOneValue(t){const r=this.getRangeCellValue(t);return Array.isArray(r)?r[0]:r}parseNumber(t){const[r,n]=zt(t);if(!r)throw new G("#VALUE!");return n}getCellValue(t,r){let n=[];if(r){const p=this.cellDataMap.getCell(t),f=this.cellDataMap.handleCell(p,{row:t.row,col:t.col});return n=n.concat(f),n}const{row:s,col:o,sheetId:d}=t,C=this.cellDataMap.getSheetInfo(d);if(!C||s>=C.rowCount||o>=C.colCount)throw new G("#REF!");return en(t,C.rowCount,C.colCount,(p,f)=>{const g=this.cellDataMap.getCell({row:p,col:f,rowCount:1,colCount:1,sheetId:d}),M=this.cellDataMap.handleCell(g,{row:p,col:f});return n=n.concat(M),!1}),n}}function We(e="normal",t="normal",r=Xt,n=""){const s=`${e} ${t} ${r}px `,o=[Or];return n&&o.unshift(n),s+o.join(",")}let oe;function Yt(e=typeof devicePixelRatio>"u"?void 0:devicePixelRatio){return typeof oe=="number"?oe:Math.max(Math.floor(e||1),1)}function $(e){return Math.floor(e*Yt())}function gn(e){oe=Math.max(Math.floor(e||1),1)}const Nt=class Nt{constructor(t){x(this,"namespace");x(this,"init",()=>(this.setColor(),this.log));x(this,"log",(...t)=>{if(!this.enable())return;const{namespace:r}=this,n=Nt.colorMap.get(r),s=[`%c ${r}:`,`color:${n};`,...t];console.log(...s)});x(this,"getRandomColor",()=>{const t=Math.floor(Math.random()*Le.length);return Le[t]});this.namespace=t}enable(){return window.localStorage.getItem("debug")==="*"}setColor(){Nt.colorMap.has(this.namespace)||Nt.colorMap.set(this.namespace,this.getRandomColor())}};x(Nt,"colorMap",new Map);let vt=Nt;new vt("model").init(),new vt("react").init(),new vt("collaboration").init();const Cn={smallFont:"10px",font:"12px",largeFont:"14px",padding:"12px",lineHeight:1.5,mediumPadding:"8px",largePadding:"20px",borderRadius:"4px",borderLargeRadius:"8px",tinyPadding:"4px",scrollBarContent:"30px",formulaBarHeight:"25px"},An={lowZIndex:2,middleZIndex:3,highZIndex:4,highestZIndex:9};function pn(e,t,r,n){t=t/100,r=r/100;const s=(1-Math.abs(2*r-1))*t,o=s*(1-Math.abs(e/60%2-1)),d=r-s/2;let C,p,f;if(e>=0&&e<60?(C=s,p=o,f=0):e>=60&&e<120?(C=o,p=s,f=0):e>=120&&e<180?(C=0,p=s,f=o):e>=180&&e<240?(C=0,p=o,f=s):e>=240&&e<300?(C=o,p=0,f=s):(C=s,p=0,f=o),n!==1)return`rgba(${C},${p},${f},${n})`;const g=k=>Math.round(k*255).toString(16).padStart(2,"0"),M=g(C+d),O=g(p+d),I=g(f+d);return`#${M}${O}${I}`}const wn=(e,t,r)=>{const n=e/255,s=t/255,o=r/255,d=Math.min(n,s,o),C=Math.max(n,s,o),p=C-d,f=mn(n,s,o),g=Sn(C,d),M=Rn(p,g);return[f,M*100,g*100]},mn=(e,t,r)=>{const n=Math.max(e,t,r),s=Math.min(e,t,r),o=n-s;let d=0;if(o==0)d=0;else switch(n){case e:{let f=(t-r)/o,g=0;f<0&&(g=360/60),d=f+g;break}case t:{let f=(r-e)/o,g=120/60;d=f+g;break}case r:let C=(e-t)/o,p=240/60;d=C+p;break}return d*60},Rn=(e,t)=>e==0?0:e/(1-Math.abs(2*t-1)),Sn=(e,t)=>(e+t)/2,ze=([e,t,r,n])=>{const[s,o,d]=wn(e,t,r);return pn(s,o*.9,100-d,n)};function Mn(e){e.startsWith("#")&&(e=e.slice(1));let t=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16),s=parseInt(e.substring(6,8)||"ff",16);return[t,r,n,s/255]}const Nn=e=>{if(e.startsWith("rgb")){const r=e.replace("rgb","").replace("a","").replace("(","").replace(")","").split(",").map(Number);return r.length<=3&&r.push(1),ze(r)}else return ze(Mn(e))},Ye=Object.freeze({primaryColor:"#217346",buttonActiveColor:"#c6c6c6",selectionColor:"rgba(198,198,198,0.3)",backgroundColor:"#e6e6e6",hoverColor:"rgba(0, 0, 0, 0.04)",scrollbarColor:"rgba(0, 0, 0, 0.1)",scrollbarHoveColor:"rgba(0, 0, 0, 0.2)",dialogBackground:"rgba(0, 0, 0, 0.6)",white:"#ffffff",black:"#000000",triangleFillColor:"#dddddd",contentColor:"#333333",borderColor:"#cccccc",activeBorderColor:"#808080",errorFormulaColor:"#ff0000"}),On=Object.freeze(Object.fromEntries(Object.entries(Ye).map(([e,t])=>[e,Nn(t)]))),ae={...Cn,...An},In="data-theme";function Tn(){if(typeof sessionStorage<"u"){const e=sessionStorage.getItem(In);if(e&&(e==="dark"||e==="light"))return e}return typeof matchMedia=="function"&&matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function j(e,t){return t==="dark"||Tn()==="dark"?On[e]:Ye[e]}var bn={copy:"Copy",cut:"Cut",paste:"Paste",delete:"Delete",add:"Add",rows:"Rows",menu:"Menu",file:"File",insert:"Insert",rename:"Rename",reset:"Reset",hide:"Hide",unhide:"Unhide",cancel:"Cancel","line-chart":"Line Chart","bar-chart":"Bar Chart","pie-chart":"Pie Chart","scatter-chart":"Scatter Chart","radar-chart":"Radar Chart","polar-area-chart":"PolarArea Chart",confirm:"Confirm","tab-color":"Tab Color","unhide-sheet":"Unhide sheet:","wrap-text":"Wrap Text","import-xlsx":"Import XLSX","export-xlsx":"Export XLSX","export-csv":"Export CSV","export-json":"Export JSON","import-csv":"Import CSV","floating-picture":"Floating Picture",chart:"Chart","chart-title":"Chart Title",duplicate:"Duplicate","select-data":"Select Data","change-chart-title":"Change Chart Title","change-chart-type":"Change Chart Type","save-as-picture":"Save as Picture","reset-size":"Reset Size","add-at-the-bottom":"Add at the bottom","row-height":"Row Height","column-width":"Column Width","greater-than-zero":"The value must be greater than or equal to 0","insert-columns":"Insert Columns","delete-columns":"Delete Columns","hide-columns":"Hide Columns","unhide-columns":"Unhide Columns","insert-rows":"Insert Rows","delete-rows":"Delete Rows","hide-rows":"Hide rows","unhide-rows":"Unhide rows","reference-is-empty":"The reference is empty","reference-is-not-valid":"The reference is not valid","the-value-cannot-be-empty":"The value cannot be empty","edit-data-source":"Edit Data Source","sheet-is-not-exist":"The sheet is not exist","sheet-id-is-duplicate":"The sheet id is duplicate","a-workbook-must-contains-at-least-one-visible-worksheet":"A workbook must contains at least one visible worksheet","sheet-name-is-duplicate":"The sheet name is duplicate","uuid-is-duplicate":"The uuid is duplicate","cells-must-contain-data":"The selected cells must contain the data","image-source-is-empty":"The image source is empty","merging-cell-is-duplicate":"The merging cell is duplicate","insert-column-left":"Insert Column Left","insert-column-right":"Insert Column Right","insert-row-above":"Insert Row Above","insert-row-below":"Insert Row Below","get-all-installed-fonts":"Get all the fonts installed locally","unsupported-chart-types":"Unsupported chart types","merge-cell":"Merge","merge-and-center":"Merge and Center","merge-cells":"Merge Cells","merge-content":"Merge Content",none:"none","single-underline":"single underline","double-underline":"double underline",general:"General",number:"Number",currency:"Currency",accounting:"Accounting","short-date":"Short Date","long-date":"Long Date",time:"Time",percentage:"Percentage",fraction:"Fraction",scientific:"Scientific",text:"Text","more-number-formats":"More Number Formats","short-date-format":"m/d/yyyy;@","long-date-format":"[$-409]dddd,mmmm d,yyyy;@","time-format":"h:mm:ss AM/PM","sheet-id-can-not-be-empty":"The sheetId can not be empty","no-border":"No Border","all-borders":"All Borders","outside-borders":"OutSide Borders","thick-box-border":"Thick Box Border","bottom-border":"Bottom Border","top-border":"Top Border","left-border":"Left Border","right-border":"Right Border","line-color":"Line Color","line-style":"Line Style",filter:"Filter","filter-empty":"(empty)","filter-all":"All"},Dn={copy:"复制",cut:"剪切",paste:"粘贴",delete:"删除",add:"添加",rows:"行",menu:"菜单",file:"文件",insert:"插入",rename:"重命名",reset:"重置",hide:"隐藏",unhide:"显示",cancel:"取消","line-chart":"折线图","bar-chart":"柱状图","pie-chart":"饼图","scatter-chart":"散点图","radar-chart":"雷达图","polar-area-chart":"极区图",confirm:"确认","tab-color":"选项卡颜色","unhide-sheet":"显示工作表:","wrap-text":"自动换行","import-xlsx":"导入 XLSX","export-xlsx":"导出 XLSX","export-csv":"导出 CSV","export-json":"导出 JSON","import-csv":"导入 CSV","floating-picture":"浮动图片",chart:"图表","chart-title":"图表标题",duplicate:"复制","select-data":"选择数据","change-chart-title":"更改图表标题","change-chart-type":"更改图表类型","save-as-picture":"保存为图片","reset-size":"重置大小","add-at-the-bottom":"在底部添加","row-height":"行高","column-width":"列宽","greater-than-zero":"值必须大于或等于 0","insert-columns":"插入列","delete-columns":"删除列","hide-columns":"隐藏列","unhide-columns":"取消隐藏列","insert-rows":"插入行","delete-rows":"删除行","hide-rows":"隐藏行","unhide-rows":"取消隐藏行","reference-is-empty":"引用为空","reference-is-not-valid":"引用无效","the-value-cannot-be-empty":"值不能为空","edit-data-source":"编辑数据源","sheet-id-is-duplicate":"工作表 ID 重复","a-workbook-must-contains-at-least-one-visible-worksheet":"工作簿必须至少包含一个可见工作表","sheet-name-is-duplicate":"工作表名称重复","uuid-is-duplicate":"UUID 重复","cells-must-contain-data":"所选单元格必须包含数据","image-source-is-empty":"图像源为空","merging-cell-is-duplicate":"合并单元格重复","insert-column-left":"向左插入列","insert-column-right":"向右插入列","insert-row-above":"在上面插入行","insert-row-below":"在下面插入行","get-all-installed-fonts":"获取本地安装的所有字体","unsupported-chart-types":"不支持的图表类型","merge-cell":"合并单元格","merge-and-center":"合并并且居中","merge-cells":"合并单元格","merge-content":"合并内容",none:"无","single-underline":"单层下划线","double-underline":"双层下划线",general:"常规",number:"数值",currency:"货币",accounting:"会计专用","short-date":"短日期","long-date":"长日期",time:"时间",percentage:"百分比",fraction:"分数",scientific:"科学计数",text:"文本","more-number-formats":"其他数字格式","short-date-format":"yyyy/m/d;@","long-date-format":'yyyy"年"m"月"d"日"',"time-format":"h:mm:ss","sheet-id-can-not-be-empty":"SheetId 不能为空","no-border":"无边框","all-borders":"全边框","outside-borders":"外边框","thick-box-border":"厚框边框","bottom-border":"底边框","top-border":"顶边框","left-border":"左边框","right-border":"右边框","line-color":"线条颜色","line-style":"线条样式",filter:"筛选","filter-empty":"(空)","filter-all":"全部","sheet-is-not-exist":"工作表不存在"};let Ln="language";const Ke=["en","zh"];function xn(){const e="en";if(typeof window>"u")return e;let t=e;const r=localStorage.getItem(Ln);if(r&&Ke.some(n=>n===r))t=r;else{const n=(navigator==null?void 0:navigator.language)||"",s=Ke.find(o=>n.includes(o));s&&(t=s)}return document.documentElement.setAttribute("lang",t),t}function Q(e){return xn()==="en"?bn[e]:Dn[e]}Q("line-chart"),Q("bar-chart"),Q("pie-chart"),Q("scatter-chart"),Q("radar-chart"),Q("polar-area-chart");const _n=[{formatCode:Wt,id:0},{formatCode:"0",id:1},{formatCode:"0.00",id:2},{formatCode:"#,##0",id:3},{formatCode:"#,##0.00",id:4},{formatCode:'"$"#,##0.00_);[Red]("$"#,##0.00)',id:8},{formatCode:"0%",id:9},{formatCode:"0.00%",id:10},{formatCode:"0.00E+00",id:11},{formatCode:"# ?/?",id:12},{formatCode:"# ??/??",id:13},{formatCode:"mm-dd-yy",id:14},{formatCode:"d-mmm-yy",id:15},{formatCode:"d-mmm",id:16},{formatCode:"mmm-yy",id:17},{formatCode:"h:mm AM/PM",id:18},{formatCode:"h:mm:ss AM/PM",id:19},{formatCode:"h:mm",id:20},{formatCode:"h:mm:ss",id:21},{formatCode:"m/d/yy h:mm",id:22},{formatCode:'yyyy"年"m"月"',id:27},{formatCode:"#,##0 ;(#,##0)",id:37},{formatCode:"#,##0 ;[Red](#,##0)",id:38},{formatCode:"#,##0.00 ;(#,##0.00)",id:39},{formatCode:"#,##0.00 ;[Red](#,##0.00)",id:40},{formatCode:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',id:44},{formatCode:"mm:ss",id:45},{formatCode:"[h]:mm:ss",id:46},{formatCode:"mmss.0",id:47},{formatCode:"##0.0E+0",id:48},{formatCode:Tr,id:49},{formatCode:'上午/下午 h"时"mm"分"ss"秒"',id:56}],gt=e=>_n.find(t=>t.id===e).formatCode;gt(0),Q("general"),gt(2),Q("number"),gt(8),Q("currency"),gt(44),Q("accounting"),Q("short-date-format"),Q("short-date"),Q("long-date-format"),Q("long-date"),Q("time-format"),Q("time"),gt(10),Q("percentage"),gt(12),Q("fraction"),gt(11),Q("scientific"),gt(49),Q("text");function Qe(e,t={row:0,col:0},r=new vn,n=new Map){if(n.has(e)){const s=n.get(e);return s.result.length===0?{result:[0]}:s}try{r.handleCell=(f,g)=>f?f.formula?Qe(f.formula,g,r,n).result:[f.value]:[];const s={result:[],expressionStr:""};n.set(e,s);const o=new on(e).scan(),d=new fn(o).parse(),C=new En(d,t,r).interpret(),p=[];for(const f of d)p.push(f.toString());s.expressionStr=p.join("");for(const f of C)typeof f=="number"&&!isNaN(f)?s.result.push(jr(f)):s.result.push(f);return s}catch(s){if(s instanceof G){const o={result:[s.value]};return n.set(e,o),o}throw s}}const ce="_test_";class vn{constructor(){x(this,"map",new Map);x(this,"definedNameMap",new Map);x(this,"currentSheetId",ce);x(this,"sheetList",[{sheetId:ce,name:"_test_",rowCount:200,colCount:30,isHide:!1,sort:1}]);x(this,"getFunction",t=>He[t]);x(this,"handleCell",(t,r)=>t?[t.value]:[])}getKey(t,r,n){return`${t}_${r}_${n||ce}`}setSheetList(t){this.sheetList=t}set(t,r){const{row:n,col:s,sheetId:o}=t;for(let d=0;d<r.length;d++)for(let C=0;C<r[d].length;C++){const p=this.getKey(n+d,s+C,o),f=r[d][C];typeof f=="string"&&Ur(f)?this.map.set(p,{formula:f,value:""}):this.map.set(p,{value:f})}}getCell(t){const{row:r,col:n,sheetId:s}=t,o=this.getKey(r,n,s);return this.map.get(o)}getSheetInfo(t,r){if(r)return this.sheetList.find(s=>s.name===r);const n=t||this.currentSheetId;return this.sheetList.find(s=>s.sheetId===n)}setDefinedName(t,r){const n=ht.makeRange(r);this.definedNameMap.set(t,n)}getDefinedName(t){return this.definedNameMap.get(t)}}function Fn(e,t){const{currentSheetId:r,worksheets:n,workbook:s,definedNames:o}=e,d=new Map,C={list:[]},p={handleCell:()=>[],getFunction:f=>He[f],getCell:f=>{const{row:g,col:M,sheetId:O}=f,I=xe(O||r,g,M);return n[I]},set:()=>{throw new G("#REF!")},getSheetInfo:(f,g)=>{if(g)return s.find(O=>O.name===g);const M=f||r;return s.find(O=>O.sheetId===M)},setDefinedName:()=>{throw new G("#REF!")},getDefinedName:f=>{const g=o[f];return g&&ht.makeRange(g)}};for(const[f,g]of Object.entries(n)){const M=Fr(f);if(!M||M.sheetId!==r||!(g!=null&&g.formula))continue;const O=Qe(g==null?void 0:g.formula,vr(f),p,d);if(!O)continue;const I=O.result[0];I!==g.value&&C.list.push({key:f,newValue:I,sheetId:r})}return t(C)}function je(e){return e?typeof Intl>"u"||typeof Intl.Segmenter!="function"?[...e]:[...new Intl.Segmenter([],{granularity:"word"}).segment(e)].map(n=>n.segment):[]}const he=new Map;function Un(e,t){const r=`${t}__${e.font}`;if(he.has(r))return he.get(r);const n=e.measureText(t),{actualBoundingBoxAscent:s,actualBoundingBoxDescent:o}=n,d=s+o,C=n.width,p=Math.ceil(C/Yt()),f=Math.ceil(d/Yt()),g={width:p,height:f};return he.set(r,g),g}function st(e,t,r,n,s){e.fillRect($(t),$(r),$(n),$(s))}function le(e,t,r,n,s){e.strokeRect($(t),$(r),$(n),$(s))}function Ze(e,t,r,n,s){e.clearRect($(t),$(r),$(n),$(s))}function ue(e,t,r,n){e.fillText(t,$(r),$(n))}function Ct(e,t){if(t.length!==0){e.beginPath();for(let r=0;r<t.length;r+=2){const n=t[r],s=t[r+1];e.moveTo($(n[0]),$(n[1])),e.lineTo($(s[0]),$(s[1]))}e.stroke()}}function Je(e,t,r,n){e.beginPath(),e.moveTo($(t[0]),$(t[1])),e.lineTo($(r[0]),$(r[1])),e.lineTo($(n[0]),$(n[1])),e.fill()}function qe(e,t,r){const n=e.slice(),[s,o]=e,d=F*2,C=r?d:0;return t==="bottom"?n.push([s[0]+C,s[1]-d],[o[0]-C,o[1]-d]):t==="top"?n.push([s[0]+C,s[1]+d],[o[0]-C,o[1]+d]):t==="left"?n.push([s[0]+d,s[1]+C],[o[0]+d,o[1]-C]):t==="right"&&n.push([s[0]-d,s[1]+C],[o[0]-d,o[1]-C]),n}function kn(e,t,r){return r?t?e.split(ee):je(e.replaceAll(ee,"")):je(e)}function Pn(e,t,r,n,s){e.setLineDash([$(8),$(6)]);const o=F;le(e,t+o,r+o,n-o*2,s-o*2),e.setLineDash([])}function $n(e){let t=[];return e==="hair"?t=[F,F]:e==="dotted"||e==="mediumDashed"?t=[F*2,F*2]:e==="dashed"?t=[F*4,F*4]:e==="dashDot"||e==="mediumDashDot"?t=[F*4,F*4,F*8,F*4]:(e==="dashDotDot"||e==="mediumDashDotDot")&&(t=[F*4,F*4,F*8,F*4,F*4,F*4]),t}function Kt(e,t,r,n,s){if(!r)return;const{top:o,left:d,width:C,height:p}=t;let f=[];n==="top"?f=[[d,o],[d+C,o]]:n==="bottom"?f=[[d,o+p],[d+C,o+p]]:n==="left"?f=[[d,o],[d,o+p]]:n==="right"&&(f=[[d+C,o],[d+C,o+p]]);const{type:g,color:M}=r;e.lineWidth=De[g],e.strokeStyle=M||j("black",s);const O=$n(g);g==="double"&&(f=qe(f,n,!0)),O.length>0&&e.setLineDash(O.map(I=>$(I))),Ct(e,f),O.length>0&&e.setLineDash([])}function Bn(e,t,r,n,s){const o=r.value,d={height:0,width:0};if(o==="")return d;const C=(r==null?void 0:r.numberFormat)||Wt,p=C===Wt&&typeof o=="number",f=Ue(o,C),g=r!=null&&r.fontSize?r.fontSize:Xt,M=We(r!=null&&r.isItalic?"italic":"normal",r!=null&&r.isBold?"bold":"500",$(g),r==null?void 0:r.fontFamily);r!=null&&r.fillColor&&(e.fillStyle=r==null?void 0:r.fillColor,st(e,t.left,t.top,t.width,t.height));let O=(r==null?void 0:r.fontColor)||j("contentColor",s);be.has(f)&&(O=j("errorFormulaColor",s)),e.font=M,e.fillStyle=O;const I={...r};let k=I==null?void 0:I.horizontalAlign;(I==null?void 0:I.horizontalAlign)===void 0&&p&&(k=Vt.RIGHT),I.horizontalAlign=k;const X=(!(I!=null&&I.isWrapText)&&Hr(C)?[f]:kn(f,r==null?void 0:r.isWrapText,n)).map(lt=>{const rt=Un(e,lt);return{str:lt,width:rt.width,height:rt.height===0?g:rt.height}}),{width:Z,height:L,resultList:it}=Hn(X,t,I,kr(!!n,f));if(Z>0&&L>0){const lt=Math.ceil(g*(ae.lineHeight-1)/2);let rt=[];for(const z of it){if(ue(e,z.text,z.x,z.y),I!=null&&I.underline){e.strokeStyle=O;const At=z.y+z.height+lt/2,Qt=[[z.x,At],[z.x+z.width,At]];(I==null?void 0:I.underline)===me.DOUBLE?rt=rt.concat(qe(Qt,"bottom",!1)):rt=rt.concat(Qt)}if(I!=null&&I.isStrike){e.strokeStyle=O;const At=z.y+z.height/2+lt/2;rt=rt.concat([[z.x,At],[z.x+z.width,At]])}}Ct(e,rt)}return d.height=Math.ceil(L),d.width=Math.ceil(Z),d}function Hn(e,t,r,n){const s=r!=null&&r.fontSize?r.fontSize:Xt,o=Math.ceil(s*(ae.lineHeight-1)/2),d=(r==null?void 0:r.verticalAlign)??Gt.MIDDLE,{left:C,top:p,height:f}=t,g=Math.max(t.width,...e.map(k=>k.width)),M=[];let O=0,I=0;if(r!=null&&r.isWrapText&&n){let k=0;for(let V=0;V<e.length;V++){const H=e[V];O=Math.max(O,H.width);const X=H.height+o*2;I+=X,M.push({text:H.str,x:0,y:k,width:H.width,height:H.height}),k+=X}}else if(r!=null&&r.isWrapText){let k=0;for(let V=0;V<e.length;){let H=g,X="",Z=0,L=0;for(;V<e.length;){const it=e[V];if(H>=it.width)Z+=it.width,L=Math.max(L,it.height),H-=it.width,X+=it.str,V++;else break}if(X){O=Math.max(O,Z);const it=L+o*2;I+=it,M.push({text:X,x:0,y:k,width:Z,height:L}),k+=it}}}else{let k="",V=g;for(let H=0;H<e.length;H++){const X=e[H];if(V>=X.width)O+=X.width,I=Math.max(I,X.height),k+=X.str,V-=X.width;else break}M.push({text:k,x:0,y:0,width:O,height:I})}if(I=Math.max(I,s*ae.lineHeight),O+=o,I+=o,O<=g&&I<=f){let k=C+o,V=p+(f-I)/2+o;d===Gt.TOP?V=p+o:d===Gt.BOTTOM&&(V=p+(f-I)+o),(r==null?void 0:r.horizontalAlign)===Vt.CENTER?k=C+(g-O)/2:(r==null?void 0:r.horizontalAlign)===Vt.RIGHT&&(k=C+(g-O)-o);for(const H of M)H.x=H.x+k,H.y=H.y+V}return{width:O,height:I,resultList:M}}function tr(e){return{textAlign:"center",textBaseline:"middle",font:We(void 0,"500",$(Xt)),fillStyle:j("black",e),lineWidth:F,strokeStyle:j("borderColor",e)}}const er=Math.max(...Object.values(De));class yn{constructor(t){x(this,"canvas");x(this,"ctx");x(this,"width",0);x(this,"height",0);x(this,"isRendering",!1);x(this,"rowMap",{});x(this,"colMap",{});x(this,"eventData",{theme:"light",sheetData:{},canvasSize:{top:0,left:0,width:0,height:0},headerSize:{width:0,height:0},currentSheetInfo:{isHide:!1,rowCount:0,colCount:0,name:"",sheetId:"",tabColor:"",sort:1},scroll:{row:0,col:0,top:0,left:0,scrollLeft:0,scrollTop:0},range:{row:0,col:0,rowCount:1,colCount:1,sheetId:""},copyRange:void 0,customHeight:{},customWidth:{},currentMergeCells:[],autoFilter:void 0});this.canvas=t,this.ctx=t.getContext("2d");const r=Yt();this.ctx.scale(r,r)}render(t){if(t.changeSet.size===0||this.isRendering)return;this.isRendering=!0,this.eventData=t,this.clear();const{ctx:r}=this;r.strokeStyle=j("primaryColor",t.theme),r.fillStyle=j("white",t.theme),r.lineWidth=F*2;const{width:n,height:s}=this.eventData.canvasSize,o=this.eventData.headerSize,{endRow:d,contentHeight:C}=this.renderRowsHeader(s),{endCol:p,contentWidth:f}=this.renderColsHeader(n);this.renderGrid(n-o.width,s-o.height),this.renderTriangle(),this.renderMergeCell(),this.ctx.fillStyle=j("selectionColor",this.eventData.theme);const g=this.renderSelection({endRow:d,endCol:p,contentHeight:C,contentWidth:f});return this.renderAntLine(g),this.renderContent({endRow:d,endCol:p,contentHeight:C,contentWidth:f}),this.ctx.lineWidth=er,le(this.ctx,g.left,g.top,g.width,g.height),this.isRendering=!1,{rowMap:{...this.rowMap},colMap:{...this.colMap}}}resize(t){this.width=t.width,this.height=t.height,this.canvas.width=$(t.width),this.canvas.height=$(t.height)}clear(){Ze(this.ctx,0,0,this.width,this.height)}renderRowsHeader(t){const{row:r}=this.eventData.scroll,n=this.eventData.headerSize,{rowCount:s}=this.eventData.currentSheetInfo;this.ctx.save();const o=this.eventData.range;st(this.ctx,0,n.height,n.width,t),Object.assign(this.ctx,tr(this.eventData.theme));const d=[];let C=n.height,p=r;for(;p<s&&C<t;p++){const g=this.getRowHeight(p);let M=C;if(p===r&&(M+=F/2),d.push([0,M],[n.width,M]),g>0){const O=this.isHighlightRow(o,p);this.ctx.fillStyle=O?j("primaryColor",this.eventData.theme):j("black",this.eventData.theme),ue(this.ctx,String(p+1),n.width/2,M+g/2)}C+=g}d.push([0,C],[n.width,C]),d.push([0,0],[0,C]),Ct(this.ctx,d),this.ctx.restore();const f=p>=s?C:t;return{endRow:p,contentHeight:Math.floor(f)}}renderColsHeader(t){const{col:r,row:n}=this.eventData.scroll,s=this.eventData.headerSize,{colCount:o}=this.eventData.currentSheetInfo,d=this.eventData.range,C=[];this.ctx.save(),st(this.ctx,s.width,0,t,s.height),Object.assign(this.ctx,tr());let p=s.width,f=r;const g=this.eventData.autoFilter;let M=0;for(let I=n;I<this.eventData.currentSheetInfo.rowCount&&(M=this.getRowHeight(n),M===0);I++);for(;f<o&&p<=t;f++){const I=this.getColWidth(f);let k=p;if(f===r&&(k+=F/2),C.push([k,0],[k,s.height]),I>0){const V=this.isHighlightCol(d,f);this.ctx.fillStyle=V?j("primaryColor",this.eventData.theme):j("black",this.eventData.theme),ue(this.ctx,Jr(f),k+I/2,s.height/2)}g&&f>=g.range.col&&f<g.range.col+g.range.colCount&&this.renderFilter(p+I,s.height+M,g.col===f),p+=I}C.push([p,0],[p,s.height]),C.push([0,0],[p,0]),Ct(this.ctx,C),this.ctx.restore();const O=f>=o?p:t;return{endCol:f,contentWidth:Math.floor(O)}}renderFilter(t,r,n){const s=Ir,o=F*4,d=t-s-o,C=r-s-o;this.ctx.fillStyle=n?j("primaryColor",this.eventData.theme):j("borderColor",this.eventData.theme),this.ctx.strokeStyle=n?j("primaryColor",this.eventData.theme):j("borderColor",this.eventData.theme),le(this.ctx,d,C,s,s),Je(this.ctx,[d+s/4,C+s*3/8],[d+s*3/4,C+s*3/8],[d+s/2,C+s*5/8])}renderGrid(t,r){const n=this.eventData.headerSize,{row:s,col:o}=this.eventData.scroll,{rowCount:d,colCount:C}=this.eventData.currentSheetInfo;this.ctx.save(),this.ctx.lineWidth=F,this.ctx.strokeStyle=j("borderColor",this.eventData.theme),this.ctx.translate($(n.width),$(n.height));const p=[];let f=0,g=0;for(let M=s;M<d&&f<=r;M++){for(;M<d&&this.getRowHeight(M)===0;)M++;p.push([0,f],[t,f]);const O=this.getRowHeight(M);f+=O}for(let M=o;M<C&&g<=t;M++){for(;M<C&&this.getColWidth(M)===0;)M++;p.push([g,0],[g,f]);const O=this.getColWidth(M);g+=O}p.push([0,f],[g,f]),p.push([g,0],[g,f]),Ct(this.ctx,p),this.ctx.restore()}renderTriangle(){const t=this.eventData.headerSize;this.ctx.save(),st(this.ctx,0,0,t.width,t.height),this.ctx.fillStyle=j("triangleFillColor",this.eventData.theme);const r=2,n=Math.floor(r),s=Math.floor(t.height-r),o=Math.floor(t.width*.4),d=Math.floor(t.width-r);Je(this.ctx,[d,n],[o,s],[d,s]),this.ctx.restore()}getRowHeight(t){const r=_e(this.eventData.currentSheetInfo.sheetId,t),n=this.eventData.customHeight[r];return n?n.isHide?Me:n.len:Re}getColWidth(t){const r=_e(this.eventData.currentSheetInfo.sheetId,t),n=this.eventData.customWidth[r];return n?n.isHide?Me:n.len:Se}isHighlightRow(t,r){return!!(bt(t)||Lt(t)||r>=t.row&&r<t.row+t.rowCount)}isHighlightCol(t,r){return!!(bt(t)||Dt(t)||r>=t.col&&r<t.col+t.colCount)}renderAntLine(t){const r=this.eventData.copyRange;!r||r.sheetId!==this.eventData.currentSheetInfo.sheetId||(this.ctx.lineWidth=er,this.ctx.strokeStyle=j("primaryColor",this.eventData.theme),Pn(this.ctx,t.left,t.top,t.width,t.height))}renderMergeCell(){const t=this.eventData.currentMergeCells;if(t.length===0)return;const r=this.eventData.range;for(const n of t)r.row===n.row&&r.col===n.col||this.clearRect(n)}getCellSize(t){let{row:r,col:n,colCount:s,rowCount:o}=t,d=r,C=n,p=r+o,f=n+s;const g=this.eventData.currentSheetInfo;bt(t)?(C=0,f=g.colCount,d=0,p=g.rowCount):Lt(t)?(d=0,p=g.rowCount):Dt(t)&&(C=0,f=g.colCount);let M=0,O=0;for(;d<p;d++)O+=this.getRowHeight(d);for(;C<f;C++)M+=this.getColWidth(C);return{width:M,height:O}}computeCellPosition(t){const{row:r,col:n}=t,s=this.eventData.headerSize,o=this.eventData.scroll;let d=s.width,C=s.height,p=o.row,f=o.col;if(n>=o.col)for(;f<n;)d+=this.getColWidth(f),f++;else for(d=-s.width;f>n;)d-=this.getColWidth(f),f--;if(r>=o.row)for(;p<r;)C+=this.getRowHeight(p),p++;else for(C=-s.height;p>r;)C-=this.getRowHeight(p),p--;return{top:C,left:d}}getActiveRange(t){const r=t||this.eventData.range,n=this.eventData.currentMergeCells;for(const s of n)if(tn(r,s))return{range:{...s,sheetId:s.sheetId},isMerged:!0};return{range:r,isMerged:!1}}clearRect(t){const r=this.getCellSize(t);if(r.width<=0||r.height<=0)return;const n=this.computeCellPosition(t),s=F;Ze(this.ctx,n.left+s,n.top+s,r.width-s*2,r.height-s*2)}renderContent(t){const{endCol:r,endRow:n,contentHeight:s,contentWidth:o}=t,{ctx:d}=this;d.textAlign="left",d.textBaseline="top",d.lineWidth=F*2;const C=this.eventData.headerSize,{row:p,col:f}=this.eventData.scroll,g=Math.floor(o-C.width),M=Math.floor(s-C.height);d.save(),this.rowMap={},this.colMap={};const O=this.eventData.currentMergeCells;for(let I=p;I<n;I++)for(let k=f;k<r;k++){const V=O.find(H=>H.row===I&&H.col===k);this.renderCell(I,k,V,g,M)}d.restore()}renderCell(t,r,n,s,o){const{ctx:d}=this,C={row:t,col:r,rowCount:1,colCount:1,sheetId:""},p=xe(this.eventData.currentSheetInfo.sheetId,t,r),f=this.eventData.sheetData[p];if(!f)return;const g=this.getCellSize(n||C);if(g.width<=0||g.height<=0)return;const M=this.computeCellPosition(C);d.lineWidth=F*2;const O=this.eventData.theme,I=Bn(d,{top:M.top,left:M.left,width:Math.min(g.width,s),height:Math.min(g.height,o)},f,!!n,O),k=Math.max(this.rowMap[t]??0,I.height),V=Math.max(this.colMap[r]??0,I.width);k>=Re&&(this.rowMap[t]=k),V>=Se&&(this.colMap[r]=V);const H={top:M.top,left:M.left,height:Math.max(k,g.height),width:Math.max(V,g.width)};Kt(d,H,f.borderTop,"top",O),Kt(d,H,f.borderBottom,"bottom",O),Kt(d,H,f.borderLeft,"left",O),Kt(d,H,f.borderRight,"right",O)}renderSelection(t){const r=this.eventData.range;return bt(r)?this.renderSelectAll(t):Lt(r)?this.renderSelectCol(t):Dt(r)?this.renderSelectRow(t):this.renderSelectRange()}renderSelectRange(){const t=this.eventData.headerSize,r=this.eventData.range,n=this.computeCellPosition({row:r.row,col:r.col,rowCount:1,colCount:1,sheetId:""}),s=r.row+r.rowCount-1,o=r.col+r.colCount-1,d={row:s,col:o,rowCount:1,colCount:1,sheetId:""},C=this.computeCellPosition(d),p=this.getCellSize(d),f=C.left+p.width-n.left,g=C.top+p.height-n.top;st(this.ctx,n.left,0,f,t.height),st(this.ctx,0,n.top,t.width,g);const M=r.rowCount>1||r.colCount>1;M&&st(this.ctx,n.left,n.top,f,g);const O=[[n.left,t.height],[n.left+f,t.height]];return O.push([t.width,n.top],[t.width,n.top+g]),Ct(this.ctx,O),M&&this.renderActiveCell(),{left:n.left,top:n.top,width:f,height:g}}renderSelectAll(t){const{contentHeight:r,contentWidth:n}=t,s=this.eventData.headerSize;st(this.ctx,0,0,n,r),this.renderActiveCell();const o=n-s.width,d=r-s.height;return{left:s.width,top:s.height,width:o,height:d}}renderSelectCol({contentHeight:t}){const r=this.eventData.headerSize,n=this.eventData.range,s=this.computeCellPosition(n);let o=0;for(let p=n.col,f=n.col+n.colCount;p<f;p++)o+=this.getColWidth(p);const d=t-r.height;st(this.ctx,s.left,0,o,t),st(this.ctx,0,s.top,r.width,d);const C=[[r.width,r.height],[r.width,t]];return Ct(this.ctx,C),this.renderActiveCell(),{left:s.left,top:r.height,width:o,height:d}}renderSelectRow({contentWidth:t}){const r=this.eventData.headerSize,n=this.eventData.range,s=this.computeCellPosition(n);let o=0;for(let p=n.row,f=n.row+n.rowCount;p<f;p++)o+=this.getRowHeight(p);const d=t-r.width-F;st(this.ctx,s.left,0,d,r.height),st(this.ctx,0,s.top,t,o);const C=[[s.left,r.height],[t,r.height]];return Ct(this.ctx,C),this.renderActiveCell(),{left:r.width,top:s.top,width:d,height:o}}renderActiveCell(){const t=this.eventData.range,r=this.getActiveRange({row:t.row,col:t.col,rowCount:1,colCount:1,sheetId:t.sheetId}).range;this.clearRect(r)}}let mt=null;qt({init(e){mt=new yn(e.canvas),gn(e.dpr)},resize(e){mt==null||mt.resize(e)},async render(e,t){const r=mt==null?void 0:mt.render(e);r&&await t(r)},async computeFormulas(e,t){return await Fn(e,t)}})})();
//# sourceMappingURL=worker-DsHjpO_5.js.map
