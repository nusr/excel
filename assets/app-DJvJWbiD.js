const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Chart-Bhz-9HqT.js","assets/Chart-BwsaDvT-.css"])))=>i.map(i=>d[i]);
var LI=Object.defineProperty;var FI=(t,e,n)=>e in t?LI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var H=(t,e,n)=>FI(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var cU=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function YS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qS={exports:{}},ef={},KS={exports:{}},xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lc=Symbol.for("react.element"),PI=Symbol.for("react.portal"),$I=Symbol.for("react.fragment"),UI=Symbol.for("react.strict_mode"),BI=Symbol.for("react.profiler"),HI=Symbol.for("react.provider"),zI=Symbol.for("react.context"),jI=Symbol.for("react.forward_ref"),WI=Symbol.for("react.suspense"),VI=Symbol.for("react.memo"),GI=Symbol.for("react.lazy"),a1=Symbol.iterator;function XI(t){return t===null||typeof t!="object"?null:(t=a1&&t[a1]||t["@@iterator"],typeof t=="function"?t:null)}var JS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},QS=Object.assign,ZS={};function ya(t,e,n){this.props=t,this.context=e,this.refs=ZS,this.updater=n||JS}ya.prototype.isReactComponent={};ya.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ya.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ev(){}ev.prototype=ya.prototype;function eg(t,e,n){this.props=t,this.context=e,this.refs=ZS,this.updater=n||JS}var tg=eg.prototype=new ev;tg.constructor=eg;QS(tg,ya.prototype);tg.isPureReactComponent=!0;var l1=Array.isArray,tv=Object.prototype.hasOwnProperty,ng={current:null},nv={key:!0,ref:!0,__self:!0,__source:!0};function rv(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)tv.call(e,r)&&!nv.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:lc,type:t,key:i,ref:o,props:s,_owner:ng.current}}function YI(t,e){return{$$typeof:lc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function rg(t){return typeof t=="object"&&t!==null&&t.$$typeof===lc}function qI(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var c1=/\/+/g;function Vf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?qI(""+t.key):e.toString(36)}function xu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case lc:case PI:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Vf(o,0):r,l1(s)?(n="",t!=null&&(n=t.replace(c1,"$&/")+"/"),xu(s,e,n,"",function(c){return c})):s!=null&&(rg(s)&&(s=YI(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(c1,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",l1(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+Vf(i,a);o+=xu(i,e,n,l,s)}else if(l=XI(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+Vf(i,a++),o+=xu(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Fc(t,e,n){if(t==null)return t;var r=[],s=0;return xu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function KI(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var fn={current:null},Iu={transition:null},JI={ReactCurrentDispatcher:fn,ReactCurrentBatchConfig:Iu,ReactCurrentOwner:ng};function sv(){throw Error("act(...) is not supported in production builds of React.")}xe.Children={map:Fc,forEach:function(t,e,n){Fc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Fc(t,function(){e++}),e},toArray:function(t){return Fc(t,function(e){return e})||[]},only:function(t){if(!rg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};xe.Component=ya;xe.Fragment=$I;xe.Profiler=BI;xe.PureComponent=eg;xe.StrictMode=UI;xe.Suspense=WI;xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JI;xe.act=sv;xe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=QS({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=ng.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)tv.call(e,l)&&!nv.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:lc,type:t.type,key:s,ref:i,props:r,_owner:o}};xe.createContext=function(t){return t={$$typeof:zI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:HI,_context:t},t.Consumer=t};xe.createElement=rv;xe.createFactory=function(t){var e=rv.bind(null,t);return e.type=t,e};xe.createRef=function(){return{current:null}};xe.forwardRef=function(t){return{$$typeof:jI,render:t}};xe.isValidElement=rg;xe.lazy=function(t){return{$$typeof:GI,_payload:{_status:-1,_result:t},_init:KI}};xe.memo=function(t,e){return{$$typeof:VI,type:t,compare:e===void 0?null:e}};xe.startTransition=function(t){var e=Iu.transition;Iu.transition={};try{t()}finally{Iu.transition=e}};xe.unstable_act=sv;xe.useCallback=function(t,e){return fn.current.useCallback(t,e)};xe.useContext=function(t){return fn.current.useContext(t)};xe.useDebugValue=function(){};xe.useDeferredValue=function(t){return fn.current.useDeferredValue(t)};xe.useEffect=function(t,e){return fn.current.useEffect(t,e)};xe.useId=function(){return fn.current.useId()};xe.useImperativeHandle=function(t,e,n){return fn.current.useImperativeHandle(t,e,n)};xe.useInsertionEffect=function(t,e){return fn.current.useInsertionEffect(t,e)};xe.useLayoutEffect=function(t,e){return fn.current.useLayoutEffect(t,e)};xe.useMemo=function(t,e){return fn.current.useMemo(t,e)};xe.useReducer=function(t,e,n){return fn.current.useReducer(t,e,n)};xe.useRef=function(t){return fn.current.useRef(t)};xe.useState=function(t){return fn.current.useState(t)};xe.useSyncExternalStore=function(t,e,n){return fn.current.useSyncExternalStore(t,e,n)};xe.useTransition=function(){return fn.current.useTransition()};xe.version="18.3.1";KS.exports=xe;var T=KS.exports;const Qs=YS(T);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QI=T,ZI=Symbol.for("react.element"),e2=Symbol.for("react.fragment"),t2=Object.prototype.hasOwnProperty,n2=QI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r2={key:!0,ref:!0,__self:!0,__source:!0};function iv(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)t2.call(e,r)&&!r2.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:ZI,type:t,key:i,ref:o,props:s,_owner:n2.current}}ef.Fragment=e2;ef.jsx=iv;ef.jsxs=iv;qS.exports=ef;var S=qS.exports;const we=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Mi="8.40.0",De=globalThis;function tf(t,e,n){const r=De,s=r.__SENTRY__=r.__SENTRY__||{},i=s[Mi]=s[Mi]||{};return i[t]||(i[t]=e())}const ai=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,s2="Sentry Logger ",Kh=["debug","info","warn","error","log","assert","trace"],Ju={};function wa(t){if(!("console"in De))return t();const e=De.console,n={},r=Object.keys(Ju);r.forEach(s=>{const i=Ju[s];n[s]=e[s],e[s]=i});try{return t()}finally{r.forEach(s=>{e[s]=n[s]})}}function i2(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return ai?Kh.forEach(n=>{e[n]=(...r)=>{t&&wa(()=>{De.console[n](`${s2}[${n}]:`,...r)})}}):Kh.forEach(n=>{e[n]=()=>{}}),e}const Y=tf("logger",i2),ov=50,Ui="?",u1=/\(error: (.*)\)/,d1=/captureMessage|captureException/;function av(...t){const e=t.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0,s=0)=>{const i=[],o=n.split(`
`);for(let a=r;a<o.length;a++){const l=o[a];if(l.length>1024)continue;const c=u1.test(l)?l.replace(u1,"$1"):l;if(!c.match(/\S*Error: /)){for(const d of e){const u=d(c);if(u){i.push(u);break}}if(i.length>=ov+s)break}}return a2(i.slice(s))}}function o2(t){return Array.isArray(t)?av(...t):t}function a2(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(Pc(e).function||"")&&e.pop(),e.reverse(),d1.test(Pc(e).function||"")&&(e.pop(),d1.test(Pc(e).function||"")&&e.pop()),e.slice(0,ov).map(n=>({...n,filename:n.filename||Pc(e).filename,function:n.function||Ui}))}function Pc(t){return t[t.length-1]||{}}const Gf="<anonymous>";function as(t){try{return!t||typeof t!="function"?Gf:t.name||Gf}catch{return Gf}}function f1(t){const e=t.exception;if(e){const n=[];try{return e.values.forEach(r=>{r.stacktrace.frames&&n.push(...r.stacktrace.frames)}),n}catch{return}}}const bu={},h1={};function li(t,e){bu[t]=bu[t]||[],bu[t].push(e)}function ci(t,e){if(!h1[t]){h1[t]=!0;try{e()}catch(n){ai&&Y.error(`Error while instrumenting ${t}`,n)}}}function ir(t,e){const n=t&&bu[t];if(n)for(const r of n)try{r(e)}catch(s){ai&&Y.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${as(r)}
Error:`,s)}}let $c=null;function lv(t){const e="error";li(e,t),ci(e,l2)}function l2(){$c=De.onerror,De.onerror=function(t,e,n,r,s){return ir("error",{column:r,error:s,line:n,msg:t,url:e}),$c&&!$c.__SENTRY_LOADER__?$c.apply(this,arguments):!1},De.onerror.__SENTRY_INSTRUMENTED__=!0}let Uc=null;function cv(t){const e="unhandledrejection";li(e,t),ci(e,c2)}function c2(){Uc=De.onunhandledrejection,De.onunhandledrejection=function(t){return ir("unhandledrejection",t),Uc&&!Uc.__SENTRY_LOADER__?Uc.apply(this,arguments):!0},De.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function Sa(){return sg(De),De}function sg(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||Mi,e[Mi]=e[Mi]||{}}const uv=Object.prototype.toString;function ig(t){switch(uv.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return ls(t,Error)}}function va(t,e){return uv.call(t)===`[object ${e}]`}function dv(t){return va(t,"ErrorEvent")}function p1(t){return va(t,"DOMError")}function u2(t){return va(t,"DOMException")}function rs(t){return va(t,"String")}function og(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function ag(t){return t===null||og(t)||typeof t!="object"&&typeof t!="function"}function Go(t){return va(t,"Object")}function nf(t){return typeof Event<"u"&&ls(t,Event)}function d2(t){return typeof Element<"u"&&ls(t,Element)}function f2(t){return va(t,"RegExp")}function rf(t){return!!(t&&t.then&&typeof t.then=="function")}function h2(t){return Go(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function ls(t,e){try{return t instanceof e}catch{return!1}}function fv(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue))}const Oo=De,p2=80;function cs(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,s=[];let i=0,o=0;const a=" > ",l=a.length;let c;const d=Array.isArray(e)?e:e.keyAttrs,u=!Array.isArray(e)&&e.maxStringLength||p2;for(;n&&i++<r&&(c=m2(n,d),!(c==="html"||i>1&&o+s.length*l+c.length>=u));)s.push(c),o+=c.length,n=n.parentNode;return s.reverse().join(a)}catch{return"<unknown>"}}function m2(t,e){const n=t,r=[];if(!n||!n.tagName)return"";if(Oo.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const s=e&&e.length?e.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(s&&s.length)s.forEach(o=>{r.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const o=n.className;if(o&&rs(o)){const a=o.split(/\s+/);for(const l of a)r.push(`.${l}`)}}const i=["aria-label","type","name","title","alt"];for(const o of i){const a=n.getAttribute(o);a&&r.push(`[${o}="${a}"]`)}return r.join("")}function hv(){try{return Oo.document.location.href}catch{return""}}function g2(t){return Oo.document&&Oo.document.querySelector?Oo.document.querySelector(t):null}function pv(t){if(!Oo.HTMLElement)return null;let e=t;const n=5;for(let r=0;r<n;r++){if(!e)return null;if(e instanceof HTMLElement){if(e.dataset.sentryComponent)return e.dataset.sentryComponent;if(e.dataset.sentryElement)return e.dataset.sentryElement}e=e.parentNode}return null}function Lo(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function m1(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const s=t[r];try{fv(s)?n.push("[VueViewModel]"):n.push(String(s))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function y2(t,e,n=!1){return rs(t)?f2(e)?e.test(t):rs(e)?n?t===e:t.includes(e):!1:!1}function Bs(t,e=[],n=!1){return e.some(r=>y2(t,r,n))}function Cn(t,e,n){if(!(e in t))return;const r=t[e],s=n(r);typeof s=="function"&&mv(s,r);try{t[e]=s}catch{ai&&Y.log(`Failed to replace method "${e}" in object`,t)}}function lr(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{ai&&Y.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function mv(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,lr(t,"__sentry_original__",e)}catch{}}function lg(t){return t.__sentry_original__}function w2(t){return Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&")}function gv(t){if(ig(t))return{message:t.message,name:t.name,stack:t.stack,...y1(t)};if(nf(t)){const e={type:t.type,target:g1(t.target),currentTarget:g1(t.currentTarget),...y1(t)};return typeof CustomEvent<"u"&&ls(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function g1(t){try{return d2(t)?cs(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function y1(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function S2(t,e=40){const n=Object.keys(gv(t));n.sort();const r=n[0];if(!r)return"[object has no keys]";if(r.length>=e)return Lo(r,e);for(let s=n.length;s>0;s--){const i=n.slice(0,s).join(", ");if(!(i.length>e))return s===n.length?i:Lo(i,e)}return""}function kt(t){return Jh(t,new Map)}function Jh(t,e){if(v2(t)){const n=e.get(t);if(n!==void 0)return n;const r={};e.set(t,r);for(const s of Object.getOwnPropertyNames(t))typeof t[s]<"u"&&(r[s]=Jh(t[s],e));return r}if(Array.isArray(t)){const n=e.get(t);if(n!==void 0)return n;const r=[];return e.set(t,r),t.forEach(s=>{r.push(Jh(s,e))}),r}return t}function v2(t){if(!Go(t))return!1;try{const e=Object.getPrototypeOf(t).constructor.name;return!e||e==="Object"}catch{return!0}}const yv=1e3;function cc(){return Date.now()/yv}function _2(){const{performance:t}=De;if(!t||!t.now)return cc;const e=Date.now()-t.now(),n=t.timeOrigin==null?e:t.timeOrigin;return()=>(n+t.now())/yv}const cn=_2(),dn=(()=>{const{performance:t}=De;if(!t||!t.now)return;const e=3600*1e3,n=t.now(),r=Date.now(),s=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,i=s<e,o=t.timing&&t.timing.navigationStart,l=typeof o=="number"?Math.abs(o+n-r):e,c=l<e;return i||c?s<=l?t.timeOrigin:o:r})();function rt(){const t=De,e=t.crypto||t.msCrypto;let n=()=>Math.random()*16;try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(n=()=>{const r=new Uint8Array(1);return e.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(n()&15)>>r/4).toString(16))}function wv(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function Is(t){const{message:e,event_id:n}=t;if(e)return e;const r=wv(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function Qh(t,e,n){const r=t.exception=t.exception||{},s=r.values=r.values||[],i=s[0]=s[0]||{};i.value||(i.value=e||""),i.type||(i.type="Error")}function yl(t,e){const n=wv(t);if(!n)return;const r={type:"generic",handled:!0},s=n.mechanism;if(n.mechanism={...r,...s,...e},e&&"data"in e){const i={...s&&s.data,...e.data};n.mechanism.data=i}}function w1(t){if(t&&t.__sentry_captured__)return!0;try{lr(t,"__sentry_captured__",!0)}catch{}return!1}var qr;(function(t){t[t.PENDING=0]="PENDING";const n=1;t[t.RESOLVED=n]="RESOLVED";const r=2;t[t.REJECTED=r]="REJECTED"})(qr||(qr={}));function us(t){return new Kn(e=>{e(t)})}function Qu(t){return new Kn((e,n)=>{n(t)})}class Kn{constructor(e){Kn.prototype.__init.call(this),Kn.prototype.__init2.call(this),Kn.prototype.__init3.call(this),Kn.prototype.__init4.call(this),this._state=qr.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(n){this._reject(n)}}then(e,n){return new Kn((r,s)=>{this._handlers.push([!1,i=>{if(!e)r(i);else try{r(e(i))}catch(o){s(o)}},i=>{if(!n)s(i);else try{r(n(i))}catch(o){s(o)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new Kn((n,r)=>{let s,i;return this.then(o=>{i=!1,s=o,e&&e()},o=>{i=!0,s=o,e&&e()}).then(()=>{if(i){r(s);return}n(s)})})}__init(){this._resolve=e=>{this._setResult(qr.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(qr.REJECTED,e)}}__init3(){this._setResult=(e,n)=>{if(this._state===qr.PENDING){if(rf(n)){n.then(this._resolve,this._reject);return}this._state=e,this._value=n,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===qr.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===qr.RESOLVED&&n[1](this._value),this._state===qr.REJECTED&&n[2](this._value),n[0]=!0)})}}}function C2(t){const e=cn(),n={sid:rt(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>k2(n)};return t&&Xo(n,t),n}function Xo(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||cn(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:rt()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function E2(t,e){let n={};t.status==="ok"&&(n={status:"exited"}),Xo(t,n)}function k2(t){return kt({sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}})}function Zu(){return{traceId:rt(),spanId:rt().substring(16)}}function sf(t,e,n=2){if(!e||typeof e!="object"||n<=0)return e;if(t&&e&&Object.keys(e).length===0)return t;const r={...t};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=sf(r[s],e[s],n-1));return r}const Zh="_sentrySpan";function wl(t,e){e?lr(t,Zh,e):delete t[Zh]}function ed(t){return t[Zh]}const x2=100;class cg{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=Zu()}clone(){const e=new cg;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,wl(e,ed(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Xo(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,[r,s]=n instanceof Bi?[n.getScopeData(),n.getRequestSession()]:Go(n)?[e,e.requestSession]:[],{tags:i,extra:o,user:a,contexts:l,level:c,fingerprint:d=[],propagationContext:u}=r||{};return this._tags={...this._tags,...i},this._extra={...this._extra,...o},this._contexts={...this._contexts,...l},a&&Object.keys(a).length&&(this._user=a),c&&(this._level=c),d.length&&(this._fingerprint=d),u&&(this._propagationContext=u),s&&(this._requestSession=s),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,wl(this,void 0),this._attachments=[],this._propagationContext=Zu(),this._notifyScopeListeners(),this}addBreadcrumb(e,n){const r=typeof n=="number"?n:x2;if(r<=0)return this;const s={timestamp:cc(),...e},i=this._breadcrumbs;return i.push(s),this._breadcrumbs=i.length>r?i.slice(-r):i,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:ed(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=sf(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=n&&n.event_id?n.event_id:rt();if(!this._client)return Y.warn("No client configured on scope - will not capture exception!"),r;const s=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:s,...n,event_id:r},this),r}captureMessage(e,n,r){const s=r&&r.event_id?r.event_id:rt();if(!this._client)return Y.warn("No client configured on scope - will not capture message!"),s;const i=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:i,...r,event_id:s},this),s}captureEvent(e,n){const r=n&&n.event_id?n.event_id:rt();return this._client?(this._client.captureEvent(e,{...n,event_id:r},this),r):(Y.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}const Bi=cg;function I2(){return tf("defaultCurrentScope",()=>new Bi)}function b2(){return tf("defaultIsolationScope",()=>new Bi)}class T2{constructor(e,n){let r;e?r=e:r=new Bi;let s;n?s=n:s=new Bi,this._stack=[{scope:r}],this._isolationScope=s}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(s){throw this._popScope(),s}return rf(r)?r.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function Yo(){const t=Sa(),e=sg(t);return e.stack=e.stack||new T2(I2(),b2())}function R2(t){return Yo().withScope(t)}function M2(t,e){const n=Yo();return n.withScope(()=>(n.getStackTop().scope=t,e(t)))}function S1(t){return Yo().withScope(()=>t(Yo().getIsolationScope()))}function N2(){return{withIsolationScope:S1,withScope:R2,withSetScope:M2,withSetIsolationScope:(t,e)=>S1(e),getCurrentScope:()=>Yo().getScope(),getIsolationScope:()=>Yo().getIsolationScope()}}function uc(t){const e=sg(t);return e.acs?e.acs:N2()}function Ke(){const t=Sa();return uc(t).getCurrentScope()}function dr(){const t=Sa();return uc(t).getIsolationScope()}function A2(){return tf("globalScope",()=>new Bi)}function ug(...t){const e=Sa(),n=uc(e);if(t.length===2){const[r,s]=t;return r?n.withSetScope(r,s):n.withScope(s)}return n.withScope(t[0])}function Re(){return Ke().getClient()}const D2="_sentryMetrics";function ep(t){const e=t[D2];if(!e)return;const n={};for(const[,[r,s]]of e)(n[r]||(n[r]=[])).push(kt(s));return n}const Pr="sentry.source",Sv="sentry.sample_rate",Hi="sentry.op",Dt="sentry.origin",tp="sentry.idle_span_finish_reason",of="sentry.measurement_unit",af="sentry.measurement_value",O2="sentry.profile_id",dg="sentry.exclusive_time",L2=0,vv=1,Tt=2;function F2(t){if(t<400&&t>=100)return{code:vv};if(t>=400&&t<500)switch(t){case 401:return{code:Tt,message:"unauthenticated"};case 403:return{code:Tt,message:"permission_denied"};case 404:return{code:Tt,message:"not_found"};case 409:return{code:Tt,message:"already_exists"};case 413:return{code:Tt,message:"failed_precondition"};case 429:return{code:Tt,message:"resource_exhausted"};case 499:return{code:Tt,message:"cancelled"};default:return{code:Tt,message:"invalid_argument"}}if(t>=500&&t<600)switch(t){case 501:return{code:Tt,message:"unimplemented"};case 503:return{code:Tt,message:"unavailable"};case 504:return{code:Tt,message:"deadline_exceeded"};default:return{code:Tt,message:"internal_error"}}return{code:Tt,message:"unknown_error"}}function _v(t,e){t.setAttribute("http.response.status_code",e);const n=F2(e);n.message!=="unknown_error"&&t.setStatus(n)}const uo="baggage",fg="sentry-",P2=/^sentry-/,$2=8192;function Cv(t){const e=U2(t);if(!e)return;const n=Object.entries(e).reduce((r,[s,i])=>{if(s.match(P2)){const o=s.slice(fg.length);r[o]=i}return r},{});if(Object.keys(n).length>0)return n}function Ev(t){if(!t)return;const e=Object.entries(t).reduce((n,[r,s])=>(s&&(n[`${fg}${r}`]=s),n),{});return B2(e)}function U2(t){if(!(!t||!rs(t)&&!Array.isArray(t)))return Array.isArray(t)?t.reduce((e,n)=>{const r=v1(n);return Object.entries(r).forEach(([s,i])=>{e[s]=i}),e},{}):v1(t)}function v1(t){return t.split(",").map(e=>e.split("=").map(n=>decodeURIComponent(n.trim()))).reduce((e,[n,r])=>(n&&r&&(e[n]=r),e),{})}function B2(t){if(Object.keys(t).length!==0)return Object.entries(t).reduce((e,[n,r],s)=>{const i=`${encodeURIComponent(n)}=${encodeURIComponent(r)}`,o=s===0?i:`${e},${i}`;return o.length>$2?(ai&&Y.warn(`Not adding key: ${n} with val: ${r} to baggage header due to exceeding baggage size limits.`),e):o},"")}const H2=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function z2(t){if(!t)return;const e=t.match(H2);if(!e)return;let n;return e[3]==="1"?n=!0:e[3]==="0"&&(n=!1),{traceId:e[1],parentSampled:n,parentSpanId:e[2]}}function j2(t,e){const n=z2(t),r=Cv(e),{traceId:s,parentSpanId:i,parentSampled:o}=n||{};return n?{traceId:s||rt(),parentSpanId:i||rt().substring(16),spanId:rt().substring(16),sampled:o,dsc:r||{}}:{traceId:s||rt(),spanId:rt().substring(16)}}function hg(t=rt(),e=rt().substring(16),n){let r="";return n!==void 0&&(r=n?"-1":"-0"),`${t}-${e}${r}`}const kv=0,xv=1;function W2(t){const{spanId:e,traceId:n}=t.spanContext(),{data:r,op:s,parent_span_id:i,status:o,origin:a}=Ae(t);return kt({parent_span_id:i,span_id:e,trace_id:n,data:r,op:s,status:o,origin:a})}function V2(t){const{spanId:e,traceId:n}=t.spanContext(),{parent_span_id:r}=Ae(t);return kt({parent_span_id:r,span_id:e,trace_id:n})}function Iv(t){const{traceId:e,spanId:n}=t.spanContext(),r=Ji(t);return hg(e,n,r)}function Ni(t){return typeof t=="number"?_1(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?_1(t.getTime()):cn()}function _1(t){return t>9999999999?t/1e3:t}function Ae(t){if(X2(t))return t.getSpanJSON();try{const{spanId:e,traceId:n}=t.spanContext();if(G2(t)){const{attributes:r,startTime:s,name:i,endTime:o,parentSpanId:a,status:l}=t;return kt({span_id:e,trace_id:n,data:r,description:i,parent_span_id:a,start_timestamp:Ni(s),timestamp:Ni(o)||void 0,status:bv(l),op:r[Hi],origin:r[Dt],_metrics_summary:ep(t)})}return{span_id:e,trace_id:n}}catch{return{}}}function G2(t){const e=t;return!!e.attributes&&!!e.startTime&&!!e.name&&!!e.endTime&&!!e.status}function X2(t){return typeof t.getSpanJSON=="function"}function Ji(t){const{traceFlags:e}=t.spanContext();return e===xv}function bv(t){if(!(!t||t.code===L2))return t.code===vv?"ok":t.message||"unknown_error"}const Ai="_sentryChildSpans",np="_sentryRootSpan";function Tv(t,e){const n=t[np]||t;lr(e,np,n),t[Ai]?t[Ai].add(e):lr(t,Ai,new Set([e]))}function Y2(t,e){t[Ai]&&t[Ai].delete(e)}function Tu(t){const e=new Set;function n(r){if(!e.has(r)&&Ji(r)){e.add(r);const s=r[Ai]?Array.from(r[Ai]):[];for(const i of s)n(i)}}return n(t),Array.from(e)}function zt(t){return t[np]||t}function Gt(){const t=Sa(),e=uc(t);return e.getActiveSpan?e.getActiveSpan():ed(Ke())}let C1=!1;function q2(){C1||(C1=!0,lv(rp),cv(rp))}function rp(){const t=Gt(),e=t&&zt(t);if(e){const n="internal_error";we&&Y.log(`[Tracing] Root span: ${n} -> Global error occurred`),e.setStatus({code:Tt,message:n})}}rp.tag="sentry_tracingErrorCallback";const Rv="_sentryScope",Mv="_sentryIsolationScope";function K2(t,e,n){t&&(lr(t,Mv,n),lr(t,Rv,e))}function E1(t){return{scope:t[Rv],isolationScope:t[Mv]}}function ds(t){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=Re(),n=t||e&&e.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}class _a{constructor(e={}){this._traceId=e.traceId||rt(),this._spanId=e.spanId||rt().substring(16)}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:kv}}end(e){}setAttribute(e,n){return this}setAttributes(e){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}addEvent(e,n,r){return this}addLink(e){return this}addLinks(e){return this}recordException(e,n){}}const pg="production",Nv="_frozenDsc";function k1(t,e){lr(t,Nv,e)}function lf(t,e){const n=e.getOptions(),{publicKey:r}=e.getDsn()||{},s=kt({environment:n.environment||pg,release:n.release,public_key:r,trace_id:t});return e.emit("createDsc",s),s}function ui(t){const e=Re();if(!e)return{};const n=lf(Ae(t).trace_id||"",e),r=zt(t),s=r[Nv];if(s)return s;const i=r.spanContext().traceState,o=i&&i.get("sentry.dsc"),a=o&&Cv(o);if(a)return a;const l=Ae(r),c=l.data||{},d=c[Sv];d!=null&&(n.sample_rate=`${d}`);const u=c[Pr],f=l.description;return u!=="url"&&f&&(n.transaction=f),ds()&&(n.sampled=String(Ji(r))),e.emit("createDsc",n,r),n}function J2(t){if(!we)return;const{description:e="< unknown name >",op:n="< unknown op >",parent_span_id:r}=Ae(t),{spanId:s}=t.spanContext(),i=Ji(t),o=zt(t),a=o===t,l=`[Tracing] Starting ${i?"sampled":"unsampled"} ${a?"root ":""}span`,c=[`op: ${n}`,`name: ${e}`,`ID: ${s}`];if(r&&c.push(`parent ID: ${r}`),!a){const{op:d,description:u}=Ae(o);c.push(`root ID: ${o.spanContext().spanId}`),d&&c.push(`root op: ${d}`),u&&c.push(`root description: ${u}`)}Y.log(`${l}
  ${c.join(`
  `)}`)}function Q2(t){if(!we)return;const{description:e="< unknown name >",op:n="< unknown op >"}=Ae(t),{spanId:r}=t.spanContext(),i=zt(t)===t,o=`[Tracing] Finishing "${n}" ${i?"root ":""}span "${e}" with ID ${r}`;Y.log(o)}function td(t){if(typeof t=="boolean")return Number(t);const e=typeof t=="string"?parseFloat(t):t;if(typeof e!="number"||isNaN(e)||e<0||e>1){we&&Y.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(t)} of type ${JSON.stringify(typeof t)}.`);return}return e}function Z2(t,e){if(!ds(t))return[!1];let n;typeof t.tracesSampler=="function"?n=t.tracesSampler(e):e.parentSampled!==void 0?n=e.parentSampled:typeof t.tracesSampleRate<"u"?n=t.tracesSampleRate:n=1;const r=td(n);return r===void 0?(we&&Y.warn("[Tracing] Discarding transaction because of invalid sample rate."),[!1]):r?Math.random()<r?[!0,r]:(we&&Y.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(n)})`),[!1,r]):(we&&Y.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),[!1,r])}const eb=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function tb(t){return t==="http"||t==="https"}function dc(t,e=!1){const{host:n,path:r,pass:s,port:i,projectId:o,protocol:a,publicKey:l}=t;return`${a}://${l}${e&&s?`:${s}`:""}@${n}${i?`:${i}`:""}/${r&&`${r}/`}${o}`}function nb(t){const e=eb.exec(t);if(!e){wa(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[n,r,s="",i="",o="",a=""]=e.slice(1);let l="",c=a;const d=c.split("/");if(d.length>1&&(l=d.slice(0,-1).join("/"),c=d.pop()),c){const u=c.match(/^\d+/);u&&(c=u[0])}return Av({host:i,pass:s,path:l,projectId:c,port:o,protocol:n,publicKey:r})}function Av(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function rb(t){if(!ai)return!0;const{port:e,projectId:n,protocol:r}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(Y.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?tb(r)?e&&isNaN(parseInt(e,10))?(Y.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(Y.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(Y.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function sb(t){const e=typeof t=="string"?nb(t):Av(t);if(!(!e||!rb(e)))return e}function ib(){const t=typeof WeakSet=="function",e=t?new WeakSet:[];function n(s){if(t)return e.has(s)?!0:(e.add(s),!1);for(let i=0;i<e.length;i++)if(e[i]===s)return!0;return e.push(s),!1}function r(s){if(t)e.delete(s);else for(let i=0;i<e.length;i++)if(e[i]===s){e.splice(i,1);break}}return[n,r]}function Or(t,e=100,n=1/0){try{return sp("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function Dv(t,e=3,n=100*1024){const r=Or(t,e);return cb(r)>n?Dv(t,e-1,n):r}function sp(t,e,n=1/0,r=1/0,s=ib()){const[i,o]=s;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const a=ob(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const l=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(l===0)return a.replace("object ","");if(i(e))return"[Circular ~]";const c=e;if(c&&typeof c.toJSON=="function")try{const h=c.toJSON();return sp("",h,l-1,r,s)}catch{}const d=Array.isArray(e)?[]:{};let u=0;const f=gv(e);for(const h in f){if(!Object.prototype.hasOwnProperty.call(f,h))continue;if(u>=r){d[h]="[MaxProperties ~]";break}const p=f[h];d[h]=sp(h,p,l-1,r,s),u++}return o(e),d}function ob(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(fv(e))return"[VueViewModel]";if(h2(e))return"[SyntheticEvent]";if(typeof e=="number"&&!Number.isFinite(e))return`[${e}]`;if(typeof e=="function")return`[Function: ${as(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=ab(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function ab(t){const e=Object.getPrototypeOf(t);return e?e.constructor.name:"null prototype"}function lb(t){return~-encodeURI(t).split(/%..|./).length}function cb(t){return lb(JSON.stringify(t))}function Qi(t,e=[]){return[t,e]}function ub(t,e){const[n,r]=t;return[n,[...r,e]]}function x1(t,e){const n=t[1];for(const r of n){const s=r[0].type;if(e(r,s))return!0}return!1}function ip(t){return De.__SENTRY__&&De.__SENTRY__.encodePolyfill?De.__SENTRY__.encodePolyfill(t):new TextEncoder().encode(t)}function db(t){const[e,n]=t;let r=JSON.stringify(e);function s(i){typeof r=="string"?r=typeof i=="string"?r+i:[ip(r),i]:r.push(typeof i=="string"?ip(i):i)}for(const i of n){const[o,a]=i;if(s(`
${JSON.stringify(o)}
`),typeof a=="string"||a instanceof Uint8Array)s(a);else{let l;try{l=JSON.stringify(a)}catch{l=JSON.stringify(Or(a))}s(l)}}return typeof r=="string"?r:fb(r)}function fb(t){const e=t.reduce((s,i)=>s+i.length,0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function hb(t){return[{type:"span"},t]}function pb(t){const e=typeof t.data=="string"?ip(t.data):t.data;return[kt({type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),e]}const mb={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket"};function I1(t){return mb[t]}function mg(t){if(!t||!t.sdk)return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function Ov(t,e,n,r){const s=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!n&&r&&{dsn:dc(r)},...s&&{trace:kt({...s})}}}function gb(t,e){return e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]]),t}function yb(t,e,n,r){const s=mg(n),i={sent_at:new Date().toISOString(),...s&&{sdk:s},...!!r&&e&&{dsn:dc(e)}},o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return Qi(i,[o])}function wb(t,e,n,r){const s=mg(n),i=t.type&&t.type!=="replay_event"?t.type:"event";gb(t,n&&n.sdk);const o=Ov(t,s,r,e);return delete t.sdkProcessingMetadata,Qi(o,[[{type:i},t]])}function Sb(t,e){function n(d){return!!d.trace_id&&!!d.public_key}const r=ui(t[0]),s=e&&e.getDsn(),i=e&&e.getOptions().tunnel,o={sent_at:new Date().toISOString(),...n(r)&&{trace:r},...!!i&&s&&{dsn:dc(s)}},a=e&&e.getOptions().beforeSendSpan,l=a?d=>a(Ae(d)):d=>Ae(d),c=[];for(const d of t){const u=l(d);u&&c.push(hb(u))}return Qi(o,c)}function vb(t,e,n,r=Gt()){const s=r&&zt(r);s&&s.addEvent(t,{[af]:e,[of]:n})}function b1(t){if(!t||t.length===0)return;const e={};return t.forEach(n=>{const r=n.attributes||{},s=r[of],i=r[af];typeof s=="string"&&typeof i=="number"&&(e[n.name]={value:i,unit:s})}),e}const T1=1e3;class gg{constructor(e={}){this._traceId=e.traceId||rt(),this._spanId=e.spanId||rt().substring(16),this._startTime=e.startTimestamp||cn(),this._attributes={},this.setAttributes({[Dt]:"manual",[Hi]:e.op,...e.attributes}),this._name=e.name,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.endTimestamp&&(this._endTime=e.endTimestamp),this._events=[],this._isStandaloneSpan=e.isStandalone,this._endTime&&this._onSpanEnded()}addLink(e){return this}addLinks(e){return this}recordException(e,n){}spanContext(){const{_spanId:e,_traceId:n,_sampled:r}=this;return{spanId:e,traceId:n,traceFlags:r?xv:kv}}setAttribute(e,n){return n===void 0?delete this._attributes[e]:this._attributes[e]=n,this}setAttributes(e){return Object.keys(e).forEach(n=>this.setAttribute(n,e[n])),this}updateStartTime(e){this._startTime=Ni(e)}setStatus(e){return this._status=e,this}updateName(e){return this._name=e,this.setAttribute(Pr,"custom"),this}end(e){this._endTime||(this._endTime=Ni(e),Q2(this),this._onSpanEnded())}getSpanJSON(){return kt({data:this._attributes,description:this._name,op:this._attributes[Hi],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:bv(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[Dt],_metrics_summary:ep(this),profile_id:this._attributes[O2],exclusive_time:this._attributes[dg],measurements:b1(this._events),is_segment:this._isStandaloneSpan&&zt(this)===this||void 0,segment_id:this._isStandaloneSpan?zt(this).spanContext().spanId:void 0})}isRecording(){return!this._endTime&&!!this._sampled}addEvent(e,n,r){we&&Y.log("[Tracing] Adding an event to span:",e);const s=R1(n)?n:r||cn(),i=R1(n)?{}:n||{},o={name:e,time:Ni(s),attributes:i};return this._events.push(o),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const e=Re();if(e&&e.emit("spanEnd",this),!(this._isStandaloneSpan||this===zt(this)))return;if(this._isStandaloneSpan){this._sampled?Cb(Sb([this],e)):(we&&Y.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","span"));return}const r=this._convertSpanToTransaction();r&&(E1(this).scope||Ke()).captureEvent(r)}_convertSpanToTransaction(){if(!M1(Ae(this)))return;this._name||(we&&Y.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:n}=E1(this),s=(e||Ke()).getClient()||Re();if(this._sampled!==!0){we&&Y.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),s&&s.recordDroppedEvent("sample_rate","transaction");return}const o=Tu(this).filter(u=>u!==this&&!_b(u)).map(u=>Ae(u)).filter(M1),a=this._attributes[Pr],l={contexts:{trace:W2(this)},spans:o.length>T1?o.sort((u,f)=>u.start_timestamp-f.start_timestamp).slice(0,T1):o,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:n,...kt({dynamicSamplingContext:ui(this)})},_metrics_summary:ep(this),...a&&{transaction_info:{source:a}}},c=b1(this._events);return c&&Object.keys(c).length&&(we&&Y.log("[Measurements] Adding measurements to transaction event",JSON.stringify(c,void 0,2)),l.measurements=c),l}}function R1(t){return t&&typeof t=="number"||t instanceof Date||Array.isArray(t)}function M1(t){return!!t.start_timestamp&&!!t.timestamp&&!!t.span_id&&!!t.trace_id}function _b(t){return t instanceof gg&&t.isStandaloneSpan()}function Cb(t){const e=Re();if(!e)return;const n=t[1];if(!n||n.length===0){e.recordDroppedEvent("before_send","span");return}e.sendEnvelope(t)}const Lv="__SENTRY_SUPPRESS_TRACING__";function fc(t){const e=Pv();if(e.startInactiveSpan)return e.startInactiveSpan(t);const n=kb(t),{forceTransaction:r,parentSpan:s}=t;return(t.scope?o=>ug(t.scope,o):s!==void 0?o=>Fv(s,o):o=>o())(()=>{const o=Ke(),a=Ib(o);return t.onlyIfParent&&!a?new _a:Eb({parentSpan:a,spanArguments:n,forceTransaction:r,scope:o})})}function Fv(t,e){const n=Pv();return n.withActiveSpan?n.withActiveSpan(t,e):ug(r=>(wl(r,t||void 0),e(r)))}function Eb({parentSpan:t,spanArguments:e,forceTransaction:n,scope:r}){if(!ds())return new _a;const s=dr();let i;if(t&&!n)i=xb(t,r,e),Tv(t,i);else if(t){const o=ui(t),{traceId:a,spanId:l}=t.spanContext(),c=Ji(t);i=N1({traceId:a,parentSpanId:l,...e},r,c),k1(i,o)}else{const{traceId:o,dsc:a,parentSpanId:l,sampled:c}={...s.getPropagationContext(),...r.getPropagationContext()};i=N1({traceId:o,parentSpanId:l,...e},r,c),a&&k1(i,a)}return J2(i),K2(i,r,s),i}function kb(t){const n={isStandalone:(t.experimental||{}).standalone,...t};if(t.startTime){const r={...n};return r.startTimestamp=Ni(t.startTime),delete r.startTime,r}return n}function Pv(){const t=Sa();return uc(t)}function N1(t,e,n){const r=Re(),s=r&&r.getOptions()||{},{name:i="",attributes:o}=t,[a,l]=e.getScopeData().sdkProcessingMetadata[Lv]?[!1]:Z2(s,{name:i,parentSampled:n,attributes:o,transactionContext:{name:i,parentSampled:n}}),c=new gg({...t,attributes:{[Pr]:"custom",...t.attributes},sampled:a});return l!==void 0&&c.setAttribute(Sv,l),r&&r.emit("spanStart",c),c}function xb(t,e,n){const{spanId:r,traceId:s}=t.spanContext(),i=e.getScopeData().sdkProcessingMetadata[Lv]?!1:Ji(t),o=i?new gg({...n,parentSpanId:r,traceId:s,sampled:i}):new _a({traceId:s});Tv(t,o);const a=Re();return a&&(a.emit("spanStart",o),n.endTimestamp&&a.emit("spanEnd",o)),o}function Ib(t){const e=ed(t);if(!e)return;const n=Re();return(n?n.getOptions():{}).parentSpanIsAlwaysRootSpan?zt(e):e}const Ru={idleTimeout:1e3,finalTimeout:3e4,childSpanTimeout:15e3},bb="heartbeatFailed",Tb="idleTimeout",Rb="finalTimeout",Mb="externalFinish";function $v(t,e={}){const n=new Map;let r=!1,s,i=Mb,o=!e.disableAutoFinish;const a=[],{idleTimeout:l=Ru.idleTimeout,finalTimeout:c=Ru.finalTimeout,childSpanTimeout:d=Ru.childSpanTimeout,beforeSpanEnd:u}=e,f=Re();if(!f||!ds())return new _a;const h=Ke(),p=Gt(),m=Nb(t);m.end=new Proxy(m.end,{apply(C,E,A){u&&u(m);const[V,...D]=A,$=V||cn(),j=Ni($),Z=Tu(m).filter(F=>F!==m);if(!Z.length)return x(j),Reflect.apply(C,E,[j,...D]);const ae=Z.map(F=>Ae(F).timestamp).filter(F=>!!F),ce=ae.length?Math.max(...ae):void 0,J=Ae(m).start_timestamp,K=Math.min(J?J+c/1e3:1/0,Math.max(J||-1/0,Math.min(j,ce||1/0)));return x(K),Reflect.apply(C,E,[K,...D])}});function _(){s&&(clearTimeout(s),s=void 0)}function g(C){_(),s=setTimeout(()=>{!r&&n.size===0&&o&&(i=Tb,m.end(C))},l)}function y(C){s=setTimeout(()=>{!r&&o&&(i=bb,m.end(C))},d)}function w(C){_(),n.set(C,!0);const E=cn();y(E+d/1e3)}function v(C){if(n.has(C)&&n.delete(C),n.size===0){const E=cn();g(E+l/1e3)}}function x(C){r=!0,n.clear(),a.forEach(j=>j()),wl(h,p);const E=Ae(m),{start_timestamp:A}=E;if(!A)return;(E.data||{})[tp]||m.setAttribute(tp,i),Y.log(`[Tracing] Idle span "${E.op}" finished`);const D=Tu(m).filter(j=>j!==m);let $=0;D.forEach(j=>{j.isRecording()&&(j.setStatus({code:Tt,message:"cancelled"}),j.end(C),we&&Y.log("[Tracing] Cancelling span since span ended early",JSON.stringify(j,void 0,2)));const Z=Ae(j),{timestamp:ae=0,start_timestamp:ce=0}=Z,J=ce<=C,K=(c+l)/1e3,F=ae-ce<=K;if(we){const q=JSON.stringify(j,void 0,2);J?F||Y.log("[Tracing] Discarding span since it finished after idle span final timeout",q):Y.log("[Tracing] Discarding span since it happened after idle span was finished",q)}(!F||!J)&&(Y2(m,j),$++)}),$>0&&m.setAttribute("sentry.idle_span_discarded_spans",$)}return a.push(f.on("spanStart",C=>{if(r||C===m||Ae(C).timestamp)return;Tu(m).includes(C)&&w(C.spanContext().spanId)})),a.push(f.on("spanEnd",C=>{r||v(C.spanContext().spanId)})),a.push(f.on("idleSpanEnableAutoFinish",C=>{C===m&&(o=!0,g(),n.size&&y())})),e.disableAutoFinish||g(),setTimeout(()=>{r||(m.setStatus({code:Tt,message:"deadline_exceeded"}),i=Rb,m.end())},c),m}function Nb(t){const e=fc(t);return wl(Ke(),e),we&&Y.log("[Tracing] Started span is an idle span"),e}function op(t,e,n,r=0){return new Kn((s,i)=>{const o=t[r];if(e===null||typeof o!="function")s(e);else{const a=o({...e},n);we&&o.id&&a===null&&Y.log(`Event processor "${o.id}" dropped event`),rf(a)?a.then(l=>op(t,l,n,r+1).then(s)).then(null,i):op(t,a,n,r+1).then(s).then(null,i)}})}const A1=new WeakMap;function Ab(t){const e=De._sentryDebugIds;if(!e)return{};let n;const r=A1.get(t);return r?n=r:(n=new Map,A1.set(t,n)),Object.keys(e).reduce((s,i)=>{let o;const a=n.get(i);a?o=a:(o=t(i),n.set(i,o));for(let l=o.length-1;l>=0;l--){const c=o[l],d=c&&c.filename;if(c&&d){s[d]=e[i];break}}return s},{})}function Db(t,e){const{fingerprint:n,span:r,breadcrumbs:s,sdkProcessingMetadata:i}=e;Ob(t,e),r&&Pb(t,r),$b(t,n),Lb(t,s),Fb(t,i)}function D1(t,e){const{extra:n,tags:r,user:s,contexts:i,level:o,sdkProcessingMetadata:a,breadcrumbs:l,fingerprint:c,eventProcessors:d,attachments:u,propagationContext:f,transactionName:h,span:p}=e;Bc(t,"extra",n),Bc(t,"tags",r),Bc(t,"user",s),Bc(t,"contexts",i),t.sdkProcessingMetadata=sf(t.sdkProcessingMetadata,a,2),o&&(t.level=o),h&&(t.transactionName=h),p&&(t.span=p),l.length&&(t.breadcrumbs=[...t.breadcrumbs,...l]),c.length&&(t.fingerprint=[...t.fingerprint,...c]),d.length&&(t.eventProcessors=[...t.eventProcessors,...d]),u.length&&(t.attachments=[...t.attachments,...u]),t.propagationContext={...t.propagationContext,...f}}function Bc(t,e,n){t[e]=sf(t[e],n,1)}function Ob(t,e){const{extra:n,tags:r,user:s,contexts:i,level:o,transactionName:a}=e,l=kt(n);l&&Object.keys(l).length&&(t.extra={...l,...t.extra});const c=kt(r);c&&Object.keys(c).length&&(t.tags={...c,...t.tags});const d=kt(s);d&&Object.keys(d).length&&(t.user={...d,...t.user});const u=kt(i);u&&Object.keys(u).length&&(t.contexts={...u,...t.contexts}),o&&(t.level=o),a&&t.type!=="transaction"&&(t.transaction=a)}function Lb(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}function Fb(t,e){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e}}function Pb(t,e){t.contexts={trace:V2(e),...t.contexts},t.sdkProcessingMetadata={dynamicSamplingContext:ui(e),...t.sdkProcessingMetadata};const n=zt(e),r=Ae(n).description;r&&!t.transaction&&t.type==="transaction"&&(t.transaction=r)}function $b(t,e){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}function Uv(t,e,n,r,s,i){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=t,l={...e,event_id:e.event_id||n.event_id||rt(),timestamp:e.timestamp||cc()},c=n.integrations||t.integrations.map(_=>_.name);Ub(l,t),zb(l,c),s&&s.emit("applyFrameMetadata",e),e.type===void 0&&Bb(l,t.stackParser);const d=Wb(r,n.captureContext);n.mechanism&&yl(l,n.mechanism);const u=s?s.getEventProcessors():[],f=A2().getScopeData();if(i){const _=i.getScopeData();D1(f,_)}if(d){const _=d.getScopeData();D1(f,_)}const h=[...n.attachments||[],...f.attachments];h.length&&(n.attachments=h),Db(l,f);const p=[...u,...f.eventProcessors];return op(p,l,n).then(_=>(_&&Hb(_),typeof o=="number"&&o>0?jb(_,o,a):_))}function Ub(t,e){const{environment:n,release:r,dist:s,maxValueLength:i=250}=e;"environment"in t||(t.environment="environment"in e?n:pg),t.release===void 0&&r!==void 0&&(t.release=r),t.dist===void 0&&s!==void 0&&(t.dist=s),t.message&&(t.message=Lo(t.message,i));const o=t.exception&&t.exception.values&&t.exception.values[0];o&&o.value&&(o.value=Lo(o.value,i));const a=t.request;a&&a.url&&(a.url=Lo(a.url,i))}function Bb(t,e){const n=Ab(e);try{t.exception.values.forEach(r=>{r.stacktrace.frames.forEach(s=>{s.filename&&(s.debug_id=n[s.filename])})})}catch{}}function Hb(t){const e={};try{t.exception.values.forEach(r=>{r.stacktrace.frames.forEach(s=>{s.debug_id&&(s.abs_path?e[s.abs_path]=s.debug_id:s.filename&&(e[s.filename]=s.debug_id),delete s.debug_id)})})}catch{}if(Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.entries(e).forEach(([r,s])=>{n.push({type:"sourcemap",code_file:r,debug_id:s})})}function zb(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function jb(t,e,n){if(!t)return null;const r={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(s=>({...s,...s.data&&{data:Or(s.data,e,n)}}))},...t.user&&{user:Or(t.user,e,n)},...t.contexts&&{contexts:Or(t.contexts,e,n)},...t.extra&&{extra:Or(t.extra,e,n)}};return t.contexts&&t.contexts.trace&&r.contexts&&(r.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(r.contexts.trace.data=Or(t.contexts.trace.data,e,n))),t.spans&&(r.spans=t.spans.map(s=>({...s,...s.data&&{data:Or(s.data,e,n)}}))),r}function Wb(t,e){if(!e)return t;const n=t?t.clone():new Bi;return n.update(e),n}function Bv(t,e){return Ke().captureException(t,void 0)}function Hv(t,e){return Ke().captureEvent(t,e)}function zv(t,e){dr().setContext(t,e)}function Vb(t){dr().addEventProcessor(t)}function O1(t){const e=Re(),n=dr(),r=Ke(),{release:s,environment:i=pg}=e&&e.getOptions()||{},{userAgent:o}=De.navigator||{},a=C2({release:s,environment:i,user:r.getUser()||n.getUser(),...o&&{userAgent:o},...t}),l=n.getSession();return l&&l.status==="ok"&&Xo(l,{status:"exited"}),jv(),n.setSession(a),r.setSession(a),a}function jv(){const t=dr(),e=Ke(),n=e.getSession()||t.getSession();n&&E2(n),Wv(),t.setSession(),e.setSession()}function Wv(){const t=dr(),e=Ke(),n=Re(),r=e.getSession()||t.getSession();r&&n&&n.captureSession(r)}function L1(t=!1){if(t){jv();return}Wv()}const Gb="7";function Xb(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function Yb(t){return`${Xb(t)}${t.projectId}/envelope/`}function qb(t,e){return w2({sentry_key:t.publicKey,sentry_version:Gb,...e&&{sentry_client:`${e.name}/${e.version}`}})}function Kb(t,e,n){return e||`${Yb(t)}?${qb(t,n)}`}const F1=[];function Jb(t){const e={};return t.forEach(n=>{const{name:r}=n,s=e[r];s&&!s.isDefaultInstance&&n.isDefaultInstance||(e[r]=n)}),Object.values(e)}function Qb(t){const e=t.defaultIntegrations||[],n=t.integrations;e.forEach(o=>{o.isDefaultInstance=!0});let r;if(Array.isArray(n))r=[...e,...n];else if(typeof n=="function"){const o=n(e);r=Array.isArray(o)?o:[o]}else r=e;const s=Jb(r),i=s.findIndex(o=>o.name==="Debug");if(i>-1){const[o]=s.splice(i,1);s.push(o)}return s}function Zb(t,e){const n={};return e.forEach(r=>{r&&Vv(t,r,n)}),n}function P1(t,e){for(const n of e)n&&n.afterAllSetup&&n.afterAllSetup(t)}function Vv(t,e,n){if(n[e.name]){we&&Y.log(`Integration skipped because it was already installed: ${e.name}`);return}if(n[e.name]=e,F1.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),F1.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(s,i)=>r(s,i,t))}if(typeof e.processEvent=="function"){const r=e.processEvent.bind(e),s=Object.assign((i,o)=>r(i,o,t),{id:e.name});t.addEventProcessor(s)}we&&Y.log(`Integration installed: ${e.name}`)}function e6(t,e,n){const r=[{type:"client_report"},{timestamp:cc(),discarded_events:t}];return Qi(e?{dsn:e}:{},[r])}class Lr extends Error{constructor(e,n="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=n}}const $1="Not capturing exception because it's already been captured.";class t6{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=sb(e.dsn):we&&Y.warn("No DSN provided, client will not send events."),this._dsn){const n=Kb(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:n})}}captureException(e,n,r){const s=rt();if(w1(e))return we&&Y.log($1),s;const i={event_id:s,...n};return this._process(this.eventFromException(e,i).then(o=>this._captureEvent(o,i,r))),i.event_id}captureMessage(e,n,r,s){const i={event_id:rt(),...r},o=og(e)?e:String(e),a=ag(e)?this.eventFromMessage(o,n,i):this.eventFromException(e,i);return this._process(a.then(l=>this._captureEvent(l,i,s))),i.event_id}captureEvent(e,n,r){const s=rt();if(n&&n.originalException&&w1(n.originalException))return we&&Y.log($1),s;const i={event_id:s,...n},a=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,i,a||r)),i.event_id}captureSession(e){typeof e.release!="string"?we&&Y.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),Xo(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?(this.emit("flush"),this._isClientDoneProcessing(e).then(r=>n.flush(e).then(s=>r&&s))):us(!0)}close(e){return this.flush(e).then(n=>(this.getOptions().enabled=!1,this.emit("close"),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const n=this._integrations[e.name];Vv(this,e,this._integrations),n||P1(this,[e])}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=wb(e,this._dsn,this._options._metadata,this._options.tunnel);for(const i of n.attachments||[])r=ub(r,pb(i));const s=this.sendEnvelope(r);s&&s.then(i=>this.emit("afterSendEvent",e,i),null)}sendSession(e){const n=yb(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(n)}recordDroppedEvent(e,n,r){if(this._options.sendClientReports){const s=typeof r=="number"?r:1,i=`${e}:${n}`;we&&Y.log(`Recording outcome: "${i}"${s>1?` (${s} times)`:""}`),this._outcomes[i]=(this._outcomes[i]||0)+s}}on(e,n){const r=this._hooks[e]=this._hooks[e]||[];return r.push(n),()=>{const s=r.indexOf(n);s>-1&&r.splice(s,1)}}emit(e,...n){const r=this._hooks[e];r&&r.forEach(s=>s(...n))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,n=>(we&&Y.error("Error while sending envelope:",n),n)):(we&&Y.error("Transport disabled"),us({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=Zb(this,e),P1(this,e)}_updateSessionFromEvent(e,n){let r=!1,s=!1;const i=n.exception&&n.exception.values;if(i){s=!0;for(const l of i){const c=l.mechanism;if(c&&c.handled===!1){r=!0;break}}}const o=e.status==="ok";(o&&e.errors===0||o&&r)&&(Xo(e,{...r&&{status:"crashed"},errors:e.errors||Number(s||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new Kn(n=>{let r=0;const s=1,i=setInterval(()=>{this._numProcessing==0?(clearInterval(i),n(!0)):(r+=s,e&&r>=e&&(clearInterval(i),n(!1)))},s)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r,s=dr()){const i=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&o.length>0&&(n.integrations=o),this.emit("preprocessEvent",e,n),e.type||s.setLastEventId(e.event_id||n.event_id),Uv(i,e,n,r,this,s).then(a=>{if(a===null)return a;const l={...s.getPropagationContext(),...r?r.getPropagationContext():void 0};if(!(a.contexts&&a.contexts.trace)&&l){const{traceId:d,spanId:u,parentSpanId:f,dsc:h}=l;a.contexts={trace:kt({trace_id:d,span_id:u,parent_span_id:f}),...a.contexts};const p=h||lf(d,this);a.sdkProcessingMetadata={dynamicSamplingContext:p,...a.sdkProcessingMetadata}}return a})}_captureEvent(e,n={},r){return this._processEvent(e,n,r).then(s=>s.event_id,s=>{if(we){const i=s;i.logLevel==="log"?Y.log(i.message):Y.warn(i)}})}_processEvent(e,n,r){const s=this.getOptions(),{sampleRate:i}=s,o=Xv(e),a=Gv(e),l=e.type||"error",c=`before send for type \`${l}\``,d=typeof i>"u"?void 0:td(i);if(a&&typeof d=="number"&&Math.random()>d)return this.recordDroppedEvent("sample_rate","error",e),Qu(new Lr(`Discarding event because it's not included in the random sample (sampling rate = ${i})`,"log"));const u=l==="replay_event"?"replay":l,h=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,n,r,h).then(p=>{if(p===null)throw this.recordDroppedEvent("event_processor",u,e),new Lr("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return p;const _=r6(this,s,p,n);return n6(_,c)}).then(p=>{if(p===null){if(this.recordDroppedEvent("before_send",u,e),o){const y=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",y)}throw new Lr(`${c} returned \`null\`, will not send event.`,"log")}const m=r&&r.getSession();if(!o&&m&&this._updateSessionFromEvent(m,p),o){const g=p.sdkProcessingMetadata&&p.sdkProcessingMetadata.spanCountBeforeProcessing||0,y=p.spans?p.spans.length:0,w=g-y;w>0&&this.recordDroppedEvent("before_send","span",w)}const _=p.transaction_info;if(o&&_&&p.transaction!==e.transaction){const g="custom";p.transaction_info={..._,source:g}}return this.sendEvent(p,n),p}).then(null,p=>{throw p instanceof Lr?p:(this.captureException(p,{data:{__sentry__:!0},originalException:p}),new Lr(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${p}`))})}_process(e){this._numProcessing++,e.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([n,r])=>{const[s,i]=n.split(":");return{reason:s,category:i,quantity:r}})}_flushOutcomes(){we&&Y.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0){we&&Y.log("No outcomes to send");return}if(!this._dsn){we&&Y.log("No dsn provided, will not send outcomes");return}we&&Y.log("Sending outcomes:",e);const n=e6(e,this._options.tunnel&&dc(this._dsn));this.sendEnvelope(n)}}function n6(t,e){const n=`${e} must return \`null\` or a valid event.`;if(rf(t))return t.then(r=>{if(!Go(r)&&r!==null)throw new Lr(n);return r},r=>{throw new Lr(`${e} rejected with ${r}`)});if(!Go(t)&&t!==null)throw new Lr(n);return t}function r6(t,e,n,r){const{beforeSend:s,beforeSendTransaction:i,beforeSendSpan:o}=e;if(Gv(n)&&s)return s(n,r);if(Xv(n)){if(n.spans&&o){const a=[];for(const l of n.spans){const c=o(l);c?a.push(c):t.recordDroppedEvent("before_send","span")}n.spans=a}if(i){if(n.spans){const a=n.spans.length;n.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:a}}return i(n,r)}}return n}function Gv(t){return t.type===void 0}function Xv(t){return t.type==="transaction"}function s6(t,e){e.debug===!0&&(we?Y.enable():wa(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),Ke().update(e.initialScope);const r=new t(e);return i6(r),r.init(),r}function i6(t){Ke().setClient(t)}function o6(t){const e=[];function n(){return t===void 0||e.length<t}function r(o){return e.splice(e.indexOf(o),1)[0]||Promise.resolve(void 0)}function s(o){if(!n())return Qu(new Lr("Not adding Promise because buffer limit was reached."));const a=o();return e.indexOf(a)===-1&&e.push(a),a.then(()=>r(a)).then(null,()=>r(a).then(null,()=>{})),a}function i(o){return new Kn((a,l)=>{let c=e.length;if(!c)return a(!0);const d=setTimeout(()=>{o&&o>0&&a(!1)},o);e.forEach(u=>{us(u).then(()=>{--c||(clearTimeout(d),a(!0))},l)})})}return{$:e,add:s,drain:i}}const a6=60*1e3;function l6(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${t}`);return isNaN(r)?a6:r-e}function c6(t,e){return t[e]||t.all||0}function Yv(t,e,n=Date.now()){return c6(t,e)>n}function qv(t,{statusCode:e,headers:n},r=Date.now()){const s={...t},i=n&&n["x-sentry-rate-limits"],o=n&&n["retry-after"];if(i)for(const a of i.trim().split(",")){const[l,c,,,d]=a.split(":",5),u=parseInt(l,10),f=(isNaN(u)?60:u)*1e3;if(!c)s.all=r+f;else for(const h of c.split(";"))h==="metric_bucket"?(!d||d.split(";").includes("custom"))&&(s[h]=r+f):s[h]=r+f}else o?s.all=r+l6(o,r):e===429&&(s.all=r+60*1e3);return s}const u6=64;function d6(t,e,n=o6(t.bufferSize||u6)){let r={};const s=o=>n.drain(o);function i(o){const a=[];if(x1(o,(u,f)=>{const h=I1(f);if(Yv(r,h)){const p=U1(u,f);t.recordDroppedEvent("ratelimit_backoff",h,p)}else a.push(u)}),a.length===0)return us({});const l=Qi(o[0],a),c=u=>{x1(l,(f,h)=>{const p=U1(f,h);t.recordDroppedEvent(u,I1(h),p)})},d=()=>e({body:db(l)}).then(u=>(u.statusCode!==void 0&&(u.statusCode<200||u.statusCode>=300)&&we&&Y.warn(`Sentry responded with status code ${u.statusCode} to sent event.`),r=qv(r,u),u),u=>{throw c("network_error"),u});return n.add(d).then(u=>u,u=>{if(u instanceof Lr)return we&&Y.error("Skipped sending event because buffer is full."),c("queue_overflow"),us({});throw u})}return{send:i,flush:s}}function U1(t,e){if(!(e!=="event"&&e!=="transaction"))return Array.isArray(t)?t[1]:void 0}function f6(t,e){const n=e&&e.getDsn(),r=e&&e.getOptions().tunnel;return p6(t,n)||h6(t,r)}function h6(t,e){return e?B1(t)===B1(e):!1}function p6(t,e){return e?t.includes(e.host):!1}function B1(t){return t[t.length-1]==="/"?t.slice(0,-1):t}function Kv(t,e,n=[e],r="npm"){const s=t._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${e}`,packages:n.map(i=>({name:`${r}:@sentry/${i}`,version:Mi})),version:Mi}),t._metadata=s}const m6=100;function Zs(t,e){const n=Re(),r=dr();if(!n)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:i=m6}=n.getOptions();if(i<=0)return;const a={timestamp:cc(),...t},l=s?wa(()=>s(a,e)):a;l!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",l,e),r.addBreadcrumb(l,i))}let H1;const g6="FunctionToString",z1=new WeakMap,y6=()=>({name:g6,setupOnce(){H1=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=lg(this),n=z1.has(Re())&&e!==void 0?e:this;return H1.apply(n,t)}}catch{}},setup(t){z1.set(t,!0)}}),w6=y6,S6=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler"],v6="InboundFilters",_6=(t={})=>({name:v6,processEvent(e,n,r){const s=r.getOptions(),i=E6(t,s);return k6(e,i)?null:e}}),C6=_6;function E6(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:S6],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[]],ignoreInternal:t.ignoreInternal!==void 0?t.ignoreInternal:!0}}function k6(t,e){return e.ignoreInternal&&M6(t)?(we&&Y.warn(`Event dropped due to being internal Sentry Error.
Event: ${Is(t)}`),!0):x6(t,e.ignoreErrors)?(we&&Y.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Is(t)}`),!0):A6(t)?(we&&Y.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Is(t)}`),!0):I6(t,e.ignoreTransactions)?(we&&Y.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Is(t)}`),!0):b6(t,e.denyUrls)?(we&&Y.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Is(t)}.
Url: ${nd(t)}`),!0):T6(t,e.allowUrls)?!1:(we&&Y.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Is(t)}.
Url: ${nd(t)}`),!0)}function x6(t,e){return t.type||!e||!e.length?!1:R6(t).some(n=>Bs(n,e))}function I6(t,e){if(t.type!=="transaction"||!e||!e.length)return!1;const n=t.transaction;return n?Bs(n,e):!1}function b6(t,e){if(!e||!e.length)return!1;const n=nd(t);return n?Bs(n,e):!1}function T6(t,e){if(!e||!e.length)return!0;const n=nd(t);return n?Bs(n,e):!0}function R6(t){const e=[];t.message&&e.push(t.message);let n;try{n=t.exception.values[t.exception.values.length-1]}catch{}return n&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`)),e}function M6(t){try{return t.exception.values[0].type==="SentryError"}catch{}return!1}function N6(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function nd(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?N6(e):null}catch{return we&&Y.error(`Cannot extract url for event ${Is(t)}`),null}}function A6(t){return t.type||!t.exception||!t.exception.values||t.exception.values.length===0?!1:!t.message&&!t.exception.values.some(e=>e.stacktrace||e.type&&e.type!=="Error"||e.value)}function D6(t,e,n=250,r,s,i,o){if(!i.exception||!i.exception.values||!o||!ls(o.originalException,Error))return;const a=i.exception.values.length>0?i.exception.values[i.exception.values.length-1]:void 0;a&&(i.exception.values=O6(ap(t,e,s,o.originalException,r,i.exception.values,a,0),n))}function ap(t,e,n,r,s,i,o,a){if(i.length>=n+1)return i;let l=[...i];if(ls(r[s],Error)){j1(o,a);const c=t(e,r[s]),d=l.length;W1(c,s,d,a),l=ap(t,e,n,r[s],s,[c,...l],c,d)}return Array.isArray(r.errors)&&r.errors.forEach((c,d)=>{if(ls(c,Error)){j1(o,a);const u=t(e,c),f=l.length;W1(u,`errors[${d}]`,f,a),l=ap(t,e,n,c,s,[u,...l],u,f)}}),l}function j1(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,...t.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function W1(t,e,n,r){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:r}}function O6(t,e){return t.map(n=>(n.value&&(n.value=Lo(n.value,e)),n))}function Di(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}function L6(t){const e="console";li(e,t),ci(e,F6)}function F6(){"console"in De&&Kh.forEach(function(t){t in De.console&&Cn(De.console,t,function(e){return Ju[t]=e,function(...n){ir("console",{args:n,level:t});const s=Ju[t];s&&s.apply(De.console,n)}})})}const P6=["fatal","error","warning","log","info","debug"];function Jv(t){return t==="warn"?"warning":P6.includes(t)?t:"log"}const $6="Dedupe",U6=()=>{let t;return{name:$6,processEvent(e){if(e.type)return e;try{if(H6(e,t))return we&&Y.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}},B6=U6;function H6(t,e){return e?!!(z6(t,e)||j6(t,e)):!1}function z6(t,e){const n=t.message,r=e.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!Zv(t,e)||!Qv(t,e))}function j6(t,e){const n=V1(e),r=V1(t);return!(!n||!r||n.type!==r.type||n.value!==r.value||!Zv(t,e)||!Qv(t,e))}function Qv(t,e){let n=f1(t),r=f1(e);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let s=0;s<r.length;s++){const i=r[s],o=n[s];if(i.filename!==o.filename||i.lineno!==o.lineno||i.colno!==o.colno||i.function!==o.function)return!1}return!0}function Zv(t,e){let n=t.fingerprint,r=e.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function V1(t){return t.exception&&t.exception.values&&t.exception.values[0]}function W6(t,e,n,r,s="auto.http.browser"){if(!t.fetchData)return;const i=ds()&&e(t.fetchData.url);if(t.endTimestamp&&i){const p=t.fetchData.__span;if(!p)return;const m=r[p];m&&(X6(m,t),delete r[p]);return}const o=Ke(),a=Re(),{method:l,url:c}=t.fetchData,d=G6(c),u=d?Di(d).host:void 0,f=!!Gt(),h=i&&f?fc({name:`${l} ${c}`,attributes:{url:c,type:"fetch","http.method":l,"http.url":d,"server.address":u,[Dt]:s,[Hi]:"http.client"}}):new _a;if(t.fetchData.__span=h.spanContext().spanId,r[h.spanContext().spanId]=h,n(t.fetchData.url)&&a){const p=t.args[0];t.args[1]=t.args[1]||{};const m=t.args[1];m.headers=V6(p,a,o,m,ds()&&f?h:void 0)}return h}function V6(t,e,n,r,s){const i=dr(),{traceId:o,spanId:a,sampled:l,dsc:c}={...i.getPropagationContext(),...n.getPropagationContext()},d=s?Iv(s):hg(o,a,l),u=Ev(c||(s?ui(s):lf(o,e))),f=r.headers||(typeof Request<"u"&&ls(t,Request)?t.headers:void 0);if(f)if(typeof Headers<"u"&&ls(f,Headers)){const h=new Headers(f);if(h.set("sentry-trace",d),u){const p=h.get(uo);if(p){const m=Hc(p);h.set(uo,m?`${m},${u}`:u)}else h.set(uo,u)}return h}else if(Array.isArray(f)){const h=[...f.filter(p=>!(Array.isArray(p)&&p[0]==="sentry-trace")).map(p=>{if(Array.isArray(p)&&p[0]===uo&&typeof p[1]=="string"){const[m,_,...g]=p;return[m,Hc(_),...g]}else return p}),["sentry-trace",d]];return u&&h.push([uo,u]),h}else{const h="baggage"in f?f.baggage:void 0;let p=[];return Array.isArray(h)?p=h.map(m=>typeof m=="string"?Hc(m):m).filter(m=>m===""):h&&p.push(Hc(h)),u&&p.push(u),{...f,"sentry-trace":d,baggage:p.length>0?p.join(","):void 0}}else return{"sentry-trace":d,baggage:u}}function G6(t){try{return new URL(t).href}catch{return}}function X6(t,e){if(e.response){_v(t,e.response.status);const n=e.response&&e.response.headers&&e.response.headers.get("content-length");if(n){const r=parseInt(n);r>0&&t.setAttribute("http.response_content_length",r)}}else e.error&&t.setStatus({code:Tt,message:"internal_error"});t.end()}function Hc(t){return t.split(",").filter(e=>!e.split("=")[0].startsWith(fg)).join(",")}function e_(t){if(t!==void 0)return t>=400&&t<500?"warning":t>=500?"error":void 0}const lp=De;function t_(){if(!("fetch"in lp))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function cp(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function Y6(){if(typeof EdgeRuntime=="string")return!0;if(!t_())return!1;if(cp(lp.fetch))return!0;let t=!1;const e=lp.document;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(t=cp(n.contentWindow.fetch)),e.head.removeChild(n)}catch(n){ai&&Y.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return t}function n_(t,e){const n="fetch";li(n,t),ci(n,()=>r_(void 0,e))}function q6(t){const e="fetch-body-resolved";li(e,t),ci(e,()=>r_(J6))}function r_(t,e=!1){e&&!Y6()||Cn(De,"fetch",function(n){return function(...r){const{method:s,url:i}=Q6(r),o={args:r,fetchData:{method:s,url:i},startTimestamp:cn()*1e3};t||ir("fetch",{...o});const a=new Error().stack;return n.apply(De,r).then(async l=>(t?t(l):ir("fetch",{...o,endTimestamp:cn()*1e3,response:l}),l),l=>{throw ir("fetch",{...o,endTimestamp:cn()*1e3,error:l}),ig(l)&&l.stack===void 0&&(l.stack=a,lr(l,"framesToPop",1)),l})}})}async function K6(t,e){if(t&&t.body){const n=t.body,r=n.getReader(),s=setTimeout(()=>{n.cancel().then(null,()=>{})},90*1e3);let i=!0;for(;i;){let o;try{o=setTimeout(()=>{n.cancel().then(null,()=>{})},5e3);const{done:a}=await r.read();clearTimeout(o),a&&(e(),i=!1)}catch{i=!1}finally{clearTimeout(o)}}clearTimeout(s),r.releaseLock(),n.cancel().then(null,()=>{})}}function J6(t){let e;try{e=t.clone()}catch{return}K6(e,()=>{ir("fetch-body-resolved",{endTimestamp:cn()*1e3,response:t})})}function up(t,e){return!!t&&typeof t=="object"&&!!t[e]}function G1(t){return typeof t=="string"?t:t?up(t,"url")?t.url:t.toString?t.toString():"":""}function Q6(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[n,r]=t;return{url:G1(n),method:up(r,"method")?String(r.method).toUpperCase():"GET"}}const e=t[0];return{url:G1(e),method:up(e,"method")?String(e.method).toUpperCase():"GET"}}function Z6(){return typeof __SENTRY_BROWSER_BUNDLE__<"u"&&!!__SENTRY_BROWSER_BUNDLE__}function eT(){return"npm"}function tT(){return!Z6()&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function X1(){return typeof window<"u"&&(!tT()||nT())}function nT(){return De.process!==void 0&&De.process.type==="renderer"}const zc=De;function rT(){const t=zc.chrome,e=t&&t.app&&t.app.runtime,n="history"in zc&&!!zc.history.pushState&&!!zc.history.replaceState;return!e&&n}function sT(t,e){return t??e()}function Ln(t){let e,n=t[0],r=1;for(;r<t.length;){const s=t[r],i=t[r+1];if(r+=2,(s==="optionalAccess"||s==="optionalCall")&&n==null)return;s==="access"||s==="optionalAccess"?(e=n,n=i(n)):(s==="call"||s==="optionalCall")&&(n=i((...o)=>n.call(e,...o)),e=void 0)}return n}const ge=De;let dp=0;function s_(){return dp>0}function iT(){dp++,setTimeout(()=>{dp--})}function qo(t,e={},n){if(typeof t!="function")return t;try{const s=t.__sentry_wrapped__;if(s)return typeof s=="function"?s:t;if(lg(t))return t}catch{return t}const r=function(){const s=Array.prototype.slice.call(arguments);try{const i=s.map(o=>qo(o,e));return t.apply(this,i)}catch(i){throw iT(),ug(o=>{o.addEventProcessor(a=>(e.mechanism&&(Qh(a,void 0),yl(a,e.mechanism)),a.extra={...a.extra,arguments:s},a)),Bv(i)}),i}};try{for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}catch{}mv(r,t),lr(t,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return t.name}})}catch{}return r}const Ir=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function yg(t,e){const n=wg(t,e),r={type:uT(e),value:dT(e)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function oT(t,e,n,r){const s=Re(),i=s&&s.getOptions().normalizeDepth,o=gT(e),a={__serialized__:Dv(e,i)};if(o)return{exception:{values:[yg(t,o)]},extra:a};const l={exception:{values:[{type:nf(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:pT(e,{isUnhandledRejection:r})}]},extra:a};if(n){const c=wg(t,n);c.length&&(l.exception.values[0].stacktrace={frames:c})}return l}function Xf(t,e){return{exception:{values:[yg(t,e)]}}}function wg(t,e){const n=e.stacktrace||e.stack||"",r=lT(e),s=cT(e);try{return t(n,r,s)}catch{}return[]}const aT=/Minified React error #\d+;/i;function lT(t){return t&&aT.test(t.message)?1:0}function cT(t){return typeof t.framesToPop=="number"?t.framesToPop:0}function i_(t){return typeof WebAssembly<"u"&&typeof WebAssembly.Exception<"u"?t instanceof WebAssembly.Exception:!1}function uT(t){const e=t&&t.name;return!e&&i_(t)?t.message&&Array.isArray(t.message)&&t.message.length==2?t.message[0]:"WebAssembly.Exception":e}function dT(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:i_(t)&&Array.isArray(t.message)&&t.message.length==2?t.message[1]:e:"No error message"}function fT(t,e,n,r){const s=n&&n.syntheticException||void 0,i=Sg(t,e,s,r);return yl(i),i.level="error",n&&n.event_id&&(i.event_id=n.event_id),us(i)}function hT(t,e,n="info",r,s){const i=r&&r.syntheticException||void 0,o=fp(t,e,i,s);return o.level=n,r&&r.event_id&&(o.event_id=r.event_id),us(o)}function Sg(t,e,n,r,s){let i;if(dv(e)&&e.error)return Xf(t,e.error);if(p1(e)||u2(e)){const o=e;if("stack"in e)i=Xf(t,e);else{const a=o.name||(p1(o)?"DOMError":"DOMException"),l=o.message?`${a}: ${o.message}`:a;i=fp(t,l,n,r),Qh(i,l)}return"code"in o&&(i.tags={...i.tags,"DOMException.code":`${o.code}`}),i}return ig(e)?Xf(t,e):Go(e)||nf(e)?(i=oT(t,e,n,s),yl(i,{synthetic:!0}),i):(i=fp(t,e,n,r),Qh(i,`${e}`),yl(i,{synthetic:!0}),i)}function fp(t,e,n,r){const s={};if(r&&n){const i=wg(t,n);i.length&&(s.exception={values:[{value:e,stacktrace:{frames:i}}]})}if(og(e)){const{__sentry_template_string__:i,__sentry_template_values__:o}=e;return s.logentry={message:i,params:o},s}return s.message=e,s}function pT(t,{isUnhandledRejection:e}){const n=S2(t),r=e?"promise rejection":"exception";return dv(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:nf(t)?`Event \`${mT(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function mT(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function gT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const n=t[e];if(n instanceof Error)return n}}function yT(t,{metadata:e,tunnel:n,dsn:r}){const s={event_id:t.event_id,sent_at:new Date().toISOString(),...e&&e.sdk&&{sdk:{name:e.sdk.name,version:e.sdk.version}},...!!n&&!!r&&{dsn:dc(r)}},i=wT(t);return Qi(s,[i])}function wT(t){return[{type:"user_report"},t]}class ST extends t6{constructor(e){const n={parentSpanIsAlwaysRootSpan:!0,...e},r=ge.SENTRY_SDK_SOURCE||eT();Kv(n,"browser",["browser"],r),super(n),n.sendClientReports&&ge.document&&ge.document.addEventListener("visibilitychange",()=>{ge.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,n){return fT(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return hT(this._options.stackParser,e,n,r,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled()){Ir&&Y.warn("SDK not enabled, will not capture user feedback.");return}const n=yT(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(n)}_prepareEvent(e,n,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,r)}}const Pn=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,vT=(t,e)=>t>e[1]?"poor":t>e[0]?"needs-improvement":"good",Ca=(t,e,n,r)=>{let s,i;return o=>{e.value>=0&&(o||r)&&(i=e.value-(s||0),(i||s===void 0)&&(s=e.value,e.delta=i,e.rating=vT(e.value,n),t(e)))}},de=De,_T=()=>`v3-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`,hc=()=>de.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],pc=()=>{const t=hc();return t&&t.activationStart||0},Ea=(t,e)=>{const n=hc();let r="navigate";return n&&(de.document&&de.document.prerendering||pc()>0?r="prerender":de.document&&de.document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:t,value:typeof e>"u"?-1:e,rating:"good",delta:0,entries:[],id:_T(),navigationType:r}},Zi=(t,e,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver(s=>{Promise.resolve().then(()=>{e(s.getEntries())})});return r.observe(Object.assign({type:t,buffered:!0},n||{})),r}}catch{}},mc=t=>{const e=n=>{(n.type==="pagehide"||de.document&&de.document.visibilityState==="hidden")&&t(n)};de.document&&(addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0))},vg=t=>{let e=!1;return n=>{e||(t(n),e=!0)}};let Sl=-1;const CT=()=>{Sl=de.document.visibilityState==="hidden"&&!de.document.prerendering?0:1/0},rd=t=>{de.document.visibilityState==="hidden"&&Sl>-1&&(Sl=t.type==="visibilitychange"?t.timeStamp:0,removeEventListener("visibilitychange",rd,!0),removeEventListener("prerenderingchange",rd,!0))},ET=()=>{addEventListener("visibilitychange",rd,!0),addEventListener("prerenderingchange",rd,!0)},cf=()=>(de.document&&Sl<0&&(CT(),ET()),{get firstHiddenTime(){return Sl}}),gc=t=>{de.document&&de.document.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},kT=[1800,3e3],xT=(t,e={})=>{gc(()=>{const n=cf(),r=Ea("FCP");let s;const o=Zi("paint",a=>{a.forEach(l=>{l.name==="first-contentful-paint"&&(o.disconnect(),l.startTime<n.firstHiddenTime&&(r.value=Math.max(l.startTime-pc(),0),r.entries.push(l),s(!0)))})});o&&(s=Ca(t,r,kT,e.reportAllChanges))})},IT=[.1,.25],bT=(t,e={})=>{xT(vg(()=>{const n=Ea("CLS",0);let r,s=0,i=[];const o=l=>{l.forEach(c=>{if(!c.hadRecentInput){const d=i[0],u=i[i.length-1];s&&d&&u&&c.startTime-u.startTime<1e3&&c.startTime-d.startTime<5e3?(s+=c.value,i.push(c)):(s=c.value,i=[c])}}),s>n.value&&(n.value=s,n.entries=i,r())},a=Zi("layout-shift",o);a&&(r=Ca(t,n,IT,e.reportAllChanges),mc(()=>{o(a.takeRecords()),r(!0)}),setTimeout(r,0))}))},TT=[100,300],RT=(t,e={})=>{gc(()=>{const n=cf(),r=Ea("FID");let s;const i=l=>{l.startTime<n.firstHiddenTime&&(r.value=l.processingStart-l.startTime,r.entries.push(l),s(!0))},o=l=>{l.forEach(i)},a=Zi("first-input",o);s=Ca(t,r,TT,e.reportAllChanges),a&&mc(vg(()=>{o(a.takeRecords()),a.disconnect()}))})};let o_=0,Yf=1/0,jc=0;const MT=t=>{t.forEach(e=>{e.interactionId&&(Yf=Math.min(Yf,e.interactionId),jc=Math.max(jc,e.interactionId),o_=jc?(jc-Yf)/7+1:0)})};let hp;const NT=()=>hp?o_:performance.interactionCount||0,AT=()=>{"interactionCount"in performance||hp||(hp=Zi("event",MT,{type:"event",buffered:!0,durationThreshold:0}))},DT=[200,500],OT=0,a_=()=>NT()-OT,Y1=10,Jr=[],qf={},q1=t=>{const e=Jr[Jr.length-1],n=qf[t.interactionId];if(n||Jr.length<Y1||e&&t.duration>e.latency){if(n)n.entries.push(t),n.latency=Math.max(n.latency,t.duration);else{const r={id:t.interactionId,latency:t.duration,entries:[t]};qf[r.id]=r,Jr.push(r)}Jr.sort((r,s)=>s.latency-r.latency),Jr.splice(Y1).forEach(r=>{delete qf[r.id]})}},LT=()=>{const t=Math.min(Jr.length-1,Math.floor(a_()/50));return Jr[t]},FT=(t,e={})=>{gc(()=>{AT();const n=Ea("INP");let r;const s=o=>{o.forEach(l=>{l.interactionId&&q1(l),l.entryType==="first-input"&&!Jr.some(d=>d.entries.some(u=>l.duration===u.duration&&l.startTime===u.startTime))&&q1(l)});const a=LT();a&&a.latency!==n.value&&(n.value=a.latency,n.entries=a.entries,r())},i=Zi("event",s,{durationThreshold:e.durationThreshold!=null?e.durationThreshold:40});r=Ca(t,n,DT,e.reportAllChanges),i&&("PerformanceEventTiming"in de&&"interactionId"in PerformanceEventTiming.prototype&&i.observe({type:"first-input",buffered:!0}),mc(()=>{s(i.takeRecords()),n.value<0&&a_()>0&&(n.value=0,n.entries=[]),r(!0)}))})},PT=[2500,4e3],K1={},$T=(t,e={})=>{gc(()=>{const n=cf(),r=Ea("LCP");let s;const i=a=>{const l=a[a.length-1];l&&l.startTime<n.firstHiddenTime&&(r.value=Math.max(l.startTime-pc(),0),r.entries=[l],s())},o=Zi("largest-contentful-paint",i);if(o){s=Ca(t,r,PT,e.reportAllChanges);const a=vg(()=>{K1[r.id]||(i(o.takeRecords()),o.disconnect(),K1[r.id]=!0,s(!0))});["keydown","click"].forEach(l=>{de.document&&addEventListener(l,()=>setTimeout(a,0),!0)}),mc(a)}})},UT=[800,1800],pp=t=>{de.document&&de.document.prerendering?gc(()=>pp(t)):de.document&&de.document.readyState!=="complete"?addEventListener("load",()=>pp(t),!0):setTimeout(t,0)},BT=(t,e={})=>{const n=Ea("TTFB"),r=Ca(t,n,UT,e.reportAllChanges);pp(()=>{const s=hc();if(s){const i=s.responseStart;if(i<=0||i>performance.now())return;n.value=Math.max(i-pc(),0),n.entries=[s],r(!0)}})},Ja={},sd={};let l_,c_,u_,d_,f_;function _g(t,e=!1){return yc("cls",t,zT,l_,e)}function h_(t,e=!1){return yc("lcp",t,WT,u_,e)}function p_(t){return yc("fid",t,jT,c_)}function HT(t){return yc("ttfb",t,VT,d_)}function m_(t){return yc("inp",t,GT,f_)}function Ko(t,e){return g_(t,e),sd[t]||(XT(t),sd[t]=!0),y_(t,e)}function ka(t,e){const n=Ja[t];if(!(!n||!n.length))for(const r of n)try{r(e)}catch(s){Pn&&Y.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${as(r)}
Error:`,s)}}function zT(){return bT(t=>{ka("cls",{metric:t}),l_=t},{reportAllChanges:!0})}function jT(){return RT(t=>{ka("fid",{metric:t}),c_=t})}function WT(){return $T(t=>{ka("lcp",{metric:t}),u_=t},{reportAllChanges:!0})}function VT(){return BT(t=>{ka("ttfb",{metric:t}),d_=t})}function GT(){return FT(t=>{ka("inp",{metric:t}),f_=t})}function yc(t,e,n,r,s=!1){g_(t,e);let i;return sd[t]||(i=n(),sd[t]=!0),r&&e({metric:r}),y_(t,e,s?i:void 0)}function XT(t){const e={};t==="event"&&(e.durationThreshold=0),Zi(t,n=>{ka(t,{entries:n})},e)}function g_(t,e){Ja[t]=Ja[t]||[],Ja[t].push(e)}function y_(t,e,n){return()=>{n&&n();const r=Ja[t];if(!r)return;const s=r.indexOf(e);s!==-1&&r.splice(s,1)}}function YT(t){return"duration"in t}function Kf(t){return typeof t=="number"&&isFinite(t)}function fs(t,e,n,{...r}){const s=Ae(t).start_timestamp;return s&&s>e&&typeof t.updateStartTime=="function"&&t.updateStartTime(e),Fv(t,()=>{const i=fc({startTime:e,...r});return i&&i.end(n),i})}function w_(t){const e=Re();if(!e)return;const{name:n,transaction:r,attributes:s,startTime:i}=t,{release:o,environment:a}=e.getOptions(),l=e.getIntegrationByName("Replay"),c=l&&l.getReplayId(),d=Ke(),u=d.getUser(),f=u!==void 0?u.email||u.id||u.ip_address:void 0;let h;try{h=d.getScopeData().contexts.profile.profile_id}catch{}const p={release:o,environment:a,user:f||void 0,profile_id:h||void 0,replay_id:c||void 0,transaction:r,"user_agent.original":de.navigator&&de.navigator.userAgent,...s};return fc({name:n,attributes:p,startTime:i,experimental:{standalone:!0}})}function Cg(){return de&&de.addEventListener&&de.performance}function mt(t){return t/1e3}function qT(){let t=0,e,n;if(!JT())return;let r=!1;function s(){r||(r=!0,n&&KT(t,e,n),i())}const i=_g(({metric:o})=>{const a=o.entries[o.entries.length-1];a&&(t=o.value,e=a)},!0);mc(()=>{s()}),setTimeout(()=>{const o=Re(),a=Ln([o,"optionalAccess",u=>u.on,"call",u=>u("startNavigationSpan",()=>{s(),a&&a()})]),l=Gt(),c=l&&zt(l),d=c&&Ae(c);d&&d.op==="pageload"&&(n=c.spanContext().spanId)},0)}function KT(t,e,n){Pn&&Y.log(`Sending CLS span (${t})`);const r=mt((dn||0)+(Ln([e,"optionalAccess",l=>l.startTime])||0)),s=Ke().getScopeData().transactionName,i=e?cs(Ln([e,"access",l=>l.sources,"access",l=>l[0],"optionalAccess",l=>l.node])):"Layout shift",o=kt({[Dt]:"auto.http.browser.cls",[Hi]:"ui.webvital.cls",[dg]:Ln([e,"optionalAccess",l=>l.duration])||0,"sentry.pageload.span_id":n}),a=w_({name:i,transaction:s,attributes:o,startTime:r});Ln([a,"optionalAccess",l=>l.addEvent,"call",l=>l("cls",{[of]:"",[af]:t})]),Ln([a,"optionalAccess",l=>l.end,"call",l=>l(r)])}function JT(){try{return Ln([PerformanceObserver,"access",t=>t.supportedEntryTypes,"optionalAccess",t=>t.includes,"call",t=>t("layout-shift")])}catch{return!1}}const QT=2147483647;let J1=0,Pt={},yn,Qa;function ZT({recordClsStandaloneSpans:t}){const e=Cg();if(e&&dn){e.mark&&de.performance.mark("sentry-tracing-init");const n=iR(),r=sR(),s=oR(),i=t?qT():rR();return()=>{n(),r(),s(),i&&i()}}return()=>{}}function eR(){Ko("longtask",({entries:t})=>{const e=Gt();if(!e)return;const{op:n,start_timestamp:r}=Ae(e);for(const s of t){const i=mt(dn+s.startTime),o=mt(s.duration);n==="navigation"&&r&&i<r||fs(e,i,i+o,{name:"Main UI thread blocked",op:"ui.long-task",attributes:{[Dt]:"auto.ui.browser.metrics"}})}})}function tR(){new PerformanceObserver(e=>{const n=Gt();if(n)for(const r of e.getEntries()){if(!r.scripts[0])continue;const s=mt(dn+r.startTime),{start_timestamp:i,op:o}=Ae(n);if(o==="navigation"&&i&&s<i)continue;const a=mt(r.duration),l={[Dt]:"auto.ui.browser.metrics"},c=r.scripts[0],{invoker:d,invokerType:u,sourceURL:f,sourceFunctionName:h,sourceCharPosition:p}=c;l["browser.script.invoker"]=d,l["browser.script.invoker_type"]=u,f&&(l["code.filepath"]=f),h&&(l["code.function"]=h),p!==-1&&(l["browser.script.source_char_position"]=p),fs(n,s,s+a,{name:"Main UI thread blocked",op:"ui.long-animation-frame",attributes:l})}}).observe({type:"long-animation-frame",buffered:!0})}function nR(){Ko("event",({entries:t})=>{const e=Gt();if(e){for(const n of t)if(n.name==="click"){const r=mt(dn+n.startTime),s=mt(n.duration),i={name:cs(n.target),op:`ui.interaction.${n.name}`,startTime:r,attributes:{[Dt]:"auto.ui.browser.metrics"}},o=pv(n.target);o&&(i.attributes["ui.component_name"]=o),fs(e,r,r+s,i)}}})}function rR(){return _g(({metric:t})=>{const e=t.entries[t.entries.length-1];e&&(Pn&&Y.log(`[Measurements] Adding CLS ${t.value}`),Pt.cls={value:t.value,unit:""},Qa=e)},!0)}function sR(){return h_(({metric:t})=>{const e=t.entries[t.entries.length-1];e&&(Pn&&Y.log("[Measurements] Adding LCP"),Pt.lcp={value:t.value,unit:"millisecond"},yn=e)},!0)}function iR(){return p_(({metric:t})=>{const e=t.entries[t.entries.length-1];if(!e)return;const n=mt(dn),r=mt(e.startTime);Pn&&Y.log("[Measurements] Adding FID"),Pt.fid={value:t.value,unit:"millisecond"},Pt["mark.fid"]={value:n+r,unit:"second"}})}function oR(){return HT(({metric:t})=>{t.entries[t.entries.length-1]&&(Pn&&Y.log("[Measurements] Adding TTFB"),Pt.ttfb={value:t.value,unit:"millisecond"})})}function aR(t,e){const n=Cg();if(!n||!de.performance.getEntries||!dn)return;Pn&&Y.log("[Tracing] Adding & adjusting spans using Performance API");const r=mt(dn),s=n.getEntries(),{op:i,start_timestamp:o}=Ae(t);if(s.slice(J1).forEach(a=>{const l=mt(a.startTime),c=mt(Math.max(0,a.duration));if(!(i==="navigation"&&o&&r+l<o))switch(a.entryType){case"navigation":{cR(t,a,r);break}case"mark":case"paint":case"measure":{lR(t,a,l,c,r);const d=cf(),u=a.startTime<d.firstHiddenTime;a.name==="first-paint"&&u&&(Pn&&Y.log("[Measurements] Adding FP"),Pt.fp={value:a.startTime,unit:"millisecond"}),a.name==="first-contentful-paint"&&u&&(Pn&&Y.log("[Measurements] Adding FCP"),Pt.fcp={value:a.startTime,unit:"millisecond"});break}case"resource":{dR(t,a,a.name,l,c,r);break}}}),J1=Math.max(s.length-1,0),fR(t),i==="pageload"){pR(Pt);const a=Pt["mark.fid"];a&&Pt.fid&&(fs(t,a.value,a.value+mt(Pt.fid.value),{name:"first input delay",op:"ui.action",attributes:{[Dt]:"auto.ui.browser.metrics"}}),delete Pt["mark.fid"]),(!("fcp"in Pt)||!e.recordClsOnPageloadSpan)&&delete Pt.cls,Object.entries(Pt).forEach(([l,c])=>{vb(l,c.value,c.unit)}),t.setAttribute("performance.timeOrigin",r),t.setAttribute("performance.activationStart",pc()),hR(t)}yn=void 0,Qa=void 0,Pt={}}function lR(t,e,n,r,s){const i=hc(),o=mt(i?i.requestStart:0),a=s+Math.max(n,o),l=s+n,c=l+r,d={[Dt]:"auto.resource.browser.metrics"};return a!==l&&(d["sentry.browser.measure_happened_before_request"]=!0,d["sentry.browser.measure_start_time"]=a),fs(t,a,c,{name:e.name,op:e.entryType,attributes:d}),a}function cR(t,e,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(r=>{Wc(t,e,r,n)}),Wc(t,e,"secureConnection",n,"TLS/SSL","connectEnd"),Wc(t,e,"fetch",n,"cache","domainLookupStart"),Wc(t,e,"domainLookup",n,"DNS"),uR(t,e,n)}function Wc(t,e,n,r,s,i){const o=i?e[i]:e[`${n}End`],a=e[`${n}Start`];!a||!o||fs(t,r+mt(a),r+mt(o),{op:`browser.${s||n}`,name:e.name,attributes:{[Dt]:"auto.ui.browser.metrics"}})}function uR(t,e,n){const r=n+mt(e.requestStart),s=n+mt(e.responseEnd),i=n+mt(e.responseStart);e.responseEnd&&(fs(t,r,s,{op:"browser.request",name:e.name,attributes:{[Dt]:"auto.ui.browser.metrics"}}),fs(t,i,s,{op:"browser.response",name:e.name,attributes:{[Dt]:"auto.ui.browser.metrics"}}))}function dR(t,e,n,r,s,i){if(e.initiatorType==="xmlhttprequest"||e.initiatorType==="fetch")return;const o=Di(n),a={[Dt]:"auto.resource.browser.metrics"};Jf(a,e,"transferSize","http.response_transfer_size"),Jf(a,e,"encodedBodySize","http.response_content_length"),Jf(a,e,"decodedBodySize","http.decoded_response_content_length"),e.deliveryType!=null&&(a["http.response_delivery_type"]=e.deliveryType),"renderBlockingStatus"in e&&(a["resource.render_blocking_status"]=e.renderBlockingStatus),o.protocol&&(a["url.scheme"]=o.protocol.split(":").pop()),o.host&&(a["server.address"]=o.host),a["url.same_origin"]=n.includes(de.location.origin);const l=i+r,c=l+s;fs(t,l,c,{name:n.replace(de.location.origin,""),op:e.initiatorType?`resource.${e.initiatorType}`:"resource.other",attributes:a})}function fR(t){const e=de.navigator;if(!e)return;const n=e.connection;n&&(n.effectiveType&&t.setAttribute("effectiveConnectionType",n.effectiveType),n.type&&t.setAttribute("connectionType",n.type),Kf(n.rtt)&&(Pt["connection.rtt"]={value:n.rtt,unit:"millisecond"})),Kf(e.deviceMemory)&&t.setAttribute("deviceMemory",`${e.deviceMemory} GB`),Kf(e.hardwareConcurrency)&&t.setAttribute("hardwareConcurrency",String(e.hardwareConcurrency))}function hR(t){yn&&(Pn&&Y.log("[Measurements] Adding LCP Data"),yn.element&&t.setAttribute("lcp.element",cs(yn.element)),yn.id&&t.setAttribute("lcp.id",yn.id),yn.url&&t.setAttribute("lcp.url",yn.url.trim().slice(0,200)),yn.loadTime!=null&&t.setAttribute("lcp.loadTime",yn.loadTime),yn.renderTime!=null&&t.setAttribute("lcp.renderTime",yn.renderTime),t.setAttribute("lcp.size",yn.size)),Qa&&Qa.sources&&(Pn&&Y.log("[Measurements] Adding CLS Data"),Qa.sources.forEach((e,n)=>t.setAttribute(`cls.source.${n+1}`,cs(e.node))))}function Jf(t,e,n,r){const s=e[n];s!=null&&s<QT&&(t[r]=s)}function pR(t){const e=hc();if(!e)return;const{responseStart:n,requestStart:r}=e;r<=n&&(Pn&&Y.log("[Measurements] Adding TTFB Request Time"),t["ttfb.requestTime"]={value:n-r,unit:"millisecond"})}const mR=1e3;let Q1,mp,gp;function S_(t){const e="dom";li(e,t),ci(e,gR)}function gR(){if(!de.document)return;const t=ir.bind(null,"dom"),e=Z1(t,!0);de.document.addEventListener("click",e,!1),de.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{const r=de[n]&&de[n].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(Cn(r,"addEventListener",function(s){return function(i,o,a){if(i==="click"||i=="keypress")try{const l=this,c=l.__sentry_instrumentation_handlers__=l.__sentry_instrumentation_handlers__||{},d=c[i]=c[i]||{refCount:0};if(!d.handler){const u=Z1(t);d.handler=u,s.call(this,i,u,a)}d.refCount++}catch{}return s.call(this,i,o,a)}}),Cn(r,"removeEventListener",function(s){return function(i,o,a){if(i==="click"||i=="keypress")try{const l=this,c=l.__sentry_instrumentation_handlers__||{},d=c[i];d&&(d.refCount--,d.refCount<=0&&(s.call(this,i,d.handler,a),d.handler=void 0,delete c[i]),Object.keys(c).length===0&&delete l.__sentry_instrumentation_handlers__)}catch{}return s.call(this,i,o,a)}}))})}function yR(t){if(t.type!==mp)return!1;try{if(!t.target||t.target._sentryId!==gp)return!1}catch{}return!0}function wR(t,e){return t!=="keypress"?!1:!e||!e.tagName?!0:!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)}function Z1(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const r=SR(n);if(wR(n.type,r))return;lr(n,"_sentryCaptured",!0),r&&!r._sentryId&&lr(r,"_sentryId",rt());const s=n.type==="keypress"?"input":n.type;yR(n)||(t({event:n,name:s,global:e}),mp=n.type,gp=r?r._sentryId:void 0),clearTimeout(Q1),Q1=de.setTimeout(()=>{gp=void 0,mp=void 0},mR)}}function SR(t){try{return t.target}catch{return null}}let Vc;function uf(t){const e="history";li(e,t),ci(e,vR)}function vR(){if(!rT())return;const t=de.onpopstate;de.onpopstate=function(...n){const r=de.location.href,s=Vc;if(Vc=r,ir("history",{from:s,to:r}),t)try{return t.apply(this,n)}catch{}};function e(n){return function(...r){const s=r.length>2?r[2]:void 0;if(s){const i=Vc,o=String(s);Vc=o,ir("history",{from:i,to:o})}return n.apply(this,r)}}Cn(de.history,"pushState",e),Cn(de.history,"replaceState",e)}const Mu={};function v_(t){const e=Mu[t];if(e)return e;let n=de[t];if(cp(n))return Mu[t]=n.bind(de);const r=de.document;if(r&&typeof r.createElement=="function")try{const s=r.createElement("iframe");s.hidden=!0,r.head.appendChild(s);const i=s.contentWindow;i&&i[t]&&(n=i[t]),r.head.removeChild(s)}catch(s){Pn&&Y.warn(`Could not create sandbox iframe for ${t} check, bailing to window.${t}: `,s)}return n&&(Mu[t]=n.bind(de))}function ey(t){Mu[t]=void 0}function Jo(...t){return v_("setTimeout")(...t)}const Ei="__sentry_xhr_v3__";function __(t){const e="xhr";li(e,t),ci(e,_R)}function _R(){if(!de.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;t.open=new Proxy(t.open,{apply(e,n,r){const s=cn()*1e3,i=rs(r[0])?r[0].toUpperCase():void 0,o=CR(r[1]);if(!i||!o)return e.apply(n,r);n[Ei]={method:i,url:o,request_headers:{}},i==="POST"&&o.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const a=()=>{const l=n[Ei];if(l&&n.readyState===4){try{l.status_code=n.status}catch{}const c={endTimestamp:cn()*1e3,startTimestamp:s,xhr:n};ir("xhr",c)}};return"onreadystatechange"in n&&typeof n.onreadystatechange=="function"?n.onreadystatechange=new Proxy(n.onreadystatechange,{apply(l,c,d){return a(),l.apply(c,d)}}):n.addEventListener("readystatechange",a),n.setRequestHeader=new Proxy(n.setRequestHeader,{apply(l,c,d){const[u,f]=d,h=c[Ei];return h&&rs(u)&&rs(f)&&(h.request_headers[u.toLowerCase()]=f),l.apply(c,d)}}),e.apply(n,r)}}),t.send=new Proxy(t.send,{apply(e,n,r){const s=n[Ei];if(!s)return e.apply(n,r);r[0]!==void 0&&(s.body=r[0]);const i={startTimestamp:cn()*1e3,xhr:n};return ir("xhr",i),e.apply(n,r)}})}function CR(t){if(rs(t))return t;try{return t.toString()}catch{}}const Qf=[],Nu=new Map;function ER(){if(Cg()&&dn){const e=kR();return()=>{e()}}return()=>{}}const ty={click:"click",pointerdown:"click",pointerup:"click",mousedown:"click",mouseup:"click",touchstart:"click",touchend:"click",mouseover:"hover",mouseout:"hover",mouseenter:"hover",mouseleave:"hover",pointerover:"hover",pointerout:"hover",pointerenter:"hover",pointerleave:"hover",dragstart:"drag",dragend:"drag",drag:"drag",dragenter:"drag",dragleave:"drag",dragover:"drag",drop:"drag",keydown:"press",keyup:"press",keypress:"press",input:"press"};function kR(){return m_(({metric:t})=>{if(t.value==null)return;const e=t.entries.find(p=>p.duration===t.value&&ty[p.name]);if(!e)return;const{interactionId:n}=e,r=ty[e.name],s=mt(dn+e.startTime),i=mt(t.value),o=Gt(),a=o?zt(o):void 0,c=(n!=null?Nu.get(n):void 0)||a,d=c?Ae(c).description:Ke().getScopeData().transactionName,u=cs(e.target),f=kt({[Dt]:"auto.http.browser.inp",[Hi]:`ui.interaction.${r}`,[dg]:e.duration}),h=w_({name:u,transaction:d,attributes:f,startTime:s});Ln([h,"optionalAccess",p=>p.addEvent,"call",p=>p("inp",{[of]:"millisecond",[af]:t.value})]),Ln([h,"optionalAccess",p=>p.end,"call",p=>p(s+i)])})}function xR(t){const e=({entries:n})=>{const r=Gt(),s=r&&zt(r);n.forEach(i=>{if(!YT(i)||!s)return;const o=i.interactionId;if(o!=null&&!Nu.has(o)){if(Qf.length>10){const a=Qf.shift();Nu.delete(a)}Qf.push(o),Nu.set(o,s)}})};Ko("event",e),Ko("first-input",e)}function IR(t,e=v_("fetch")){let n=0,r=0;function s(i){const o=i.body.length;n+=o,r++;const a={body:i.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:n<=6e4&&r<15,...t.fetchOptions};if(!e)return ey("fetch"),Qu("No fetch implementation available");try{return e(t.url,a).then(l=>(n-=o,r--,{statusCode:l.status,headers:{"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")}}))}catch(l){return ey("fetch"),n-=o,r--,Qu(l)}}return d6(t,s)}const bR=30,TR=50;function yp(t,e,n,r){const s={filename:t,function:e==="<anonymous>"?Ui:e,in_app:!0};return n!==void 0&&(s.lineno=n),r!==void 0&&(s.colno=r),s}const RR=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,MR=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,NR=/\((\S*)(?::(\d+))(?::(\d+))\)/,AR=t=>{const e=RR.exec(t);if(e){const[,r,s,i]=e;return yp(r,Ui,+s,+i)}const n=MR.exec(t);if(n){if(n[2]&&n[2].indexOf("eval")===0){const o=NR.exec(n[2]);o&&(n[2]=o[1],n[3]=o[2],n[4]=o[3])}const[s,i]=C_(n[1]||Ui,n[2]);return yp(i,s,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}},DR=[bR,AR],OR=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,LR=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,FR=t=>{const e=OR.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const i=LR.exec(e[3]);i&&(e[1]=e[1]||"eval",e[3]=i[1],e[4]=i[2],e[5]="")}let r=e[3],s=e[1]||Ui;return[s,r]=C_(s,r),yp(r,s,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},PR=[TR,FR],$R=[DR,PR],UR=av(...$R),C_=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:Ui,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},Gc=1024,BR="Breadcrumbs",HR=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:BR,setup(n){e.console&&L6(VR(n)),e.dom&&S_(WR(n,e.dom)),e.xhr&&__(GR(n)),e.fetch&&n_(XR(n)),e.history&&uf(YR(n)),e.sentry&&n.on("beforeSendEvent",jR(n))}}},zR=HR;function jR(t){return function(n){Re()===t&&Zs({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:Is(n)},{event:n})}}function WR(t,e){return function(r){if(Re()!==t)return;let s,i,o=typeof e=="object"?e.serializeAttribute:void 0,a=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;a&&a>Gc&&(Ir&&Y.warn(`\`dom.maxStringLength\` cannot exceed ${Gc}, but a value of ${a} was configured. Sentry will use ${Gc} instead.`),a=Gc),typeof o=="string"&&(o=[o]);try{const c=r.event,d=qR(c)?c.target:c;s=cs(d,{keyAttrs:o,maxStringLength:a}),i=pv(d)}catch{s="<unknown>"}if(s.length===0)return;const l={category:`ui.${r.name}`,message:s};i&&(l.data={"ui.component_name":i}),Zs(l,{event:r.event,name:r.name,global:r.global})}}function VR(t){return function(n){if(Re()!==t)return;const r={category:"console",data:{arguments:n.args,logger:"console"},level:Jv(n.level),message:m1(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)r.message=`Assertion failed: ${m1(n.args.slice(1)," ")||"console.assert"}`,r.data.arguments=n.args.slice(1);else return;Zs(r,{input:n.args,level:n.level})}}function GR(t){return function(n){if(Re()!==t)return;const{startTimestamp:r,endTimestamp:s}=n,i=n.xhr[Ei];if(!r||!s||!i)return;const{method:o,url:a,status_code:l,body:c}=i,d={method:o,url:a,status_code:l},u={xhr:n.xhr,input:c,startTimestamp:r,endTimestamp:s},f=e_(l);Zs({category:"xhr",data:d,type:"http",level:f},u)}}function XR(t){return function(n){if(Re()!==t)return;const{startTimestamp:r,endTimestamp:s}=n;if(s&&!(n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST"))if(n.error){const i=n.fetchData,o={data:n.error,input:n.args,startTimestamp:r,endTimestamp:s};Zs({category:"fetch",data:i,level:"error",type:"http"},o)}else{const i=n.response,o={...n.fetchData,status_code:i&&i.status},a={input:n.args,response:i,startTimestamp:r,endTimestamp:s},l=e_(o.status_code);Zs({category:"fetch",data:o,type:"http",level:l},a)}}}function YR(t){return function(n){if(Re()!==t)return;let r=n.from,s=n.to;const i=Di(ge.location.href);let o=r?Di(r):void 0;const a=Di(s);(!o||!o.path)&&(o=i),i.protocol===a.protocol&&i.host===a.host&&(s=a.relative),i.protocol===o.protocol&&i.host===o.host&&(r=o.relative),Zs({category:"navigation",data:{from:r,to:s}})}}function qR(t){return!!t&&!!t.target}const KR=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],JR="BrowserApiErrors",QR=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t};return{name:JR,setupOnce(){e.setTimeout&&Cn(ge,"setTimeout",ny),e.setInterval&&Cn(ge,"setInterval",ny),e.requestAnimationFrame&&Cn(ge,"requestAnimationFrame",e3),e.XMLHttpRequest&&"XMLHttpRequest"in ge&&Cn(XMLHttpRequest.prototype,"send",t3);const n=e.eventTarget;n&&(Array.isArray(n)?n:KR).forEach(n3)}}},ZR=QR;function ny(t){return function(...e){const n=e[0];return e[0]=qo(n,{mechanism:{data:{function:as(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function e3(t){return function(e){return t.apply(this,[qo(e,{mechanism:{data:{function:"requestAnimationFrame",handler:as(t)},handled:!1,type:"instrument"}})])}}function t3(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(s=>{s in n&&typeof n[s]=="function"&&Cn(n,s,function(i){const o={mechanism:{data:{function:s,handler:as(i)},handled:!1,type:"instrument"}},a=lg(i);return a&&(o.mechanism.data.handler=as(a)),qo(i,o)})}),t.apply(this,e)}}function n3(t){const e=ge,n=e[t]&&e[t].prototype;!n||!n.hasOwnProperty||!n.hasOwnProperty("addEventListener")||(Cn(n,"addEventListener",function(r){return function(s,i,o){try{typeof i.handleEvent=="function"&&(i.handleEvent=qo(i.handleEvent,{mechanism:{data:{function:"handleEvent",handler:as(i),target:t},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[s,qo(i,{mechanism:{data:{function:"addEventListener",handler:as(i),target:t},handled:!1,type:"instrument"}}),o])}}),Cn(n,"removeEventListener",function(r){return function(s,i,o){const a=i;try{const l=a&&a.__sentry_wrapped__;l&&r.call(this,s,l,o)}catch{}return r.call(this,s,a,o)}}))}const r3="GlobalHandlers",s3=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:r3,setupOnce(){Error.stackTraceLimit=50},setup(n){e.onerror&&(o3(n),ry("onerror")),e.onunhandledrejection&&(a3(n),ry("onunhandledrejection"))}}},i3=s3;function o3(t){lv(e=>{const{stackParser:n,attachStacktrace:r}=E_();if(Re()!==t||s_())return;const{msg:s,url:i,line:o,column:a,error:l}=e,c=u3(Sg(n,l||s,void 0,r,!1),i,o,a);c.level="error",Hv(c,{originalException:l,mechanism:{handled:!1,type:"onerror"}})})}function a3(t){cv(e=>{const{stackParser:n,attachStacktrace:r}=E_();if(Re()!==t||s_())return;const s=l3(e),i=ag(s)?c3(s):Sg(n,s,void 0,r,!0);i.level="error",Hv(i,{originalException:s,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function l3(t){if(ag(t))return t;try{if("reason"in t)return t.reason;if("detail"in t&&"reason"in t.detail)return t.detail.reason}catch{}return t}function c3(t){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(t)}`}]}}}function u3(t,e,n,r){const s=t.exception=t.exception||{},i=s.values=s.values||[],o=i[0]=i[0]||{},a=o.stacktrace=o.stacktrace||{},l=a.frames=a.frames||[],c=isNaN(parseInt(r,10))?void 0:r,d=isNaN(parseInt(n,10))?void 0:n,u=rs(e)&&e.length>0?e:hv();return l.length===0&&l.push({colno:c,filename:u,function:Ui,in_app:!0,lineno:d}),t}function ry(t){Ir&&Y.log(`Global Handler attached: ${t}`)}function E_(){const t=Re();return t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const d3=()=>({name:"HttpContext",preprocessEvent(t){if(!ge.navigator&&!ge.location&&!ge.document)return;const e=t.request&&t.request.url||ge.location&&ge.location.href,{referrer:n}=ge.document||{},{userAgent:r}=ge.navigator||{},s={...t.request&&t.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},i={...t.request,...e&&{url:e},headers:s};t.request=i}}),f3="cause",h3=5,p3="LinkedErrors",m3=(t={})=>{const e=t.limit||h3,n=t.key||f3;return{name:p3,preprocessEvent(r,s,i){const o=i.getOptions();D6(yg,o.stackParser,o.maxValueLength,n,e,r,s)}}},g3=m3;function y3(t){return[C6(),w6(),ZR(),zR(),i3(),g3(),B6(),d3()]}function w3(t={}){const e={defaultIntegrations:y3(),release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:ge.SENTRY_RELEASE&&ge.SENTRY_RELEASE.id?ge.SENTRY_RELEASE.id:void 0,autoSessionTracking:!0,sendClientReports:!0};return t.defaultIntegrations==null&&delete t.defaultIntegrations,{...e,...t}}function S3(){const t=typeof ge.window<"u"&&ge;if(!t)return!1;const e=t.chrome?"chrome":"browser",n=t[e],r=n&&n.runtime&&n.runtime.id,s=ge.location&&ge.location.href||"",i=["chrome-extension:","moz-extension:","ms-browser-extension:","safari-web-extension:"],o=!!r&&ge===ge.top&&i.some(l=>s.startsWith(`${l}//`)),a=typeof t.nw<"u";return!!r&&!o&&!a}function v3(t={}){const e=w3(t);if(!e.skipBrowserExtensionCheck&&S3()){wa(()=>{console.error("[Sentry] You cannot run Sentry this way in a browser extension, check: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")});return}Ir&&(t_()||Y.warn("No Fetch API detected. The Sentry SDK requires a Fetch API compatible environment to send events. Please add a Fetch API polyfill."));const n={...e,stackParser:o2(e.stackParser||UR),integrations:Qb(e),transport:e.transport||IR},r=s6(ST,n);return e.autoSessionTracking&&_3(),r}function _3(){if(typeof ge.document>"u"){Ir&&Y.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}O1({ignoreDuration:!0}),L1(),uf(({from:t,to:e})=>{t!==void 0&&t!==e&&(O1({ignoreDuration:!0}),L1())})}const Ye=De,Eg="sentryReplaySession",C3="replay_event",kg="Unable to send Replay",E3=3e5,k3=9e5,x3=5e3,I3=5500,b3=6e4,T3=5e3,R3=3,sy=15e4,Xc=5e3,M3=3e3,N3=300,xg=2e7,A3=4999,D3=15e3,iy=36e5;function wp(t,e){return t??e()}function vl(t){let e,n=t[0],r=1;for(;r<t.length;){const s=t[r],i=t[r+1];if(r+=2,(s==="optionalAccess"||s==="optionalCall")&&n==null)return;s==="access"||s==="optionalAccess"?(e=n,n=i(n)):(s==="call"||s==="optionalCall")&&(n=i((...o)=>n.call(e,...o)),e=void 0)}return n}var Ct;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(Ct||(Ct={}));function O3(t){return t.nodeType===t.ELEMENT_NODE}function Za(t){const e=vl([t,"optionalAccess",n=>n.host]);return vl([e,"optionalAccess",n=>n.shadowRoot])===t}function el(t){return Object.prototype.toString.call(t)==="[object ShadowRoot]"}function L3(t){return t.includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),t}function F3(t){const{cssText:e}=t;if(e.split('"').length<3)return e;const n=["@import",`url(${JSON.stringify(t.href)})`];return t.layerName===""?n.push("layer"):t.layerName&&n.push(`layer(${t.layerName})`),t.supportsText&&n.push(`supports(${t.supportsText})`),t.media.length&&n.push(t.media.mediaText),n.join(" ")+";"}function id(t){try{const e=t.rules||t.cssRules;return e?L3(Array.from(e,k_).join("")):null}catch{return null}}function k_(t){let e;if($3(t))try{e=id(t.styleSheet)||F3(t)}catch{}else if(U3(t)&&t.selectorText.includes(":"))return P3(t.cssText);return e||t.cssText}function P3(t){const e=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return t.replace(e,"$1\\$2")}function $3(t){return"styleSheet"in t}function U3(t){return"selectorText"in t}class x_{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){if(!e)return-1;const n=vl([this,"access",r=>r.getMeta,"call",r=>r(e),"optionalAccess",r=>r.id]);return wp(n,()=>-1)}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,n){const r=n.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,n)}replace(e,n){const r=this.getNode(e);if(r){const s=this.nodeMetaMap.get(r);s&&this.nodeMetaMap.set(n,s)}this.idNodeMap.set(e,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function B3(){return new x_}function df({maskInputOptions:t,tagName:e,type:n}){return e==="OPTION"&&(e="SELECT"),!!(t[e.toLowerCase()]||n&&t[n]||n==="password"||e==="INPUT"&&!n&&t.text)}function _l({isMasked:t,element:e,value:n,maskInputFn:r}){let s=n||"";return t?(r&&(s=r(s,e)),"*".repeat(s.length)):s}function Qo(t){return t.toLowerCase()}function Sp(t){return t.toUpperCase()}const oy="__rrweb_original__";function H3(t){const e=t.getContext("2d");if(!e)return!0;const n=50;for(let r=0;r<t.width;r+=n)for(let s=0;s<t.height;s+=n){const i=e.getImageData,o=oy in i?i[oy]:i;if(new Uint32Array(o.call(e,r,s,Math.min(n,t.width-r),Math.min(n,t.height-s)).data.buffer).some(l=>l!==0))return!1}return!0}function Ig(t){const e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?Qo(e):null}function od(t,e,n){return e==="INPUT"&&(n==="radio"||n==="checkbox")?t.getAttribute("value")||"":t.value}function I_(t,e){let n;try{n=new URL(t,wp(e,()=>window.location.href))}catch{return null}const r=/\.([0-9a-z]+)(?:$)/i,s=n.pathname.match(r);return wp(vl([s,"optionalAccess",i=>i[1]]),()=>null)}const ay={};function b_(t){const e=ay[t];if(e)return e;const n=window.document;let r=window[t];if(n&&typeof n.createElement=="function")try{const s=n.createElement("iframe");s.hidden=!0,n.head.appendChild(s);const i=s.contentWindow;i&&i[t]&&(r=i[t]),n.head.removeChild(s)}catch{}return ay[t]=r.bind(window)}function vp(...t){return b_("setTimeout")(...t)}function T_(...t){return b_("clearTimeout")(...t)}let z3=1;const j3=new RegExp("[^a-z0-9-_:]"),Cl=-2;function bg(){return z3++}function W3(t){if(t instanceof HTMLFormElement)return"form";const e=Qo(t.tagName);return j3.test(e)?"div":e}function V3(t){let e="";return t.indexOf("//")>-1?e=t.split("/").slice(0,3).join("/"):e=t.split("/")[0],e=e.split("?")[0],e}let oo,ly;const G3=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,X3=/^(?:[a-z+]+:)?\/\//i,Y3=/^www\..*/i,q3=/^(data:)([^,]*),(.*)/i;function ad(t,e){return(t||"").replace(G3,(n,r,s,i,o,a)=>{const l=s||o||a,c=r||i||"";if(!l)return n;if(X3.test(l)||Y3.test(l))return`url(${c}${l}${c})`;if(q3.test(l))return`url(${c}${l}${c})`;if(l[0]==="/")return`url(${c}${V3(e)+l}${c})`;const d=e.split("/"),u=l.split("/");d.pop();for(const f of u)f!=="."&&(f===".."?d.pop():d.push(f));return`url(${c}${d.join("/")}${c})`})}const K3=/^[^ \t\n\r\u000c]+/,J3=/^[, \t\n\r\u000c]+/;function Q3(t,e){if(e.trim()==="")return e;let n=0;function r(i){let o;const a=i.exec(e.substring(n));return a?(o=a[0],n+=o.length,o):""}const s=[];for(;r(J3),!(n>=e.length);){let i=r(K3);if(i.slice(-1)===",")i=go(t,i.substring(0,i.length-1)),s.push(i);else{let o="";i=go(t,i);let a=!1;for(;;){const l=e.charAt(n);if(l===""){s.push((i+o).trim());break}else if(a)l===")"&&(a=!1);else if(l===","){n+=1,s.push((i+o).trim());break}else l==="("&&(a=!0);o+=l,n+=1}}}return s.join(", ")}const cy=new WeakMap;function go(t,e){return!e||e.trim()===""?e:ff(t,e)}function Z3(t){return!!(t.tagName==="svg"||t.ownerSVGElement)}function ff(t,e){let n=cy.get(t);if(n||(n=t.createElement("a"),cy.set(t,n)),!e)e="";else if(e.startsWith("blob:")||e.startsWith("data:"))return e;return n.setAttribute("href",e),n.href}function R_(t,e,n,r,s,i){return r&&(n==="src"||n==="href"&&!(e==="use"&&r[0]==="#")||n==="xlink:href"&&r[0]!=="#"||n==="background"&&(e==="table"||e==="td"||e==="th")?go(t,r):n==="srcset"?Q3(t,r):n==="style"?ad(r,ff(t)):e==="object"&&n==="data"?go(t,r):typeof i=="function"?i(n,r,s):r)}function M_(t,e,n){return(t==="video"||t==="audio")&&e==="autoplay"}function eM(t,e,n,r){try{if(r&&t.matches(r))return!1;if(typeof e=="string"){if(t.classList.contains(e))return!0}else for(let s=t.classList.length;s--;){const i=t.classList[s];if(e.test(i))return!0}if(n)return t.matches(n)}catch{}return!1}function tM(t,e){for(let n=t.classList.length;n--;){const r=t.classList[n];if(e.test(r))return!0}return!1}function ki(t,e,n=1/0,r=0){return!t||t.nodeType!==t.ELEMENT_NODE||r>n?-1:e(t)?r:ki(t.parentNode,e,n,r+1)}function yo(t,e){return n=>{const r=n;if(r===null)return!1;try{if(t){if(typeof t=="string"){if(r.matches(`.${t}`))return!0}else if(tM(r,t))return!0}return!!(e&&r.matches(e))}catch{return!1}}}function Zo(t,e,n,r,s,i){try{const o=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(o===null)return!1;if(o.tagName==="INPUT"){const c=o.getAttribute("autocomplete");if(["current-password","new-password","cc-number","cc-exp","cc-exp-month","cc-exp-year","cc-csc"].includes(c))return!0}let a=-1,l=-1;if(i){if(l=ki(o,yo(r,s)),l<0)return!0;a=ki(o,yo(e,n),l>=0?l:1/0)}else{if(a=ki(o,yo(e,n)),a<0)return!1;l=ki(o,yo(r,s),a>=0?a:1/0)}return a>=0?l>=0?a<=l:!0:l>=0?!1:!!i}catch{}return!!i}function nM(t,e,n){const r=t.contentWindow;if(!r)return;let s=!1,i;try{i=r.document.readyState}catch{return}if(i!=="complete"){const a=vp(()=>{s||(e(),s=!0)},n);t.addEventListener("load",()=>{T_(a),s=!0,e()});return}const o="about:blank";if(r.location.href!==o||t.src===o||t.src==="")return vp(e,0),t.addEventListener("load",e);t.addEventListener("load",e)}function rM(t,e,n){let r=!1,s;try{s=t.sheet}catch{return}if(s)return;const i=vp(()=>{r||(e(),r=!0)},n);t.addEventListener("load",()=>{T_(i),r=!0,e()})}function sM(t,e){const{doc:n,mirror:r,blockClass:s,blockSelector:i,unblockSelector:o,maskAllText:a,maskAttributeFn:l,maskTextClass:c,unmaskTextClass:d,maskTextSelector:u,unmaskTextSelector:f,inlineStylesheet:h,maskInputOptions:p={},maskTextFn:m,maskInputFn:_,dataURLOptions:g={},inlineImages:y,recordCanvas:w,keepIframeSrcFn:v,newlyAddedElement:x=!1}=e,C=iM(n,r);switch(t.nodeType){case t.DOCUMENT_NODE:return t.compatMode!=="CSS1Compat"?{type:Ct.Document,childNodes:[],compatMode:t.compatMode}:{type:Ct.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:Ct.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:C};case t.ELEMENT_NODE:return aM(t,{doc:n,blockClass:s,blockSelector:i,unblockSelector:o,inlineStylesheet:h,maskAttributeFn:l,maskInputOptions:p,maskInputFn:_,dataURLOptions:g,inlineImages:y,recordCanvas:w,keepIframeSrcFn:v,newlyAddedElement:x,rootId:C,maskAllText:a,maskTextClass:c,unmaskTextClass:d,maskTextSelector:u,unmaskTextSelector:f});case t.TEXT_NODE:return oM(t,{doc:n,maskAllText:a,maskTextClass:c,unmaskTextClass:d,maskTextSelector:u,unmaskTextSelector:f,maskTextFn:m,maskInputOptions:p,maskInputFn:_,rootId:C});case t.CDATA_SECTION_NODE:return{type:Ct.CDATA,textContent:"",rootId:C};case t.COMMENT_NODE:return{type:Ct.Comment,textContent:t.textContent||"",rootId:C};default:return!1}}function iM(t,e){if(!e.hasNode(t))return;const n=e.getId(t);return n===1?void 0:n}function oM(t,e){const{maskAllText:n,maskTextClass:r,unmaskTextClass:s,maskTextSelector:i,unmaskTextSelector:o,maskTextFn:a,maskInputOptions:l,maskInputFn:c,rootId:d}=e,u=t.parentNode&&t.parentNode.tagName;let f=t.textContent;const h=u==="STYLE"?!0:void 0,p=u==="SCRIPT"?!0:void 0,m=u==="TEXTAREA"?!0:void 0;if(h&&f){try{t.nextSibling||t.previousSibling||vl([t,"access",g=>g.parentNode,"access",g=>g.sheet,"optionalAccess",g=>g.cssRules])&&(f=id(t.parentNode.sheet))}catch(g){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${g}`,t)}f=ad(f,ff(e.doc))}p&&(f="SCRIPT_PLACEHOLDER");const _=Zo(t,r,i,s,o,n);if(!h&&!p&&!m&&f&&_&&(f=a?a(f,t.parentElement):f.replace(/[\S]/g,"*")),m&&f&&(l.textarea||_)&&(f=c?c(f,t.parentNode):f.replace(/[\S]/g,"*")),u==="OPTION"&&f){const g=df({type:null,tagName:u,maskInputOptions:l});f=_l({isMasked:Zo(t,r,i,s,o,g),element:t,value:f,maskInputFn:c})}return{type:Ct.Text,textContent:f||"",isStyle:h,rootId:d}}function aM(t,e){const{doc:n,blockClass:r,blockSelector:s,unblockSelector:i,inlineStylesheet:o,maskInputOptions:a={},maskAttributeFn:l,maskInputFn:c,dataURLOptions:d={},inlineImages:u,recordCanvas:f,keepIframeSrcFn:h,newlyAddedElement:p=!1,rootId:m,maskAllText:_,maskTextClass:g,unmaskTextClass:y,maskTextSelector:w,unmaskTextSelector:v}=e,x=eM(t,r,s,i),C=W3(t);let E={};const A=t.attributes.length;for(let D=0;D<A;D++){const $=t.attributes[D];$.name&&!M_(C,$.name,$.value)&&(E[$.name]=R_(n,C,Qo($.name),$.value,t,l))}if(C==="link"&&o){const D=Array.from(n.styleSheets).find(j=>j.href===t.href);let $=null;D&&($=id(D)),$&&(delete E.rel,delete E.href,E._cssText=ad($,D.href))}if(C==="style"&&t.sheet&&!(t.innerText||t.textContent||"").trim().length){const D=id(t.sheet);D&&(E._cssText=ad(D,ff(n)))}if(C==="input"||C==="textarea"||C==="select"||C==="option"){const D=t,$=Ig(D),j=od(D,Sp(C),$),Z=D.checked;if($!=="submit"&&$!=="button"&&j){const ae=Zo(D,g,w,y,v,df({type:$,tagName:Sp(C),maskInputOptions:a}));E.value=_l({isMasked:ae,element:D,value:j,maskInputFn:c})}Z&&(E.checked=Z)}if(C==="option"&&(t.selected&&!a.select?E.selected=!0:delete E.selected),C==="canvas"&&f){if(t.__context==="2d")H3(t)||(E.rr_dataURL=t.toDataURL(d.type,d.quality));else if(!("__context"in t)){const D=t.toDataURL(d.type,d.quality),$=n.createElement("canvas");$.width=t.width,$.height=t.height;const j=$.toDataURL(d.type,d.quality);D!==j&&(E.rr_dataURL=D)}}if(C==="img"&&u){oo||(oo=n.createElement("canvas"),ly=oo.getContext("2d"));const D=t,$=D.currentSrc||D.getAttribute("src")||"<unknown-src>",j=D.crossOrigin,Z=()=>{D.removeEventListener("load",Z);try{oo.width=D.naturalWidth,oo.height=D.naturalHeight,ly.drawImage(D,0,0),E.rr_dataURL=oo.toDataURL(d.type,d.quality)}catch(ae){if(D.crossOrigin!=="anonymous"){D.crossOrigin="anonymous",D.complete&&D.naturalWidth!==0?Z():D.addEventListener("load",Z);return}else console.warn(`Cannot inline img src=${$}! Error: ${ae}`)}D.crossOrigin==="anonymous"&&(j?E.crossOrigin=j:D.removeAttribute("crossorigin"))};D.complete&&D.naturalWidth!==0?Z():D.addEventListener("load",Z)}if((C==="audio"||C==="video")&&(E.rr_mediaState=t.paused?"paused":"played",E.rr_mediaCurrentTime=t.currentTime),p||(t.scrollLeft&&(E.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(E.rr_scrollTop=t.scrollTop)),x){const{width:D,height:$}=t.getBoundingClientRect();E={class:E.class,rr_width:`${D}px`,rr_height:`${$}px`}}C==="iframe"&&!h(E.src)&&(!x&&!t.contentDocument&&(E.rr_src=E.src),delete E.src);let V;try{customElements.get(C)&&(V=!0)}catch{}return{type:Ct.Element,tagName:C,attributes:E,childNodes:[],isSVG:Z3(t)||void 0,needBlock:x,rootId:m,isCustom:V}}function Xe(t){return t==null?"":t.toLowerCase()}function lM(t,e){if(e.comment&&t.type===Ct.Comment)return!0;if(t.type===Ct.Element){if(e.script&&(t.tagName==="script"||t.tagName==="link"&&(t.attributes.rel==="preload"||t.attributes.rel==="modulepreload")&&t.attributes.as==="script"||t.tagName==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&I_(t.attributes.href)==="js"))return!0;if(e.headFavicon&&(t.tagName==="link"&&t.attributes.rel==="shortcut icon"||t.tagName==="meta"&&(Xe(t.attributes.name).match(/^msapplication-tile(image|color)$/)||Xe(t.attributes.name)==="application-name"||Xe(t.attributes.rel)==="icon"||Xe(t.attributes.rel)==="apple-touch-icon"||Xe(t.attributes.rel)==="shortcut icon")))return!0;if(t.tagName==="meta"){if(e.headMetaDescKeywords&&Xe(t.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(Xe(t.attributes.property).match(/^(og|twitter|fb):/)||Xe(t.attributes.name).match(/^(og|twitter):/)||Xe(t.attributes.name)==="pinterest"))return!0;if(e.headMetaRobots&&(Xe(t.attributes.name)==="robots"||Xe(t.attributes.name)==="googlebot"||Xe(t.attributes.name)==="bingbot"))return!0;if(e.headMetaHttpEquiv&&t.attributes["http-equiv"]!==void 0)return!0;if(e.headMetaAuthorship&&(Xe(t.attributes.name)==="author"||Xe(t.attributes.name)==="generator"||Xe(t.attributes.name)==="framework"||Xe(t.attributes.name)==="publisher"||Xe(t.attributes.name)==="progid"||Xe(t.attributes.property).match(/^article:/)||Xe(t.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&(Xe(t.attributes.name)==="google-site-verification"||Xe(t.attributes.name)==="yandex-verification"||Xe(t.attributes.name)==="csrf-token"||Xe(t.attributes.name)==="p:domain_verify"||Xe(t.attributes.name)==="verify-v1"||Xe(t.attributes.name)==="verification"||Xe(t.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function wo(t,e){const{doc:n,mirror:r,blockClass:s,blockSelector:i,unblockSelector:o,maskAllText:a,maskTextClass:l,unmaskTextClass:c,maskTextSelector:d,unmaskTextSelector:u,skipChild:f=!1,inlineStylesheet:h=!0,maskInputOptions:p={},maskAttributeFn:m,maskTextFn:_,maskInputFn:g,slimDOMOptions:y,dataURLOptions:w={},inlineImages:v=!1,recordCanvas:x=!1,onSerialize:C,onIframeLoad:E,iframeLoadTimeout:A=5e3,onStylesheetLoad:V,stylesheetLoadTimeout:D=5e3,keepIframeSrcFn:$=()=>!1,newlyAddedElement:j=!1}=e;let{preserveWhiteSpace:Z=!0}=e;const ae=sM(t,{doc:n,mirror:r,blockClass:s,blockSelector:i,maskAllText:a,unblockSelector:o,maskTextClass:l,unmaskTextClass:c,maskTextSelector:d,unmaskTextSelector:u,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:m,maskTextFn:_,maskInputFn:g,dataURLOptions:w,inlineImages:v,recordCanvas:x,keepIframeSrcFn:$,newlyAddedElement:j});if(!ae)return console.warn(t,"not serialized"),null;let ce;r.hasNode(t)?ce=r.getId(t):lM(ae,y)||!Z&&ae.type===Ct.Text&&!ae.isStyle&&!ae.textContent.replace(/^\s+|\s+$/gm,"").length?ce=Cl:ce=bg();const J=Object.assign(ae,{id:ce});if(r.add(t,J),ce===Cl)return null;C&&C(t);let K=!f;if(J.type===Ct.Element){K=K&&!J.needBlock,delete J.needBlock;const F=t.shadowRoot;F&&el(F)&&(J.isShadowHost=!0)}if((J.type===Ct.Document||J.type===Ct.Element)&&K){y.headWhitespace&&J.type===Ct.Element&&J.tagName==="head"&&(Z=!1);const F={doc:n,mirror:r,blockClass:s,blockSelector:i,maskAllText:a,unblockSelector:o,maskTextClass:l,unmaskTextClass:c,maskTextSelector:d,unmaskTextSelector:u,skipChild:f,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:m,maskTextFn:_,maskInputFn:g,slimDOMOptions:y,dataURLOptions:w,inlineImages:v,recordCanvas:x,preserveWhiteSpace:Z,onSerialize:C,onIframeLoad:E,iframeLoadTimeout:A,onStylesheetLoad:V,stylesheetLoadTimeout:D,keepIframeSrcFn:$};for(const q of Array.from(t.childNodes)){const ne=wo(q,F);ne&&J.childNodes.push(ne)}if(O3(t)&&t.shadowRoot)for(const q of Array.from(t.shadowRoot.childNodes)){const ne=wo(q,F);ne&&(el(t.shadowRoot)&&(ne.isShadow=!0),J.childNodes.push(ne))}}return t.parentNode&&Za(t.parentNode)&&el(t.parentNode)&&(J.isShadow=!0),J.type===Ct.Element&&J.tagName==="iframe"&&nM(t,()=>{const F=t.contentDocument;if(F&&E){const q=wo(F,{doc:F,mirror:r,blockClass:s,blockSelector:i,unblockSelector:o,maskAllText:a,maskTextClass:l,unmaskTextClass:c,maskTextSelector:d,unmaskTextSelector:u,skipChild:!1,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:m,maskTextFn:_,maskInputFn:g,slimDOMOptions:y,dataURLOptions:w,inlineImages:v,recordCanvas:x,preserveWhiteSpace:Z,onSerialize:C,onIframeLoad:E,iframeLoadTimeout:A,onStylesheetLoad:V,stylesheetLoadTimeout:D,keepIframeSrcFn:$});q&&E(t,q)}},A),J.type===Ct.Element&&J.tagName==="link"&&typeof J.attributes.rel=="string"&&(J.attributes.rel==="stylesheet"||J.attributes.rel==="preload"&&typeof J.attributes.href=="string"&&I_(J.attributes.href)==="css")&&rM(t,()=>{if(V){const F=wo(t,{doc:n,mirror:r,blockClass:s,blockSelector:i,unblockSelector:o,maskAllText:a,maskTextClass:l,unmaskTextClass:c,maskTextSelector:d,unmaskTextSelector:u,skipChild:!1,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:m,maskTextFn:_,maskInputFn:g,slimDOMOptions:y,dataURLOptions:w,inlineImages:v,recordCanvas:x,preserveWhiteSpace:Z,onSerialize:C,onIframeLoad:E,iframeLoadTimeout:A,onStylesheetLoad:V,stylesheetLoadTimeout:D,keepIframeSrcFn:$});F&&V(t,F)}},D),J}function cM(t,e){const{mirror:n=new x_,blockClass:r="rr-block",blockSelector:s=null,unblockSelector:i=null,maskAllText:o=!1,maskTextClass:a="rr-mask",unmaskTextClass:l=null,maskTextSelector:c=null,unmaskTextSelector:d=null,inlineStylesheet:u=!0,inlineImages:f=!1,recordCanvas:h=!1,maskAllInputs:p=!1,maskAttributeFn:m,maskTextFn:_,maskInputFn:g,slimDOM:y=!1,dataURLOptions:w,preserveWhiteSpace:v,onSerialize:x,onIframeLoad:C,iframeLoadTimeout:E,onStylesheetLoad:A,stylesheetLoadTimeout:V,keepIframeSrcFn:D=()=>!1}=e||{};return wo(t,{doc:t,mirror:n,blockClass:r,blockSelector:s,unblockSelector:i,maskAllText:o,maskTextClass:a,unmaskTextClass:l,maskTextSelector:c,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:u,maskInputOptions:p===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:p===!1?{}:p,maskAttributeFn:m,maskTextFn:_,maskInputFn:g,slimDOMOptions:y===!0||y==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:y==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:y===!1?{}:y,dataURLOptions:w,inlineImages:f,recordCanvas:h,preserveWhiteSpace:v,onSerialize:x,onIframeLoad:C,iframeLoadTimeout:E,onStylesheetLoad:A,stylesheetLoadTimeout:V,keepIframeSrcFn:D,newlyAddedElement:!1})}function bs(t){let e,n=t[0],r=1;for(;r<t.length;){const s=t[r],i=t[r+1];if(r+=2,(s==="optionalAccess"||s==="optionalCall")&&n==null)return;s==="access"||s==="optionalAccess"?(e=n,n=i(n)):(s==="call"||s==="optionalCall")&&(n=i((...o)=>n.call(e,...o)),e=void 0)}return n}function ln(t,e,n=document){const r={capture:!0,passive:!0};return n.addEventListener(t,e,r),()=>n.removeEventListener(t,e,r)}const fo=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let uy={map:{},getId(){return console.error(fo),-1},getNode(){return console.error(fo),null},removeNodeFromMap(){console.error(fo)},has(){return console.error(fo),!1},reset(){console.error(fo)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(uy=new Proxy(uy,{get(t,e,n){return e==="map"&&console.error(fo),Reflect.get(t,e,n)}}));function El(t,e,n={}){let r=null,s=0;return function(...i){const o=Date.now();!s&&n.leading===!1&&(s=o);const a=e-(o-s),l=this;a<=0||a>e?(r&&(gM(r),r=null),s=o,t.apply(l,i)):!r&&n.trailing!==!1&&(r=hf(()=>{s=n.leading===!1?0:Date.now(),r=null,t.apply(l,i)},a))}}function N_(t,e,n,r,s=window){const i=s.Object.getOwnPropertyDescriptor(t,e);return s.Object.defineProperty(t,e,r?n:{set(o){hf(()=>{n.set.call(this,o)},0),i&&i.set&&i.set.call(this,o)}}),()=>N_(t,e,i||{},!0)}function Tg(t,e,n){try{if(!(e in t))return()=>{};const r=t[e],s=n(r);return typeof s=="function"&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__rrweb_original__:{enumerable:!1,value:r}})),t[e]=s,()=>{t[e]=r}}catch{return()=>{}}}let ld=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(ld=()=>new Date().getTime());function A_(t){const e=t.document;return{left:e.scrollingElement?e.scrollingElement.scrollLeft:t.pageXOffset!==void 0?t.pageXOffset:bs([e,"optionalAccess",n=>n.documentElement,"access",n=>n.scrollLeft])||bs([e,"optionalAccess",n=>n.body,"optionalAccess",n=>n.parentElement,"optionalAccess",n=>n.scrollLeft])||bs([e,"optionalAccess",n=>n.body,"optionalAccess",n=>n.scrollLeft])||0,top:e.scrollingElement?e.scrollingElement.scrollTop:t.pageYOffset!==void 0?t.pageYOffset:bs([e,"optionalAccess",n=>n.documentElement,"access",n=>n.scrollTop])||bs([e,"optionalAccess",n=>n.body,"optionalAccess",n=>n.parentElement,"optionalAccess",n=>n.scrollTop])||bs([e,"optionalAccess",n=>n.body,"optionalAccess",n=>n.scrollTop])||0}}function D_(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function O_(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function L_(t){return t?t.nodeType===t.ELEMENT_NODE?t:t.parentElement:null}function An(t,e,n,r,s){if(!t)return!1;const i=L_(t);if(!i)return!1;const o=yo(e,n);if(!s){const c=r&&i.matches(r);return o(i)&&!c}const a=ki(i,o);let l=-1;return a<0?!1:(r&&(l=ki(i,yo(null,r))),a>-1&&l<0?!0:a<l)}function uM(t,e){return e.getId(t)!==-1}function Zf(t,e){return e.getId(t)===Cl}function F_(t,e){if(Za(t))return!1;const n=e.getId(t);return e.has(n)?t.parentNode&&t.parentNode.nodeType===t.DOCUMENT_NODE?!1:t.parentNode?F_(t.parentNode,e):!0:!0}function _p(t){return!!t.changedTouches}function dM(t=window){"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let n=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function P_(t,e){return!!(t.nodeName==="IFRAME"&&e.getMeta(t))}function $_(t,e){return!!(t.nodeName==="LINK"&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&t.getAttribute("rel")==="stylesheet"&&e.getMeta(t))}function Cp(t){return!!bs([t,"optionalAccess",e=>e.shadowRoot])}class fM{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){return sT(this.styleIDMap.get(e),()=>-1)}has(e){return this.styleIDMap.has(e)}add(e,n){if(this.has(e))return this.getId(e);let r;return n===void 0?r=this.id++:r=n,this.styleIDMap.set(e,r),this.idStyleMap.set(r,e),r}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function U_(t){let e=null;return bs([t,"access",n=>n.getRootNode,"optionalCall",n=>n(),"optionalAccess",n=>n.nodeType])===Node.DOCUMENT_FRAGMENT_NODE&&t.getRootNode().host&&(e=t.getRootNode().host),e}function hM(t){let e=t,n;for(;n=U_(e);)e=n;return e}function pM(t){const e=t.ownerDocument;if(!e)return!1;const n=hM(t);return e.contains(n)}function B_(t){const e=t.ownerDocument;return e?e.contains(t)||pM(t):!1}const dy={};function Rg(t){const e=dy[t];if(e)return e;const n=window.document;let r=window[t];if(n&&typeof n.createElement=="function")try{const s=n.createElement("iframe");s.hidden=!0,n.head.appendChild(s);const i=s.contentWindow;i&&i[t]&&(r=i[t]),n.head.removeChild(s)}catch{}return dy[t]=r.bind(window)}function mM(...t){return Rg("requestAnimationFrame")(...t)}function hf(...t){return Rg("setTimeout")(...t)}function gM(...t){return Rg("clearTimeout")(...t)}var _e=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(_e||{}),he=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t))(he||{}),rn=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(rn||{}),Xr=(t=>(t[t.Mouse=0]="Mouse",t[t.Pen=1]="Pen",t[t.Touch=2]="Touch",t))(Xr||{});function yM(t){let e,n=t[0],r=1;for(;r<t.length;){const s=t[r],i=t[r+1];if(r+=2,(s==="optionalAccess"||s==="optionalCall")&&n==null)return;s==="access"||s==="optionalAccess"?(e=n,n=i(n)):(s==="call"||s==="optionalCall")&&(n=i((...o)=>n.call(e,...o)),e=void 0)}return n}function fy(t){return"__ln"in t}class wM{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let n=this.head;for(let r=0;r<e;r++)n=yM([n,"optionalAccess",s=>s.next])||null;return n}addNode(e){const n={value:e,previous:null,next:null};if(e.__ln=n,e.previousSibling&&fy(e.previousSibling)){const r=e.previousSibling.__ln.next;n.next=r,n.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=n,r&&(r.previous=n)}else if(e.nextSibling&&fy(e.nextSibling)&&e.nextSibling.__ln.previous){const r=e.nextSibling.__ln.previous;n.previous=r,n.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=n,r&&(r.next=n)}else this.head&&(this.head.previous=n),n.next=this.head,this.head=n;n.next===null&&(this.tail=n),this.length++}removeNode(e){const n=e.__ln;this.head&&(n.previous?(n.previous.next=n.next,n.next?n.next.previous=n.previous:this.tail=n.previous):(this.head=n.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const hy=(t,e)=>`${t}@${e}`;class SM{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],n=new Set,r=new wM,s=l=>{let c=l,d=Cl;for(;d===Cl;)c=c&&c.nextSibling,d=c&&this.mirror.getId(c);return d},i=l=>{if(!l.parentNode||!B_(l))return;const c=Za(l.parentNode)?this.mirror.getId(U_(l)):this.mirror.getId(l.parentNode),d=s(l);if(c===-1||d===-1)return r.addNode(l);const u=wo(l,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskAllText:this.maskAllText,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,unmaskTextClass:this.unmaskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskAttributeFn:this.maskAttributeFn,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:f=>{P_(f,this.mirror)&&!An(f,this.blockClass,this.blockSelector,this.unblockSelector,!1)&&this.iframeManager.addIframe(f),$_(f,this.mirror)&&this.stylesheetManager.trackLinkElement(f),Cp(l)&&this.shadowDomManager.addShadowRoot(l.shadowRoot,this.doc)},onIframeLoad:(f,h)=>{An(f,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(this.iframeManager.attachIframe(f,h),f.contentWindow&&this.canvasManager.addWindow(f.contentWindow),this.shadowDomManager.observeAttachShadow(f))},onStylesheetLoad:(f,h)=>{this.stylesheetManager.attachLinkElement(f,h)}});u&&(e.push({parentId:c,nextId:d,node:u}),n.add(u.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const l of this.movedSet)py(this.removes,l,this.mirror)&&!this.movedSet.has(l.parentNode)||i(l);for(const l of this.addedSet)!my(this.droppedSet,l)&&!py(this.removes,l,this.mirror)||my(this.movedSet,l)?i(l):this.droppedSet.add(l);let o=null;for(;r.length;){let l=null;if(o){const c=this.mirror.getId(o.value.parentNode),d=s(o.value);c!==-1&&d!==-1&&(l=o)}if(!l){let c=r.tail;for(;c;){const d=c;if(c=c.previous,d){const u=this.mirror.getId(d.value.parentNode);if(s(d.value)===-1)continue;if(u!==-1){l=d;break}else{const h=d.value;if(h.parentNode&&h.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const p=h.parentNode.host;if(this.mirror.getId(p)!==-1){l=d;break}}}}}}if(!l){for(;r.head;)r.removeNode(r.head.value);break}o=l.previous,r.removeNode(l.value),i(l.value)}const a={texts:this.texts.map(l=>({id:this.mirror.getId(l.node),value:l.value})).filter(l=>!n.has(l.id)).filter(l=>this.mirror.has(l.id)),attributes:this.attributes.map(l=>{const{attributes:c}=l;if(typeof c.style=="string"){const d=JSON.stringify(l.styleDiff),u=JSON.stringify(l._unchangedStyles);d.length<c.style.length&&(d+u).split("var(").length===c.style.split("var(").length&&(c.style=l.styleDiff)}return{id:this.mirror.getId(l.node),attributes:c}}).filter(l=>!n.has(l.id)).filter(l=>this.mirror.has(l.id)),removes:this.removes,adds:e};!a.texts.length&&!a.attributes.length&&!a.removes.length&&!a.adds.length||(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(a))},this.processMutation=e=>{if(!Zf(e.target,this.mirror))switch(e.type){case"characterData":{const n=e.target.textContent;!An(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)&&n!==e.oldValue&&this.texts.push({value:Zo(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,this.maskAllText)&&n?this.maskTextFn?this.maskTextFn(n,L_(e.target)):n.replace(/[\S]/g,"*"):n,node:e.target});break}case"attributes":{const n=e.target;let r=e.attributeName,s=e.target.getAttribute(r);if(r==="value"){const o=Ig(n),a=n.tagName;s=od(n,a,o);const l=df({maskInputOptions:this.maskInputOptions,tagName:a,type:o}),c=Zo(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,l);s=_l({isMasked:c,element:n,value:s,maskInputFn:this.maskInputFn})}if(An(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||s===e.oldValue)return;let i=this.attributeMap.get(e.target);if(n.tagName==="IFRAME"&&r==="src"&&!this.keepIframeSrcFn(s))if(!n.contentDocument)r="rr_src";else return;if(i||(i={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(i),this.attributeMap.set(e.target,i)),r==="type"&&n.tagName==="INPUT"&&(e.oldValue||"").toLowerCase()==="password"&&n.setAttribute("data-rr-is-password","true"),!M_(n.tagName,r)&&(i.attributes[r]=R_(this.doc,Qo(n.tagName),Qo(r),s,n,this.maskAttributeFn),r==="style")){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch{this.unattachedDoc=this.doc}const o=this.unattachedDoc.createElement("span");e.oldValue&&o.setAttribute("style",e.oldValue);for(const a of Array.from(n.style)){const l=n.style.getPropertyValue(a),c=n.style.getPropertyPriority(a);l!==o.style.getPropertyValue(a)||c!==o.style.getPropertyPriority(a)?c===""?i.styleDiff[a]=l:i.styleDiff[a]=[l,c]:i._unchangedStyles[a]=[l,c]}for(const a of Array.from(o.style))n.style.getPropertyValue(a)===""&&(i.styleDiff[a]=!1)}break}case"childList":{if(An(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!0))return;e.addedNodes.forEach(n=>this.genAdds(n,e.target)),e.removedNodes.forEach(n=>{const r=this.mirror.getId(n),s=Za(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);An(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||Zf(n,this.mirror)||!uM(n,this.mirror)||(this.addedSet.has(n)?(Ep(this.addedSet,n),this.droppedSet.add(n)):this.addedSet.has(e.target)&&r===-1||F_(e.target,this.mirror)||(this.movedSet.has(n)&&this.movedMap[hy(r,s)]?Ep(this.movedSet,n):this.removes.push({parentId:s,id:r,isShadow:Za(e.target)&&el(e.target)?!0:void 0})),this.mapRemoves.push(n))});break}}},this.genAdds=(e,n)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!(this.addedSet.has(e)||this.movedSet.has(e))){if(this.mirror.hasNode(e)){if(Zf(e,this.mirror))return;this.movedSet.add(e);let r=null;n&&this.mirror.hasNode(n)&&(r=this.mirror.getId(n)),r&&r!==-1&&(this.movedMap[hy(this.mirror.getId(e),r)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);An(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(e.childNodes.forEach(r=>this.genAdds(r)),Cp(e)&&e.shadowRoot.childNodes.forEach(r=>{this.processedNodeManager.add(r,this),this.genAdds(r,e)}))}}}init(e){["mutationCb","blockClass","blockSelector","unblockSelector","maskAllText","maskTextClass","unmaskTextClass","maskTextSelector","unmaskTextSelector","inlineStylesheet","maskInputOptions","maskAttributeFn","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(n=>{this[n]=e[n]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Ep(t,e){t.delete(e),e.childNodes.forEach(n=>Ep(t,n))}function py(t,e,n){return t.length===0?!1:vM(t,e,n)}function vM(t,e,n){let r=e.parentNode;for(;r;){const s=n.getId(r);if(t.some(i=>i.id===s))return!0;r=r.parentNode}return!1}function my(t,e){return t.size===0?!1:H_(t,e)}function H_(t,e){const{parentNode:n}=e;return n?t.has(n)?!0:H_(t,n):!1}let tl;function _M(t){tl=t}function CM(){tl=void 0}const Pe=t=>tl?(...n)=>{try{return t(...n)}catch(r){if(tl&&tl(r)===!0)return()=>{};throw r}}:t;function yr(t){let e,n=t[0],r=1;for(;r<t.length;){const s=t[r],i=t[r+1];if(r+=2,(s==="optionalAccess"||s==="optionalCall")&&n==null)return;s==="access"||s==="optionalAccess"?(e=n,n=i(n)):(s==="call"||s==="optionalCall")&&(n=i((...o)=>n.call(e,...o)),e=void 0)}return n}const So=[];function wc(t){try{if("composedPath"in t){const e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0]}catch{}return t&&t.target}function z_(t,e){const n=new SM;So.push(n),n.init(t);let r=window.MutationObserver||window.__rrMutationObserver;const s=yr([window,"optionalAccess",o=>o.Zone,"optionalAccess",o=>o.__symbol__,"optionalCall",o=>o("MutationObserver")]);s&&window[s]&&(r=window[s]);const i=new r(Pe(o=>{t.onMutation&&t.onMutation(o)===!1||n.processMutations.bind(n)(o)}));return i.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),i}function EM({mousemoveCb:t,sampling:e,doc:n,mirror:r}){if(e.mousemove===!1)return()=>{};const s=typeof e.mousemove=="number"?e.mousemove:50,i=typeof e.mousemoveCallback=="number"?e.mousemoveCallback:500;let o=[],a;const l=El(Pe(u=>{const f=Date.now()-a;t(o.map(h=>(h.timeOffset-=f,h)),u),o=[],a=null}),i),c=Pe(El(Pe(u=>{const f=wc(u),{clientX:h,clientY:p}=_p(u)?u.changedTouches[0]:u;a||(a=ld()),o.push({x:h,y:p,id:r.getId(f),timeOffset:ld()-a}),l(typeof DragEvent<"u"&&u instanceof DragEvent?he.Drag:u instanceof MouseEvent?he.MouseMove:he.TouchMove)}),s,{trailing:!1})),d=[ln("mousemove",c,n),ln("touchmove",c,n),ln("drag",c,n)];return Pe(()=>{d.forEach(u=>u())})}function kM({mouseInteractionCb:t,doc:e,mirror:n,blockClass:r,blockSelector:s,unblockSelector:i,sampling:o}){if(o.mouseInteraction===!1)return()=>{};const a=o.mouseInteraction===!0||o.mouseInteraction===void 0?{}:o.mouseInteraction,l=[];let c=null;const d=u=>f=>{const h=wc(f);if(An(h,r,s,i,!0))return;let p=null,m=u;if("pointerType"in f){switch(f.pointerType){case"mouse":p=Xr.Mouse;break;case"touch":p=Xr.Touch;break;case"pen":p=Xr.Pen;break}p===Xr.Touch?rn[u]===rn.MouseDown?m="TouchStart":rn[u]===rn.MouseUp&&(m="TouchEnd"):Xr.Pen}else _p(f)&&(p=Xr.Touch);p!==null?(c=p,(m.startsWith("Touch")&&p===Xr.Touch||m.startsWith("Mouse")&&p===Xr.Mouse)&&(p=null)):rn[u]===rn.Click&&(p=c,c=null);const _=_p(f)?f.changedTouches[0]:f;if(!_)return;const g=n.getId(h),{clientX:y,clientY:w}=_;Pe(t)({type:rn[m],id:g,x:y,y:w,...p!==null&&{pointerType:p}})};return Object.keys(rn).filter(u=>Number.isNaN(Number(u))&&!u.endsWith("_Departed")&&a[u]!==!1).forEach(u=>{let f=Qo(u);const h=d(u);if(window.PointerEvent)switch(rn[u]){case rn.MouseDown:case rn.MouseUp:f=f.replace("mouse","pointer");break;case rn.TouchStart:case rn.TouchEnd:return}l.push(ln(f,h,e))}),Pe(()=>{l.forEach(u=>u())})}function j_({scrollCb:t,doc:e,mirror:n,blockClass:r,blockSelector:s,unblockSelector:i,sampling:o}){const a=Pe(El(Pe(l=>{const c=wc(l);if(!c||An(c,r,s,i,!0))return;const d=n.getId(c);if(c===e&&e.defaultView){const u=A_(e.defaultView);t({id:d,x:u.left,y:u.top})}else t({id:d,x:c.scrollLeft,y:c.scrollTop})}),o.scroll||100));return ln("scroll",a,e)}function xM({viewportResizeCb:t},{win:e}){let n=-1,r=-1;const s=Pe(El(Pe(()=>{const i=D_(),o=O_();(n!==i||r!==o)&&(t({width:Number(o),height:Number(i)}),n=i,r=o)}),200));return ln("resize",s,e)}const IM=["INPUT","TEXTAREA","SELECT"],gy=new WeakMap;function bM({inputCb:t,doc:e,mirror:n,blockClass:r,blockSelector:s,unblockSelector:i,ignoreClass:o,ignoreSelector:a,maskInputOptions:l,maskInputFn:c,sampling:d,userTriggeredOnInput:u,maskTextClass:f,unmaskTextClass:h,maskTextSelector:p,unmaskTextSelector:m}){function _(E){let A=wc(E);const V=E.isTrusted,D=A&&Sp(A.tagName);if(D==="OPTION"&&(A=A.parentElement),!A||!D||IM.indexOf(D)<0||An(A,r,s,i,!0))return;const $=A;if($.classList.contains(o)||a&&$.matches(a))return;const j=Ig(A);let Z=od($,D,j),ae=!1;const ce=df({maskInputOptions:l,tagName:D,type:j}),J=Zo(A,f,p,h,m,ce);(j==="radio"||j==="checkbox")&&(ae=A.checked),Z=_l({isMasked:J,element:A,value:Z,maskInputFn:c}),g(A,u?{text:Z,isChecked:ae,userTriggered:V}:{text:Z,isChecked:ae});const K=A.name;j==="radio"&&K&&ae&&e.querySelectorAll(`input[type="radio"][name="${K}"]`).forEach(F=>{if(F!==A){const q=_l({isMasked:J,element:F,value:od(F,D,j),maskInputFn:c});g(F,u?{text:q,isChecked:!ae,userTriggered:!1}:{text:q,isChecked:!ae})}})}function g(E,A){const V=gy.get(E);if(!V||V.text!==A.text||V.isChecked!==A.isChecked){gy.set(E,A);const D=n.getId(E);Pe(t)({...A,id:D})}}const w=(d.input==="last"?["change"]:["input","change"]).map(E=>ln(E,Pe(_),e)),v=e.defaultView;if(!v)return()=>{w.forEach(E=>E())};const x=v.Object.getOwnPropertyDescriptor(v.HTMLInputElement.prototype,"value"),C=[[v.HTMLInputElement.prototype,"value"],[v.HTMLInputElement.prototype,"checked"],[v.HTMLSelectElement.prototype,"value"],[v.HTMLTextAreaElement.prototype,"value"],[v.HTMLSelectElement.prototype,"selectedIndex"],[v.HTMLOptionElement.prototype,"selected"]];return x&&x.set&&w.push(...C.map(E=>N_(E[0],E[1],{set(){Pe(_)({target:this,isTrusted:!1})}},!1,v))),Pe(()=>{w.forEach(E=>E())})}function cd(t){const e=[];function n(r,s){if(Yc("CSSGroupingRule")&&r.parentRule instanceof CSSGroupingRule||Yc("CSSMediaRule")&&r.parentRule instanceof CSSMediaRule||Yc("CSSSupportsRule")&&r.parentRule instanceof CSSSupportsRule||Yc("CSSConditionRule")&&r.parentRule instanceof CSSConditionRule){const o=Array.from(r.parentRule.cssRules).indexOf(r);s.unshift(o)}else if(r.parentStyleSheet){const o=Array.from(r.parentStyleSheet.cssRules).indexOf(r);s.unshift(o)}return s}return n(t,e)}function Ts(t,e,n){let r,s;return t?(t.ownerNode?r=e.getId(t.ownerNode):s=n.getId(t),{styleId:s,id:r}):{}}function TM({styleSheetRuleCb:t,mirror:e,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const s=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(s,{apply:Pe((d,u,f)=>{const[h,p]=f,{id:m,styleId:_}=Ts(u,e,n.styleMirror);return(m&&m!==-1||_&&_!==-1)&&t({id:m,styleId:_,adds:[{rule:h,index:p}]}),d.apply(u,f)})});const i=r.CSSStyleSheet.prototype.deleteRule;r.CSSStyleSheet.prototype.deleteRule=new Proxy(i,{apply:Pe((d,u,f)=>{const[h]=f,{id:p,styleId:m}=Ts(u,e,n.styleMirror);return(p&&p!==-1||m&&m!==-1)&&t({id:p,styleId:m,removes:[{index:h}]}),d.apply(u,f)})});let o;r.CSSStyleSheet.prototype.replace&&(o=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(o,{apply:Pe((d,u,f)=>{const[h]=f,{id:p,styleId:m}=Ts(u,e,n.styleMirror);return(p&&p!==-1||m&&m!==-1)&&t({id:p,styleId:m,replace:h}),d.apply(u,f)})}));let a;r.CSSStyleSheet.prototype.replaceSync&&(a=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:Pe((d,u,f)=>{const[h]=f,{id:p,styleId:m}=Ts(u,e,n.styleMirror);return(p&&p!==-1||m&&m!==-1)&&t({id:p,styleId:m,replaceSync:h}),d.apply(u,f)})}));const l={};qc("CSSGroupingRule")?l.CSSGroupingRule=r.CSSGroupingRule:(qc("CSSMediaRule")&&(l.CSSMediaRule=r.CSSMediaRule),qc("CSSConditionRule")&&(l.CSSConditionRule=r.CSSConditionRule),qc("CSSSupportsRule")&&(l.CSSSupportsRule=r.CSSSupportsRule));const c={};return Object.entries(l).forEach(([d,u])=>{c[d]={insertRule:u.prototype.insertRule,deleteRule:u.prototype.deleteRule},u.prototype.insertRule=new Proxy(c[d].insertRule,{apply:Pe((f,h,p)=>{const[m,_]=p,{id:g,styleId:y}=Ts(h.parentStyleSheet,e,n.styleMirror);return(g&&g!==-1||y&&y!==-1)&&t({id:g,styleId:y,adds:[{rule:m,index:[...cd(h),_||0]}]}),f.apply(h,p)})}),u.prototype.deleteRule=new Proxy(c[d].deleteRule,{apply:Pe((f,h,p)=>{const[m]=p,{id:_,styleId:g}=Ts(h.parentStyleSheet,e,n.styleMirror);return(_&&_!==-1||g&&g!==-1)&&t({id:_,styleId:g,removes:[{index:[...cd(h),m]}]}),f.apply(h,p)})})}),Pe(()=>{r.CSSStyleSheet.prototype.insertRule=s,r.CSSStyleSheet.prototype.deleteRule=i,o&&(r.CSSStyleSheet.prototype.replace=o),a&&(r.CSSStyleSheet.prototype.replaceSync=a),Object.entries(l).forEach(([d,u])=>{u.prototype.insertRule=c[d].insertRule,u.prototype.deleteRule=c[d].deleteRule})})}function W_({mirror:t,stylesheetManager:e},n){let r=null;n.nodeName==="#document"?r=t.getId(n):r=t.getId(n.host);const s=n.nodeName==="#document"?yr([n,"access",o=>o.defaultView,"optionalAccess",o=>o.Document]):yr([n,"access",o=>o.ownerDocument,"optionalAccess",o=>o.defaultView,"optionalAccess",o=>o.ShadowRoot]),i=yr([s,"optionalAccess",o=>o.prototype])?Object.getOwnPropertyDescriptor(yr([s,"optionalAccess",o=>o.prototype]),"adoptedStyleSheets"):void 0;return r===null||r===-1||!s||!i?()=>{}:(Object.defineProperty(n,"adoptedStyleSheets",{configurable:i.configurable,enumerable:i.enumerable,get(){return yr([i,"access",o=>o.get,"optionalAccess",o=>o.call,"call",o=>o(this)])},set(o){const a=yr([i,"access",l=>l.set,"optionalAccess",l=>l.call,"call",l=>l(this,o)]);if(r!==null&&r!==-1)try{e.adoptStyleSheets(o,r)}catch{}return a}}),Pe(()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:i.configurable,enumerable:i.enumerable,get:i.get,set:i.set})}))}function RM({styleDeclarationCb:t,mirror:e,ignoreCSSAttributes:n,stylesheetManager:r},{win:s}){const i=s.CSSStyleDeclaration.prototype.setProperty;s.CSSStyleDeclaration.prototype.setProperty=new Proxy(i,{apply:Pe((a,l,c)=>{const[d,u,f]=c;if(n.has(d))return i.apply(l,[d,u,f]);const{id:h,styleId:p}=Ts(yr([l,"access",m=>m.parentRule,"optionalAccess",m=>m.parentStyleSheet]),e,r.styleMirror);return(h&&h!==-1||p&&p!==-1)&&t({id:h,styleId:p,set:{property:d,value:u,priority:f},index:cd(l.parentRule)}),a.apply(l,c)})});const o=s.CSSStyleDeclaration.prototype.removeProperty;return s.CSSStyleDeclaration.prototype.removeProperty=new Proxy(o,{apply:Pe((a,l,c)=>{const[d]=c;if(n.has(d))return o.apply(l,[d]);const{id:u,styleId:f}=Ts(yr([l,"access",h=>h.parentRule,"optionalAccess",h=>h.parentStyleSheet]),e,r.styleMirror);return(u&&u!==-1||f&&f!==-1)&&t({id:u,styleId:f,remove:{property:d},index:cd(l.parentRule)}),a.apply(l,c)})}),Pe(()=>{s.CSSStyleDeclaration.prototype.setProperty=i,s.CSSStyleDeclaration.prototype.removeProperty=o})}function MM({mediaInteractionCb:t,blockClass:e,blockSelector:n,unblockSelector:r,mirror:s,sampling:i,doc:o}){const a=Pe(c=>El(Pe(d=>{const u=wc(d);if(!u||An(u,e,n,r,!0))return;const{currentTime:f,volume:h,muted:p,playbackRate:m}=u;t({type:c,id:s.getId(u),currentTime:f,volume:h,muted:p,playbackRate:m})}),i.media||500)),l=[ln("play",a(0),o),ln("pause",a(1),o),ln("seeked",a(2),o),ln("volumechange",a(3),o),ln("ratechange",a(4),o)];return Pe(()=>{l.forEach(c=>c())})}function NM({fontCb:t,doc:e}){const n=e.defaultView;if(!n)return()=>{};const r=[],s=new WeakMap,i=n.FontFace;n.FontFace=function(l,c,d){const u=new i(l,c,d);return s.set(u,{family:l,buffer:typeof c!="string",descriptors:d,fontSource:typeof c=="string"?c:JSON.stringify(Array.from(new Uint8Array(c)))}),u};const o=Tg(e.fonts,"add",function(a){return function(l){return hf(Pe(()=>{const c=s.get(l);c&&(t(c),s.delete(l))}),0),a.apply(this,[l])}});return r.push(()=>{n.FontFace=i}),r.push(o),Pe(()=>{r.forEach(a=>a())})}function AM(t){const{doc:e,mirror:n,blockClass:r,blockSelector:s,unblockSelector:i,selectionCb:o}=t;let a=!0;const l=Pe(()=>{const c=e.getSelection();if(!c||a&&yr([c,"optionalAccess",f=>f.isCollapsed]))return;a=c.isCollapsed||!1;const d=[],u=c.rangeCount||0;for(let f=0;f<u;f++){const h=c.getRangeAt(f),{startContainer:p,startOffset:m,endContainer:_,endOffset:g}=h;An(p,r,s,i,!0)||An(_,r,s,i,!0)||d.push({start:n.getId(p),startOffset:m,end:n.getId(_),endOffset:g})}o({ranges:d})});return l(),ln("selectionchange",l)}function DM({doc:t,customElementCb:e}){const n=t.defaultView;return!n||!n.customElements?()=>{}:Tg(n.customElements,"define",function(s){return function(i,o,a){try{e({define:{name:i}})}catch{}return s.apply(this,[i,o,a])}})}function OM(t,e={}){const n=t.doc.defaultView;if(!n)return()=>{};let r;t.recordDOM&&(r=z_(t,t.doc));const s=EM(t),i=kM(t),o=j_(t),a=xM(t,{win:n}),l=bM(t),c=MM(t);let d=()=>{},u=()=>{},f=()=>{},h=()=>{};t.recordDOM&&(d=TM(t,{win:n}),u=W_(t,t.doc),f=RM(t,{win:n}),t.collectFonts&&(h=NM(t)));const p=AM(t),m=DM(t),_=[];for(const g of t.plugins)_.push(g.observer(g.callback,n,g.options));return Pe(()=>{So.forEach(g=>g.reset()),yr([r,"optionalAccess",g=>g.disconnect,"call",g=>g()]),s(),i(),o(),a(),l(),c(),d(),u(),f(),h(),p(),m(),_.forEach(g=>g())})}function Yc(t){return typeof window[t]<"u"}function qc(t){return!!(typeof window[t]<"u"&&window[t].prototype&&"insertRule"in window[t].prototype&&"deleteRule"in window[t].prototype)}class kp{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,n,r,s){const i=r||this.getIdToRemoteIdMap(e),o=s||this.getRemoteIdToIdMap(e);let a=i.get(n);return a||(a=this.generateIdFn(),i.set(n,a),o.set(a,n)),a}getIds(e,n){const r=this.getIdToRemoteIdMap(e),s=this.getRemoteIdToIdMap(e);return n.map(i=>this.getId(e,i,r,s))}getRemoteId(e,n,r){const s=r||this.getRemoteIdToIdMap(e);if(typeof n!="number")return n;const i=s.get(n);return i||-1}getRemoteIds(e,n){const r=this.getRemoteIdToIdMap(e);return n.map(s=>this.getRemoteId(e,s,r))}reset(e){if(!e){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let n=this.iframeIdToRemoteIdMap.get(e);return n||(n=new Map,this.iframeIdToRemoteIdMap.set(e,n)),n}getRemoteIdToIdMap(e){let n=this.iframeRemoteIdToIdMap.get(e);return n||(n=new Map,this.iframeRemoteIdToIdMap.set(e,n)),n}}function yy(t){let e,n=t[0],r=1;for(;r<t.length;){const s=t[r],i=t[r+1];if(r+=2,(s==="optionalAccess"||s==="optionalCall")&&n==null)return;s==="access"||s==="optionalAccess"?(e=n,n=i(n)):(s==="call"||s==="optionalCall")&&(n=i((...o)=>n.call(e,...o)),e=void 0)}return n}class LM{constructor(){this.crossOriginIframeMirror=new kp(bg),this.crossOriginIframeRootIdMap=new WeakMap}addIframe(){}addLoadListener(){}attachIframe(){}}class FM{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new kp(bg),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new kp(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,n){this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:n}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),yy([this,"access",r=>r.loadListener,"optionalCall",r=>r(e)]),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const n=e;if(n.data.type!=="rrweb"||n.origin!==n.data.origin||!e.source)return;const s=this.crossOriginIframeMap.get(e.source);if(!s)return;const i=this.transformCrossOriginEvent(s,n.data.event);i&&this.wrappedEmit(i,n.data.isCheckout)}transformCrossOriginEvent(e,n){switch(n.type){case _e.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(n.data.node,e);const r=n.data.node.id;return this.crossOriginIframeRootIdMap.set(e,r),this.patchRootIdOnNode(n.data.node,r),{timestamp:n.timestamp,type:_e.IncrementalSnapshot,data:{source:he.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:n.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case _e.Meta:case _e.Load:case _e.DomContentLoaded:return!1;case _e.Plugin:return n;case _e.Custom:return this.replaceIds(n.data.payload,e,["id","parentId","previousId","nextId"]),n;case _e.IncrementalSnapshot:switch(n.data.source){case he.Mutation:return n.data.adds.forEach(r=>{this.replaceIds(r,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(r.node,e);const s=this.crossOriginIframeRootIdMap.get(e);s&&this.patchRootIdOnNode(r.node,s)}),n.data.removes.forEach(r=>{this.replaceIds(r,e,["parentId","id"])}),n.data.attributes.forEach(r=>{this.replaceIds(r,e,["id"])}),n.data.texts.forEach(r=>{this.replaceIds(r,e,["id"])}),n;case he.Drag:case he.TouchMove:case he.MouseMove:return n.data.positions.forEach(r=>{this.replaceIds(r,e,["id"])}),n;case he.ViewportResize:return!1;case he.MediaInteraction:case he.MouseInteraction:case he.Scroll:case he.CanvasMutation:case he.Input:return this.replaceIds(n.data,e,["id"]),n;case he.StyleSheetRule:case he.StyleDeclaration:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleId"]),n;case he.Font:return n;case he.Selection:return n.data.ranges.forEach(r=>{this.replaceIds(r,e,["start","end"])}),n;case he.AdoptedStyleSheet:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleIds"]),yy([n,"access",r=>r.data,"access",r=>r.styles,"optionalAccess",r=>r.forEach,"call",r=>r(s=>{this.replaceStyleIds(s,e,["styleId"])})]),n}}return!1}replace(e,n,r,s){for(const i of s)!Array.isArray(n[i])&&typeof n[i]!="number"||(Array.isArray(n[i])?n[i]=e.getIds(r,n[i]):n[i]=e.getId(r,n[i]));return n}replaceIds(e,n,r){return this.replace(this.crossOriginIframeMirror,e,n,r)}replaceStyleIds(e,n,r){return this.replace(this.crossOriginIframeStyleMirror,e,n,r)}replaceIdOnNode(e,n){this.replaceIds(e,n,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(r=>{this.replaceIdOnNode(r,n)})}patchRootIdOnNode(e,n){e.type!==Ct.Document&&!e.rootId&&(e.rootId=n),"childNodes"in e&&e.childNodes.forEach(r=>{this.patchRootIdOnNode(r,n)})}}class PM{init(){}addShadowRoot(){}observeAttachShadow(){}reset(){}}class $M{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,n){if(!el(e)||this.shadowDoms.has(e))return;this.shadowDoms.add(e),this.bypassOptions.canvasManager.addShadowRoot(e);const r=z_({...this.bypassOptions,doc:n,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},e);this.restoreHandlers.push(()=>r.disconnect()),this.restoreHandlers.push(j_({...this.bypassOptions,scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),hf(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(W_({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){!e.contentWindow||!e.contentDocument||this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,n){const r=this;this.restoreHandlers.push(Tg(e.prototype,"attachShadow",function(s){return function(i){const o=s.call(this,i);return this.shadowRoot&&B_(this)&&r.addShadowRoot(this.shadowRoot,n),o}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet,this.bypassOptions.canvasManager.resetShadowRoots()}}class wy{reset(){}freeze(){}unfreeze(){}lock(){}unlock(){}snapshot(){}addWindow(){}addShadowRoot(){}resetShadowRoots(){}}class UM{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new fM,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,n){"_cssText"in n.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:n.id,attributes:n.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,n){if(e.length===0)return;const r={id:n,styleIds:[]},s=[];for(const i of e){let o;this.styleMirror.has(i)?o=this.styleMirror.getId(i):(o=this.styleMirror.add(i),s.push({styleId:o,rules:Array.from(i.rules||CSSRule,(a,l)=>({rule:k_(a),index:l}))})),r.styleIds.push(o)}s.length>0&&(r.styles=s),this.adoptedStyleSheetCb(r)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class BM{constructor(){this.nodeMap=new WeakMap,this.active=!1}inOtherBuffer(e,n){const r=this.nodeMap.get(e);return r&&Array.from(r).some(s=>s!==n)}add(e,n){this.active||(this.active=!0,mM(()=>{this.nodeMap=new WeakMap,this.active=!1})),this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(n))}destroy(){}}let ct,ud;try{if(Array.from([1],t=>t*2)[0]!==2){const t=document.createElement("iframe");document.body.appendChild(t),Array.from=Ln([t,"access",e=>e.contentWindow,"optionalAccess",e=>e.Array,"access",e=>e.from])||Array.from,document.body.removeChild(t)}}catch(t){console.debug("Unable to override Array.from",t)}const hr=B3();function ss(t={}){const{emit:e,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:s="rr-block",blockSelector:i=null,unblockSelector:o=null,ignoreClass:a="rr-ignore",ignoreSelector:l=null,maskAllText:c=!1,maskTextClass:d="rr-mask",unmaskTextClass:u=null,maskTextSelector:f=null,unmaskTextSelector:h=null,inlineStylesheet:p=!0,maskAllInputs:m,maskInputOptions:_,slimDOMOptions:g,maskAttributeFn:y,maskInputFn:w,maskTextFn:v,maxCanvasSize:x=null,packFn:C,sampling:E={},dataURLOptions:A={},mousemoveWait:V,recordDOM:D=!0,recordCanvas:$=!1,recordCrossOriginIframes:j=!1,recordAfter:Z=t.recordAfter==="DOMContentLoaded"?t.recordAfter:"load",userTriggeredOnInput:ae=!1,collectFonts:ce=!1,inlineImages:J=!1,plugins:K,keepIframeSrcFn:F=()=>!1,ignoreCSSAttributes:q=new Set([]),errorHandler:ne,onMutation:oe,getCanvasManager:Te}=t;_M(ne);const yt=j?window.parent===window:!0;let $e=!1;if(!yt)try{window.parent.document&&($e=!1)}catch{$e=!0}if(yt&&!e)throw new Error("emit function is required");if(!yt&&!$e)return()=>{};V!==void 0&&E.mousemove===void 0&&(E.mousemove=V),hr.reset();const Ot=m===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:_!==void 0?_:{},Je=g===!0||g==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:g==="all",headMetaDescKeywords:g==="all"}:g||{};dM();let mn,I=0;const k=me=>{for(const vt of K||[])vt.eventProcessor&&(me=vt.eventProcessor(me));return C&&!$e&&(me=C(me)),me};ct=(me,vt)=>{const Ce=me;if(Ce.timestamp=ld(),Ln([So,"access",Me=>Me[0],"optionalAccess",Me=>Me.isFrozen,"call",Me=>Me()])&&Ce.type!==_e.FullSnapshot&&!(Ce.type===_e.IncrementalSnapshot&&Ce.data.source===he.Mutation)&&So.forEach(Me=>Me.unfreeze()),yt)Ln([e,"optionalCall",Me=>Me(k(Ce),vt)]);else if($e){const Me={type:"rrweb",event:k(Ce),origin:window.location.origin,isCheckout:vt};window.parent.postMessage(Me,"*")}if(Ce.type===_e.FullSnapshot)mn=Ce,I=0;else if(Ce.type===_e.IncrementalSnapshot){if(Ce.data.source===he.Mutation&&Ce.data.isAttachIframe)return;I++;const Me=r&&I>=r,re=n&&mn&&Ce.timestamp-mn.timestamp>n;(Me||re)&&Se(!0)}};const b=me=>{ct({type:_e.IncrementalSnapshot,data:{source:he.Mutation,...me}})},Q=me=>ct({type:_e.IncrementalSnapshot,data:{source:he.Scroll,...me}}),R=me=>ct({type:_e.IncrementalSnapshot,data:{source:he.CanvasMutation,...me}}),ie=me=>ct({type:_e.IncrementalSnapshot,data:{source:he.AdoptedStyleSheet,...me}}),M=new UM({mutationCb:b,adoptedStyleSheetCb:ie}),X=typeof __RRWEB_EXCLUDE_IFRAME__=="boolean"&&__RRWEB_EXCLUDE_IFRAME__?new LM:new FM({mirror:hr,mutationCb:b,stylesheetManager:M,recordCrossOriginIframes:j,wrappedEmit:ct});for(const me of K||[])me.getMirror&&me.getMirror({nodeMirror:hr,crossOriginIframeMirror:X.crossOriginIframeMirror,crossOriginIframeStyleMirror:X.crossOriginIframeStyleMirror});const fe=new BM,B=zM(Te,{mirror:hr,win:window,mutationCb:me=>ct({type:_e.IncrementalSnapshot,data:{source:he.CanvasMutation,...me}}),recordCanvas:$,blockClass:s,blockSelector:i,unblockSelector:o,maxCanvasSize:x,sampling:E.canvas,dataURLOptions:A,errorHandler:ne}),pe=typeof __RRWEB_EXCLUDE_SHADOW_DOM__=="boolean"&&__RRWEB_EXCLUDE_SHADOW_DOM__?new PM:new $M({mutationCb:b,scrollCb:Q,bypassOptions:{onMutation:oe,blockClass:s,blockSelector:i,unblockSelector:o,maskAllText:c,maskTextClass:d,unmaskTextClass:u,maskTextSelector:f,unmaskTextSelector:h,inlineStylesheet:p,maskInputOptions:Ot,dataURLOptions:A,maskAttributeFn:y,maskTextFn:v,maskInputFn:w,recordCanvas:$,inlineImages:J,sampling:E,slimDOMOptions:Je,iframeManager:X,stylesheetManager:M,canvasManager:B,keepIframeSrcFn:F,processedNodeManager:fe},mirror:hr}),Se=(me=!1)=>{if(!D)return;ct({type:_e.Meta,data:{href:window.location.href,width:O_(),height:D_()}},me),M.reset(),pe.init(),So.forEach(Ce=>Ce.lock());const vt=cM(document,{mirror:hr,blockClass:s,blockSelector:i,unblockSelector:o,maskAllText:c,maskTextClass:d,unmaskTextClass:u,maskTextSelector:f,unmaskTextSelector:h,inlineStylesheet:p,maskAllInputs:Ot,maskAttributeFn:y,maskInputFn:w,maskTextFn:v,slimDOM:Je,dataURLOptions:A,recordCanvas:$,inlineImages:J,onSerialize:Ce=>{P_(Ce,hr)&&X.addIframe(Ce),$_(Ce,hr)&&M.trackLinkElement(Ce),Cp(Ce)&&pe.addShadowRoot(Ce.shadowRoot,document)},onIframeLoad:(Ce,Me)=>{X.attachIframe(Ce,Me),Ce.contentWindow&&B.addWindow(Ce.contentWindow),pe.observeAttachShadow(Ce)},onStylesheetLoad:(Ce,Me)=>{M.attachLinkElement(Ce,Me)},keepIframeSrcFn:F});if(!vt)return console.warn("Failed to snapshot the document");ct({type:_e.FullSnapshot,data:{node:vt,initialOffset:A_(window)}}),So.forEach(Ce=>Ce.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&M.adoptStyleSheets(document.adoptedStyleSheets,hr.getId(document))};ud=Se;try{const me=[],vt=Me=>Pe(OM)({onMutation:oe,mutationCb:b,mousemoveCb:(re,gn)=>ct({type:_e.IncrementalSnapshot,data:{source:gn,positions:re}}),mouseInteractionCb:re=>ct({type:_e.IncrementalSnapshot,data:{source:he.MouseInteraction,...re}}),scrollCb:Q,viewportResizeCb:re=>ct({type:_e.IncrementalSnapshot,data:{source:he.ViewportResize,...re}}),inputCb:re=>ct({type:_e.IncrementalSnapshot,data:{source:he.Input,...re}}),mediaInteractionCb:re=>ct({type:_e.IncrementalSnapshot,data:{source:he.MediaInteraction,...re}}),styleSheetRuleCb:re=>ct({type:_e.IncrementalSnapshot,data:{source:he.StyleSheetRule,...re}}),styleDeclarationCb:re=>ct({type:_e.IncrementalSnapshot,data:{source:he.StyleDeclaration,...re}}),canvasMutationCb:R,fontCb:re=>ct({type:_e.IncrementalSnapshot,data:{source:he.Font,...re}}),selectionCb:re=>{ct({type:_e.IncrementalSnapshot,data:{source:he.Selection,...re}})},customElementCb:re=>{ct({type:_e.IncrementalSnapshot,data:{source:he.CustomElement,...re}})},blockClass:s,ignoreClass:a,ignoreSelector:l,maskAllText:c,maskTextClass:d,unmaskTextClass:u,maskTextSelector:f,unmaskTextSelector:h,maskInputOptions:Ot,inlineStylesheet:p,sampling:E,recordDOM:D,recordCanvas:$,inlineImages:J,userTriggeredOnInput:ae,collectFonts:ce,doc:Me,maskAttributeFn:y,maskInputFn:w,maskTextFn:v,keepIframeSrcFn:F,blockSelector:i,unblockSelector:o,slimDOMOptions:Je,dataURLOptions:A,mirror:hr,iframeManager:X,stylesheetManager:M,shadowDomManager:pe,processedNodeManager:fe,canvasManager:B,ignoreCSSAttributes:q,plugins:Ln([K,"optionalAccess",re=>re.filter,"call",re=>re(gn=>gn.observer),"optionalAccess",re=>re.map,"call",re=>re(gn=>({observer:gn.observer,options:gn.options,callback:io=>ct({type:_e.Plugin,data:{plugin:gn.name,payload:io}})}))])||[]},{});X.addLoadListener(Me=>{try{me.push(vt(Me.contentDocument))}catch(re){console.warn(re)}});const Ce=()=>{Se(),me.push(vt(document))};return document.readyState==="interactive"||document.readyState==="complete"?Ce():(me.push(ln("DOMContentLoaded",()=>{ct({type:_e.DomContentLoaded,data:{}}),Z==="DOMContentLoaded"&&Ce()})),me.push(ln("load",()=>{ct({type:_e.Load,data:{}}),Z==="load"&&Ce()},window))),()=>{me.forEach(Me=>Me()),fe.destroy(),ud=void 0,CM()}}catch(me){console.warn(me)}}function HM(t){if(!ud)throw new Error("please take full snapshot after start recording");ud(t)}ss.mirror=hr;ss.takeFullSnapshot=HM;function zM(t,e){try{return t?t(e):new wy}catch{return console.warn("Unable to initialize CanvasManager"),new wy}}const le=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Sy=["info","warn","error","log"],Au="[Replay] ";function eh(t,e="info"){Zs({category:"console",data:{logger:"replay"},level:e,message:`${Au}${t}`},{level:e})}function jM(){let t=!1,e=!1;const n={exception:()=>{},infoTick:()=>{},setConfig:r=>{t=r.captureExceptions,e=r.traceInternals}};return le?(Sy.forEach(r=>{n[r]=(...s)=>{Y[r](Au,...s),e&&eh(s.join(""),Jv(r))}}),n.exception=(r,...s)=>{s.length&&n.error&&n.error(...s),Y.error(Au,r),t?Bv(r):e&&eh(r,"error")},n.infoTick=(...r)=>{Y.info(Au,...r),e&&setTimeout(()=>eh(r[0]),0)}):Sy.forEach(r=>{n[r]=()=>{}}),n}const ue=jM(),WM=3,VM=5;function Mg(t){return t>9999999999?t:t*1e3}function th(t){return t>9999999999?t/1e3:t}function Sc(t,e){e.category!=="sentry.transaction"&&(["ui.click","ui.input"].includes(e.category)?t.triggerUserActivity():t.checkAndHandleExpiredSession(),t.addUpdate(()=>(t.throttledAddEvent({type:_e.Custom,timestamp:(e.timestamp||0)*1e3,data:{tag:"breadcrumb",payload:Or(e,10,1e3)}}),e.category==="console")))}const GM="button,a";function V_(t){return t.closest(GM)||t}function G_(t){const e=X_(t);return!e||!(e instanceof Element)?e:V_(e)}function X_(t){return XM(t)?t.target:t}function XM(t){return typeof t=="object"&&!!t&&"target"in t}let Rs;function YM(t){return Rs||(Rs=[],qM()),Rs.push(t),()=>{const e=Rs?Rs.indexOf(t):-1;e>-1&&Rs.splice(e,1)}}function qM(){Cn(Ye,"open",function(t){return function(...e){if(Rs)try{Rs.forEach(n=>n())}catch{}return t.apply(Ye,e)}})}const KM=new Set([he.Mutation,he.StyleSheetRule,he.StyleDeclaration,he.AdoptedStyleSheet,he.CanvasMutation,he.Selection,he.MediaInteraction]);function JM(t,e,n){t.handleClick(e,n)}class QM{constructor(e,n,r=Sc){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=n.timeout/1e3,this._threshold=n.threshold/1e3,this._scrollTimeout=n.scrollTimeout/1e3,this._replay=e,this._ignoreSelector=n.ignoreSelector,this._addBreadcrumbEvent=r}addListeners(){const e=YM(()=>{this._lastMutation=vy()});this._teardown=()=>{e(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(e,n){if(e4(n,this._ignoreSelector)||!t4(e))return;const r={timestamp:th(e.timestamp),clickBreadcrumb:e,clickCount:0,node:n};this._clicks.some(s=>s.node===r.node&&Math.abs(s.timestamp-r.timestamp)<1)||(this._clicks.push(r),this._clicks.length===1&&this._scheduleCheckClicks())}registerMutation(e=Date.now()){this._lastMutation=th(e)}registerScroll(e=Date.now()){this._lastScroll=th(e)}registerClick(e){const n=V_(e);this._handleMultiClick(n)}_handleMultiClick(e){this._getClicks(e).forEach(n=>{n.clickCount++})}_getClicks(e){return this._clicks.filter(n=>n.node===e)}_checkClicks(){const e=[],n=vy();this._clicks.forEach(r=>{!r.mutationAfter&&this._lastMutation&&(r.mutationAfter=r.timestamp<=this._lastMutation?this._lastMutation-r.timestamp:void 0),!r.scrollAfter&&this._lastScroll&&(r.scrollAfter=r.timestamp<=this._lastScroll?this._lastScroll-r.timestamp:void 0),r.timestamp+this._timeout<=n&&e.push(r)});for(const r of e){const s=this._clicks.indexOf(r);s>-1&&(this._generateBreadcrumbs(r),this._clicks.splice(s,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(e){const n=this._replay,r=e.scrollAfter&&e.scrollAfter<=this._scrollTimeout,s=e.mutationAfter&&e.mutationAfter<=this._threshold,i=!r&&!s,{clickCount:o,clickBreadcrumb:a}=e;if(i){const l=Math.min(e.mutationAfter||this._timeout,this._timeout)*1e3,c=l<this._timeout*1e3?"mutation":"timeout",d={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.slowClickDetected",data:{...a.data,url:Ye.location.href,route:n.getCurrentRoute(),timeAfterClickMs:l,endReason:c,clickCount:o||1}};this._addBreadcrumbEvent(n,d);return}if(o>1){const l={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.multiClick",data:{...a.data,url:Ye.location.href,route:n.getCurrentRoute(),clickCount:o,metric:!0}};this._addBreadcrumbEvent(n,l)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=Jo(()=>this._checkClicks(),1e3)}}const ZM=["A","BUTTON","INPUT"];function e4(t,e){return!!(!ZM.includes(t.tagName)||t.tagName==="INPUT"&&!["submit","button"].includes(t.getAttribute("type")||"")||t.tagName==="A"&&(t.hasAttribute("download")||t.hasAttribute("target")&&t.getAttribute("target")!=="_self")||e&&t.matches(e))}function t4(t){return!!(t.data&&typeof t.data.nodeId=="number"&&t.timestamp)}function vy(){return Date.now()/1e3}function n4(t,e){try{if(!r4(e))return;const{source:n}=e.data;if(KM.has(n)&&t.registerMutation(e.timestamp),n===he.Scroll&&t.registerScroll(e.timestamp),s4(e)){const{type:r,id:s}=e.data,i=ss.mirror.getNode(s);i instanceof HTMLElement&&r===rn.Click&&t.registerClick(i)}}catch{}}function r4(t){return t.type===WM}function s4(t){return t.data.source===he.MouseInteraction}function $r(t){return{timestamp:Date.now()/1e3,type:"default",...t}}var dd;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(dd||(dd={}));const i4=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled","data-sentry-component"]);function o4(t){const e={};!t["data-sentry-component"]&&t["data-sentry-element"]&&(t["data-sentry-component"]=t["data-sentry-element"]);for(const n in t)if(i4.has(n)){let r=n;(n==="data-testid"||n==="data-test-id")&&(r="testId"),e[r]=t[n]}return e}const a4=t=>e=>{if(!t.isEnabled())return;const n=l4(e);if(!n)return;const r=e.name==="click",s=r?e.event:void 0;r&&t.clickDetector&&s&&s.target&&!s.altKey&&!s.metaKey&&!s.ctrlKey&&!s.shiftKey&&JM(t.clickDetector,n,G_(e.event)),Sc(t,n)};function Y_(t,e){const n=ss.mirror.getId(t),r=n&&ss.mirror.getNode(n),s=r&&ss.mirror.getMeta(r),i=s&&u4(s)?s:null;return{message:e,data:i?{nodeId:n,node:{id:n,tagName:i.tagName,textContent:Array.from(i.childNodes).map(o=>o.type===dd.Text&&o.textContent).filter(Boolean).map(o=>o.trim()).join(""),attributes:o4(i.attributes)}}:{}}}function l4(t){const{target:e,message:n}=c4(t);return $r({category:`ui.${t.name}`,...Y_(e,n)})}function c4(t){const e=t.name==="click";let n,r=null;try{r=e?G_(t.event):X_(t.event),n=cs(r,{maxStringLength:200})||"<unknown>"}catch{n="<unknown>"}return{target:r,message:n}}function u4(t){return t.type===dd.Element}function d4(t,e){if(!t.isEnabled())return;t.updateUserActivity();const n=f4(e);n&&Sc(t,n)}function f4(t){const{metaKey:e,shiftKey:n,ctrlKey:r,altKey:s,key:i,target:o}=t;if(!o||h4(o)||!i)return null;const a=e||r||s,l=i.length===1;if(!a&&l)return null;const c=cs(o,{maxStringLength:200})||"<unknown>",d=Y_(o,c);return $r({category:"ui.keyDown",message:c,data:{...d.data,metaKey:e,shiftKey:n,ctrlKey:r,altKey:s,key:i}})}function h4(t){return t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable}const p4={resource:S4,paint:y4,navigation:w4};function Kc(t,e){return({metric:n})=>void e.replayPerformanceEntries.push(t(n))}function m4(t){return t.map(g4).filter(Boolean)}function g4(t){const e=p4[t.entryType];return e?e(t):null}function ea(t){return((dn||Ye.performance.timeOrigin)+t)/1e3}function y4(t){const{duration:e,entryType:n,name:r,startTime:s}=t,i=ea(s);return{type:n,name:r,start:i,end:i+e,data:void 0}}function w4(t){const{entryType:e,name:n,decodedBodySize:r,duration:s,domComplete:i,encodedBodySize:o,domContentLoadedEventStart:a,domContentLoadedEventEnd:l,domInteractive:c,loadEventStart:d,loadEventEnd:u,redirectCount:f,startTime:h,transferSize:p,type:m}=t;return s===0?null:{type:`${e}.${m}`,start:ea(h),end:ea(i),name:n,data:{size:p,decodedBodySize:r,encodedBodySize:o,duration:s,domInteractive:c,domContentLoadedEventStart:a,domContentLoadedEventEnd:l,loadEventStart:d,loadEventEnd:u,domComplete:i,redirectCount:f}}}function S4(t){const{entryType:e,initiatorType:n,name:r,responseEnd:s,startTime:i,decodedBodySize:o,encodedBodySize:a,responseStatus:l,transferSize:c}=t;return["fetch","xmlhttprequest"].includes(n)?null:{type:`${e}.${n}`,start:ea(i),end:ea(s),name:r,data:{size:c,statusCode:l,decodedBodySize:o,encodedBodySize:a}}}function v4(t){const e=t.entries[t.entries.length-1],n=e&&e.element?[e.element]:void 0;return pf(t,"largest-contentful-paint",n)}function _4(t){return t.sources!==void 0}function C4(t){const e=[],n=[];for(const r of t.entries)if(_4(r)){const s=[];for(const i of r.sources)if(i.node){n.push(i.node);const o=ss.mirror.getId(i.node);o&&s.push(o)}e.push({value:r.value,nodeIds:s.length?s:void 0})}return pf(t,"cumulative-layout-shift",n,e)}function E4(t){const e=t.entries[t.entries.length-1],n=e&&e.target?[e.target]:void 0;return pf(t,"first-input-delay",n)}function k4(t){const e=t.entries[t.entries.length-1],n=e&&e.target?[e.target]:void 0;return pf(t,"interaction-to-next-paint",n)}function pf(t,e,n,r){const s=t.value,i=t.rating,o=ea(s);return{type:"web-vital",name:e,start:o,end:o,data:{value:s,size:s,rating:i,nodeIds:n?n.map(a=>ss.mirror.getId(a)):void 0,attributions:r}}}function x4(t){function e(s){t.performanceEntries.includes(s)||t.performanceEntries.push(s)}function n({entries:s}){s.forEach(e)}const r=[];return["navigation","paint","resource"].forEach(s=>{r.push(Ko(s,n))}),r.push(h_(Kc(v4,t)),_g(Kc(C4,t)),p_(Kc(E4,t)),m_(Kc(k4,t))),()=>{r.forEach(s=>s())}}const I4='var t=Uint8Array,n=Uint16Array,r=Int32Array,e=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(t,e){for(var i=new n(31),a=0;a<31;++a)i[a]=e+=1<<t[a-1];var s=new r(i[30]);for(a=1;a<30;++a)for(var o=i[a];o<i[a+1];++o)s[o]=o-i[a]<<5|a;return{b:i,r:s}},o=s(e,2),f=o.b,h=o.r;f[28]=258,h[258]=28;for(var l=s(i,0).r,u=new n(32768),c=0;c<32768;++c){var v=(43690&c)>>1|(21845&c)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,u[c]=((65280&v)>>8|(255&v)<<8)>>1}var d=function(t,r,e){for(var i=t.length,a=0,s=new n(r);a<i;++a)t[a]&&++s[t[a]-1];var o,f=new n(r);for(a=1;a<r;++a)f[a]=f[a-1]+s[a-1]<<1;if(e){o=new n(1<<r);var h=15-r;for(a=0;a<i;++a)if(t[a])for(var l=a<<4|t[a],c=r-t[a],v=f[t[a]-1]++<<c,d=v|(1<<c)-1;v<=d;++v)o[u[v]>>h]=l}else for(o=new n(i),a=0;a<i;++a)t[a]&&(o[a]=u[f[t[a]-1]++]>>15-t[a]);return o},g=new t(288);for(c=0;c<144;++c)g[c]=8;for(c=144;c<256;++c)g[c]=9;for(c=256;c<280;++c)g[c]=7;for(c=280;c<288;++c)g[c]=8;var w=new t(32);for(c=0;c<32;++c)w[c]=5;var p=d(g,9,0),y=d(w,5,0),m=function(t){return(t+7)/8|0},b=function(n,r,e){return(null==e||e>n.length)&&(e=n.length),new t(n.subarray(r,e))},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(t,n,r){var e=new Error(n||M[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,E),!r)throw e;return e},z=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8},_=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8,t[e+2]|=r>>16},x=function(r,e){for(var i=[],a=0;a<r.length;++a)r[a]&&i.push({s:a,f:r[a]});var s=i.length,o=i.slice();if(!s)return{t:F,l:0};if(1==s){var f=new t(i[0].s+1);return f[i[0].s]=1,{t:f,l:1}}i.sort((function(t,n){return t.f-n.f})),i.push({s:-1,f:25001});var h=i[0],l=i[1],u=0,c=1,v=2;for(i[0]={s:-1,f:h.f+l.f,l:h,r:l};c!=s-1;)h=i[i[u].f<i[v].f?u++:v++],l=i[u!=c&&i[u].f<i[v].f?u++:v++],i[c++]={s:-1,f:h.f+l.f,l:h,r:l};var d=o[0].s;for(a=1;a<s;++a)o[a].s>d&&(d=o[a].s);var g=new n(d+1),w=A(i[c-1],g,0);if(w>e){a=0;var p=0,y=w-e,m=1<<y;for(o.sort((function(t,n){return g[n.s]-g[t.s]||t.f-n.f}));a<s;++a){var b=o[a].s;if(!(g[b]>e))break;p+=m-(1<<w-g[b]),g[b]=e}for(p>>=y;p>0;){var M=o[a].s;g[M]<e?p-=1<<e-g[M]++-1:++a}for(;a>=0&&p;--a){var E=o[a].s;g[E]==e&&(--g[E],++p)}w=e}return{t:new t(g),l:w}},A=function(t,n,r){return-1==t.s?Math.max(A(t.l,n,r+1),A(t.r,n,r+1)):n[t.s]=r},D=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new n(++r),i=0,a=t[0],s=1,o=function(t){e[i++]=t},f=1;f<=r;++f)if(t[f]==a&&f!=r)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[f]}return{c:e.subarray(0,i),n:r}},T=function(t,n){for(var r=0,e=0;e<n.length;++e)r+=t[e]*n[e];return r},k=function(t,n,r){var e=r.length,i=m(n+2);t[i]=255&e,t[i+1]=e>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var a=0;a<e;++a)t[i+a+4]=r[a];return 8*(i+4+e)},U=function(t,r,s,o,f,h,l,u,c,v,m){z(r,m++,s),++f[256];for(var b=x(f,15),M=b.t,E=b.l,A=x(h,15),U=A.t,C=A.l,F=D(M),I=F.c,S=F.n,L=D(U),O=L.c,j=L.n,q=new n(19),B=0;B<I.length;++B)++q[31&I[B]];for(B=0;B<O.length;++B)++q[31&O[B]];for(var G=x(q,7),H=G.t,J=G.l,K=19;K>4&&!H[a[K-1]];--K);var N,P,Q,R,V=v+5<<3,W=T(f,g)+T(h,w)+l,X=T(f,M)+T(h,U)+l+14+3*K+T(q,H)+2*q[16]+3*q[17]+7*q[18];if(c>=0&&V<=W&&V<=X)return k(r,m,t.subarray(c,c+v));if(z(r,m,1+(X<W)),m+=2,X<W){N=d(M,E,0),P=M,Q=d(U,C,0),R=U;var Y=d(H,J,0);z(r,m,S-257),z(r,m+5,j-1),z(r,m+10,K-4),m+=14;for(B=0;B<K;++B)z(r,m+3*B,H[a[B]]);m+=3*K;for(var Z=[I,O],$=0;$<2;++$){var tt=Z[$];for(B=0;B<tt.length;++B){var nt=31&tt[B];z(r,m,Y[nt]),m+=H[nt],nt>15&&(z(r,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else N=p,P=g,Q=y,R=w;for(B=0;B<u;++B){var rt=o[B];if(rt>255){_(r,m,N[(nt=rt>>18&31)+257]),m+=P[nt+257],nt>7&&(z(r,m,rt>>23&31),m+=e[nt]);var et=31&rt;_(r,m,Q[et]),m+=R[et],et>3&&(_(r,m,rt>>5&8191),m+=i[et])}else _(r,m,N[rt]),m+=P[rt]}return _(r,m,N[256]),m+P[256]},C=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new t(0),I=function(){for(var t=new Int32Array(256),n=0;n<256;++n){for(var r=n,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[n]=r}return t}(),S=function(){var t=-1;return{p:function(n){for(var r=t,e=0;e<n.length;++e)r=I[255&r^n[e]]^r>>>8;t=r},d:function(){return~t}}},L=function(){var t=1,n=0;return{p:function(r){for(var e=t,i=n,a=0|r.length,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=e+=r[s];e=(65535&e)+15*(e>>16),i=(65535&i)+15*(i>>16)}t=e,n=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(n%=65521))<<8|n>>8}}},O=function(a,s,o,f,u){if(!u&&(u={l:1},s.dictionary)){var c=s.dictionary.subarray(-32768),v=new t(c.length+a.length);v.set(c),v.set(a,c.length),a=v,u.w=c.length}return function(a,s,o,f,u,c){var v=c.z||a.length,d=new t(f+v+5*(1+Math.ceil(v/7e3))+u),g=d.subarray(f,d.length-u),w=c.l,p=7&(c.r||0);if(s){p&&(g[0]=c.r>>3);for(var y=C[s-1],M=y>>13,E=8191&y,z=(1<<o)-1,_=c.p||new n(32768),x=c.h||new n(z+1),A=Math.ceil(o/3),D=2*A,T=function(t){return(a[t]^a[t+1]<<A^a[t+2]<<D)&z},F=new r(25e3),I=new n(288),S=new n(32),L=0,O=0,j=c.i||0,q=0,B=c.w||0,G=0;j+2<v;++j){var H=T(j),J=32767&j,K=x[H];if(_[J]=K,x[H]=J,B<=j){var N=v-j;if((L>7e3||q>24576)&&(N>423||!w)){p=U(a,g,0,F,I,S,O,q,G,j-G,p),q=L=O=0,G=j;for(var P=0;P<286;++P)I[P]=0;for(P=0;P<30;++P)S[P]=0}var Q=2,R=0,V=E,W=J-K&32767;if(N>2&&H==T(j-W))for(var X=Math.min(M,N)-1,Y=Math.min(32767,j),Z=Math.min(258,N);W<=Y&&--V&&J!=K;){if(a[j+Q]==a[j+Q-W]){for(var $=0;$<Z&&a[j+$]==a[j+$-W];++$);if($>Q){if(Q=$,R=W,$>X)break;var tt=Math.min(W,$-2),nt=0;for(P=0;P<tt;++P){var rt=j-W+P&32767,et=rt-_[rt]&32767;et>nt&&(nt=et,K=rt)}}}W+=(J=K)-(K=_[J])&32767}if(R){F[q++]=268435456|h[Q]<<18|l[R];var it=31&h[Q],at=31&l[R];O+=e[it]+i[at],++I[257+it],++S[at],B=j+Q,++L}else F[q++]=a[j],++I[a[j]]}}for(j=Math.max(j,B);j<v;++j)F[q++]=a[j],++I[a[j]];p=U(a,g,w,F,I,S,O,q,G,j-G,p),w||(c.r=7&p|g[p/8|0]<<3,p-=7,c.h=x,c.p=_,c.i=j,c.w=B)}else{for(j=c.w||0;j<v+w;j+=65535){var st=j+65535;st>=v&&(g[p/8|0]=w,st=v),p=k(g,p+1,a.subarray(j,st))}c.i=v}return b(d,0,f+m(p)+u)}(a,null==s.level?6:s.level,null==s.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):12+s.mem,o,f,u)},j=function(t,n,r){for(;r;++n)t[n]=r,r>>>=8},q=function(t,n){var r=n.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=n.level<2?4:9==n.level?2:0,t[9]=3,0!=n.mtime&&j(t,4,Math.floor(new Date(n.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}},B=function(t){return 10+(t.filename?t.filename.length+1:0)},G=function(){function n(n,r){if("function"==typeof n&&(r=n,n={}),this.ondata=r,this.o=n||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new t(98304),this.o.dictionary){var e=this.o.dictionary.subarray(-32768);this.b.set(e,32768-e.length),this.s.i=32768-e.length}}return n.prototype.p=function(t,n){this.ondata(O(t,this.o,0,0,this.s),n)},n.prototype.push=function(n,r){this.ondata||E(5),this.s.l&&E(4);var e=n.length+this.s.z;if(e>this.b.length){if(e>2*this.b.length-32768){var i=new t(-32768&e);i.set(this.b.subarray(0,this.s.z)),this.b=i}var a=this.b.length-this.s.z;a&&(this.b.set(n.subarray(0,a),this.s.z),this.s.z=this.b.length,this.p(this.b,!1)),this.b.set(this.b.subarray(-32768)),this.b.set(n.subarray(a),32768),this.s.z=n.length-a+32768,this.s.i=32766,this.s.w=32768}else this.b.set(n,this.s.z),this.s.z+=n.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n}();var H=function(){function t(t,n){this.c=L(),this.v=1,G.call(this,t,n)}return t.prototype.push=function(t,n){this.c.p(t),G.prototype.push.call(this,t,n)},t.prototype.p=function(t,n){var r=O(t,this.o,this.v&&(this.o.dictionary?6:2),n&&4,this.s);this.v&&(function(t,n){var r=n.level,e=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=e<<6|(n.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,n.dictionary){var i=L();i.p(n.dictionary),j(t,2,i.d())}}(r,this.o),this.v=0),n&&j(r,r.length-4,this.c.d()),this.ondata(r,n)},t}(),J="undefined"!=typeof TextEncoder&&new TextEncoder,K="undefined"!=typeof TextDecoder&&new TextDecoder;try{K.decode(F,{stream:!0})}catch(t){}var N=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,n){this.ondata||E(5),this.d&&E(4),this.ondata(P(t),this.d=n||!1)},t}();function P(n,r){if(J)return J.encode(n);for(var e=n.length,i=new t(n.length+(n.length>>1)),a=0,s=function(t){i[a++]=t},o=0;o<e;++o){if(a+5>i.length){var f=new t(a+8+(e-o<<1));f.set(i),i=f}var h=n.charCodeAt(o);h<128||r?s(h):h<2048?(s(192|h>>6),s(128|63&h)):h>55295&&h<57344?(s(240|(h=65536+(1047552&h)|1023&n.charCodeAt(++o))>>18),s(128|h>>12&63),s(128|h>>6&63),s(128|63&h)):(s(224|h>>12),s(128|h>>6&63),s(128|63&h))}return b(i,0,a)}function Q(t){return function(t,n){n||(n={});var r=S(),e=t.length;r.p(t);var i=O(t,n,B(n),8),a=i.length;return q(i,n),j(i,a-8,r.d()),j(i,a-4,e),i}(P(t))}const R=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const n=this._hasEvents?",":"";this.stream.push(n+t),this._hasEvents=!0}finish(){this.stream.push("]",!0);const t=function(t){let n=0;for(const r of t)n+=r.length;const r=new Uint8Array(n);for(let n=0,e=0,i=t.length;n<i;n++){const i=t[n];r.set(i,e),e+=i.length}return r}(this._deflatedData);return this._init(),t}_init(){this._hasEvents=!1,this._deflatedData=[],this.deflate=new H,this.deflate.ondata=(t,n)=>{this._deflatedData.push(t)},this.stream=new N(((t,n)=>{this.deflate.push(t,n)})),this.stream.push("[")}},V={clear:()=>{R.clear()},addEvent:t=>R.addEvent(t),finish:()=>R.finish(),compress:t=>Q(t)};addEventListener("message",(function(t){const n=t.data.method,r=t.data.id,e=t.data.arg;if(n in V&&"function"==typeof V[n])try{const t=V[n](e);postMessage({id:r,method:n,success:!0,response:t})}catch(t){postMessage({id:r,method:n,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});';function b4(){const t=new Blob([I4]);return URL.createObjectURL(t)}class Ng extends Error{constructor(){super(`Event buffer exceeded maximum size of ${xg}.`)}}class q_{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1,this.waitForCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(e){const n=JSON.stringify(e).length;if(this._totalSize+=n,this._totalSize>xg)throw new Ng;this.events.push(e)}finish(){return new Promise(e=>{const n=this.events;this.clear(),e(JSON.stringify(n))})}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const e=this.events.map(n=>n.timestamp).sort()[0];return e?Mg(e):null}}class T4{constructor(e){this._worker=e,this._id=0}ensureReady(){return this._ensureReadyPromise?this._ensureReadyPromise:(this._ensureReadyPromise=new Promise((e,n)=>{this._worker.addEventListener("message",({data:r})=>{r.success?e():n()},{once:!0}),this._worker.addEventListener("error",r=>{n(r)},{once:!0})}),this._ensureReadyPromise)}destroy(){le&&ue.info("Destroying compression worker"),this._worker.terminate()}postMessage(e,n){const r=this._getAndIncrementId();return new Promise((s,i)=>{const o=({data:a})=>{const l=a;if(l.method===e&&l.id===r){if(this._worker.removeEventListener("message",o),!l.success){le&&ue.error("Error in compression worker: ",l.response),i(new Error("Error in compression worker"));return}s(l.response)}};this._worker.addEventListener("message",o),this._worker.postMessage({id:r,method:e,arg:n})})}_getAndIncrementId(){return this._id++}}class R4{constructor(e){this._worker=new T4(e),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this.waitForCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(e){const n=Mg(e.timestamp);(!this._earliestTimestamp||n<this._earliestTimestamp)&&(this._earliestTimestamp=n);const r=JSON.stringify(e);return this._totalSize+=r.length,this._totalSize>xg?Promise.reject(new Ng):this._sendEventToWorker(r)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear").then(null,e=>{le&&ue.exception(e,'Sending "clear" message to worker failed',e)})}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(e){return this._worker.postMessage("addEvent",e)}async _finishRequest(){const e=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,e}}class M4{constructor(e){this._fallback=new q_,this._compression=new R4(e),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get waitForCheckout(){return this._used.waitForCheckout}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(e){this._used.hasCheckout=e}set waitForCheckout(e){this._used.waitForCheckout=e}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(e){return this._used.addEvent(e)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch(e){le&&ue.exception(e,"Failed to load the compression worker, falling back to simple buffer");return}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:e,hasCheckout:n,waitForCheckout:r}=this._fallback,s=[];for(const i of e)s.push(this._compression.addEvent(i));this._compression.hasCheckout=n,this._compression.waitForCheckout=r,this._used=this._compression;try{await Promise.all(s),this._fallback.clear()}catch(i){le&&ue.exception(i,"Failed to add events when switching buffers.")}}}function N4({useCompression:t,workerUrl:e}){if(t&&window.Worker){const n=A4(e);if(n)return n}return le&&ue.info("Using simple buffer"),new q_}function A4(t){try{const e=t||D4();if(!e)return;le&&ue.info(`Using compression worker${t?` from ${t}`:""}`);const n=new Worker(e);return new M4(n)}catch(e){le&&ue.exception(e,"Failed to create compression worker")}}function D4(){return typeof __SENTRY_EXCLUDE_REPLAY_WORKER__>"u"||!__SENTRY_EXCLUDE_REPLAY_WORKER__?b4():""}function Ag(){try{return"sessionStorage"in Ye&&!!Ye.sessionStorage}catch{return!1}}function O4(t){L4(),t.session=void 0}function L4(){if(Ag())try{Ye.sessionStorage.removeItem(Eg)}catch{}}function K_(t){return t===void 0?!1:Math.random()<t}function J_(t){const e=Date.now(),n=t.id||rt(),r=t.started||e,s=t.lastActivity||e,i=t.segmentId||0,o=t.sampled,a=t.previousSessionId;return{id:n,started:r,lastActivity:s,segmentId:i,sampled:o,previousSessionId:a}}function Dg(t){if(Ag())try{Ye.sessionStorage.setItem(Eg,JSON.stringify(t))}catch{}}function F4(t,e){return K_(t)?"session":e?"buffer":!1}function _y({sessionSampleRate:t,allowBuffering:e,stickySession:n=!1},{previousSessionId:r}={}){const s=F4(t,e),i=J_({sampled:s,previousSessionId:r});return n&&Dg(i),i}function P4(){if(!Ag())return null;try{const t=Ye.sessionStorage.getItem(Eg);if(!t)return null;const e=JSON.parse(t);return le&&ue.infoTick("Loading existing session"),J_(e)}catch{return null}}function xp(t,e,n=+new Date){return t===null||e===void 0||e<0?!0:e===0?!1:t+e<=n}function Q_(t,{maxReplayDuration:e,sessionIdleExpire:n,targetTime:r=Date.now()}){return xp(t.started,e,r)||xp(t.lastActivity,n,r)}function Z_(t,{sessionIdleExpire:e,maxReplayDuration:n}){return!(!Q_(t,{sessionIdleExpire:e,maxReplayDuration:n})||t.sampled==="buffer"&&t.segmentId===0)}function nh({sessionIdleExpire:t,maxReplayDuration:e,previousSessionId:n},r){const s=r.stickySession&&P4();return s?Z_(s,{sessionIdleExpire:t,maxReplayDuration:e})?(le&&ue.infoTick("Session in sessionStorage is expired, creating new one..."),_y(r,{previousSessionId:s.id})):s:(le&&ue.infoTick("Creating new session"),_y(r,{previousSessionId:n}))}function $4(t){return t.type===_e.Custom}function Og(t,e,n){return tC(t,e)?(eC(t,e,n),!0):!1}function U4(t,e,n){return tC(t,e)?eC(t,e,n):Promise.resolve(null)}async function eC(t,e,n){const{eventBuffer:r}=t;if(!r||r.waitForCheckout&&!n)return null;const s=t.recordingMode==="buffer";try{n&&s&&r.clear(),n&&(r.hasCheckout=!0,r.waitForCheckout=!1);const i=t.getOptions(),o=B4(e,i.beforeAddRecordingEvent);return o?await r.addEvent(o):void 0}catch(i){const o=i&&i instanceof Ng,a=o?"addEventSizeExceeded":"addEvent";if(o&&s)return r.clear(),r.waitForCheckout=!0,null;t.handleException(i),await t.stop({reason:a});const l=Re();l&&l.recordDroppedEvent("internal_sdk_error","replay")}}function tC(t,e){if(!t.eventBuffer||t.isPaused()||!t.isEnabled())return!1;const n=Mg(e.timestamp);return n+t.timeouts.sessionIdlePause<Date.now()?!1:n>t.getContext().initialTimestamp+t.getOptions().maxReplayDuration?(le&&ue.infoTick(`Skipping event with timestamp ${n} because it is after maxReplayDuration`),!1):!0}function B4(t,e){try{if(typeof e=="function"&&$4(t))return e(t)}catch(n){return le&&ue.exception(n,"An error occurred in the `beforeAddRecordingEvent` callback, skipping the event..."),null}return t}function Lg(t){return!t.type}function Ip(t){return t.type==="transaction"}function H4(t){return t.type==="replay_event"}function Cy(t){return t.type==="feedback"}function z4(t){return(e,n)=>{if(!t.isEnabled()||!Lg(e)&&!Ip(e))return;const r=n&&n.statusCode;if(!(!r||r<200||r>=300)){if(Ip(e)){j4(t,e);return}W4(t,e)}}}function j4(t,e){const n=t.getContext();e.contexts&&e.contexts.trace&&e.contexts.trace.trace_id&&n.traceIds.size<100&&n.traceIds.add(e.contexts.trace.trace_id)}function W4(t,e){const n=t.getContext();if(e.event_id&&n.errorIds.size<100&&n.errorIds.add(e.event_id),t.recordingMode!=="buffer"||!e.tags||!e.tags.replayId)return;const{beforeErrorSampling:r}=t.getOptions();typeof r=="function"&&!r(e)||Jo(async()=>{try{await t.sendBufferedReplayOrFlush()}catch(s){t.handleException(s)}})}function V4(t){return e=>{!t.isEnabled()||!Lg(e)||G4(t,e)}}function G4(t,e){const n=e.exception&&e.exception.values&&e.exception.values[0]&&e.exception.values[0].value;if(typeof n=="string"&&(n.match(/(reactjs\.org\/docs\/error-decoder\.html\?invariant=|react\.dev\/errors\/)(418|419|422|423|425)/)||n.match(/(does not match server-rendered HTML|Hydration failed because)/i))){const r=$r({category:"replay.hydrate-error",data:{url:hv()}});Sc(t,r)}}function X4(t){const e=Re();e&&e.on("beforeAddBreadcrumb",n=>Y4(t,n))}function Y4(t,e){if(!t.isEnabled()||!nC(e))return;const n=q4(e);n&&Sc(t,n)}function q4(t){return!nC(t)||["fetch","xhr","sentry.event","sentry.transaction"].includes(t.category)||t.category.startsWith("ui.")?null:t.category==="console"?K4(t):$r(t)}function K4(t){const e=t.data&&t.data.arguments;if(!Array.isArray(e)||e.length===0)return $r(t);let n=!1;const r=e.map(s=>{if(!s)return s;if(typeof s=="string")return s.length>Xc?(n=!0,`${s.slice(0,Xc)}`):s;if(typeof s=="object")try{const i=Or(s,7);return JSON.stringify(i).length>Xc?(n=!0,`${JSON.stringify(i,null,2).slice(0,Xc)}`):i}catch{}return s});return $r({...t,data:{...t.data,arguments:r,...n?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}function nC(t){return!!t.category}function J4(t,e){return t.type||!t.exception||!t.exception.values||!t.exception.values.length?!1:!!(e.originalException&&e.originalException.__rrweb__)}function rC(){const t=Ke().getPropagationContext().dsc;t&&delete t.replay_id;const e=Gt();if(e){const n=ui(e);delete n.replay_id}}function Q4(t,e){t.triggerUserActivity(),t.addUpdate(()=>e.timestamp?(t.throttledAddEvent({type:_e.Custom,timestamp:e.timestamp*1e3,data:{tag:"breadcrumb",payload:{timestamp:e.timestamp,type:"default",category:"sentry.feedback",data:{feedbackId:e.event_id}}}}),!1):!0)}function Z4(t,e){return t.recordingMode!=="buffer"||e.message===kg||!e.exception||e.type?!1:K_(t.getOptions().errorSampleRate)}function eN(t){return Object.assign((e,n)=>!t.isEnabled()||t.isPaused()?e:H4(e)?(delete e.breadcrumbs,e):!Lg(e)&&!Ip(e)&&!Cy(e)?e:t.checkAndHandleExpiredSession()?Cy(e)?(t.flush(),e.contexts.feedback.replay_id=t.getSessionId(),Q4(t,e),e):J4(e,n)&&!t.getOptions()._experiments.captureExceptions?(le&&ue.log("Ignoring error from rrweb internals",e),null):((Z4(t,e)||t.recordingMode==="session")&&(e.tags={...e.tags,replayId:t.getSessionId()}),e):(rC(),e),{id:"Replay"})}function mf(t,e){return e.map(({type:n,start:r,end:s,name:i,data:o})=>{const a=t.throttledAddEvent({type:_e.Custom,timestamp:r,data:{tag:"performanceSpan",payload:{op:n,description:i,startTimestamp:r,endTimestamp:s,data:o}}});return typeof a=="string"?Promise.resolve(null):a})}function tN(t){const{from:e,to:n}=t,r=Date.now()/1e3;return{type:"navigation.push",start:r,end:r,name:n,data:{previous:e}}}function nN(t){return e=>{if(!t.isEnabled())return;const n=tN(e);n!==null&&(t.getContext().urls.push(n.name),t.triggerUserActivity(),t.addUpdate(()=>(mf(t,[n]),!1)))}}function rN(t,e){return le&&t.getOptions()._experiments.traceInternals?!1:f6(e,Re())}function sC(t,e){t.isEnabled()&&e!==null&&(rN(t,e.name)||t.addUpdate(()=>(mf(t,[e]),!0)))}function gf(t){if(!t)return;const e=new TextEncoder;try{if(typeof t=="string")return e.encode(t).length;if(t instanceof URLSearchParams)return e.encode(t.toString()).length;if(t instanceof FormData){const n=lC(t);return e.encode(n).length}if(t instanceof Blob)return t.size;if(t instanceof ArrayBuffer)return t.byteLength}catch{}}function iC(t){if(!t)return;const e=parseInt(t,10);return isNaN(e)?void 0:e}function oC(t){try{if(typeof t=="string")return[t];if(t instanceof URLSearchParams)return[t.toString()];if(t instanceof FormData)return[lC(t)];if(!t)return[void 0]}catch(e){return le&&ue.exception(e,"Failed to serialize body",t),[void 0,"BODY_PARSE_ERROR"]}return le&&ue.info("Skipping network body because of body type",t),[void 0,"UNPARSEABLE_BODY_TYPE"]}function fd(t,e){if(!t)return{headers:{},size:void 0,_meta:{warnings:[e]}};const n={...t._meta},r=n.warnings||[];return n.warnings=[...r,e],t._meta=n,t}function aC(t,e){if(!e)return null;const{startTimestamp:n,endTimestamp:r,url:s,method:i,statusCode:o,request:a,response:l}=e;return{type:t,start:n/1e3,end:r/1e3,name:s,data:kt({method:i,statusCode:o,request:a,response:l})}}function kl(t){return{headers:{},size:t,_meta:{warnings:["URL_SKIPPED"]}}}function Hs(t,e,n){if(!e&&Object.keys(t).length===0)return;if(!e)return{headers:t};if(!n)return{headers:t,size:e};const r={headers:t,size:e},{body:s,warnings:i}=sN(n);return r.body=s,i&&i.length>0&&(r._meta={warnings:i}),r}function bp(t,e){return Object.entries(t).reduce((n,[r,s])=>{const i=r.toLowerCase();return e.includes(i)&&t[r]&&(n[i]=s),n},{})}function lC(t){return new URLSearchParams(t).toString()}function sN(t){if(!t||typeof t!="string")return{body:t};const e=t.length>sy,n=iN(t);if(e){const r=t.slice(0,sy);return n?{body:r,warnings:["MAYBE_JSON_TRUNCATED"]}:{body:`${r}`,warnings:["TEXT_TRUNCATED"]}}if(n)try{return{body:JSON.parse(t)}}catch{}return{body:t}}function iN(t){const e=t[0],n=t[t.length-1];return e==="["&&n==="]"||e==="{"&&n==="}"}function hd(t,e){const n=oN(t);return Bs(n,e)}function oN(t,e=Ye.document.baseURI){if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith(Ye.location.origin))return t;const n=new URL(t,e);if(n.origin!==new URL(e).origin)return t;const r=n.href;return!t.endsWith("/")&&r.endsWith("/")?r.slice(0,-1):r}async function aN(t,e,n){try{const r=await cN(t,e,n),s=aC("resource.fetch",r);sC(n.replay,s)}catch(r){le&&ue.exception(r,"Failed to capture fetch breadcrumb")}}function lN(t,e){const{input:n,response:r}=e,s=n?cC(n):void 0,i=gf(s),o=r?iC(r.headers.get("content-length")):void 0;i!==void 0&&(t.data.request_body_size=i),o!==void 0&&(t.data.response_body_size=o)}async function cN(t,e,n){const r=Date.now(),{startTimestamp:s=r,endTimestamp:i=r}=e,{url:o,method:a,status_code:l=0,request_body_size:c,response_body_size:d}=t.data,u=hd(o,n.networkDetailAllowUrls)&&!hd(o,n.networkDetailDenyUrls),f=u?uN(n,e.input,c):kl(c),h=await dN(u,n,e.response,d);return{startTimestamp:s,endTimestamp:i,url:o,method:a,statusCode:l,request:f,response:h}}function uN({networkCaptureBodies:t,networkRequestHeaders:e},n,r){const s=n?pN(n,e):{};if(!t)return Hs(s,r,void 0);const i=cC(n),[o,a]=oC(i),l=Hs(s,r,o);return a?fd(l,a):l}async function dN(t,{networkCaptureBodies:e,networkResponseHeaders:n},r,s){if(!t&&s!==void 0)return kl(s);const i=r?uC(r.headers,n):{};if(!r||!e&&s!==void 0)return Hs(i,s,void 0);const[o,a]=await hN(r),l=fN(o,{networkCaptureBodies:e,responseBodySize:s,captureDetails:t,headers:i});return a?fd(l,a):l}function fN(t,{networkCaptureBodies:e,responseBodySize:n,captureDetails:r,headers:s}){try{const i=t&&t.length&&n===void 0?gf(t):n;return r?e?Hs(s,i,t):Hs(s,i,void 0):kl(i)}catch(i){return le&&ue.exception(i,"Failed to serialize response body"),Hs(s,n,void 0)}}async function hN(t){const e=mN(t);if(!e)return[void 0,"BODY_PARSE_ERROR"];try{return[await gN(e)]}catch(n){return n instanceof Error&&n.message.indexOf("Timeout")>-1?(le&&ue.warn("Parsing text body from response timed out"),[void 0,"BODY_PARSE_TIMEOUT"]):(le&&ue.exception(n,"Failed to get text body from response"),[void 0,"BODY_PARSE_ERROR"])}}function cC(t=[]){if(!(t.length!==2||typeof t[1]!="object"))return t[1].body}function uC(t,e){const n={};return e.forEach(r=>{t.get(r)&&(n[r]=t.get(r))}),n}function pN(t,e){return t.length===1&&typeof t[0]!="string"?Ey(t[0],e):t.length===2?Ey(t[1],e):{}}function Ey(t,e){if(!t)return{};const n=t.headers;return n?n instanceof Headers?uC(n,e):Array.isArray(n)?{}:bp(n,e):{}}function mN(t){try{return t.clone()}catch(e){le&&ue.exception(e,"Failed to clone response body")}}function gN(t){return new Promise((e,n)=>{const r=Jo(()=>n(new Error("Timeout while trying to read response body")),500);yN(t).then(s=>e(s),s=>n(s)).finally(()=>clearTimeout(r))})}async function yN(t){return await t.text()}async function wN(t,e,n){try{const r=vN(t,e,n),s=aC("resource.xhr",r);sC(n.replay,s)}catch(r){le&&ue.exception(r,"Failed to capture xhr breadcrumb")}}function SN(t,e){const{xhr:n,input:r}=e;if(!n)return;const s=gf(r),i=n.getResponseHeader("content-length")?iC(n.getResponseHeader("content-length")):kN(n.response,n.responseType);s!==void 0&&(t.data.request_body_size=s),i!==void 0&&(t.data.response_body_size=i)}function vN(t,e,n){const r=Date.now(),{startTimestamp:s=r,endTimestamp:i=r,input:o,xhr:a}=e,{url:l,method:c,status_code:d=0,request_body_size:u,response_body_size:f}=t.data;if(!l)return null;if(!a||!hd(l,n.networkDetailAllowUrls)||hd(l,n.networkDetailDenyUrls)){const C=kl(u),E=kl(f);return{startTimestamp:s,endTimestamp:i,url:l,method:c,statusCode:d,request:C,response:E}}const h=a[Ei],p=h?bp(h.request_headers,n.networkRequestHeaders):{},m=bp(_N(a),n.networkResponseHeaders),[_,g]=n.networkCaptureBodies?oC(o):[void 0],[y,w]=n.networkCaptureBodies?CN(a):[void 0],v=Hs(p,u,_),x=Hs(m,f,y);return{startTimestamp:s,endTimestamp:i,url:l,method:c,statusCode:d,request:g?fd(v,g):v,response:w?fd(x,w):x}}function _N(t){const e=t.getAllResponseHeaders();return e?e.split(`\r
`).reduce((n,r)=>{const[s,i]=r.split(": ");return i&&(n[s.toLowerCase()]=i),n},{}):{}}function CN(t){const e=[];try{return[t.responseText]}catch(n){e.push(n)}try{return EN(t.response,t.responseType)}catch(n){e.push(n)}return le&&ue.warn("Failed to get xhr response body",...e),[void 0]}function EN(t,e){try{if(typeof t=="string")return[t];if(t instanceof Document)return[t.body.outerHTML];if(e==="json"&&t&&typeof t=="object")return[JSON.stringify(t)];if(!t)return[void 0]}catch(n){return le&&ue.exception(n,"Failed to serialize body",t),[void 0,"BODY_PARSE_ERROR"]}return le&&ue.info("Skipping network body because of body type",t),[void 0,"UNPARSEABLE_BODY_TYPE"]}function kN(t,e){try{const n=e==="json"&&t&&typeof t=="object"?JSON.stringify(t):t;return gf(n)}catch{return}}function xN(t){const e=Re();try{const{networkDetailAllowUrls:n,networkDetailDenyUrls:r,networkCaptureBodies:s,networkRequestHeaders:i,networkResponseHeaders:o}=t.getOptions(),a={replay:t,networkDetailAllowUrls:n,networkDetailDenyUrls:r,networkCaptureBodies:s,networkRequestHeaders:i,networkResponseHeaders:o};e&&e.on("beforeAddBreadcrumb",(l,c)=>IN(a,l,c))}catch{}}function IN(t,e,n){if(e.data)try{bN(e)&&RN(n)&&(SN(e,n),wN(e,n,t)),TN(e)&&MN(n)&&(lN(e,n),aN(e,n,t))}catch(r){le&&ue.exception(r,"Error when enriching network breadcrumb")}}function bN(t){return t.category==="xhr"}function TN(t){return t.category==="fetch"}function RN(t){return t&&t.xhr}function MN(t){return t&&t.response}function NN(t){const e=Re();S_(a4(t)),uf(nN(t)),X4(t),xN(t);const n=eN(t);Vb(n),e&&(e.on("beforeSendEvent",V4(t)),e.on("afterSendEvent",z4(t)),e.on("createDsc",r=>{const s=t.getSessionId();s&&t.isEnabled()&&t.recordingMode==="session"&&t.checkAndHandleExpiredSession()&&(r.replay_id=s)}),e.on("spanStart",r=>{t.lastActiveSpan=r}),e.on("spanEnd",r=>{t.lastActiveSpan=r}),e.on("beforeSendFeedback",(r,s)=>{const i=t.getSessionId();s&&s.includeReplay&&t.isEnabled()&&i&&r.contexts&&r.contexts.feedback&&(r.contexts.feedback.replay_id=i)}))}async function AN(t){try{return Promise.all(mf(t,[DN(Ye.performance.memory)]))}catch{return[]}}function DN(t){const{jsHeapSizeLimit:e,totalJSHeapSize:n,usedJSHeapSize:r}=t,s=Date.now()/1e3;return{type:"memory",name:"memory",start:s,end:s,data:{memory:{jsHeapSizeLimit:e,totalJSHeapSize:n,usedJSHeapSize:r}}}}function ON(t,e,n){let r,s,i;const o=n&&n.maxWait?Math.max(n.maxWait,e):0;function a(){return l(),r=t(),r}function l(){s!==void 0&&clearTimeout(s),i!==void 0&&clearTimeout(i),s=i=void 0}function c(){return s!==void 0||i!==void 0?a():r}function d(){return s&&clearTimeout(s),s=Jo(a,e),o&&i===void 0&&(i=Jo(a,o)),r}return d.cancel=l,d.flush=c,d}function LN(t){let e=!1;return(n,r)=>{if(!t.checkAndHandleExpiredSession()){le&&ue.warn("Received replay event after session expired.");return}const s=r||!e;e=!0,t.clickDetector&&n4(t.clickDetector,n),t.addUpdate(()=>{if(t.recordingMode==="buffer"&&s&&t.setInitialState(),!Og(t,n,s))return!0;if(!s)return!1;const i=t.session;if(PN(t,s),t.recordingMode==="buffer"&&i&&t.eventBuffer){const o=t.eventBuffer.getEarliestTimestamp();o&&(le&&ue.info(`Updating session start time to earliest event in buffer to ${new Date(o)}`),i.started=o,t.getOptions().stickySession&&Dg(i))}return i&&i.previousSessionId||t.recordingMode==="session"&&t.flush(),!0})}}function FN(t){const e=t.getOptions();return{type:_e.Custom,timestamp:Date.now(),data:{tag:"options",payload:{shouldRecordCanvas:t.isRecordingCanvas(),sessionSampleRate:e.sessionSampleRate,errorSampleRate:e.errorSampleRate,useCompressionOption:e.useCompression,blockAllMedia:e.blockAllMedia,maskAllText:e.maskAllText,maskAllInputs:e.maskAllInputs,useCompression:t.eventBuffer?t.eventBuffer.type==="worker":!1,networkDetailHasUrls:e.networkDetailAllowUrls.length>0,networkCaptureBodies:e.networkCaptureBodies,networkRequestHasHeaders:e.networkRequestHeaders.length>0,networkResponseHasHeaders:e.networkResponseHeaders.length>0}}}}function PN(t,e){!e||!t.session||t.session.segmentId!==0||Og(t,FN(t),!1)}function $N(t,e,n,r){return Qi(Ov(t,mg(t),r,n),[[{type:"replay_event"},t],[{type:"replay_recording",length:typeof e=="string"?new TextEncoder().encode(e).length:e.length},e]])}function UN({recordingData:t,headers:e}){let n;const r=`${JSON.stringify(e)}
`;if(typeof t=="string")n=`${r}${t}`;else{const i=new TextEncoder().encode(r);n=new Uint8Array(i.length+t.length),n.set(i),n.set(t,i.length)}return n}async function BN({client:t,scope:e,replayId:n,event:r}){const s=typeof t._integrations=="object"&&t._integrations!==null&&!Array.isArray(t._integrations)?Object.keys(t._integrations):void 0,i={event_id:n,integrations:s};t.emit("preprocessEvent",r,i);const o=await Uv(t.getOptions(),r,i,e,t,dr());if(!o)return null;o.platform=o.platform||"javascript";const a=t.getSdkMetadata(),{name:l,version:c}=a&&a.sdk||{};return o.sdk={...o.sdk,name:l||"sentry.javascript.unknown",version:c||"0.0.0"},o}async function HN({recordingData:t,replayId:e,segmentId:n,eventContext:r,timestamp:s,session:i}){const o=UN({recordingData:t,headers:{segment_id:n}}),{urls:a,errorIds:l,traceIds:c,initialTimestamp:d}=r,u=Re(),f=Ke(),h=u&&u.getTransport(),p=u&&u.getDsn();if(!u||!h||!p||!i.sampled)return us({});const m={type:C3,replay_start_timestamp:d/1e3,timestamp:s/1e3,error_ids:l,trace_ids:c,urls:a,replay_id:e,segment_id:n,replay_type:i.sampled},_=await BN({scope:f,client:u,replayId:e,event:m});if(!_)return u.recordDroppedEvent("event_processor","replay",m),le&&ue.info("An event processor returned `null`, will not send event."),us({});delete _.sdkProcessingMetadata;const g=$N(_,o,p,u.getOptions().tunnel);let y;try{y=await h.send(g)}catch(v){const x=new Error(kg);try{x.cause=v}catch{}throw x}if(typeof y.statusCode=="number"&&(y.statusCode<200||y.statusCode>=300))throw new dC(y.statusCode);const w=qv({},y);if(Yv(w,"replay"))throw new Fg(w);return y}class dC extends Error{constructor(e){super(`Transport returned status code ${e}`)}}class Fg extends Error{constructor(e){super("Rate limit hit"),this.rateLimits=e}}async function fC(t,e={count:0,interval:T3}){const{recordingData:n,onError:r}=t;if(n.length)try{return await HN(t),!0}catch(s){if(s instanceof dC||s instanceof Fg)throw s;if(zv("Replays",{_retryCount:e.count}),r&&r(s),e.count>=R3){const i=new Error(`${kg} - max retries exceeded`);try{i.cause=s}catch{}throw i}return e.interval*=++e.count,new Promise((i,o)=>{Jo(async()=>{try{await fC(t,e),i(!0)}catch(a){o(a)}},e.interval)})}}const hC="__THROTTLED",zN="__SKIPPED";function jN(t,e,n){const r=new Map,s=a=>{const l=a-n;r.forEach((c,d)=>{d<l&&r.delete(d)})},i=()=>[...r.values()].reduce((a,l)=>a+l,0);let o=!1;return(...a)=>{const l=Math.floor(Date.now()/1e3);if(s(l),i()>=e){const d=o;return o=!0,d?zN:hC}o=!1;const c=r.get(l)||0;return r.set(l,c+1),t(...a)}}class Ms{constructor({options:e,recordingOptions:n}){Ms.prototype.__init.call(this),Ms.prototype.__init2.call(this),Ms.prototype.__init3.call(this),Ms.prototype.__init4.call(this),Ms.prototype.__init5.call(this),Ms.prototype.__init6.call(this),this.eventBuffer=null,this.performanceEntries=[],this.replayPerformanceEntries=[],this.recordingMode="session",this.timeouts={sessionIdlePause:E3,sessionIdleExpire:k3},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._requiresManualStart=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=n,this._options=e,this._debouncedFlush=ON(()=>this._flush(),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=jN((o,a)=>U4(this,o,a),300,5);const{slowClickTimeout:r,slowClickIgnoreSelectors:s}=this.getOptions(),i=r?{threshold:Math.min(M3,r),timeout:r,scrollTimeout:N3,ignoreSelector:s?s.join(","):""}:void 0;if(i&&(this.clickDetector=new QM(this,i)),le){const o=e._experiments;ue.setConfig({captureExceptions:!!o.captureExceptions,traceInternals:!!o.traceInternals})}}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}isRecordingCanvas(){return!!this._canvas}getOptions(){return this._options}handleException(e){le&&ue.exception(e),this._options.onError&&this._options.onError(e)}initializeSampling(e){const{errorSampleRate:n,sessionSampleRate:r}=this._options,s=n<=0&&r<=0;if(this._requiresManualStart=s,!s){if(this._initializeSessionForSampling(e),!this.session){le&&ue.exception(new Error("Unable to initialize and create session"));return}this.session.sampled!==!1&&(this.recordingMode=this.session.sampled==="buffer"&&this.session.segmentId===0?"buffer":"session",le&&ue.infoTick(`Starting replay in ${this.recordingMode} mode`),this._initializeRecording())}}start(){if(this._isEnabled&&this.recordingMode==="session"){le&&ue.info("Recording is already in progress");return}if(this._isEnabled&&this.recordingMode==="buffer"){le&&ue.info("Buffering is in progress, call `flush()` to save the replay");return}le&&ue.infoTick("Starting replay in session mode"),this._updateUserActivity();const e=nh({maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire},{stickySession:this._options.stickySession,sessionSampleRate:1,allowBuffering:!1});this.session=e,this._initializeRecording()}startBuffering(){if(this._isEnabled){le&&ue.info("Buffering is in progress, call `flush()` to save the replay");return}le&&ue.infoTick("Starting replay in buffer mode");const e=nh({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration},{stickySession:this._options.stickySession,sessionSampleRate:0,allowBuffering:!0});this.session=e,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{const e=this._canvas;this._stopRecording=ss({...this._recordingOptions,...this.recordingMode==="buffer"?{checkoutEveryNms:b3}:this._options._experiments.continuousCheckout&&{checkoutEveryNms:Math.max(36e4,this._options._experiments.continuousCheckout)},emit:LN(this),onMutation:this._onMutationHandler,...e?{recordCanvas:e.recordCanvas,getCanvasManager:e.getCanvasManager,sampling:e.sampling,dataURLOptions:e.dataURLOptions}:{}})}catch(e){this.handleException(e)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(e){return this.handleException(e),!1}}async stop({forceFlush:e=!1,reason:n}={}){if(this._isEnabled){this._isEnabled=!1;try{le&&ue.info(`Stopping Replay${n?` triggered by ${n}`:""}`),rC(),this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),e&&await this._flush({force:!0}),this.eventBuffer&&this.eventBuffer.destroy(),this.eventBuffer=null,O4(this)}catch(r){this.handleException(r)}}}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),le&&ue.info("Pausing replay"))}resume(){!this._isPaused||!this._checkSession()||(this._isPaused=!1,this.startRecording(),le&&ue.info("Resuming replay"))}async sendBufferedReplayOrFlush({continueRecording:e=!0}={}){if(this.recordingMode==="session")return this.flushImmediate();const n=Date.now();le&&ue.info("Converting buffer to session"),await this.flushImmediate();const r=this.stopRecording();!e||!r||this.recordingMode!=="session"&&(this.recordingMode="session",this.session&&(this._updateUserActivity(n),this._updateSessionActivity(n),this._maybeSaveSession()),this.startRecording())}addUpdate(e){const n=e();this.recordingMode!=="buffer"&&n!==!0&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),!this._stopRecording){if(!this._checkSession())return;this.resume();return}this.checkAndHandleExpiredSession(),this._updateSessionActivity()}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return this.recordingMode==="buffer"?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){if(this._lastActivity&&xp(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&this.session.sampled==="session"){this.pause();return}return!!this._checkSession()}setInitialState(){const e=`${Ye.location.pathname}${Ye.location.hash}${Ye.location.search}`,n=`${Ye.location.origin}${e}`;this.performanceEntries=[],this.replayPerformanceEntries=[],this._clearContext(),this._context.initialUrl=n,this._context.initialTimestamp=Date.now(),this._context.urls.push(n)}throttledAddEvent(e,n){const r=this._throttledAddEvent(e,n);if(r===hC){const s=$r({category:"replay.throttled"});this.addUpdate(()=>!Og(this,{type:VM,timestamp:s.timestamp||0,data:{tag:"breadcrumb",payload:s,metric:!0}}))}return r}getCurrentRoute(){const e=this.lastActiveSpan||Gt(),n=e&&zt(e),s=(n&&Ae(n).data||{})[Pr];if(!(!n||!s||!["route","custom"].includes(s)))return Ae(n).description}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=N4({useCompression:this._options.useCompression,workerUrl:this._options.workerUrl}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this._isPaused=!1,this.startRecording()}_initializeSessionForSampling(e){const n=this._options.errorSampleRate>0,r=nh({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,previousSessionId:e},{stickySession:this._options.stickySession,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:n});this.session=r}_checkSession(){if(!this.session)return!1;const e=this.session;return Z_(e,{sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration})?(this._refreshSession(e),!1):!0}async _refreshSession(e){this._isEnabled&&(await this.stop({reason:"refresh session"}),this.initializeSampling(e.id))}_addListeners(){try{Ye.document.addEventListener("visibilitychange",this._handleVisibilityChange),Ye.addEventListener("blur",this._handleWindowBlur),Ye.addEventListener("focus",this._handleWindowFocus),Ye.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(NN(this),this._hasInitializedCoreListeners=!0)}catch(e){this.handleException(e)}this._performanceCleanupCallback=x4(this)}_removeListeners(){try{Ye.document.removeEventListener("visibilitychange",this._handleVisibilityChange),Ye.removeEventListener("blur",this._handleWindowBlur),Ye.removeEventListener("focus",this._handleWindowFocus),Ye.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceCleanupCallback&&this._performanceCleanupCallback()}catch(e){this.handleException(e)}}__init(){this._handleVisibilityChange=()=>{Ye.document.visibilityState==="visible"?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()}}__init2(){this._handleWindowBlur=()=>{const e=$r({category:"ui.blur"});this._doChangeToBackgroundTasks(e)}}__init3(){this._handleWindowFocus=()=>{const e=$r({category:"ui.focus"});this._doChangeToForegroundTasks(e)}}__init4(){this._handleKeyboardEvent=e=>{d4(this,e)}}_doChangeToBackgroundTasks(e){!this.session||Q_(this.session,{maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire})||(e&&this._createCustomBreadcrumb(e),this.conditionalFlush())}_doChangeToForegroundTasks(e){if(!this.session)return;if(!this.checkAndHandleExpiredSession()){le&&ue.info("Document has become active, but session has expired");return}e&&this._createCustomBreadcrumb(e)}_updateUserActivity(e=Date.now()){this._lastActivity=e}_updateSessionActivity(e=Date.now()){this.session&&(this.session.lastActivity=e,this._maybeSaveSession())}_createCustomBreadcrumb(e){this.addUpdate(()=>{this.throttledAddEvent({type:_e.Custom,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e}})})}_addPerformanceEntries(){let e=m4(this.performanceEntries).concat(this.replayPerformanceEntries);if(this.performanceEntries=[],this.replayPerformanceEntries=[],this._requiresManualStart){const n=this._context.initialTimestamp/1e3;e=e.filter(r=>r.start>=n)}return Promise.all(mf(this,e))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:e,eventBuffer:n}=this;if(!e||!n||this._requiresManualStart||e.segmentId)return;const r=n.getEarliestTimestamp();r&&r<this._context.initialTimestamp&&(this._context.initialTimestamp=r)}_popEventContext(){const e={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),e}async _runFlush(){const e=this.getSessionId();if(!this.session||!this.eventBuffer||!e){le&&ue.error("No session or eventBuffer found to flush.");return}if(await this._addPerformanceEntries(),!(!this.eventBuffer||!this.eventBuffer.hasEvents)&&(await AN(this),!!this.eventBuffer&&e===this.getSessionId()))try{this._updateInitialTimestampFromEventBuffer();const n=Date.now();if(n-this._context.initialTimestamp>this._options.maxReplayDuration+3e4)throw new Error("Session is too long, not sending replay");const r=this._popEventContext(),s=this.session.segmentId++;this._maybeSaveSession();const i=await this.eventBuffer.finish();await fC({replayId:e,recordingData:i,segmentId:s,eventContext:r,session:this.session,timestamp:n,onError:o=>this.handleException(o)})}catch(n){this.handleException(n),this.stop({reason:"sendReplay"});const r=Re();if(r){const s=n instanceof Fg?"ratelimit_backoff":"send_error";r.recordDroppedEvent(s,"replay")}}}__init5(){this._flush=async({force:e=!1}={})=>{if(!this._isEnabled&&!e)return;if(!this.checkAndHandleExpiredSession()){le&&ue.error("Attempting to finish replay event after session expired.");return}if(!this.session)return;const n=this.session.started,s=Date.now()-n;this._debouncedFlush.cancel();const i=s<this._options.minReplayDuration,o=s>this._options.maxReplayDuration+5e3;if(i||o){le&&ue.info(`Session duration (${Math.floor(s/1e3)}s) is too ${i?"short":"long"}, not sending replay.`),i&&this._debouncedFlush();return}const a=this.eventBuffer;a&&this.session.segmentId===0&&!a.hasCheckout&&le&&ue.info("Flushing initial segment without checkout.");const l=!!this._flushLock;this._flushLock||(this._flushLock=this._runFlush());try{await this._flushLock}catch(c){this.handleException(c)}finally{this._flushLock=void 0,l&&this._debouncedFlush()}}}_maybeSaveSession(){this.session&&this._options.stickySession&&Dg(this.session)}__init6(){this._onMutationHandler=e=>{const n=e.length,r=this._options.mutationLimit,s=this._options.mutationBreadcrumbLimit,i=r&&n>r;if(n>s||i){const o=$r({category:"replay.mutations",data:{count:n,limit:i}});this._createCustomBreadcrumb(o)}return i?(this.stop({reason:"mutationLimit",forceFlush:this.recordingMode==="session"}),!1):!0}}}function Aa(t,e){return[...t,...e].join(",")}function WN({mask:t,unmask:e,block:n,unblock:r,ignore:s}){const i=['base[href="/"]'],o=Aa(t,[".sentry-mask","[data-sentry-mask]"]),a=Aa(e,[]);return{maskTextSelector:o,unmaskTextSelector:a,blockSelector:Aa(n,[".sentry-block","[data-sentry-block]",...i]),unblockSelector:Aa(r,[]),ignoreSelector:Aa(s,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'])}}function VN({el:t,key:e,maskAttributes:n,maskAllText:r,privacyOptions:s,value:i}){return!r||s.unmaskTextSelector&&t.matches(s.unmaskTextSelector)?i:n.includes(e)||e==="value"&&t.tagName==="INPUT"&&["submit","button"].includes(t.getAttribute("type")||"")?i.replace(/[\S]/g,"*"):i}const ky='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',GN=["content-length","content-type","accept"];let xy=!1;const XN=t=>new yf(t);class yf{static __initStatic(){this.id="Replay"}constructor({flushMinDelay:e=x3,flushMaxDelay:n=I3,minReplayDuration:r=A3,maxReplayDuration:s=iy,stickySession:i=!0,useCompression:o=!0,workerUrl:a,_experiments:l={},maskAllText:c=!0,maskAllInputs:d=!0,blockAllMedia:u=!0,mutationBreadcrumbLimit:f=750,mutationLimit:h=1e4,slowClickTimeout:p=7e3,slowClickIgnoreSelectors:m=[],networkDetailAllowUrls:_=[],networkDetailDenyUrls:g=[],networkCaptureBodies:y=!0,networkRequestHeaders:w=[],networkResponseHeaders:v=[],mask:x=[],maskAttributes:C=["title","placeholder"],unmask:E=[],block:A=[],unblock:V=[],ignore:D=[],maskFn:$,beforeAddRecordingEvent:j,beforeErrorSampling:Z,onError:ae}={}){this.name=yf.id;const ce=WN({mask:x,unmask:E,block:A,unblock:V,ignore:D});if(this._recordingOptions={maskAllInputs:d,maskAllText:c,maskInputOptions:{password:!0},maskTextFn:$,maskInputFn:$,maskAttributeFn:(J,K,F)=>VN({maskAttributes:C,maskAllText:c,privacyOptions:ce,key:J,value:K,el:F}),...ce,slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0,errorHandler:J=>{try{J.__rrweb__=!0}catch{}}},this._initialOptions={flushMinDelay:e,flushMaxDelay:n,minReplayDuration:Math.min(r,D3),maxReplayDuration:Math.min(s,iy),stickySession:i,useCompression:o,workerUrl:a,blockAllMedia:u,maskAllInputs:d,maskAllText:c,mutationBreadcrumbLimit:f,mutationLimit:h,slowClickTimeout:p,slowClickIgnoreSelectors:m,networkDetailAllowUrls:_,networkDetailDenyUrls:g,networkCaptureBodies:y,networkRequestHeaders:Iy(w),networkResponseHeaders:Iy(v),beforeAddRecordingEvent:j,beforeErrorSampling:Z,onError:ae,_experiments:l},this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${ky}`:ky),this._isInitialized&&X1())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return xy}set _isInitialized(e){xy=e}afterAllSetup(e){!X1()||this._replay||(this._setup(e),this._initialize(e))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:this._replay.recordingMode==="session"}):Promise.resolve()}flush(e){return this._replay?this._replay.isEnabled()?this._replay.sendBufferedReplayOrFlush(e):(this._replay.start(),Promise.resolve()):Promise.resolve()}getReplayId(){if(!(!this._replay||!this._replay.isEnabled()))return this._replay.getSessionId()}getRecordingMode(){if(!(!this._replay||!this._replay.isEnabled()))return this._replay.recordingMode}_initialize(e){this._replay&&(this._maybeLoadFromReplayCanvasIntegration(e),this._replay.initializeSampling())}_setup(e){const n=YN(this._initialOptions,e);this._replay=new Ms({options:n,recordingOptions:this._recordingOptions})}_maybeLoadFromReplayCanvasIntegration(e){try{const n=e.getIntegrationByName("ReplayCanvas");if(!n)return;this._replay._canvas=n.getOptions()}catch{}}}yf.__initStatic();function YN(t,e){const n=e.getOptions(),r={sessionSampleRate:0,errorSampleRate:0,...kt(t)},s=td(n.replaysSessionSampleRate),i=td(n.replaysOnErrorSampleRate);return s==null&&i==null&&wa(()=>{console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set.")}),s!=null&&(r.sessionSampleRate=s),i!=null&&(r.errorSampleRate=i),r}function Iy(t){return[...GN,...t.map(e=>e.toLowerCase())]}const by=new WeakMap,rh=new Map,Du={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,trackFetchStreamPerformance:!1};function qN(t,e){const{traceFetch:n,traceXHR:r,trackFetchStreamPerformance:s,shouldCreateSpanForRequest:i,enableHTTPTimings:o,tracePropagationTargets:a}={traceFetch:Du.traceFetch,traceXHR:Du.traceXHR,trackFetchStreamPerformance:Du.trackFetchStreamPerformance,...e},l=typeof i=="function"?i:u=>!0,c=u=>ZN(u,a),d={};n&&(t.addEventProcessor(u=>(u.type==="transaction"&&u.spans&&u.spans.forEach(f=>{if(f.op==="http.client"){const h=rh.get(f.span_id);h&&(f.timestamp=h/1e3,rh.delete(f.span_id))}}),u)),s&&q6(u=>{if(u.response){const f=by.get(u.response);f&&u.endTimestamp&&rh.set(f,u.endTimestamp)}}),n_(u=>{const f=W6(u,l,c,d);if(u.response&&u.fetchData.__span&&by.set(u.response,u.fetchData.__span),f){const h=pC(u.fetchData.url),p=h?Di(h).host:void 0;f.setAttributes({"http.url":h,"server.address":p})}o&&f&&Ty(f)})),r&&__(u=>{const f=eA(u,l,c,d);o&&f&&Ty(f)})}function KN(t){return t.entryType==="resource"&&"initiatorType"in t&&typeof t.nextHopProtocol=="string"&&(t.initiatorType==="fetch"||t.initiatorType==="xmlhttprequest")}function Ty(t){const{url:e}=Ae(t).data||{};if(!e||typeof e!="string")return;const n=Ko("resource",({entries:r})=>{r.forEach(s=>{KN(s)&&s.name.endsWith(e)&&(QN(s).forEach(o=>t.setAttribute(...o)),setTimeout(n))})})}function JN(t){let e="unknown",n="unknown",r="";for(const s of t){if(s==="/"){[e,n]=t.split("/");break}if(!isNaN(Number(s))){e=r==="h"?"http":r,n=t.split(r)[1];break}r+=s}return r===t&&(e=r),{name:e,version:n}}function Rr(t=0){return((dn||performance.timeOrigin)+t)/1e3}function QN(t){const{name:e,version:n}=JN(t.nextHopProtocol),r=[];return r.push(["network.protocol.version",n],["network.protocol.name",e]),dn?[...r,["http.request.redirect_start",Rr(t.redirectStart)],["http.request.fetch_start",Rr(t.fetchStart)],["http.request.domain_lookup_start",Rr(t.domainLookupStart)],["http.request.domain_lookup_end",Rr(t.domainLookupEnd)],["http.request.connect_start",Rr(t.connectStart)],["http.request.secure_connection_start",Rr(t.secureConnectionStart)],["http.request.connection_end",Rr(t.connectEnd)],["http.request.request_start",Rr(t.requestStart)],["http.request.response_start",Rr(t.responseStart)],["http.request.response_end",Rr(t.responseEnd)]]:r}function ZN(t,e){const n=ge.location&&ge.location.href;if(n){let r,s;try{r=new URL(t,n),s=new URL(n).origin}catch{return!1}const i=r.origin===s;return e?Bs(r.toString(),e)||i&&Bs(r.pathname,e):i}else{const r=!!t.match(/^\/(?!\/)/);return e?Bs(t,e):r}}function eA(t,e,n,r){const s=t.xhr,i=s&&s[Ei];if(!s||s.__sentry_own_request__||!i)return;const o=ds()&&e(i.url);if(t.endTimestamp&&o){const f=s.__sentry_xhr_span_id__;if(!f)return;const h=r[f];h&&i.status_code!==void 0&&(_v(h,i.status_code),h.end(),delete r[f]);return}const a=pC(i.url),l=a?Di(a).host:void 0,c=!!Gt(),d=o&&c?fc({name:`${i.method} ${i.url}`,attributes:{type:"xhr","http.method":i.method,"http.url":a,url:i.url,"server.address":l,[Dt]:"auto.http.browser",[Hi]:"http.client"}}):new _a;s.__sentry_xhr_span_id__=d.spanContext().spanId,r[s.__sentry_xhr_span_id__]=d;const u=Re();return s.setRequestHeader&&n(i.url)&&u&&tA(s,u,ds()&&c?d:void 0),d}function tA(t,e,n){const r=Ke(),s=dr(),{traceId:i,spanId:o,sampled:a,dsc:l}={...s.getPropagationContext(),...r.getPropagationContext()},c=n&&ds()?Iv(n):hg(i,o,a),d=Ev(l||(n?ui(n):lf(i,e)));nA(t,c,d)}function nA(t,e,n){try{t.setRequestHeader("sentry-trace",e),n&&t.setRequestHeader(uo,n)}catch{}}function pC(t){try{return new URL(t,ge.location.origin).href}catch{return}}function rA(){ge&&ge.document?ge.document.addEventListener("visibilitychange",()=>{const t=Gt();if(!t)return;const e=zt(t);if(ge.document.hidden&&e){const n="cancelled",{op:r,status:s}=Ae(e);Ir&&Y.log(`[Tracing] Transaction: ${n} -> since tab moved to the background, op: ${r}`),s||e.setStatus({code:Tt,message:n}),e.setAttribute("sentry.cancellation_reason","document.hidden"),e.end()}}):Ir&&Y.warn("[Tracing] Could not set up background tab detection due to lack of global document")}const sA="BrowserTracing",iA={...Ru,instrumentNavigation:!0,instrumentPageLoad:!0,markBackgroundSpan:!0,enableLongTask:!0,enableLongAnimationFrame:!0,enableInp:!0,_experiments:{},...Du},oA=(t={})=>{q2();const{enableInp:e,enableLongTask:n,enableLongAnimationFrame:r,_experiments:{enableInteractions:s,enableStandaloneClsSpans:i},beforeStartSpan:o,idleTimeout:a,finalTimeout:l,childSpanTimeout:c,markBackgroundSpan:d,traceFetch:u,traceXHR:f,trackFetchStreamPerformance:h,shouldCreateSpanForRequest:p,enableHTTPTimings:m,instrumentPageLoad:_,instrumentNavigation:g}={...iA,...t},y=ZT({recordClsStandaloneSpans:i||!1});e&&ER(),r&&De.PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("long-animation-frame")?tR():n&&eR(),s&&nR();const w={name:void 0,source:void 0};function v(x,C){const E=C.op==="pageload",A=o?o(C):C,V=A.attributes||{};C.name!==A.name&&(V[Pr]="custom",A.attributes=V),w.name=A.name,w.source=V[Pr];const D=$v(A,{idleTimeout:a,finalTimeout:l,childSpanTimeout:c,disableAutoFinish:E,beforeSpanEnd:j=>{y(),aR(j,{recordClsOnPageloadSpan:!i})}});function $(){["interactive","complete"].includes(ge.document.readyState)&&x.emit("idleSpanEnableAutoFinish",D)}return E&&ge.document&&(ge.document.addEventListener("readystatechange",()=>{$()}),$()),D}return{name:sA,afterAllSetup(x){let C,E=ge.location&&ge.location.href;x.on("startNavigationSpan",A=>{Re()===x&&(C&&!Ae(C).timestamp&&(Ir&&Y.log(`[Tracing] Finishing current root span with op: ${Ae(C).op}`),C.end()),C=v(x,{op:"navigation",...A}))}),x.on("startPageLoadSpan",(A,V={})=>{if(Re()!==x)return;C&&!Ae(C).timestamp&&(Ir&&Y.log(`[Tracing] Finishing current root span with op: ${Ae(C).op}`),C.end());const D=V.sentryTrace||Ry("sentry-trace"),$=V.baggage||Ry("baggage"),j=j2(D,$);Ke().setPropagationContext(j),C=v(x,{op:"pageload",...A})}),x.on("spanEnd",A=>{const V=Ae(A).op;if(A!==zt(A)||V!=="navigation"&&V!=="pageload")return;const D=Ke(),$=D.getPropagationContext();D.setPropagationContext({...$,sampled:$.sampled!==void 0?$.sampled:Ji(A),dsc:$.dsc||ui(A)})}),ge.location&&(_&&aA(x,{name:ge.location.pathname,startTime:dn?dn/1e3:void 0,attributes:{[Pr]:"url",[Dt]:"auto.pageload.browser"}}),g&&uf(({to:A,from:V})=>{if(V===void 0&&E&&E.indexOf(A)!==-1){E=void 0;return}V!==A&&(E=void 0,lA(x,{name:ge.location.pathname,attributes:{[Pr]:"url",[Dt]:"auto.navigation.browser"}}))})),d&&rA(),s&&cA(a,l,c,w),e&&xR(),qN(x,{traceFetch:u,traceXHR:f,trackFetchStreamPerformance:h,tracePropagationTargets:x.getOptions().tracePropagationTargets,shouldCreateSpanForRequest:p,enableHTTPTimings:m})}}};function aA(t,e,n){t.emit("startPageLoadSpan",e,n),Ke().setTransactionName(e.name);const r=Gt();return(r&&Ae(r).op)==="pageload"?r:void 0}function lA(t,e){dr().setPropagationContext(Zu()),Ke().setPropagationContext(Zu()),t.emit("startNavigationSpan",e),Ke().setTransactionName(e.name);const n=Gt();return(n&&Ae(n).op)==="navigation"?n:void 0}function Ry(t){const e=g2(`meta[name=${t}]`);return e?e.getAttribute("content"):void 0}function cA(t,e,n,r){let s;const i=()=>{const o="ui.action.click",a=Gt(),l=a&&zt(a);if(l){const c=Ae(l).op;if(["navigation","pageload"].includes(c)){Ir&&Y.warn(`[Tracing] Did not create ${o} span because a pageload or navigation span is in progress.`);return}}if(s&&(s.setAttribute(tp,"interactionInterrupted"),s.end(),s=void 0),!r.name){Ir&&Y.warn(`[Tracing] Did not create ${o} transaction because _latestRouteName is missing.`);return}s=$v({name:r.name,op:o,attributes:{[Pr]:r.source||"url"}},{idleTimeout:t,finalTimeout:e,childSpanTimeout:n})};ge.document&&addEventListener("click",i,{once:!1,capture:!0})}function uA(t){const e={...t};return Kv(e,"react"),zv("react",{version:T.version}),v3(e)}var mC={exports:{}},jn={},gC={exports:{}},yC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,q){var ne=F.length;F.push(q);e:for(;0<ne;){var oe=ne-1>>>1,Te=F[oe];if(0<s(Te,q))F[oe]=q,F[ne]=Te,ne=oe;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var q=F[0],ne=F.pop();if(ne!==q){F[0]=ne;e:for(var oe=0,Te=F.length,yt=Te>>>1;oe<yt;){var $e=2*(oe+1)-1,Ot=F[$e],Je=$e+1,mn=F[Je];if(0>s(Ot,ne))Je<Te&&0>s(mn,Ot)?(F[oe]=mn,F[Je]=ne,oe=Je):(F[oe]=Ot,F[$e]=ne,oe=$e);else if(Je<Te&&0>s(mn,ne))F[oe]=mn,F[Je]=ne,oe=Je;else break e}}return q}function s(F,q){var ne=F.sortIndex-q.sortIndex;return ne!==0?ne:F.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,u=null,f=3,h=!1,p=!1,m=!1,_=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(F){for(var q=n(c);q!==null;){if(q.callback===null)r(c);else if(q.startTime<=F)r(c),q.sortIndex=q.expirationTime,e(l,q);else break;q=n(c)}}function v(F){if(m=!1,w(F),!p)if(n(l)!==null)p=!0,J(x);else{var q=n(c);q!==null&&K(v,q.startTime-F)}}function x(F,q){p=!1,m&&(m=!1,g(A),A=-1),h=!0;var ne=f;try{for(w(q),u=n(l);u!==null&&(!(u.expirationTime>q)||F&&!$());){var oe=u.callback;if(typeof oe=="function"){u.callback=null,f=u.priorityLevel;var Te=oe(u.expirationTime<=q);q=t.unstable_now(),typeof Te=="function"?u.callback=Te:u===n(l)&&r(l),w(q)}else r(l);u=n(l)}if(u!==null)var yt=!0;else{var $e=n(c);$e!==null&&K(v,$e.startTime-q),yt=!1}return yt}finally{u=null,f=ne,h=!1}}var C=!1,E=null,A=-1,V=5,D=-1;function $(){return!(t.unstable_now()-D<V)}function j(){if(E!==null){var F=t.unstable_now();D=F;var q=!0;try{q=E(!0,F)}finally{q?Z():(C=!1,E=null)}}else C=!1}var Z;if(typeof y=="function")Z=function(){y(j)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,ce=ae.port2;ae.port1.onmessage=j,Z=function(){ce.postMessage(null)}}else Z=function(){_(j,0)};function J(F){E=F,C||(C=!0,Z())}function K(F,q){A=_(function(){F(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,J(x))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(f){case 1:case 2:case 3:var q=3;break;default:q=f}var ne=f;f=q;try{return F()}finally{f=ne}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,q){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var ne=f;f=F;try{return q()}finally{f=ne}},t.unstable_scheduleCallback=function(F,q,ne){var oe=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?oe+ne:oe):ne=oe,F){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=ne+Te,F={id:d++,callback:q,priorityLevel:F,startTime:ne,expirationTime:Te,sortIndex:-1},ne>oe?(F.sortIndex=ne,e(c,F),n(l)===null&&F===n(c)&&(m?(g(A),A=-1):m=!0,K(v,ne-oe))):(F.sortIndex=Te,e(l,F),p||h||(p=!0,J(x))),F},t.unstable_shouldYield=$,t.unstable_wrapCallback=function(F){var q=f;return function(){var ne=f;f=q;try{return F.apply(this,arguments)}finally{f=ne}}}})(yC);gC.exports=yC;var dA=gC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fA=T,Bn=dA;function G(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wC=new Set,xl={};function eo(t,e){ta(t,e),ta(t+"Capture",e)}function ta(t,e){for(xl[t]=e,t=0;t<e.length;t++)wC.add(e[t])}var hs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tp=Object.prototype.hasOwnProperty,hA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,My={},Ny={};function pA(t){return Tp.call(Ny,t)?!0:Tp.call(My,t)?!1:hA.test(t)?Ny[t]=!0:(My[t]=!0,!1)}function mA(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function gA(t,e,n,r){if(e===null||typeof e>"u"||mA(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function hn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vt[t]=new hn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vt[e]=new hn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vt[t]=new hn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vt[t]=new hn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vt[t]=new hn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vt[t]=new hn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vt[t]=new hn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vt[t]=new hn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vt[t]=new hn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Pg=/[\-:]([a-z])/g;function $g(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Pg,$g);Vt[e]=new hn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Pg,$g);Vt[e]=new hn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Pg,$g);Vt[e]=new hn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vt[t]=new hn(t,1,!1,t.toLowerCase(),null,!1,!1)});Vt.xlinkHref=new hn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vt[t]=new hn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ug(t,e,n,r){var s=Vt.hasOwnProperty(e)?Vt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(gA(e,n,s,r)&&(n=null),r||s===null?pA(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ws=fA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Jc=Symbol.for("react.element"),vo=Symbol.for("react.portal"),_o=Symbol.for("react.fragment"),Bg=Symbol.for("react.strict_mode"),Rp=Symbol.for("react.profiler"),SC=Symbol.for("react.provider"),vC=Symbol.for("react.context"),Hg=Symbol.for("react.forward_ref"),Mp=Symbol.for("react.suspense"),Np=Symbol.for("react.suspense_list"),zg=Symbol.for("react.memo"),Ns=Symbol.for("react.lazy"),_C=Symbol.for("react.offscreen"),Ay=Symbol.iterator;function Da(t){return t===null||typeof t!="object"?null:(t=Ay&&t[Ay]||t["@@iterator"],typeof t=="function"?t:null)}var lt=Object.assign,sh;function Ga(t){if(sh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);sh=e&&e[1]||""}return`
`+sh+t}var ih=!1;function oh(t,e){if(!t||ih)return"";ih=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{ih=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ga(t):""}function yA(t){switch(t.tag){case 5:return Ga(t.type);case 16:return Ga("Lazy");case 13:return Ga("Suspense");case 19:return Ga("SuspenseList");case 0:case 2:case 15:return t=oh(t.type,!1),t;case 11:return t=oh(t.type.render,!1),t;case 1:return t=oh(t.type,!0),t;default:return""}}function Ap(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case _o:return"Fragment";case vo:return"Portal";case Rp:return"Profiler";case Bg:return"StrictMode";case Mp:return"Suspense";case Np:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case vC:return(t.displayName||"Context")+".Consumer";case SC:return(t._context.displayName||"Context")+".Provider";case Hg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case zg:return e=t.displayName||null,e!==null?e:Ap(t.type)||"Memo";case Ns:e=t._payload,t=t._init;try{return Ap(t(e))}catch{}}return null}function wA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ap(e);case 8:return e===Bg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ei(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function CC(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function SA(t){var e=CC(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Qc(t){t._valueTracker||(t._valueTracker=SA(t))}function EC(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=CC(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function pd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Dp(t,e){var n=e.checked;return lt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Dy(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ei(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function kC(t,e){e=e.checked,e!=null&&Ug(t,"checked",e,!1)}function Op(t,e){kC(t,e);var n=ei(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Lp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Lp(t,e.type,ei(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Oy(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Lp(t,e,n){(e!=="number"||pd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Xa=Array.isArray;function Fo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ei(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Fp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(G(91));return lt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ly(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(G(92));if(Xa(n)){if(1<n.length)throw Error(G(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ei(n)}}function xC(t,e){var n=ei(e.value),r=ei(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Fy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function IC(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?IC(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Zc,bC=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Zc=Zc||document.createElement("div"),Zc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Zc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Il(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var nl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vA=["Webkit","ms","Moz","O"];Object.keys(nl).forEach(function(t){vA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),nl[e]=nl[t]})});function TC(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||nl.hasOwnProperty(t)&&nl[t]?(""+e).trim():e+"px"}function RC(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=TC(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var _A=lt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $p(t,e){if(e){if(_A[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(G(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(G(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(G(61))}if(e.style!=null&&typeof e.style!="object")throw Error(G(62))}}function Up(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bp=null;function jg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hp=null,Po=null,$o=null;function Py(t){if(t=Cc(t)){if(typeof Hp!="function")throw Error(G(280));var e=t.stateNode;e&&(e=Cf(e),Hp(t.stateNode,t.type,e))}}function MC(t){Po?$o?$o.push(t):$o=[t]:Po=t}function NC(){if(Po){var t=Po,e=$o;if($o=Po=null,Py(t),e)for(t=0;t<e.length;t++)Py(e[t])}}function AC(t,e){return t(e)}function DC(){}var ah=!1;function OC(t,e,n){if(ah)return t(e,n);ah=!0;try{return AC(t,e,n)}finally{ah=!1,(Po!==null||$o!==null)&&(DC(),NC())}}function bl(t,e){var n=t.stateNode;if(n===null)return null;var r=Cf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(G(231,e,typeof n));return n}var zp=!1;if(hs)try{var Oa={};Object.defineProperty(Oa,"passive",{get:function(){zp=!0}}),window.addEventListener("test",Oa,Oa),window.removeEventListener("test",Oa,Oa)}catch{zp=!1}function CA(t,e,n,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var rl=!1,md=null,gd=!1,jp=null,EA={onError:function(t){rl=!0,md=t}};function kA(t,e,n,r,s,i,o,a,l){rl=!1,md=null,CA.apply(EA,arguments)}function xA(t,e,n,r,s,i,o,a,l){if(kA.apply(this,arguments),rl){if(rl){var c=md;rl=!1,md=null}else throw Error(G(198));gd||(gd=!0,jp=c)}}function to(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function LC(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function $y(t){if(to(t)!==t)throw Error(G(188))}function IA(t){var e=t.alternate;if(!e){if(e=to(t),e===null)throw Error(G(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return $y(s),t;if(i===r)return $y(s),e;i=i.sibling}throw Error(G(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(G(189))}}if(n.alternate!==r)throw Error(G(190))}if(n.tag!==3)throw Error(G(188));return n.stateNode.current===n?t:e}function FC(t){return t=IA(t),t!==null?PC(t):null}function PC(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=PC(t);if(e!==null)return e;t=t.sibling}return null}var $C=Bn.unstable_scheduleCallback,Uy=Bn.unstable_cancelCallback,bA=Bn.unstable_shouldYield,TA=Bn.unstable_requestPaint,pt=Bn.unstable_now,RA=Bn.unstable_getCurrentPriorityLevel,Wg=Bn.unstable_ImmediatePriority,UC=Bn.unstable_UserBlockingPriority,yd=Bn.unstable_NormalPriority,MA=Bn.unstable_LowPriority,BC=Bn.unstable_IdlePriority,wf=null,Br=null;function NA(t){if(Br&&typeof Br.onCommitFiberRoot=="function")try{Br.onCommitFiberRoot(wf,t,void 0,(t.current.flags&128)===128)}catch{}}var Cr=Math.clz32?Math.clz32:OA,AA=Math.log,DA=Math.LN2;function OA(t){return t>>>=0,t===0?32:31-(AA(t)/DA|0)|0}var eu=64,tu=4194304;function Ya(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function wd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Ya(a):(i&=o,i!==0&&(r=Ya(i)))}else o=n&~s,o!==0?r=Ya(o):i!==0&&(r=Ya(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Cr(e),s=1<<n,r|=t[n],e&=~s;return r}function LA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function FA(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Cr(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=LA(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Wp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function HC(){var t=eu;return eu<<=1,!(eu&4194240)&&(eu=64),t}function lh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function vc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Cr(e),t[e]=n}function PA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Cr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Vg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Cr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var je=0;function zC(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var jC,Gg,WC,VC,GC,Vp=!1,nu=[],zs=null,js=null,Ws=null,Tl=new Map,Rl=new Map,Ls=[],$A="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function By(t,e){switch(t){case"focusin":case"focusout":zs=null;break;case"dragenter":case"dragleave":js=null;break;case"mouseover":case"mouseout":Ws=null;break;case"pointerover":case"pointerout":Tl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rl.delete(e.pointerId)}}function La(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Cc(e),e!==null&&Gg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function UA(t,e,n,r,s){switch(e){case"focusin":return zs=La(zs,t,e,n,r,s),!0;case"dragenter":return js=La(js,t,e,n,r,s),!0;case"mouseover":return Ws=La(Ws,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Tl.set(i,La(Tl.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Rl.set(i,La(Rl.get(i)||null,t,e,n,r,s)),!0}return!1}function XC(t){var e=xi(t.target);if(e!==null){var n=to(e);if(n!==null){if(e=n.tag,e===13){if(e=LC(n),e!==null){t.blockedOn=e,GC(t.priority,function(){WC(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ou(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Gp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Bp=r,n.target.dispatchEvent(r),Bp=null}else return e=Cc(n),e!==null&&Gg(e),t.blockedOn=n,!1;e.shift()}return!0}function Hy(t,e,n){Ou(t)&&n.delete(e)}function BA(){Vp=!1,zs!==null&&Ou(zs)&&(zs=null),js!==null&&Ou(js)&&(js=null),Ws!==null&&Ou(Ws)&&(Ws=null),Tl.forEach(Hy),Rl.forEach(Hy)}function Fa(t,e){t.blockedOn===e&&(t.blockedOn=null,Vp||(Vp=!0,Bn.unstable_scheduleCallback(Bn.unstable_NormalPriority,BA)))}function Ml(t){function e(s){return Fa(s,t)}if(0<nu.length){Fa(nu[0],t);for(var n=1;n<nu.length;n++){var r=nu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(zs!==null&&Fa(zs,t),js!==null&&Fa(js,t),Ws!==null&&Fa(Ws,t),Tl.forEach(e),Rl.forEach(e),n=0;n<Ls.length;n++)r=Ls[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ls.length&&(n=Ls[0],n.blockedOn===null);)XC(n),n.blockedOn===null&&Ls.shift()}var Uo=ws.ReactCurrentBatchConfig,Sd=!0;function HA(t,e,n,r){var s=je,i=Uo.transition;Uo.transition=null;try{je=1,Xg(t,e,n,r)}finally{je=s,Uo.transition=i}}function zA(t,e,n,r){var s=je,i=Uo.transition;Uo.transition=null;try{je=4,Xg(t,e,n,r)}finally{je=s,Uo.transition=i}}function Xg(t,e,n,r){if(Sd){var s=Gp(t,e,n,r);if(s===null)wh(t,e,r,vd,n),By(t,r);else if(UA(s,t,e,n,r))r.stopPropagation();else if(By(t,r),e&4&&-1<$A.indexOf(t)){for(;s!==null;){var i=Cc(s);if(i!==null&&jC(i),i=Gp(t,e,n,r),i===null&&wh(t,e,r,vd,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else wh(t,e,r,null,n)}}var vd=null;function Gp(t,e,n,r){if(vd=null,t=jg(r),t=xi(t),t!==null)if(e=to(t),e===null)t=null;else if(n=e.tag,n===13){if(t=LC(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return vd=t,null}function YC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RA()){case Wg:return 1;case UC:return 4;case yd:case MA:return 16;case BC:return 536870912;default:return 16}default:return 16}}var Ps=null,Yg=null,Lu=null;function qC(){if(Lu)return Lu;var t,e=Yg,n=e.length,r,s="value"in Ps?Ps.value:Ps.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Lu=s.slice(t,1<r?1-r:void 0)}function Fu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ru(){return!0}function zy(){return!1}function Wn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ru:zy,this.isPropagationStopped=zy,this}return lt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ru)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ru)},persist:function(){},isPersistent:ru}),e}var xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qg=Wn(xa),_c=lt({},xa,{view:0,detail:0}),jA=Wn(_c),ch,uh,Pa,Sf=lt({},_c,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Pa&&(Pa&&t.type==="mousemove"?(ch=t.screenX-Pa.screenX,uh=t.screenY-Pa.screenY):uh=ch=0,Pa=t),ch)},movementY:function(t){return"movementY"in t?t.movementY:uh}}),jy=Wn(Sf),WA=lt({},Sf,{dataTransfer:0}),VA=Wn(WA),GA=lt({},_c,{relatedTarget:0}),dh=Wn(GA),XA=lt({},xa,{animationName:0,elapsedTime:0,pseudoElement:0}),YA=Wn(XA),qA=lt({},xa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),KA=Wn(qA),JA=lt({},xa,{data:0}),Wy=Wn(JA),QA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ZA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tD(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=eD[t])?!!e[t]:!1}function Kg(){return tD}var nD=lt({},_c,{key:function(t){if(t.key){var e=QA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Fu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ZA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kg,charCode:function(t){return t.type==="keypress"?Fu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Fu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),rD=Wn(nD),sD=lt({},Sf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vy=Wn(sD),iD=lt({},_c,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kg}),oD=Wn(iD),aD=lt({},xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),lD=Wn(aD),cD=lt({},Sf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),uD=Wn(cD),dD=[9,13,27,32],Jg=hs&&"CompositionEvent"in window,sl=null;hs&&"documentMode"in document&&(sl=document.documentMode);var fD=hs&&"TextEvent"in window&&!sl,KC=hs&&(!Jg||sl&&8<sl&&11>=sl),Gy=" ",Xy=!1;function JC(t,e){switch(t){case"keyup":return dD.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function QC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Co=!1;function hD(t,e){switch(t){case"compositionend":return QC(e);case"keypress":return e.which!==32?null:(Xy=!0,Gy);case"textInput":return t=e.data,t===Gy&&Xy?null:t;default:return null}}function pD(t,e){if(Co)return t==="compositionend"||!Jg&&JC(t,e)?(t=qC(),Lu=Yg=Ps=null,Co=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return KC&&e.locale!=="ko"?null:e.data;default:return null}}var mD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!mD[t.type]:e==="textarea"}function ZC(t,e,n,r){MC(r),e=_d(e,"onChange"),0<e.length&&(n=new qg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var il=null,Nl=null;function gD(t){uE(t,0)}function vf(t){var e=xo(t);if(EC(e))return t}function yD(t,e){if(t==="change")return e}var eE=!1;if(hs){var fh;if(hs){var hh="oninput"in document;if(!hh){var qy=document.createElement("div");qy.setAttribute("oninput","return;"),hh=typeof qy.oninput=="function"}fh=hh}else fh=!1;eE=fh&&(!document.documentMode||9<document.documentMode)}function Ky(){il&&(il.detachEvent("onpropertychange",tE),Nl=il=null)}function tE(t){if(t.propertyName==="value"&&vf(Nl)){var e=[];ZC(e,Nl,t,jg(t)),OC(gD,e)}}function wD(t,e,n){t==="focusin"?(Ky(),il=e,Nl=n,il.attachEvent("onpropertychange",tE)):t==="focusout"&&Ky()}function SD(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return vf(Nl)}function vD(t,e){if(t==="click")return vf(e)}function _D(t,e){if(t==="input"||t==="change")return vf(e)}function CD(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var br=typeof Object.is=="function"?Object.is:CD;function Al(t,e){if(br(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Tp.call(e,s)||!br(t[s],e[s]))return!1}return!0}function Jy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Qy(t,e){var n=Jy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Jy(n)}}function nE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?nE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function rE(){for(var t=window,e=pd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=pd(t.document)}return e}function Qg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function ED(t){var e=rE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&nE(n.ownerDocument.documentElement,n)){if(r!==null&&Qg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Qy(n,i);var o=Qy(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var kD=hs&&"documentMode"in document&&11>=document.documentMode,Eo=null,Xp=null,ol=null,Yp=!1;function Zy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Yp||Eo==null||Eo!==pd(r)||(r=Eo,"selectionStart"in r&&Qg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ol&&Al(ol,r)||(ol=r,r=_d(Xp,"onSelect"),0<r.length&&(e=new qg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Eo)))}function su(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ko={animationend:su("Animation","AnimationEnd"),animationiteration:su("Animation","AnimationIteration"),animationstart:su("Animation","AnimationStart"),transitionend:su("Transition","TransitionEnd")},ph={},sE={};hs&&(sE=document.createElement("div").style,"AnimationEvent"in window||(delete ko.animationend.animation,delete ko.animationiteration.animation,delete ko.animationstart.animation),"TransitionEvent"in window||delete ko.transitionend.transition);function _f(t){if(ph[t])return ph[t];if(!ko[t])return t;var e=ko[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in sE)return ph[t]=e[n];return t}var iE=_f("animationend"),oE=_f("animationiteration"),aE=_f("animationstart"),lE=_f("transitionend"),cE=new Map,ew="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function di(t,e){cE.set(t,e),eo(e,[t])}for(var mh=0;mh<ew.length;mh++){var gh=ew[mh],xD=gh.toLowerCase(),ID=gh[0].toUpperCase()+gh.slice(1);di(xD,"on"+ID)}di(iE,"onAnimationEnd");di(oE,"onAnimationIteration");di(aE,"onAnimationStart");di("dblclick","onDoubleClick");di("focusin","onFocus");di("focusout","onBlur");di(lE,"onTransitionEnd");ta("onMouseEnter",["mouseout","mouseover"]);ta("onMouseLeave",["mouseout","mouseover"]);ta("onPointerEnter",["pointerout","pointerover"]);ta("onPointerLeave",["pointerout","pointerover"]);eo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));eo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));eo("onBeforeInput",["compositionend","keypress","textInput","paste"]);eo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bD=new Set("cancel close invalid load scroll toggle".split(" ").concat(qa));function tw(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,xA(r,e,void 0,t),t.currentTarget=null}function uE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;tw(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;tw(s,a,c),i=l}}}if(gd)throw t=jp,gd=!1,jp=null,t}function Qe(t,e){var n=e[Zp];n===void 0&&(n=e[Zp]=new Set);var r=t+"__bubble";n.has(r)||(dE(e,t,2,!1),n.add(r))}function yh(t,e,n){var r=0;e&&(r|=4),dE(n,t,r,e)}var iu="_reactListening"+Math.random().toString(36).slice(2);function Dl(t){if(!t[iu]){t[iu]=!0,wC.forEach(function(n){n!=="selectionchange"&&(bD.has(n)||yh(n,!1,t),yh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[iu]||(e[iu]=!0,yh("selectionchange",!1,e))}}function dE(t,e,n,r){switch(YC(e)){case 1:var s=HA;break;case 4:s=zA;break;default:s=Xg}n=s.bind(null,e,n,t),s=void 0,!zp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function wh(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=xi(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}OC(function(){var c=i,d=jg(n),u=[];e:{var f=cE.get(t);if(f!==void 0){var h=qg,p=t;switch(t){case"keypress":if(Fu(n)===0)break e;case"keydown":case"keyup":h=rD;break;case"focusin":p="focus",h=dh;break;case"focusout":p="blur",h=dh;break;case"beforeblur":case"afterblur":h=dh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=jy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=VA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=oD;break;case iE:case oE:case aE:h=YA;break;case lE:h=lD;break;case"scroll":h=jA;break;case"wheel":h=uD;break;case"copy":case"cut":case"paste":h=KA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Vy}var m=(e&4)!==0,_=!m&&t==="scroll",g=m?f!==null?f+"Capture":null:f;m=[];for(var y=c,w;y!==null;){w=y;var v=w.stateNode;if(w.tag===5&&v!==null&&(w=v,g!==null&&(v=bl(y,g),v!=null&&m.push(Ol(y,v,w)))),_)break;y=y.return}0<m.length&&(f=new h(f,p,null,n,d),u.push({event:f,listeners:m}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Bp&&(p=n.relatedTarget||n.fromElement)&&(xi(p)||p[ps]))break e;if((h||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=c,p=p?xi(p):null,p!==null&&(_=to(p),p!==_||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=c),h!==p)){if(m=jy,v="onMouseLeave",g="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=Vy,v="onPointerLeave",g="onPointerEnter",y="pointer"),_=h==null?f:xo(h),w=p==null?f:xo(p),f=new m(v,y+"leave",h,n,d),f.target=_,f.relatedTarget=w,v=null,xi(d)===c&&(m=new m(g,y+"enter",p,n,d),m.target=w,m.relatedTarget=_,v=m),_=v,h&&p)t:{for(m=h,g=p,y=0,w=m;w;w=ao(w))y++;for(w=0,v=g;v;v=ao(v))w++;for(;0<y-w;)m=ao(m),y--;for(;0<w-y;)g=ao(g),w--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=ao(m),g=ao(g)}m=null}else m=null;h!==null&&nw(u,f,h,m,!1),p!==null&&_!==null&&nw(u,_,p,m,!0)}}e:{if(f=c?xo(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var x=yD;else if(Yy(f))if(eE)x=_D;else{x=SD;var C=wD}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(x=vD);if(x&&(x=x(t,c))){ZC(u,x,n,d);break e}C&&C(t,f,c),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Lp(f,"number",f.value)}switch(C=c?xo(c):window,t){case"focusin":(Yy(C)||C.contentEditable==="true")&&(Eo=C,Xp=c,ol=null);break;case"focusout":ol=Xp=Eo=null;break;case"mousedown":Yp=!0;break;case"contextmenu":case"mouseup":case"dragend":Yp=!1,Zy(u,n,d);break;case"selectionchange":if(kD)break;case"keydown":case"keyup":Zy(u,n,d)}var E;if(Jg)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Co?JC(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(KC&&n.locale!=="ko"&&(Co||A!=="onCompositionStart"?A==="onCompositionEnd"&&Co&&(E=qC()):(Ps=d,Yg="value"in Ps?Ps.value:Ps.textContent,Co=!0)),C=_d(c,A),0<C.length&&(A=new Wy(A,t,null,n,d),u.push({event:A,listeners:C}),E?A.data=E:(E=QC(n),E!==null&&(A.data=E)))),(E=fD?hD(t,n):pD(t,n))&&(c=_d(c,"onBeforeInput"),0<c.length&&(d=new Wy("onBeforeInput","beforeinput",null,n,d),u.push({event:d,listeners:c}),d.data=E))}uE(u,e)})}function Ol(t,e,n){return{instance:t,listener:e,currentTarget:n}}function _d(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=bl(t,n),i!=null&&r.unshift(Ol(t,i,s)),i=bl(t,e),i!=null&&r.push(Ol(t,i,s))),t=t.return}return r}function ao(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function nw(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=bl(n,i),l!=null&&o.unshift(Ol(n,l,a))):s||(l=bl(n,i),l!=null&&o.push(Ol(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var TD=/\r\n?/g,RD=/\u0000|\uFFFD/g;function rw(t){return(typeof t=="string"?t:""+t).replace(TD,`
`).replace(RD,"")}function ou(t,e,n){if(e=rw(e),rw(t)!==e&&n)throw Error(G(425))}function Cd(){}var qp=null,Kp=null;function Jp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Qp=typeof setTimeout=="function"?setTimeout:void 0,MD=typeof clearTimeout=="function"?clearTimeout:void 0,sw=typeof Promise=="function"?Promise:void 0,ND=typeof queueMicrotask=="function"?queueMicrotask:typeof sw<"u"?function(t){return sw.resolve(null).then(t).catch(AD)}:Qp;function AD(t){setTimeout(function(){throw t})}function Sh(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ml(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ml(e)}function Vs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function iw(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ia=Math.random().toString(36).slice(2),Fr="__reactFiber$"+Ia,Ll="__reactProps$"+Ia,ps="__reactContainer$"+Ia,Zp="__reactEvents$"+Ia,DD="__reactListeners$"+Ia,OD="__reactHandles$"+Ia;function xi(t){var e=t[Fr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ps]||n[Fr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=iw(t);t!==null;){if(n=t[Fr])return n;t=iw(t)}return e}t=n,n=t.parentNode}return null}function Cc(t){return t=t[Fr]||t[ps],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function xo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(G(33))}function Cf(t){return t[Ll]||null}var em=[],Io=-1;function fi(t){return{current:t}}function et(t){0>Io||(t.current=em[Io],em[Io]=null,Io--)}function qe(t,e){Io++,em[Io]=t.current,t.current=e}var ti={},tn=fi(ti),kn=fi(!1),zi=ti;function na(t,e){var n=t.type.contextTypes;if(!n)return ti;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function xn(t){return t=t.childContextTypes,t!=null}function Ed(){et(kn),et(tn)}function ow(t,e,n){if(tn.current!==ti)throw Error(G(168));qe(tn,e),qe(kn,n)}function fE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(G(108,wA(t)||"Unknown",s));return lt({},n,r)}function kd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ti,zi=tn.current,qe(tn,t),qe(kn,kn.current),!0}function aw(t,e,n){var r=t.stateNode;if(!r)throw Error(G(169));n?(t=fE(t,e,zi),r.__reactInternalMemoizedMergedChildContext=t,et(kn),et(tn),qe(tn,t)):et(kn),qe(kn,n)}var Qr=null,Ef=!1,vh=!1;function hE(t){Qr===null?Qr=[t]:Qr.push(t)}function LD(t){Ef=!0,hE(t)}function hi(){if(!vh&&Qr!==null){vh=!0;var t=0,e=je;try{var n=Qr;for(je=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Qr=null,Ef=!1}catch(s){throw Qr!==null&&(Qr=Qr.slice(t+1)),$C(Wg,hi),s}finally{je=e,vh=!1}}return null}var bo=[],To=0,xd=null,Id=0,Jn=[],Qn=0,ji=null,ts=1,ns="";function yi(t,e){bo[To++]=Id,bo[To++]=xd,xd=t,Id=e}function pE(t,e,n){Jn[Qn++]=ts,Jn[Qn++]=ns,Jn[Qn++]=ji,ji=t;var r=ts;t=ns;var s=32-Cr(r)-1;r&=~(1<<s),n+=1;var i=32-Cr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ts=1<<32-Cr(e)+s|n<<s|r,ns=i+t}else ts=1<<i|n<<s|r,ns=t}function Zg(t){t.return!==null&&(yi(t,1),pE(t,1,0))}function e0(t){for(;t===xd;)xd=bo[--To],bo[To]=null,Id=bo[--To],bo[To]=null;for(;t===ji;)ji=Jn[--Qn],Jn[Qn]=null,ns=Jn[--Qn],Jn[Qn]=null,ts=Jn[--Qn],Jn[Qn]=null}var $n=null,Fn=null,nt=!1,wr=null;function mE(t,e){var n=nr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function lw(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,$n=t,Fn=Vs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,$n=t,Fn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ji!==null?{id:ts,overflow:ns}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=nr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,$n=t,Fn=null,!0):!1;default:return!1}}function tm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function nm(t){if(nt){var e=Fn;if(e){var n=e;if(!lw(t,e)){if(tm(t))throw Error(G(418));e=Vs(n.nextSibling);var r=$n;e&&lw(t,e)?mE(r,n):(t.flags=t.flags&-4097|2,nt=!1,$n=t)}}else{if(tm(t))throw Error(G(418));t.flags=t.flags&-4097|2,nt=!1,$n=t}}}function cw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;$n=t}function au(t){if(t!==$n)return!1;if(!nt)return cw(t),nt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Jp(t.type,t.memoizedProps)),e&&(e=Fn)){if(tm(t))throw gE(),Error(G(418));for(;e;)mE(t,e),e=Vs(e.nextSibling)}if(cw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Fn=Vs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Fn=null}}else Fn=$n?Vs(t.stateNode.nextSibling):null;return!0}function gE(){for(var t=Fn;t;)t=Vs(t.nextSibling)}function ra(){Fn=$n=null,nt=!1}function t0(t){wr===null?wr=[t]:wr.push(t)}var FD=ws.ReactCurrentBatchConfig;function $a(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(G(309));var r=n.stateNode}if(!r)throw Error(G(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(G(284));if(!n._owner)throw Error(G(290,t))}return t}function lu(t,e){throw t=Object.prototype.toString.call(e),Error(G(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function uw(t){var e=t._init;return e(t._payload)}function yE(t){function e(g,y){if(t){var w=g.deletions;w===null?(g.deletions=[y],g.flags|=16):w.push(y)}}function n(g,y){if(!t)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function r(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function s(g,y){return g=qs(g,y),g.index=0,g.sibling=null,g}function i(g,y,w){return g.index=w,t?(w=g.alternate,w!==null?(w=w.index,w<y?(g.flags|=2,y):w):(g.flags|=2,y)):(g.flags|=1048576,y)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,y,w,v){return y===null||y.tag!==6?(y=bh(w,g.mode,v),y.return=g,y):(y=s(y,w),y.return=g,y)}function l(g,y,w,v){var x=w.type;return x===_o?d(g,y,w.props.children,v,w.key):y!==null&&(y.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Ns&&uw(x)===y.type)?(v=s(y,w.props),v.ref=$a(g,y,w),v.return=g,v):(v=ju(w.type,w.key,w.props,null,g.mode,v),v.ref=$a(g,y,w),v.return=g,v)}function c(g,y,w,v){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=Th(w,g.mode,v),y.return=g,y):(y=s(y,w.children||[]),y.return=g,y)}function d(g,y,w,v,x){return y===null||y.tag!==7?(y=Li(w,g.mode,v,x),y.return=g,y):(y=s(y,w),y.return=g,y)}function u(g,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=bh(""+y,g.mode,w),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Jc:return w=ju(y.type,y.key,y.props,null,g.mode,w),w.ref=$a(g,null,y),w.return=g,w;case vo:return y=Th(y,g.mode,w),y.return=g,y;case Ns:var v=y._init;return u(g,v(y._payload),w)}if(Xa(y)||Da(y))return y=Li(y,g.mode,w,null),y.return=g,y;lu(g,y)}return null}function f(g,y,w,v){var x=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return x!==null?null:a(g,y,""+w,v);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Jc:return w.key===x?l(g,y,w,v):null;case vo:return w.key===x?c(g,y,w,v):null;case Ns:return x=w._init,f(g,y,x(w._payload),v)}if(Xa(w)||Da(w))return x!==null?null:d(g,y,w,v,null);lu(g,w)}return null}function h(g,y,w,v,x){if(typeof v=="string"&&v!==""||typeof v=="number")return g=g.get(w)||null,a(y,g,""+v,x);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Jc:return g=g.get(v.key===null?w:v.key)||null,l(y,g,v,x);case vo:return g=g.get(v.key===null?w:v.key)||null,c(y,g,v,x);case Ns:var C=v._init;return h(g,y,w,C(v._payload),x)}if(Xa(v)||Da(v))return g=g.get(w)||null,d(y,g,v,x,null);lu(y,v)}return null}function p(g,y,w,v){for(var x=null,C=null,E=y,A=y=0,V=null;E!==null&&A<w.length;A++){E.index>A?(V=E,E=null):V=E.sibling;var D=f(g,E,w[A],v);if(D===null){E===null&&(E=V);break}t&&E&&D.alternate===null&&e(g,E),y=i(D,y,A),C===null?x=D:C.sibling=D,C=D,E=V}if(A===w.length)return n(g,E),nt&&yi(g,A),x;if(E===null){for(;A<w.length;A++)E=u(g,w[A],v),E!==null&&(y=i(E,y,A),C===null?x=E:C.sibling=E,C=E);return nt&&yi(g,A),x}for(E=r(g,E);A<w.length;A++)V=h(E,g,A,w[A],v),V!==null&&(t&&V.alternate!==null&&E.delete(V.key===null?A:V.key),y=i(V,y,A),C===null?x=V:C.sibling=V,C=V);return t&&E.forEach(function($){return e(g,$)}),nt&&yi(g,A),x}function m(g,y,w,v){var x=Da(w);if(typeof x!="function")throw Error(G(150));if(w=x.call(w),w==null)throw Error(G(151));for(var C=x=null,E=y,A=y=0,V=null,D=w.next();E!==null&&!D.done;A++,D=w.next()){E.index>A?(V=E,E=null):V=E.sibling;var $=f(g,E,D.value,v);if($===null){E===null&&(E=V);break}t&&E&&$.alternate===null&&e(g,E),y=i($,y,A),C===null?x=$:C.sibling=$,C=$,E=V}if(D.done)return n(g,E),nt&&yi(g,A),x;if(E===null){for(;!D.done;A++,D=w.next())D=u(g,D.value,v),D!==null&&(y=i(D,y,A),C===null?x=D:C.sibling=D,C=D);return nt&&yi(g,A),x}for(E=r(g,E);!D.done;A++,D=w.next())D=h(E,g,A,D.value,v),D!==null&&(t&&D.alternate!==null&&E.delete(D.key===null?A:D.key),y=i(D,y,A),C===null?x=D:C.sibling=D,C=D);return t&&E.forEach(function(j){return e(g,j)}),nt&&yi(g,A),x}function _(g,y,w,v){if(typeof w=="object"&&w!==null&&w.type===_o&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Jc:e:{for(var x=w.key,C=y;C!==null;){if(C.key===x){if(x=w.type,x===_o){if(C.tag===7){n(g,C.sibling),y=s(C,w.props.children),y.return=g,g=y;break e}}else if(C.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Ns&&uw(x)===C.type){n(g,C.sibling),y=s(C,w.props),y.ref=$a(g,C,w),y.return=g,g=y;break e}n(g,C);break}else e(g,C);C=C.sibling}w.type===_o?(y=Li(w.props.children,g.mode,v,w.key),y.return=g,g=y):(v=ju(w.type,w.key,w.props,null,g.mode,v),v.ref=$a(g,y,w),v.return=g,g=v)}return o(g);case vo:e:{for(C=w.key;y!==null;){if(y.key===C)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){n(g,y.sibling),y=s(y,w.children||[]),y.return=g,g=y;break e}else{n(g,y);break}else e(g,y);y=y.sibling}y=Th(w,g.mode,v),y.return=g,g=y}return o(g);case Ns:return C=w._init,_(g,y,C(w._payload),v)}if(Xa(w))return p(g,y,w,v);if(Da(w))return m(g,y,w,v);lu(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(n(g,y.sibling),y=s(y,w),y.return=g,g=y):(n(g,y),y=bh(w,g.mode,v),y.return=g,g=y),o(g)):n(g,y)}return _}var sa=yE(!0),wE=yE(!1),bd=fi(null),Td=null,Ro=null,n0=null;function r0(){n0=Ro=Td=null}function s0(t){var e=bd.current;et(bd),t._currentValue=e}function rm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Bo(t,e){Td=t,n0=Ro=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(En=!0),t.firstContext=null)}function cr(t){var e=t._currentValue;if(n0!==t)if(t={context:t,memoizedValue:e,next:null},Ro===null){if(Td===null)throw Error(G(308));Ro=t,Td.dependencies={lanes:0,firstContext:t}}else Ro=Ro.next=t;return e}var Ii=null;function i0(t){Ii===null?Ii=[t]:Ii.push(t)}function SE(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,i0(e)):(n.next=s.next,s.next=n),e.interleaved=n,ms(t,r)}function ms(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var As=!1;function o0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function is(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Gs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ze&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,ms(t,n)}return s=r.interleaved,s===null?(e.next=e,i0(r)):(e.next=s.next,s.next=e),r.interleaved=e,ms(t,n)}function Pu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Vg(t,n)}}function dw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Rd(t,e,n,r){var s=t.updateQueue;As=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(i!==null){var u=s.baseState;o=0,d=c=l=null,a=i;do{var f=a.lane,h=a.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(f=e,h=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){u=p.call(h,u,f);break e}u=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(h,u,f):p,f==null)break e;u=lt({},u,f);break e;case 2:As=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=h,l=u):d=d.next=h,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(l=u),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Vi|=o,t.lanes=o,t.memoizedState=u}}function fw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(G(191,s));s.call(r)}}}var Ec={},Hr=fi(Ec),Fl=fi(Ec),Pl=fi(Ec);function bi(t){if(t===Ec)throw Error(G(174));return t}function a0(t,e){switch(qe(Pl,e),qe(Fl,t),qe(Hr,Ec),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Pp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Pp(e,t)}et(Hr),qe(Hr,e)}function ia(){et(Hr),et(Fl),et(Pl)}function _E(t){bi(Pl.current);var e=bi(Hr.current),n=Pp(e,t.type);e!==n&&(qe(Fl,t),qe(Hr,n))}function l0(t){Fl.current===t&&(et(Hr),et(Fl))}var ot=fi(0);function Md(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var _h=[];function c0(){for(var t=0;t<_h.length;t++)_h[t]._workInProgressVersionPrimary=null;_h.length=0}var $u=ws.ReactCurrentDispatcher,Ch=ws.ReactCurrentBatchConfig,Wi=0,at=null,_t=null,Nt=null,Nd=!1,al=!1,$l=0,PD=0;function Xt(){throw Error(G(321))}function u0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!br(t[n],e[n]))return!1;return!0}function d0(t,e,n,r,s,i){if(Wi=i,at=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$u.current=t===null||t.memoizedState===null?HD:zD,t=n(r,s),al){i=0;do{if(al=!1,$l=0,25<=i)throw Error(G(301));i+=1,Nt=_t=null,e.updateQueue=null,$u.current=jD,t=n(r,s)}while(al)}if($u.current=Ad,e=_t!==null&&_t.next!==null,Wi=0,Nt=_t=at=null,Nd=!1,e)throw Error(G(300));return t}function f0(){var t=$l!==0;return $l=0,t}function Dr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?at.memoizedState=Nt=t:Nt=Nt.next=t,Nt}function ur(){if(_t===null){var t=at.alternate;t=t!==null?t.memoizedState:null}else t=_t.next;var e=Nt===null?at.memoizedState:Nt.next;if(e!==null)Nt=e,_t=t;else{if(t===null)throw Error(G(310));_t=t,t={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},Nt===null?at.memoizedState=Nt=t:Nt=Nt.next=t}return Nt}function Ul(t,e){return typeof e=="function"?e(t):e}function Eh(t){var e=ur(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=_t,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var d=c.lane;if((Wi&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var u={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=u,o=r):l=l.next=u,at.lanes|=d,Vi|=d}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,br(r,e.memoizedState)||(En=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,at.lanes|=i,Vi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function kh(t){var e=ur(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);br(i,e.memoizedState)||(En=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function CE(){}function EE(t,e){var n=at,r=ur(),s=e(),i=!br(r.memoizedState,s);if(i&&(r.memoizedState=s,En=!0),r=r.queue,h0(IE.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Nt!==null&&Nt.memoizedState.tag&1){if(n.flags|=2048,Bl(9,xE.bind(null,n,r,s,e),void 0,null),At===null)throw Error(G(349));Wi&30||kE(n,e,s)}return s}function kE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=at.updateQueue,e===null?(e={lastEffect:null,stores:null},at.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function xE(t,e,n,r){e.value=n,e.getSnapshot=r,bE(e)&&TE(t)}function IE(t,e,n){return n(function(){bE(e)&&TE(t)})}function bE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!br(t,n)}catch{return!0}}function TE(t){var e=ms(t,1);e!==null&&Er(e,t,1,-1)}function hw(t){var e=Dr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ul,lastRenderedState:t},e.queue=t,t=t.dispatch=BD.bind(null,at,t),[e.memoizedState,t]}function Bl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=at.updateQueue,e===null?(e={lastEffect:null,stores:null},at.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function RE(){return ur().memoizedState}function Uu(t,e,n,r){var s=Dr();at.flags|=t,s.memoizedState=Bl(1|e,n,void 0,r===void 0?null:r)}function kf(t,e,n,r){var s=ur();r=r===void 0?null:r;var i=void 0;if(_t!==null){var o=_t.memoizedState;if(i=o.destroy,r!==null&&u0(r,o.deps)){s.memoizedState=Bl(e,n,i,r);return}}at.flags|=t,s.memoizedState=Bl(1|e,n,i,r)}function pw(t,e){return Uu(8390656,8,t,e)}function h0(t,e){return kf(2048,8,t,e)}function ME(t,e){return kf(4,2,t,e)}function NE(t,e){return kf(4,4,t,e)}function AE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function DE(t,e,n){return n=n!=null?n.concat([t]):null,kf(4,4,AE.bind(null,e,t),n)}function p0(){}function OE(t,e){var n=ur();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&u0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function LE(t,e){var n=ur();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&u0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function FE(t,e,n){return Wi&21?(br(n,e)||(n=HC(),at.lanes|=n,Vi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,En=!0),t.memoizedState=n)}function $D(t,e){var n=je;je=n!==0&&4>n?n:4,t(!0);var r=Ch.transition;Ch.transition={};try{t(!1),e()}finally{je=n,Ch.transition=r}}function PE(){return ur().memoizedState}function UD(t,e,n){var r=Ys(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},$E(t))UE(e,n);else if(n=SE(t,e,n,r),n!==null){var s=un();Er(n,t,r,s),BE(n,e,r)}}function BD(t,e,n){var r=Ys(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if($E(t))UE(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,br(a,o)){var l=e.interleaved;l===null?(s.next=s,i0(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=SE(t,e,s,r),n!==null&&(s=un(),Er(n,t,r,s),BE(n,e,r))}}function $E(t){var e=t.alternate;return t===at||e!==null&&e===at}function UE(t,e){al=Nd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function BE(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Vg(t,n)}}var Ad={readContext:cr,useCallback:Xt,useContext:Xt,useEffect:Xt,useImperativeHandle:Xt,useInsertionEffect:Xt,useLayoutEffect:Xt,useMemo:Xt,useReducer:Xt,useRef:Xt,useState:Xt,useDebugValue:Xt,useDeferredValue:Xt,useTransition:Xt,useMutableSource:Xt,useSyncExternalStore:Xt,useId:Xt,unstable_isNewReconciler:!1},HD={readContext:cr,useCallback:function(t,e){return Dr().memoizedState=[t,e===void 0?null:e],t},useContext:cr,useEffect:pw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Uu(4194308,4,AE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Uu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Uu(4,2,t,e)},useMemo:function(t,e){var n=Dr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Dr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=UD.bind(null,at,t),[r.memoizedState,t]},useRef:function(t){var e=Dr();return t={current:t},e.memoizedState=t},useState:hw,useDebugValue:p0,useDeferredValue:function(t){return Dr().memoizedState=t},useTransition:function(){var t=hw(!1),e=t[0];return t=$D.bind(null,t[1]),Dr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=at,s=Dr();if(nt){if(n===void 0)throw Error(G(407));n=n()}else{if(n=e(),At===null)throw Error(G(349));Wi&30||kE(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,pw(IE.bind(null,r,i,t),[t]),r.flags|=2048,Bl(9,xE.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Dr(),e=At.identifierPrefix;if(nt){var n=ns,r=ts;n=(r&~(1<<32-Cr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=$l++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=PD++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},zD={readContext:cr,useCallback:OE,useContext:cr,useEffect:h0,useImperativeHandle:DE,useInsertionEffect:ME,useLayoutEffect:NE,useMemo:LE,useReducer:Eh,useRef:RE,useState:function(){return Eh(Ul)},useDebugValue:p0,useDeferredValue:function(t){var e=ur();return FE(e,_t.memoizedState,t)},useTransition:function(){var t=Eh(Ul)[0],e=ur().memoizedState;return[t,e]},useMutableSource:CE,useSyncExternalStore:EE,useId:PE,unstable_isNewReconciler:!1},jD={readContext:cr,useCallback:OE,useContext:cr,useEffect:h0,useImperativeHandle:DE,useInsertionEffect:ME,useLayoutEffect:NE,useMemo:LE,useReducer:kh,useRef:RE,useState:function(){return kh(Ul)},useDebugValue:p0,useDeferredValue:function(t){var e=ur();return _t===null?e.memoizedState=t:FE(e,_t.memoizedState,t)},useTransition:function(){var t=kh(Ul)[0],e=ur().memoizedState;return[t,e]},useMutableSource:CE,useSyncExternalStore:EE,useId:PE,unstable_isNewReconciler:!1};function mr(t,e){if(t&&t.defaultProps){e=lt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function sm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:lt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var xf={isMounted:function(t){return(t=t._reactInternals)?to(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=un(),s=Ys(t),i=is(r,s);i.payload=e,n!=null&&(i.callback=n),e=Gs(t,i,s),e!==null&&(Er(e,t,s,r),Pu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=un(),s=Ys(t),i=is(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Gs(t,i,s),e!==null&&(Er(e,t,s,r),Pu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=un(),r=Ys(t),s=is(n,r);s.tag=2,e!=null&&(s.callback=e),e=Gs(t,s,r),e!==null&&(Er(e,t,r,n),Pu(e,t,r))}};function mw(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Al(n,r)||!Al(s,i):!0}function HE(t,e,n){var r=!1,s=ti,i=e.contextType;return typeof i=="object"&&i!==null?i=cr(i):(s=xn(e)?zi:tn.current,r=e.contextTypes,i=(r=r!=null)?na(t,s):ti),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=xf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function gw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&xf.enqueueReplaceState(e,e.state,null)}function im(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},o0(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=cr(i):(i=xn(e)?zi:tn.current,s.context=na(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(sm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&xf.enqueueReplaceState(s,s.state,null),Rd(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function oa(t,e){try{var n="",r=e;do n+=yA(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function xh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function om(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var WD=typeof WeakMap=="function"?WeakMap:Map;function zE(t,e,n){n=is(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Od||(Od=!0,gm=r),om(t,e)},n}function jE(t,e,n){n=is(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){om(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){om(t,e),typeof r!="function"&&(Xs===null?Xs=new Set([this]):Xs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function yw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new WD;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=sO.bind(null,t,e,n),e.then(t,t))}function ww(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Sw(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=is(-1,1),e.tag=2,Gs(n,e,1))),n.lanes|=1),t)}var VD=ws.ReactCurrentOwner,En=!1;function on(t,e,n,r){e.child=t===null?wE(e,null,n,r):sa(e,t.child,n,r)}function vw(t,e,n,r,s){n=n.render;var i=e.ref;return Bo(e,s),r=d0(t,e,n,r,i,s),n=f0(),t!==null&&!En?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,gs(t,e,s)):(nt&&n&&Zg(e),e.flags|=1,on(t,e,r,s),e.child)}function _w(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!C0(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,WE(t,e,i,r,s)):(t=ju(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Al,n(o,r)&&t.ref===e.ref)return gs(t,e,s)}return e.flags|=1,t=qs(i,r),t.ref=e.ref,t.return=e,e.child=t}function WE(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Al(i,r)&&t.ref===e.ref)if(En=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(En=!0);else return e.lanes=t.lanes,gs(t,e,s)}return am(t,e,n,r,s)}function VE(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},qe(No,Nn),Nn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,qe(No,Nn),Nn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,qe(No,Nn),Nn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,qe(No,Nn),Nn|=r;return on(t,e,s,n),e.child}function GE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function am(t,e,n,r,s){var i=xn(n)?zi:tn.current;return i=na(e,i),Bo(e,s),n=d0(t,e,n,r,i,s),r=f0(),t!==null&&!En?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,gs(t,e,s)):(nt&&r&&Zg(e),e.flags|=1,on(t,e,n,s),e.child)}function Cw(t,e,n,r,s){if(xn(n)){var i=!0;kd(e)}else i=!1;if(Bo(e,s),e.stateNode===null)Bu(t,e),HE(e,n,r),im(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=cr(c):(c=xn(n)?zi:tn.current,c=na(e,c));var d=n.getDerivedStateFromProps,u=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&gw(e,o,r,c),As=!1;var f=e.memoizedState;o.state=f,Rd(e,r,o,s),l=e.memoizedState,a!==r||f!==l||kn.current||As?(typeof d=="function"&&(sm(e,n,d,r),l=e.memoizedState),(a=As||mw(e,n,a,r,f,l,c))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,vE(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:mr(e.type,a),o.props=c,u=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=cr(l):(l=xn(n)?zi:tn.current,l=na(e,l));var h=n.getDerivedStateFromProps;(d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==u||f!==l)&&gw(e,o,r,l),As=!1,f=e.memoizedState,o.state=f,Rd(e,r,o,s);var p=e.memoizedState;a!==u||f!==p||kn.current||As?(typeof h=="function"&&(sm(e,n,h,r),p=e.memoizedState),(c=As||mw(e,n,c,r,f,p,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return lm(t,e,n,r,i,s)}function lm(t,e,n,r,s,i){GE(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&aw(e,n,!1),gs(t,e,i);r=e.stateNode,VD.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=sa(e,t.child,null,i),e.child=sa(e,null,a,i)):on(t,e,a,i),e.memoizedState=r.state,s&&aw(e,n,!0),e.child}function XE(t){var e=t.stateNode;e.pendingContext?ow(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ow(t,e.context,!1),a0(t,e.containerInfo)}function Ew(t,e,n,r,s){return ra(),t0(s),e.flags|=256,on(t,e,n,r),e.child}var cm={dehydrated:null,treeContext:null,retryLane:0};function um(t){return{baseLanes:t,cachePool:null,transitions:null}}function YE(t,e,n){var r=e.pendingProps,s=ot.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),qe(ot,s&1),t===null)return nm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Tf(o,r,0,null),t=Li(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=um(n),e.memoizedState=cm,t):m0(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return GD(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=qs(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=qs(a,i):(i=Li(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?um(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=cm,r}return i=t.child,t=i.sibling,r=qs(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function m0(t,e){return e=Tf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function cu(t,e,n,r){return r!==null&&t0(r),sa(e,t.child,null,n),t=m0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function GD(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=xh(Error(G(422))),cu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Tf({mode:"visible",children:r.children},s,0,null),i=Li(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&sa(e,t.child,null,o),e.child.memoizedState=um(o),e.memoizedState=cm,i);if(!(e.mode&1))return cu(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(G(419)),r=xh(i,r,void 0),cu(t,e,o,r)}if(a=(o&t.childLanes)!==0,En||a){if(r=At,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ms(t,s),Er(r,t,s,-1))}return _0(),r=xh(Error(G(421))),cu(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=iO.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Fn=Vs(s.nextSibling),$n=e,nt=!0,wr=null,t!==null&&(Jn[Qn++]=ts,Jn[Qn++]=ns,Jn[Qn++]=ji,ts=t.id,ns=t.overflow,ji=e),e=m0(e,r.children),e.flags|=4096,e)}function kw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),rm(t.return,e,n)}function Ih(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function qE(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(on(t,e,r.children,n),r=ot.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&kw(t,n,e);else if(t.tag===19)kw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(qe(ot,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Md(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Ih(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Md(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Ih(e,!0,n,null,i);break;case"together":Ih(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function gs(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Vi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(G(153));if(e.child!==null){for(t=e.child,n=qs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=qs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function XD(t,e,n){switch(e.tag){case 3:XE(e),ra();break;case 5:_E(e);break;case 1:xn(e.type)&&kd(e);break;case 4:a0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;qe(bd,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(qe(ot,ot.current&1),e.flags|=128,null):n&e.child.childLanes?YE(t,e,n):(qe(ot,ot.current&1),t=gs(t,e,n),t!==null?t.sibling:null);qe(ot,ot.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return qE(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),qe(ot,ot.current),r)break;return null;case 22:case 23:return e.lanes=0,VE(t,e,n)}return gs(t,e,n)}var KE,dm,JE,QE;KE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};dm=function(){};JE=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,bi(Hr.current);var i=null;switch(n){case"input":s=Dp(t,s),r=Dp(t,r),i=[];break;case"select":s=lt({},s,{value:void 0}),r=lt({},r,{value:void 0}),i=[];break;case"textarea":s=Fp(t,s),r=Fp(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Cd)}$p(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(xl.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(xl.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Qe("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};QE=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ua(t,e){if(!nt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Yt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function YD(t,e,n){var r=e.pendingProps;switch(e0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yt(e),null;case 1:return xn(e.type)&&Ed(),Yt(e),null;case 3:return r=e.stateNode,ia(),et(kn),et(tn),c0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(au(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,wr!==null&&(Sm(wr),wr=null))),dm(t,e),Yt(e),null;case 5:l0(e);var s=bi(Pl.current);if(n=e.type,t!==null&&e.stateNode!=null)JE(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(G(166));return Yt(e),null}if(t=bi(Hr.current),au(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Fr]=e,r[Ll]=i,t=(e.mode&1)!==0,n){case"dialog":Qe("cancel",r),Qe("close",r);break;case"iframe":case"object":case"embed":Qe("load",r);break;case"video":case"audio":for(s=0;s<qa.length;s++)Qe(qa[s],r);break;case"source":Qe("error",r);break;case"img":case"image":case"link":Qe("error",r),Qe("load",r);break;case"details":Qe("toggle",r);break;case"input":Dy(r,i),Qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Qe("invalid",r);break;case"textarea":Ly(r,i),Qe("invalid",r)}$p(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&ou(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&ou(r.textContent,a,t),s=["children",""+a]):xl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Qe("scroll",r)}switch(n){case"input":Qc(r),Oy(r,i,!0);break;case"textarea":Qc(r),Fy(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Cd)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=IC(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Fr]=e,t[Ll]=r,KE(t,e,!1,!1),e.stateNode=t;e:{switch(o=Up(n,r),n){case"dialog":Qe("cancel",t),Qe("close",t),s=r;break;case"iframe":case"object":case"embed":Qe("load",t),s=r;break;case"video":case"audio":for(s=0;s<qa.length;s++)Qe(qa[s],t);s=r;break;case"source":Qe("error",t),s=r;break;case"img":case"image":case"link":Qe("error",t),Qe("load",t),s=r;break;case"details":Qe("toggle",t),s=r;break;case"input":Dy(t,r),s=Dp(t,r),Qe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=lt({},r,{value:void 0}),Qe("invalid",t);break;case"textarea":Ly(t,r),s=Fp(t,r),Qe("invalid",t);break;default:s=r}$p(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?RC(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&bC(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Il(t,l):typeof l=="number"&&Il(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(xl.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Qe("scroll",t):l!=null&&Ug(t,i,l,o))}switch(n){case"input":Qc(t),Oy(t,r,!1);break;case"textarea":Qc(t),Fy(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ei(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Fo(t,!!r.multiple,i,!1):r.defaultValue!=null&&Fo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Cd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Yt(e),null;case 6:if(t&&e.stateNode!=null)QE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(G(166));if(n=bi(Pl.current),bi(Hr.current),au(e)){if(r=e.stateNode,n=e.memoizedProps,r[Fr]=e,(i=r.nodeValue!==n)&&(t=$n,t!==null))switch(t.tag){case 3:ou(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ou(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Fr]=e,e.stateNode=r}return Yt(e),null;case 13:if(et(ot),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(nt&&Fn!==null&&e.mode&1&&!(e.flags&128))gE(),ra(),e.flags|=98560,i=!1;else if(i=au(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(G(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(G(317));i[Fr]=e}else ra(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Yt(e),i=!1}else wr!==null&&(Sm(wr),wr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ot.current&1?xt===0&&(xt=3):_0())),e.updateQueue!==null&&(e.flags|=4),Yt(e),null);case 4:return ia(),dm(t,e),t===null&&Dl(e.stateNode.containerInfo),Yt(e),null;case 10:return s0(e.type._context),Yt(e),null;case 17:return xn(e.type)&&Ed(),Yt(e),null;case 19:if(et(ot),i=e.memoizedState,i===null)return Yt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Ua(i,!1);else{if(xt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Md(t),o!==null){for(e.flags|=128,Ua(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return qe(ot,ot.current&1|2),e.child}t=t.sibling}i.tail!==null&&pt()>aa&&(e.flags|=128,r=!0,Ua(i,!1),e.lanes=4194304)}else{if(!r)if(t=Md(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ua(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!nt)return Yt(e),null}else 2*pt()-i.renderingStartTime>aa&&n!==1073741824&&(e.flags|=128,r=!0,Ua(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=pt(),e.sibling=null,n=ot.current,qe(ot,r?n&1|2:n&1),e):(Yt(e),null);case 22:case 23:return v0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Nn&1073741824&&(Yt(e),e.subtreeFlags&6&&(e.flags|=8192)):Yt(e),null;case 24:return null;case 25:return null}throw Error(G(156,e.tag))}function qD(t,e){switch(e0(e),e.tag){case 1:return xn(e.type)&&Ed(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ia(),et(kn),et(tn),c0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return l0(e),null;case 13:if(et(ot),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(G(340));ra()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return et(ot),null;case 4:return ia(),null;case 10:return s0(e.type._context),null;case 22:case 23:return v0(),null;case 24:return null;default:return null}}var uu=!1,Jt=!1,KD=typeof WeakSet=="function"?WeakSet:Set,te=null;function Mo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ut(t,e,r)}else n.current=null}function fm(t,e,n){try{n()}catch(r){ut(t,e,r)}}var xw=!1;function JD(t,e){if(qp=Sd,t=rE(),Qg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,d=0,u=t,f=null;t:for(;;){for(var h;u!==n||s!==0&&u.nodeType!==3||(a=o+s),u!==i||r!==0&&u.nodeType!==3||(l=o+r),u.nodeType===3&&(o+=u.nodeValue.length),(h=u.firstChild)!==null;)f=u,u=h;for(;;){if(u===t)break t;if(f===n&&++c===s&&(a=o),f===i&&++d===r&&(l=o),(h=u.nextSibling)!==null)break;u=f,f=u.parentNode}u=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Kp={focusedElem:t,selectionRange:n},Sd=!1,te=e;te!==null;)if(e=te,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,te=t;else for(;te!==null;){e=te;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,_=p.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:mr(e.type,m),_);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(v){ut(e,e.return,v)}if(t=e.sibling,t!==null){t.return=e.return,te=t;break}te=e.return}return p=xw,xw=!1,p}function ll(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&fm(e,n,i)}s=s.next}while(s!==r)}}function If(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function hm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ZE(t){var e=t.alternate;e!==null&&(t.alternate=null,ZE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Fr],delete e[Ll],delete e[Zp],delete e[DD],delete e[OD])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ek(t){return t.tag===5||t.tag===3||t.tag===4}function Iw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ek(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function pm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Cd));else if(r!==4&&(t=t.child,t!==null))for(pm(t,e,n),t=t.sibling;t!==null;)pm(t,e,n),t=t.sibling}function mm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(mm(t,e,n),t=t.sibling;t!==null;)mm(t,e,n),t=t.sibling}var Ft=null,gr=!1;function _s(t,e,n){for(n=n.child;n!==null;)tk(t,e,n),n=n.sibling}function tk(t,e,n){if(Br&&typeof Br.onCommitFiberUnmount=="function")try{Br.onCommitFiberUnmount(wf,n)}catch{}switch(n.tag){case 5:Jt||Mo(n,e);case 6:var r=Ft,s=gr;Ft=null,_s(t,e,n),Ft=r,gr=s,Ft!==null&&(gr?(t=Ft,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ft.removeChild(n.stateNode));break;case 18:Ft!==null&&(gr?(t=Ft,n=n.stateNode,t.nodeType===8?Sh(t.parentNode,n):t.nodeType===1&&Sh(t,n),Ml(t)):Sh(Ft,n.stateNode));break;case 4:r=Ft,s=gr,Ft=n.stateNode.containerInfo,gr=!0,_s(t,e,n),Ft=r,gr=s;break;case 0:case 11:case 14:case 15:if(!Jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&fm(n,e,o),s=s.next}while(s!==r)}_s(t,e,n);break;case 1:if(!Jt&&(Mo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){ut(n,e,a)}_s(t,e,n);break;case 21:_s(t,e,n);break;case 22:n.mode&1?(Jt=(r=Jt)||n.memoizedState!==null,_s(t,e,n),Jt=r):_s(t,e,n);break;default:_s(t,e,n)}}function bw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new KD),e.forEach(function(r){var s=oO.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function fr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ft=a.stateNode,gr=!1;break e;case 3:Ft=a.stateNode.containerInfo,gr=!0;break e;case 4:Ft=a.stateNode.containerInfo,gr=!0;break e}a=a.return}if(Ft===null)throw Error(G(160));tk(i,o,s),Ft=null,gr=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){ut(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)nk(e,t),e=e.sibling}function nk(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(fr(e,t),Mr(t),r&4){try{ll(3,t,t.return),If(3,t)}catch(m){ut(t,t.return,m)}try{ll(5,t,t.return)}catch(m){ut(t,t.return,m)}}break;case 1:fr(e,t),Mr(t),r&512&&n!==null&&Mo(n,n.return);break;case 5:if(fr(e,t),Mr(t),r&512&&n!==null&&Mo(n,n.return),t.flags&32){var s=t.stateNode;try{Il(s,"")}catch(m){ut(t,t.return,m)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&kC(s,i),Up(a,o);var c=Up(a,i);for(o=0;o<l.length;o+=2){var d=l[o],u=l[o+1];d==="style"?RC(s,u):d==="dangerouslySetInnerHTML"?bC(s,u):d==="children"?Il(s,u):Ug(s,d,u,c)}switch(a){case"input":Op(s,i);break;case"textarea":xC(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?Fo(s,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?Fo(s,!!i.multiple,i.defaultValue,!0):Fo(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ll]=i}catch(m){ut(t,t.return,m)}}break;case 6:if(fr(e,t),Mr(t),r&4){if(t.stateNode===null)throw Error(G(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(m){ut(t,t.return,m)}}break;case 3:if(fr(e,t),Mr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ml(e.containerInfo)}catch(m){ut(t,t.return,m)}break;case 4:fr(e,t),Mr(t);break;case 13:fr(e,t),Mr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(w0=pt())),r&4&&bw(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Jt=(c=Jt)||d,fr(e,t),Jt=c):fr(e,t),Mr(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(te=t,d=t.child;d!==null;){for(u=te=d;te!==null;){switch(f=te,h=f.child,f.tag){case 0:case 11:case 14:case 15:ll(4,f,f.return);break;case 1:Mo(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){ut(r,n,m)}}break;case 5:Mo(f,f.return);break;case 22:if(f.memoizedState!==null){Rw(u);continue}}h!==null?(h.return=f,te=h):Rw(u)}d=d.sibling}e:for(d=null,u=t;;){if(u.tag===5){if(d===null){d=u;try{s=u.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=u.stateNode,l=u.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=TC("display",o))}catch(m){ut(t,t.return,m)}}}else if(u.tag===6){if(d===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(m){ut(t,t.return,m)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===t)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===t)break e;for(;u.sibling===null;){if(u.return===null||u.return===t)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:fr(e,t),Mr(t),r&4&&bw(t);break;case 21:break;default:fr(e,t),Mr(t)}}function Mr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(ek(n)){var r=n;break e}n=n.return}throw Error(G(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Il(s,""),r.flags&=-33);var i=Iw(t);mm(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Iw(t);pm(t,a,o);break;default:throw Error(G(161))}}catch(l){ut(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function QD(t,e,n){te=t,rk(t)}function rk(t,e,n){for(var r=(t.mode&1)!==0;te!==null;){var s=te,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||uu;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Jt;a=uu;var c=Jt;if(uu=o,(Jt=l)&&!c)for(te=s;te!==null;)o=te,l=o.child,o.tag===22&&o.memoizedState!==null?Mw(s):l!==null?(l.return=o,te=l):Mw(s);for(;i!==null;)te=i,rk(i),i=i.sibling;te=s,uu=a,Jt=c}Tw(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,te=i):Tw(t)}}function Tw(t){for(;te!==null;){var e=te;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Jt||If(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Jt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:mr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&fw(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}fw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var u=d.dehydrated;u!==null&&Ml(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}Jt||e.flags&512&&hm(e)}catch(f){ut(e,e.return,f)}}if(e===t){te=null;break}if(n=e.sibling,n!==null){n.return=e.return,te=n;break}te=e.return}}function Rw(t){for(;te!==null;){var e=te;if(e===t){te=null;break}var n=e.sibling;if(n!==null){n.return=e.return,te=n;break}te=e.return}}function Mw(t){for(;te!==null;){var e=te;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{If(4,e)}catch(l){ut(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){ut(e,s,l)}}var i=e.return;try{hm(e)}catch(l){ut(e,i,l)}break;case 5:var o=e.return;try{hm(e)}catch(l){ut(e,o,l)}}}catch(l){ut(e,e.return,l)}if(e===t){te=null;break}var a=e.sibling;if(a!==null){a.return=e.return,te=a;break}te=e.return}}var ZD=Math.ceil,Dd=ws.ReactCurrentDispatcher,g0=ws.ReactCurrentOwner,or=ws.ReactCurrentBatchConfig,ze=0,At=null,St=null,jt=0,Nn=0,No=fi(0),xt=0,Hl=null,Vi=0,bf=0,y0=0,cl=null,vn=null,w0=0,aa=1/0,Kr=null,Od=!1,gm=null,Xs=null,du=!1,$s=null,Ld=0,ul=0,ym=null,Hu=-1,zu=0;function un(){return ze&6?pt():Hu!==-1?Hu:Hu=pt()}function Ys(t){return t.mode&1?ze&2&&jt!==0?jt&-jt:FD.transition!==null?(zu===0&&(zu=HC()),zu):(t=je,t!==0||(t=window.event,t=t===void 0?16:YC(t.type)),t):1}function Er(t,e,n,r){if(50<ul)throw ul=0,ym=null,Error(G(185));vc(t,n,r),(!(ze&2)||t!==At)&&(t===At&&(!(ze&2)&&(bf|=n),xt===4&&Fs(t,jt)),In(t,r),n===1&&ze===0&&!(e.mode&1)&&(aa=pt()+500,Ef&&hi()))}function In(t,e){var n=t.callbackNode;FA(t,e);var r=wd(t,t===At?jt:0);if(r===0)n!==null&&Uy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Uy(n),e===1)t.tag===0?LD(Nw.bind(null,t)):hE(Nw.bind(null,t)),ND(function(){!(ze&6)&&hi()}),n=null;else{switch(zC(r)){case 1:n=Wg;break;case 4:n=UC;break;case 16:n=yd;break;case 536870912:n=BC;break;default:n=yd}n=dk(n,sk.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function sk(t,e){if(Hu=-1,zu=0,ze&6)throw Error(G(327));var n=t.callbackNode;if(Ho()&&t.callbackNode!==n)return null;var r=wd(t,t===At?jt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Fd(t,r);else{e=r;var s=ze;ze|=2;var i=ok();(At!==t||jt!==e)&&(Kr=null,aa=pt()+500,Oi(t,e));do try{nO();break}catch(a){ik(t,a)}while(!0);r0(),Dd.current=i,ze=s,St!==null?e=0:(At=null,jt=0,e=xt)}if(e!==0){if(e===2&&(s=Wp(t),s!==0&&(r=s,e=wm(t,s))),e===1)throw n=Hl,Oi(t,0),Fs(t,r),In(t,pt()),n;if(e===6)Fs(t,r);else{if(s=t.current.alternate,!(r&30)&&!eO(s)&&(e=Fd(t,r),e===2&&(i=Wp(t),i!==0&&(r=i,e=wm(t,i))),e===1))throw n=Hl,Oi(t,0),Fs(t,r),In(t,pt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(G(345));case 2:wi(t,vn,Kr);break;case 3:if(Fs(t,r),(r&130023424)===r&&(e=w0+500-pt(),10<e)){if(wd(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){un(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Qp(wi.bind(null,t,vn,Kr),e);break}wi(t,vn,Kr);break;case 4:if(Fs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Cr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=pt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ZD(r/1960))-r,10<r){t.timeoutHandle=Qp(wi.bind(null,t,vn,Kr),r);break}wi(t,vn,Kr);break;case 5:wi(t,vn,Kr);break;default:throw Error(G(329))}}}return In(t,pt()),t.callbackNode===n?sk.bind(null,t):null}function wm(t,e){var n=cl;return t.current.memoizedState.isDehydrated&&(Oi(t,e).flags|=256),t=Fd(t,e),t!==2&&(e=vn,vn=n,e!==null&&Sm(e)),t}function Sm(t){vn===null?vn=t:vn.push.apply(vn,t)}function eO(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!br(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Fs(t,e){for(e&=~y0,e&=~bf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Cr(e),r=1<<n;t[n]=-1,e&=~r}}function Nw(t){if(ze&6)throw Error(G(327));Ho();var e=wd(t,0);if(!(e&1))return In(t,pt()),null;var n=Fd(t,e);if(t.tag!==0&&n===2){var r=Wp(t);r!==0&&(e=r,n=wm(t,r))}if(n===1)throw n=Hl,Oi(t,0),Fs(t,e),In(t,pt()),n;if(n===6)throw Error(G(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,wi(t,vn,Kr),In(t,pt()),null}function S0(t,e){var n=ze;ze|=1;try{return t(e)}finally{ze=n,ze===0&&(aa=pt()+500,Ef&&hi())}}function Gi(t){$s!==null&&$s.tag===0&&!(ze&6)&&Ho();var e=ze;ze|=1;var n=or.transition,r=je;try{if(or.transition=null,je=1,t)return t()}finally{je=r,or.transition=n,ze=e,!(ze&6)&&hi()}}function v0(){Nn=No.current,et(No)}function Oi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,MD(n)),St!==null)for(n=St.return;n!==null;){var r=n;switch(e0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ed();break;case 3:ia(),et(kn),et(tn),c0();break;case 5:l0(r);break;case 4:ia();break;case 13:et(ot);break;case 19:et(ot);break;case 10:s0(r.type._context);break;case 22:case 23:v0()}n=n.return}if(At=t,St=t=qs(t.current,null),jt=Nn=e,xt=0,Hl=null,y0=bf=Vi=0,vn=cl=null,Ii!==null){for(e=0;e<Ii.length;e++)if(n=Ii[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Ii=null}return t}function ik(t,e){do{var n=St;try{if(r0(),$u.current=Ad,Nd){for(var r=at.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Nd=!1}if(Wi=0,Nt=_t=at=null,al=!1,$l=0,g0.current=null,n===null||n.return===null){xt=1,Hl=e,St=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=jt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=a,u=d.tag;if(!(d.mode&1)&&(u===0||u===11||u===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=ww(o);if(h!==null){h.flags&=-257,Sw(h,o,a,i,e),h.mode&1&&yw(i,c,e),e=h,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){yw(i,c,e),_0();break e}l=Error(G(426))}}else if(nt&&a.mode&1){var _=ww(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),Sw(_,o,a,i,e),t0(oa(l,a));break e}}i=l=oa(l,a),xt!==4&&(xt=2),cl===null?cl=[i]:cl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=zE(i,l,e);dw(i,g);break e;case 1:a=l;var y=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Xs===null||!Xs.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var v=jE(i,a,e);dw(i,v);break e}}i=i.return}while(i!==null)}lk(n)}catch(x){e=x,St===n&&n!==null&&(St=n=n.return);continue}break}while(!0)}function ok(){var t=Dd.current;return Dd.current=Ad,t===null?Ad:t}function _0(){(xt===0||xt===3||xt===2)&&(xt=4),At===null||!(Vi&268435455)&&!(bf&268435455)||Fs(At,jt)}function Fd(t,e){var n=ze;ze|=2;var r=ok();(At!==t||jt!==e)&&(Kr=null,Oi(t,e));do try{tO();break}catch(s){ik(t,s)}while(!0);if(r0(),ze=n,Dd.current=r,St!==null)throw Error(G(261));return At=null,jt=0,xt}function tO(){for(;St!==null;)ak(St)}function nO(){for(;St!==null&&!bA();)ak(St)}function ak(t){var e=uk(t.alternate,t,Nn);t.memoizedProps=t.pendingProps,e===null?lk(t):St=e,g0.current=null}function lk(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=qD(n,e),n!==null){n.flags&=32767,St=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{xt=6,St=null;return}}else if(n=YD(n,e,Nn),n!==null){St=n;return}if(e=e.sibling,e!==null){St=e;return}St=e=t}while(e!==null);xt===0&&(xt=5)}function wi(t,e,n){var r=je,s=or.transition;try{or.transition=null,je=1,rO(t,e,n,r)}finally{or.transition=s,je=r}return null}function rO(t,e,n,r){do Ho();while($s!==null);if(ze&6)throw Error(G(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(G(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(PA(t,i),t===At&&(St=At=null,jt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||du||(du=!0,dk(yd,function(){return Ho(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=or.transition,or.transition=null;var o=je;je=1;var a=ze;ze|=4,g0.current=null,JD(t,n),nk(n,t),ED(Kp),Sd=!!qp,Kp=qp=null,t.current=n,QD(n),TA(),ze=a,je=o,or.transition=i}else t.current=n;if(du&&(du=!1,$s=t,Ld=s),i=t.pendingLanes,i===0&&(Xs=null),NA(n.stateNode),In(t,pt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Od)throw Od=!1,t=gm,gm=null,t;return Ld&1&&t.tag!==0&&Ho(),i=t.pendingLanes,i&1?t===ym?ul++:(ul=0,ym=t):ul=0,hi(),null}function Ho(){if($s!==null){var t=zC(Ld),e=or.transition,n=je;try{if(or.transition=null,je=16>t?16:t,$s===null)var r=!1;else{if(t=$s,$s=null,Ld=0,ze&6)throw Error(G(331));var s=ze;for(ze|=4,te=t.current;te!==null;){var i=te,o=i.child;if(te.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(te=c;te!==null;){var d=te;switch(d.tag){case 0:case 11:case 15:ll(8,d,i)}var u=d.child;if(u!==null)u.return=d,te=u;else for(;te!==null;){d=te;var f=d.sibling,h=d.return;if(ZE(d),d===c){te=null;break}if(f!==null){f.return=h,te=f;break}te=h}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var _=m.sibling;m.sibling=null,m=_}while(m!==null)}}te=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,te=o;else e:for(;te!==null;){if(i=te,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ll(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,te=g;break e}te=i.return}}var y=t.current;for(te=y;te!==null;){o=te;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,te=w;else e:for(o=y;te!==null;){if(a=te,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:If(9,a)}}catch(x){ut(a,a.return,x)}if(a===o){te=null;break e}var v=a.sibling;if(v!==null){v.return=a.return,te=v;break e}te=a.return}}if(ze=s,hi(),Br&&typeof Br.onPostCommitFiberRoot=="function")try{Br.onPostCommitFiberRoot(wf,t)}catch{}r=!0}return r}finally{je=n,or.transition=e}}return!1}function Aw(t,e,n){e=oa(n,e),e=zE(t,e,1),t=Gs(t,e,1),e=un(),t!==null&&(vc(t,1,e),In(t,e))}function ut(t,e,n){if(t.tag===3)Aw(t,t,n);else for(;e!==null;){if(e.tag===3){Aw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Xs===null||!Xs.has(r))){t=oa(n,t),t=jE(e,t,1),e=Gs(e,t,1),t=un(),e!==null&&(vc(e,1,t),In(e,t));break}}e=e.return}}function sO(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=un(),t.pingedLanes|=t.suspendedLanes&n,At===t&&(jt&n)===n&&(xt===4||xt===3&&(jt&130023424)===jt&&500>pt()-w0?Oi(t,0):y0|=n),In(t,e)}function ck(t,e){e===0&&(t.mode&1?(e=tu,tu<<=1,!(tu&130023424)&&(tu=4194304)):e=1);var n=un();t=ms(t,e),t!==null&&(vc(t,e,n),In(t,n))}function iO(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),ck(t,n)}function oO(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(G(314))}r!==null&&r.delete(e),ck(t,n)}var uk;uk=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||kn.current)En=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return En=!1,XD(t,e,n);En=!!(t.flags&131072)}else En=!1,nt&&e.flags&1048576&&pE(e,Id,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Bu(t,e),t=e.pendingProps;var s=na(e,tn.current);Bo(e,n),s=d0(null,e,r,t,s,n);var i=f0();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,xn(r)?(i=!0,kd(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,o0(e),s.updater=xf,e.stateNode=s,s._reactInternals=e,im(e,r,t,n),e=lm(null,e,r,!0,i,n)):(e.tag=0,nt&&i&&Zg(e),on(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Bu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=lO(r),t=mr(r,t),s){case 0:e=am(null,e,r,t,n);break e;case 1:e=Cw(null,e,r,t,n);break e;case 11:e=vw(null,e,r,t,n);break e;case 14:e=_w(null,e,r,mr(r.type,t),n);break e}throw Error(G(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mr(r,s),am(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mr(r,s),Cw(t,e,r,s,n);case 3:e:{if(XE(e),t===null)throw Error(G(387));r=e.pendingProps,i=e.memoizedState,s=i.element,vE(t,e),Rd(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=oa(Error(G(423)),e),e=Ew(t,e,r,n,s);break e}else if(r!==s){s=oa(Error(G(424)),e),e=Ew(t,e,r,n,s);break e}else for(Fn=Vs(e.stateNode.containerInfo.firstChild),$n=e,nt=!0,wr=null,n=wE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ra(),r===s){e=gs(t,e,n);break e}on(t,e,r,n)}e=e.child}return e;case 5:return _E(e),t===null&&nm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Jp(r,s)?o=null:i!==null&&Jp(r,i)&&(e.flags|=32),GE(t,e),on(t,e,o,n),e.child;case 6:return t===null&&nm(e),null;case 13:return YE(t,e,n);case 4:return a0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=sa(e,null,r,n):on(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mr(r,s),vw(t,e,r,s,n);case 7:return on(t,e,e.pendingProps,n),e.child;case 8:return on(t,e,e.pendingProps.children,n),e.child;case 12:return on(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,qe(bd,r._currentValue),r._currentValue=o,i!==null)if(br(i.value,o)){if(i.children===s.children&&!kn.current){e=gs(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=is(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),rm(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(G(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),rm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}on(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Bo(e,n),s=cr(s),r=r(s),e.flags|=1,on(t,e,r,n),e.child;case 14:return r=e.type,s=mr(r,e.pendingProps),s=mr(r.type,s),_w(t,e,r,s,n);case 15:return WE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mr(r,s),Bu(t,e),e.tag=1,xn(r)?(t=!0,kd(e)):t=!1,Bo(e,n),HE(e,r,s),im(e,r,s,n),lm(null,e,r,!0,t,n);case 19:return qE(t,e,n);case 22:return VE(t,e,n)}throw Error(G(156,e.tag))};function dk(t,e){return $C(t,e)}function aO(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nr(t,e,n,r){return new aO(t,e,n,r)}function C0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function lO(t){if(typeof t=="function")return C0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Hg)return 11;if(t===zg)return 14}return 2}function qs(t,e){var n=t.alternate;return n===null?(n=nr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ju(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")C0(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case _o:return Li(n.children,s,i,e);case Bg:o=8,s|=8;break;case Rp:return t=nr(12,n,e,s|2),t.elementType=Rp,t.lanes=i,t;case Mp:return t=nr(13,n,e,s),t.elementType=Mp,t.lanes=i,t;case Np:return t=nr(19,n,e,s),t.elementType=Np,t.lanes=i,t;case _C:return Tf(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case SC:o=10;break e;case vC:o=9;break e;case Hg:o=11;break e;case zg:o=14;break e;case Ns:o=16,r=null;break e}throw Error(G(130,t==null?t:typeof t,""))}return e=nr(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Li(t,e,n,r){return t=nr(7,t,r,e),t.lanes=n,t}function Tf(t,e,n,r){return t=nr(22,t,r,e),t.elementType=_C,t.lanes=n,t.stateNode={isHidden:!1},t}function bh(t,e,n){return t=nr(6,t,null,e),t.lanes=n,t}function Th(t,e,n){return e=nr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function cO(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=lh(0),this.expirationTimes=lh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function E0(t,e,n,r,s,i,o,a,l){return t=new cO(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=nr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},o0(i),t}function uO(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:vo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function fk(t){if(!t)return ti;t=t._reactInternals;e:{if(to(t)!==t||t.tag!==1)throw Error(G(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(xn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(G(171))}if(t.tag===1){var n=t.type;if(xn(n))return fE(t,n,e)}return e}function hk(t,e,n,r,s,i,o,a,l){return t=E0(n,r,!0,t,s,i,o,a,l),t.context=fk(null),n=t.current,r=un(),s=Ys(n),i=is(r,s),i.callback=e??null,Gs(n,i,s),t.current.lanes=s,vc(t,s,r),In(t,r),t}function Rf(t,e,n,r){var s=e.current,i=un(),o=Ys(s);return n=fk(n),e.context===null?e.context=n:e.pendingContext=n,e=is(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Gs(s,e,o),t!==null&&(Er(t,s,o,i),Pu(t,s,o)),o}function Pd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Dw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function k0(t,e){Dw(t,e),(t=t.alternate)&&Dw(t,e)}function dO(){return null}var pk=typeof reportError=="function"?reportError:function(t){console.error(t)};function x0(t){this._internalRoot=t}Mf.prototype.render=x0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(G(409));Rf(t,e,null,null)};Mf.prototype.unmount=x0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Gi(function(){Rf(null,t,null,null)}),e[ps]=null}};function Mf(t){this._internalRoot=t}Mf.prototype.unstable_scheduleHydration=function(t){if(t){var e=VC();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ls.length&&e!==0&&e<Ls[n].priority;n++);Ls.splice(n,0,t),n===0&&XC(t)}};function I0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Nf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ow(){}function fO(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=Pd(o);i.call(c)}}var o=hk(e,r,t,0,null,!1,!1,"",Ow);return t._reactRootContainer=o,t[ps]=o.current,Dl(t.nodeType===8?t.parentNode:t),Gi(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=Pd(l);a.call(c)}}var l=E0(t,0,!1,null,null,!1,!1,"",Ow);return t._reactRootContainer=l,t[ps]=l.current,Dl(t.nodeType===8?t.parentNode:t),Gi(function(){Rf(e,l,n,r)}),l}function Af(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Pd(o);a.call(l)}}Rf(e,o,t,s)}else o=fO(n,e,t,s,r);return Pd(o)}jC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ya(e.pendingLanes);n!==0&&(Vg(e,n|1),In(e,pt()),!(ze&6)&&(aa=pt()+500,hi()))}break;case 13:Gi(function(){var r=ms(t,1);if(r!==null){var s=un();Er(r,t,1,s)}}),k0(t,1)}};Gg=function(t){if(t.tag===13){var e=ms(t,134217728);if(e!==null){var n=un();Er(e,t,134217728,n)}k0(t,134217728)}};WC=function(t){if(t.tag===13){var e=Ys(t),n=ms(t,e);if(n!==null){var r=un();Er(n,t,e,r)}k0(t,e)}};VC=function(){return je};GC=function(t,e){var n=je;try{return je=t,e()}finally{je=n}};Hp=function(t,e,n){switch(e){case"input":if(Op(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Cf(r);if(!s)throw Error(G(90));EC(r),Op(r,s)}}}break;case"textarea":xC(t,n);break;case"select":e=n.value,e!=null&&Fo(t,!!n.multiple,e,!1)}};AC=S0;DC=Gi;var hO={usingClientEntryPoint:!1,Events:[Cc,xo,Cf,MC,NC,S0]},Ba={findFiberByHostInstance:xi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pO={bundleType:Ba.bundleType,version:Ba.version,rendererPackageName:Ba.rendererPackageName,rendererConfig:Ba.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ws.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=FC(t),t===null?null:t.stateNode},findFiberByHostInstance:Ba.findFiberByHostInstance||dO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fu.isDisabled&&fu.supportsFiber)try{wf=fu.inject(pO),Br=fu}catch{}}jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hO;jn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I0(e))throw Error(G(200));return uO(t,e,null,n)};jn.createRoot=function(t,e){if(!I0(t))throw Error(G(299));var n=!1,r="",s=pk;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=E0(t,1,!1,null,null,n,!1,r,s),t[ps]=e.current,Dl(t.nodeType===8?t.parentNode:t),new x0(e)};jn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(G(188)):(t=Object.keys(t).join(","),Error(G(268,t)));return t=FC(e),t=t===null?null:t.stateNode,t};jn.flushSync=function(t){return Gi(t)};jn.hydrate=function(t,e,n){if(!Nf(e))throw Error(G(200));return Af(null,t,e,!0,n)};jn.hydrateRoot=function(t,e,n){if(!I0(t))throw Error(G(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=pk;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=hk(e,null,t,1,n??null,s,!1,i,o),t[ps]=e.current,Dl(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Mf(e)};jn.render=function(t,e,n){if(!Nf(e))throw Error(G(200));return Af(null,t,e,!1,n)};jn.unmountComponentAtNode=function(t){if(!Nf(t))throw Error(G(40));return t._reactRootContainer?(Gi(function(){Af(null,null,t,!1,function(){t._reactRootContainer=null,t[ps]=null})}),!0):!1};jn.unstable_batchedUpdates=S0;jn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Nf(n))throw Error(G(200));if(t==null||t._reactInternals===void 0)throw Error(G(38));return Af(t,e,n,!1,r)};jn.version="18.3.1-next-f1338f8080-20240426";function mk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(mk)}catch(t){console.error(t)}}mk(),mC.exports=jn;var gk=mC.exports,Df,Lw=gk;Df=Lw.createRoot,Lw.hydrateRoot;const mO="_loader_1mrvv_8",gO="_l4_1mrvv_1",yO={"app-container":"_app-container_1mrvv_1",loader:mO,l4:gO};var Si=(t=>(t[t.NONE=0]="NONE",t[t.VERTICAL=1]="VERTICAL",t[t.HORIZONTAL=2]="HORIZONTAL",t))(Si||{}),rr=(t=>(t[t.NONE=0]="NONE",t[t.EDIT_CELL=1]="EDIT_CELL",t[t.EDIT_FORMULA_BAR=2]="EDIT_FORMULA_BAR",t))(rr||{}),Et=(t=>(t[t.TOP=0]="TOP",t[t.MIDDLE=1]="MIDDLE",t[t.BOTTOM=2]="BOTTOM",t))(Et||{}),wt=(t=>(t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT",t))(wt||{}),Ze=(t=>(t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE",t))(Ze||{}),vr=(t=>(t[t.MERGE_CENTER=0]="MERGE_CENTER",t[t.MERGE_CELL=1]="MERGE_CELL",t[t.MERGE_CONTENT=2]="MERGE_CONTENT",t))(vr||{}),_r=(t=>(t.REMOTE="remote",t.MODEL="model",t.INIT="init",t.EMPTY="empty",t))(_r||{}),L=(t=>(t[t.EQUAL=0]="EQUAL",t[t.NOT_EQUAL=1]="NOT_EQUAL",t[t.PLUS=2]="PLUS",t[t.MINUS=3]="MINUS",t[t.STAR=4]="STAR",t[t.SLASH=5]="SLASH",t[t.EXPONENT=6]="EXPONENT",t[t.GREATER=7]="GREATER",t[t.GREATER_EQUAL=8]="GREATER_EQUAL",t[t.CONCATENATE=9]="CONCATENATE",t[t.COLON=10]="COLON",t[t.COMMA=11]="COMMA",t[t.EMPTY_CHAR=12]="EMPTY_CHAR",t[t.PERCENT=13]="PERCENT",t[t.LESS=14]="LESS",t[t.LESS_EQUAL=15]="LESS_EQUAL",t[t.STRING=16]="STRING",t[t.NUMBER=17]="NUMBER",t[t.BOOL=18]="BOOL",t[t.ERROR=19]="ERROR",t[t.ERROR_REF=20]="ERROR_REF",t[t.LEFT_BRACKET=21]="LEFT_BRACKET",t[t.RIGHT_BRACKET=22]="RIGHT_BRACKET",t[t.lEFT_BRACE=23]="lEFT_BRACE",t[t.RIGHT_BRACE=24]="RIGHT_BRACE",t[t.SEMICOLON=25]="SEMICOLON",t[t.EXCLAMATION=26]="EXCLAMATION",t[t.R1C1=27]="R1C1",t[t.SHEET_NAME=28]="SHEET_NAME",t[t.CELL=29]="CELL",t[t.COLUMN=30]="COLUMN",t[t.ROW=31]="ROW",t[t.DEFINED_NAME=32]="DEFINED_NAME",t[t.EXCEL_FUNCTION=33]="EXCEL_FUNCTION",t[t.REF_FUNCTION=34]="REF_FUNCTION",t[t.REF_FUNCTION_COND=35]="REF_FUNCTION_COND",t[t.EOF=36]="EOF",t))(L||{});const wO="_wrap_1flh9_49",SO="_show_1flh9_53",Zr={"formula-bar-wrapper":"_formula-bar-wrapper_1flh9_1","defined-name":"_defined-name_1flh9_11","defined-name-editor":"_defined-name-editor_1flh9_16","formula-bar-editor-wrapper":"_formula-bar-editor-wrapper_1flh9_28","formula-bar-value":"_formula-bar-value_1flh9_38",wrap:wO,show:SO,"formula-editor":"_formula-editor_1flh9_58","edit-cell":"_edit-cell_1flh9_73"};class pi{constructor(e){H(this,"listeners",new Set);H(this,"state");H(this,"setState",(e,n)=>{Array.isArray(e)&&(n=!0);const r=!n&&e&&typeof e=="object"&&Object.entries(e).every(([s,i])=>Object.is(this.state[s],i));if(r)return r;if(!Object.is(this.state,e)){const s=this.state;this.state=n??(typeof e!="object"||e===null)?e:Object.assign({},this.state,e);for(const i of this.listeners)i(this.state,s)}});H(this,"subscribe",e=>(this.listeners.add(e),()=>this.listeners.delete(e)));H(this,"getSnapshot",()=>this.state);this.state=e}}const $d=new pi([]),no=12,yk="sans-serif",vO="Sheet",zl=22,jl=76,vm=zl,_m=jl/2,Cm=0,_O=10,Hn="&#10;",kc=`
`,wk=",",xc=16384,Ic=1048576,Gn=200,Rh=200,Xn=30,sr=-999,Em=16,Sk="__sheet_item_",la="=",ca="_",Wl=35,bc=256,Fw=9,vk="__FORMULA_EDITOR_ROLE__",CO="184858c4-be37-41b5-af82-52689004e605",Xi="General",_k="@",Ck=new Set(["#GETTING_DATA","#DIV/0!","#NULL!","#NUM!","#REF!","#VALUE!","#N/A","#NAME?"]),ve=1,Tc={thin:ve,hair:ve,dotted:ve,dashed:ve,dashDot:ve,dashDotDot:ve,double:ve,medium:ve*2,mediumDashed:ve*2,mediumDashDot:ve*2,mediumDashDotDot:ve*2,thick:ve*4},km=["#35322B","#505050","#606060","#6F6F6F","#8B8B8B","#B2B2B2","#CCCCCC","#E5E5E5","#F5F5F5","#FFFFFF","#9D0000","#B20000","#CD0F0F","#E30909","#F30B0B","#FE4B4B","#FA7979","#FB9D9D","#FDCECE","#FEE7E7","#B24000","#CC4F10","#DF5D00","#F96800","#FB8937","#FF8C51","#FCA669","#FDC49B","#FEE1CD","#FEF0E6","#B19401","#C5A300","#D8B300","#EBC301","#F9D700","#FBE137","#FCE869","#FDF09B","#FEF7CD","#FEFBE6","#58770A","#688C0D","#7AA017","#8BBB11","#A4DC16","#BEEE44","#CEF273","#DEF6A2","#EFFBD0","#F7FDE8","#007676","#008A8A","#009E9E","#00BBBB","#1CD8D8","#2AEAEA","#76EFEF","#A3F5F5","#D1FAFA","#E8FCFC","#001F9C","#0025B7","#012BD2","#133DE3","#2F55EB","#4567ED","#738DF2","#A2B3F6","#D0D9FB","#E8ECFD","#3F0198","#510EB0","#6721CB","#7735D4","#894EDE","#9E6DE3","#AA82E3","#C7ABED","#E3D5F6","#F1EAFA","#8F0550","#A1095C","#C1026B","#D4157E","#E7258F","#F248A6","#F273B9","#F6A2D0","#FBD0E8","#FDE8F3"],EO="#TEXT",kO=/^[$]?[A-Za-z]{1,3}[$]?[1-9][0-9]*$/,xO=/^[$]?[A-Za-z]{1,3}$/,IO=/^\$[1-9][0-9]*$/,b0=/^[a-zA-Z_][a-zA-Z0-9_.?]*$/,bO=new Set(["ABS","ACCRINT","ACCRINTM","ACOS","ACOSH","ACOT","ACOTH","ADDRESS","AGGREGATE","AMORDEGRC","AMORLINC","AND","ARABIC","AREAS","ARRAYTOTEXT","ASC","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BAHTTEXT","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CALL","CEILING","CEILING.MATH","CEILING.PRECISE","CELL","CHAR","CHIDIST","CHIINV","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHISQ.TEST","CHITEST","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCAT","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUPDAYBS","COUPDAYS","COUPDAYSNC","COUPNCD","COUPNUM","COUPPCD","COVAR","COVARIANCE.P","COVARIANCE.S","CRITBINOM","CSC","CSCH","CUBEKPIMEMBER","CUBEMEMBER","CUBEMEMBERPROPERTY","CUBERANKEDMEMBER","CUBESET","CUBESETCOUNT","CUBEVALUE","CUMIPMT","CUMPRINC","DATE","DATEDIF","DATEVALUE","DAVERAGE","DAY","DAYS","DAYS360","DB","DBCS","DCOUNT","DCOUNTA","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DGET","DISC","DMAX","DMIN","DOLLAR","DOLLARDE","DOLLARFR","DPRODUCT","DSTDEV","DSTDEVP","DSUM","DURATION","DVAR","DVARP","EDATE","EFFECT","ENCODEURL","EOMONTH","ERF","ERF.PRECISE","ERFC","ERFC.PRECISE","ERROR.TYPE","EUROCONVERT","EVEN","EXACT","EXP","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","F.TEST","FACT","FACTDOUBLE","FALSE","FDIST","FILTER","FILTERXML","FIND","FINDB","FINV","FISHER","FISHERINV","FIXED","FLOOR","FLOOR.MATH","FLOOR.PRECISE","FORECAST","FORECAST.ETS","FORECAST.ETS.CONFINT","FORECAST.ETS.SEASONALITY","FORECAST.ETS.STAT","FORECAST.LINEAR","FORMULATEXT","FREQUENCY","FTEST","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GETPIVOTDATA","GROWTH","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HLOOKUP","HOUR","HYPERLINK","HYPGEOM.DIST","HYPGEOMDIST","IFERROR","IFNA","IFS","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INFO","INT","INTERCEPT","INTRATE","IPMT","IRR","ISBLANK","ISERR","ISERROR","ISEVEN","ISFORMULA","ISLOGICAL","ISNA","ISNONTEXT","ISNUMBER","ISO.CEILING","ISODD","ISOWEEKNUM","ISPMT","ISREF","ISTEXT","JIS","KURT","LARGE","LCM","LEFT","LEFTB","LEN","LENB","LET","LINEST","LN","LOG","LOG10","LOGEST","LOGINV","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOOKUP","LOWER","MATCH","MAX","MAXA","MAXIFS","MDETERM","MDURATION","MEDIAN","MID","MIDB","MIN","MINA","MINIFS","MINUTE","MINVERSE","MIRR","MMULT","MOD","MODE","MODE.MULT","MODE.SNGL","MONTH","MROUND","MULTINOMIAL","MUNIT","N","NA","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NETWORKDAYS.INTL","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERVALUE","OCT2BIN","OCT2DEC","OCT2HEX","ODD","ODDFPRICE","ODDFYIELD","ODDLPRICE","ODDLYIELD","OR","PDURATION","PEARSON","PERCENTILE","PERCENTILE.EXC","PERCENTILE.INC","PERCENTRANK","PERCENTRANK.EXC","PERCENTRANK.INC","PERMUT","PERMUTATIONA","PHI","PHONETIC","PI","PMT","POISSON","POISSON.DIST","POWER","PPMT","PRICE","PRICEDISC","PRICEMAT","PROB","PRODUCT","PROPER","PV","QUARTILE","QUARTILE.EXC","QUARTILE.INC","QUOTIENT","RADIANS","RAND","RANDARRAY","RANDBETWEEN","RANK","RANK.AVG","RANK.EQ","RATE","RECEIVED","REGISTER.ID","REPLACE","REPLACEB","REPT","RIGHT","RIGHTB","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","RTD","SEARCH","SEARCHB","SEC","SECH","SECOND","SEQUENCE","SERIESSUM","SHEET","SHEETS","SIGN","SIN","SINH","SKEW","SKEW.P","SLN","SLOPE","SMALL","SORT","SORTBY","SQRT","SQRTPI","STANDARDIZE","STDEV","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","T.TEST","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TEXT","TEXTJOIN","TIME","TIMEVALUE","TINV","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","TTEST","TYPE","UNICHAR","UNICODE","UNIQUE","UPPER","VALUE","VALUETOTEXT","VAR","VAR.P","VAR.S","VARA","VARP","VARPA","VDB","VLOOKUP","WEBSERVICE","WEEKDAY","WEEKNUM","WEIBULL","WEIBULL.DIST","WORKDAY","WORKDAY.INTL","XIRR","XLOOKUP","XMATCH","XNPV","XOR","YEAR","YEARFRAC","YIELD","YIELDDISC","YIELDMAT","Z.TEST","ZTEST"]);function TO(t,e){let n=!1,r;return function(...s){n?r=s:(t.apply(this,s),setTimeout(()=>{r&&t.apply(this,r),n=!1},e))}}function Tn(t,e,n){const r=t==null?void 0:e.replace(/\[/g,".").replace(/\]/g,"").split(".").reduce((s,i)=>s==null?s:s[i],t);return r===void 0?n:r}function dl(t){const e=t||{};return[Object,Array].includes(e.constructor)&&!Object.entries(e).length}function Of(t,e){if(t===e)return!0;if(t&&typeof t=="object"&&e&&typeof e=="object"){if(Object.keys(t).length!==Object.keys(e).length)return!1;const n=Object.keys(t),r=Object.keys(e);for(let s=0;s<n.length;s++){const i=n[s],o=r[s];if(i!==o||!Of(t[i],e[o]))return!1}return!0}return!1}function RO(){}function MO(t){const e=t.toLowerCase().replace(/[-_\s.]+(.)?/g,(n,r)=>r?r.toUpperCase():"");return e.substring(0,1).toLowerCase()+e.substring(1)}function Ha(t,e){const n={...t};return e.forEach(r=>{delete n[r]}),n}function ni(t){if(typeof t=="boolean")return[!0,Number(t)];if(typeof t=="number"&&!isNaN(t))return[!0,t];if(typeof t!="string")return[!1,0];if(t.length>12)return[!1,0];const e=Number(t);return isNaN(e)?[!1,0]:[!0,e]}function NO(t=[]){const e=t.map(n=>ni(n)[1]).filter(n=>!isNaN(n));return Math.max(Math.max(...e),0)}function AO(t=[]){const e=Math.ceil(NO(t.map(n=>n.sheetId)))+1;return{name:`${vO}${e}`,sheetId:String(e),sort:e}}function Pw(t){if(typeof t=="string"){const r=t.toUpperCase();if(["TRUE","FALSE"].includes(r))return r==="TRUE"}if(typeof t=="boolean")return t;if(t==="")return"";const[e,n]=ni(t);return e?n:t}function DO(t){const[e,n]=t.split(ca),r=parseInt(e,10),s=parseInt(n,10);return{row:isNaN(r)?-1:r,col:isNaN(s)?-1:s}}function qn(t,e,n){return`${t}${ca}${e}${ca}${n}`}function fl(t){const[e,n,r]=t.split(ca),s=parseInt(n,10),i=parseInt(r,10),o={row:isNaN(s)?-1:s,col:isNaN(i)?-1:i,sheetId:e};return o.row<0||o.col<0||!e?null:o}function kr(t,e){return`${t}${ca}${e}`}function Vl(t){const[e,n]=t.split(ca),r=parseInt(n,10);return{sheetId:e,rowOrCol:isNaN(r)?-1:r}}function ua(){let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const r=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(n==="x"?r:r&3|8).toString(16)})}function OO(){const t=[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i],e=navigator.userAgent;return t.some(n=>e.match(n))}const T0=["autoFilter","currentSheetId","customHeight","customWidth","workbook","worksheets","definedNames","drawings","mergeCells","rangeMap","scroll"];function LO(t){var r,s,i;const e=new Set,n=new Set(T0);for(const o of t){if(!o)continue;const a=new Set(((i=(s=(r=o==null?void 0:o.changes)==null?void 0:r.keys)==null?void 0:s.keys)==null?void 0:i.call(s))||[]),l=new Set(o.path||[]);for(const c of a.keys())n.has(c)&&e.add(c);for(const c of l.keys())n.has(c)&&e.add(c);(l.has("worksheets")||a.has("worksheets"))&&(a.has("formula")||a.has("value"))?e.add("cellValue"):e.add("cellStyle")}return e}function FO(){return!1}function PO(){var t;return((t=navigator==null?void 0:navigator.userAgent)==null?void 0:t.indexOf("Mac OS X"))>=0}function Ek(t){return!!(typeof t=="string"&&t&&t.startsWith(la)&&t.length>1)}function R0(t,e){return t&&e.includes(Hn)}function $O(){return(window==null?void 0:window.top)!==window}function kk(){var e,n;return(((n=(e=window==null?void 0:window.top)==null?void 0:e.location)==null?void 0:n.hash)||"").slice(1)||window.location.hash.slice(1)||CO}const UO=[6,8,9,10,no,14,16,18,20,22,24,26,28,36,48,72];function xk(t="normal",e="normal",n=no,r=""){const s=`${t} ${e} ${n}px `,i=[yk];return r&&i.unshift(r),s+i.join(",")}function BO(t){let e="";return t.fontColor&&(e+=`color:${t.fontColor};`),t.fillColor&&(e+=`background-color:${t.fillColor};`),t.fontSize&&(e+=`font-size:${t.fontSize}pt;`),t.fontFamily&&(e+=`font-family:${t.fontFamily};`),t.isItalic&&(e+="font-style:italic;"),t.isBold&&(e+="font-weight:700;"),t.isWrapText&&(e+="white-space:normal;"),t.underline&&t.isStrike?e+="text-decoration-line:underline line-through;":t.underline?e+="text-decoration-line:underline;":t.isStrike&&(e+="text-decoration-line:line-through;"),t.underline===Ze.DOUBLE&&(e+="text-decoration-style: double;"),e}function Mh(t){const{color:e,backgroundColor:n,fontSize:r,fontFamily:s,fontStyle:i,fontWeight:o,whiteSpace:a,textDecorationLine:l,textDecorationStyle:c}=t,d={};if(e&&(d.fontColor=e),n&&(d.fillColor=n),r){const u=parseInt(r,10);isNaN(u)||(d.fontSize=u)}return s&&(d.fontFamily=s),i==="italic"&&(d.isItalic=!0),o&&[700,800,900,"bold"].includes(o)&&(d.isBold=!0),a&&["normal","pre-wrap","pre-line","break-spaces","revert","unset"].includes(a)&&(d.isWrapText=!0),l!=null&&l.includes("underline")&&(d.underline=Ze.SINGLE,c==="double"&&(d.underline=Ze.DOUBLE)),l!=null&&l.includes("line-through")&&(d.isStrike=!0),d}function HO(t,e,n,r){let s={};const i=r.toLowerCase(),o=t[r]||t[i];return o&&(s=Mh(o)),t[n]&&(s=Object.assign(s,Mh(t[n]))),s=Object.assign(s,Mh(e)),i==="s"||i==="strike"?s.isStrike=!0:i==="i"?s.isItalic=!0:i==="b"||i==="strong"?s.isBold=!0:i==="u"&&(s.underline=Ze.SINGLE),s}function zO(t){const e=t.replace(/\s+/g,"").replace("<!--",""),n=/([^{}]+)\s*\{([^}]*)\}/g,r={};let s;for(;(s=n.exec(e))!==null;){const i=(s[1]||"").trim(),o=(s[2]||"").trim();if(!i||!o)continue;r[i]={};const a=o.split(";");for(const l of a){const[c,d]=l.split(":").map(m=>m.trim());if(!d||!c)continue;const u=MO(c),[f,h]=ni(d),p=f?h:d;r[i][u]=p}}return r}function $w(t){const e=parseInt(t,10);return isNaN(e)?-1:t.endsWith("pt")?Math.ceil(e*96/72):e}function Uw(t,e="pt"){const n=Math.floor(t*72/96);return String(n)+e}function Ik(t,e="	"){let n;t.indexOf(`\r
`)>=0?n=t.split(`\r
`):n=t.split(`
`);const r=n.map(i=>i.trim()).filter(i=>i).map(i=>i.split(e).map(o=>o.trim()).filter(o=>o)),s=[];for(const i of r)i.length!==0&&s.push(i);return s}function jO(t){let e=document.createElement("template");e.innerHTML=t;const n=e.content,r={};for(const d of n.querySelectorAll("style")){const u=zO(d.textContent||"");for(const[f,h]of Object.entries(u))r[f]=Object.assign(r[f]||{},h)}const s=[],i=[],o=n.querySelectorAll("tr"),a=new Map,l=new Map;let c=0;for(const d of o){const u=$w(d.style.height);u>0&&l.set(c++,u);const f=[],h=[];let p=0;for(const m of d.children){if(m.tagName!=="TD")continue;let _=m;const g=$w(_.style.width);g>0&&!a.has(p)&&a.set(p++,g);let y={};for(;_.nodeType!==Node.TEXT_NODE;){const w=HO(r,_.style,_.className?`.${_.className}`:"",_.tagName);if(y=Object.assign(y,w),_.firstChild)_=_.firstChild;else break}h.push(y),f.push((_.textContent??"").trim())}s.push(f),i.push(h)}return e=void 0,{textList:s,styleList:i,rowMap:l,colMap:a}}let xm;function Gl(t=typeof devicePixelRatio>"u"?void 0:devicePixelRatio){return typeof xm=="number"?xm:Math.max(Math.floor(t||1),1)}function He(t){return Math.floor(t*Gl())}function WO(t){xm=Math.max(Math.floor(t||1),1)}function VO(t){const e=t.toUpperCase();let n=0;for(let r=0;r<e.length;r++)n=e.charCodeAt(r)-64+n*26;return n-1}function bk(t){const e=t+1;let n="",r=Math.floor(Math.abs(e)),s;for(;r>0;)s=(r-1)%26,n=String.fromCharCode(65+s)+n,r=Math.floor((r-s)/26);return n.toUpperCase()}function GO(t){let e=parseInt(t,10);return isNaN(e)?e=-1:e=Math.max(e-1,-1),e}function Fe(...t){let e="";for(const n of t)if(n!==void 0&&(typeof n=="string"&&n&&(e+=`${n} `),typeof n=="object"))for(const r of Object.keys(n))n[r]&&(e+=`${r} `);return e.trim()}function Ao(t){return Ks(t)&&Js(t)}function Ks(t){return t.colCount===0}function Js(t){return t.rowCount===0}function M0(t,e){return t.col===e.col&&t.row===e.row&&t.colCount===e.colCount&&t.rowCount===e.rowCount&&t.sheetId===e.sheetId}function Tk(t,e){if(t.colCount===0&&e.colCount!==0||t.rowCount===0&&e.rowCount!==0)return!1;if(e.colCount===0&&e.row===t.row||e.rowCount===0&&e.col===t.col)return!0;const{row:n,col:r}=t;return n>=e.row&&n<e.row+e.rowCount&&r>=e.col&&r<e.col+e.colCount}function ri(t){return Tr.makeRange(t).toIRange()}class Tr{constructor(e,n,r,s,i){H(this,"row",0);H(this,"col",0);H(this,"colCount",0);H(this,"rowCount",0);H(this,"sheetId","");this.row=e,this.col=n,this.colCount=s,this.rowCount=r,this.sheetId=i}static makeRange(e){return new Tr(e.row,e.col,e.rowCount,e.colCount,e.sheetId)}toIRange(){return{row:this.row,col:this.col,rowCount:this.rowCount,colCount:this.colCount,sheetId:this.sheetId}}}function hl(t,e,n,r){const{row:s,col:i,rowCount:o,colCount:a}=t;if(Ao(t)){for(let d=0;d<e;d++)for(let u=0;u<n;u++)if(r(d,u))return;return}if(Ks(t)){for(let d=0;d<n;d++)if(r(s,d))return;return}if(Js(t)){for(let d=0;d<e;d++)if(r(d,i))return;return}const l=s+o,c=i+a;for(let d=s;d<l;d++)for(let u=i;u<c;u++)if(r(d,u))return}const Im=t=>t>="a"&&t<="z"||t>="A"&&t<="Z",xs=t=>t>="0"&&t<="9";function Rk(t){return t}function Bw(t,e){if(!t)return;const n=t.trim();let[r,s=""]=n.split("!");n.includes("!")||(r="",s=n),r&&r[0]==="'"&&r[r.length-1]==="'"&&(r=r.slice(1,-1));let i=0,o="",a="";for(s[i]==="$"&&i++;i<s.length&&Im(s[i]);)a+=s[i++];for(s[i]==="$"&&i++;i<s.length&&xs(s[i]);)o+=s[i++];if(i!==s.length||!o&&!a)return;let l=1,c=1,d=-1,u=-1;return o===""?(l=0,d=0):d=GO(o),a===""?(c=0,u=0):u=VO(a),d<0||u<0||u>=xc||d>=Ic?void 0:new Tr(d,u,l,c,e(r))}function es(t,e=Rk){const[n,r]=t.split(":"),s=Bw(n,e);if(!s)return;const i=Bw(r,e);return i?(i.sheetId=s.sheetId,N0(s,i)):s}function N0(t,e){if(t.sheetId!==e.sheetId)return;if(t.row===e.row&&t.col===e.col&&t.rowCount===e.rowCount&&t.colCount===e.colCount)return Tr.makeRange(t);if(t.rowCount===0&&e.rowCount!==0||t.rowCount!==0&&e.rowCount===0||t.colCount===0&&e.colCount!==0||t.colCount!==0&&e.colCount===0)return;const n=Math.abs(t.row-e.row)+1,r=Math.abs(t.col-e.col)+1,s=t.row<e.row?t.row:e.row,i=t.col<e.col?t.col:e.col;return new Tr(s,i,n,r,t.sheetId)}function Hw(t,e,n){const r=n==="absolute"||n==="mixed",s=n==="absolute";return`${r?"$":""}${bk(e)}${s?"$":""}${t+1}`}function Zn(t,e="relative",n=Rk){let r=Hw(t.row,t.col,e),s=n(t.sheetId);if(s=s?`${s}!`:"",t.colCount>1&&t.rowCount>1){const i=Hw(t.row+t.rowCount-1,t.col+t.colCount-1,e);r=`${r}:${i}`}return s+r}function zw(t,e){let n=-1;if(t.startsWith("[")){const r=parseInt(t.slice(1,-1),10);isNaN(r)||(n=e+r)}else{const r=parseInt(t,10);isNaN(r)||(n=r-1)}return isNaN(n)?-1:n}function XO(t,e={row:-1,col:-1}){const n=t.toUpperCase();if(n[0]!=="R")return;const r=n.slice(1).split("C");if(r.length!==2)return;const[s,i]=r;let o=-1,a=-1;return s?o=zw(s,e.row):o=e.row,i?a=zw(i,e.col):a=e.col,a>=xc||o>=Ic||o<0||a<0?void 0:new Tr(o,a,1,1,"")}const Do=class Do{constructor(e){H(this,"namespace");H(this,"init",()=>(this.setColor(),this.log));H(this,"log",(...e)=>{if(!this.enable())return;const{namespace:n}=this,r=Do.colorMap.get(n),s=[`%c ${n}:`,`color:${r};`,...e];console.log(...s)});H(this,"getRandomColor",()=>{const e=Math.floor(Math.random()*km.length);return km[e]});this.namespace=e}enable(){return window.localStorage.getItem("debug")==="*"}setColor(){Do.colorMap.has(this.namespace)||Do.colorMap.set(this.namespace,this.getRandomColor())}};H(Do,"colorMap",new Map);let Xl=Do;const jw=new Xl("model").init();new Xl("react").init();const Mk=new Xl("collaboration").init(),Ut="text/plain",Bt="text/html",Kt="custom/model",an="image/png",bm="<caption>",Nk="</caption>";function YO(t){const e=t.hasAttribute("readonly");return e||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),e||t.removeAttribute("readonly"),t.value}function qO(t){const e=document.documentElement.getAttribute("dir")==="rtl",n=document.createElement("textarea");n.style.fontSize="12pt",n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[e?"right":"left"]="-9999px";const r=window.pageYOffset||document.documentElement.scrollTop;return n.style.top=`${r}px`,n.setAttribute("readonly",""),n.value=t,n}function KO(t,e){let n=qO(t);document.body.appendChild(n);const r=YO(n);return typeof document.execCommand=="function"&&document.execCommand(e),n.remove(),n=void 0,r}async function JO(t){var s;const e=new Blob([t[Ut]],{type:Ut}),n=new Blob([t[Bt]],{type:Bt}),r={[Ut]:e,[Bt]:n};t[an]&&(r[an]=t[an]),await((s=navigator==null?void 0:navigator.clipboard)==null?void 0:s.write([new ClipboardItem(r)]))}async function QO(t,e){try{await JO(t);return}catch(n){console.log(n)}try{KO(t[Ut],e)}catch(n){console.log(n)}}async function ZO(){var n;const t={[Bt]:"",[Ut]:"",[Kt]:null,[an]:null},e=await((n=navigator==null?void 0:navigator.clipboard)==null?void 0:n.read())||[];for(const r of e){if(r.types.includes(Ut)){const s=await r.getType(Ut);t[Ut]=await(s==null?void 0:s.text())}if(r.types.includes(Bt)){const s=await r.getType(Bt);t[Bt]=await(s==null?void 0:s.text())}if(r.types.includes(an)){const s=await r.getType(an);t[an]=s}}return t[Kt]=t[Kt]||n8(t[Bt]),t}async function Ak(){try{return await ZO()}catch(t){console.log(t)}return{[Bt]:"",[Ut]:"",[Kt]:null,[an]:null}}function e8(t,e,n=""){return`
<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="ProgId" content="Excel.Sheet" />
    <meta name="Generator" content="Microsoft Excel 15" />
    <style>${t}</style>
  </head>
    <body>
      <table>${n}${e}</table>
    </body>
  </html>`.replaceAll(`
`,"")}function t8(t){return t?`${bm}${t}${Nk}`:""}function n8(t){const e=t.indexOf(bm),n=t.indexOf(Nk);if(e>=0&&n>=0){const r=t.slice(e+bm.length,n).trim();if(!r||r[0]!=="{"||r[r.length-1]!=="}")return null;try{return JSON.parse(r)}catch(s){return console.log(s),null}}return null}const r8={smallFont:"10px",font:"12px",largeFont:"14px",padding:"12px",lineHeight:1.5,mediumPadding:"8px",largePadding:"20px",borderRadius:"4px",borderLargeRadius:"8px",tinyPadding:"4px",scrollBarContent:"30px",formulaBarHeight:"25px"},s8={lowZIndex:2,middleZIndex:3,highZIndex:4,highestZIndex:9};function i8(t,e,n,r){e=e/100,n=n/100;const s=(1-Math.abs(2*n-1))*e,i=s*(1-Math.abs(t/60%2-1)),o=n-s/2;let a,l,c;if(t>=0&&t<60?(a=s,l=i,c=0):t>=60&&t<120?(a=i,l=s,c=0):t>=120&&t<180?(a=0,l=s,c=i):t>=180&&t<240?(a=0,l=i,c=s):t>=240&&t<300?(a=i,l=0,c=s):(a=s,l=0,c=i),r!==1)return`rgba(${a},${l},${c},${r})`;const d=p=>Math.round(p*255).toString(16).padStart(2,"0"),u=d(a+o),f=d(l+o),h=d(c+o);return`#${u}${f}${h}`}const o8=(t,e,n)=>{const r=t/255,s=e/255,i=n/255,o=Math.min(r,s,i),a=Math.max(r,s,i),l=a-o,c=a8(r,s,i),d=c8(a,o),u=l8(l,d);return[c,u*100,d*100]},a8=(t,e,n)=>{const r=Math.max(t,e,n),s=Math.min(t,e,n),i=r-s;let o=0;if(i==0)o=0;else switch(r){case t:{let c=(e-n)/i,d=0;c<0&&(d=360/60),o=c+d;break}case e:{let c=(n-t)/i,d=120/60;o=c+d;break}case n:let a=(t-e)/i,l=240/60;o=a+l;break}return o*60},l8=(t,e)=>t==0?0:t/(1-Math.abs(2*e-1)),c8=(t,e)=>(t+e)/2,Ww=([t,e,n,r])=>{const[s,i,o]=o8(t,e,n);return i8(s,i*.9,100-o,r)};function u8(t){t.startsWith("#")&&(t=t.slice(1));let e=parseInt(t.substring(0,2),16),n=parseInt(t.substring(2,4),16),r=parseInt(t.substring(4,6),16),s=parseInt(t.substring(6,8)||"ff",16);return[e,n,r,s/255]}const d8=t=>{if(t.startsWith("rgb")){const n=t.replace("rgb","").replace("a","").replace("(","").replace(")","").split(",").map(Number);return n.length<=3&&n.push(1),Ww(n)}else return Ww(u8(t))},A0=Object.freeze({primaryColor:"#217346",buttonActiveColor:"#c6c6c6",selectionColor:"rgba(198,198,198,0.3)",backgroundColor:"#e6e6e6",hoverColor:"rgba(0, 0, 0, 0.04)",scrollbarColor:"rgba(0, 0, 0, 0.1)",scrollbarHoveColor:"rgba(0, 0, 0, 0.2)",dialogBackground:"rgba(0, 0, 0, 0.6)",white:"#ffffff",black:"#000000",triangleFillColor:"#dddddd",contentColor:"#333333",borderColor:"#cccccc",activeBorderColor:"#808080",errorFormulaColor:"#ff0000"}),Dk=Object.freeze(Object.fromEntries(Object.entries(A0).map(([t,e])=>[t,d8(e)]))),da={...r8,...s8},Tm="data-theme";function f8(t){sessionStorage.setItem(Tm,t),document.documentElement.setAttribute(Tm,t)}function D0(){if(typeof sessionStorage<"u"){const t=sessionStorage.getItem(Tm);if(t&&(t==="dark"||t==="light"))return t}return typeof matchMedia=="function"&&matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function it(t,e){return e==="dark"||D0()==="dark"?Dk[t]:A0[t]}const Rm="QUERY_ALL_LOCAL_FONT",Ok="LOCAL_FONT_KEY",h8=["PingFang SC","Microsoft Yahei","SimSun","Times New Roman","Source Code Pro","","","","","","","","","","Arial","Calibri"];class O0{constructor(e){H(this,"state");H(this,"set",e=>{this.state=e});this.state=e}get(){return this.state}}const zn=new O0({top:0,left:0,width:0,height:0}),Ti=new O0({width:0,height:0}),ar=new O0({width:_m,height:vm}),Vw=200;function L0(){const t=parseInt(da.scrollBarContent,10),e=zn.get(),n=Ti.get(),r=n.height-e.height+Vw,s=n.width-e.width+Vw,i=e.height-t,o=e.width-t;return{maxHeight:r,maxWidth:s,maxScrollHeight:i,maxScrollWidth:o}}function Lk(t,e,n){if(e<0||n<0)return;const r=t.getSheetInfo(t.getCurrentSheetId());if(!r)return;const s=t.getScroll(),i=ar.get();let o=i.width,a=i.height,l=e-i.width,c=n-i.height,{row:d,col:u}=s;for(;o+t.getColWidth(u)<=e;){const f=t.getColWidth(u);o+=f,l-=f,u++}for(;a+t.getRowHeight(d)<=n;){const f=t.getRowHeight(d);a+=f,c-=f,d++}if(!(d>=r.rowCount||u>=r.colCount))return{row:d,col:u,marginX:l,marginY:c}}function Yl(t,e){let n=document.createElement("a");n.download=e||"download",n.rel="noopener",n.target="_blank",n.setAttribute("data-testid","save-as-link"),typeof t=="string"?n.href=t:n.href=URL.createObjectURL(t),n.dispatchEvent(new MouseEvent("click")),n=void 0}const Gw={maroon:"#800000",red:"#ff0000",orange:"#ffA500",yellow:"#ffff00",olive:"#808000",purple:"#800080",fuchsia:"#ff00ff",white:"#ffffff",lime:"#00ff00",green:"#008000",navy:"#000080",blue:"#0000ff",aqua:"#00ffff",teal:"#008080",black:"#000000",silver:"#c0c0c0",gray:"#808080",transparent:"#0000",cyan:"#F00",magenta:"#00F"},p8="(?:#([a-f0-9]{3,8}))",Nh="\\s*([.\\d%]+)\\s*",m8="(?:,\\s*([.\\d]+)\\s*)?",Fk=`\\(${[Nh,Nh,Nh]}${m8}\\)`,g8="(?:rgb)a?",y8="(?:hsl)a?",Pk=RegExp(p8,"i"),Xw=RegExp(g8+Fk,"i"),Yw=RegExp(y8+Fk,"i");function w8(t){return t.length===1?`0${t}`:t}function $k(t,e,n,r){return`#${[t,e,n,r*255].map(i=>w8(Math.round(i).toString(16))).join("")}`}function S8(t,e,n,r){let s=1;r&&(s=parseFloat(r));const i=parseFloat(t),o=parseFloat(e),a=parseFloat(n);return i<=255&&i>=0&&o<=255&&o>=0&&a<=255&&a>=0&&s<=1&&s>=0?$k(i,o,a,s):""}function Ah(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function v8(t,e,n,r){let s=1;r&&(s=parseFloat(r)/1);const i=parseFloat(t)/360,o=parseFloat(e)/360,a=parseFloat(n)/360;if(i>1||i<0||o>1||o<0||a>1||a<0||s>1||s<0)return"";let l,c,d;if(o===0)l=a,c=a,d=a;else{const u=a<.5?a*(1+o):a+o-a*o,f=2*a-u;l=Ah(f,u,i+1/3),c=Ah(f,u,i),d=Ah(f,u,i-1/3)}return $k(l*255,c*255,d*255,s)}function hu(t){if(!Pk.test(t))return"";if(t.length===9)return t.toUpperCase();if(t.length===7)return`${t}ff`.toUpperCase();if(t.length===4){const[,e,n,r]=t;return`#${e}${e}${n}${n}${r}${r}ff`.toUpperCase()}return""}function Mm(t){if(Gw[t])return hu(Gw[t]);if(Pk.test(t))return hu(t);if(Xw.test(t)){const[,e,n,r,s]=t.match(Xw);return hu(S8(e,n,r,s))}if(Yw.test(t)){const[,e,n,r,s]=t.match(Yw);return hu(v8(e,n,r,s))}return""}class _8{constructor(){H(this,"event",{})}getEventLength(e){const n=this.event[e];return n&&n.length||0}on(e,n){return this.event[e]=this.event[e]||[],this.event[e].push(n),()=>this.off(e,n)}emit(e,n){const r=this.event[e];if(!(!r||r.length<=0))for(const s of r)s(n)}off(e,n){const r=[],s=this.event[e];if(s&&n)for(const i of s)i!==n&&i._!==n&&r.push(i);r.length?this.event[e]=r:delete this.event[e]}once(e,n){const r=s=>{this.off(e,r),n(s)};return r._=n,this.on(e,r)}}const Lf=new _8,Uk={"image/apng":[".apng"],"image/bmp":[".bmp"],"image/x-icon":[".ico",".cur"],"image/png":[".png"],"image/webp":[".webp"],"image/svg+xml":[".svg"],"image/avif":[".avif"],"image/gif":[".gif"],"image/jpeg":[".jpeg",".jpg",".jfif",".pjpeg",".pjp"]};function Bk(t){if(!t)return{ext:"",base64:"",type:""};const e=";base64,",n=t.indexOf(e),s=t.slice("data:".length,n),i=Uk[s]||[];return i.length>0?{ext:i[0],type:s,base64:t.slice(n+e.length)}:{ext:"",base64:"",type:""}}function F0(t,e=!1){return new Promise((n,r)=>{const s=new FileReader;s.onload=function(i){var a;const o=(a=i.target)==null?void 0:a.result;n(o&&typeof o=="string"?o:"")},s.onerror=function(i){r(i)},e?s.readAsDataURL(t):s.readAsText(t)})}function P0(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>{const s=r.width,i=r.height;e({width:s,height:i})},r.onerror=s=>{n(s)},r.src=t})}function C8(t,e="image/png"){const r=atob(t),s=r.length,i=Math.ceil(s/1024),o=Array.from({length:i});for(let a=0;a<i;++a){let l=a*1024,c=Math.min(l+1024,s),d=Array.from({length:c-l});for(let u=l,f=0;u<c;++f,++u)d[f]=r[u].charCodeAt(0);o[a]=new Uint8Array(d)}return new Blob(o,{type:e})}const E8="Copy",k8="Cut",x8="Paste",I8="Add",b8="Rows",T8="Menu",R8="File",M8="Insert",N8="Rename",A8="Reset",D8="Hide",O8="Unhide",L8="Cancel",F8="Confirm",P8="Chart",$8="Duplicate",U8="none",B8="General",H8="Number",z8="Currency",j8="Accounting",W8="Time",V8="Percentage",G8="Fraction",X8="Scientific",Y8="Text",q8="Filter",K8={copy:E8,cut:k8,paste:x8,delete:"Delete",add:I8,rows:b8,menu:T8,file:R8,insert:M8,rename:N8,reset:A8,hide:D8,unhide:O8,cancel:L8,"line-chart":"Line Chart","bar-chart":"Bar Chart","pie-chart":"Pie Chart","scatter-chart":"Scatter Chart","radar-chart":"Radar Chart","polar-area-chart":"PolarArea Chart",confirm:F8,"tab-color":"Tab Color","unhide-sheet":"Unhide sheet:","wrap-text":"Wrap Text","import-xlsx":"Import XLSX","export-xlsx":"Export XLSX","export-csv":"Export CSV","export-json":"Export JSON","import-csv":"Import CSV","floating-picture":"Floating Picture",chart:P8,"chart-title":"Chart Title",duplicate:$8,"select-data":"Select Data","change-chart-title":"Change Chart Title","change-chart-type":"Change Chart Type","save-as-picture":"Save as Picture","reset-size":"Reset Size","add-at-the-bottom":"Add at the bottom","row-height":"Row Height","column-width":"Column Width","greater-than-zero":"The value must be greater than or equal to 0","insert-columns":"Insert Columns","delete-columns":"Delete Columns","hide-columns":"Hide Columns","unhide-columns":"Unhide Columns","insert-rows":"Insert Rows","delete-rows":"Delete Rows","hide-rows":"Hide rows","unhide-rows":"Unhide rows","reference-is-empty":"The reference is empty","reference-is-not-valid":"The reference is not valid","the-value-cannot-be-empty":"The value cannot be empty","edit-data-source":"Edit Data Source","sheet-is-not-exist":"The sheet is not exist","sheet-id-is-duplicate":"The sheet id is duplicate","a-workbook-must-contains-at-least-one-visible-worksheet":"A workbook must contains at least one visible worksheet","sheet-name-is-duplicate":"The sheet name is duplicate","uuid-is-duplicate":"The uuid is duplicate","cells-must-contain-data":"The selected cells must contain the data","image-source-is-empty":"The image source is empty","merging-cell-is-duplicate":"The merging cell is duplicate","insert-column-left":"Insert Column Left","insert-column-right":"Insert Column Right","insert-row-above":"Insert Row Above","insert-row-below":"Insert Row Below","get-all-installed-fonts":"Get all the fonts installed locally","unsupported-chart-types":"Unsupported chart types","merge-cell":"Merge","merge-and-center":"Merge and Center","merge-cells":"Merge Cells","merge-content":"Merge Content",none:U8,"single-underline":"single underline","double-underline":"double underline",general:B8,number:H8,currency:z8,accounting:j8,"short-date":"Short Date","long-date":"Long Date",time:W8,percentage:V8,fraction:G8,scientific:X8,text:Y8,"more-number-formats":"More Number Formats","short-date-format":"m/d/yyyy;@","long-date-format":"[$-409]dddd,mmmm d,yyyy;@","time-format":"h:mm:ss AM/PM","sheet-id-can-not-be-empty":"The sheetId can not be empty","no-border":"No Border","all-borders":"All Borders","outside-borders":"OutSide Borders","thick-box-border":"Thick Box Border","bottom-border":"Bottom Border","top-border":"Top Border","left-border":"Left Border","right-border":"Right Border","line-color":"Line Color","line-style":"Line Style",filter:q8,"filter-empty":"(empty)","filter-all":"All"},J8="",Q8="",Z8="",eL="",tL="",nL="",rL="",sL="",iL="",oL="",aL="",lL="",cL="",uL="",dL="",fL="",hL="",pL="",mL="",gL="",yL="",wL="",SL="",vL="",_L="",CL="",EL="",kL={copy:J8,cut:Q8,paste:Z8,delete:"",add:eL,rows:tL,menu:nL,file:rL,insert:sL,rename:iL,reset:oL,hide:aL,unhide:lL,cancel:cL,"line-chart":"","bar-chart":"","pie-chart":"","scatter-chart":"","radar-chart":"","polar-area-chart":"",confirm:uL,"tab-color":"","unhide-sheet":":","wrap-text":"","import-xlsx":" XLSX","export-xlsx":" XLSX","export-csv":" CSV","export-json":" JSON","import-csv":" CSV","floating-picture":"",chart:dL,"chart-title":"",duplicate:fL,"select-data":"","change-chart-title":"","change-chart-type":"","save-as-picture":"","reset-size":"","add-at-the-bottom":"","row-height":"","column-width":"","greater-than-zero":" 0","insert-columns":"","delete-columns":"","hide-columns":"","unhide-columns":"","insert-rows":"","delete-rows":"","hide-rows":"","unhide-rows":"","reference-is-empty":"","reference-is-not-valid":"","the-value-cannot-be-empty":"","edit-data-source":"","sheet-id-is-duplicate":" ID ","a-workbook-must-contains-at-least-one-visible-worksheet":"","sheet-name-is-duplicate":"","uuid-is-duplicate":"UUID ","cells-must-contain-data":"","image-source-is-empty":"","merging-cell-is-duplicate":"","insert-column-left":"","insert-column-right":"","insert-row-above":"","insert-row-below":"","get-all-installed-fonts":"","unsupported-chart-types":"","merge-cell":"","merge-and-center":"","merge-cells":"","merge-content":"",none:hL,"single-underline":"","double-underline":"",general:pL,number:mL,currency:gL,accounting:yL,"short-date":"","long-date":"",time:wL,percentage:SL,fraction:vL,scientific:_L,text:CL,"more-number-formats":"","short-date-format":"yyyy/m/d;@","long-date-format":'yyyy""m""d""',"time-format":"h:mm:ss","sheet-id-can-not-be-empty":"SheetId ","no-border":"","all-borders":"","outside-borders":"","thick-box-border":"","bottom-border":"","top-border":"","left-border":"","right-border":"","line-color":"","line-style":"",filter:EL,"filter-empty":"()","filter-all":"","sheet-is-not-exist":""};let Hk="language";const Nm=["en","zh"];function zk(){const t="en";if(typeof window>"u")return t;let e=t;const n=localStorage.getItem(Hk);if(n&&Nm.some(r=>r===n))e=n;else{const r=(navigator==null?void 0:navigator.language)||"",s=Nm.find(i=>r.includes(i));s&&(e=s)}return document.documentElement.setAttribute("lang",e),e}function xL(t){localStorage.setItem(Hk,t)}function P(t){return zk()==="en"?K8[t]:kL[t]}const Am=[{value:"line",label:P("line-chart")},{value:"bar",label:P("bar-chart")},{value:"pie",label:P("pie-chart")},{value:"scatter",label:P("scatter-chart")},{value:"radar",label:P("radar-chart")},{value:"polarArea",label:P("polar-area-chart")}],$0=[{formatCode:Xi,id:0},{formatCode:"0",id:1},{formatCode:"0.00",id:2},{formatCode:"#,##0",id:3},{formatCode:"#,##0.00",id:4},{formatCode:'"$"#,##0.00_);[Red]("$"#,##0.00)',id:8},{formatCode:"0%",id:9},{formatCode:"0.00%",id:10},{formatCode:"0.00E+00",id:11},{formatCode:"# ?/?",id:12},{formatCode:"# ??/??",id:13},{formatCode:"mm-dd-yy",id:14},{formatCode:"d-mmm-yy",id:15},{formatCode:"d-mmm",id:16},{formatCode:"mmm-yy",id:17},{formatCode:"h:mm AM/PM",id:18},{formatCode:"h:mm:ss AM/PM",id:19},{formatCode:"h:mm",id:20},{formatCode:"h:mm:ss",id:21},{formatCode:"m/d/yy h:mm",id:22},{formatCode:'yyyy""m""',id:27},{formatCode:"#,##0 ;(#,##0)",id:37},{formatCode:"#,##0 ;[Red](#,##0)",id:38},{formatCode:"#,##0.00 ;(#,##0.00)",id:39},{formatCode:"#,##0.00 ;[Red](#,##0.00)",id:40},{formatCode:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',id:44},{formatCode:"mm:ss",id:45},{formatCode:"[h]:mm:ss",id:46},{formatCode:"mmss.0",id:47},{formatCode:"##0.0E+0",id:48},{formatCode:_k,id:49},{formatCode:'/ h""mm""ss""',id:56}],Yr=t=>$0.find(e=>e.id===t).formatCode,vi=[{value:Yr(0),label:P("general"),disabled:!1},{value:Yr(2),label:P("number"),disabled:!1},{value:Yr(8),label:P("currency"),disabled:!1},{value:Yr(44),label:P("accounting"),disabled:!1},{value:P("short-date-format"),label:P("short-date"),disabled:!1},{value:P("long-date-format"),label:P("long-date"),disabled:!1},{value:P("time-format"),label:P("time"),disabled:!1},{value:Yr(10),label:P("percentage"),disabled:!1},{value:Yr(12),label:P("fraction"),disabled:!1},{value:Yr(11),label:P("scientific"),disabled:!1},{value:Yr(49),label:P("text"),disabled:!1}],IL={value:"",displayValue:"",row:0,col:0,left:sr,top:sr,width:0,height:0,defineName:"",rowCount:1,colCount:1},ql=new pi(IL),Qt=new pi({editorStatus:rr.NONE,canRedo:!1,canUndo:!1,activeUuid:"",currentSheetId:"",isFilter:!1}),_i=new pi([]),Kl=new pi({scrollTop:0,scrollLeft:0,top:0,left:0,showBottomBar:!1}),Dm=new pi([]),Om=new pi([]),bL={isBold:!1,isItalic:!1,isStrike:!1,fontColor:it("contentColor"),fontSize:no,fontFamily:"",fillColor:"",isWrapText:!1,underline:Ze.NONE,verticalAlign:Et.TOP,horizontalAlign:wt.LEFT,numberFormat:Xi,isMergeCell:!1,mergeType:""},Jl=new pi(bL);T.createContext({isServer:!1,controller:null});function jk(t,e=!0){const n={};return t!=null&&t.isItalic&&(n.fontStyle="italic"),t!=null&&t.isBold&&(n.fontWeight="bold"),t!=null&&t.fontFamily&&(n.fontFamily=t==null?void 0:t.fontFamily),t!=null&&t.fontSize&&!e&&(n.fontSize=t==null?void 0:t.fontSize),t!=null&&t.fillColor&&!e&&(n.backgroundColor=t.fillColor),t!=null&&t.fontColor&&!e&&(n.color=t==null?void 0:t.fontColor),t!=null&&t.underline&&(t!=null&&t.isStrike)?n.textDecorationLine="underline line-through":t!=null&&t.underline?n.textDecorationLine="underline":t!=null&&t.isStrike&&(n.textDecorationLine="line-through"),n}function TL(t,e,n){if(e===rr.NONE)return;const r=e===rr.EDIT_FORMULA_BAR,s=jk(n,r);return r?s:{...s,top:t.top,left:t.left,width:t.width,height:t.height}}const Wk=1;function Dh(t){return Math.max(Math.min(_O,t),Wk)}const Vk=T.memo(({initValue:t,style:e,testId:n,isMergeCell:r,controller:s,className:i})=>{const o=T.useRef(null),[a,l]=T.useState(Wk);T.useEffect(()=>{var d;if(r){const u=t.split(Hn).length;l(Dh(u))}else{const u=Math.ceil((((d=o.current)==null?void 0:d.scrollHeight)||20)/20);l(Dh(u))}},[r,t]);const c=T.useCallback(d=>{if(d.stopPropagation(),d.key==="Enter"||d.key==="Tab"){let u=d.currentTarget.value;const{range:f,isMerged:h}=s.getActiveRange(),p=s.getCell(f);typeof(p==null?void 0:p.value)=="string"&&R0(h,p==null?void 0:p.value)&&(u=u.replaceAll(kc,Hn)),s.transaction(()=>{s.setCellValue(u,f),d.key==="Enter"?s.setNextActiveCell("down"):s.setNextActiveCell("right")}),Qt.setState({editorStatus:rr.NONE}),d.currentTarget.value="",d.currentTarget.blur()}else{const u=Math.ceil(d.currentTarget.scrollHeight/20);l(Dh(u))}},[]);return S.jsx("textarea",{spellCheck:!0,autoFocus:!0,ref:o,style:e,maxLength:Wl*100,"data-testid":n,"data-role":vk,onKeyDown:c,className:Fe(Zr["formula-editor"],i),defaultValue:t,rows:a})});Vk.displayName="MultipleLineEditor";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Gk=Symbol("Comlink.proxy"),RL=Symbol("Comlink.endpoint"),ML=Symbol("Comlink.releaseProxy"),Oh=Symbol("Comlink.finalizer"),Wu=Symbol("Comlink.thrown"),Xk=t=>typeof t=="object"&&t!==null||typeof t=="function",NL={canHandle:t=>Xk(t)&&t[Gk],serialize(t){const{port1:e,port2:n}=new MessageChannel;return qk(t,e),[n,[n]]},deserialize(t){return t.start(),Jk(t)}},AL={canHandle:t=>Xk(t)&&Wu in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},Yk=new Map([["proxy",NL],["throw",AL]]);function DL(t,e){for(const n of t)if(e===n||n==="*"||n instanceof RegExp&&n.test(e))return!0;return!1}function qk(t,e=globalThis,n=["*"]){e.addEventListener("message",function r(s){if(!s||!s.data)return;if(!DL(n,s.origin)){console.warn(`Invalid origin '${s.origin}' for comlink proxy`);return}const{id:i,type:o,path:a}=Object.assign({path:[]},s.data),l=(s.data.argumentList||[]).map(Ci);let c;try{const d=a.slice(0,-1).reduce((f,h)=>f[h],t),u=a.reduce((f,h)=>f[h],t);switch(o){case"GET":c=u;break;case"SET":d[a.slice(-1)[0]]=Ci(s.data.value),c=!0;break;case"APPLY":c=u.apply(d,l);break;case"CONSTRUCT":{const f=new u(...l);c=U0(f)}break;case"ENDPOINT":{const{port1:f,port2:h}=new MessageChannel;qk(t,h),c=ex(f,[f])}break;case"RELEASE":c=void 0;break;default:return}}catch(d){c={value:d,[Wu]:0}}Promise.resolve(c).catch(d=>({value:d,[Wu]:0})).then(d=>{const[u,f]=Hd(d);e.postMessage(Object.assign(Object.assign({},u),{id:i}),f),o==="RELEASE"&&(e.removeEventListener("message",r),Kk(e),Oh in t&&typeof t[Oh]=="function"&&t[Oh]())}).catch(d=>{const[u,f]=Hd({value:new TypeError("Unserializable return value"),[Wu]:0});e.postMessage(Object.assign(Object.assign({},u),{id:i}),f)})}),e.start&&e.start()}function OL(t){return t.constructor.name==="MessagePort"}function Kk(t){OL(t)&&t.close()}function Jk(t,e){const n=new Map;return t.addEventListener("message",function(s){const{data:i}=s;if(!i||!i.id)return;const o=n.get(i.id);if(o)try{o(i)}finally{n.delete(i.id)}}),Lm(t,n,[],e)}function pu(t){if(t)throw new Error("Proxy has been released and is not useable")}function Qk(t){return ho(t,new Map,{type:"RELEASE"}).then(()=>{Kk(t)})}const Ud=new WeakMap,Bd="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(Ud.get(t)||0)-1;Ud.set(t,e),e===0&&Qk(t)});function LL(t,e){const n=(Ud.get(e)||0)+1;Ud.set(e,n),Bd&&Bd.register(t,e,t)}function FL(t){Bd&&Bd.unregister(t)}function Lm(t,e,n=[],r=function(){}){let s=!1;const i=new Proxy(r,{get(o,a){if(pu(s),a===ML)return()=>{FL(i),Qk(t),e.clear(),s=!0};if(a==="then"){if(n.length===0)return{then:()=>i};const l=ho(t,e,{type:"GET",path:n.map(c=>c.toString())}).then(Ci);return l.then.bind(l)}return Lm(t,e,[...n,a])},set(o,a,l){pu(s);const[c,d]=Hd(l);return ho(t,e,{type:"SET",path:[...n,a].map(u=>u.toString()),value:c},d).then(Ci)},apply(o,a,l){pu(s);const c=n[n.length-1];if(c===RL)return ho(t,e,{type:"ENDPOINT"}).then(Ci);if(c==="bind")return Lm(t,e,n.slice(0,-1));const[d,u]=qw(l);return ho(t,e,{type:"APPLY",path:n.map(f=>f.toString()),argumentList:d},u).then(Ci)},construct(o,a){pu(s);const[l,c]=qw(a);return ho(t,e,{type:"CONSTRUCT",path:n.map(d=>d.toString()),argumentList:l},c).then(Ci)}});return LL(i,t),i}function PL(t){return Array.prototype.concat.apply([],t)}function qw(t){const e=t.map(Hd);return[e.map(n=>n[0]),PL(e.map(n=>n[1]))]}const Zk=new WeakMap;function ex(t,e){return Zk.set(t,e),t}function U0(t){return Object.assign(t,{[Gk]:!0})}function Hd(t){for(const[e,n]of Yk)if(n.canHandle(t)){const[r,s]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},s]}return[{type:"RAW",value:t},Zk.get(t)||[]]}function Ci(t){switch(t.type){case"HANDLER":return Yk.get(t.name).deserialize(t.value);case"RAW":return t.value}}function ho(t,e,n,r){return new Promise(s=>{const i=$L();e.set(i,s),t.start&&t.start(),t.postMessage(Object.assign({id:i},n),r)})}function $L(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}class UL{constructor(e,n){H(this,"controller");H(this,"canvas");H(this,"renderCallback",e=>{const{rowMap:n,colMap:r}=e,s=Object.keys(n);Object.keys(r).length===0&&s.length===0||this.controller.transaction(()=>{for(const[o,a]of Object.entries(n)){const l=parseInt(o,10);this.controller.setRowHeight(l,a)}for(const[o,a]of Object.entries(r)){const l=parseInt(o,10);this.controller.setColWidth(l,a)}})});var i;this.controller=e,this.canvas=n;const r=(i=n==null?void 0:n.transferControlToOffscreen)==null?void 0:i.call(n),s=this.controller.getHooks().worker;if(r){const o={canvas:r,dpr:Gl()};s.init(ex(o,[o.canvas]))}}async render(e){const{controller:n}=this,r=n.getCurrentSheetId(),s=n.getSheetInfo(r);if(!s)return;const i=n.getCopyRange(),o=n.toJSON(),a={changeSet:e.changeSet,theme:D0(),canvasSize:zn.get(),headerSize:ar.get(),currentSheetInfo:s,scroll:n.getScroll(r),range:n.getActiveRange().range,copyRange:i,currentMergeCells:n.getMergeCellList(r),customHeight:o.customHeight,customWidth:o.customWidth,sheetData:o.worksheets,autoFilter:o.autoFilter[r]};this.controller.getHooks().worker.render(a,U0(this.renderCallback))}resize(){const{canvas:e}=this,{width:n,height:r}=zn.get();e.style.width=`${n}px`,e.style.height=`${r}px`;const s={width:n,height:r};this.controller.getHooks().worker.resize(s)}}function Kw(t){t.transaction(()=>{Ds(t),t.setNextActiveCell("right"),zd(t)})}function Jw(t){t.transaction(()=>{Ds(t),t.setNextActiveCell("down"),zd(t)})}function tx(t,e,n){const r=t.getScroll();let{row:s,col:i}=r;if(r.top!==n){s=0;let o=n;for(;o>0;){const a=t.getRowHeight(s);if(a>o)break;o-=a,s++}}if(r.left!==e){i=0;let o=e;for(;o>0;){const a=t.getColWidth(i);if(a>o)break;o-=a,i++}}return{row:s,col:i}}function BL(t){const e=`div[data-testid="${Sk}${t}"]`,n=document.querySelector(e);n&&typeof n.scrollIntoView=="function"&&n.scrollIntoView()}function Lh(t,e){t.transaction(()=>{const n=e.sheetId||t.getCurrentSheetId();n!==t.getCurrentSheetId()&&t.setCurrentSheetId(n);const r=t.getSheetInfo(n);if(!r||e.row<0||e.col<0||e.row>=r.rowCount||e.col>=r.colCount)return!0;const s=t.getScroll(n),i=t.computeCellPosition({row:s.row,col:s.col,colCount:1,rowCount:1,sheetId:n}),o=zn.get(),a=ar.get(),{top:l,left:c}=t.computeCellPosition(e),d=i.top,u=i.left,f=i.top+o.height-a.height,h=i.left+o.width-a.width;if(l>=d&&l<f&&c>=u&&c<=h)return t.setActiveRange(e),!0;const p=t.computeCellPosition(t.getActiveRange().range);return Ri(t,c-p.left,l-p.top),t.setActiveRange(e),!0})}function Ri(t,e,n){const r=t.getScroll(),s=L0(),{maxHeight:i,maxWidth:o,maxScrollHeight:a,maxScrollWidth:l}=s;let c=r.top+Math.ceil(n),d=r.left+Math.ceil(e);c<0?c=0:c>i&&(c=i),d<0?d=0:d>o&&(d=o);const u=Math.floor(c*a/i),f=Math.floor(d*l/o),{row:h,col:p}=tx(t,d,c),m={left:d,top:c,scrollLeft:f,scrollTop:u,row:h,col:p};t.setScroll(m)}function zd(t){const e=t.getActiveRange().range,n={row:e.row,col:e.col,colCount:1,rowCount:1,sheetId:""},r=t.computeCellPosition(n),s=t.getCellSize(n),i=zn.get(),o=t.getScroll(),a=t.getSheetInfo(t.getCurrentSheetId()),l=ar.get(),c=5,d=L0(),{maxHeight:u,maxWidth:f,maxScrollHeight:h,maxScrollWidth:p}=d;if(r.left+s.width+c>i.width&&o.col<=a.colCount-2){const m=o.left+t.getCol(o.col).len,_=Math.floor(m*p/f);t.setScroll({...o,col:o.col+1,left:m,scrollLeft:_})}if(r.left-l.width<i.left+c&&o.col>=1){const m=o.left-t.getCol(o.col).len,_=Math.floor(m*p/f);t.setScroll({...o,col:o.col-1,left:m,scrollLeft:_})}if(r.top+s.height+c>i.height&&o.row<=a.rowCount-2){const m=o.top+t.getRowHeight(o.row),_=Math.floor(m*h/u);t.setScroll({...o,row:o.row+1,top:m,scrollTop:_})}if(r.top-l.height<i.top+c&&o.row>=1){const m=o.top-t.getRowHeight(o.row),_=Math.floor(m*h/u);t.setScroll({...o,row:o.row-1,top:m,scrollTop:_})}}function wn(){const t=document.activeElement;return!(!t||t.getAttribute("data-role")!==vk)}function nx(t){const e=document.activeElement,{range:n,isMerged:r}=t.getActiveRange(),s=t.getCell(n);let i=e.value;typeof(s==null?void 0:s.value)=="string"&&R0(r,s==null?void 0:s.value)&&(i=i.replaceAll(kc,Hn)),t.setCellValue(i,n),e.value="",e.blur(),Qt.setState({editorStatus:rr.NONE})}function Ds(t){wn()&&nx(t)}const Nr=[PO()?"meta":"ctrl"],HL=[{key:"Enter",modifierKey:[],handler:Jw},{key:"Tab",modifierKey:[],handler:Kw},{key:"ArrowDown",modifierKey:Nr,handler:t=>{wn()||t.transaction(()=>{Ds(t);const e=Ti.get();return Ri(t,0,e.height),!0})}},{key:"ArrowUp",modifierKey:Nr,handler:t=>{wn()||t.transaction(()=>{Ds(t);const e=Ti.get();return Ri(t,0,-e.height),!0})}},{key:"ArrowRight",modifierKey:Nr,handler:t=>{wn()||t.transaction(()=>{Ds(t);const e=Ti.get();return Ri(t,e.width,0),!0})}},{key:"ArrowLeft",modifierKey:Nr,handler:t=>{wn()||t.transaction(()=>{Ds(t);const e=Ti.get();return Ri(t,-e.width,0),!0})}},{key:"ArrowDown",modifierKey:[],handler:t=>{wn()||Jw(t)}},{key:"ArrowUp",modifierKey:[],handler:t=>{wn()||t.transaction(()=>(Ds(t),t.setNextActiveCell("up"),zd(t),!0))}},{key:"ArrowRight",modifierKey:[],handler:t=>{wn()||Kw(t)}},{key:"ArrowLeft",modifierKey:[],handler:t=>{wn()||t.transaction(()=>(Ds(t),t.setNextActiveCell("left"),zd(t),!0))}},{key:"b",modifierKey:Nr,handler:t=>{if(wn())return;const e=t.getCell(t.getActiveRange().range);t.updateCellStyle({isBold:!(e!=null&&e.isBold)},t.getActiveRange().range)}},{key:"i",modifierKey:Nr,handler:t=>{if(wn())return;const e=t.getCell(t.getActiveRange().range);t.updateCellStyle({isItalic:!(e!=null&&e.isItalic)},t.getActiveRange().range)}},{key:"5",modifierKey:Nr,handler:t=>{if(wn())return;const e=t.getCell(t.getActiveRange().range);t.updateCellStyle({isStrike:!(e!=null&&e.isStrike)},t.getActiveRange().range)}},{key:"u",modifierKey:Nr,handler:t=>{if(wn())return;const e=t.getCell(t.getActiveRange().range),n=e==null?void 0:e.underline;let r=Ze.NONE;n===void 0||n===Ze.NONE?r=Ze.SINGLE:r=Ze.NONE,t.updateCellStyle({underline:r},t.getActiveRange().range)}},{key:"z",modifierKey:Nr,handler:t=>{t.undo()}},{key:"y",modifierKey:Nr,handler:t=>{t.redo()}}];function za(t){var n,r;const e=(r=(n=t==null?void 0:t.target)==null?void 0:n.tagName)==null?void 0:r.toLowerCase();return e==="input"||e==="textarea"}function zL(t,e){function n(l){if(za(l))return;const c=HL.filter(u=>u.key===l.key);c.sort((u,f)=>f.modifierKey.length-u.modifierKey.length);let d;for(const u of c)if(u.modifierKey.length>0){if(u.modifierKey.some(f=>l[`${f}Key`])){d=u;break}}else{d=u;break}if(d){l.preventDefault(),d.handler(t);return}l.metaKey||l.ctrlKey||Qt.setState({editorStatus:rr.EDIT_CELL})}const r=TO(l=>{var d,u;(((u=(d=l==null?void 0:l.target)==null?void 0:d.tagName)==null?void 0:u.toLowerCase())==="canvas"||FO())&&Ri(t,l.deltaX,l.deltaY)},1e3/60);function s(l){za(l)||(l.preventDefault(),t.paste(l))}function i(l){za(l)||(l.preventDefault(),t.copy(l))}function o(l){za(l)||(l.preventDefault(),t.cut(l))}function a(l){za(l)||Ak().then(c=>{const d=t.getCopyRange();let u;if(c[Kt]){const f=c[Kt];u=!f.floatElementUuid&&f.range?f.range:void 0,t.setFloatElementUuid(f.floatElementUuid)}else t.setFloatElementUuid("");Of(u,d)||(t.setCopyRange(u),Lf.emit("modelChange",{changeSet:new Set(["cellStyle"])}))})}return window.addEventListener("resize",e),document.body.addEventListener("keydown",n),document.body.addEventListener("wheel",r),document.body.addEventListener("paste",s),document.body.addEventListener("copy",i),document.body.addEventListener("cut",o),window.addEventListener("focus",a),()=>{window.removeEventListener("resize",e),document.body.removeEventListener("keydown",n),document.body.removeEventListener("wheel",r),document.body.removeEventListener("paste",s),document.body.removeEventListener("copy",i),document.body.removeEventListener("cut",o),window.removeEventListener("focus",a)}}let mu;function jL(t,e){return mu||(mu=new UL(t,e),mu)}const WL="_buttonWrapper_16zfq_1",VL="_circle_16zfq_15",GL="_disabled_16zfq_18",XL="_active_16zfq_23",YL="_plain_16zfq_26",qL="_primary_16zfq_30",lo={buttonWrapper:WL,circle:VL,disabled:GL,active:XL,plain:YL,primary:qL},ee=T.memo(t=>{const{className:e="",onClick:n=RO,disabled:r=!1,active:s=!1,type:i="normal",style:o,testId:a,title:l,dataType:c,buttonType:d,children:u}=t,f=Fe(lo.buttonWrapper,e,{[lo.disabled]:r,[lo.active]:s,[lo.circle]:i==="circle",[lo.plain]:i==="plain",[lo.primary]:i==="primary"});return S.jsx("button",{onClick:n,style:o,title:l,disabled:r,className:f,"data-testid":a,"data-type":c,type:d,children:u})});ee.displayName="Button";const KL="_githubWrapper_10ifg_1",JL={githubWrapper:KL},Qw={transformOrigin:"130px 106px"},rx=T.memo(()=>S.jsx("a",{href:"https://github.com/nusr/excel","aria-label":"View source on Github",target:"_blank",title:"github link",rel:"noreferrer",children:S.jsxs("svg",{className:JL.githubWrapper,viewBox:"0 0 250 250","aria-hidden":!0,children:[S.jsx("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}),S.jsx("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:Qw}),S.jsx("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",style:Qw})]})}));rx.displayName="Github";const QL={alignCenter:["M142.2 227.6h739.6v56.9H142.2zM142.2 568.9h739.6v56.9H142.2zM256 398.2h512v56.9H256zM256 739.6h512v56.9H256z"],alignLeft:["M627.712 788.48c11.305 0 20.48-9.155 20.48-20.48s-9.175-20.48-20.48-20.48H218.46c-11.305 0-20.48 9.155-20.48 20.48s9.175 20.48 20.48 20.48h409.252zM832.86 583.68h-614.4c-11.305 0-20.48 9.155-20.48 20.48s9.175 20.48 20.48 20.48h614.4c11.305 0 20.48-9.155 20.48-20.48s-9.175-20.48-20.48-20.48zM832.86 256h-614.4c-11.305 0-20.48 9.155-20.48 20.48s9.175 20.48 20.48 20.48h614.4c11.305 0 20.48-9.155 20.48-20.48S844.165 256 832.86 256zM218.46 460.8h409.252c11.305 0 20.48-9.155 20.48-20.48s-9.175-20.48-20.48-20.48H218.46c-11.305 0-20.48 9.155-20.48 20.48s9.155 20.48 20.48 20.48z"],alignRight:["M832.86 747.52H423.588a20.48 20.48 0 1 0 0 40.96H832.84a20.48 20.48 0 0 0 0.02-40.96z m20.48-143.36a20.48 20.48 0 0 0-20.48-20.48h-614.4a20.48 20.48 0 1 0 0 40.96h614.4a20.48 20.48 0 0 0 20.48-20.48zM832.86 256h-614.4a20.48 20.48 0 1 0 0 40.96h614.4a20.48 20.48 0 1 0 0-40.96z m0 163.84H423.588a20.48 20.48 0 1 0 0 40.96H832.84a20.48 20.48 0 0 0 0.02-40.96z"],bold:["M724.342857 477.028571c38.4-40 61.942857-94.057143 61.942857-153.485714v-11.657143C786.285714 188.914286 685.6 89.142857 561.485714 89.142857H223.314286c-17.257143 0-31.314286 14.057143-31.314286 31.314286v776.114286c0 18.628571 15.085714 33.714286 33.714286 33.714285h364.228571c133.714286 0 242.057143-107.657143 242.057143-240.571428v-12.571429c0-83.428571-42.742857-156.914286-107.657143-200.114286zM301.714286 198.857143h256.8c65.257143 0 118.057143 50.742857 118.057143 113.485714v10.857143c0 62.628571-52.914286 113.485714-118.057143 113.485714H301.714286V198.857143z m418.971428 490.742857c0 71.885714-59.085714 130.171429-132 130.171429H301.714286V547.085714h286.971428c72.914286 0 132 58.285714 132 130.171429v12.342857z"],fontColor:["M650.496 597.333333H373.504l-68.266667 170.666667H213.333333l256-640h85.333334l256 640h-91.904l-68.266667-170.666667z m-34.133333-85.333333L512 251.093333 407.637333 512h208.725334zM128 853.333333h768v85.333334H128v-85.333334z"],italic:["M219.428571 949.714286l9.714286-48.571429q3.428571-1.142857 46.571429-12.285714t63.714286-21.428571q16-20 23.428571-57.714286 0.571429-4 35.428571-165.142857t65.142857-310.571429 29.714286-169.428571l0-14.285714q-13.714286-7.428571-31.142857-10.571429t-39.714286-4.571429-33.142857-3.142857l10.857143-58.857143q18.857143 1.142857 68.571429 3.714286t85.428571 4 68.857143 1.428571q27.428571 0 56.285714-1.428571t69.142857-4 56.285714-3.714286q-2.857143 22.285714-10.857143 50.857143-17.142857 5.714286-58 16.285714t-62 19.142857q-4.571429 10.857143-8 24.285714t-5.142857 22.857143-4.285714 26-3.714286 24q-15.428571 84.571429-50 239.714286t-44.285714 203.142857q-1.142857 5.142857-7.428571 33.142857t-11.428571 51.428571-9.142857 47.714286-3.428571 32.857143l0.571429 10.285714q9.714286 2.285714 105.714286 17.714286-1.714286 25.142857-9.142857 56.571429-6.285714 0-18.571429 0.857143t-18.571429 0.857143q-16.571429 0-49.714286-5.714286t-49.142857-5.714286q-78.857143-1.142857-117.714286-1.142857-29.142857 0-81.714286 5.142857t-69.142857 6.285714z"],middleAlign:["M740.43392 788.48c11.30496 0 20.48-9.15456 20.48-20.48s-9.17504-20.48-20.48-20.48L331.18208 747.52c-11.30496 0-20.48 9.15456-20.48 20.48s9.17504 20.48 20.48 20.48L740.43392 788.48zM863.49824 604.16c0-11.32544-9.17504-20.48-20.48-20.48l-614.4 0c-11.30496 0-20.48 9.15456-20.48 20.48s9.17504 20.48 20.48 20.48l614.4 0C854.3232 624.64 863.49824 615.48544 863.49824 604.16zM208.13824 276.48c0 11.32544 9.17504 20.48 20.48 20.48l614.4 0c11.30496 0 20.48-9.15456 20.48-20.48s-9.17504-20.48-20.48-20.48l-614.4 0C217.2928 256 208.13824 265.15456 208.13824 276.48zM740.43392 460.8c11.30496 0 20.48-9.15456 20.48-20.48s-9.17504-20.48-20.48-20.48L331.18208 419.84c-11.30496 0-20.48 9.15456-20.48 20.48s9.17504 20.48 20.48 20.48L740.43392 460.8z"],plus:["M896 468.571429H555.428571V100.571429h-86.857142v368H128c-5.028571 0-9.142857 4.114286-9.142857 9.142857v68.571428c0 5.028571 4.114286 9.142857 9.142857 9.142857h340.571429v368h86.857142V555.428571h340.571429c5.028571 0 9.142857-4.114286 9.142857-9.142857v-68.571428c0-5.028571-4.114286-9.142857-9.142857-9.142857z"],redo:["M611.783111 569.344L549.622519 644.740741h284.444444l-65.498074-265.481482-59.922963 72.666074c-35.422815-28.48237-108.278519-68.342519-238.667852-68.342518-202.827852 0-280.651852 206.01363-280.651852 206.013629s116.318815-132.778667 246.215111-132.778666c97.204148-0.037926 153.865481 74.827852 176.241778 112.526222z"],underline:["M512 725.333333c166.4 0 298.666667-132.266667 298.666667-298.666666V128c0-25.6-17.066667-42.666667-42.666667-42.666667s-42.666667 17.066667-42.666667 42.666667v298.666667c0 119.466667-93.866667 213.333333-213.333333 213.333333s-213.333333-93.866667-213.333333-213.333333V128c0-25.6-17.066667-42.666667-42.666667-42.666667s-42.666667 17.066667-42.666667 42.666667v298.666667c0 166.4 132.266667 298.666667 298.666667 298.666666zM853.333333 853.333333H170.666667c-25.6 0-42.666667 17.066667-42.666667 42.666667s17.066667 42.666667 42.666667 42.666667h682.666666c25.6 0 42.666667-17.066667 42.666667-42.666667s-17.066667-42.666667-42.666667-42.666667z"],undo:["M489.244444 568.888889l60.681482 75.851852H265.481481l64.474075-265.481482 60.681481 72.05926c34.133333-30.340741 109.985185-68.266667 238.933333-68.266667 201.007407 0 280.651852 204.8 280.651852 204.8S792.651852 455.111111 663.703704 455.111111c-98.607407 0-155.496296 75.851852-174.45926 113.777778z"],success:["M666.272 472.288l-175.616 192a31.904 31.904 0 0 1-23.616 10.4h-0.192a32 32 0 0 1-23.68-10.688l-85.728-96a32 32 0 1 1 47.744-42.624l62.144 69.6 151.712-165.888a32 32 0 1 1 47.232 43.2m-154.24-344.32C300.224 128 128 300.32 128 512c0 211.776 172.224 384 384 384 211.68 0 384-172.224 384-384 0-211.68-172.32-384-384-384"],info:["M512 97.52381c228.912762 0 414.47619 185.563429 414.47619 414.47619s-185.563429 414.47619-414.47619 414.47619S97.52381 740.912762 97.52381 512 283.087238 97.52381 512 97.52381z m36.571429 341.333333h-73.142858v292.571428h73.142858V438.857143z m0-121.904762h-73.142858v73.142857h73.142858v-73.142857z"],warning:["M512 64q190.016 4.992 316.512 131.488T960 512q-4.992 190.016-131.488 316.512T512 960q-190.016-4.992-316.512-131.488T64 512q4.992-190.016 131.488-316.512T512 64z m0 192q-26.016 0-43.008 19.008T453.984 320l23.008 256q2.016 14.016 11.488 22.496t23.488 8.512 23.488-8.512 11.488-22.496l23.008-256q2.016-26.016-15.008-44.992T511.936 256z m0 512q22.016-0.992 36.512-15.008t14.496-36-14.496-36.512T512 665.984t-36.512 14.496-14.496 36.512 14.496 36T512 768z"],error:["M512 97.52381c228.912762 0 414.47619 185.563429 414.47619 414.47619s-185.563429 414.47619-414.47619 414.47619S97.52381 740.912762 97.52381 512 283.087238 97.52381 512 97.52381z m129.29219 233.447619l-129.267809 129.29219-129.316571-129.29219-51.736381 51.736381 129.316571 129.267809-129.316571 129.316571 51.736381 51.736381L512 563.687619l129.29219 129.316571 51.736381-51.73638L563.687619 512l129.316571-129.29219-51.73638-51.736381z"],rotate:["M934.08 416.448h-220.352a46.4 46.4 0 0 1-47.232-47.232c0-26.752 20.48-47.232 47.232-47.232h173.184V148.8c0-26.752 20.48-47.168 47.168-47.168 26.816 0 47.232 20.48 47.232 47.168V369.28a47.36 47.36 0 0 1-47.232 47.232z","M509.056 978.432A470.976 470.976 0 0 1 38.4 507.712 470.976 470.976 0 0 1 509.056 37.12a472.32 472.32 0 0 1 434.56 288.064c9.408 23.68-1.6 51.968-25.216 61.44-23.68 9.408-51.968-1.6-61.44-25.216a377.92 377.92 0 0 0-347.904-229.824 376.192 376.192 0 1 0 0 752.448c190.528 0 351.104-141.696 373.12-328.96a47.36 47.36 0 0 1 51.904-40.96 47.36 47.36 0 0 1 40.96 51.904 469.504 469.504 0 0 1-465.92 412.48z"],moon:["M735.996 244.2C693.136 221.106 644.1 208 592 208c-167.894 0-304 136.106-304 304s136.106 304 304 304c52.1 0 101.136-13.106 143.996-36.2C621.368 744.742 538 638.108 538 512s83.368-232.742 197.996-267.8z m26.32 86.064C683.17 354.472 628 427.888 628 512s55.168 157.528 134.318 181.736c76.442 23.378 86.74 127.376 16.37 165.294C721.764 889.702 657.958 906 592 906c-217.6 0-394-176.4-394-394S374.4 118 592 118c65.96 0 129.764 16.298 186.688 46.97 70.372 37.918 60.072 141.916-16.37 165.294z"],sun:["M512 768c-140.8 0-256-115.2-256-256s115.2-256 256-256 256 115.2 256 256-115.2 256-256 256z m0-426.666667c-93.866667 0-170.666667 76.8-170.666667 170.666667s76.8 170.666667 170.666667 170.666667 170.666667-76.8 170.666667-170.666667-76.8-170.666667-170.666667-170.666667zM512 170.666667c-25.6 0-42.666667-17.066667-42.666667-42.666667V42.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667v85.333333c0 25.6-17.066667 42.666667-42.666667 42.666667zM512 1024c-25.6 0-42.666667-17.066667-42.666667-42.666667v-85.333333c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667v85.333333c0 25.6-17.066667 42.666667-42.666667 42.666667zM238.933333 281.6c-12.8 0-21.333333-4.266667-29.866666-12.8L149.333333 209.066667c-17.066667-17.066667-17.066667-42.666667 0-59.733334s42.666667-17.066667 59.733334 0l59.733333 59.733334c17.066667 17.066667 17.066667 42.666667 0 59.733333-4.266667 8.533333-17.066667 12.8-29.866667 12.8zM844.8 887.466667c-12.8 0-21.333333-4.266667-29.866667-12.8l-59.733333-59.733334c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l59.733334 59.733333c17.066667 17.066667 17.066667 42.666667 0 59.733334-8.533333 8.533333-21.333333 12.8-29.866667 12.8zM128 554.666667H42.666667c-25.6 0-42.666667-17.066667-42.666667-42.666667s17.066667-42.666667 42.666667-42.666667h85.333333c25.6 0 42.666667 17.066667 42.666667 42.666667s-17.066667 42.666667-42.666667 42.666667zM981.333333 554.666667h-85.333333c-25.6 0-42.666667-17.066667-42.666667-42.666667s17.066667-42.666667 42.666667-42.666667h85.333333c25.6 0 42.666667 17.066667 42.666667 42.666667s-17.066667 42.666667-42.666667 42.666667zM179.2 887.466667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733334l59.733334-59.733333c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-59.733333 59.733334c-8.533333 8.533333-17.066667 12.8-29.866667 12.8zM785.066667 281.6c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l59.733333-59.733334c17.066667-17.066667 42.666667-17.066667 59.733334 0s17.066667 42.666667 0 59.733334l-59.733334 59.733333c-8.533333 8.533333-21.333333 12.8-29.866666 12.8z"],down:["M512.146286 619.52L245.296762 352.792381 193.584762 404.48l318.585905 318.415238 318.268952-318.415238-51.736381-51.687619z"],menu:["M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zM904 784H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zM904 472H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"],confirm:["M394.792 797.429c-9.71 0-19.443-3.513-27.137-10.622L87.488 527.917c-16.225-14.993-17.224-40.3-2.231-56.525 14.993-16.226 40.3-17.225 56.524-2.231l280.167 258.89c16.225 14.993 17.224 40.3 2.231 56.524-7.883 8.532-18.62 12.854-29.387 12.854z","M394.808 797.429c-10.555 0-21.088-4.15-28.949-12.391-15.249-15.984-14.652-41.304 1.333-56.553l514.564-490.858c15.983-15.249 41.303-14.652 56.553 1.333 15.248 15.985 14.651 41.305-1.334 56.553l-514.563 490.86c-7.745 7.387-17.684 11.056-27.604 11.056z"],horizontalLeft:["M484.693 477.013h-371.2a32 32 0 0 0-32 32v32a32 32 0 0 0 32 32h371.2a32 32 0 0 0 32-32v-32a32 32 0 0 0-32-32z m435.2-338.133h-806.4a32 32 0 0 0-32 31.787v32a32 32 0 0 0 32 32h806.4a32 32 0 0 0 32-32v-32a32 32 0 0 0-32-32z m0 674.133h-806.4a32 32 0 0 0-32 32v32a32 32 0 0 0 32 32h806.4a32 32 0 0 0 32-32v-32a32 32 0 0 0-32-32z"],horizontalRight:["M922.453 472.107H551.04a32 32 0 0 0-32 32v32a32 32 0 0 0 32 32h371.413a32 32 0 0 0 32-32v-32a32 32 0 0 0-32-32z m0 337.066H115.84a32 32 0 0 0-32 32v32a32 32 0 0 0 32 32h806.613a32 32 0 0 0 32-32v-32a32 32 0 0 0-32-32z m0-674.133H115.84a32 32 0 0 0-32 32v32a32 32 0 0 0 32 32h806.613a32 32 0 0 0 32-32v-32a32 32 0 0 0-32-32z"],horizontalCenter:["M697.6 472.107H326.4a32 32 0 0 0-32 32v32a32 32 0 0 0 32 32h371.2a32 32 0 0 0 32-32v-32a32 32 0 0 0-32-32zM915.2 135.04H108.8a32 32 0 0 0-32 32v32a32 32 0 0 0 32 32h806.4a32 32 0 0 0 32-32v-32a32 32 0 0 0-32-32z m0 674.133H108.8a32 32 0 0 0-32 32v32a32 32 0 0 0 32 32h806.4a32 32 0 0 0 32-32v-32a32 32 0 0 0-32-32z"],verticalTop:["M902.890667 125.482667H121.109333a9.045333 9.045333 0 0 0-9.109333 8.981333v67.413333c0 4.949333 4.053333 9.002667 9.109333 9.002667h781.781334c5.056 0 9.109333-4.053333 9.109333-9.002667v-67.413333a9.045333 9.045333 0 0 0-9.109333-8.981333z m-383.808 210.112a8.96 8.96 0 0 0-14.165334 0l-125.845333 159.210666a8.96 8.96 0 0 0 7.082667 14.506667h83.029333v380.224c0 4.928 4.053333 8.981333 9.002667 8.981333h67.413333c4.949333 0 8.981333-4.053333 8.981333-8.981333V509.418667H637.866667a8.96 8.96 0 0 0 7.082666-14.506667l-125.866666-159.317333z"],verticalMiddle:["M512 614.4l117.028571 153.6h-73.142857V950.857143H468.114286v-182.857143h-73.142857L512 614.4z m438.857143-153.6v102.4H73.142857V460.8h877.714286zM555.885714 73.142857v182.857143h73.142857L512 409.6 394.971429 256h73.142857V73.142857h87.771428z"],verticalBottom:["M902.890667 813.12H121.109333a9.045333 9.045333 0 0 0-9.109333 9.002667v67.413333c0 4.928 4.053333 8.981333 9.109333 8.981333h781.781334c5.056 0 9.109333-4.053333 9.109333-8.981333v-67.413333a9.045333 9.045333 0 0 0-9.109333-9.002667zM504.917333 688.426667a8.96 8.96 0 0 0 14.165334 0l125.845333-159.210667a8.96 8.96 0 0 0-7.082667-14.506667h-83.264V134.464a9.024 9.024 0 0 0-8.981333-8.981333h-67.413333a9.024 9.024 0 0 0-9.002667 8.981333v380.117333h-83.029333a8.96 8.96 0 0 0-7.082667 14.506667l125.866667 159.317333z"]},ZL="_baseIcon_27qkj_1",e5={baseIcon:ZL},B0=({className:t="",paths:e,testId:n})=>S.jsx("svg",{className:Fe(e5.baseIcon,t),viewBox:"0 0 1137 1024","aria-hidden":!0,"data-testid":n,children:e.map((r,s)=>S.jsx("path",{d:r.d,fillOpacity:r["fill-opacity"]},s))});B0.displayName="BaseIcon";const sx=T.memo(()=>B0({paths:[{d:"M0 0h1024v1024H0z","fill-opacity":".01"},{d:"M496.512 32a128 128 0 0 1 127.84 121.6l0.16 6.4-0.032 113.504 264.256 264.256a32 32 0 0 1-8.16 51.2l-144.064 72.96-269.12 269.12a64 64 0 0 1-90.496 0l-294.144-294.176a64 64 0 0 1 0-90.496l286.016-286.08-0.192-2.048-0.064-2.08V160a128 128 0 0 1 128-128z m-6.464 197.568L128 591.616l294.144 294.144 276.32-276.32 113.792-57.632-187.776-187.776V416a32 32 0 0 1-28.256 31.776l-3.712 0.224a32 32 0 0 1-31.808-28.256L560.512 416l-0.032-115.968-70.432-70.464z m402.016 395.936l1.792 2.24 5.472 8.416c30.112 46.752 45.184 80.032 45.184 99.84a64 64 0 1 1-128 0c0-20.96 16.864-57.024 50.624-108.224a16 16 0 0 1 24.928-2.24zM496.512 96a64 64 0 0 0-63.84 59.2l-0.16 4.8-0.032 36.576 34.944-34.88a32 32 0 0 1 45.248 0l47.808 47.808V160a64 64 0 0 0-59.2-63.84L496.48 96z"}]}));sx.displayName="FillColorIcon";const Mt=T.memo(({name:t,className:e="",testId:n})=>{const r=QL[t].map(s=>({d:s}));return B0({className:e,paths:r,testId:n})});Mt.displayName="Icon";const t5="_selectList_nyspg_1",n5="_selectItem_nyspg_6",r5="_disabled_nyspg_9",s5="_top_nyspg_32",i5="_active_nyspg_36",er={selectList:t5,selectItem:n5,disabled:r5,"popup-container":"_popup-container_nyspg_18",top:s5,active:i5,"popup-item":"_popup-item_nyspg_40","popup-item-icon":"_popup-item-icon_nyspg_50","popup-item-content":"_popup-item-content_nyspg_54","select-list-container":"_select-list-container_nyspg_59","select-list-trigger":"_select-list-trigger_nyspg_71"},Fi=T.memo(t=>{const{data:e,value:n,className:r,onChange:s,getItemStyle:i,title:o,defaultValue:a,testId:l}=t,c=T.useCallback(d=>{s(d.target.value)},[]);return S.jsx("select",{onChange:c,value:n,defaultValue:a,name:"select",className:Fe(er.selectList,r),title:o,"data-testid":l,children:e.map(d=>{const u=typeof d=="object"?d.value:d,f=typeof d=="object"?d.label:d,h=typeof d=="object"?d.disabled:!1;let p;return typeof i=="function"&&(p=i(u)),S.jsx("option",{value:u,disabled:!!h,className:Fe(er.selectItem,{[er.disabled]:h}),style:p,children:f},u)})})});Fi.displayName="Select";const H0=T.memo(({onChange:t,value:e,active:n,data:r,className:s,position:i="bottom",testId:o})=>{T.useEffect(()=>()=>{t("")},[t]);const a=T.useCallback(l=>{var d;const c=(d=l.target.dataset)==null?void 0:d.value;c&&t(c)},[t]);return S.jsx("div",{className:Fe(er["popup-container"],s,i==="top"?er.top:"",{[er.active]:n}),onClick:a,"data-testid":o,children:r.map(l=>S.jsxs("div",{className:er["popup-item"],children:[S.jsx("span",{className:er["popup-item-content"],"data-value":l.value,children:l.label}),l.value==e&&S.jsx("span",{className:er["popup-item-icon"],children:S.jsx(Mt,{name:"confirm"})})]},l.value))})});H0.displayName="SelectPopup";const jd=T.memo(({children:t,value:e,data:n,onChange:r,position:s,testId:i,className:o})=>{const[a,l]=T.useState(!1),c=T.useCallback(()=>{l(u=>!u)},[]),d=T.useCallback(u=>{l(!1),u&&r(u)},[r]);return S.jsxs("div",{className:Fe(er["select-list-container"],o,{[er.active]:a}),"data-testid":i,children:[t,S.jsx(ee,{className:er["select-list-trigger"],onClick:c,testId:`${i}-trigger`,type:"plain",children:S.jsx(Mt,{name:"down"})}),a&&n.length>0&&S.jsx(H0,{active:!0,value:e,data:n,onChange:d,position:s,testId:`${i}-popup`})]})});jd.displayName="SelectList";const co={"dialog-modal":"_dialog-modal_1hyk9_1","dialog-container":"_dialog-container_1hyk9_13","dialog-title":"_dialog-title_1hyk9_20","dialog-content":"_dialog-content_1hyk9_25","dialog-button":"_dialog-button_1hyk9_29","dialog-cancel":"_dialog-cancel_1hyk9_36"},ix=T.memo(t=>{const{children:e,title:n,className:r,onCancel:s,onOk:i,visible:o,getContainer:a=()=>document.body,testId:l}=t;if(!o)return;const c=l?`${l}-cancel`:void 0,d=l?`${l}-confirm`:void 0;return gk.createPortal(S.jsx("div",{className:co["dialog-modal"],"data-testid":l,children:S.jsxs("div",{className:Fe(co["dialog-container"],r),children:[S.jsx("div",{className:co["dialog-title"],children:n}),S.jsx("div",{className:co["dialog-content"],children:e}),S.jsxs("div",{className:co["dialog-button"],children:[S.jsx(ee,{onClick:s,testId:c,children:P("cancel")}),S.jsx(ee,{onClick:i,className:co["dialog-cancel"],type:"primary",testId:d,children:P("confirm")})]})]})}),a())});ix.displayName="Dialog";function pl(t){const e=document.createDocumentFragment();let n;function r(){n==null||n.unmount(),n=void 0}function s(o){n=n||Df(e),n.render(S.jsx(ix,{visible:o.visible,title:o.title,className:o.className,onCancel:a=>{a.stopPropagation(),o.onCancel&&o.onCancel(a),r()},onOk:a=>{a.stopPropagation(),o.onOk&&o.onOk(a),r()},testId:o.testId,children:o.children}))}function i(o){s(o)}return s(t),{close:r,update:i}}const o5="_container_uqw8i_1",a5="_portal_uqw8i_5",l5="_menuContainer_uqw8i_13",c5="_bottom_uqw8i_16",u5="_subMenuContainer_uqw8i_21",d5="_menu_uqw8i_13",f5="_small_uqw8i_35",h5="_menuItem_uqw8i_35",p5="_active_uqw8i_53",m5="_trigger_uqw8i_57",Dn={container:o5,portal:a5,menuContainer:l5,bottom:c5,subMenuContainer:u5,menu:d5,small:f5,menuItem:h5,active:p5,trigger:m5};function Rc(t,e=!0){const n=T.useRef(null);function r(s){const i=s.target;n!=null&&n.current&&(n.current===i||i instanceof Node&&n.current.contains(i))||t()}return T.useEffect(()=>{if(e)return document.addEventListener("pointerdown",r),window.addEventListener("blur",r),()=>{document.removeEventListener("pointerdown",r),window.removeEventListener("blur",r)}},[e]),n}function ox(t){const e=T.useRef(t),n=T.useRef(r=>{e.current&&e.current(r)});return e.current=t,n.current}function g5(){const[t,e]=T.useState(0);return T.useEffect(()=>{let n=0,r=performance.now(),s;function i(){n++;let o=(performance.now()-r)/1e3;if(o>1){let a=n/o;e(Math.round(a)),n=0,r=performance.now()}s=requestAnimationFrame(i)}return s=requestAnimationFrame(i),()=>{cancelAnimationFrame(s)}},[]),t}const sn=({onClick:t,children:e,testId:n,active:r=!1})=>S.jsx("li",{className:Fe(Dn.menuItem,{[Dn.active]:r}),onClick:t,"data-testid":n,children:e}),y5=({label:t,children:e,testId:n,className:r,portalClassName:s})=>{const[i,o]=T.useState(!1),a=T.useCallback(()=>{o(l=>!l)},[]);return S.jsxs("li",{className:Fe(Dn.menuItem,r),onClick:a,"data-testid":n,children:[S.jsx("div",{children:t}),i&&S.jsx("div",{className:Fe(Dn.subMenuContainer,Dn.portal,s),children:S.jsx("ul",{className:Dn.menu,children:e})})]})},z0=T.memo(({label:t,children:e,testId:n,className:r,isPlain:s=!1,position:i="right",size:o="normal",portalClassName:a})=>{const l=s?"plain":void 0,[c,d]=T.useState(!1),u=T.useCallback(()=>{d(p=>!p)},[]),f=T.useCallback(()=>{d(!1)},[]),h=Rc(f,c);return S.jsxs("div",{className:Fe(Dn.container,r,{[Dn.small]:o==="small"}),ref:h,"data-testid":n,children:[S.jsx(ee,{onClick:u,testId:`${n}-trigger`,type:l,className:Dn.trigger,children:t}),S.jsx("div",{className:Fe(Dn.menuContainer,Dn.portal,a,{[Dn.bottom]:i==="bottom"}),"data-testid":`${n}-portal`,hidden:!c,children:S.jsx("ul",{className:Dn.menu,children:e})})]})});z0.displayName="Menu";const w5="_container_ivcy9_1",S5="_content_ivcy9_7",v5="_toast_ivcy9_10",_5="_icon_ivcy9_19",C5="_success_ivcy9_22",E5="_success_icon_ivcy9_26",k5="_error_ivcy9_29",x5="_error_icon_ivcy9_33",I5="_info_ivcy9_36",b5="_info_icon_ivcy9_40",T5="_warning_ivcy9_43",R5="_warning_icon_ivcy9_47",po={container:w5,content:S5,toast:v5,icon:_5,success:C5,success_icon:E5,error:k5,error_icon:x5,info:I5,info_icon:b5,warning:T5,warning_icon:R5},M5=({message:t,type:e,testId:n})=>S.jsxs("div",{className:Fe(po.toast,po[e]),"data-testid":n,children:[S.jsx(Mt,{name:e,className:Fe(po[`${e}_icon`],po.icon)}),S.jsx("div",{className:po.content,children:t})]});function gt(t){const{duration:e=3,...n}=t;let r=document.createElement("div");r.className=po.container,document.body.appendChild(r);const s=Df(r);s.render(S.jsx(M5,{...n}));function i(){r&&(s.unmount(),document.body.removeChild(r),r=void 0)}return setTimeout(i,e*1e3),i}gt.error=function(t,e="error-toast"){return gt({message:t,type:"error",testId:e})};gt.info=function(t,e="info-toast"){return gt({message:t,type:"info",testId:e})};gt.warning=function(t,e="warning-toast"){return gt({message:t,type:"warning",testId:e})};gt.success=function(t,e="success-toast"){return gt({message:t,type:"success",testId:e})};const N5="_container_926r9_1",A5="_loading_926r9_12",D5="_rotation_926r9_1",Zw={container:N5,loading:A5,rotation:D5},ax=T.memo(()=>S.jsx("div",{className:Zw.container,children:S.jsx("div",{className:Zw.loading})}));ax.displayName="Loading";const O5="_top_18907_16",L5="_right_18907_20",F5="_reset_18907_46",Cs={"color-picker":"_color-picker_18907_1","color-picker-wrapper":"_color-picker-wrapper_18907_5",top:O5,right:L5,"color-picker-list":"_color-picker-list_18907_26","color-picker-item":"_color-picker-item_18907_32","no-fill":"_no-fill_18907_39",reset:F5},eS=(t,e=0,n=1)=>t>n?n:t<e?e:t,ys={"color-picker-panel":"_color-picker-panel_mnh2i_1","color-picker-panel__saturation":"_color-picker-panel__saturation_mnh2i_11","color-picker-panel__pointer-fill":"_color-picker-panel__pointer-fill_mnh2i_22","color-picker-panel__hue":"_color-picker-panel__hue_mnh2i_38","color-picker-panel__last-control":"_color-picker-panel__last-control_mnh2i_56","color-picker-panel__interactive":"_color-picker-panel__interactive_mnh2i_60","color-picker-panel__pointer":"_color-picker-panel__pointer_mnh2i_22","color-picker-panel__saturation-pointer":"_color-picker-panel__saturation-pointer_mnh2i_88","color-picker-panel__hue-pointer":"_color-picker-panel__hue-pointer_mnh2i_92"},P5=200,$5=234,tS=(t,e,n)=>{const r=t.getBoundingClientRect();return{left:eS((e-r.left)/(r.width||$5)),top:eS((n-r.top)/(r.height||P5))}},U5=({onMove:t,testId:e,...n})=>{const r=T.useRef(null),s=ox(t),[i,o]=T.useMemo(()=>{const a=u=>{r.current&&(u.preventDefault(),r.current.focus(),s(tS(r.current,u.clientX,u.clientY)),d(!0))},l=u=>{u.buttons<=0||r.current&&(u.preventDefault(),s(tS(r.current,u.clientX,u.clientY)))},c=()=>d(!1);function d(u){const f=u?document.body.addEventListener:document.body.removeEventListener;f("pointermove",l),f("pointerup",c)}return[a,d]},[s]);return T.useEffect(()=>o,[o]),S.jsx("div",{...n,onPointerDown:i,className:ys["color-picker-panel__interactive"],ref:r,tabIndex:0,role:"slider","data-testid":e})},lx=Qs.memo(U5),cx=({className:t,color:e,left:n,top:r=.5})=>{const s={top:`${r*100}%`,left:`${n*100}%`};return S.jsx("div",{className:Fe(ys["color-picker-panel__pointer"],t),style:s,children:S.jsx("div",{className:ys["color-picker-panel__pointer-fill"],style:{backgroundColor:e}})})},Ht=(t,e=0,n=Math.pow(10,e))=>Math.round(n*t)/n,B5=t=>{const e=H5(t);return G5(e)},H5=t=>(t[0]==="#"&&(t=t.substring(1)),t.length<6?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?Ht(parseInt(t[3]+t[3],16)/255,2):1}:{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16),a:t.length===8?Ht(parseInt(t.substring(6,8),16)/255,2):1}),z5=t=>V5(W5(t)),j5=({h:t,s:e,v:n,a:r})=>{const s=(200-e)*n/100;return{h:Ht(t),s:Ht(s>0&&s<200?e*n/100/(s<=100?s:200-s)*100:0),l:Ht(s/2),a:Ht(r,2)}},Fm=t=>{const{h:e,s:n,l:r}=j5(t);return`hsl(${e}, ${n}%, ${r}%)`},W5=({h:t,s:e,v:n,a:r})=>{t=t/360*6,e=e/100,n=n/100;const s=Math.floor(t),i=n*(1-e),o=n*(1-(t-s)*e),a=n*(1-(1-t+s)*e),l=s%6;return{r:Ht([n,o,i,i,a,n][l]*255),g:Ht([a,n,n,o,i,i][l]*255),b:Ht([i,i,a,n,n,o][l]*255),a:Ht(r,2)}},gu=t=>{const e=t.toString(16);return e.length<2?"0"+e:e},V5=({r:t,g:e,b:n,a:r})=>{const s=r<1?gu(Ht(r*255)):"";return"#"+gu(t)+gu(e)+gu(n)+s},G5=({r:t,g:e,b:n,a:r})=>{const s=Math.max(t,e,n),i=s-Math.min(t,e,n),o=i?s===t?(e-n)/i:s===e?2+(n-t)/i:4+(t-e)/i:0;return{h:Ht(60*(o<0?o+6:o)),s:Ht(s?i/s*100:0),v:Ht(s/255*100),a:r}},X5=({className:t,hue:e,testId:n,onChange:r})=>{const s=i=>{r({h:360*i.left})};return S.jsx("div",{className:Fe(ys["color-picker-panel__hue"],t),children:S.jsx(lx,{onMove:s,"aria-label":"Hue","aria-valuenow":Ht(e),"aria-valuemax":"360","aria-valuemin":"0",testId:`${n}-hue`,children:S.jsx(cx,{className:ys["color-picker-panel__hue-pointer"],left:e/360,color:Fm({h:e,s:100,v:100,a:1})})})})},Y5=Qs.memo(X5),q5=({hsva:t,testId:e,onChange:n})=>{const r=T.useCallback(i=>{n({s:i.left*100,v:100-i.top*100})},[]),s={backgroundColor:Fm({h:t.h,s:100,v:100,a:1})};return S.jsx("div",{className:ys["color-picker-panel__saturation"],style:s,children:S.jsx(lx,{onMove:r,"aria-label":"Color","aria-valuetext":`Saturation ${Ht(t.s)}%, Brightness ${Ht(t.v)}%`,testId:`${e}-saturation`,children:S.jsx(cx,{className:ys["color-picker-panel__saturation-pointer"],top:1-t.v/100,left:t.s/100,color:Fm(t)})})})},K5=Qs.memo(q5);function J5(t,e,n){const r=ox(n),[s,i]=T.useState(()=>t.toHsva(e)),o=T.useRef({color:e,hsva:s});T.useEffect(()=>{if(!t.equal(e,o.current.color)){const l=t.toHsva(e);o.current={hsva:l,color:e},i(l)}},[e,t]),T.useEffect(()=>{let l;!Of(s,o.current.hsva)&&!t.equal(l=t.fromHsva(s),o.current.color)&&(o.current={hsva:s,color:l},r(l))},[s,t,r]);const a=T.useCallback(l=>{i(c=>Object.assign({},c,l))},[]);return[s,a]}const Q5=({className:t,colorModel:e,color:n,onChange:r,testId:s})=>{const[i,o]=J5(e,n||e.defaultColor,r);return S.jsxs("div",{className:Fe(ys["color-picker-panel"],t),children:[S.jsx(K5,{hsva:i,onChange:o,testId:s}),S.jsx(Y5,{hue:i.h,onChange:o,className:ys["color-picker-panel__last-control"],testId:s})]})},Z5={defaultColor:"#000",toHsva:B5,fromHsva:({h:t,s:e,v:n})=>z5({h:t,s:e,v:n,a:1}),equal:(t,e)=>{const n=Mm(t),r=Mm(e);return n===r}},e7=T.memo(t=>S.jsx(Q5,{className:t.className,color:t.color,onChange:t.onChange,testId:t.testId,colorModel:Z5})),Ql=T.memo(t=>{const{onChange:e,children:n,color:r,position:s="bottom",testId:i,className:o}=t,[a,l]=T.useState(!1),c=Rc(()=>{l(!1)},a),d=T.useCallback(()=>{l(!0)},[]),u=T.useCallback(()=>{e("")},[]),f=T.useCallback(h=>{var m,_;const p=(_=(m=h.target)==null?void 0:m.dataset)==null?void 0:_.value;p&&e(p)},[]);return S.jsxs("div",{className:Fe(Cs["color-picker"],o,{[Cs.top]:s==="top",[Cs.right]:s==="right"}),ref:c,children:[S.jsx("div",{className:Cs["color-picker-trigger"],onClick:d,"data-testid":`${i}-trigger`,children:n}),a&&S.jsxs("div",{className:Fe(Cs["color-picker-wrapper"]),children:[S.jsx("div",{className:Cs["color-picker-list"],onClick:f,"data-testid":`${i}-list`,children:km.map(h=>S.jsx("div",{className:Cs["color-picker-item"],style:{backgroundColor:h},"data-value":h},h))}),S.jsx("div",{children:S.jsx(e7,{color:r,onChange:e,testId:i})}),S.jsx("div",{children:S.jsx(ee,{type:"normal",className:Cs.reset,onClick:u,testId:`${i}-reset`,children:P("reset")})})]})]})});Ql.displayName="ColorPicker";const ux=T.memo(({controller:t,displayName:e,defineName:n})=>{const r=T.useRef(null),[s,i]=T.useState(e),o=T.useSyncExternalStore(Om.subscribe,Om.getSnapshot),a=T.useMemo(()=>o.map(u=>({disabled:!1,value:u,label:u})),[o]);T.useEffect(()=>{i(e)},[e]);const l=T.useCallback(u=>{var f;if(u.stopPropagation(),u.key==="Enter"){const h=u.currentTarget.value.trim().toLowerCase();if((f=r.current)==null||f.blur(),!h){i(e);return}const p=t.checkDefineName(h);if(p){i(e),Lh(t,p);return}const m=es(h,g=>{const w=t.getSheetList().find(v=>v.name===g);return(w==null?void 0:w.sheetId)||""}),_=t.getSheetInfo((m==null?void 0:m.sheetId)||t.getCurrentSheetId());if(m&&m.col<_.colCount&&m.row<_.rowCount){m.sheetId=m.sheetId||t.getCurrentSheetId(),i(e),Lh(t,m);return}b0.test(h)&&h.length<=bc?t.setDefineName(t.getActiveRange().range,h):i(e)}},[e]),c=T.useCallback(u=>{i(u.target.value)},[]),d=T.useCallback(u=>{const f=t.checkDefineName(u);f&&Lh(t,f)},[]);return S.jsx(jd,{testId:"formula-bar-name",value:n,data:a,onChange:d,className:Zr["defined-name"],children:S.jsx("input",{value:s,ref:r,spellCheck:!0,type:"text",onChange:c,className:Zr["defined-name-editor"],onKeyDown:l,maxLength:Wl*8,"data-testid":"formula-bar-name-input"})})});ux.displayName="DefineName";const dx=T.memo(({controller:t})=>{const e=T.useSyncExternalStore(ql.subscribe,ql.getSnapshot),n=T.useSyncExternalStore(Jl.subscribe,Jl.getSnapshot),{editorStatus:r}=T.useSyncExternalStore(Qt.subscribe,Qt.getSnapshot),s=T.useMemo(()=>e.defineName||Zn({row:e.row,col:e.col,rowCount:1,colCount:1,sheetId:""}),[e.defineName,e.col,e.row]),i=T.useCallback(()=>{Qt.setState({editorStatus:rr.EDIT_FORMULA_BAR})},[]),o=T.useMemo(()=>jk(n),[n]);return S.jsxs("div",{className:Zr["formula-bar-wrapper"],"data-testid":"formula-bar",children:[S.jsx(ux,{controller:t,displayName:s,defineName:e.defineName}),S.jsxs("div",{className:Zr["formula-bar-editor-wrapper"],children:[r!==rr.NONE&&S.jsx(Vk,{initValue:e.value,controller:t,style:TL(e,r,n),testId:"formula-editor",isMergeCell:n.isMergeCell,className:r===rr.EDIT_CELL?Zr["edit-cell"]:""}),S.jsx("div",{className:Fe(Zr["formula-bar-value"],{[Zr.show]:r!==rr.EDIT_FORMULA_BAR,[Zr.wrap]:n.isMergeCell&&e.displayValue.includes(kc)}),style:o,onClick:i,"data-testid":"formula-editor-trigger",children:e.displayValue})]})]})});dx.displayName="FormulaBarContainer";const t7="_border_196ac_17",n7="_fontFamily_196ac_35",r7="_bold_196ac_38",s7="_italic_196ac_41",i7="_strike_196ac_44",ht={"toolbar-wrapper":"_toolbar-wrapper_196ac_1","merge-cell":"_merge-cell_196ac_13",border:t7,"merge-cell-button":"_merge-cell-button_196ac_21","number-format":"_number-format_196ac_26","number-format-value":"_number-format-value_196ac_30",fontFamily:n7,bold:r7,italic:s7,strike:i7,"wrap-text":"_wrap-text_196ac_48","icon-center":"_icon-center_196ac_52"},fx=T.memo(({controller:t})=>{const e=T.useRef(null),n=T.useCallback(async r=>{var d;const s=(d=r.target.files)==null?void 0:d[0];if(!s)return;let i=s.name;const o=s.type.slice(6);i=i.slice(0,-(o.length+1));const a=await F0(s,!0);if(e.current&&(e.current.value="",e.current.blur()),!a)return;const l=await P0(a),c=t.getActiveRange().range;await t.addDrawing({width:l.width,height:l.height,originHeight:l.height,originWidth:l.width,title:i,type:"floating-picture",uuid:ua(),imageSrc:a,sheetId:c.sheetId,fromRow:c.row,fromCol:c.col,marginX:0,marginY:0})},[]);return S.jsxs(ee,{testId:"toolbar-floating-picture",title:"Floating Picture",children:[S.jsx("input",{type:"file",hidden:!0,onChange:n,accept:"image/*",ref:e,id:"upload_float_image","data-testid":"toolbar-floating-picture-input"}),S.jsx("label",{htmlFor:"upload_float_image",children:P("floating-picture")})]})});fx.displayName="InsertFloatingPicture";const hx=T.memo(({controller:t})=>{const e=T.useCallback(async()=>{const n=t.getActiveRange().range;await t.addDrawing({width:400,height:300,originHeight:300,originWidth:400,title:P("chart-title"),type:"chart",uuid:ua(),sheetId:n.sheetId,fromRow:n.row,fromCol:n.col,chartRange:ri(n),chartType:"line",marginX:0,marginY:0})},[]);return S.jsx(ee,{testId:"toolbar-chart",onClick:e,title:"Chart",children:P("chart")})});hx.displayName="InsertChart";const o7="_container_11gw9_1",a7="_trigger_11gw9_9",l7="_main_11gw9_14",c7="_menu_11gw9_19",u7="_portal_11gw9_24",yu={container:o7,trigger:a7,main:l7,menu:c7,portal:u7},px=T.memo(({controller:t})=>{const[e,n]=T.useState(""),[r,s]=T.useState("thin"),[i,o]=T.useState("all-borders"),a=T.useRef({color:e,borderType:r,type:i}),l=()=>({color:a.current.color,type:a.current.borderType}),c=()=>{o("all-borders");const v=l();t.updateCellStyle({borderLeft:v,borderRight:v,borderTop:v,borderBottom:v},t.getActiveRange().range)},d=v=>{a.current.color=v,n(v),c()},u=v=>{a.current.borderType=v,s(v),c()},f=()=>{o("no-border"),t.updateCellStyle({borderLeft:void 0,borderRight:void 0,borderTop:void 0,borderBottom:void 0},t.getActiveRange().range)},h=()=>{o("bottom-border");const v=t.getActiveRange().range,x=l(),{row:C,col:E,colCount:A,rowCount:V}=v;t.updateCellStyle({borderBottom:x},{row:C+V-1,rowCount:1,colCount:A,col:Ks(v)?0:E,sheetId:""})},p=()=>{o("top-border");const v=t.getActiveRange().range,x=l(),{row:C,col:E,colCount:A}=v,V={row:C,rowCount:1,colCount:A,col:Ks(v)?0:E,sheetId:""};t.updateCellStyle({borderTop:x},V)},m=()=>{o("left-border");const v=t.getActiveRange().range,x=l(),{row:C,col:E,rowCount:A}=v;t.updateCellStyle({borderLeft:x},{row:Js(v)?0:C,rowCount:A,colCount:1,col:E,sheetId:""})},_=()=>{o("right-border");const v=t.getActiveRange().range,x=l(),{row:C,col:E,rowCount:A,colCount:V}=v;t.updateCellStyle({borderRight:x},{row:Js(v)?0:C,rowCount:A,colCount:1,col:E+V-1,sheetId:""})},g=()=>{p(),_(),h(),m(),o("outside-borders")},y=()=>{const v=a.current.borderType;a.current.borderType="medium",g(),a.current.borderType=v,o("thick-box-border")},w=()=>{({"all-borders":c,"no-border":f,"bottom-border":h,"top-border":p,"left-border":m,"right-border":_,"thick-box-border":y,"outside-borders":g})[i]()};return S.jsxs("div",{className:yu.container,children:[S.jsx(ee,{onClick:w,type:"plain",className:yu.main,testId:"toolbar-border-shortcut",title:P(i),children:P(i)}),S.jsxs(z0,{className:yu.menu,label:S.jsx(Mt,{name:"down"}),isPlain:!0,testId:"toolbar-border",position:"bottom",size:"small",portalClassName:yu.portal,children:[S.jsx(sn,{onClick:f,testId:"toolbar-no-border",children:P("no-border")}),S.jsx(sn,{onClick:c,testId:"toolbar-all-borders",children:P("all-borders")}),S.jsx(sn,{onClick:g,testId:"toolbar-outside-borders",children:P("outside-borders")}),S.jsx(sn,{onClick:y,testId:"toolbar-thick-box-border",children:P("thick-box-border")}),S.jsx(sn,{onClick:h,testId:"toolbar-bottom-border",children:P("bottom-border")}),S.jsx(sn,{onClick:p,testId:"toolbar-top-border",children:P("top-border")}),S.jsx(sn,{onClick:m,testId:"toolbar-left-border",children:P("left-border")}),S.jsx(sn,{onClick:_,testId:"toolbar-right-border",children:P("right-border")}),S.jsx(sn,{children:S.jsx(Ql,{color:e,onChange:d,position:"right",testId:"toolbar-border-color",children:S.jsxs("span",{style:{color:e},children:[P("line-color")," >"]})})}),S.jsx(y5,{label:`${P("line-style")} >`,testId:"toolbar-border-style",children:Object.keys(Tc).map(v=>S.jsx(sn,{onClick:()=>u(v),testId:`toolbar-border-style-${v}`,active:r===v,children:v},v))})]})]})});px.displayName="BorderToolBar";function nS(t){const e=document.createElement("span");e.style.fontSize="72px",e.innerHTML="mmmmmmmmmmlli",e.style.fontFamily=t,document.body.appendChild(e);const{offsetWidth:n,offsetHeight:r}=e;return document.body.removeChild(e),{offsetHeight:r,offsetWidth:n}}function d7(){const t=[yk,"serif"],e={},n={};for(const s of t){const{offsetWidth:i,offsetHeight:o}=nS(s);e[s]=i,n[s]=o}function r(s){for(const i of t){const{offsetWidth:o,offsetHeight:a}=nS(s+","+i);if(o!==e[i]||a!==n[i])return!0}return!1}return r}const mx=d7();function f7(t=mx,e=h8){const n=localStorage.getItem(Ok);if(n){const s=JSON.parse(n);if(s.length>0)return s.map(i=>({value:i,label:i,disabled:!1}))}const r=[];for(const s of e)t(s)&&r.push({label:s,value:s,disabled:!1});return typeof window.queryLocalFonts=="function"&&r.push({value:Rm,label:P("get-all-installed-fonts"),disabled:!1}),r}const h7=[{value:Ze.NONE,label:P("none"),disabled:!1},{value:Ze.SINGLE,label:P("single-underline"),disabled:!1},{value:Ze.DOUBLE,label:P("double-underline"),disabled:!1}],p7=[{value:vr.MERGE_CENTER,label:P("merge-and-center"),disabled:!1},{value:vr.MERGE_CELL,label:P("merge-cells"),disabled:!1},{value:vr.MERGE_CONTENT,label:P("merge-content"),disabled:!1}],gx=T.memo(({controller:t})=>{const e=T.useSyncExternalStore(Qt.subscribe,Qt.getSnapshot),n=T.useSyncExternalStore(Jl.subscribe,Jl.getSnapshot),r=T.useSyncExternalStore(_i.subscribe,_i.getSnapshot),s=T.useMemo(()=>({color:n.fillColor}),[n.fillColor]),i=T.useMemo(()=>({color:n.fontColor}),[n.fontColor]),[o,a]=T.useMemo(()=>{let K=vi[0];if(n.numberFormat){const F=vi.find(q=>q.value===n.numberFormat);F?K=F:K=vi[vi.length-1]}return[K.label,String(K.value)]},[n.numberFormat]),l=T.useCallback(K=>({fontFamily:String(K)}),[]),c=T.useCallback(K=>{String(K)===Rm&&typeof window.queryLocalFonts=="function"?window.queryLocalFonts().then(F=>{let q=F.map(oe=>oe.fullName);q=Array.from(new Set(q)).filter(oe=>mx(oe)),q.sort((oe,Te)=>oe.localeCompare(Te));const ne=q.map(oe=>({label:oe,value:oe,disabled:!1}));q.length>0?(_i.setState(ne),localStorage.setItem(Ok,JSON.stringify(q))):_i.setState(_i.getSnapshot().filter(oe=>oe.value!==Rm))}):t.updateCellStyle({fontFamily:String(K)},t.getActiveRange().range)},[]),d=T.useCallback(()=>{t.undo()},[]),u=T.useCallback(()=>{t.redo()},[]),f=T.useCallback(()=>{t.copy()},[]),h=T.useCallback(()=>{t.cut()},[]),p=T.useCallback(()=>{t.paste()},[]),m=T.useCallback(K=>{t.updateCellStyle({fontSize:Number(K)},t.getActiveRange().range)},[]),_=T.useCallback(()=>{t.updateCellStyle({isBold:!n.isBold},t.getActiveRange().range)},[n.isBold]),g=T.useCallback(()=>{t.updateCellStyle({isItalic:!n.isItalic},t.getActiveRange().range)},[n.isItalic]),y=T.useCallback(()=>{t.updateCellStyle({isStrike:!n.isStrike},t.getActiveRange().range)},[n.isStrike]),w=T.useCallback(K=>{const F=Number(K);let q=Ze.NONE;F===Ze.SINGLE?q=Ze.SINGLE:F===Ze.DOUBLE&&(q=Ze.DOUBLE),t.updateCellStyle({underline:q},t.getActiveRange().range)},[]),v=T.useCallback(K=>{t.updateCellStyle({fillColor:K},t.getActiveRange().range)},[]),x=T.useCallback(K=>{t.updateCellStyle({fontColor:K},t.getActiveRange().range)},[]),C=T.useCallback(()=>{t.updateCellStyle({isWrapText:!n.isWrapText},t.getActiveRange().range)},[n.isWrapText]),E=T.useCallback(()=>{const{range:K,isMerged:F}=t.getActiveRange();F?t.deleteMergeCell(K):t.addMergeCell(K)},[]),A=T.useCallback(K=>{if(!K)return;const{range:F,isMerged:q}=t.getActiveRange();q?t.deleteMergeCell(F):t.addMergeCell(F,Number(K))},[]),V=T.useCallback(K=>{K&&t.updateCellStyle({numberFormat:K},t.getActiveRange().range)},[]),D=T.useCallback(()=>{t.updateCellStyle({horizontalAlign:wt.LEFT},t.getActiveRange().range)},[]),$=T.useCallback(()=>{t.updateCellStyle({horizontalAlign:wt.CENTER},t.getActiveRange().range)},[]),j=T.useCallback(()=>{t.updateCellStyle({horizontalAlign:wt.RIGHT},t.getActiveRange().range)},[]),Z=T.useCallback(()=>{t.updateCellStyle({verticalAlign:Et.TOP},t.getActiveRange().range)},[]),ae=T.useCallback(()=>{t.updateCellStyle({verticalAlign:Et.MIDDLE},t.getActiveRange().range)},[]),ce=T.useCallback(()=>{t.updateCellStyle({verticalAlign:Et.BOTTOM},t.getActiveRange().range)},[]),J=T.useCallback(()=>{t.getFilter()?t.deleteFilter():t.addFilter(t.getActiveRange().range)},[]);return S.jsxs("div",{className:ht["toolbar-wrapper"],"data-testid":"toolbar",children:[S.jsx(ee,{disabled:!e.canUndo,onClick:d,testId:"toolbar-undo",title:"Undo",className:ht["icon-center"],children:S.jsx(Mt,{name:"undo"})}),S.jsx(ee,{disabled:!e.canRedo,onClick:u,testId:"toolbar-redo",title:"Redo",className:ht["icon-center"],children:S.jsx(Mt,{name:"redo"})}),S.jsx(ee,{onClick:f,testId:"toolbar-copy",title:"Copy",children:P("copy")}),S.jsx(ee,{onClick:h,testId:"toolbar-cut",title:"Cut",children:P("cut")}),S.jsx(ee,{onClick:p,testId:"toolbar-paste",title:"Paste",children:P("paste")}),S.jsx(Fi,{data:r,value:n.fontFamily,getItemStyle:l,onChange:c,testId:"toolbar-font-family",className:ht.fontFamily}),S.jsx(Fi,{data:UO,value:n.fontSize,onChange:m,testId:"toolbar-font-size"}),S.jsx(ee,{active:n.isBold,onClick:_,testId:"toolbar-bold",title:"Bold",children:S.jsx("span",{className:ht.bold,children:"B"})}),S.jsx(ee,{active:n.isItalic,onClick:g,testId:"toolbar-italic",title:"Italic",children:S.jsx("span",{className:ht.italic,children:"I"})}),S.jsx(ee,{active:n.isStrike,onClick:y,testId:"toolbar-strike",title:"Strike",children:S.jsx("span",{className:ht.strike,children:"A"})}),S.jsx(Fi,{data:h7,value:n.underline,title:"Underline",onChange:w,testId:"toolbar-underline"}),S.jsx(px,{controller:t}),S.jsx(Ql,{color:n.fillColor,onChange:v,testId:"toolbar-fill-color",children:S.jsx(ee,{style:s,testId:"toolbar-fill-color",className:ht["icon-center"],title:"Fill Color",children:S.jsx(sx,{})})},"fill-color"),S.jsx(Ql,{color:n.fontColor,onChange:x,testId:"toolbar-font-color",children:S.jsx(ee,{style:i,testId:"toolbar-font-color",className:ht["icon-center"],title:"Font Color",children:S.jsx(Mt,{name:"fontColor"})})},"font-color"),S.jsx(ee,{active:n.verticalAlign===Et.TOP,onClick:Z,testId:"toolbar-vertical-top",className:ht["icon-center"],title:"Top Align",children:S.jsx(Mt,{name:"verticalTop"})}),S.jsx(ee,{active:n.verticalAlign===Et.MIDDLE,onClick:ae,testId:"toolbar-vertical-middle",className:ht["icon-center"],title:"Middle Align",children:S.jsx(Mt,{name:"verticalMiddle"})}),S.jsx(ee,{active:n.verticalAlign===Et.BOTTOM,onClick:ce,testId:"toolbar-vertical-bottom",className:ht["icon-center"],title:"Bottom Align",children:S.jsx(Mt,{name:"verticalBottom"})}),S.jsx(ee,{active:n.horizontalAlign===wt.LEFT,onClick:D,testId:"toolbar-horizontal-left",className:ht["icon-center"],title:"Align Text Left",children:S.jsx(Mt,{name:"horizontalLeft"})}),S.jsx(ee,{active:n.horizontalAlign===wt.CENTER,onClick:$,testId:"toolbar-horizontal-center",className:ht["icon-center"],title:"Align Text Center",children:S.jsx(Mt,{name:"horizontalCenter"})}),S.jsx(ee,{active:n.horizontalAlign===wt.RIGHT,onClick:j,testId:"toolbar-horizontal-right",className:ht["icon-center"],title:"Align Text Right",children:S.jsx(Mt,{name:"horizontalRight"})}),S.jsx(ee,{active:n.isWrapText,onClick:C,testId:"toolbar-wrap-text",className:ht["wrap-text"],title:"Wrap Text",children:P("wrap-text")}),S.jsx(jd,{data:p7,value:n.mergeType,onChange:A,className:ht["merge-cell"],testId:"toolbar-merge-cell-select",children:S.jsx(ee,{active:n.isMergeCell,onClick:E,testId:"toolbar-merge-cell",className:ht["merge-cell-button"],type:"plain",title:"Merge And Center",children:P("merge-and-center")})}),S.jsx(jd,{data:vi,value:a,onChange:V,className:ht["number-format"],testId:"toolbar-number-format",children:S.jsx("div",{className:ht["number-format-value"],"data-testid":"toolbar-number-format-value",children:o})}),S.jsx(ee,{active:e.isFilter,onClick:J,testId:"toolbar-filter",className:ht["wrap-text"],title:"Filter",children:P("filter")}),S.jsx(fx,{controller:t}),S.jsx(hx,{controller:t}),S.jsx(rx,{})]})});gx.displayName="ToolbarContainer";const m7="_active_x1u6k_80",On={"canvas-container":"_canvas-container_x1u6k_1","vertical-scroll-bar":"_vertical-scroll-bar_x1u6k_9","vertical-scroll-bar-content":"_vertical-scroll-bar-content_x1u6k_22","horizontal-scroll-bar":"_horizontal-scroll-bar_x1u6k_30","horizontal-scroll-bar-content":"_horizontal-scroll-bar-content_x1u6k_43","context-menu":"_context-menu_x1u6k_57","bottom-bar":"_bottom-bar_x1u6k_70",active:m7,"bottom-bar-text":"_bottom-bar-text_x1u6k_84","bottom-bar-input":"_bottom-bar-input_x1u6k_88","add-button":"_add-button_x1u6k_91"};function rS(t,e,n){const r=t.getScroll(),s=L0(),{maxHeight:i,maxScrollHeight:o,maxScrollWidth:a,maxWidth:l}=s;let c=r.scrollTop+Math.ceil(n),d=r.scrollLeft+Math.ceil(e);c<0?c=0:c>o&&(c=o),d<0?d=0:d>a&&(d=a);const u=Math.floor(i*c/o),f=Math.floor(l*d/a),{row:h,col:p}=tx(t,f,u);t.setScroll({row:h,col:p,top:u,left:f,scrollLeft:d,scrollTop:c})}const sS={prevPageX:0,prevPageY:0,scrollStatus:Si.NONE},yx=T.memo(({controller:t})=>{const e=T.useRef({...sS}),{scrollLeft:n,scrollTop:r}=T.useSyncExternalStore(Kl.subscribe,Kl.getSnapshot),[s]=T.useMemo(()=>{function l(){e.current={...sS},d(!1)}function c(u){if(u.buttons<=0){d(!1);return}e.current.scrollStatus!==Si.NONE&&(e.current.scrollStatus===Si.VERTICAL?(rS(t,0,u.clientY-e.current.prevPageY),e.current.prevPageY=u.clientY):e.current.scrollStatus===Si.HORIZONTAL&&(rS(t,u.clientX-e.current.prevPageX,0),e.current.prevPageX=u.clientX))}function d(u){const f=u?document.addEventListener:document.removeEventListener;f("pointermove",c),f("pointerup",l)}return[d]},[]);T.useEffect(()=>s,[s]);const i=T.useCallback((l,c)=>{l.buttons<=0||(s(!0),e.current.prevPageX=l.clientX,e.current.prevPageY=l.clientY,e.current.scrollStatus=c)},[s]),o=T.useCallback(l=>{i(l,Si.VERTICAL)},[i]),a=T.useCallback(l=>{i(l,Si.HORIZONTAL)},[s]);return S.jsxs(T.Fragment,{children:[S.jsx("div",{className:On["vertical-scroll-bar"],"data-testid":"vertical-scroll-bar",onPointerDown:o,children:S.jsx("div",{className:On["vertical-scroll-bar-content"],style:{transform:`translateY(${r}px)`},"data-testid":"vertical-scroll-bar-content"})}),S.jsx("div",{className:On["horizontal-scroll-bar"],"data-testid":"horizontal-scroll-bar",onPointerDown:a,children:S.jsx("div",{className:On["horizontal-scroll-bar-content"],style:{transform:`translateX(${n}px)`},"data-testid":"horizontal-scroll-bar-content"})})]})});yx.displayName="ScrollBar";const iS=110,Fh=20;function g7(t,e){const n=ar.get(),r=zn.get();let s=3,i=Fh*3;const o=t-r.top,a=e-r.left;o<n.height&&a<n.width?s=2:o<n.height?(s=0,i=Fh*6):a<n.width&&(s=1,i=Fh*6);let l=t,c=e;const d=18,u=r.height+r.top;return l+i>u&&(l=u-i-d),c+iS>r.width&&(c=r.width-iS-d),{style:{top:l,left:c},position:s}}const Ph=1e4,wx=T.memo(t=>{const{controller:e,top:n,left:r,hideContextMenu:s}=t,{row:i,col:o,colCount:a,rowCount:l}=T.useSyncExternalStore(ql.subscribe,ql.getSnapshot),c=Rc(s),{style:d,position:u}=T.useMemo(()=>g7(n,r),[n,r]),f=h=>{let p=h?e.getRow(i).len:e.getCol(o).len;const m=_=>{const g=parseInt(_.target.value,10);isNaN(g)||(g<0?p=0:p>Ph?p=Ph:p=g),_.stopPropagation()};pl({visible:!0,title:P(h?"row-height":"column-width"),testId:"context-menu-width-height-dialog",children:S.jsx("input",{type:"number",min:0,max:Ph,style:{width:"200px"},defaultValue:p,onChange:m,"data-testid":"context-menu-width-height-dialog-input"}),onOk:()=>{if(p<0)return gt.error(P("greater-than-zero"));h?e.transaction(()=>{for(let _=0;_<l;_++)e.setRowHeight(i+_,p)}):e.transaction(()=>{for(let _=0;_<a;_++)e.setColWidth(o+_,p)}),s()},onCancel:()=>{s()}})};return S.jsxs("div",{className:On["context-menu"],"data-testid":"context-menu",style:d,ref:c,children:[S.jsx(ee,{onClick:()=>{s(),e.setFloatElementUuid(""),e.copy()},testId:"context-menu-copy",children:P("copy")}),S.jsx(ee,{onClick:()=>{s(),e.setFloatElementUuid(""),e.cut()},testId:"context-menu-cut",children:P("cut")}),S.jsx(ee,{testId:"context-menu-paste",onClick:()=>{s(),e.paste()},children:P("paste")}),(u===1||u===3)&&S.jsxs(T.Fragment,{children:[S.jsx(ee,{testId:"context-menu-insert-row-above",onClick:()=>{s(),e.addRow(i,l,!0)},children:P("insert-row-above")}),S.jsx(ee,{testId:"context-menu-insert-row-below",onClick:()=>{s(),e.addRow(i,l)},children:P("insert-row-below")})]}),(u===0||u===3)&&S.jsxs(T.Fragment,{children:[S.jsx(ee,{testId:"context-menu-insert-column-left",onClick:()=>{s(),e.addCol(o,a)},children:P("insert-column-left")}),S.jsx(ee,{testId:"context-menu-insert-column-right",onClick:()=>{s(),e.addCol(o,a,!0)},children:P("insert-column-right")})]}),u===2&&S.jsx(ee,{testId:"context-menu-delete",onClick:()=>{s(),e.deleteAll(e.getCurrentSheetId())},children:P("delete")}),u===0&&S.jsxs(T.Fragment,{children:[S.jsx(ee,{testId:"context-menu-delete-column",onClick:()=>{s(),e.deleteCol(o,a)},children:P("delete-columns")}),S.jsx(ee,{testId:"context-menu-hide-column",onClick:()=>{s(),e.hideCol(o,a)},children:P("hide-columns")}),S.jsx(ee,{testId:"context-menu-unhide-column",onClick:()=>{s(),e.unhideCol(o,a)},children:P("unhide-columns")}),S.jsx(ee,{testId:"context-menu-column-width",onClick:()=>{f(!1)},children:P("column-width")})]}),u===1&&S.jsxs(T.Fragment,{children:[S.jsx(ee,{testId:"context-menu-delete-row",onClick:()=>{s(),e.deleteRow(i,l)},children:P("delete-rows")}),S.jsx(ee,{testId:"context-menu-hide-row",onClick:()=>{s(),e.hideRow(i,l)},children:P("hide-rows")}),S.jsx(ee,{testId:"context-menu-unhide-row",onClick:()=>{s(),e.unhideRow(i,l)},children:P("unhide-rows")}),S.jsx(ee,{testId:"context-menu-row-height",onClick:()=>{f(!0)},children:P("row-height")})]})]})});wx.displayName="CanvasContextMenu";const xr=()=>new Map,Pm=t=>{const e=xr();return t.forEach((n,r)=>{e.set(r,n)}),e},mi=(t,e,n)=>{let r=t.get(e);return r===void 0&&t.set(e,r=n()),r},y7=(t,e)=>{const n=[];for(const[r,s]of t)n.push(e(s,r));return n},w7=(t,e)=>{for(const[n,r]of t)if(e(r,n))return!0;return!1},fa=()=>new Set,$h=t=>t[t.length-1],S7=(t,e)=>{for(let n=0;n<e.length;n++)t.push(e[n])},Yi=Array.from,v7=(t,e)=>{for(let n=0;n<t.length;n++)if(e(t[n],n,t))return!0;return!1},$m=Array.isArray;class Sx{constructor(){this._observers=xr()}on(e,n){return mi(this._observers,e,fa).add(n),n}once(e,n){const r=(...s)=>{this.off(e,r),n(...s)};this.on(e,r)}off(e,n){const r=this._observers.get(e);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(e))}emit(e,n){return Yi((this._observers.get(e)||xr()).values()).forEach(r=>r(...n))}destroy(){this._observers=xr()}}const si=Math.floor,Vu=Math.abs,vx=(t,e)=>t<e?t:e,ba=(t,e)=>t>e?t:e,_x=t=>t!==0?t<0:1/t<0,oS=1,aS=2,Uh=4,Bh=8,Zl=32,os=64,Un=128,Ff=31,Um=63,Pi=127,_7=2147483647,Cx=Number.MAX_SAFE_INTEGER,C7=Number.isInteger||(t=>typeof t=="number"&&isFinite(t)&&si(t)===t),E7=t=>t.toLowerCase(),k7=/^\s*/g,x7=t=>t.replace(k7,""),I7=/([A-Z])/g,lS=(t,e)=>x7(t.replace(I7,n=>`${e}${E7(n)}`)),b7=t=>{const e=unescape(encodeURIComponent(t)),n=e.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=e.codePointAt(s);return r},ec=typeof TextEncoder<"u"?new TextEncoder:null,T7=t=>ec.encode(t),R7=ec?T7:b7;let ml=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});ml&&ml.decode(new Uint8Array).length===1&&(ml=null);class Mc{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const Pf=()=>new Mc,M7=t=>{let e=t.cpos;for(let n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e},Ur=t=>{const e=new Uint8Array(M7(t));let n=0;for(let r=0;r<t.bufs.length;r++){const s=t.bufs[r];e.set(s,n),n+=s.length}return e.set(new Uint8Array(t.cbuf.buffer,0,t.cpos),n),e},N7=(t,e)=>{const n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(new Uint8Array(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(ba(n,e)*2),t.cpos=0)},Rt=(t,e)=>{const n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(n*2),t.cpos=0),t.cbuf[t.cpos++]=e},Bm=Rt,Be=(t,e)=>{for(;e>Pi;)Rt(t,Un|Pi&e),e=si(e/128);Rt(t,Pi&e)},j0=(t,e)=>{const n=_x(e);for(n&&(e=-e),Rt(t,(e>Um?Un:0)|(n?os:0)|Um&e),e=si(e/64);e>0;)Rt(t,(e>Pi?Un:0)|Pi&e),e=si(e/128)},Hm=new Uint8Array(3e4),A7=Hm.length/3,D7=(t,e)=>{if(e.length<A7){const n=ec.encodeInto(e,Hm).written||0;Be(t,n);for(let r=0;r<n;r++)Rt(t,Hm[r])}else Rn(t,R7(e))},O7=(t,e)=>{const n=unescape(encodeURIComponent(e)),r=n.length;Be(t,r);for(let s=0;s<r;s++)Rt(t,n.codePointAt(s))},zo=ec&&ec.encodeInto?D7:O7,$f=(t,e)=>{const n=t.cbuf.length,r=t.cpos,s=vx(n-r,e.length),i=e.length-s;t.cbuf.set(e.subarray(0,s),r),t.cpos+=s,i>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(ba(n*2,i)),t.cbuf.set(e.subarray(s)),t.cpos=i)},Rn=(t,e)=>{Be(t,e.byteLength),$f(t,e)},W0=(t,e)=>{N7(t,e);const n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},L7=(t,e)=>W0(t,4).setFloat32(0,e,!1),F7=(t,e)=>W0(t,8).setFloat64(0,e,!1),P7=(t,e)=>W0(t,8).setBigInt64(0,e,!1),cS=new DataView(new ArrayBuffer(4)),$7=t=>(cS.setFloat32(0,t),cS.getFloat32(0)===t),tc=(t,e)=>{switch(typeof e){case"string":Rt(t,119),zo(t,e);break;case"number":C7(e)&&Vu(e)<=_7?(Rt(t,125),j0(t,e)):$7(e)?(Rt(t,124),L7(t,e)):(Rt(t,123),F7(t,e));break;case"bigint":Rt(t,122),P7(t,e);break;case"object":if(e===null)Rt(t,126);else if($m(e)){Rt(t,117),Be(t,e.length);for(let n=0;n<e.length;n++)tc(t,e[n])}else if(e instanceof Uint8Array)Rt(t,116),Rn(t,e);else{Rt(t,118);const n=Object.keys(e);Be(t,n.length);for(let r=0;r<n.length;r++){const s=n[r];zo(t,s),tc(t,e[s])}}break;case"boolean":Rt(t,e?120:121);break;default:Rt(t,127)}};class uS extends Mc{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&Be(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const dS=t=>{t.count>0&&(j0(t.encoder,t.count===1?t.s:-t.s),t.count>1&&Be(t.encoder,t.count-2))};class Gu{constructor(){this.encoder=new Mc,this.s=0,this.count=0}write(e){this.s===e?this.count++:(dS(this),this.count=1,this.s=e)}toUint8Array(){return dS(this),Ur(this.encoder)}}const fS=t=>{if(t.count>0){const e=t.diff*2+(t.count===1?0:1);j0(t.encoder,e),t.count>1&&Be(t.encoder,t.count-2)}};class Hh{constructor(){this.encoder=new Mc,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(fS(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return fS(this),Ur(this.encoder)}}class U7{constructor(){this.sarr=[],this.s="",this.lensE=new Gu}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new Mc;return this.sarr.push(this.s),this.s="",zo(e,this.sarr.join("")),$f(e,this.lensE.toUint8Array()),Ur(e)}}const ii=t=>new Error(t),zr=()=>{throw ii("Method unimplemented")},jr=()=>{throw ii("Unexpected case")},Ex=ii("Unexpected end of array"),kx=ii("Integer out of Range");class Uf{constructor(e){this.arr=e,this.pos=0}}const V0=t=>new Uf(t),B7=t=>t.pos!==t.arr.length,H7=(t,e)=>{const n=new Uint8Array(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n},Mn=t=>H7(t,Ne(t)),ha=t=>t.arr[t.pos++],Ne=t=>{let e=0,n=1;const r=t.arr.length;for(;t.pos<r;){const s=t.arr[t.pos++];if(e=e+(s&Pi)*n,n*=128,s<Un)return e;if(e>Cx)throw kx}throw Ex},G0=t=>{let e=t.arr[t.pos++],n=e&Um,r=64;const s=(e&os)>0?-1:1;if(!(e&Un))return s*n;const i=t.arr.length;for(;t.pos<i;){if(e=t.arr[t.pos++],n=n+(e&Pi)*r,r*=128,e<Un)return s*n;if(n>Cx)throw kx}throw Ex},z7=t=>{let e=Ne(t);if(e===0)return"";{let n=String.fromCodePoint(ha(t));if(--e<100)for(;e--;)n+=String.fromCodePoint(ha(t));else for(;e>0;){const r=e<1e4?e:1e4,s=t.arr.subarray(t.pos,t.pos+r);t.pos+=r,n+=String.fromCodePoint.apply(null,s),e-=r}return decodeURIComponent(escape(n))}},j7=t=>ml.decode(Mn(t)),jo=ml?j7:z7,X0=(t,e)=>{const n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},W7=t=>X0(t,4).getFloat32(0,!1),V7=t=>X0(t,8).getFloat64(0,!1),G7=t=>X0(t,8).getBigInt64(0,!1),X7=[t=>{},t=>null,G0,W7,V7,G7,t=>!1,t=>!0,jo,t=>{const e=Ne(t),n={};for(let r=0;r<e;r++){const s=jo(t);n[s]=nc(t)}return n},t=>{const e=Ne(t),n=[];for(let r=0;r<e;r++)n.push(nc(t));return n},Mn],nc=t=>X7[127-ha(t)](t);class hS extends Uf{constructor(e,n){super(e),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),B7(this)?this.count=Ne(this)+1:this.count=-1),this.count--,this.s}}class Xu extends Uf{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=G0(this);const e=_x(this.s);this.count=1,e&&(this.s=-this.s,this.count=Ne(this)+2)}return this.count--,this.s}}class zh extends Uf{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=G0(this),n=e&1;this.diff=si(e/2),this.count=1,n&&(this.count=Ne(this)+2)}return this.s+=this.diff,this.count--,this.s}}class Y7{constructor(e){this.decoder=new Xu(e),this.str=jo(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),n=this.str.slice(this.spos,e);return this.spos=e,n}}const q7=crypto.getRandomValues.bind(crypto),xx=()=>q7(new Uint32Array(1))[0],K7="10000000-1000-4000-8000"+-1e11,J7=()=>K7.replace(/[018]/g,t=>(t^xx()&15>>t/4).toString(16)),Q7=Date.now,pS=t=>new Promise(t);Promise.all.bind(Promise);const mS=t=>t===void 0?null:t;class Z7{constructor(){this.map=new Map}setItem(e,n){this.map.set(e,n)}getItem(e){return this.map.get(e)}}let Ix=new Z7,eF=!0;try{typeof localStorage<"u"&&localStorage&&(Ix=localStorage,eF=!1)}catch{}const tF=Ix,nF=Object.assign,rF=Object.keys,sF=(t,e)=>{for(const n in t)e(t[n],n)},gS=t=>rF(t).length,iF=t=>{for(const e in t)return!1;return!0},oF=(t,e)=>{for(const n in t)if(!e(t[n],n))return!1;return!0},aF=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),lF=(t,e)=>t===e||gS(t)===gS(e)&&oF(t,(n,r)=>(n!==void 0||aF(e,r))&&e[r]===n),cF=Object.freeze,bx=t=>{for(const e in t){const n=t[e];(typeof n=="object"||typeof n=="function")&&bx(t[e])}return cF(t)},Y0=(t,e,n=0)=>{try{for(;n<t.length;n++)t[n](...e)}finally{n<t.length&&Y0(t,e,n+1)}},uF=(t,e)=>e.includes(t);var Tx={};const rc=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";let Ar;const dF=()=>{if(Ar===void 0)if(rc){Ar=xr();const t=process.argv;let e=null;for(let n=0;n<t.length;n++){const r=t[n];r[0]==="-"?(e!==null&&Ar.set(e,""),e=r):e!==null&&(Ar.set(e,r),e=null)}e!==null&&Ar.set(e,"")}else typeof location=="object"?(Ar=xr(),(location.search||"?").slice(1).split("&").forEach(t=>{if(t.length!==0){const[e,n]=t.split("=");Ar.set(`--${lS(e,"-")}`,n),Ar.set(`-${lS(e,"-")}`,n)}})):Ar=xr();return Ar},zm=t=>dF().has(t),Wd=t=>mS(rc?Tx[t.toUpperCase().replaceAll("-","_")]:tF.getItem(t)),Rx=t=>zm("--"+t)||Wd(t)!==null;Rx("production");const fF=rc&&uF(Tx.FORCE_COLOR,["true","1","2"]),hF=fF||!zm("--no-colors")&&!Rx("no-color")&&(!rc||process.stdout.isTTY)&&(!rc||zm("--color")||Wd("COLORTERM")!==null||(Wd("TERM")||"").includes("color")),pF=t=>new Uint8Array(t),mF=t=>{const e=pF(t.byteLength);return e.set(t),e};class gF{constructor(e,n){this.left=e,this.right=n}}const Gr=(t,e)=>new gF(t,e);typeof DOMParser<"u"&&new DOMParser;const yF=t=>y7(t,(e,n)=>`${n}:${e};`).join(""),Ss=Symbol,Mx=Ss(),Nx=Ss(),wF=Ss(),SF=Ss(),vF=Ss(),Ax=Ss(),_F=Ss(),q0=Ss(),CF=Ss(),EF=t=>{var s;t.length===1&&((s=t[0])==null?void 0:s.constructor)===Function&&(t=t[0]());const e=[],n=[];let r=0;for(;r<t.length;r++){const i=t[r];if(i===void 0)break;if(i.constructor===String||i.constructor===Number)e.push(i);else if(i.constructor===Object)break}for(r>0&&n.push(e.join(""));r<t.length;r++){const i=t[r];i instanceof Symbol||n.push(i)}return n},kF={[Mx]:Gr("font-weight","bold"),[Nx]:Gr("font-weight","normal"),[wF]:Gr("color","blue"),[vF]:Gr("color","green"),[SF]:Gr("color","grey"),[Ax]:Gr("color","red"),[_F]:Gr("color","purple"),[q0]:Gr("color","orange"),[CF]:Gr("color","black")},xF=t=>{var o;t.length===1&&((o=t[0])==null?void 0:o.constructor)===Function&&(t=t[0]());const e=[],n=[],r=xr();let s=[],i=0;for(;i<t.length;i++){const a=t[i],l=kF[a];if(l!==void 0)r.set(l.left,l.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const c=yF(r);i>0||c.length>0?(e.push("%c"+a),n.push(c)):e.push(a)}else break}}for(i>0&&(s=n,s.unshift(e.join("")));i<t.length;i++){const a=t[i];a instanceof Symbol||s.push(a)}return s},Dx=hF?xF:EF,IF=(...t)=>{console.log(...Dx(t)),Lx.forEach(e=>e.print(t))},Ox=(...t)=>{console.warn(...Dx(t)),t.unshift(q0),Lx.forEach(e=>e.print(t))},Lx=fa(),Fx=t=>({[Symbol.iterator](){return this},next:t}),bF=(t,e)=>Fx(()=>{let n;do n=t.next();while(!n.done&&!e(n.value));return n}),jh=(t,e)=>Fx(()=>{const{done:n,value:r}=t.next();return{done:n,value:n?void 0:e(r)}});class Px{constructor(e,n){this.clock=e,this.len=n}}class Nc{constructor(){this.clients=new Map}}const pa=(t,e,n)=>e.clients.forEach((r,s)=>{const i=t.doc.store.clients.get(s);for(let o=0;o<r.length;o++){const a=r[o];Gx(t,i,a.clock,a.len,n)}}),TF=(t,e)=>{let n=0,r=t.length-1;for(;n<=r;){const s=si((n+r)/2),i=t[s],o=i.clock;if(o<=e){if(e<o+i.len)return s;n=s+1}else r=s-1}return null},Ac=(t,e)=>{const n=t.clients.get(e.client);return n!==void 0&&TF(n,e.clock)!==null},K0=t=>{t.clients.forEach(e=>{e.sort((s,i)=>s.clock-i.clock);let n,r;for(n=1,r=1;n<e.length;n++){const s=e[r-1],i=e[n];s.clock+s.len>=i.clock?s.len=ba(s.len,i.clock+i.len-s.clock):(r<n&&(e[r]=i),r++)}e.length=r})},jm=t=>{const e=new Nc;for(let n=0;n<t.length;n++)t[n].clients.forEach((r,s)=>{if(!e.clients.has(s)){const i=r.slice();for(let o=n+1;o<t.length;o++)S7(i,t[o].clients.get(s)||[]);e.clients.set(s,i)}});return K0(e),e},sc=(t,e,n,r)=>{mi(t.clients,e,()=>[]).push(new Px(n,r))},J0=(t,e)=>{Be(t.restEncoder,e.clients.size),Yi(e.clients.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{t.resetDsCurVal(),Be(t.restEncoder,n);const s=r.length;Be(t.restEncoder,s);for(let i=0;i<s;i++){const o=r[i];t.writeDsClock(o.clock),t.writeDsLen(o.len)}})},RF=t=>{const e=new Nc,n=Ne(t.restDecoder);for(let r=0;r<n;r++){t.resetDsCurVal();const s=Ne(t.restDecoder),i=Ne(t.restDecoder);if(i>0){const o=mi(e.clients,s,()=>[]);for(let a=0;a<i;a++)o.push(new Px(t.readDsClock(),t.readDsLen()))}}return e},yS=(t,e,n)=>{const r=new Nc,s=Ne(t.restDecoder);for(let i=0;i<s;i++){t.resetDsCurVal();const o=Ne(t.restDecoder),a=Ne(t.restDecoder),l=n.clients.get(o)||[],c=It(n,o);for(let d=0;d<a;d++){const u=t.readDsClock(),f=u+t.readDsLen();if(u<c){c<f&&sc(r,o,c,f-c);let h=Wr(l,u),p=l[h];for(!p.deleted&&p.id.clock<u&&(l.splice(h+1,0,Qd(e,p,u-p.id.clock)),h++);h<l.length&&(p=l[h++],p.id.clock<f);)p.deleted||(f<p.id.clock+p.length&&l.splice(h,0,Qd(e,p,f-p.id.clock)),p.delete(e))}else sc(r,o,u,f-u)}}if(r.clients.size>0){const i=new Bf;return Be(i.restEncoder,0),J0(i,r),i.toUint8Array()}return null},$x=xx;class ro extends Sx{constructor({guid:e=J7(),collectionid:n=null,gc:r=!0,gcFilter:s=()=>!0,meta:i=null,autoLoad:o=!1,shouldLoad:a=!0}={}){super(),this.gc=r,this.gcFilter=s,this.clientID=$x(),this.guid=e,this.collectionid=n,this.share=new Map,this.store=new Wx,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=o,this.meta=i,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=pS(c=>{this.on("load",()=>{this.isLoaded=!0,c(this)})});const l=()=>pS(c=>{const d=u=>{(u===void 0||u===!0)&&(this.off("sync",d),c())};this.on("sync",d)});this.on("sync",c=>{c===!1&&this.isSynced&&(this.whenSynced=l()),this.isSynced=c===void 0||c===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=l()}load(){const e=this._item;e!==null&&!this.shouldLoad&&Ge(e.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Yi(this.subdocs).map(e=>e.guid))}transact(e,n=null){return Ge(this,e,n)}get(e,n=Wt){const r=mi(this.share,e,()=>{const i=new n;return i._integrate(this,null),i}),s=r.constructor;if(n!==Wt&&s!==n)if(s===Wt){const i=new n;i._map=r._map,r._map.forEach(o=>{for(;o!==null;o=o.left)o.parent=i}),i._start=r._start;for(let o=i._start;o!==null;o=o.right)o.parent=i;return i._length=r._length,this.share.set(e,i),i._integrate(this,null),i}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return r}getArray(e=""){return this.get(e,Vo)}getText(e=""){return this.get(e,ma)}getMap(e=""){return this.get(e,Oe)}getXmlElement(e=""){return this.get(e,ga)}getXmlFragment(e=""){return this.get(e,qi)}toJSON(){const e={};return this.share.forEach((n,r)=>{e[r]=n.toJSON()}),e}destroy(){this.isDestroyed=!0,Yi(this.subdocs).forEach(n=>n.destroy());const e=this._item;if(e!==null){this._item=null;const n=e.content;n.doc=new ro({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=e,Ge(e.parent.doc,r=>{const s=n.doc;e.deleted||r.subdocsAdded.add(s),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class MF{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return Ne(this.restDecoder)}readDsLen(){return Ne(this.restDecoder)}}class Ux extends MF{readLeftID(){return Ee(Ne(this.restDecoder),Ne(this.restDecoder))}readRightID(){return Ee(Ne(this.restDecoder),Ne(this.restDecoder))}readClient(){return Ne(this.restDecoder)}readInfo(){return ha(this.restDecoder)}readString(){return jo(this.restDecoder)}readParentInfo(){return Ne(this.restDecoder)===1}readTypeRef(){return Ne(this.restDecoder)}readLen(){return Ne(this.restDecoder)}readAny(){return nc(this.restDecoder)}readBuf(){return mF(Mn(this.restDecoder))}readJSON(){return JSON.parse(jo(this.restDecoder))}readKey(){return jo(this.restDecoder)}}class NF{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Ne(this.restDecoder),this.dsCurrVal}readDsLen(){const e=Ne(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class Vd extends NF{constructor(e){super(e),this.keys=[],Ne(e),this.keyClockDecoder=new zh(Mn(e)),this.clientDecoder=new Xu(Mn(e)),this.leftClockDecoder=new zh(Mn(e)),this.rightClockDecoder=new zh(Mn(e)),this.infoDecoder=new hS(Mn(e),ha),this.stringDecoder=new Y7(Mn(e)),this.parentInfoDecoder=new hS(Mn(e),ha),this.typeRefDecoder=new Xu(Mn(e)),this.lenDecoder=new Xu(Mn(e))}readLeftID(){return new Wo(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Wo(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return nc(this.restDecoder)}readBuf(){return Mn(this.restDecoder)}readJSON(){return nc(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class AF{constructor(){this.restEncoder=Pf()}toUint8Array(){return Ur(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){Be(this.restEncoder,e)}writeDsLen(e){Be(this.restEncoder,e)}}class Bx extends AF{writeLeftID(e){Be(this.restEncoder,e.client),Be(this.restEncoder,e.clock)}writeRightID(e){Be(this.restEncoder,e.client),Be(this.restEncoder,e.clock)}writeClient(e){Be(this.restEncoder,e)}writeInfo(e){Bm(this.restEncoder,e)}writeString(e){zo(this.restEncoder,e)}writeParentInfo(e){Be(this.restEncoder,e?1:0)}writeTypeRef(e){Be(this.restEncoder,e)}writeLen(e){Be(this.restEncoder,e)}writeAny(e){tc(this.restEncoder,e)}writeBuf(e){Rn(this.restEncoder,e)}writeJSON(e){zo(this.restEncoder,JSON.stringify(e))}writeKey(e){zo(this.restEncoder,e)}}class DF{constructor(){this.restEncoder=Pf(),this.dsCurrVal=0}toUint8Array(){return Ur(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const n=e-this.dsCurrVal;this.dsCurrVal=e,Be(this.restEncoder,n)}writeDsLen(e){e===0&&jr(),Be(this.restEncoder,e-1),this.dsCurrVal+=e}}class Bf extends DF{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Hh,this.clientEncoder=new Gu,this.leftClockEncoder=new Hh,this.rightClockEncoder=new Hh,this.infoEncoder=new uS(Bm),this.stringEncoder=new U7,this.parentInfoEncoder=new uS(Bm),this.typeRefEncoder=new Gu,this.lenEncoder=new Gu}toUint8Array(){const e=Pf();return Be(e,0),Rn(e,this.keyClockEncoder.toUint8Array()),Rn(e,this.clientEncoder.toUint8Array()),Rn(e,this.leftClockEncoder.toUint8Array()),Rn(e,this.rightClockEncoder.toUint8Array()),Rn(e,Ur(this.infoEncoder)),Rn(e,this.stringEncoder.toUint8Array()),Rn(e,Ur(this.parentInfoEncoder)),Rn(e,this.typeRefEncoder.toUint8Array()),Rn(e,this.lenEncoder.toUint8Array()),$f(e,Ur(this.restEncoder)),Ur(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){tc(this.restEncoder,e)}writeBuf(e){Rn(this.restEncoder,e)}writeJSON(e){tc(this.restEncoder,e)}writeKey(e){const n=this.keyMap.get(e);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(n)}}const OF=(t,e,n,r)=>{r=ba(r,e[0].id.clock);const s=Wr(e,r);Be(t.restEncoder,e.length-s),t.writeClient(n),Be(t.restEncoder,r);const i=e[s];i.write(t,r-i.id.clock);for(let o=s+1;o<e.length;o++)e[o].write(t,0)},Hx=(t,e,n)=>{const r=new Map;n.forEach((s,i)=>{It(e,i)>s&&r.set(i,s)}),Q0(e).forEach((s,i)=>{n.has(i)||r.set(i,0)}),Be(t.restEncoder,r.size),Yi(r.entries()).sort((s,i)=>i[0]-s[0]).forEach(([s,i])=>{OF(t,e.clients.get(s),s,i)})},LF=(t,e)=>{const n=xr(),r=Ne(t.restDecoder);for(let s=0;s<r;s++){const i=Ne(t.restDecoder),o=new Array(i),a=t.readClient();let l=Ne(t.restDecoder);n.set(a,{i:0,refs:o});for(let c=0;c<i;c++){const d=t.readInfo();switch(Ff&d){case 0:{const u=t.readLen();o[c]=new tr(Ee(a,l),u),l+=u;break}case 10:{const u=Ne(t.restDecoder);o[c]=new Sr(Ee(a,l),u),l+=u;break}default:{const u=(d&(os|Un))===0,f=new tt(Ee(a,l),null,(d&Un)===Un?t.readLeftID():null,null,(d&os)===os?t.readRightID():null,u?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,u&&(d&Zl)===Zl?t.readString():null,fI(t,d));o[c]=f,l+=f.length}}}}return n},FF=(t,e,n)=>{const r=[];let s=Yi(n.keys()).sort((h,p)=>h-p);if(s.length===0)return null;const i=()=>{if(s.length===0)return null;let h=n.get(s[s.length-1]);for(;h.refs.length===h.i;)if(s.pop(),s.length>0)h=n.get(s[s.length-1]);else return null;return h};let o=i();if(o===null)return null;const a=new Wx,l=new Map,c=(h,p)=>{const m=l.get(h);(m==null||m>p)&&l.set(h,p)};let d=o.refs[o.i++];const u=new Map,f=()=>{for(const h of r){const p=h.id.client,m=n.get(p);m?(m.i--,a.clients.set(p,m.refs.slice(m.i)),n.delete(p),m.i=0,m.refs=[]):a.clients.set(p,[h]),s=s.filter(_=>_!==p)}r.length=0};for(;;){if(d.constructor!==Sr){const p=mi(u,d.id.client,()=>It(e,d.id.client))-d.id.clock;if(p<0)r.push(d),c(d.id.client,d.id.clock-1),f();else{const m=d.getMissing(t,e);if(m!==null){r.push(d);const _=n.get(m)||{refs:[],i:0};if(_.refs.length===_.i)c(m,It(e,m)),f();else{d=_.refs[_.i++];continue}}else(p===0||p<d.length)&&(d.integrate(t,p),u.set(d.id.client,d.id.clock+d.length))}}if(r.length>0)d=r.pop();else if(o!==null&&o.i<o.refs.length)d=o.refs[o.i++];else{if(o=i(),o===null)break;d=o.refs[o.i++]}}if(a.clients.size>0){const h=new Bf;return Hx(h,a,new Map),Be(h.restEncoder,0),{missing:l,update:h.toUint8Array()}}return null},PF=(t,e)=>Hx(t,e.doc.store,e.beforeState),$F=(t,e,n,r=new Vd(t))=>Ge(e,s=>{s.local=!1;let i=!1;const o=s.doc,a=o.store,l=LF(r,o),c=FF(s,a,l),d=a.pendingStructs;if(d){for(const[f,h]of d.missing)if(h<It(a,f)){i=!0;break}if(c){for(const[f,h]of c.missing){const p=d.missing.get(f);(p==null||p>h)&&d.missing.set(f,h)}d.update=Xm([d.update,c.update])}}else a.pendingStructs=c;const u=yS(r,s,a);if(a.pendingDs){const f=new Vd(V0(a.pendingDs));Ne(f.restDecoder);const h=yS(f,s,a);u&&h?a.pendingDs=Xm([u,h]):a.pendingDs=u||h}else a.pendingDs=u;if(i){const f=a.pendingStructs.update;a.pendingStructs=null,zx(s.doc,f)}},n,!1),zx=(t,e,n,r=Vd)=>{const s=V0(e);$F(s,t,n,new r(s))},Wm=(t,e,n)=>zx(t,e,n,Ux);class UF{constructor(){this.l=[]}}const wS=()=>new UF,SS=(t,e)=>t.l.push(e),vS=(t,e)=>{const n=t.l,r=n.length;t.l=n.filter(s=>e!==s),r===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},jx=(t,e,n)=>Y0(t.l,[e,n]);class Wo{constructor(e,n){this.client=e,this.clock=n}}const wu=(t,e)=>t===e||t!==null&&e!==null&&t.client===e.client&&t.clock===e.clock,Ee=(t,e)=>new Wo(t,e),BF=t=>{for(const[e,n]of t.doc.share.entries())if(n===t)return e;throw jr()},Gd=(t,e)=>{for(;e!==null;){if(e.parent===t)return!0;e=e.parent._item}return!1},mo=(t,e)=>e===void 0?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!Ac(e.ds,t.id),Vm=(t,e)=>{const n=mi(t.meta,Vm,fa),r=t.doc.store;n.has(e)||(e.sv.forEach((s,i)=>{s<It(r,i)&&_n(t,Ee(i,s))}),pa(t,e.ds,s=>{}),n.add(e))};class Wx{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Q0=t=>{const e=new Map;return t.clients.forEach((n,r)=>{const s=n[n.length-1];e.set(r,s.id.clock+s.length)}),e},It=(t,e)=>{const n=t.clients.get(e);if(n===void 0)return 0;const r=n[n.length-1];return r.id.clock+r.length},Vx=(t,e)=>{let n=t.clients.get(e.id.client);if(n===void 0)n=[],t.clients.set(e.id.client,n);else{const r=n[n.length-1];if(r.id.clock+r.length!==e.id.clock)throw jr()}n.push(e)},Wr=(t,e)=>{let n=0,r=t.length-1,s=t[r],i=s.id.clock;if(i===e)return r;let o=si(e/(i+s.length-1)*r);for(;n<=r;){if(s=t[o],i=s.id.clock,i<=e){if(e<i+s.length)return o;n=o+1}else r=o-1;o=si((n+r)/2)}throw jr()},HF=(t,e)=>{const n=t.clients.get(e.client);return n[Wr(n,e.clock)]},Yu=HF,Gm=(t,e,n)=>{const r=Wr(e,n),s=e[r];return s.id.clock<n&&s instanceof tt?(e.splice(r+1,0,Qd(t,s,n-s.id.clock)),r+1):r},_n=(t,e)=>{const n=t.doc.store.clients.get(e.client);return n[Gm(t,n,e.clock)]},_S=(t,e,n)=>{const r=e.clients.get(n.client),s=Wr(r,n.clock),i=r[s];return n.clock!==i.id.clock+i.length-1&&i.constructor!==tr&&r.splice(s+1,0,Qd(t,i,n.clock-i.id.clock+1)),i},zF=(t,e,n)=>{const r=t.clients.get(e.id.client);r[Wr(r,e.id.clock)]=n},Gx=(t,e,n,r,s)=>{if(r===0)return;const i=n+r;let o=Gm(t,e,n),a;do a=e[o++],i<a.id.clock+a.length&&Gm(t,e,i),s(a);while(o<e.length&&e[o].id.clock<i)};class jF{constructor(e,n,r){this.doc=e,this.deleteSet=new Nc,this.beforeState=Q0(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const CS=(t,e)=>e.deleteSet.clients.size===0&&!w7(e.afterState,(n,r)=>e.beforeState.get(r)!==n)?!1:(K0(e.deleteSet),PF(t,e),J0(t,e.deleteSet),!0),ES=(t,e,n)=>{const r=e._item;(r===null||r.id.clock<(t.beforeState.get(r.id.client)||0)&&!r.deleted)&&mi(t.changed,e,fa).add(n)},qu=(t,e)=>{let n=t[e],r=t[e-1],s=e;for(;s>0;n=r,r=t[--s-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof tt&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}const i=e-s;return i&&t.splice(e+1-i,i),i},WF=(t,e,n)=>{for(const[r,s]of t.clients.entries()){const i=e.clients.get(r);for(let o=s.length-1;o>=0;o--){const a=s[o],l=a.clock+a.len;for(let c=Wr(i,a.clock),d=i[c];c<i.length&&d.id.clock<l;d=i[++c]){const u=i[c];if(a.clock+a.len<=u.id.clock)break;u instanceof tt&&u.deleted&&!u.keep&&n(u)&&u.gc(e,!1)}}}},VF=(t,e)=>{t.clients.forEach((n,r)=>{const s=e.clients.get(r);for(let i=n.length-1;i>=0;i--){const o=n[i],a=vx(s.length-1,1+Wr(s,o.clock+o.len-1));for(let l=a,c=s[l];l>0&&c.id.clock>=o.clock;c=s[l])l-=1+qu(s,l)}})},Xx=(t,e)=>{if(e<t.length){const n=t[e],r=n.doc,s=r.store,i=n.deleteSet,o=n._mergeStructs;try{K0(i),n.afterState=Q0(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const a=[];n.changed.forEach((l,c)=>a.push(()=>{(c._item===null||!c._item.deleted)&&c._callObserver(n,l)})),a.push(()=>{n.changedParentTypes.forEach((l,c)=>{c._dEH.l.length>0&&(c._item===null||!c._item.deleted)&&(l=l.filter(d=>d.target._item===null||!d.target._item.deleted),l.forEach(d=>{d.currentTarget=c,d._path=null}),l.sort((d,u)=>d.path.length-u.path.length),jx(c._dEH,l,n))})}),a.push(()=>r.emit("afterTransaction",[n,r])),Y0(a,[]),n._needFormattingCleanup&&hP(n)}finally{r.gc&&WF(i,s,r.gcFilter),VF(i,s),n.afterState.forEach((d,u)=>{const f=n.beforeState.get(u)||0;if(f!==d){const h=s.clients.get(u),p=ba(Wr(h,f),1);for(let m=h.length-1;m>=p;)m-=1+qu(h,m)}});for(let d=o.length-1;d>=0;d--){const{client:u,clock:f}=o[d].id,h=s.clients.get(u),p=Wr(h,f);p+1<h.length&&qu(h,p+1)>1||p>0&&qu(h,p)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(IF(q0,Mx,"[yjs] ",Nx,Ax,"Changed the client-id because another client seems to be using it."),r.clientID=$x()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const d=new Bx;CS(d,n)&&r.emit("update",[d.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const d=new Bf;CS(d,n)&&r.emit("updateV2",[d.toUint8Array(),n.origin,r,n])}const{subdocsAdded:a,subdocsLoaded:l,subdocsRemoved:c}=n;(a.size>0||c.size>0||l.size>0)&&(a.forEach(d=>{d.clientID=r.clientID,d.collectionid==null&&(d.collectionid=r.collectionid),r.subdocs.add(d)}),c.forEach(d=>r.subdocs.delete(d)),r.emit("subdocs",[{loaded:l,added:a,removed:c},r,n]),c.forEach(d=>d.destroy())),t.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,t])):Xx(t,e+1)}}},Ge=(t,e,n=null,r=!0)=>{const s=t._transactionCleanups;let i=!1,o=null;t._transaction===null&&(i=!0,t._transaction=new jF(t,n,r),s.push(t._transaction),s.length===1&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{o=e(t._transaction)}finally{if(i){const a=t._transaction===s[0];t._transaction=null,a&&Xx(s,0)}}return o};class GF{constructor(e,n){this.insertions=n,this.deletions=e,this.meta=new Map}}const kS=(t,e,n)=>{pa(t,n.deletions,r=>{r instanceof tt&&e.scope.some(s=>Gd(s,r))&&r1(r,!1)})},xS=(t,e,n)=>{let r=null;const s=t.doc,i=t.scope;Ge(s,a=>{for(;e.length>0&&t.currStackItem===null;){const l=s.store,c=e.pop(),d=new Set,u=[];let f=!1;pa(a,c.insertions,h=>{if(h instanceof tt){if(h.redone!==null){let{item:p,diff:m}=BP(l,h.id);m>0&&(p=_n(a,Ee(p.id.client,p.id.clock+m))),h=p}!h.deleted&&i.some(p=>Gd(p,h))&&u.push(h)}}),pa(a,c.deletions,h=>{h instanceof tt&&i.some(p=>Gd(p,h))&&!Ac(c.insertions,h.id)&&d.add(h)}),d.forEach(h=>{f=dI(a,h,d,c.insertions,t.ignoreRemoteMapChanges,t)!==null||f});for(let h=u.length-1;h>=0;h--){const p=u[h];t.deleteFilter(p)&&(p.delete(a),f=!0)}t.currStackItem=f?c:null}a.changed.forEach((l,c)=>{l.has(null)&&c._searchMarker&&(c._searchMarker.length=0)}),r=a},t);const o=t.currStackItem;if(o!=null){const a=r.changedParentTypes;t.emit("stack-item-popped",[{stackItem:o,type:n,changedParentTypes:a,origin:t},t]),t.currStackItem=null}return o};class XF extends Sx{constructor(e,{captureTimeout:n=500,captureTransaction:r=l=>!0,deleteFilter:s=()=>!0,trackedOrigins:i=new Set([null]),ignoreRemoteMapChanges:o=!1,doc:a=$m(e)?e[0].doc:e.doc}={}){super(),this.scope=[],this.doc=a,this.addToScope(e),this.deleteFilter=s,i.add(this),this.trackedOrigins=i,this.captureTransaction=r,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=o,this.captureTimeout=n,this.afterTransactionHandler=l=>{if(!this.captureTransaction(l)||!this.scope.some(_=>l.changedParentTypes.has(_))||!this.trackedOrigins.has(l.origin)&&(!l.origin||!this.trackedOrigins.has(l.origin.constructor)))return;const c=this.undoing,d=this.redoing,u=c?this.redoStack:this.undoStack;c?this.stopCapturing():d||this.clear(!1,!0);const f=new Nc;l.afterState.forEach((_,g)=>{const y=l.beforeState.get(g)||0,w=_-y;w>0&&sc(f,g,y,w)});const h=Q7();let p=!1;if(this.lastChange>0&&h-this.lastChange<this.captureTimeout&&u.length>0&&!c&&!d){const _=u[u.length-1];_.deletions=jm([_.deletions,l.deleteSet]),_.insertions=jm([_.insertions,f])}else u.push(new GF(l.deleteSet,f)),p=!0;!c&&!d&&(this.lastChange=h),pa(l,l.deleteSet,_=>{_ instanceof tt&&this.scope.some(g=>Gd(g,_))&&r1(_,!0)});const m=[{stackItem:u[u.length-1],origin:l.origin,type:c?"redo":"undo",changedParentTypes:l.changedParentTypes},this];p?this.emit("stack-item-added",m):this.emit("stack-item-updated",m)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){e=$m(e)?e:[e],e.forEach(n=>{this.scope.every(r=>r!==n)&&(n.doc!==this.doc&&Ox("[yjs#509] Not same Y.Doc"),this.scope.push(n))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,n=!0){(e&&this.canUndo()||n&&this.canRedo())&&this.doc.transact(r=>{e&&(this.undoStack.forEach(s=>kS(r,this,s)),this.undoStack=[]),n&&(this.redoStack.forEach(s=>kS(r,this,s)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:n}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let e;try{e=xS(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){this.redoing=!0;let e;try{e=xS(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*YF(t){const e=Ne(t.restDecoder);for(let n=0;n<e;n++){const r=Ne(t.restDecoder),s=t.readClient();let i=Ne(t.restDecoder);for(let o=0;o<r;o++){const a=t.readInfo();if(a===10){const l=Ne(t.restDecoder);yield new Sr(Ee(s,i),l),i+=l}else if(Ff&a){const l=(a&(os|Un))===0,c=new tt(Ee(s,i),null,(a&Un)===Un?t.readLeftID():null,null,(a&os)===os?t.readRightID():null,l?t.readParentInfo()?t.readString():t.readLeftID():null,l&&(a&Zl)===Zl?t.readString():null,fI(t,a));yield c,i+=c.length}else{const l=t.readLen();yield new tr(Ee(s,i),l),i+=l}}}}class qF{constructor(e,n){this.gen=YF(e),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Sr);return this.curr}}class KF{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const JF=t=>Xm(t,Ux,Bx),QF=(t,e)=>{if(t.constructor===tr){const{client:n,clock:r}=t.id;return new tr(Ee(n,r+e),t.length-e)}else if(t.constructor===Sr){const{client:n,clock:r}=t.id;return new Sr(Ee(n,r+e),t.length-e)}else{const n=t,{client:r,clock:s}=n.id;return new tt(Ee(r,s+e),null,Ee(r,s+e-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(e))}},Xm=(t,e=Vd,n=Bf)=>{if(t.length===1)return t[0];const r=t.map(d=>new e(V0(d)));let s=r.map(d=>new qF(d,!0)),i=null;const o=new n,a=new KF(o);for(;s=s.filter(f=>f.curr!==null),s.sort((f,h)=>{if(f.curr.id.client===h.curr.id.client){const p=f.curr.id.clock-h.curr.id.clock;return p===0?f.curr.constructor===h.curr.constructor?0:f.curr.constructor===Sr?1:-1:p}else return h.curr.id.client-f.curr.id.client}),s.length!==0;){const d=s[0],u=d.curr.id.client;if(i!==null){let f=d.curr,h=!1;for(;f!==null&&f.id.clock+f.length<=i.struct.id.clock+i.struct.length&&f.id.client>=i.struct.id.client;)f=d.next(),h=!0;if(f===null||f.id.client!==u||h&&f.id.clock>i.struct.id.clock+i.struct.length)continue;if(u!==i.struct.id.client)ja(a,i.struct,i.offset),i={struct:f,offset:0},d.next();else if(i.struct.id.clock+i.struct.length<f.id.clock)if(i.struct.constructor===Sr)i.struct.length=f.id.clock+f.length-i.struct.id.clock;else{ja(a,i.struct,i.offset);const p=f.id.clock-i.struct.id.clock-i.struct.length;i={struct:new Sr(Ee(u,i.struct.id.clock+i.struct.length),p),offset:0}}else{const p=i.struct.id.clock+i.struct.length-f.id.clock;p>0&&(i.struct.constructor===Sr?i.struct.length-=p:f=QF(f,p)),i.struct.mergeWith(f)||(ja(a,i.struct,i.offset),i={struct:f,offset:0},d.next())}}else i={struct:d.curr,offset:0},d.next();for(let f=d.curr;f!==null&&f.id.client===u&&f.id.clock===i.struct.id.clock+i.struct.length&&f.constructor!==Sr;f=d.next())ja(a,i.struct,i.offset),i={struct:f,offset:0}}i!==null&&(ja(a,i.struct,i.offset),i=null),ZF(a);const l=r.map(d=>RF(d)),c=jm(l);return J0(o,c),o.toUint8Array()},Yx=t=>{t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:Ur(t.encoder.restEncoder)}),t.encoder.restEncoder=Pf(),t.written=0)},ja=(t,e,n)=>{t.written>0&&t.currClient!==e.id.client&&Yx(t),t.written===0&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),Be(t.encoder.restEncoder,e.id.clock+n)),e.write(t.encoder,n),t.written++},ZF=t=>{Yx(t);const e=t.encoder.restEncoder;Be(e,t.clientStructs.length);for(let n=0;n<t.clientStructs.length;n++){const r=t.clientStructs[n];Be(e,r.written),$f(e,r.restEncoder)}},IS="You must not compute changes after the event-handler fired.";class Hf{constructor(e,n){this.target=e,this.currentTarget=e,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=eP(this.currentTarget,this.target))}deletes(e){return Ac(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw ii(IS);const e=new Map,n=this.target;this.transaction.changed.get(n).forEach(s=>{if(s!==null){const i=n._map.get(s);let o,a;if(this.adds(i)){let l=i.left;for(;l!==null&&this.adds(l);)l=l.left;if(this.deletes(i))if(l!==null&&this.deletes(l))o="delete",a=$h(l.content.getContent());else return;else l!==null&&this.deletes(l)?(o="update",a=$h(l.content.getContent())):(o="add",a=void 0)}else if(this.deletes(i))o="delete",a=$h(i.content.getContent());else return;e.set(s,{action:o,oldValue:a})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw ii(IS);const n=this.target,r=fa(),s=fa(),i=[];if(e={added:r,deleted:s,delta:i,keys:this.keys},this.transaction.changed.get(n).has(null)){let a=null;const l=()=>{a&&i.push(a)};for(let c=n._start;c!==null;c=c.right)c.deleted?this.deletes(c)&&!this.adds(c)&&((a===null||a.delete===void 0)&&(l(),a={delete:0}),a.delete+=c.length,s.add(c)):this.adds(c)?((a===null||a.insert===void 0)&&(l(),a={insert:[]}),a.insert=a.insert.concat(c.content.getContent()),r.add(c)):((a===null||a.retain===void 0)&&(l(),a={retain:0}),a.retain+=c.length);a!==null&&a.retain===void 0&&l()}this._changes=e}return e}}const eP=(t,e)=>{const n=[];for(;e._item!==null&&e!==t;){if(e._item.parentSub!==null)n.unshift(e._item.parentSub);else{let r=0,s=e._item.parent._start;for(;s!==e._item&&s!==null;)!s.deleted&&s.countable&&(r+=s.length),s=s.right;n.unshift(r)}e=e._item.parent}return n},Zt=()=>{Ox("Invalid access: Add Yjs type to a document before reading data.")},qx=80;let Z0=0;class tP{constructor(e,n){e.marker=!0,this.p=e,this.index=n,this.timestamp=Z0++}}const nP=t=>{t.timestamp=Z0++},Kx=(t,e,n)=>{t.p.marker=!1,t.p=e,e.marker=!0,t.index=n,t.timestamp=Z0++},rP=(t,e,n)=>{if(t.length>=qx){const r=t.reduce((s,i)=>s.timestamp<i.timestamp?s:i);return Kx(r,e,n),r}else{const r=new tP(e,n);return t.push(r),r}},zf=(t,e)=>{if(t._start===null||e===0||t._searchMarker===null)return null;const n=t._searchMarker.length===0?null:t._searchMarker.reduce((i,o)=>Vu(e-i.index)<Vu(e-o.index)?i:o);let r=t._start,s=0;for(n!==null&&(r=n.p,s=n.index,nP(n));r.right!==null&&s<e;){if(!r.deleted&&r.countable){if(e<s+r.length)break;s+=r.length}r=r.right}for(;r.left!==null&&s>e;)r=r.left,!r.deleted&&r.countable&&(s-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(s-=r.length);return n!==null&&Vu(n.index-s)<r.parent.length/qx?(Kx(n,r,s),n):rP(t._searchMarker,r,s)},ic=(t,e,n)=>{for(let r=t.length-1;r>=0;r--){const s=t[r];if(n>0){let i=s.p;for(i.marker=!1;i&&(i.deleted||!i.countable);)i=i.left,i&&!i.deleted&&i.countable&&(s.index-=i.length);if(i===null||i.marker===!0){t.splice(r,1);continue}s.p=i,i.marker=!0}(e<s.index||n>0&&e===s.index)&&(s.index=ba(e,s.index+n))}},jf=(t,e,n)=>{const r=t,s=e.changedParentTypes;for(;mi(s,t,()=>[]).push(n),t._item!==null;)t=t._item.parent;jx(r._eH,n,e)};class Wt{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=wS(),this._dEH=wS(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,n){this.doc=e,this._item=n}_copy(){throw zr()}clone(){throw zr()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,n){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){SS(this._eH,e)}observeDeep(e){SS(this._dEH,e)}unobserve(e){vS(this._eH,e)}unobserveDeep(e){vS(this._dEH,e)}toJSON(){}}const Jx=(t,e,n)=>{t.doc??Zt(),e<0&&(e=t._length+e),n<0&&(n=t._length+n);let r=n-e;const s=[];let i=t._start;for(;i!==null&&r>0;){if(i.countable&&!i.deleted){const o=i.content.getContent();if(o.length<=e)e-=o.length;else{for(let a=e;a<o.length&&r>0;a++)s.push(o[a]),r--;e=0}}i=i.right}return s},Qx=t=>{t.doc??Zt();const e=[];let n=t._start;for(;n!==null;){if(n.countable&&!n.deleted){const r=n.content.getContent();for(let s=0;s<r.length;s++)e.push(r[s])}n=n.right}return e},oc=(t,e)=>{let n=0,r=t._start;for(t.doc??Zt();r!==null;){if(r.countable&&!r.deleted){const s=r.content.getContent();for(let i=0;i<s.length;i++)e(s[i],n++,t)}r=r.right}},Zx=(t,e)=>{const n=[];return oc(t,(r,s)=>{n.push(e(r,s,t))}),n},sP=t=>{let e=t._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};n=e.content.getContent(),r=0,e=e.right}const s=n[r++];return n.length<=r&&(n=null),{done:!1,value:s}}}},eI=(t,e)=>{t.doc??Zt();const n=zf(t,e);let r=t._start;for(n!==null&&(r=n.p,e-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},Xd=(t,e,n,r)=>{let s=n;const i=t.doc,o=i.clientID,a=i.store,l=n===null?e._start:n.right;let c=[];const d=()=>{c.length>0&&(s=new tt(Ee(o,It(a,o)),s,s&&s.lastId,l,l&&l.id,e,null,new Ki(c)),s.integrate(t,0),c=[])};r.forEach(u=>{if(u===null)c.push(u);else switch(u.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(u);break;default:switch(d(),u.constructor){case Uint8Array:case ArrayBuffer:s=new tt(Ee(o,It(a,o)),s,s&&s.lastId,l,l&&l.id,e,null,new Dc(new Uint8Array(u))),s.integrate(t,0);break;case ro:s=new tt(Ee(o,It(a,o)),s,s&&s.lastId,l,l&&l.id,e,null,new Oc(u)),s.integrate(t,0);break;default:if(u instanceof Wt)s=new tt(Ee(o,It(a,o)),s,s&&s.lastId,l,l&&l.id,e,null,new vs(u)),s.integrate(t,0);else throw new Error("Unexpected content type in insert operation")}}}),d()},tI=()=>ii("Length exceeded!"),nI=(t,e,n,r)=>{if(n>e._length)throw tI();if(n===0)return e._searchMarker&&ic(e._searchMarker,n,r.length),Xd(t,e,null,r);const s=n,i=zf(e,n);let o=e._start;for(i!==null&&(o=i.p,n-=i.index,n===0&&(o=o.prev,n+=o&&o.countable&&!o.deleted?o.length:0));o!==null;o=o.right)if(!o.deleted&&o.countable){if(n<=o.length){n<o.length&&_n(t,Ee(o.id.client,o.id.clock+n));break}n-=o.length}return e._searchMarker&&ic(e._searchMarker,s,r.length),Xd(t,e,o,r)},iP=(t,e,n)=>{let s=(e._searchMarker||[]).reduce((i,o)=>o.index>i.index?o:i,{index:0,p:e._start}).p;if(s)for(;s.right;)s=s.right;return Xd(t,e,s,n)},rI=(t,e,n,r)=>{if(r===0)return;const s=n,i=r,o=zf(e,n);let a=e._start;for(o!==null&&(a=o.p,n-=o.index);a!==null&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&_n(t,Ee(a.id.client,a.id.clock+n)),n-=a.length);for(;r>0&&a!==null;)a.deleted||(r<a.length&&_n(t,Ee(a.id.client,a.id.clock+r)),a.delete(t),r-=a.length),a=a.right;if(r>0)throw tI();e._searchMarker&&ic(e._searchMarker,s,-i+r)},Yd=(t,e,n)=>{const r=e._map.get(n);r!==void 0&&r.delete(t)},e1=(t,e,n,r)=>{const s=e._map.get(n)||null,i=t.doc,o=i.clientID;let a;if(r==null)a=new Ki([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:a=new Ki([r]);break;case Uint8Array:a=new Dc(r);break;case ro:a=new Oc(r);break;default:if(r instanceof Wt)a=new vs(r);else throw new Error("Unexpected content type")}new tt(Ee(o,It(i.store,o)),s,s&&s.lastId,null,null,e,n,a).integrate(t,0)},t1=(t,e)=>{t.doc??Zt();const n=t._map.get(e);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},sI=t=>{const e={};return t.doc??Zt(),t._map.forEach((n,r)=>{n.deleted||(e[r]=n.content.getContent()[n.length-1])}),e},iI=(t,e)=>{t.doc??Zt();const n=t._map.get(e);return n!==void 0&&!n.deleted},oP=(t,e)=>{const n={};return t._map.forEach((r,s)=>{let i=r;for(;i!==null&&(!e.sv.has(i.id.client)||i.id.clock>=(e.sv.get(i.id.client)||0));)i=i.left;i!==null&&mo(i,e)&&(n[s]=i.content.getContent()[i.length-1])}),n},Su=t=>(t.doc??Zt(),bF(t._map.entries(),e=>!e[1].deleted));class aP extends Hf{}class Vo extends Wt{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const n=new Vo;return n.push(e),n}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Vo}clone(){const e=new Vo;return e.insert(0,this.toArray().map(n=>n instanceof Wt?n.clone():n)),e}get length(){return this.doc??Zt(),this._length}_callObserver(e,n){super._callObserver(e,n),jf(this,e,new aP(this,e))}insert(e,n){this.doc!==null?Ge(this.doc,r=>{nI(r,this,e,n)}):this._prelimContent.splice(e,0,...n)}push(e){this.doc!==null?Ge(this.doc,n=>{iP(n,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,n=1){this.doc!==null?Ge(this.doc,r=>{rI(r,this,e,n)}):this._prelimContent.splice(e,n)}get(e){return eI(this,e)}toArray(){return Qx(this)}slice(e=0,n=this.length){return Jx(this,e,n)}toJSON(){return this.map(e=>e instanceof Wt?e.toJSON():e)}map(e){return Zx(this,e)}forEach(e){oc(this,e)}[Symbol.iterator](){return sP(this)}_write(e){e.writeTypeRef(AP)}}const lP=t=>new Vo;class cP extends Hf{constructor(e,n,r){super(e,n),this.keysChanged=r}}class Oe extends Wt{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,n){super._integrate(e,n),this._prelimContent.forEach((r,s)=>{this.set(s,r)}),this._prelimContent=null}_copy(){return new Oe}clone(){const e=new Oe;return this.forEach((n,r)=>{e.set(r,n instanceof Wt?n.clone():n)}),e}_callObserver(e,n){jf(this,e,new cP(this,e,n))}toJSON(){this.doc??Zt();const e={};return this._map.forEach((n,r)=>{if(!n.deleted){const s=n.content.getContent()[n.length-1];e[r]=s instanceof Wt?s.toJSON():s}}),e}get size(){return[...Su(this)].length}keys(){return jh(Su(this),e=>e[0])}values(){return jh(Su(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return jh(Su(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??Zt(),this._map.forEach((n,r)=>{n.deleted||e(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?Ge(this.doc,n=>{Yd(n,this,e)}):this._prelimContent.delete(e)}set(e,n){return this.doc!==null?Ge(this.doc,r=>{e1(r,this,e,n)}):this._prelimContent.set(e,n),n}get(e){return t1(this,e)}has(e){return iI(this,e)}clear(){this.doc!==null?Ge(this.doc,e=>{this.forEach(function(n,r,s){Yd(e,s,r)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(DP)}}const uP=t=>new Oe,Us=(t,e)=>t===e||typeof t=="object"&&typeof e=="object"&&t&&e&&lF(t,e);class Ym{constructor(e,n,r,s){this.left=e,this.right=n,this.index=r,this.currentAttributes=s}forward(){switch(this.right===null&&jr(),this.right.content.constructor){case bt:this.right.deleted||Ta(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const bS=(t,e,n)=>{for(;e.right!==null&&n>0;){switch(e.right.content.constructor){case bt:e.right.deleted||Ta(e.currentAttributes,e.right.content);break;default:e.right.deleted||(n<e.right.length&&_n(t,Ee(e.right.id.client,e.right.id.clock+n)),e.index+=e.right.length,n-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},vu=(t,e,n,r)=>{const s=new Map,i=r?zf(e,n):null;if(i){const o=new Ym(i.p.left,i.p,i.index,s);return bS(t,o,n-i.index)}else{const o=new Ym(null,e._start,0,s);return bS(t,o,n)}},oI=(t,e,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===bt&&Us(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const s=t.doc,i=s.clientID;r.forEach((o,a)=>{const l=n.left,c=n.right,d=new tt(Ee(i,It(s.store,i)),l,l&&l.lastId,c,c&&c.id,e,null,new bt(a,o));d.integrate(t,0),n.right=d,n.forward()})},Ta=(t,e)=>{const{key:n,value:r}=e;r===null?t.delete(n):t.set(n,r)},aI=(t,e)=>{for(;t.right!==null;){if(!(t.right.deleted||t.right.content.constructor===bt&&Us(e[t.right.content.key]??null,t.right.content.value)))break;t.forward()}},lI=(t,e,n,r)=>{const s=t.doc,i=s.clientID,o=new Map;for(const a in r){const l=r[a],c=n.currentAttributes.get(a)??null;if(!Us(c,l)){o.set(a,c);const{left:d,right:u}=n;n.right=new tt(Ee(i,It(s.store,i)),d,d&&d.lastId,u,u&&u.id,e,null,new bt(a,l)),n.right.integrate(t,0),n.forward()}}return o},Wh=(t,e,n,r,s)=>{n.currentAttributes.forEach((f,h)=>{s[h]===void 0&&(s[h]=null)});const i=t.doc,o=i.clientID;aI(n,s);const a=lI(t,e,n,s),l=r.constructor===String?new Vr(r):r instanceof Wt?new vs(r):new so(r);let{left:c,right:d,index:u}=n;e._searchMarker&&ic(e._searchMarker,n.index,l.getLength()),d=new tt(Ee(o,It(i.store,o)),c,c&&c.lastId,d,d&&d.id,e,null,l),d.integrate(t,0),n.right=d,n.index=u,n.forward(),oI(t,e,n,a)},TS=(t,e,n,r,s)=>{const i=t.doc,o=i.clientID;aI(n,s);const a=lI(t,e,n,s);e:for(;n.right!==null&&(r>0||a.size>0&&(n.right.deleted||n.right.content.constructor===bt));){if(!n.right.deleted)switch(n.right.content.constructor){case bt:{const{key:l,value:c}=n.right.content,d=s[l];if(d!==void 0){if(Us(d,c))a.delete(l);else{if(r===0)break e;a.set(l,c)}n.right.delete(t)}else n.currentAttributes.set(l,c);break}default:r<n.right.length&&_n(t,Ee(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let l="";for(;r>0;r--)l+=`
`;n.right=new tt(Ee(o,It(i.store,o)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,e,null,new Vr(l)),n.right.integrate(t,0),n.forward()}oI(t,e,n,a)},cI=(t,e,n,r,s)=>{let i=e;const o=xr();for(;i&&(!i.countable||i.deleted);){if(!i.deleted&&i.content.constructor===bt){const c=i.content;o.set(c.key,c)}i=i.right}let a=0,l=!1;for(;e!==i;){if(n===e&&(l=!0),!e.deleted){const c=e.content;switch(c.constructor){case bt:{const{key:d,value:u}=c,f=r.get(d)??null;(o.get(d)!==c||f===u)&&(e.delete(t),a++,!l&&(s.get(d)??null)===u&&f!==u&&(f===null?s.delete(d):s.set(d,f))),!l&&!e.deleted&&Ta(s,c);break}}}e=e.right}return a},dP=(t,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const n=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===bt){const r=e.content.key;n.has(r)?e.delete(t):n.add(r)}e=e.left}},fP=t=>{let e=0;return Ge(t.doc,n=>{let r=t._start,s=t._start,i=xr();const o=Pm(i);for(;s;){if(s.deleted===!1)switch(s.content.constructor){case bt:Ta(o,s.content);break;default:e+=cI(n,r,s,i,o),i=Pm(o),r=s;break}s=s.right}}),e},hP=t=>{const e=new Set,n=t.doc;for(const[r,s]of t.afterState.entries()){const i=t.beforeState.get(r)||0;s!==i&&Gx(t,n.store.clients.get(r),i,s,o=>{!o.deleted&&o.content.constructor===bt&&o.constructor!==tr&&e.add(o.parent)})}Ge(n,r=>{pa(t,t.deleteSet,s=>{if(s instanceof tr||!s.parent._hasFormatting||e.has(s.parent))return;const i=s.parent;s.content.constructor===bt?e.add(i):dP(r,s)});for(const s of e)fP(s)})},RS=(t,e,n)=>{const r=n,s=Pm(e.currentAttributes),i=e.right;for(;n>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case vs:case so:case Vr:n<e.right.length&&_n(t,Ee(e.right.id.client,e.right.id.clock+n)),n-=e.right.length,e.right.delete(t);break}e.forward()}i&&cI(t,i,e.right,s,e.currentAttributes);const o=(e.left||e.right).parent;return o._searchMarker&&ic(o._searchMarker,e.index,-r+n),e};class pP extends Hf{constructor(e,n,r){super(e,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(s=>{s===null?this.childListChanged=!0:this.keysChanged.add(s)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,n=[];Ge(e,r=>{const s=new Map,i=new Map;let o=this.target._start,a=null;const l={};let c="",d=0,u=0;const f=()=>{if(a!==null){let h=null;switch(a){case"delete":u>0&&(h={delete:u}),u=0;break;case"insert":(typeof c=="object"||c.length>0)&&(h={insert:c},s.size>0&&(h.attributes={},s.forEach((p,m)=>{p!==null&&(h.attributes[m]=p)}))),c="";break;case"retain":d>0&&(h={retain:d},iF(l)||(h.attributes=nF({},l))),d=0;break}h&&n.push(h),a=null}};for(;o!==null;){switch(o.content.constructor){case vs:case so:this.adds(o)?this.deletes(o)||(f(),a="insert",c=o.content.getContent()[0],f()):this.deletes(o)?(a!=="delete"&&(f(),a="delete"),u+=1):o.deleted||(a!=="retain"&&(f(),a="retain"),d+=1);break;case Vr:this.adds(o)?this.deletes(o)||(a!=="insert"&&(f(),a="insert"),c+=o.content.str):this.deletes(o)?(a!=="delete"&&(f(),a="delete"),u+=o.length):o.deleted||(a!=="retain"&&(f(),a="retain"),d+=o.length);break;case bt:{const{key:h,value:p}=o.content;if(this.adds(o)){if(!this.deletes(o)){const m=s.get(h)??null;Us(m,p)?p!==null&&o.delete(r):(a==="retain"&&f(),Us(p,i.get(h)??null)?delete l[h]:l[h]=p)}}else if(this.deletes(o)){i.set(h,p);const m=s.get(h)??null;Us(m,p)||(a==="retain"&&f(),l[h]=m)}else if(!o.deleted){i.set(h,p);const m=l[h];m!==void 0&&(Us(m,p)?m!==null&&o.delete(r):(a==="retain"&&f(),p===null?delete l[h]:l[h]=p))}o.deleted||(a==="insert"&&f(),Ta(s,o.content));break}}o=o.right}for(f();n.length>0;){const h=n[n.length-1];if(h.retain!==void 0&&h.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class ma extends Wt{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??Zt(),this._length}_integrate(e,n){super._integrate(e,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new ma}clone(){const e=new ma;return e.applyDelta(this.toDelta()),e}_callObserver(e,n){super._callObserver(e,n);const r=new pP(this,e,n);jf(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??Zt();let e="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===Vr&&(e+=n.content.str),n=n.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:n=!0}={}){this.doc!==null?Ge(this.doc,r=>{const s=new Ym(null,this._start,0,new Map);for(let i=0;i<e.length;i++){const o=e[i];if(o.insert!==void 0){const a=!n&&typeof o.insert=="string"&&i===e.length-1&&s.right===null&&o.insert.slice(-1)===`
`?o.insert.slice(0,-1):o.insert;(typeof a!="string"||a.length>0)&&Wh(r,this,s,a,o.attributes||{})}else o.retain!==void 0?TS(r,this,s,o.retain,o.attributes||{}):o.delete!==void 0&&RS(r,s,o.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,n,r){this.doc??Zt();const s=[],i=new Map,o=this.doc;let a="",l=this._start;function c(){if(a.length>0){const u={};let f=!1;i.forEach((p,m)=>{f=!0,u[m]=p});const h={insert:a};f&&(h.attributes=u),s.push(h),a=""}}const d=()=>{for(;l!==null;){if(mo(l,e)||n!==void 0&&mo(l,n))switch(l.content.constructor){case Vr:{const u=i.get("ychange");e!==void 0&&!mo(l,e)?(u===void 0||u.user!==l.id.client||u.type!=="removed")&&(c(),i.set("ychange",r?r("removed",l.id):{type:"removed"})):n!==void 0&&!mo(l,n)?(u===void 0||u.user!==l.id.client||u.type!=="added")&&(c(),i.set("ychange",r?r("added",l.id):{type:"added"})):u!==void 0&&(c(),i.delete("ychange")),a+=l.content.str;break}case vs:case so:{c();const u={insert:l.content.getContent()[0]};if(i.size>0){const f={};u.attributes=f,i.forEach((h,p)=>{f[p]=h})}s.push(u);break}case bt:mo(l,e)&&(c(),Ta(i,l.content));break}l=l.right}c()};return e||n?Ge(o,u=>{e&&Vm(u,e),n&&Vm(u,n),d()},"cleanup"):d(),s}insert(e,n,r){if(n.length<=0)return;const s=this.doc;s!==null?Ge(s,i=>{const o=vu(i,this,e,!r);r||(r={},o.currentAttributes.forEach((a,l)=>{r[l]=a})),Wh(i,this,o,n,r)}):this._pending.push(()=>this.insert(e,n,r))}insertEmbed(e,n,r){const s=this.doc;s!==null?Ge(s,i=>{const o=vu(i,this,e,!r);Wh(i,this,o,n,r||{})}):this._pending.push(()=>this.insertEmbed(e,n,r||{}))}delete(e,n){if(n===0)return;const r=this.doc;r!==null?Ge(r,s=>{RS(s,vu(s,this,e,!0),n)}):this._pending.push(()=>this.delete(e,n))}format(e,n,r){if(n===0)return;const s=this.doc;s!==null?Ge(s,i=>{const o=vu(i,this,e,!1);o.right!==null&&TS(i,this,o,n,r)}):this._pending.push(()=>this.format(e,n,r))}removeAttribute(e){this.doc!==null?Ge(this.doc,n=>{Yd(n,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,n){this.doc!==null?Ge(this.doc,r=>{e1(r,this,e,n)}):this._pending.push(()=>this.setAttribute(e,n))}getAttribute(e){return t1(this,e)}getAttributes(){return sI(this)}_write(e){e.writeTypeRef(OP)}}const mP=t=>new ma;class Vh{constructor(e,n=()=>!0){this._filter=n,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??Zt()}[Symbol.iterator](){return this}next(){let e=this._currentNode,n=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(n)))do if(n=e.content.type,!e.deleted&&(n.constructor===ga||n.constructor===qi)&&n._start!==null)e=n._start;else for(;e!==null;)if(e.right!==null){e=e.right;break}else e.parent===this._root?e=null:e=e.parent._item;while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class qi extends Wt{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new qi}clone(){const e=new qi;return e.insert(0,this.toArray().map(n=>n instanceof Wt?n.clone():n)),e}get length(){return this.doc??Zt(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new Vh(this,e)}querySelector(e){e=e.toUpperCase();const r=new Vh(this,s=>s.nodeName&&s.nodeName.toUpperCase()===e).next();return r.done?null:r.value}querySelectorAll(e){return e=e.toUpperCase(),Yi(new Vh(this,n=>n.nodeName&&n.nodeName.toUpperCase()===e))}_callObserver(e,n){jf(this,e,new wP(this,n,e))}toString(){return Zx(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,n={},r){const s=e.createDocumentFragment();return r!==void 0&&r._createAssociation(s,this),oc(this,i=>{s.insertBefore(i.toDOM(e,n,r),null)}),s}insert(e,n){this.doc!==null?Ge(this.doc,r=>{nI(r,this,e,n)}):this._prelimContent.splice(e,0,...n)}insertAfter(e,n){if(this.doc!==null)Ge(this.doc,r=>{const s=e&&e instanceof Wt?e._item:e;Xd(r,this,s,n)});else{const r=this._prelimContent,s=e===null?0:r.findIndex(i=>i===e)+1;if(s===0&&e!==null)throw ii("Reference item not found");r.splice(s,0,...n)}}delete(e,n=1){this.doc!==null?Ge(this.doc,r=>{rI(r,this,e,n)}):this._prelimContent.splice(e,n)}toArray(){return Qx(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return eI(this,e)}slice(e=0,n=this.length){return Jx(this,e,n)}forEach(e){oc(this,e)}_write(e){e.writeTypeRef(FP)}}const gP=t=>new qi;class ga extends qi{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,n){super._integrate(e,n),this._prelimAttrs.forEach((r,s)=>{this.setAttribute(s,r)}),this._prelimAttrs=null}_copy(){return new ga(this.nodeName)}clone(){const e=new ga(this.nodeName),n=this.getAttributes();return sF(n,(r,s)=>{typeof r=="string"&&e.setAttribute(s,r)}),e.insert(0,this.toArray().map(r=>r instanceof Wt?r.clone():r)),e}toString(){const e=this.getAttributes(),n=[],r=[];for(const a in e)r.push(a);r.sort();const s=r.length;for(let a=0;a<s;a++){const l=r[a];n.push(l+'="'+e[l]+'"')}const i=this.nodeName.toLocaleLowerCase(),o=n.length>0?" "+n.join(" "):"";return`<${i}${o}>${super.toString()}</${i}>`}removeAttribute(e){this.doc!==null?Ge(this.doc,n=>{Yd(n,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,n){this.doc!==null?Ge(this.doc,r=>{e1(r,this,e,n)}):this._prelimAttrs.set(e,n)}getAttribute(e){return t1(this,e)}hasAttribute(e){return iI(this,e)}getAttributes(e){return e?oP(this,e):sI(this)}toDOM(e=document,n={},r){const s=e.createElement(this.nodeName),i=this.getAttributes();for(const o in i){const a=i[o];typeof a=="string"&&s.setAttribute(o,a)}return oc(this,o=>{s.appendChild(o.toDOM(e,n,r))}),r!==void 0&&r._createAssociation(s,this),s}_write(e){e.writeTypeRef(LP),e.writeKey(this.nodeName)}}const yP=t=>new ga(t.readKey());class wP extends Hf{constructor(e,n,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(s=>{s===null?this.childListChanged=!0:this.attributesChanged.add(s)})}}class qd extends Oe{constructor(e){super(),this.hookName=e}_copy(){return new qd(this.hookName)}clone(){const e=new qd(this.hookName);return this.forEach((n,r)=>{e.set(r,n)}),e}toDOM(e=document,n={},r){const s=n[this.hookName];let i;return s!==void 0?i=s.createDom(this):i=document.createElement(this.hookName),i.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(i,this),i}_write(e){e.writeTypeRef(PP),e.writeKey(this.hookName)}}const SP=t=>new qd(t.readKey());class Kd extends ma{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new Kd}clone(){const e=new Kd;return e.applyDelta(this.toDelta()),e}toDOM(e=document,n,r){const s=e.createTextNode(this.toString());return r!==void 0&&r._createAssociation(s,this),s}toString(){return this.toDelta().map(e=>{const n=[];for(const s in e.attributes){const i=[];for(const o in e.attributes[s])i.push({key:o,value:e.attributes[s][o]});i.sort((o,a)=>o.key<a.key?-1:1),n.push({nodeName:s,attrs:i})}n.sort((s,i)=>s.nodeName<i.nodeName?-1:1);let r="";for(let s=0;s<n.length;s++){const i=n[s];r+=`<${i.nodeName}`;for(let o=0;o<i.attrs.length;o++){const a=i.attrs[o];r+=` ${a.key}="${a.value}"`}r+=">"}r+=e.insert;for(let s=n.length-1;s>=0;s--)r+=`</${n[s].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef($P)}}const vP=t=>new Kd;class n1{constructor(e,n){this.id=e,this.length=n}get deleted(){throw zr()}mergeWith(e){return!1}write(e,n,r){throw zr()}integrate(e,n){throw zr()}}const _P=0;class tr extends n1{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){n>0&&(this.id.clock+=n,this.length-=n),Vx(e.doc.store,this)}write(e,n){e.writeInfo(_P),e.writeLen(this.length-n)}getMissing(e,n){return null}}class Dc{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Dc(this.content)}splice(e){throw zr()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeBuf(this.content)}getRef(){return 3}}const CP=t=>new Dc(t.readBuf());class ac{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new ac(this.len)}splice(e){const n=new ac(this.len-e);return this.len=e,n}mergeWith(e){return this.len+=e.len,!0}integrate(e,n){sc(e.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(e){}gc(e){}write(e,n){e.writeLen(this.len-n)}getRef(){return 1}}const EP=t=>new ac(t.readLen()),uI=(t,e)=>new ro({guid:t,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class Oc{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const n={};this.opts=n,e.gc||(n.gc=!1),e.autoLoad&&(n.autoLoad=!0),e.meta!==null&&(n.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Oc(uI(this.doc.guid,this.opts))}splice(e){throw zr()}mergeWith(e){return!1}integrate(e,n){this.doc._item=n,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,n){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const kP=t=>new Oc(uI(t.readString(),t.readAny()));class so{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new so(this.embed)}splice(e){throw zr()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeJSON(this.embed)}getRef(){return 5}}const xP=t=>new so(t.readJSON());class bt{constructor(e,n){this.key=e,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new bt(this.key,this.value)}splice(e){throw zr()}mergeWith(e){return!1}integrate(e,n){const r=n.parent;r._searchMarker=null,r._hasFormatting=!0}delete(e){}gc(e){}write(e,n){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const IP=t=>new bt(t.readKey(),t.readJSON());class Jd{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Jd(this.arr)}splice(e){const n=new Jd(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const r=this.arr.length;e.writeLen(r-n);for(let s=n;s<r;s++){const i=this.arr[s];e.writeString(i===void 0?"undefined":JSON.stringify(i))}}getRef(){return 2}}const bP=t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++){const s=t.readString();s==="undefined"?n.push(void 0):n.push(JSON.parse(s))}return new Jd(n)},TP=Wd("node_env")==="development";class Ki{constructor(e){this.arr=e,TP&&bx(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ki(this.arr)}splice(e){const n=new Ki(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const r=this.arr.length;e.writeLen(r-n);for(let s=n;s<r;s++){const i=this.arr[s];e.writeAny(i)}}getRef(){return 8}}const RP=t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++)n.push(t.readAny());return new Ki(n)};class Vr{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Vr(this.str)}splice(e){const n=new Vr(this.str.slice(e));this.str=this.str.slice(0,e);const r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"",n.str=""+n.str.slice(1)),n}mergeWith(e){return this.str+=e.str,!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const MP=t=>new Vr(t.readString()),NP=[lP,uP,mP,yP,gP,SP,vP],AP=0,DP=1,OP=2,LP=3,FP=4,PP=5,$P=6;class vs{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new vs(this.type._copy())}splice(e){throw zr()}mergeWith(e){return!1}integrate(e,n){this.type._integrate(e.doc,n)}delete(e){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(e.beforeState.get(n.id.client)||0)&&e._mergeStructs.push(n):n.delete(e),n=n.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(e.beforeState.get(r.id.client)||0)&&e._mergeStructs.push(r):r.delete(e)}),e.changed.delete(this.type)}gc(e){let n=this.type._start;for(;n!==null;)n.gc(e,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(e,!0),r=r.left}),this.type._map=new Map}write(e,n){this.type._write(e)}getRef(){return 7}}const UP=t=>new vs(NP[t.readTypeRef()](t)),BP=(t,e)=>{let n=e,r=0,s;do r>0&&(n=Ee(n.client,n.clock+r)),s=Yu(t,n),r=n.clock-s.id.clock,n=s.redone;while(n!==null&&s instanceof tt);return{item:s,diff:r}},r1=(t,e)=>{for(;t!==null&&t.keep!==e;)t.keep=e,t=t.parent._item},Qd=(t,e,n)=>{const{client:r,clock:s}=e.id,i=new tt(Ee(r,s+n),e,Ee(r,s+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&i.markDeleted(),e.keep&&(i.keep=!0),e.redone!==null&&(i.redone=Ee(e.redone.client,e.redone.clock+n)),e.right=i,i.right!==null&&(i.right.left=i),t._mergeStructs.push(i),i.parentSub!==null&&i.right===null&&i.parent._map.set(i.parentSub,i),e.length=n,i},MS=(t,e)=>v7(t,n=>Ac(n.deletions,e)),dI=(t,e,n,r,s,i)=>{const o=t.doc,a=o.store,l=o.clientID,c=e.redone;if(c!==null)return _n(t,c);let d=e.parent._item,u=null,f;if(d!==null&&d.deleted===!0){if(d.redone===null&&(!n.has(d)||dI(t,d,n,r,s,i)===null))return null;for(;d.redone!==null;)d=_n(t,d.redone)}const h=d===null?e.parent:d.content.type;if(e.parentSub===null){for(u=e.left,f=e;u!==null;){let g=u;for(;g!==null&&g.parent._item!==d;)g=g.redone===null?null:_n(t,g.redone);if(g!==null&&g.parent._item===d){u=g;break}u=u.left}for(;f!==null;){let g=f;for(;g!==null&&g.parent._item!==d;)g=g.redone===null?null:_n(t,g.redone);if(g!==null&&g.parent._item===d){f=g;break}f=f.right}}else if(f=null,e.right&&!s){for(u=e;u!==null&&u.right!==null&&(u.right.redone||Ac(r,u.right.id)||MS(i.undoStack,u.right.id)||MS(i.redoStack,u.right.id));)for(u=u.right;u.redone;)u=_n(t,u.redone);if(u&&u.right!==null)return null}else u=h._map.get(e.parentSub)||null;const p=It(a,l),m=Ee(l,p),_=new tt(m,u,u&&u.lastId,f,f&&f.id,h,e.parentSub,e.content.copy());return e.redone=m,r1(_,!0),_.integrate(t,0),_};class tt extends n1{constructor(e,n,r,s,i,o,a,l){super(e,l.getLength()),this.origin=r,this.left=n,this.right=s,this.rightOrigin=i,this.parent=o,this.parentSub=a,this.redone=null,this.content=l,this.info=this.content.isCountable()?aS:0}set marker(e){(this.info&Bh)>0!==e&&(this.info^=Bh)}get marker(){return(this.info&Bh)>0}get keep(){return(this.info&oS)>0}set keep(e){this.keep!==e&&(this.info^=oS)}get countable(){return(this.info&aS)>0}get deleted(){return(this.info&Uh)>0}set deleted(e){this.deleted!==e&&(this.info^=Uh)}markDeleted(){this.info|=Uh}getMissing(e,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=It(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=It(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Wo&&this.id.client!==this.parent.client&&this.parent.clock>=It(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=_S(e,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=_n(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===tr||this.right&&this.right.constructor===tr)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===tt&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===tt&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===Wo){const r=Yu(n,this.parent);r.constructor===tr?this.parent=null:this.parent=r.content.type}return null}integrate(e,n){if(n>0&&(this.id.clock+=n,this.left=_S(e,e.doc.store,Ee(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,s;if(r!==null)s=r.right;else if(this.parentSub!==null)for(s=this.parent._map.get(this.parentSub)||null;s!==null&&s.left!==null;)s=s.left;else s=this.parent._start;const i=new Set,o=new Set;for(;s!==null&&s!==this.right;){if(o.add(s),i.add(s),wu(this.origin,s.origin)){if(s.id.client<this.id.client)r=s,i.clear();else if(wu(this.rightOrigin,s.rightOrigin))break}else if(s.origin!==null&&o.has(Yu(e.doc.store,s.origin)))i.has(Yu(e.doc.store,s.origin))||(r=s,i.clear());else break;s=s.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Vx(e.doc.store,this),this.content.integrate(e,this),ES(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new tr(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Ee(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&wu(e.origin,this.lastId)&&this.right===e&&wu(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===e&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),sc(e.deleteSet,this.id.client,this.id.clock,this.length),ES(e,n,this.parentSub),this.content.delete(e)}}gc(e,n){if(!this.deleted)throw jr();this.content.gc(e),n?zF(e,this,new tr(this.id,this.length)):this.content=new ac(this.length)}write(e,n){const r=n>0?Ee(this.id.client,this.id.clock+n-1):this.origin,s=this.rightOrigin,i=this.parentSub,o=this.content.getRef()&Ff|(r===null?0:Un)|(s===null?0:os)|(i===null?0:Zl);if(e.writeInfo(o),r!==null&&e.writeLeftID(r),s!==null&&e.writeRightID(s),r===null&&s===null){const a=this.parent;if(a._item!==void 0){const l=a._item;if(l===null){const c=BF(a);e.writeParentInfo(!0),e.writeString(c)}else e.writeParentInfo(!1),e.writeLeftID(l.id)}else a.constructor===String?(e.writeParentInfo(!0),e.writeString(a)):a.constructor===Wo?(e.writeParentInfo(!1),e.writeLeftID(a)):jr();i!==null&&e.writeString(i)}this.content.write(e,n)}}const fI=(t,e)=>HP[e&Ff](t),HP=[()=>{jr()},EP,bP,CP,MP,xP,IP,UP,RP,kP,()=>{jr()}],zP=10;class Sr extends n1{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){jr()}write(e,n){e.writeInfo(zP),Be(e.restEncoder,this.length-n)}getMissing(e,n){return null}}const hI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},pI="__ $YJS$ __";hI[pI]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");hI[pI]=!0;class jP{constructor(e){H(this,"model");this.model=e}get workbook(){return this.model.getRoot().get("workbook")}get currentSheetId(){return this.model.getRoot().get("currentSheetId")||""}validateSheet(e){return!(!e||!e.sheetId||!e.name||typeof e.isHide!="boolean"||typeof e.sort!="number"||typeof e.colCount!="number"||typeof e.rowCount!="number"||e.rowCount>Ic||e.colCount>xc||e.rowCount<=0||e.colCount<=0)}fromJSON(e){const n=e.workbook||{},r=e.currentSheetId||"",s=new Oe;for(const a of Object.values(n)){if(!this.validateSheet(a))continue;const l=new Oe(Object.entries(a));s.set(a.sheetId,l)}this.model.getRoot().set("workbook",s);let i=this.getSheetId()||"";const o=s.get(r);o&&!(o!=null&&o.get("isHide"))&&(i=r),this.setCurrentSheetId(i)}updateSheetInfo(e,n){var o;const r=n||this.currentSheetId,s=(o=this.workbook)==null?void 0:o.get(r);if(!s)return;const i=Object.keys(e);for(const a of i)a==="sheetId"||s.get(a)===e[a]||s.set(a,e[a])}getSheetList(){if(!this.workbook)return[];const e=Array.from(this.workbook.values()).map(n=>n.toJSON());return e.sort((n,r)=>n.sort-r.sort),e.slice()}addSheet(){this.workbook||this.model.getRoot().set("workbook",new Oe);const e=this.getSheetList(),r={...AO(e),isHide:!1,colCount:Xn,rowCount:Gn};return this.workbook.set(r.sheetId,new Oe(Object.entries(r))),r}deleteSheet(e){var r;const n=e||this.currentSheetId;this.checkSheetSize(e)&&((r=this.workbook)==null||r.delete(n))}hideSheet(e){this.checkSheetSize(e)&&this.updateSheetInfo({isHide:!0},e)}unhideSheet(e){this.updateSheetInfo({isHide:!1},e)}renameSheet(e,n){if(!e){gt.error(P("the-value-cannot-be-empty"));return}const r=n||this.currentSheetId,i=this.getSheetList().find(o=>o.name===e);if(i){if(i.sheetId===r)return;gt.error(P("sheet-name-is-duplicate"));return}this.updateSheetInfo({name:e},r)}getSheetInfo(e){var s;const n=e||this.currentSheetId,r=(s=this.workbook)==null?void 0:s.get(n);if(r)return{...r.toJSON()}}setCurrentSheetId(e){var n;!e||!((n=this.workbook)!=null&&n.get(e))||this.currentSheetId!==e&&this.model.getRoot().set("currentSheetId",e)}getCurrentSheetId(){var n;const e=this.currentSheetId;return this.workbook?(n=this.workbook)!=null&&n.get(e)?e:(this.model.getRoot().set("currentSheetId",""),""):(e&&this.model.getRoot().set("currentSheetId",""),"")}getSheetId(){var r;return(r=this.getSheetList().filter(s=>!s.isHide)[0])==null?void 0:r.sheetId}deleteAll(e){this.deleteSheet(e)}checkSheetSize(e){var i;const n=e||this.currentSheetId;return(i=this.workbook)!=null&&i.get(n)?this.getSheetList().filter(o=>!o.isHide).length<2?(gt.error(P("a-workbook-must-contains-at-least-one-visible-worksheet")),!1):!0:!1}}class WP{constructor(e){H(this,"model");this.model=e}get rangeMap(){return this.model.getRoot().get("rangeMap")}validateRange(e){if(!e)return!1;e.sheetId=e.sheetId||this.model.getCurrentSheetId();const n=this.model.getSheetInfo(e.sheetId);return!(!n||e.row<0||e.col<0||e.colCount<0||e.rowCount<0||e.row>=n.rowCount||e.col>=n.colCount||e.colCount>n.colCount||e.rowCount>n.rowCount||e.row+e.rowCount>n.rowCount||e.col+e.colCount>n.colCount)}fromJSON(e){const n=e.rangeMap||{},r=new Oe;for(const s of Object.values(n))s.sheetId=s.sheetId||this.model.getCurrentSheetId(),this.model.validateRange(s)&&r.set(s.sheetId,s);this.model.getRoot().set("rangeMap",r)}getActiveRange(){var r;const e=this.model.getCurrentSheetId(),n=(r=this.rangeMap)==null?void 0:r.get(e);return n?(n.sheetId=n.sheetId||e,{range:{...n},isMerged:!1}):{range:{row:0,col:0,rowCount:1,colCount:1,sheetId:e},isMerged:!1}}setActiveRange(e){if(e.sheetId=e.sheetId||this.model.getCurrentSheetId(),!this.validateRange(e))return;let n=this.rangeMap;n||(n=new Oe,this.model.getRoot().set("rangeMap",n));const r=n.get(e.sheetId);r&&M0(r,e)||n.set(e.sheetId,ri(e))}deleteAll(e){var n;(n=this.rangeMap)==null||n.delete(e||this.model.getCurrentSheetId())}}class VP{constructor(e){H(this,"model");this.model=e}get drawings(){return this.model.getRoot().get("drawings")}validateDrawing(e){if(!e||!e.uuid||!this.model.getSheetInfo(e.sheetId))return!1;if(e.type==="floating-picture"){if(!e.imageSrc)return!1}else if(e.chartType===void 0||e.chartRange===void 0||Am.findIndex(r=>r.value===e.chartType)<0||!this.model.validateRange(e.chartRange))return!1;return!0}fromJSON(e){const n=e.drawings||{},r=new Oe;for(const[s,i]of Object.entries(n)){if(!this.validateDrawing(i)||!s)return;const o=new Oe(Object.entries(i));r.set(s,o)}this.model.getRoot().set("drawings",r)}getDrawingList(e){if(!this.drawings)return[];const n=e||this.model.getCurrentSheetId();return Array.from(this.drawings.values()).filter(s=>s.get("sheetId")===n).map(s=>s.toJSON()).slice()}addDrawing(e){var r;if((r=this.drawings)==null?void 0:r.get(e.uuid))return gt.error(P("uuid-is-duplicate"));if(this.validateDrawing(e)){if(e.type==="chart"){const s=e.chartRange;let i=!1;const o=this.model.getSheetInfo(s.sheetId);if(!o)return gt.error(P("sheet-is-not-exist"));if(hl(s,o==null?void 0:o.rowCount,o==null?void 0:o.colCount,(a,l)=>{const c=this.model.getCell({row:a,col:l,rowCount:1,colCount:1,sheetId:""});return c!=null&&c.value?(i=!0,!0):!1}),!i)return gt.error(P("cells-must-contain-data"));e.chartRange=ri(e.chartRange)}else e.type==="floating-picture"&&typeof e.imageAngle!="number"&&(e.imageAngle=0);this.drawings||this.model.getRoot().set("drawings",new Oe),this.drawings.set(e.uuid,new Oe(Object.entries(e)))}}updateDrawing(e,n){var i;const r=Object.keys(n),s=(i=this.drawings)==null?void 0:i.get(e);if(!(r.length===0||!s)){for(const o of r)if(s.get(o)!==n[o]&&o==="chartType"&&Am.findIndex(l=>l.value===n.chartType)<0)return gt.error(P("unsupported-chart-types"));for(const o of r){const a=n[o];s.get(o)!==a&&s.set(o,o==="chartRange"?ri(a):a)}}}deleteDrawing(e){var n;(n=this.drawings)==null||n.delete(e)}addCol(e,n,r=!1){if(!this.drawings)return;const s=this.model.getSheetInfo().colCount;for(const[i,o]of this.drawings.entries()){const a=o.toJSON(),l={},c=r?e+1:e;if(a.fromCol>=c&&(l.fromCol=Math.min(s-1,a.fromCol+n)),a.type==="chart"&&a.chartRange.col>=c){const d={...a.chartRange},u=d.col;u+n<=s-1?d.col+=n:(d.col=s-1,d.colCount=Math.max(s-1-n-u+d.colCount,1)),l.chartRange=d}this.updateDrawing(i,l)}}addRow(e,n,r=!1){if(n<=0||!this.drawings)return;const s=this.model.getSheetInfo().rowCount;for(const[i,o]of this.drawings.entries()){const a=o.toJSON(),l={},c=r?e:e+1;if(a.fromRow>=c&&(l.fromRow=Math.min(s-1,a.fromRow+n)),a.type==="chart"&&a.chartRange.row>=c){const d={...a.chartRange},u=d.row;u+n<=s-1?d.row+=n:(d.row=s-1,d.rowCount=Math.max(s-1-n-u+d.rowCount,1)),l.chartRange=d}this.updateDrawing(i,l)}}deleteCol(e,n){if(this.drawings)for(const[r,s]of this.drawings.entries()){const i=s.toJSON(),o={};if(i.fromCol>=e&&(o.fromCol=Math.max(i.fromCol-n,0)),i.type==="chart"&&i.chartRange.col>=e){const a={...i.chartRange},l=a.col;l>=n?a.col-=n:(a.col=0,a.colCount=Math.max(l-n+a.colCount,1)),o.chartRange=a}this.updateDrawing(r,o)}}deleteRow(e,n){if(this.drawings)for(const[r,s]of this.drawings.entries()){const i=s.toJSON(),o={};if(i.fromRow>=e&&(o.fromRow=Math.max(i.fromRow-n,0)),i.type==="chart"&&i.chartRange.row>=e){const a={...i.chartRange},l=a.row;l>=n?a.row=l-n:(a.row=0,a.rowCount=Math.max(l-n+a.rowCount,1)),o.chartRange=a}this.updateDrawing(r,o)}}deleteAll(e){if(!this.drawings)return;const n=e||this.model.getCurrentSheetId();for(const[r,s]of this.drawings.entries())s.get("sheetId")===n&&this.drawings.delete(r)}}class GP{constructor(e){H(this,"model");this.model=e}get definedNames(){return this.model.getRoot().get("definedNames")}validateDefinedName(e){if(!e)return!1;const n=es(e,r=>{const i=this.model.getSheetList().find(o=>o.name===r);return(i==null?void 0:i.sheetId)||""});if(n){const r=this.model.getSheetInfo(n.sheetId);if(r&&n.col<r.colCount&&n.row<r.rowCount)return!1}return!!(b0.test(e)&&e.length<=bc)}fromJSON(e){const n=e.definedNames||{},r=new Oe;for(const[s,i]of Object.entries(n))!this.model.validateRange(i)||!this.validateDefinedName(s)||r.set(s,ri(i));this.model.getRoot().set("definedNames",r)}getDefineNameList(){if(!this.definedNames)return[];const e=Array.from(this.definedNames.entries());return e.length===0?[]:e.map(n=>({name:n[0],range:n[1]}))}getDefineName(e){if(!this.definedNames)return"";const n=e.sheetId||this.model.getCurrentSheetId();for(const[r,s]of this.definedNames.entries())if(s.row===e.row&&s.col===e.col&&s.sheetId===n)return r;return""}setDefineName(e,n){var i;if(!n)return!1;const r=this.getDefineName(e);if(r===n)return!1;this.definedNames||this.model.getRoot().set("definedNames",new Oe);const s={row:e.row,col:e.col,sheetId:e.sheetId||this.model.getCurrentSheetId(),colCount:1,rowCount:1};return this.definedNames.set(n,s),r&&((i=this.definedNames)==null||i.delete(r)),!0}checkDefineName(e){var r;const n=(r=this.definedNames)==null?void 0:r.get(e);if(n)return{...n}}deleteAll(e){if(!this.definedNames)return;const n=e||this.model.getCurrentSheetId();for(const[r,s]of this.definedNames.entries())s.sheetId===n&&this.definedNames.delete(r)}}class XP{constructor(e,n){H(this,"model");H(this,"worker");H(this,"computeFormulasCallback",e=>{var s;const{list:n}=e;let r=!1;for(const i of n){const o=(s=this.worksheets)==null?void 0:s.get(i.key);if(!o)continue;const a=o.get("value"),l=o.get("formula");l&&i.newValue===EO&&l!==a?(r=!0,o.set("value",l),o.set("formula","")):a!==i.newValue&&(r=!0,o.set("value",i.newValue))}return r});this.model=e,this.worker=n}get worksheets(){return this.model.getRoot().get("worksheets")}fromJSON(e){const n=e.worksheets||{},r=[];for(const[s,i]of Object.entries(n)){const o=fl(s);if(!o)continue;const a={...o,...i};r.push(a)}this.model.getRoot().set("worksheets",new Oe),this.setWorksheet(r)}addMergeCell(e,n){var u,f,h;const r=e.sheetId||this.model.getCurrentSheetId(),s=n===vr.MERGE_CONTENT,i=[],o=this.model.getSheetInfo(e.sheetId);if(!o||(hl(e,o.rowCount,o.colCount,(p,m)=>{const _=this.getCell({row:p,col:m,rowCount:1,colCount:1,sheetId:r});return _&&i.push({value:{..._},row:p,col:m}),!1}),i.length===0))return;let a=[oi(i[0].value.value,(u=i[0].value)==null?void 0:u.numberFormat)];for(let p=1;p<i.length;p++){const m=i[p],_=qn(r,m.row,m.col),g={...m.value};s&&a.push(oi(g.value,g==null?void 0:g.numberFormat)),(f=this.worksheets)==null||f.delete(_)}i.some(p=>p.value.formula)&&(a=[a[0]]);let l=Ha(i[0],["row","col","value"]),c=i[0].value.value;n===vr.MERGE_CELL||n===vr.MERGE_CENTER?l.horizontalAlign=wt.CENTER:n===vr.MERGE_CONTENT&&(l.isWrapText=!0);const d={row:e.row,col:e.col,rowCount:1,colCount:1,sheetId:r};if(s?c=a.join(Hn):c=a[0],e.row===i[0].row&&e.col===i[0].col)s&&this.setCellValue(c,d);else{const p=qn(r,i[0].row,i[0].col);(h=this.worksheets)==null||h.delete(p),this.setCellValue(c,d)}this.updateCellStyle(l,d)}addRow(e,n,r=!1){var a;const s=this.getCoordinateList(),i=this.model.getCurrentSheetId(),o=r?e:e+1;for(let l=s.length-1;l>=0;l--){const c=s[l];if(c.row<o)continue;const d=qn(i,c.row,c.col),u=Ha(c,["sheetId","row","col"]);(a=this.worksheets)==null||a.delete(d),this.setCellModel({sheetId:i,row:c.row+n,col:c.col},u)}}deleteRow(e,n){var i;const r=this.model.getCurrentSheetId(),s=this.getCoordinateList();for(const o of s){if(o.row<e)continue;const a=qn(r,o.row,o.col),l=Ha(o,["sheetId","row","col"]);o.row>=e+n&&this.setCellModel({sheetId:r,row:o.row-n,col:o.col},l),(i=this.worksheets)==null||i.delete(a)}}addCol(e,n,r=!1){var a;const s=this.getCoordinateList(!0),i=this.model.getCurrentSheetId(),o=r?e+1:e;for(let l=s.length-1;l>=0;l--){const c=s[l];if(c.col<o)continue;const d=qn(i,c.row,c.col),u=Ha(c,["sheetId","row","col"]);(a=this.worksheets)==null||a.delete(d),this.setCellModel({sheetId:i,row:c.row,col:c.col+n},u)}}deleteCol(e,n){var i;const r=this.getCoordinateList(!0),s=this.model.getCurrentSheetId();for(const o of r){if(o.col<e)continue;const a=qn(s,o.row,o.col),l=Ha(o,["sheetId","row","col"]);o.col>=e+n&&this.setCellModel({sheetId:s,row:o.row,col:o.col-n},l),(i=this.worksheets)==null||i.delete(a)}}getWorksheet(e){const n=e||this.model.getCurrentSheetId();return this.getWorkData(n)}getWorkData(e=""){const n=[];if(!this.worksheets)return n;for(const[r,s]of this.worksheets.entries()){const i=fl(r);if(!i)continue;const o=s.toJSON();e&&i.sheetId===e?n.push({...i,...o}):n.push({...i,...o})}return n}setWorksheet(e){const n=this.validateSheetData(e);for(const r of n){const{sheetId:s,row:i,col:o,...a}=r;this.setCellModel({sheetId:s,row:i,col:o},a)}}getCell(e){const n=this.getCellModel(e);if(n)return{...n.toJSON()}}async setCell(e,n,r){const{row:s,col:i}=r;for(let o=0;o<e.length;o++)for(let a=0;a<e[o].length;a++){const l={row:s+o,col:i+a};n[o]&&n[o][a]&&this.updateStyle(n[o][a],{...l,sheetId:r.sheetId,rowCount:1,colCount:1}),this.setCellValue(e[o][a],{...r,...l})}}setCellValue(e,n){const r=this.getCellModel(n,!0);typeof e=="string"&&Ek(e)&&(r==null?void 0:r.get("numberFormat"))!==_k?this.setCellFormula(e,n):(r!=null&&r.get("formula")&&this.setCellFormula("",n),this.setValue(e,n))}updateCellStyle(e,n){if(dl(e))return;const r=this.model.getSheetInfo(n.sheetId);r&&hl(n,r.rowCount,r.colCount,(s,i)=>(this.updateStyle(e,{row:s,col:i,sheetId:n.sheetId,rowCount:1,colCount:1}),!1))}pasteRange(e,n){const r=this.model.getCurrentSheetId(),s=this.model.getActiveRange().range,{row:i,col:o,rowCount:a,colCount:l,sheetId:c}=e,d=c||r,u=this.getWorksheet(d),f={...s,rowCount:a,colCount:l};if(u.length===0)return f;const h=this.model.getSheetInfo(e.sheetId);return h&&hl(e,h.rowCount,h.colCount,(p,m)=>{var x,C;const _=qn(d,p,m),g=(x=this.worksheets)==null?void 0:x.get(_),y=s.row+(p-i),w=s.col+(m-o),v=g?{...g.toJSON()}:{value:""};return this.setCellModel({sheetId:f.sheetId,row:y,col:w},v),n&&((C=this.worksheets)==null||C.delete(_)),!1}),f}deleteAll(e){const n=e||this.model.getCurrentSheetId();if(this.worksheets)for(const r of this.worksheets.keys()){const s=fl(r);(s==null?void 0:s.sheetId)===n&&this.worksheets.delete(r)}}updateStyle(e,n){const r=this.getCellModel(n,!0),s=Object.keys(e);for(const i of s){const o=r.get(i),a=e[i];Of(o,a)||r.set(i,a)}}setValue(e,n){const r=this.getCellModel(n,!0);if((r==null?void 0:r.get("value"))===e)return;const i=Pw(e??"");r==null||r.set("value",i)}setCellFormula(e,n){const r=this.getCellModel(n,!0);(r==null?void 0:r.get("formula"))!==e&&(r==null||r.set("formula",e))}validateSheetData(e){const n=[],r=this.model.getCurrentSheetId();for(const s of e){if(dl(s)||s.row<0||s.col<0)continue;const i={...s,sheetId:s.sheetId||r,value:Pw(s.value??"")};s.formula&&(s.formula.startsWith(la)||(i.formula=la+s.formula)),n.push(i)}return n}getCoordinateList(e=!1){const n=this.model.getCurrentSheetId(),r=this.getWorkData(n);return r.length===0?[]:(r.sort((s,i)=>e?s.col-i.col:s.row-i.row),r)}getCellModel(e,n=!1){var c;const{row:r,col:s,sheetId:i}=e,o=i||this.model.getCurrentSheetId();if(!o)return;const a=qn(o,r,s),l=(c=this.worksheets)==null?void 0:c.get(a);return n&&!l?this.setCellModel({sheetId:o,row:r,col:s},{value:""}):l}setCellModel(e,n){const{row:r,col:s,sheetId:i}=e,o=qn(i||this.model.getCurrentSheetId(),r,s);let a=this.worksheets;this.worksheets||(a=new Oe,this.model.getRoot().set("worksheets",a));const l=new Oe(Object.entries(n));return a.set(o,l),l}async computeFormulas(){var s;const e=(s=this.worksheets)==null?void 0:s.toJSON();if(!e||dl(e))return Promise.resolve(!1);const n={};for(const i of this.model.getDefineNameList())n[i.name]=i.range;const r={worksheets:e,definedNames:n,currentSheetId:this.model.getCurrentSheetId(),workbook:this.model.getSheetList()};return this.worker.computeFormulas(r,U0(this.computeFormulasCallback))}}class YP{constructor(e){H(this,"model");H(this,"convertSheetIdToName",e=>{const n=this.model.getSheetInfo(e);return(n==null?void 0:n.name)||""});this.model=e}get mergeCells(){return this.model.getRoot().get("mergeCells")}fromJSON(e){const n=e.mergeCells||{},r=new Oe;for(const s of Object.values(n)){if(s.sheetId=s.sheetId||this.model.getCurrentSheetId(),!this.model.validateRange(s))continue;const i=Zn(s,"absolute",this.convertSheetIdToName);r.set(i,ri(s))}this.model.getRoot().set("mergeCells",r)}getMergeCellList(e){if(!this.mergeCells)return[];const n=e||this.model.getCurrentSheetId();return Array.from(this.mergeCells.values()).filter(r=>r.sheetId===n)}addMergeCell(e){var r;const n=Zn(e,"absolute",this.convertSheetIdToName);if((r=this.mergeCells)!=null&&r.get(n)){gt.error(P("merging-cell-is-duplicate"));return}this.mergeCells||this.model.getRoot().set("mergeCells",new Oe),this.mergeCells.set(n,ri(e))}deleteMergeCell(e){var r;e.sheetId=e.sheetId||this.model.getCurrentSheetId();const n=Zn(e,"absolute",this.convertSheetIdToName);(r=this.mergeCells)==null||r.delete(n)}deleteAll(e){if(!this.mergeCells)return;const n=e||this.model.getCurrentSheetId();for(const[r,s]of this.mergeCells.entries())s.sheetId===n&&this.mergeCells.delete(r)}}class qP{constructor(e){H(this,"model");this.model=e}get customHeight(){return this.model.getRoot().get("customHeight")}getModel(){return this.customHeight||this.model.getRoot().set("customHeight",new Oe),this.customHeight}fromJSON(e){const n=e.customHeight||{},r=new Oe;for(const[s,i]of Object.entries(n)){const{sheetId:o,rowOrCol:a}=Vl(s);if(!o||a<0)continue;const l=this.model.getSheetInfo(o);!l||a>=l.rowCount||typeof i.isHide=="boolean"&&typeof i.len=="number"&&r.set(s,i)}this.model.getRoot().set("customHeight",r)}hideRow(e,n){this.toggleHideRow(e,n,!0)}toggleHideRow(e,n,r){const s=this.model.getCurrentSheetId();for(let i=0;i<n;i++){const o=e+i,a=kr(s,o),l=this.getRow(o);if(l.isHide===r)continue;const c={...l,isHide:r};this.getModel().set(a,c)}}unhideRow(e,n){this.toggleHideRow(e,n,!1)}getRow(e,n){var o;const r=n||this.model.getCurrentSheetId(),s=kr(r,e),i=(o=this.customHeight)==null?void 0:o.get(s);return i?{...i}:{len:zl,isHide:!1}}setRowHeight(e,n,r){const s=r||this.model.getCurrentSheetId(),i=kr(s,e),o=this.getRow(e,r);if(o.len===n)return;const a={...o};a.len=n,this.getModel().set(i,a)}deleteAll(e){if(!this.customHeight)return;const n=e||this.model.getCurrentSheetId();for(const r of this.customHeight.keys()){const{sheetId:s}=Vl(r);s===n&&this.customHeight.delete(r)}}}class KP{constructor(e){H(this,"model");this.model=e}get customWidth(){return this.model.getRoot().get("customWidth")}getModel(){return this.customWidth||this.model.getRoot().set("customWidth",new Oe),this.customWidth}fromJSON(e){const n=e.customWidth||{},r=new Oe;for(const[s,i]of Object.entries(n)){const{sheetId:o,rowOrCol:a}=Vl(s);if(!o||a<0)continue;const l=this.model.getSheetInfo(o);!l||a>=l.colCount||typeof i.isHide=="boolean"&&typeof i.len=="number"&&r.set(s,i)}this.model.getRoot().set("customWidth",r)}hideCol(e,n){this.toggleHideCol(e,n,!0)}toggleHideCol(e,n,r){const s=this.model.getCurrentSheetId();for(let i=0;i<n;i++){const o=e+i,a=kr(s,o),l=this.getCol(o,s);if(l.isHide===r)continue;const c={...l,isHide:r};this.getModel().set(a,c)}}unhideCol(e,n){this.toggleHideCol(e,n,!1)}getCol(e,n){var o;const r=n||this.model.getCurrentSheetId(),s=kr(r,e),i=(o=this.customWidth)==null?void 0:o.get(s);return i?{...i}:{len:jl,isHide:!1}}setColWidth(e,n,r){const s=r||this.model.getCurrentSheetId(),i=kr(s,e),o=this.getCol(e,r);if(o.len===n)return;const a={...o,len:n};this.getModel().set(i,a)}deleteAll(e){if(!this.customWidth)return;const n=e||this.model.getCurrentSheetId();for(const r of this.customWidth.keys()){const{sheetId:s}=Vl(r);s===n&&this.customWidth.delete(r)}}}class JP{constructor(e){H(this,"model");this.model=e}get autoFilter(){return this.model.getRoot().get("autoFilter")}fromJSON(e){const n=e.autoFilter||{},r=new Oe;for(const[s,i]of Object.entries(n)){if(i.range.sheetId=s,!this.model.validateRange(i.range))continue;const o=new Oe(Object.entries(i));r.set(s,o)}this.model.getRoot().set("autoFilter",r)}deleteAll(e){var r;const n=e||this.model.getCurrentSheetId();(r=this.autoFilter)==null||r.delete(n)}addFilter(e){if(e.sheetId=e.sheetId||this.model.getCurrentSheetId(),!this.model.validateRange(e)||e.rowCount===1&&e.colCount===1)return;this.autoFilter||this.model.getRoot().set("autoFilter",new Oe);const n={range:ri(e)},r=new Oe(Object.entries(n));this.autoFilter.set(e.sheetId,r)}deleteFilter(e){this.deleteAll(e)}updateFilter(e,n){var a;const r=e||this.model.getCurrentSheetId(),s=Object.keys(n),i=(a=this.autoFilter)==null?void 0:a.get(r);if(!i)return;for(const l of s)i.get(l)!==n[l]&&i.set(l,n[l]);const o=i.get("range");if(typeof n.col=="number"&&n.value){this.applyFilter(o,n);return}typeof n.col>"u"&&!n.value&&this.clearFilter(o)}clearFilter(e){const n=this.model.getSheetInfo(e.sheetId);if(!n)return;let r=e.row+1,s=e.rowCount===0?n.rowCount:e.row+e.rowCount;for(;r<s;r++)this.model.unhideRow(r,1)}applyFilter(e,n){const r=this.model.getSheetInfo(e.sheetId);if(!r)return;const{col:s,value:i}=n;if((i==null?void 0:i.type)==="normal"){const o=new Set(i.value);let a=e.row+1,l=e.rowCount===0?r.rowCount:e.row+e.rowCount;for(;a<l;a++){const c=this.model.getCell({row:a,col:s,rowCount:1,colCount:1,sheetId:e.sheetId}),d=c?c.value:Hn;o.has(d)?this.model.unhideRow(a,1):this.model.hideRow(a,1)}}}getFilter(e){var s;const n=e||this.model.getCurrentSheetId(),r=(s=this.autoFilter)==null?void 0:s.get(n);if(r)return r.toJSON()}}class QP{constructor(e){H(this,"model");this.model=e}get scroll(){return this.model.getRoot().get("scroll")}fromJSON(e){const n=e.scroll||{},r=new Oe;for(const[s,i]of Object.entries(n))!s||i.row<0||i.col<0||r.set(s,new Oe(Object.entries(i)));this.model.getRoot().set("scroll",r)}deleteAll(e){var n;(n=this.scroll)==null||n.delete(e||this.model.getCurrentSheetId())}getScroll(e){var r;const n=(r=this.scroll)==null?void 0:r.get(e||this.model.getCurrentSheetId());return n?n.toJSON():{row:0,col:0}}setScroll(e,n){var c;const r=n||this.model.getCurrentSheetId();this.scroll||this.model.getRoot().set("scroll",new Oe);const s=this.model.getSheetInfo(r);if(!s)return!1;const i=s.rowCount-1,o=s.colCount-1;e.row>=i?e.row=i:e.row<0&&(e.row=0),e.col>=o?e.col=o:e.col<0&&(e.col=0);const a=(c=this.scroll)==null?void 0:c.get(r);if(!a)return this.scroll.set(r,new Oe(Object.entries(e))),!1;let l=!1;return a.get("row")!==e.row&&(l=!0,a.set("row",e.row)),a.get("col")!==e.col&&(l=!0,a.set("col",e.col)),l}}class ZP{constructor(e){H(this,"workbookManager");H(this,"rangeMapManager");H(this,"drawingsManager");H(this,"definedNameManager");H(this,"worksheetManager");H(this,"mergeCellManager");H(this,"rowManager");H(this,"colManager");H(this,"filterManager");H(this,"scrollManager");H(this,"doc");H(this,"undoManager");H(this,"changeSet",new Set);H(this,"transaction",(e,n)=>this.doc.transact(e,n||_r.MODEL));H(this,"fromJSON",e=>{this.workbookManager.fromJSON(e),this.rangeMapManager.fromJSON(e),this.drawingsManager.fromJSON(e),this.definedNameManager.fromJSON(e),this.worksheetManager.fromJSON(e),this.mergeCellManager.fromJSON(e),this.rowManager.fromJSON(e),this.colManager.fromJSON(e),this.filterManager.fromJSON(e),this.scrollManager.fromJSON(e),this.worksheetManager.computeFormulas()});H(this,"toJSON",()=>{const e=this.getRoot().toJSON(),n={};for(const r of T0){const s=e[r];if(r==="currentSheetId"){n.currentSheetId=s||"";continue}n[r]=typeof s>"u"?{}:s}return n});H(this,"getCell",e=>this.worksheetManager.getCell(e));const{doc:n,worker:r}=e;this.doc=n;const s=this.getRoot();s.observeDeep(i=>{jw("observeDeep",i);const o=LO(i);for(const a of this.changeSet.keys())o.add(a);(o.has("customHeight")||o.has("customWidth"))&&this.computeViewSize(),this.render(o),this.changeSet=new Set}),this.undoManager=new XF(s,{trackedOrigins:new Set([_r.MODEL,_r.REMOTE,_r.INIT]),captureTimeout:100}),this.workbookManager=new jP(this),this.rangeMapManager=new WP(this),this.drawingsManager=new VP(this),this.definedNameManager=new GP(this),this.worksheetManager=new XP(this,r),this.mergeCellManager=new YP(this),this.rowManager=new qP(this),this.colManager=new KP(this),this.filterManager=new JP(this),this.scrollManager=new QP(this)}clearHistory(){this.undoManager.clear(!0,!0)}getRoot(){return this.doc.getMap("excel")}render(e){e.size!==0&&(jw(e),Lf.emit("modelChange",{changeSet:e}))}async emitChange(e){const n=["antLine","undo","redo"];for(const r of n)e.has(r)&&(this.changeSet.add(r),e.delete(r));(e.has("cellValue")||e.has("definedNames")||e.has("currentSheetId"))&&await this.worksheetManager.computeFormulas()&&this.changeSet.add("cellValue"),e.size===0&&this.changeSet.size>0&&(this.render(this.changeSet),this.changeSet=new Set)}getSheetList(){return this.workbookManager.getSheetList()}getActiveRange(e){const n=e||this.rangeMapManager.getActiveRange().range,r=this.getMergeCellList(n.sheetId);for(const s of r)if(Tk(n,s))return{range:{...s,sheetId:s.sheetId||this.getCurrentSheetId()},isMerged:!0};return{range:n,isMerged:!1}}setActiveRange(e){e.sheetId=e.sheetId||this.getCurrentSheetId();const{range:n}=this.getActiveRange(e);this.rangeMapManager.setActiveRange(n)}addSheet(){const e=this.workbookManager.addSheet();return this.worksheetManager.setWorksheet([]),this.workbookManager.setCurrentSheetId(e.sheetId),this.computeViewSize(),e}deleteSheet(e){const n=this.getNextSheetId(e);n&&(this.deleteAll(e),this.workbookManager.deleteSheet(e),this.workbookManager.setCurrentSheetId(n))}updateSheetInfo(e,n){this.workbookManager.updateSheetInfo(e,n)}hideSheet(e){const n=this.getNextSheetId(e);n&&(this.workbookManager.hideSheet(e),this.workbookManager.setCurrentSheetId(n))}unhideSheet(e){e&&(this.workbookManager.unhideSheet(e),this.workbookManager.setCurrentSheetId(e))}renameSheet(e,n){this.workbookManager.renameSheet(e,n)}getSheetInfo(e){return this.workbookManager.getSheetInfo(e)}setCurrentSheetId(e){this.workbookManager.setCurrentSheetId(e)}getCurrentSheetId(){return this.workbookManager.getCurrentSheetId()}setCell(e,n,r){return this.worksheetManager.setCell(e,n,r)}setCellValue(e,n){return this.worksheetManager.setCellValue(e,n)}updateCellStyle(e,n){return this.worksheetManager.updateCellStyle(e,n)}getWorksheet(e){return this.worksheetManager.getWorksheet(e)}setWorksheet(e){this.worksheetManager.setWorksheet(e)}addCol(e,n,r=!1){if(n<=0)return;const s=this.getSheetInfo();if(s.colCount>=xc)return;const i=this.getCurrentSheetId(),o=s.colCount+n;this.workbookManager.updateSheetInfo({colCount:o},i),this.drawingsManager.addCol(e,n,r),this.worksheetManager.addCol(e,n,r)}deleteCol(e,n){if(n<=0)return;const r=this.getSheetInfo(),s=this.getCurrentSheetId(),i=r.colCount-n;this.workbookManager.updateSheetInfo({colCount:i},s),this.drawingsManager.deleteCol(e,n),this.worksheetManager.deleteCol(e,n)}hideCol(e,n){this.colManager.hideCol(e,n)}getCol(e,n){return this.colManager.getCol(e,n)}setColWidth(e,n,r){this.colManager.setColWidth(e,n,r)}addRow(e,n,r=!1){if(n<=0)return;const s=this.getSheetInfo();if(s.rowCount>=Ic)return;const i=s.rowCount+n;this.workbookManager.updateSheetInfo({rowCount:i}),this.drawingsManager.addRow(e,n,r),this.worksheetManager.addRow(e,n,r)}deleteRow(e,n){if(n<=0)return;const s=this.getSheetInfo().rowCount-n;this.workbookManager.updateSheetInfo({rowCount:s}),this.drawingsManager.deleteRow(e,n),this.worksheetManager.deleteRow(e,n)}hideRow(e,n){this.rowManager.hideRow(e,n)}unhideRow(e,n){this.rowManager.unhideRow(e,n)}unhideCol(e,n){this.colManager.unhideCol(e,n)}getRow(e,n){return this.rowManager.getRow(e,n)}setRowHeight(e,n,r){this.rowManager.setRowHeight(e,n,r)}canRedo(){return this.undoManager.canRedo()}canUndo(){return this.undoManager.canUndo()}undo(){this.undoManager.undo()}redo(){this.undoManager.redo()}pasteRange(e,n){return this.worksheetManager.pasteRange(e,n)}deleteAll(e){this.rowManager.deleteAll(e),this.colManager.deleteAll(e),this.worksheetManager.deleteAll(e),this.mergeCellManager.deleteAll(e),this.drawingsManager.deleteAll(e),this.definedNameManager.deleteAll(e),this.filterManager.deleteAll(e)}getDefineNameList(){return this.definedNameManager.getDefineNameList()}getDefineName(e){return this.definedNameManager.getDefineName(e)}setDefineName(e,n){return this.definedNameManager.setDefineName(e,n)}checkDefineName(e){return this.definedNameManager.checkDefineName(e)}getDrawingList(e){return this.drawingsManager.getDrawingList(e)}addDrawing(...e){for(const n of e)this.drawingsManager.addDrawing(n)}updateDrawing(e,n){this.drawingsManager.updateDrawing(e,n)}deleteDrawing(e){this.drawingsManager.deleteDrawing(e)}getMergeCellList(e){return this.mergeCellManager.getMergeCellList(e)}addMergeCell(e,n=vr.MERGE_CENTER){e.colCount===1&&e.rowCount===1||(e.sheetId=e.sheetId||this.getCurrentSheetId(),this.mergeCellManager.addMergeCell(e),this.worksheetManager.addMergeCell(e,n))}deleteMergeCell(e){this.mergeCellManager.deleteMergeCell(e)}validateRange(e){return this.rangeMapManager.validateRange(e)}validateDrawing(e){return this.drawingsManager.validateDrawing(e)}validateDefinedName(e){return this.definedNameManager.validateDefinedName(e)}getFilter(e){return this.filterManager.getFilter(e)}addFilter(e){this.filterManager.addFilter(e)}deleteFilter(e){this.filterManager.deleteFilter(e)}updateFilter(e,n){this.filterManager.updateFilter(e,n)}getScroll(e){return this.scrollManager.getScroll(e)}setScroll(e,n){return this.scrollManager.setScroll(e,n)}computeViewSize(){const e=ar.get(),n=this.getSheetInfo();if(!n)return;let{width:r,height:s}=e;for(let i=0;i<n.colCount;i++){const o=this.getCol(i);r+=o.isHide?0:o.len}for(let i=0;i<n.rowCount;i++){const o=this.getRow(i);s+=o.isHide?0:o.len}Ti.set({width:r,height:s})}getNextSheetId(e){const n=e||this.getCurrentSheetId(),r=this.getSheetList(),s=r.findIndex(a=>a.sheetId===n);if(s<0)return"";const i=s===r.length-1;let o=i?(s-1+r.length)%r.length:(s+1)%r.length;for(;o!==s&&r[o].isHide;)o=i?(o-1+r.length)%r.length:(o+1)%r.length;return r[o].sheetId}}Ze.DOUBLE,wt.CENTER,[1,"Hello World",!0,"",!1].join(Hn);if(!OO()){ua();const t=ua();P("chart-title")}for(let t=0;t<vi.length;t++){const e=vi[t];t+1,String(e.value)}const NS=Object.keys(Tc);for(let t=0;t<NS.length;t++)NS[t];var mI={exports:{}};(function(t){var e={};function n(r){r.version="0.11.3";function s(I){for(var k="",b=I.length-1;b>=0;)k+=I.charAt(b--);return k}function i(I,k){for(var b="";b.length<k;)b+=I;return b}function o(I,k){var b=""+I;return b.length>=k?b:i("0",k-b.length)+b}function a(I,k){var b=""+I;return b.length>=k?b:i(" ",k-b.length)+b}function l(I,k){var b=""+I;return b.length>=k?b:b+i(" ",k-b.length)}function c(I,k){var b=""+Math.round(I);return b.length>=k?b:i("0",k-b.length)+b}function d(I,k){var b=""+I;return b.length>=k?b:i("0",k-b.length)+b}var u=Math.pow(2,32);function f(I,k){if(I>u||I<-u)return c(I,k);var b=Math.round(I);return d(b,k)}function h(I,k){return k=k||0,I.length>=7+k&&(I.charCodeAt(k)|32)===103&&(I.charCodeAt(k+1)|32)===101&&(I.charCodeAt(k+2)|32)===110&&(I.charCodeAt(k+3)|32)===101&&(I.charCodeAt(k+4)|32)===114&&(I.charCodeAt(k+5)|32)===97&&(I.charCodeAt(k+6)|32)===108}var p=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],m=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function _(I){I[0]="General",I[1]="0",I[2]="0.00",I[3]="#,##0",I[4]="#,##0.00",I[9]="0%",I[10]="0.00%",I[11]="0.00E+00",I[12]="# ?/?",I[13]="# ??/??",I[14]="m/d/yy",I[15]="d-mmm-yy",I[16]="d-mmm",I[17]="mmm-yy",I[18]="h:mm AM/PM",I[19]="h:mm:ss AM/PM",I[20]="h:mm",I[21]="h:mm:ss",I[22]="m/d/yy h:mm",I[37]="#,##0 ;(#,##0)",I[38]="#,##0 ;[Red](#,##0)",I[39]="#,##0.00;(#,##0.00)",I[40]="#,##0.00;[Red](#,##0.00)",I[45]="mm:ss",I[46]="[h]:mm:ss",I[47]="mmss.0",I[48]="##0.0E+0",I[49]="@",I[56]='"/ "hh""mm""ss" "'}var g={};_(g);var y=[],w=0;for(w=5;w<=8;++w)y[w]=32+w;for(w=23;w<=26;++w)y[w]=0;for(w=27;w<=31;++w)y[w]=14;for(w=50;w<=58;++w)y[w]=14;for(w=59;w<=62;++w)y[w]=w-58;for(w=67;w<=68;++w)y[w]=w-58;for(w=72;w<=75;++w)y[w]=w-58;for(w=67;w<=68;++w)y[w]=w-57;for(w=76;w<=78;++w)y[w]=w-56;for(w=79;w<=81;++w)y[w]=w-34;var v={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function x(I,k,b){for(var Q=I<0?-1:1,R=I*Q,ie=0,M=1,X=0,fe=1,B=0,pe=0,Se=Math.floor(R);B<k&&(Se=Math.floor(R),X=Se*M+ie,pe=Se*B+fe,!(R-Se<5e-8));)R=1/(R-Se),ie=M,M=X,fe=B,B=pe;if(pe>k&&(B>k?(pe=fe,X=ie):(pe=B,X=M)),!b)return[0,Q*X,pe];var me=Math.floor(Q*X/pe);return[me,Q*X-me*pe,pe]}function C(I){var k=I.toPrecision(16);if(k.indexOf("e")>-1){var b=k.slice(0,k.indexOf("e"));return b=b.indexOf(".")>-1?b.slice(0,b.slice(0,2)=="0."?17:16):b.slice(0,15)+i("0",b.length-15),b+k.slice(k.indexOf("e"))}var Q=k.indexOf(".")>-1?k.slice(0,k.slice(0,2)=="0."?17:16):k.slice(0,15)+i("0",k.length-15);return Number(Q)}function E(I,k,b){if(I>2958465||I<0)return null;I=C(I);var Q=I|0,R=Math.floor(86400*(I-Q)),ie=0,M=[],X={D:Q,T:R,u:86400*(I-Q)-R,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(X.u)<1e-6&&(X.u=0),k&&k.date1904&&(Q+=1462),X.u>.9999&&(X.u=0,++R==86400&&(X.T=R=0,++Q,++X.D)),Q===60)M=b?[1317,10,29]:[1900,2,29],ie=3;else if(Q===0)M=b?[1317,8,29]:[1900,1,0],ie=6;else{Q>60&&--Q;var fe=new Date(1900,0,1);fe.setDate(fe.getDate()+Q-1),M=[fe.getFullYear(),fe.getMonth()+1,fe.getDate()],ie=fe.getDay(),Q<60&&(ie=(ie+6)%7),b&&(ie=ae(fe,M))}return X.y=M[0],X.m=M[1],X.d=M[2],X.S=R%60,R=Math.floor(R/60),X.M=R%60,R=Math.floor(R/60),X.H=R,X.q=ie,X}r.parse_date_code=E;var A=new Date(1899,11,31,0,0,0),V=A.getTime(),D=new Date(1900,2,1,0,0,0);function $(I,k){var b=I.getTime();return k?b-=1461*24*60*60*1e3:I>=D&&(b+=24*60*60*1e3),(b-(V+(I.getTimezoneOffset()-A.getTimezoneOffset())*6e4))/(24*60*60*1e3)}var j=function(){var k=/(?:\.0*|(\.\d*[1-9])0+)$/;function b(B){return B.indexOf(".")==-1?B:B.replace(k,"$1")}var Q=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,R=/(E[+-])(\d)$/;function ie(B){return B.indexOf("E")==-1?B:B.replace(Q,"$1E").replace(R,"$10$2")}function M(B){var pe=B<0?12:11,Se=b(B.toFixed(12));return Se.length<=pe||(Se=B.toPrecision(10),Se.length<=pe)?Se:B.toExponential(5)}function X(B){var pe=b(B.toFixed(11));return pe.length>(B<0?12:11)||pe==="0"||pe==="-0"?B.toPrecision(6):pe}function fe(B){var pe=Math.floor(Math.log(Math.abs(B))*Math.LOG10E),Se;return pe>=-4&&pe<=-1?Se=B.toPrecision(10+pe):Math.abs(pe)<=9?Se=M(B):pe===10?Se=B.toFixed(10).substr(0,12):Se=X(B),b(ie(Se.toUpperCase()))}return fe}();r._general_num=j;function Z(I,k){switch(typeof I){case"string":return I;case"boolean":return I?"TRUE":"FALSE";case"number":return(I|0)===I?I.toString(10):j(I);case"undefined":return"";case"object":if(I==null)return"";if(I instanceof Date)return Je(14,$(I,k&&k.date1904),k)}throw new Error("unsupported value in General format: "+I)}r._general=Z;function ae(I,k){k[0]-=581;var b=I.getDay();return I<60&&(b=(b+6)%7),b}function ce(I,k,b,Q){var R="",ie=0,M=0,X=b.y,fe,B=0;switch(I){case 98:X=b.y+543;case 121:switch(k.length){case 1:case 2:fe=X%100,B=2;break;default:fe=X%1e4,B=4;break}break;case 109:switch(k.length){case 1:case 2:fe=b.m,B=k.length;break;case 3:return m[b.m-1][1];case 5:return m[b.m-1][0];default:return m[b.m-1][2]}break;case 100:switch(k.length){case 1:case 2:fe=b.d,B=k.length;break;case 3:return p[b.q][0];default:return p[b.q][1]}break;case 104:switch(k.length){case 1:case 2:fe=1+(b.H+11)%12,B=k.length;break;default:throw"bad hour format: "+k}break;case 72:switch(k.length){case 1:case 2:fe=b.H,B=k.length;break;default:throw"bad hour format: "+k}break;case 77:switch(k.length){case 1:case 2:fe=b.M,B=k.length;break;default:throw"bad minute format: "+k}break;case 115:if(k!="s"&&k!="ss"&&k!=".0"&&k!=".00"&&k!=".000")throw"bad second format: "+k;return b.u===0&&(k=="s"||k=="ss")?o(b.S,k.length):(Q>=2?M=Q===3?1e3:100:M=Q===1?10:1,ie=Math.round(M*(b.S+b.u)),ie>=60*M&&(ie=0),k==="s"?ie===0?"0":""+ie/M:(R=o(ie,2+Q),k==="ss"?R.substr(0,2):"."+R.substr(2,k.length-1)));case 90:switch(k){case"[h]":case"[hh]":fe=b.D*24+b.H;break;case"[m]":case"[mm]":fe=(b.D*24+b.H)*60+b.M;break;case"[s]":case"[ss]":fe=((b.D*24+b.H)*60+b.M)*60+(Q==0?Math.round(b.S+b.u):b.S);break;default:throw"bad abstime format: "+k}B=k.length===3?1:2;break;case 101:fe=X,B=1;break}var pe=B>0?o(fe,B):"";return pe}function J(I){var k=3;if(I.length<=k)return I;for(var b=I.length%k,Q=I.substr(0,b);b!=I.length;b+=k)Q+=(Q.length>0?",":"")+I.substr(b,k);return Q}var K=function(){var k=/%/g;function b(U,N,O){var se=N.replace(k,""),W=N.length-se.length;return K(U,se,O*Math.pow(10,2*W))+i("%",W)}function Q(U,N,O){for(var se=N.length-1;N.charCodeAt(se-1)===44;)--se;return K(U,N.substr(0,se),O/Math.pow(10,3*(N.length-se)))}function R(U,N){var O,se=U.indexOf("E")-U.indexOf(".")-1;if(U.match(/^#+0.0E\+0$/)){if(N==0)return"0.0E+0";if(N<0)return"-"+R(U,-N);var W=U.indexOf(".");W===-1&&(W=U.indexOf("E"));var z=Math.floor(Math.log(N)*Math.LOG10E)%W;if(z<0&&(z+=W),O=(N/Math.pow(10,z)).toPrecision(se+1+(W+z)%W),O.indexOf("e")===-1){var ye=Math.floor(Math.log(N)*Math.LOG10E);for(O.indexOf(".")===-1?O=O.charAt(0)+"."+O.substr(1)+"E+"+(ye-O.length+z):O+="E+"+(ye-z);O.substr(0,2)==="0.";)O=O.charAt(0)+O.substr(2,W)+"."+O.substr(2+W),O=O.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");O=O.replace(/\+-/,"-")}O=O.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(st,dt,ft,Ue){return dt+ft+Ue.substr(0,(W+z)%W)+"."+Ue.substr(z)+"E"})}else O=N.toExponential(se);return U.match(/E\+00$/)&&O.match(/e[+-]\d$/)&&(O=O.substr(0,O.length-1)+"0"+O.charAt(O.length-1)),U.match(/E\-/)&&O.match(/e\+/)&&(O=O.replace(/e\+/,"e")),O.replace("e","E")}var ie=/# (\?+)( ?)\/( ?)(\d+)/;function M(U,N,O){var se=parseInt(U[4],10),W=Math.round(N*se),z=Math.floor(W/se),ye=W-z*se,st=se;return O+(z===0?"":""+z)+" "+(ye===0?i(" ",U[1].length+1+U[4].length):a(ye,U[1].length)+U[2]+"/"+U[3]+o(st,U[4].length))}function X(U,N,O){return O+(N===0?"":""+N)+i(" ",U[1].length+2+U[4].length)}var fe=/^#*0*\.([0#]+)/,B=/\).*[0#]/,pe=/\(###\) ###\\?-####/;function Se(U){for(var N="",O,se=0;se!=U.length;++se)switch(O=U.charCodeAt(se)){case 35:break;case 63:N+=" ";break;case 48:N+="0";break;default:N+=String.fromCharCode(O)}return N}function me(U,N){var O=Math.pow(10,N);return""+Math.round(U*O)/O}function vt(U,N){var O=U-Math.floor(U),se=Math.pow(10,N);return N<(""+Math.round(O*se)).length?0:Math.round(O*se)}function Ce(U,N){return N<(""+Math.round((U-Math.floor(U))*Math.pow(10,N))).length?1:0}function Me(U){return U<2147483647&&U>-2147483648?""+(U>=0?U|0:U-1|0):""+Math.floor(U)}function re(U,N,O){if(U.charCodeAt(0)===40&&!N.match(B)){var se=N.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return O>=0?re("n",se,O):"("+re("n",se,-O)+")"}if(N.charCodeAt(N.length-1)===44)return Q(U,N,O);if(N.indexOf("%")!==-1)return b(U,N,O);if(N.indexOf("E")!==-1)return R(N,O);if(N.charCodeAt(0)===36)return"$"+re(U,N.substr(N.charAt(1)==" "?2:1),O);var W,z,ye,st,dt=Math.abs(O),ft=O<0?"-":"";if(N.match(/^00+$/))return ft+f(dt,N.length);if(N.match(/^[#?]+$/))return W=f(O,0),W==="0"&&(W=""),W.length>N.length?W:Se(N.substr(0,N.length-W.length))+W;if(z=N.match(ie))return M(z,dt,ft);if(N.match(/^#+0+$/))return ft+f(dt,N.length-N.indexOf("0"));if(z=N.match(fe))return W=me(O,z[1].length).replace(/^([^\.]+)$/,"$1."+Se(z[1])).replace(/\.$/,"."+Se(z[1])).replace(/\.(\d*)$/,function(bn,Na){return"."+Na+i("0",Se(z[1]).length-Na.length)}),N.indexOf("0.")!==-1?W:W.replace(/^0\./,".");if(N=N.replace(/^#+([0.])/,"$1"),z=N.match(/^(0*)\.(#*)$/))return ft+me(dt,z[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,z[1].length?"0.":".");if(z=N.match(/^#{1,3},##0(\.?)$/))return ft+J(f(dt,0));if(z=N.match(/^#,##0\.([#0]*0)$/))return O<0?"-"+re(U,N,-O):J(""+(Math.floor(O)+Ce(O,z[1].length)))+"."+o(vt(O,z[1].length),z[1].length);if(z=N.match(/^#,#*,#0/))return re(U,N.replace(/^#,#*,/,""),O);if(z=N.match(/^([0#]+)(\\?-([0#]+))+$/))return W=s(re(U,N.replace(/[\\-]/g,""),O)),ye=0,s(s(N.replace(/\\/g,"")).replace(/[0#]/g,function(bn){return ye<W.length?W.charAt(ye++):bn==="0"?"0":""}));if(N.match(pe))return W=re(U,"##########",O),"("+W.substr(0,3)+") "+W.substr(3,3)+"-"+W.substr(6);var Ue="";if(z=N.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return ye=Math.min(z[4].length,7),st=x(dt,Math.pow(10,ye)-1,!1),W=""+ft,Ue=K("n",z[1],st[1]),Ue.charAt(Ue.length-1)==" "&&(Ue=Ue.substr(0,Ue.length-1)+"0"),W+=Ue+z[2]+"/"+z[3],Ue=l(st[2],ye),Ue.length<z[4].length&&(Ue=Se(z[4].substr(z[4].length-Ue.length))+Ue),W+=Ue,W;if(z=N.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return ye=Math.min(Math.max(z[1].length,z[4].length),7),st=x(dt,Math.pow(10,ye)-1,!0),ft+(st[0]||(st[1]?"":"0"))+" "+(st[1]?a(st[1],ye)+z[2]+"/"+z[3]+l(st[2],ye):i(" ",2*ye+1+z[2].length+z[3].length));if(z=N.match(/^[#0?]+$/))return W=f(O,0),N.length<=W.length?W:Se(N.substr(0,N.length-W.length))+W;if(z=N.match(/^([#0?]+)\.([#0]+)$/)){W=""+O.toFixed(Math.min(z[2].length,10)).replace(/([^0])0+$/,"$1"),ye=W.indexOf(".");var Ra=N.indexOf(".")-ye,Wf=N.length-W.length-Ra;return Se(N.substr(0,Ra)+W+N.substr(N.length-Wf))}if(z=N.match(/^00,000\.([#0]*0)$/))return ye=vt(O,z[1].length),O<0?"-"+re(U,N,-O):J(Me(O)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(bn){return"00,"+(bn.length<3?o(0,3-bn.length):"")+bn})+"."+o(ye,z[1].length);switch(N){case"###,##0.00":return re(U,"#,##0.00",O);case"###,###":case"##,###":case"#,###":var Ma=J(f(dt,0));return Ma!=="0"?ft+Ma:"";case"###,###.00":return re(U,"###,##0.00",O).replace(/^0\./,".");case"#,###.00":return re(U,"#,##0.00",O).replace(/^0\./,".")}throw new Error("unsupported format |"+N+"|")}function gn(U,N,O){for(var se=N.length-1;N.charCodeAt(se-1)===44;)--se;return K(U,N.substr(0,se),O/Math.pow(10,3*(N.length-se)))}function io(U,N,O){var se=N.replace(k,""),W=N.length-se.length;return K(U,se,O*Math.pow(10,2*W))+i("%",W)}function nn(U,N){var O,se=U.indexOf("E")-U.indexOf(".")-1;if(U.match(/^#+0.0E\+0$/)){if(N==0)return"0.0E+0";if(N<0)return"-"+nn(U,-N);var W=U.indexOf(".");W===-1&&(W=U.indexOf("E"));var z=Math.floor(Math.log(N)*Math.LOG10E)%W;if(z<0&&(z+=W),O=(N/Math.pow(10,z)).toPrecision(se+1+(W+z)%W),!O.match(/[Ee]/)){var ye=Math.floor(Math.log(N)*Math.LOG10E);O.indexOf(".")===-1?O=O.charAt(0)+"."+O.substr(1)+"E+"+(ye-O.length+z):O+="E+"+(ye-z),O=O.replace(/\+-/,"-")}O=O.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(st,dt,ft,Ue){return dt+ft+Ue.substr(0,(W+z)%W)+"."+Ue.substr(z)+"E"})}else O=N.toExponential(se);return U.match(/E\+00$/)&&O.match(/e[+-]\d$/)&&(O=O.substr(0,O.length-1)+"0"+O.charAt(O.length-1)),U.match(/E\-/)&&O.match(/e\+/)&&(O=O.replace(/e\+/,"e")),O.replace("e","E")}function Lt(U,N,O){if(U.charCodeAt(0)===40&&!N.match(B)){var se=N.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return O>=0?Lt("n",se,O):"("+Lt("n",se,-O)+")"}if(N.charCodeAt(N.length-1)===44)return gn(U,N,O);if(N.indexOf("%")!==-1)return io(U,N,O);if(N.indexOf("E")!==-1)return nn(N,O);if(N.charCodeAt(0)===36)return"$"+Lt(U,N.substr(N.charAt(1)==" "?2:1),O);var W,z,ye,st,dt=Math.abs(O),ft=O<0?"-":"";if(N.match(/^00+$/))return ft+o(dt,N.length);if(N.match(/^[#?]+$/))return W=""+O,O===0&&(W=""),W.length>N.length?W:Se(N.substr(0,N.length-W.length))+W;if(z=N.match(ie))return X(z,dt,ft);if(N.match(/^#+0+$/))return ft+o(dt,N.length-N.indexOf("0"));if(z=N.match(fe))return W=(""+O).replace(/^([^\.]+)$/,"$1."+Se(z[1])).replace(/\.$/,"."+Se(z[1])),W=W.replace(/\.(\d*)$/,function(bn,Na){return"."+Na+i("0",Se(z[1]).length-Na.length)}),N.indexOf("0.")!==-1?W:W.replace(/^0\./,".");if(N=N.replace(/^#+([0.])/,"$1"),z=N.match(/^(0*)\.(#*)$/))return ft+(""+dt).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,z[1].length?"0.":".");if(z=N.match(/^#{1,3},##0(\.?)$/))return ft+J(""+dt);if(z=N.match(/^#,##0\.([#0]*0)$/))return O<0?"-"+Lt(U,N,-O):J(""+O)+"."+i("0",z[1].length);if(z=N.match(/^#,#*,#0/))return Lt(U,N.replace(/^#,#*,/,""),O);if(z=N.match(/^([0#]+)(\\?-([0#]+))+$/))return W=s(Lt(U,N.replace(/[\\-]/g,""),O)),ye=0,s(s(N.replace(/\\/g,"")).replace(/[0#]/g,function(bn){return ye<W.length?W.charAt(ye++):bn==="0"?"0":""}));if(N.match(pe))return W=Lt(U,"##########",O),"("+W.substr(0,3)+") "+W.substr(3,3)+"-"+W.substr(6);var Ue="";if(z=N.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return ye=Math.min(z[4].length,7),st=x(dt,Math.pow(10,ye)-1,!1),W=""+ft,Ue=K("n",z[1],st[1]),Ue.charAt(Ue.length-1)==" "&&(Ue=Ue.substr(0,Ue.length-1)+"0"),W+=Ue+z[2]+"/"+z[3],Ue=l(st[2],ye),Ue.length<z[4].length&&(Ue=Se(z[4].substr(z[4].length-Ue.length))+Ue),W+=Ue,W;if(z=N.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return ye=Math.min(Math.max(z[1].length,z[4].length),7),st=x(dt,Math.pow(10,ye)-1,!0),ft+(st[0]||(st[1]?"":"0"))+" "+(st[1]?a(st[1],ye)+z[2]+"/"+z[3]+l(st[2],ye):i(" ",2*ye+1+z[2].length+z[3].length));if(z=N.match(/^[#0?]+$/))return W=""+O,N.length<=W.length?W:Se(N.substr(0,N.length-W.length))+W;if(z=N.match(/^([#0]+)\.([#0]+)$/)){W=""+O.toFixed(Math.min(z[2].length,10)).replace(/([^0])0+$/,"$1"),ye=W.indexOf(".");var Ra=N.indexOf(".")-ye,Wf=N.length-W.length-Ra;return Se(N.substr(0,Ra)+W+N.substr(N.length-Wf))}if(z=N.match(/^00,000\.([#0]*0)$/))return O<0?"-"+Lt(U,N,-O):J(""+O).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(bn){return"00,"+(bn.length<3?o(0,3-bn.length):"")+bn})+"."+o(0,z[1].length);switch(N){case"###,###":case"##,###":case"#,###":var Ma=J(""+dt);return Ma!=="0"?ft+Ma:"";default:if(N.match(/\.[0#?]*$/))return Lt(U,N.slice(0,N.lastIndexOf(".")),O)+Se(N.slice(N.lastIndexOf(".")))}throw new Error("unsupported format |"+N+"|")}return function(N,O,se){return(se|0)===se?Lt(N,O,se):re(N,O,se)}}();function F(I){for(var k=[],b=!1,Q=0,R=0;Q<I.length;++Q)switch(I.charCodeAt(Q)){case 34:b=!b;break;case 95:case 42:case 92:++Q;break;case 59:k[k.length]=I.substr(R,Q-R),R=Q+1}if(k[k.length]=I.substr(R),b===!0)throw new Error("Format |"+I+"| unterminated string ");return k}r._split=F;var q=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ne(I){for(var k=0,b="",Q="";k<I.length;)switch(b=I.charAt(k)){case"G":h(I,k)&&(k+=6),k++;break;case'"':for(;I.charCodeAt(++k)!==34&&k<I.length;);++k;break;case"\\":k+=2;break;case"_":k+=2;break;case"@":++k;break;case"B":case"b":if(I.charAt(k+1)==="1"||I.charAt(k+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(I.substr(k,3).toUpperCase()==="A/P"||I.substr(k,5).toUpperCase()==="AM/PM"||I.substr(k,5).toUpperCase()==="/")return!0;++k;break;case"[":for(Q=b;I.charAt(k++)!=="]"&&k<I.length;)Q+=I.charAt(k);if(Q.match(q))return!0;break;case".":case"0":case"#":for(;k<I.length&&("0#?.,E+-%".indexOf(b=I.charAt(++k))>-1||b=="\\"&&I.charAt(k+1)=="-"&&"0#".indexOf(I.charAt(k+2))>-1););break;case"?":for(;I.charAt(++k)===b;);break;case"*":++k,(I.charAt(k)==" "||I.charAt(k)=="*")&&++k;break;case"(":case")":++k;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;k<I.length&&"0123456789".indexOf(I.charAt(++k))>-1;);break;case" ":++k;break;default:++k;break}return!1}r.is_date=ne;function oe(I,k,b,Q){for(var R=[],ie="",M=0,X="",fe="t",B,pe,Se,me="H";M<I.length;)switch(X=I.charAt(M)){case"G":if(!h(I,M))throw new Error("unrecognized character "+X+" in "+I);R[R.length]={t:"G",v:"General"},M+=7;break;case'"':for(ie="";(Se=I.charCodeAt(++M))!==34&&M<I.length;)ie+=String.fromCharCode(Se);R[R.length]={t:"t",v:ie},++M;break;case"\\":var vt=I.charAt(++M),Ce=vt==="("||vt===")"?vt:"t";R[R.length]={t:Ce,v:vt},++M;break;case"_":R[R.length]={t:"t",v:" "},M+=2;break;case"@":R[R.length]={t:"T",v:k},++M;break;case"B":case"b":if(I.charAt(M+1)==="1"||I.charAt(M+1)==="2"){if(B==null&&(B=E(k,b,I.charAt(M+1)==="2"),B==null))return"";R[R.length]={t:"X",v:I.substr(M,2)},fe=X,M+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":X=X.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(k<0||B==null&&(B=E(k,b),B==null))return"";for(ie=X;++M<I.length&&I.charAt(M).toLowerCase()===X;)ie+=X;X==="m"&&fe.toLowerCase()==="h"&&(X="M"),X==="h"&&(X=me),R[R.length]={t:X,v:ie},fe=X;break;case"A":case"a":case"":var Me={t:X,v:X};if(B==null&&(B=E(k,b)),I.substr(M,3).toUpperCase()==="A/P"?(B!=null&&(Me.v=B.H>=12?I.charAt(M+2):X),Me.t="T",me="h",M+=3):I.substr(M,5).toUpperCase()==="AM/PM"?(B!=null&&(Me.v=B.H>=12?"PM":"AM"),Me.t="T",M+=5,me="h"):I.substr(M,5).toUpperCase()==="/"?(B!=null&&(Me.v=B.H>=12?"":""),Me.t="T",M+=5,me="h"):(Me.t="t",++M),B==null&&Me.t==="T")return"";R[R.length]=Me,fe=X;break;case"[":for(ie=X;I.charAt(M++)!=="]"&&M<I.length;)ie+=I.charAt(M);if(ie.slice(-1)!=="]")throw'unterminated "[" block: |'+ie+"|";if(ie.match(q)){if(B==null&&(B=E(k,b),B==null))return"";R[R.length]={t:"Z",v:ie.toLowerCase()},fe=ie.charAt(1)}else ie.indexOf("$")>-1&&(ie=(ie.match(/\$([^-\[\]]*)/)||[])[1]||"$",ne(I)||(R[R.length]={t:"t",v:ie}));break;case".":if(B!=null){for(ie=X;++M<I.length&&(X=I.charAt(M))==="0";)ie+=X;R[R.length]={t:"s",v:ie};break}case"0":case"#":for(ie=X;++M<I.length&&"0#?.,E+-%".indexOf(X=I.charAt(M))>-1;)ie+=X;R[R.length]={t:"n",v:ie};break;case"?":for(ie=X;I.charAt(++M)===X;)ie+=X;R[R.length]={t:X,v:ie},fe=X;break;case"*":++M,(I.charAt(M)==" "||I.charAt(M)=="*")&&++M;break;case"(":case")":R[R.length]={t:Q===1?"t":X,v:X},++M;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(ie=X;M<I.length&&"0123456789".indexOf(I.charAt(++M))>-1;)ie+=I.charAt(M);R[R.length]={t:"D",v:ie};break;case" ":R[R.length]={t:X,v:X},++M;break;case"$":R[R.length]={t:"t",v:"$"},++M;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(X)===-1)throw new Error("unrecognized character "+X+" in "+I);R[R.length]={t:"t",v:X},++M;break}var re=0,gn=0,io;for(M=R.length-1,fe="t";M>=0;--M)switch(R[M].t){case"h":case"H":R[M].t=me,fe="h",re<1&&(re=1);break;case"s":(io=R[M].v.match(/\.0+$/))&&(gn=Math.max(gn,io[0].length-1),re=4),re<3&&(re=3);case"d":case"y":case"e":fe=R[M].t;break;case"M":fe=R[M].t,re<2&&(re=2);break;case"m":fe==="s"&&(R[M].t="M",re<2&&(re=2));break;case"X":break;case"Z":re<1&&R[M].v.match(/[Hh]/)&&(re=1),re<2&&R[M].v.match(/[Mm]/)&&(re=2),re<3&&R[M].v.match(/[Ss]/)&&(re=3)}var nn;switch(re){case 0:break;case 1:case 2:case 3:B.u>=.5&&(B.u=0,++B.S),B.S>=60&&(B.S=0,++B.M),B.M>=60&&(B.M=0,++B.H),B.H>=24&&(B.H=0,++B.D,nn=E(B.D),nn.u=B.u,nn.S=B.S,nn.M=B.M,nn.H=B.H,B=nn);break;case 4:switch(gn){case 1:B.u=Math.round(B.u*10)/10;break;case 2:B.u=Math.round(B.u*100)/100;break;case 3:B.u=Math.round(B.u*1e3)/1e3;break}B.u>=1&&(B.u=0,++B.S),B.S>=60&&(B.S=0,++B.M),B.M>=60&&(B.M=0,++B.H),B.H>=24&&(B.H=0,++B.D,nn=E(B.D),nn.u=B.u,nn.S=B.S,nn.M=B.M,nn.H=B.H,B=nn);break}var Lt="",U;for(M=0;M<R.length;++M)switch(R[M].t){case"t":case"T":case" ":case"D":break;case"X":R[M].v="",R[M].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":R[M].v=ce(R[M].t.charCodeAt(0),R[M].v,B,gn),R[M].t="t";break;case"n":case"?":for(U=M+1;R[U]!=null&&((X=R[U].t)==="?"||X==="D"||(X===" "||X==="t")&&R[U+1]!=null&&(R[U+1].t==="?"||R[U+1].t==="t"&&R[U+1].v==="/")||R[M].t==="("&&(X===" "||X==="n"||X===")")||X==="t"&&(R[U].v==="/"||R[U].v===" "&&R[U+1]!=null&&R[U+1].t=="?"));)R[M].v+=R[U].v,R[U]={v:"",t:";"},++U;Lt+=R[M].v,M=U-1;break;case"G":R[M].t="t",R[M].v=Z(k,b);break}var N="",O,se;if(Lt.length>0){Lt.charCodeAt(0)==40?(O=k<0&&Lt.charCodeAt(0)===45?-k:k,se=K("n",Lt,O)):(O=k<0&&Q>1?-k:k,se=K("n",Lt,O),O<0&&R[0]&&R[0].t=="t"&&(se=se.substr(1),R[0].v="-"+R[0].v)),U=se.length-1;var W=R.length;for(M=0;M<R.length;++M)if(R[M]!=null&&R[M].t!="t"&&R[M].v.indexOf(".")>-1){W=M;break}var z=R.length;if(W===R.length&&se.indexOf("E")===-1){for(M=R.length-1;M>=0;--M)R[M]==null||"n?".indexOf(R[M].t)===-1||(U>=R[M].v.length-1?(U-=R[M].v.length,R[M].v=se.substr(U+1,R[M].v.length)):U<0?R[M].v="":(R[M].v=se.substr(0,U+1),U=-1),R[M].t="t",z=M);U>=0&&z<R.length&&(R[z].v=se.substr(0,U+1)+R[z].v)}else if(W!==R.length&&se.indexOf("E")===-1){for(U=se.indexOf(".")-1,M=W;M>=0;--M)if(!(R[M]==null||"n?".indexOf(R[M].t)===-1)){for(pe=R[M].v.indexOf(".")>-1&&M===W?R[M].v.indexOf(".")-1:R[M].v.length-1,N=R[M].v.substr(pe+1);pe>=0;--pe)U>=0&&(R[M].v.charAt(pe)==="0"||R[M].v.charAt(pe)==="#")&&(N=se.charAt(U--)+N);R[M].v=N,R[M].t="t",z=M}for(U>=0&&z<R.length&&(R[z].v=se.substr(0,U+1)+R[z].v),U=se.indexOf(".")+1,M=W;M<R.length;++M)if(!(R[M]==null||"n?(".indexOf(R[M].t)===-1&&M!==W)){for(pe=R[M].v.indexOf(".")>-1&&M===W?R[M].v.indexOf(".")+1:0,N=R[M].v.substr(0,pe);pe<R[M].v.length;++pe)U<se.length&&(N+=se.charAt(U++));R[M].v=N,R[M].t="t",z=M}}}for(M=0;M<R.length;++M)R[M]!=null&&"n?".indexOf(R[M].t)>-1&&(O=Q>1&&k<0&&M>0&&R[M-1].v==="-"?-k:k,R[M].v=K(R[M].t,R[M].v,O),R[M].t="t");var ye="";for(M=0;M!==R.length;++M)R[M]!=null&&(ye+=R[M].v);return ye}r._eval=oe;var Te=/\[[=<>]/,yt=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $e(I,k){if(k==null)return!1;var b=parseFloat(k[2]);switch(k[1]){case"=":if(I==b)return!0;break;case">":if(I>b)return!0;break;case"<":if(I<b)return!0;break;case"<>":if(I!=b)return!0;break;case">=":if(I>=b)return!0;break;case"<=":if(I<=b)return!0;break}return!1}function Ot(I,k){var b=F(I),Q=b.length,R=b[Q-1].indexOf("@");if(Q<4&&R>-1&&--Q,b.length>4)throw new Error("cannot find right format for |"+b.join("|")+"|");if(typeof k!="number")return[4,b.length===4||R>-1?b[b.length-1]:"@"];switch(b.length){case 1:b=R>-1?["General","General","General",b[0]]:[b[0],b[0],b[0],"@"];break;case 2:b=R>-1?[b[0],b[0],b[0],b[1]]:[b[0],b[1],b[0],"@"];break;case 3:b=R>-1?[b[0],b[1],b[0],b[2]]:[b[0],b[1],b[2],"@"];break}var ie=k>0?b[0]:k<0?b[1]:b[2];if(b[0].indexOf("[")===-1&&b[1].indexOf("[")===-1)return[Q,ie];if(b[0].match(Te)!=null||b[1].match(Te)!=null){var M=b[0].match(yt),X=b[1].match(yt);return $e(k,M)?[Q,b[0]]:$e(k,X)?[Q,b[1]]:[Q,b[M!=null&&X!=null?2:1]]}return[Q,ie]}function Je(I,k,b){b==null&&(b={});var Q="";switch(typeof I){case"string":I=="m/d/yy"&&b.dateNF?Q=b.dateNF:Q=I;break;case"number":I==14&&b.dateNF?Q=b.dateNF:Q=(b.table!=null?b.table:g)[I],Q==null&&(Q=b.table&&b.table[y[I]]||g[y[I]]),Q==null&&(Q=v[I]||"General");break}if(h(Q,0))return Z(k,b);k instanceof Date&&(k=$(k,b.date1904));var R=Ot(Q,k);if(h(R[1]))return Z(k,b);if(k===!0)k="TRUE";else if(k===!1)k="FALSE";else if(k===""||k==null)return"";return oe(R[1],k,b,R[0])}function mn(I,k){if(typeof k!="number"){k=+k||-1;for(var b=0;b<392;++b){if(g[b]==null){k<0&&(k=b);continue}if(g[b]==I){k=b;break}}k<0&&(k=391)}return g[k]=I,k}r.load=mn,r._table=g,r.get_table=function(){return g},r.load_table=function(k){for(var b=0;b!=392;++b)k[b]!==void 0&&mn(k[b],b)},r.init_table=_,r.format=Je,r.choose_format=Ot}n(e),typeof DO_NOT_EXPORT_SSF>"u"&&(t.exports=e)})(mI);var e9=mI.exports;const gI=YS(e9);function oi(t,e,n={}){return gI.format(e||Xi,t,n)}function s1(t){return t?gI.is_date(t):!1}function t9(t,e){const n=new Date(1899,11,31,0,0,0),r=n.getTime(),s=new Date(1900,2,1,0,0,0);let i=t.getTime();return t>=s&&(i+=24*60*60*1e3),(i-(r+(t.getTimezoneOffset()-n.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function n9(t,e){const{row:n,col:r,rowCount:s,colCount:i,sheetId:o}=t,a={labels:[],datasets:[]};for(let l=n,c=1,d=n+s;l<d;l++,c++){if(e.getRowHeight(l)===Cm)continue;const f=[];for(let h=r,p=r+i;h<p;h++){const m=e.getCell({row:l,col:h,rowCount:1,colCount:1,sheetId:o});m&&f.push(ni(m.value)[1])}f.length>0&&a.datasets.push({label:`Series${c}`,data:f})}return a.datasets[0]&&a.datasets[0].data.length>0&&(a.labels=Array.from({length:a.datasets[0].data.length}).fill("").map((l,c)=>String(c+1))),a}function r9(t){const{top:e}=zn.get(),{range:n,isMerged:r}=t.getActiveRange(),s=n.sheetId||t.getCurrentSheetId(),i=t.getCell(n),o=t.getDefineName({row:n.row,col:n.col,rowCount:1,colCount:1,sheetId:s}),a=t.getCellSize(n),l=t.computeCellPosition(n);l.top=e+l.top;let c=(i==null?void 0:i.fontFamily)??"";if(!c){let D="";const $=_i.getSnapshot();for(const j of $)if(!j.disabled){D=String(j.value);break}c=D}const{isBold:d=!1,isItalic:u=!1,isStrike:f=!1,fontSize:h=no,fontColor:p=it("contentColor"),fillColor:m="",isWrapText:_=!1,underline:g=Ze.NONE,horizontalAlign:y,verticalAlign:w}=i||{},v=(i==null?void 0:i.numberFormat)||Xi,x=v===Xi&&typeof(i==null?void 0:i.value)=="number";let C=y;y===void 0&&x&&(C=wt.RIGHT);let E=oi(i==null?void 0:i.value,v),A="";if(s1(v)||v===Yr(10))A=E;else{const D=(i==null?void 0:i.value)??"";A=typeof D=="boolean"?D.toString().toUpperCase():String(D),E=A}let V="";r&&(E.includes(Hn)?(V=String(vr.MERGE_CONTENT),E=E.replaceAll(Hn,kc)):V=String(vr.MERGE_CENTER)),ql.setState({top:l.top,left:l.left,width:a.width,height:a.height,row:n.row,col:n.col,rowCount:n.rowCount,colCount:n.colCount,value:(i==null?void 0:i.formula)||A,defineName:o,displayValue:(i==null?void 0:i.formula)||E}),Jl.setState({isBold:d,isItalic:u,isStrike:f,fontColor:p,fontSize:h,fontFamily:c,fillColor:m,isWrapText:_,underline:g,numberFormat:v,isMergeCell:r,mergeType:V,horizontalAlign:C,verticalAlign:w})}const AS=(t,e)=>{if((t.has("rangeMap")||t.has("cellStyle")||t.has("cellValue")||t.has("currentSheetId")||t.has("mergeCells"))&&r9(e),t.has("workbook")){const r=e.getSheetList().map(s=>({sheetId:s.sheetId,name:s.name,isHide:s.isHide,tabColor:s.tabColor||""}));$d.setState(r)}const n={canRedo:e.canRedo(),canUndo:e.canUndo()};if(t.has("currentSheetId")&&(n.activeUuid="",n.currentSheetId=e.getCurrentSheetId(),n.isFilter=!!e.getFilter()),t.has("autoFilter")&&(n.isFilter=!!e.getFilter()),Qt.setState(n),t.has("scroll")){const r=e.getScroll(),s=zn.get(),i=r.scrollTop/s.height>=.91;Kl.setState({scrollLeft:r.scrollLeft,scrollTop:r.scrollTop,showBottomBar:i})}if(t.has("definedNames")){const r=e.getDefineNameList().map(s=>s.name);Om.setState(r)}if(t.has("drawings")||t.has("cellValue")||t.has("customHeight")||t.has("customWidth")||t.has("currentSheetId")||t.has("scroll")){const r=e.getScroll(),s=zn.get(),i=r.left,o=r.top,a=s.width+i,l=s.height+o,c=e.getDrawingList(e.getCurrentSheetId()),d=[];for(const u of c){const f=e.computeCellPosition({row:u.fromRow,col:u.fromCol,colCount:1,rowCount:1,sheetId:""}),h=f.top+u.marginY,p=f.left+u.marginX;if(h>o&&h<l||p>i&&p<a||h+u.height>o&&h+u.height<l||p+u.width>i&&p+u.width<a){const _={...u,top:h,left:p,labels:[],datasets:[]};if(u.type==="chart"){const g=n9(u.chartRange,e);_.labels=g.labels,_.datasets=g.datasets}d.push(_)}}Dm.setState(d)}t.has("currentSheetId")&&$d.getSnapshot().length>5&&setTimeout(()=>{BL(e.getCurrentSheetId())},0)};function s9(t){const e=parseInt(da.largePadding,10),n=t.parentElement;if(!n)return null;const r=n.getBoundingClientRect(),s={top:r.top,left:r.left,width:n.clientWidth-e,height:n.clientHeight-e};zn.set(s)}function i9(t,e){const n=f7();_i.setState(n);const r=jL(t,e),s=()=>{i(new Set(["customWidth"]))},i=c=>{s9(e),r.resize(),r.render({changeSet:c})},o=Lf.on("modelChange",({changeSet:c})=>{AS(c,t),r.render({changeSet:c})}),a=zL(t,s),l=new Set([...T0,"scroll","cellValue","cellStyle","antLine","undo","redo"]);return AS(l,t),i(l),queueMicrotask(()=>{i(l)}),()=>{a(),o()}}const o9=10,yI=T.memo(({controller:t})=>{const[e,n]=T.useState(o9),{showBottomBar:r}=T.useSyncExternalStore(Kl.subscribe,Kl.getSnapshot),s=o=>{o.stopPropagation();const a=parseInt(o.target.value,10);isNaN(a)||(a<1?n(1):a>Rh?n(Rh):n(a))},i=()=>{const o=t.getSheetInfo(t.getCurrentSheetId());t.addRow(o.rowCount-1,e);const a=Ti.get();Ri(t,0,a.height)};return S.jsxs("div",{className:Fe(On["bottom-bar"],{[On.active]:r}),"data-testid":"canvas-bottom-bar",children:[S.jsx("div",{className:On["bottom-bar-text"],children:P("add-at-the-bottom")}),S.jsx("input",{value:e,onChange:s,type:"number",min:1,max:Rh,"data-testid":"canvas-bottom-bar-input",className:On["bottom-bar-input"]}),S.jsx("div",{className:On["bottom-bar-text"],children:P("rows")}),S.jsx(ee,{testId:"canvas-bottom-bar-add",className:On["add-button"],onClick:i,children:P("add")})]})});yI.displayName="BottomBar";const a9="modulepreload",l9=function(t){return"/excel/"+t},DS={},i1=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=l9(l),l in DS)return;DS[l]=!0;const c=l.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const u=document.createElement("link");if(u.rel=c?"stylesheet":a9,c||(u.as="script"),u.crossOrigin="",u.href=l,a&&u.setAttribute("nonce",a),document.head.appendChild(u),c)return new Promise((f,h)=>{u.addEventListener("load",f),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},c9="_active_k5rmq_11",u9="_title_k5rmq_43",d9="_image_k5rmq_52",f9="_top_k5rmq_89",h9="_bottom_k5rmq_95",p9="_right_k5rmq_121",m9="_left_k5rmq_127",g9="_rotate_k5rmq_78",Le={"float-element":"_float-element_k5rmq_1",active:c9,"float-element-mask":"_float-element-mask_k5rmq_18","context-menu":"_context-menu_k5rmq_30",title:u9,image:d9,"resize-handler":"_resize-handler_k5rmq_57","resize-handler-rect":"_resize-handler-rect_k5rmq_66","scale-dot":"_scale-dot_k5rmq_70","rotate-icon":"_rotate-icon_k5rmq_78",top:f9,bottom:h9,"top-right":"_top-right_k5rmq_101","top-left":"_top-left_k5rmq_106","bottom-right":"_bottom-right_k5rmq_111","bottom-left":"_bottom-left_k5rmq_116",right:p9,left:m9,rotate:g9,"chart-type-select":"_chart-type-select_k5rmq_148"},wI=T.memo(t=>{const{controller:e,menuLeft:n,menuTop:r,uuid:s,type:i,chartType:o,title:a,resetResize:l,hideContextMenu:c,originHeight:d,originWidth:u,width:f,height:h}=t,p=Rc(c),m=()=>{let w=Zn(t.chartRange,"absolute",v=>{var x;return((x=e.getSheetInfo(v))==null?void 0:x.name)||""});pl({visible:!0,title:P("edit-data-source"),testId:"dialog-select-data",children:S.jsx("input",{type:"text",spellCheck:!0,style:{width:"400px"},defaultValue:w,onChange:v=>{w=v.target.value.trim(),v.stopPropagation()},maxLength:Wl*2,"data-testid":"dialog-select-data-input"}),onOk:()=>{if(!w)return gt.error(P("reference-is-empty"),"select-data-empty-toast");const v=e.getSheetList(),x=es(w,C=>{var E;return((E=v.find(A=>A.name===C))==null?void 0:E.sheetId)||""});if(!x||!e.validateRange(x)||t.chartRange&&M0(x,t.chartRange))return gt.error(P("reference-is-not-valid"),"select-data-invalid-toast");x.sheetId=x.sheetId||e.getCurrentSheetId(),e.updateDrawing(s,{chartRange:x}),c()},onCancel:()=>{c()}})},_=()=>{let w=a.trim();pl({visible:!0,title:P("change-chart-title"),testId:"dialog-change-chart-title",children:S.jsx("input",{type:"text",spellCheck:!0,style:{width:"200px"},defaultValue:w,onChange:v=>{w=v.target.value.trim(),v.stopPropagation()},maxLength:Wl,"data-testid":"dialog-change-chart-title-input"}),onOk:()=>{if(!w)return gt.error(P("the-value-cannot-be-empty"),"change-chart-title-toast");e.updateDrawing(s,{title:w}),c()},onCancel:()=>{c()}})},g=()=>{let w=o;pl({title:P("change-chart-type"),testId:"dialog-change-chart-type",visible:!0,children:S.jsx(Fi,{className:Le["chart-type-select"],defaultValue:w,data:Am.map(v=>({...v,disabled:!1})),onChange:v=>w=String(v),testId:"dialog-change-chart-type-select"}),onCancel(){c()},onOk(){e.updateDrawing(s,{chartType:w}),c()}})},y=()=>{c();const v=e.getDrawingList(e.getCurrentSheetId()).find(x=>x.uuid===s);if(v){if(i==="floating-picture"&&v.imageSrc){const x=Bk(v.imageSrc);Yl(v.imageSrc,v.title+x.ext)}if(i==="chart"){const x=document.querySelector(`canvas[data-uuid="${s}"]`);if(!x)return;const C=x.toDataURL();Yl(C,v.title+".png")}}};return S.jsxs("div",{className:Le["context-menu"],"data-testid":"float-element-context-menu",ref:p,style:{top:r,left:n},children:[S.jsx(ee,{testId:"float-element-context-menu-copy",onClick:()=>{c(),e.setFloatElementUuid(s),e.copy()},children:P("copy")}),S.jsx(ee,{testId:"float-element-context-menu-cut",onClick:()=>{c(),e.setFloatElementUuid(s),e.cut()},children:P("cut")}),S.jsx(ee,{testId:"float-element-context-menu-paste",onClick:()=>{c(),e.paste()},children:P("paste")}),S.jsx(ee,{testId:"float-element-context-menu-duplicate",onClick:()=>{c(),e.setFloatElementUuid(s),e.copy(),e.paste(),e.setFloatElementUuid("")},children:P("duplicate")}),i==="chart"&&S.jsxs(Qs.Fragment,{children:[S.jsx(ee,{onClick:m,testId:"float-element-context-menu-select-data",children:P("select-data")}),S.jsx(ee,{onClick:_,testId:"float-element-context-menu-change-chart-title",children:P("change-chart-title")}),S.jsx(ee,{onClick:g,testId:"float-element-context-menu-change-chart-type",children:P("change-chart-type")})]}),S.jsx(ee,{testId:"float-element-context-menu-save-as-picture",onClick:y,children:P("save-as-picture")}),S.jsx(ee,{disabled:f===u&&h===d,testId:"float-element-context-reset-size",onClick:()=>{c(),e.updateDrawing(s,{height:d,width:u}),l({width:u,height:d})},children:P("reset-size")}),S.jsx(ee,{testId:"float-element-context-menu-delete",onClick:()=>{c(),e.deleteDrawing(s)},children:P("delete")})]})});wI.displayName="FloatElementContextMenu";var Ve=(t=>(t.top="top",t.topRight="top-right",t.topLeft="top-left",t.bottom="bottom",t.bottomLeft="bottom-left",t.bottomRight="bottom-right",t.left="left",t.right="right",t.rotate="rotate",t.active="active",t))(Ve||{});const Es={resizePosition:"",moveStartX:0,moveStartY:0,activeUuid:"",position:{width:-1,height:-1,imageAngle:0,top:-1,left:-1}};function OS(t,e){const n=ar.get(),r=zn.get(),s=n.height,i=n.width;return t<s&&(t=s),t>r.height&&(t=r.height),e<i&&(e=i),e>r.width&&(e=r.width),{top:t,left:e}}const y9=Qs.lazy(()=>i1(()=>import("./Chart-Bhz-9HqT.js"),__vite__mapDeps([0,1]))),w9=T.memo(t=>{const{top:e,left:n,active:r,width:s,height:i,type:o,imageAngle:a=0,resetResize:l,pointerDown:c,resizeDown:d}=t,[u,f]=T.useState({top:sr,left:sr}),h=T.useCallback(_=>{_.preventDefault(),_.stopPropagation(),f({top:_.clientY,left:_.clientX})},[]),p=T.useCallback(()=>{f({top:sr,left:sr})},[]);let m;return o==="floating-picture"?m=S.jsx("img",{title:t.title,alt:t.title,src:t.imageSrc,className:Le.image,"data-uuid":t.uuid,"data-testid":"float-element-image"}):o==="chart"&&(m=S.jsx(T.Suspense,{fallback:S.jsx(ax,{}),children:S.jsx(y9,{...t})})),m&&S.jsxs(Qs.Fragment,{children:[S.jsxs("div",{onPointerDown:c,onContextMenu:h,className:Fe(Le["float-element"],{[Le.active]:r}),style:{transform:`translateX(${n}px) translateY(${e}px) ${o==="floating-picture"?`rotate(${a}deg)`:""} `,width:s,height:i},"data-testid":"float-element",children:[m,r&&S.jsxs(Qs.Fragment,{children:[S.jsx("div",{className:Fe(Le["resize-handler"],Le.top),"data-position":Ve.top,onPointerDown:d,"data-testid":"float-element-resize-top",children:S.jsx("div",{className:Le["scale-dot"]})}),S.jsx("div",{className:Fe(Le["resize-handler"],Le["top-right"]),"data-position":Ve.topRight,onPointerDown:d,"data-testid":"float-element-resize-top-right",children:S.jsx("div",{className:Le["scale-dot"]})}),S.jsx("div",{className:Fe(Le["resize-handler"],Le["top-left"]),"data-position":Ve.topLeft,onPointerDown:d,"data-testid":"float-element-resize-top-left",children:S.jsx("div",{className:Le["scale-dot"]})}),S.jsx("div",{className:Fe(Le["resize-handler"],Le.left),"data-position":Ve.left,onPointerDown:d,"data-testid":"float-element-resize-left",children:S.jsx("div",{className:Le["scale-dot"]})}),S.jsx("div",{className:Fe(Le["resize-handler"],Le.right),"data-position":Ve.right,onPointerDown:d,"data-testid":"float-element-resize-right",children:S.jsx("div",{className:Le["scale-dot"]})}),S.jsx("div",{className:Fe(Le["resize-handler"],Le["bottom-right"]),"data-position":Ve.bottomRight,onPointerDown:d,"data-testid":"float-element-resize-bottom-right",children:S.jsx("div",{className:Le["scale-dot"]})}),S.jsx("div",{className:Fe(Le["resize-handler"],Le["bottom-left"]),"data-position":Ve.bottomLeft,onPointerDown:d,"data-testid":"float-element-resize-bottom-left",children:S.jsx("div",{className:Le["scale-dot"]})}),S.jsx("div",{className:Fe(Le["resize-handler"],Le.bottom),"data-position":Ve.bottom,onPointerDown:d,"data-testid":"float-element-resize-bottom",children:S.jsx("div",{className:Le["scale-dot"]})}),o==="floating-picture"&&S.jsx("div",{className:Fe(Le["resize-handler"],Le.rotate),"data-position":Ve.rotate,onPointerDown:d,"data-testid":"float-element-rotate",children:S.jsx("div",{className:Le["rotate-icon"],children:S.jsx(Mt,{name:"rotate"})})})]})]}),u.top>=0&&u.left>=0&&S.jsx(wI,{...t,resetResize:l,menuLeft:u.left,menuTop:u.top,hideContextMenu:p})]})}),SI=T.memo(({controller:t,floatElementList:e,activeUuid:n})=>{const r=T.useRef({...Es,position:{...Es.position}}),[s,i]=T.useState({width:-1,height:-1,imageAngle:0,top:-1,left:-1});r.current.activeUuid=n,r.current.position={...s};const[o]=T.useMemo(()=>{const d=p=>{const m=Math.round(p.clientX-r.current.moveStartX),_=Math.round(p.clientY-r.current.moveStartY);i(g=>{const y=r.current.resizePosition;let{top:w,left:v,width:x,height:C}=g;return[Ve.topRight,Ve.topLeft,Ve.top].includes(y)?(C-=_,w+=_):[Ve.bottomRight,Ve.bottom,Ve.bottomLeft].includes(y)&&(C+=_),[Ve.topLeft,Ve.bottomLeft,Ve.left].includes(y)?(x-=m,v+=m):[Ve.topRight,Ve.bottomRight,Ve.right].includes(y)&&(x+=m),{...OS(w,v),imageAngle:g.imageAngle,width:x,height:C}})},u=p=>{p.stopPropagation(),p.preventDefault();const m=r.current.activeUuid;if(!m||!r.current.resizePosition){r.current={...Es,position:{...Es.position}};return}const _=r.current.position;if(r.current.resizePosition===Ve.rotate)t.updateDrawing(m,{imageAngle:_.imageAngle});else if(r.current.resizePosition===Ve.active){const g=zn.get(),{left:y,top:w}=_;if(y>=0&&w>=0&&y<g.width&&w<g.height){const v=Lk(t,y,w);v&&t.updateDrawing(m,{fromCol:v.col,fromRow:v.row,marginX:v.marginX,marginY:v.marginY})}}else _.height>0&&_.width>0&&t.updateDrawing(m,{height:_.height,width:_.width});r.current={...Es,position:{...Es.position}}},f=p=>{if(!(!r.current.resizePosition||p.buttons<=0))if(p.stopPropagation(),p.preventDefault(),r.current.resizePosition===Ve.rotate){const m=p.clientX-r.current.moveStartX,_=p.clientY-r.current.moveStartY,g=Math.atan2(_,m)*180/Math.PI;i(y=>({...y,imageAngle:g}));return}else if(r.current.resizePosition===Ve.active){const m=Math.round(p.clientX-r.current.moveStartX),_=Math.round(p.clientY-r.current.moveStartY);i(g=>{const y=g.top+_,w=g.left+m;return{...OS(y,w),imageAngle:g.imageAngle,width:g.width,height:g.height}}),r.current.moveStartX=p.clientX,r.current.moveStartY=p.clientY}else{d(p),r.current.moveStartX=p.clientX,r.current.moveStartY=p.clientY;return}};function h(p){const m=p?document.addEventListener:document.removeEventListener;m("pointerup",u),m("pointermove",f)}return[h]},[]);T.useEffect(()=>o,[o]);const a=T.useCallback(d=>{if(d.stopPropagation(),d.preventDefault(),d.buttons<=0)return;const u=d.currentTarget.dataset.position||"";u&&(r.current.resizePosition=u,r.current.moveStartX=d.clientX,r.current.moveStartY=d.clientY)},[]),l=T.useCallback(d=>{i(u=>({...u,...d}))},[]),c=T.useCallback(()=>{r.current={...Es,position:{...Es.position}},Qt.setState({activeUuid:""}),t.setFloatElementUuid(""),o(!1)},[o]);return S.jsxs(T.Fragment,{children:[S.jsx("div",{className:Fe(Le["float-element-mask"],{[Le.active]:!!n}),"data-testid":"float-element-mask",onPointerDown:c}),e.map(d=>{const u=d.uuid===n,f={...d,...u?s:{}};return S.jsx(w9,{...f,active:u,controller:t,resetResize:l,pointerDown:h=>{h.stopPropagation(),h.preventDefault(),!(h.buttons<=0)&&(r.current.resizePosition=Ve.active,r.current.moveStartX=h.clientX,r.current.moveStartY=h.clientY,r.current.activeUuid=d.uuid,t.setFloatElementUuid(d.uuid),Qt.setState({activeUuid:d.uuid}),i({top:d.top,left:d.left,width:d.width,height:d.height,imageAngle:d.imageAngle||0}),o(!0))},resizeDown:a},d.uuid)})]})});SI.displayName="FloatElementContainer";const S9=300;class v9{constructor(){H(this,"lastTimeStamp",0)}pointerMove(e){const{controller:n,x:r,y:s,position:i}=e,o=ar.get();if(!i)return!1;const{range:a,isMerged:l}=n.getActiveRange({row:i.row,col:i.col,colCount:1,rowCount:1,sheetId:""}),c=n.getActiveRange().range;if(c.row===a.row&&c.col===a.col)return!1;let d=0,u=0;if(r>o.width&&s>o.height){if(l)return n.setActiveRange(a),!1;u=Math.abs(i.col-c.col)+1,d=Math.abs(i.row-c.row)+1}return o.width>r&&o.height<=s&&(d=Math.abs(i.row-c.row)+1),o.width<=r&&o.height>s&&(u=Math.abs(i.col-c.col)+1),n.setActiveRange({row:Math.min(i.row,c.row),col:Math.min(i.col,c.col),rowCount:d,colCount:u,sheetId:""}),!1}pointerDown(e,n){const{controller:r,x:s,y:i,position:o}=e,a=ar.get(),{timeStamp:l}=n;if(!o)return!1;if(a.width>s&&a.height>i)return r.setActiveRange({row:0,col:0,colCount:0,rowCount:0,sheetId:""}),!1;if(a.width>s&&a.height<=i)return r.setActiveRange({row:o.row,col:o.col,rowCount:1,colCount:0,sheetId:""}),!1;if(a.width<=s&&a.height>i)return r.setActiveRange({row:o.row,col:o.col,rowCount:0,colCount:1,sheetId:""}),!1;const{range:c}=r.getActiveRange({row:o.row,col:o.col,colCount:1,rowCount:1,sheetId:r.getCurrentSheetId()}),d=r.getActiveRange().range;return M0(d,c)?l-this.lastTimeStamp<S9&&Qt.setState({editorStatus:rr.EDIT_CELL}):(wn()&&nx(r),r.setActiveRange({row:o.row,col:o.col,rowCount:1,colCount:1,sheetId:""})),this.lastTimeStamp=l,!1}}class _9{pointerDown(e,n){if(!e.position)return!1;const{controller:r,position:s}=e,{row:i,col:o,marginX:a,marginY:l}=s,c=r.getFilter();if(!c)return!1;const{range:d}=c;if(o>=d.col&&o<d.col+d.colCount){const u=r.getRowHeight(i),f=r.getColWidth(o);if(a>f-Em&&l>u-Em)return n.stopPropagation(),{type:"filter",row:i,col:o,x:n.clientX,y:n.clientY}}return!1}pointerMove(){return!1}}const LS=[new _9,new v9],C9="_modalContainer_7sk22_1",E9="_listItem_7sk22_16",Ka={modalContainer:C9,listItem:E9,"dialog-title":"_dialog-title_7sk22_19","dialog-button":"_dialog-button_7sk22_22"};function k9(t,e){const n=t.getCurrentSheetId(),r=t.getSheetInfo(n);if(!r)return;const s=t.getFilter(n);if(!s)return;const{range:i}=s;let o=new Set;s.value&&s.value.type==="normal"&&(o=new Set(s.value.value));const a=new Map,l=[],c=i.rowCount===0?r.rowCount:i.row+i.rowCount;for(let u=i.row+1;u<c;u++){const f=t.getCell({row:u,col:e,rowCount:1,colCount:1,sheetId:n}),h=f?f==null?void 0:f.value:Hn,p=(f==null?void 0:f.value)===void 0;a.has(h)||l.push({checked:!0,label:p?P("filter-empty"):String(h),value:h,count:1}),a.set(h,(a.get(h)||0)+1)}const d=l.findIndex(u=>u.value===Hn);return d>=0&&l.unshift(...l.splice(d,1)),{dataList:l.map(u=>{const f=o.size===0?!0:o.has(u.value);return{...u,count:a.get(u.value)||0,checked:f}})}}const x9=({controller:t,col:e,hide:n})=>{const[r,s]=T.useState([]);return T.useEffect(()=>{const i=k9(t,e);i&&s(i.dataList)},[t,e]),S.jsxs("div",{children:[S.jsx("div",{className:Ka["dialog-title"],children:P("filter")}),S.jsxs("div",{children:[S.jsxs("div",{children:[S.jsx("input",{type:"checkbox",id:"modal_all",name:"all",value:"all",checked:r.every(i=>i.checked),onChange:i=>{s(o=>o.map(a=>({...a,checked:i.target.checked})))}}),S.jsxs("label",{htmlFor:"modal_all",children:[P("filter-all")," "]}),S.jsxs("span",{children:["(",r.length,")"]})]}),r.map((i,o)=>S.jsxs("div",{className:Ka.listItem,children:[S.jsx("input",{type:"checkbox",id:`modal_${i.label}`,name:i.label,value:i.label,checked:i.checked,onChange:a=>s(l=>(l[o].checked=a.target.checked,[...l]))}),S.jsx("label",{htmlFor:`modal_${i.label}`,children:i.label}),S.jsxs("span",{children:["(",i.count,")"]})]},i.label))]}),S.jsxs("div",{className:Ka["dialog-button"],children:[S.jsx(ee,{onClick:n,children:P("cancel")}),S.jsx(ee,{className:Ka["dialog-cancel"],type:"primary",onClick:()=>{const i=r.filter(o=>o.checked).map(o=>o.value);if(i.length===r.length){const o=t.getFilter();typeof(o==null?void 0:o.col)=="number"&&(o!=null&&o.value)&&t.updateFilter("",{col:void 0,value:void 0}),n();return}t.updateFilter("",{col:e,value:{type:"normal",value:i}}),n()},children:P("confirm")})]})]})},I9=t=>{let e=null;if(t.type==="filter")e=S.jsx(x9,{...t});else throw new Error(`can't handle the modal type: ${t.type}`);return S.jsx("div",{style:{top:t.y,left:t.x},className:Ka.modalContainer,children:e})};function FS(t,e){const n=zn.get(),{clientX:r=0,clientY:s=0}=t,i=r-n.left,o=s-n.top;return{position:Lk(e,i,o),x:i,y:o,controller:e}}const vI=T.memo(t=>{const{controller:e}=t,[n,r]=T.useState(null),s=T.useSyncExternalStore(Dm.subscribe,Dm.getSnapshot),{activeUuid:i}=T.useSyncExternalStore(Qt.subscribe,Qt.getSnapshot),[o,a]=T.useState({top:sr,left:sr}),l=T.useRef(null);T.useEffect(()=>{if(l.current)return i9(e,l.current)},[]);const c=h=>{h.preventDefault(),a({top:h.clientY,left:h.clientX})},d=()=>{a({top:sr,left:sr})},u=h=>{if(h.buttons<=0)return;const p=FS(h,e);for(const m of LS){const _=m.pointerMove(p,h);if(_){typeof _!="boolean"&&r(_);break}}},f=async h=>{if(h.buttons<=0)return;r(null);const p=FS(h,e);for(const m of LS){const _=m.pointerDown(p,h);if(_){typeof _!="boolean"&&r(_);break}}};return S.jsxs(T.Fragment,{children:[S.jsxs("div",{className:On["canvas-container"],"data-testid":"canvas-container",children:[S.jsx("canvas",{className:On["canvas-content"],onContextMenu:c,onPointerMove:u,onPointerDown:f,ref:l,"data-testid":"canvas-main"}),S.jsx(yx,{controller:e}),S.jsx(yI,{controller:e}),s.length>0&&S.jsx(SI,{controller:e,floatElementList:s,activeUuid:i})]}),o.top>=0&&o.left>=0&&S.jsx(wx,{...o,controller:e,hideContextMenu:d}),n&&S.jsx(I9,{...n,controller:e,hide:()=>r(null)})]})});vI.displayName="CanvasContainer";const b9="_active_1d9ea_30",Sn={"sheet-bar-wrapper":"_sheet-bar-wrapper_1d9ea_1","sheet-bar-list":"_sheet-bar-list_1d9ea_11","sheet-bar-item":"_sheet-bar-item_1d9ea_22",active:b9,"sheet-bar-item-text":"_sheet-bar-item-text_1d9ea_35","sheet-bar-item-color":"_sheet-bar-item-color_1d9ea_39","sheet-bar-context-menu":"_sheet-bar-context-menu_1d9ea_48","sheet-bar-input":"_sheet-bar-input_1d9ea_63","show-block":"_show-block_1d9ea_75","sheet-bar-unhide":"_sheet-bar-unhide_1d9ea_79","add-button":"_add-button_1d9ea_83","menu-button":"_menu-button_1d9ea_90","select-popup":"_select-popup_1d9ea_98","unhide-select":"_unhide-select_1d9ea_103"},_I=T.memo(({controller:t,position:e,sheetList:n,currentSheetId:r,hideMenu:s,editSheetName:i})=>{const o=Rc(s),a=T.useMemo(()=>{var u;return((u=n.find(f=>f.sheetId===r))==null?void 0:u.tabColor)||""},[n,r]),l=T.useMemo(()=>n.filter(u=>u.isHide).map(u=>({value:String(u.sheetId),label:u.name,disabled:!1})),[n]),c=()=>{var f;let u=String((f=l[0])==null?void 0:f.value)||"";pl({visible:!0,title:P("unhide-sheet"),testId:"sheet-bar-context-menu-unhide-dialog",children:S.jsx(Fi,{data:l,onChange:h=>{u=String(h)},className:Sn["unhide-select"],defaultValue:u,testId:"sheet-bar-context-menu-unhide-dialog-select"}),onCancel:s,onOk(){if(!u)return gt.error(P("sheet-id-can-not-be-empty"));t.unhideSheet(u),s()}})},d=u=>{t.updateSheetInfo({tabColor:u}),s()};return S.jsxs("div",{className:Sn["sheet-bar-context-menu"],style:{left:e},ref:o,"data-testid":"sheet-bar-context-menu",children:[S.jsx(ee,{testId:"sheet-bar-context-menu-insert",onClick:()=>{s(),t.addSheet()},children:P("insert")}),S.jsx(ee,{testId:"sheet-bar-context-menu-delete",onClick:()=>{s(),t.deleteSheet()},children:P("delete")}),S.jsx(ee,{testId:"sheet-bar-context-menu-rename",onClick:()=>{s(),i()},children:P("rename")}),S.jsx(ee,{testId:"sheet-bar-context-menu-hide",onClick:()=>{s(),t.hideSheet()},children:P("hide")}),S.jsx(ee,{testId:"sheet-bar-context-menu-unhide",className:Sn["sheet-bar-unhide"],disabled:l.length===0,onClick:c,children:P("unhide")}),S.jsx(Ql,{color:a,onChange:d,position:"top",testId:"sheet-bar-context-menu-tab-color",children:S.jsx(ee,{className:Sn["sheet-bar-unhide"],testId:"sheet-bar-context-menu-tab-color",children:P("tab-color")})})]})});_I.displayName="SheetBarContextMenu";const CI=T.memo(({controller:t})=>{const e=T.useSyncExternalStore($d.subscribe,$d.getSnapshot),n=T.useMemo(()=>e.filter(y=>!y.isHide),[e]),r=T.useMemo(()=>e.filter(y=>!y.isHide).map(y=>({value:y.sheetId,label:y.name,disabled:!1})),[e]),[s,i]=T.useState(!1),{currentSheetId:o}=T.useSyncExternalStore(Qt.subscribe,Qt.getSnapshot),[a,l]=T.useState(sr),[c,d]=T.useState(!1),u=T.useCallback(y=>{y.preventDefault();const w=y.clientX-30;return l(w),!1},[]),f=T.useCallback(y=>{if(y.stopPropagation(),y.key==="Enter"){const w=y.currentTarget.value;if(d(!1),!w)return;t.renameSheet(w)}},[]),h=T.useCallback(y=>{i(!1),t.setCurrentSheetId(y)},[]),p=T.useCallback(()=>{t.addSheet()},[]),m=T.useCallback(()=>{l(sr)},[]),_=T.useCallback(()=>{d(!0)},[]),g=T.useCallback(()=>{i(y=>!y)},[]);return S.jsxs("div",{className:Sn["sheet-bar-wrapper"],"data-testid":"sheet-bar",children:[S.jsxs("div",{children:[S.jsx(ee,{onClick:g,className:Sn["menu-button"],testId:"sheet-bar-select-sheet",children:S.jsx(Mt,{name:"menu"})}),s&&S.jsx(H0,{data:r,onChange:h,active:!0,position:"top",value:o,testId:"sheet-bar-select-sheet-popup",className:Sn["select-popup"]})]}),S.jsx("div",{className:Sn["sheet-bar-list"],"data-testid":"sheet-bar-list",children:n.map(y=>{const w=o===y.sheetId,v=w&&c,x=y.tabColor||"",C=Fe(Sn["sheet-bar-item"],{[Sn.active]:w});let E;!w&&!c&&x&&(E={backgroundColor:x});const A=w?"sheet-bar-active-item":void 0;return S.jsx("div",{"data-testid":`${Sk}${y.sheetId}`,className:C,style:E,onContextMenu:u,onClick:()=>{o!==y.sheetId&&(d(!1),t.setCurrentSheetId(y.sheetId))},children:v?S.jsx("input",{className:Sn["sheet-bar-input"],defaultValue:y.name,onKeyDown:f,type:"text",spellCheck:!0,maxLength:Wl,"data-testid":"sheet-bar-rename-input"}):S.jsxs(Qs.Fragment,{children:[w&&x&&S.jsx("span",{className:Sn["sheet-bar-item-color"],style:{backgroundColor:x},"data-testid":"sheet-bar-tab-color-item"}),S.jsx("span",{className:Sn["sheet-bar-item-text"],"data-testid":A,children:y.name})]})},y.sheetId)})}),S.jsx(ee,{onClick:p,type:"circle",className:Sn["add-button"],testId:"sheet-bar-add-sheet",children:S.jsx(Mt,{name:"plus"})}),a>=0&&S.jsx(_I,{controller:t,position:a,sheetList:e,currentSheetId:o,hideMenu:m,editSheetName:_})]})});CI.displayName="SheetBarContainer";const qt={"_rels/.rels":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
      <Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/>
      <Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/>
      <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/>
    </Relationships>`,"docProps/app.xml":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"
      xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes">
      <Application>Microsoft Excel</Application>
      <DocSecurity>0</DocSecurity>
      <ScaleCrop>false</ScaleCrop>
      <HeadingPairs>
        <vt:vector size="2" baseType="variant">
          <vt:variant>
            <vt:lpstr></vt:lpstr>
          </vt:variant>
          <vt:variant>
            <vt:i4>{size}</vt:i4>
          </vt:variant>
        </vt:vector>
      </HeadingPairs>
      <TitlesOfParts>
        <vt:vector size="{size}" baseType="lpstr">
          {children}
        </vt:vector>
      </TitlesOfParts>
      <Company></Company>
      <LinksUpToDate>false</LinksUpToDate>
      <SharedDoc>false</SharedDoc>
      <HyperlinksChanged>false</HyperlinksChanged>
      <AppVersion>16.0300</AppVersion>
    </Properties>`,"docProps/core.xml":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties"
      xmlns:dc="http://purl.org/dc/elements/1.1/"
      xmlns:dcterms="http://purl.org/dc/terms/"
      xmlns:dcmitype="http://purl.org/dc/dcmitype/"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <dc:creator>Xu Steve</dc:creator>
      <cp:lastModifiedBy>Xu Steve</cp:lastModifiedBy>
      <dcterms:created xsi:type="dcterms:W3CDTF">{children}</dcterms:created>
      <dcterms:modified xsi:type="dcterms:W3CDTF">{children}</dcterms:modified>
    </cp:coreProperties>`,"xl/_rels/workbook.xml.rels":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
      {children}
      {size}
    </Relationships>`,"xl/charts/_rels/chart1.xml.rels":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
      <Relationship Id="rId2" Type="http://schemas.microsoft.com/office/2011/relationships/chartColorStyle" Target="colors{children}.xml"/>
      <Relationship Id="rId1" Type="http://schemas.microsoft.com/office/2011/relationships/chartStyle" Target="style{children}.xml"/>
    </Relationships>`,"xl/charts/chart1.xml":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <c:chartSpace xmlns:c="http://schemas.openxmlformats.org/drawingml/2006/chart"
      xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"
      xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"
      xmlns:c16r2="http://schemas.microsoft.com/office/drawing/2015/06/chart">
      <c:date1904 val="0"/>
      <c:lang val="zh-CN"/>
      <c:roundedCorners val="0"/>
      <mc:AlternateContent xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006">
        <mc:Choice Requires="c14"
          xmlns:c14="http://schemas.microsoft.com/office/drawing/2007/8/2/chart">
          <c14:style val="102"/>
        </mc:Choice>
        <mc:Fallback>
          <c:style val="2"/>
        </mc:Fallback>
      </mc:AlternateContent>
      <c:chart>
        <c:title>
          <c:tx>
            <c:rich>
              <a:bodyPr rot="0" spcFirstLastPara="1" vertOverflow="ellipsis" vert="horz" wrap="square" anchor="ctr" anchorCtr="1"/>
              <a:lstStyle/>
              <a:p>
                <a:pPr>
                  <a:defRPr sz="1400" b="0" i="0" u="none" strike="noStrike" kern="1200" spc="0" baseline="0">
                    <a:solidFill>
                      <a:schemeClr val="tx1">
                        <a:lumMod val="65000"/>
                        <a:lumOff val="35000"/>
                      </a:schemeClr>
                    </a:solidFill>
                    <a:latin typeface="+mn-lt"/>
                    <a:ea typeface="+mn-ea"/>
                    <a:cs typeface="+mn-cs"/>
                  </a:defRPr>
                </a:pPr>
                <a:r>
                  <a:rPr lang="en-US" altLang="zh-CN"/>
                  <a:t>{size}</a:t>
                </a:r>
              </a:p>
              <a:p>
                <a:pPr>
                  <a:defRPr/>
                </a:pPr>
                <a:endParaRPr lang="zh-CN" altLang="en-US"/>
              </a:p>
            </c:rich>
          </c:tx>
          <c:overlay val="0"/>
          <c:spPr>
            <a:noFill/>
            <a:ln>
              <a:noFill/>
            </a:ln>
            <a:effectLst/>
          </c:spPr>
          <c:txPr>
            <a:bodyPr rot="0" spcFirstLastPara="1" vertOverflow="ellipsis" vert="horz" wrap="square" anchor="ctr" anchorCtr="1"/>
            <a:lstStyle/>
            <a:p>
              <a:pPr>
                <a:defRPr sz="1400" b="0" i="0" u="none" strike="noStrike" kern="1200" spc="0" baseline="0">
                  <a:solidFill>
                    <a:schemeClr val="tx1">
                      <a:lumMod val="65000"/>
                      <a:lumOff val="35000"/>
                    </a:schemeClr>
                  </a:solidFill>
                  <a:latin typeface="+mn-lt"/>
                  <a:ea typeface="+mn-ea"/>
                  <a:cs typeface="+mn-cs"/>
                </a:defRPr>
              </a:pPr>
              <a:endParaRPr lang="zh-CN"/>
            </a:p>
          </c:txPr>
        </c:title>
        <c:autoTitleDeleted val="0"/>
        <c:plotArea>
          <c:layout/>
          <c:{large}Chart>
            <c:barDir val="col"/>
            <c:grouping val="clustered"/>
            <c:varyColors val="0"/>
            {children}
            <c:dLbls>
              <c:showLegendKey val="0"/>
              <c:showVal val="0"/>
              <c:showCatName val="0"/>
              <c:showSerName val="0"/>
              <c:showPercent val="0"/>
              <c:showBubbleSize val="0"/>
            </c:dLbls>
            <c:gapWidth val="219"/>
            <c:overlap val="-27"/>
            <c:axId val="152326191"/>
            <c:axId val="152327631"/>
          </c:barChart>
          <c:catAx>
            <c:axId val="152326191"/>
            <c:scaling>
              <c:orientation val="minMax"/>
            </c:scaling>
            <c:delete val="0"/>
            <c:axPos val="b"/>
            <c:majorTickMark val="none"/>
            <c:minorTickMark val="none"/>
            <c:tickLblPos val="nextTo"/>
            <c:spPr>
              <a:noFill/>
              <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">
                <a:solidFill>
                  <a:schemeClr val="tx1">
                    <a:lumMod val="15000"/>
                    <a:lumOff val="85000"/>
                  </a:schemeClr>
                </a:solidFill>
                <a:round/>
              </a:ln>
              <a:effectLst/>
            </c:spPr>
            <c:txPr>
              <a:bodyPr rot="-60000000" spcFirstLastPara="1" vertOverflow="ellipsis" vert="horz" wrap="square" anchor="ctr" anchorCtr="1"/>
              <a:lstStyle/>
              <a:p>
                <a:pPr>
                  <a:defRPr sz="900" b="0" i="0" u="none" strike="noStrike" kern="1200" baseline="0">
                    <a:solidFill>
                      <a:schemeClr val="tx1">
                        <a:lumMod val="65000"/>
                        <a:lumOff val="35000"/>
                      </a:schemeClr>
                    </a:solidFill>
                    <a:latin typeface="+mn-lt"/>
                    <a:ea typeface="+mn-ea"/>
                    <a:cs typeface="+mn-cs"/>
                  </a:defRPr>
                </a:pPr>
                <a:endParaRPr lang="zh-CN"/>
              </a:p>
            </c:txPr>
            <c:crossAx val="152327631"/>
            <c:crosses val="autoZero"/>
            <c:auto val="1"/>
            <c:lblAlgn val="ctr"/>
            <c:lblOffset val="100"/>
            <c:noMultiLvlLbl val="0"/>
          </c:catAx>
          <c:valAx>
            <c:axId val="152327631"/>
            <c:scaling>
              <c:orientation val="minMax"/>
            </c:scaling>
            <c:delete val="0"/>
            <c:axPos val="l"/>
            <c:majorGridlines>
              <c:spPr>
                <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">
                  <a:solidFill>
                    <a:schemeClr val="tx1">
                      <a:lumMod val="15000"/>
                      <a:lumOff val="85000"/>
                    </a:schemeClr>
                  </a:solidFill>
                  <a:round/>
                </a:ln>
                <a:effectLst/>
              </c:spPr>
            </c:majorGridlines>
            <c:numFmt formatCode="General" sourceLinked="1"/>
            <c:majorTickMark val="none"/>
            <c:minorTickMark val="none"/>
            <c:tickLblPos val="nextTo"/>
            <c:spPr>
              <a:noFill/>
              <a:ln>
                <a:noFill/>
              </a:ln>
              <a:effectLst/>
            </c:spPr>
            <c:txPr>
              <a:bodyPr rot="-60000000" spcFirstLastPara="1" vertOverflow="ellipsis" vert="horz" wrap="square" anchor="ctr" anchorCtr="1"/>
              <a:lstStyle/>
              <a:p>
                <a:pPr>
                  <a:defRPr sz="900" b="0" i="0" u="none" strike="noStrike" kern="1200" baseline="0">
                    <a:solidFill>
                      <a:schemeClr val="tx1">
                        <a:lumMod val="65000"/>
                        <a:lumOff val="35000"/>
                      </a:schemeClr>
                    </a:solidFill>
                    <a:latin typeface="+mn-lt"/>
                    <a:ea typeface="+mn-ea"/>
                    <a:cs typeface="+mn-cs"/>
                  </a:defRPr>
                </a:pPr>
                <a:endParaRPr lang="zh-CN"/>
              </a:p>
            </c:txPr>
            <c:crossAx val="152326191"/>
            <c:crosses val="autoZero"/>
            <c:crossBetween val="between"/>
          </c:valAx>
          <c:spPr>
            <a:noFill/>
            <a:ln>
              <a:noFill/>
            </a:ln>
            <a:effectLst/>
          </c:spPr>
        </c:plotArea>
        <c:legend>
          <c:legendPos val="b"/>
          <c:overlay val="0"/>
          <c:spPr>
            <a:noFill/>
            <a:ln>
              <a:noFill/>
            </a:ln>
            <a:effectLst/>
          </c:spPr>
          <c:txPr>
            <a:bodyPr rot="0" spcFirstLastPara="1" vertOverflow="ellipsis" vert="horz" wrap="square" anchor="ctr" anchorCtr="1"/>
            <a:lstStyle/>
            <a:p>
              <a:pPr>
                <a:defRPr sz="900" b="0" i="0" u="none" strike="noStrike" kern="1200" baseline="0">
                  <a:solidFill>
                    <a:schemeClr val="tx1">
                      <a:lumMod val="65000"/>
                      <a:lumOff val="35000"/>
                    </a:schemeClr>
                  </a:solidFill>
                  <a:latin typeface="+mn-lt"/>
                  <a:ea typeface="+mn-ea"/>
                  <a:cs typeface="+mn-cs"/>
                </a:defRPr>
              </a:pPr>
              <a:endParaRPr lang="zh-CN"/>
            </a:p>
          </c:txPr>
        </c:legend>
        <c:plotVisOnly val="1"/>
        <c:dispBlanksAs val="gap"/>
        <c:extLst>
          <c:ext uri="{56B9EC1D-385E-4148-901F-78D8002777C0}"
            xmlns:c16r3="http://schemas.microsoft.com/office/drawing/2017/03/chart">
            <c16r3:dataDisplayOptions16>
              <c16r3:dispNaAsBlank val="1"/>
            </c16r3:dataDisplayOptions16>
          </c:ext>
        </c:extLst>
        <c:showDLblsOverMax val="0"/>
      </c:chart>
      <c:spPr>
        <a:solidFill>
          <a:schemeClr val="bg1"/>
        </a:solidFill>
        <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">
          <a:solidFill>
            <a:schemeClr val="tx1">
              <a:lumMod val="15000"/>
              <a:lumOff val="85000"/>
            </a:schemeClr>
          </a:solidFill>
          <a:round/>
        </a:ln>
        <a:effectLst/>
      </c:spPr>
      <c:txPr>
        <a:bodyPr/>
        <a:lstStyle/>
        <a:p>
          <a:pPr>
            <a:defRPr/>
          </a:pPr>
          <a:endParaRPr lang="zh-CN"/>
        </a:p>
      </c:txPr>
      <c:printSettings>
        <c:headerFooter/>
        <c:pageMargins b="0.75" l="0.7" r="0.7" t="0.75" header="0.3" footer="0.3"/>
        <c:pageSetup/>
      </c:printSettings>
    </c:chartSpace>`,"xl/charts/colors1.xml":`<cs:colorStyle xmlns:cs="http://schemas.microsoft.com/office/drawing/2012/chartStyle"
xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" meth="cycle" id="10">
<a:schemeClr val="accent1"/>
<a:schemeClr val="accent2"/>
<a:schemeClr val="accent3"/>
<a:schemeClr val="accent4"/>
<a:schemeClr val="accent5"/>
<a:schemeClr val="accent6"/>
<cs:variation/>
<cs:variation>
  <a:lumMod val="60000"/>
</cs:variation>
<cs:variation>
  <a:lumMod val="80000"/>
  <a:lumOff val="20000"/>
</cs:variation>
<cs:variation>
  <a:lumMod val="80000"/>
</cs:variation>
<cs:variation>
  <a:lumMod val="60000"/>
  <a:lumOff val="40000"/>
</cs:variation>
<cs:variation>
  <a:lumMod val="50000"/>
</cs:variation>
<cs:variation>
  <a:lumMod val="70000"/>
  <a:lumOff val="30000"/>
</cs:variation>
<cs:variation>
  <a:lumMod val="70000"/>
</cs:variation>
<cs:variation>
  <a:lumMod val="50000"/>
  <a:lumOff val="50000"/>
</cs:variation>
</cs:colorStyle>`,"xl/charts/style1.xml":`<cs:chartStyle xmlns:cs="http://schemas.microsoft.com/office/drawing/2012/chartStyle"
    xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" id="201">
    <cs:axisTitle>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1">
          <a:lumMod val="65000"/>
          <a:lumOff val="35000"/>
        </a:schemeClr>
      </cs:fontRef>
      <cs:defRPr sz="1000" kern="1200"/>
    </cs:axisTitle>
    <cs:categoryAxis>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1">
          <a:lumMod val="65000"/>
          <a:lumOff val="35000"/>
        </a:schemeClr>
      </cs:fontRef>
      <cs:spPr>
        <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">
          <a:solidFill>
            <a:schemeClr val="tx1">
              <a:lumMod val="15000"/>
              <a:lumOff val="85000"/>
            </a:schemeClr>
          </a:solidFill>
          <a:round/>
        </a:ln>
      </cs:spPr>
      <cs:defRPr sz="900" kern="1200"/>
    </cs:categoryAxis>
    <cs:chartArea mods="allowNoFillOverride allowNoLineOverride">
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:solidFill>
          <a:schemeClr val="bg1"/>
        </a:solidFill>
        <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">
          <a:solidFill>
            <a:schemeClr val="tx1">
              <a:lumMod val="15000"/>
              <a:lumOff val="85000"/>
            </a:schemeClr>
          </a:solidFill>
          <a:round/>
        </a:ln>
      </cs:spPr>
      <cs:defRPr sz="1000" kern="1200"/>
    </cs:chartArea>
    <cs:dataLabel>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1">
          <a:lumMod val="75000"/>
          <a:lumOff val="25000"/>
        </a:schemeClr>
      </cs:fontRef>
      <cs:defRPr sz="900" kern="1200"/>
    </cs:dataLabel>
    <cs:dataLabelCallout>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="dk1">
          <a:lumMod val="65000"/>
          <a:lumOff val="35000"/>
        </a:schemeClr>
      </cs:fontRef>
      <cs:spPr>
        <a:solidFill>
          <a:schemeClr val="lt1"/>
        </a:solidFill>
        <a:ln>
          <a:solidFill>
            <a:schemeClr val="dk1">
              <a:lumMod val="25000"/>
              <a:lumOff val="75000"/>
            </a:schemeClr>
          </a:solidFill>
        </a:ln>
      </cs:spPr>
      <cs:defRPr sz="900" kern="1200"/>
      <cs:bodyPr rot="0" spcFirstLastPara="1" vertOverflow="clip" horzOverflow="clip" vert="horz" wrap="square" lIns="36576" tIns="18288" rIns="36576" bIns="18288" anchor="ctr" anchorCtr="1">
        <a:spAutoFit/>
      </cs:bodyPr>
    </cs:dataLabelCallout>
    <cs:dataPoint>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="1">
        <cs:styleClr val="auto"/>
      </cs:fillRef>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
    </cs:dataPoint>
    <cs:dataPoint3D>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="1">
        <cs:styleClr val="auto"/>
      </cs:fillRef>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
    </cs:dataPoint3D>
    <cs:dataPointLine>
      <cs:lnRef idx="0">
        <cs:styleClr val="auto"/>
      </cs:lnRef>
      <cs:fillRef idx="1"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:ln w="28575" cap="rnd">
          <a:solidFill>
            <a:schemeClr val="phClr"/>
          </a:solidFill>
          <a:round/>
        </a:ln>
      </cs:spPr>
    </cs:dataPointLine>
    <cs:dataPointMarker>
      <cs:lnRef idx="0">
        <cs:styleClr val="auto"/>
      </cs:lnRef>
      <cs:fillRef idx="1">
        <cs:styleClr val="auto"/>
      </cs:fillRef>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:ln w="9525">
          <a:solidFill>
            <a:schemeClr val="phClr"/>
          </a:solidFill>
        </a:ln>
      </cs:spPr>
    </cs:dataPointMarker>
    <cs:dataPointMarkerLayout symbol="circle" size="5"/>
    <cs:dataPointWireframe>
      <cs:lnRef idx="0">
        <cs:styleClr val="auto"/>
      </cs:lnRef>
      <cs:fillRef idx="1"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:ln w="9525" cap="rnd">
          <a:solidFill>
            <a:schemeClr val="phClr"/>
          </a:solidFill>
          <a:round/>
        </a:ln>
      </cs:spPr>
    </cs:dataPointWireframe>
    <cs:dataTable>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1">
          <a:lumMod val="65000"/>
          <a:lumOff val="35000"/>
        </a:schemeClr>
      </cs:fontRef>
      <cs:spPr>
        <a:noFill/>
        <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">
          <a:solidFill>
            <a:schemeClr val="tx1">
              <a:lumMod val="15000"/>
              <a:lumOff val="85000"/>
            </a:schemeClr>
          </a:solidFill>
          <a:round/>
        </a:ln>
      </cs:spPr>
      <cs:defRPr sz="900" kern="1200"/>
    </cs:dataTable>
    <cs:downBar>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="dk1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:solidFill>
          <a:schemeClr val="dk1">
            <a:lumMod val="65000"/>
            <a:lumOff val="35000"/>
          </a:schemeClr>
        </a:solidFill>
        <a:ln w="9525">
          <a:solidFill>
            <a:schemeClr val="tx1">
              <a:lumMod val="65000"/>
              <a:lumOff val="35000"/>
            </a:schemeClr>
          </a:solidFill>
        </a:ln>
      </cs:spPr>
    </cs:downBar>
    <cs:dropLine>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">
          <a:solidFill>
            <a:schemeClr val="tx1">
              <a:lumMod val="35000"/>
              <a:lumOff val="65000"/>
            </a:schemeClr>
          </a:solidFill>
          <a:round/>
        </a:ln>
      </cs:spPr>
    </cs:dropLine>
    <cs:errorBar>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">
          <a:solidFill>
            <a:schemeClr val="tx1">
              <a:lumMod val="65000"/>
              <a:lumOff val="35000"/>
            </a:schemeClr>
          </a:solidFill>
          <a:round/>
        </a:ln>
      </cs:spPr>
    </cs:errorBar>
    <cs:floor>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:noFill/>
        <a:ln>
          <a:noFill/>
        </a:ln>
      </cs:spPr>
    </cs:floor>
    <cs:gridlineMajor>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">
          <a:solidFill>
            <a:schemeClr val="tx1">
              <a:lumMod val="15000"/>
              <a:lumOff val="85000"/>
            </a:schemeClr>
          </a:solidFill>
          <a:round/>
        </a:ln>
      </cs:spPr>
    </cs:gridlineMajor>
    <cs:gridlineMinor>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">
          <a:solidFill>
            <a:schemeClr val="tx1">
              <a:lumMod val="5000"/>
              <a:lumOff val="95000"/>
            </a:schemeClr>
          </a:solidFill>
          <a:round/>
        </a:ln>
      </cs:spPr>
    </cs:gridlineMinor>
    <cs:hiLoLine>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">
          <a:solidFill>
            <a:schemeClr val="tx1">
              <a:lumMod val="75000"/>
              <a:lumOff val="25000"/>
            </a:schemeClr>
          </a:solidFill>
          <a:round/>
        </a:ln>
      </cs:spPr>
    </cs:hiLoLine>
    <cs:leaderLine>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">
          <a:solidFill>
            <a:schemeClr val="tx1">
              <a:lumMod val="35000"/>
              <a:lumOff val="65000"/>
            </a:schemeClr>
          </a:solidFill>
          <a:round/>
        </a:ln>
      </cs:spPr>
    </cs:leaderLine>
    <cs:legend>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1">
          <a:lumMod val="65000"/>
          <a:lumOff val="35000"/>
        </a:schemeClr>
      </cs:fontRef>
      <cs:defRPr sz="900" kern="1200"/>
    </cs:legend>
    <cs:plotArea mods="allowNoFillOverride allowNoLineOverride">
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
    </cs:plotArea>
    <cs:plotArea3D mods="allowNoFillOverride allowNoLineOverride">
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
    </cs:plotArea3D>
    <cs:seriesAxis>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1">
          <a:lumMod val="65000"/>
          <a:lumOff val="35000"/>
        </a:schemeClr>
      </cs:fontRef>
      <cs:defRPr sz="900" kern="1200"/>
    </cs:seriesAxis>
    <cs:seriesLine>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">
          <a:solidFill>
            <a:schemeClr val="tx1">
              <a:lumMod val="35000"/>
              <a:lumOff val="65000"/>
            </a:schemeClr>
          </a:solidFill>
          <a:round/>
        </a:ln>
      </cs:spPr>
    </cs:seriesLine>
    <cs:title>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1">
          <a:lumMod val="65000"/>
          <a:lumOff val="35000"/>
        </a:schemeClr>
      </cs:fontRef>
      <cs:defRPr sz="1400" b="0" kern="1200" spc="0" baseline="0"/>
    </cs:title>
    <cs:trendline>
      <cs:lnRef idx="0">
        <cs:styleClr val="auto"/>
      </cs:lnRef>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:ln w="19050" cap="rnd">
          <a:solidFill>
            <a:schemeClr val="phClr"/>
          </a:solidFill>
          <a:prstDash val="sysDot"/>
        </a:ln>
      </cs:spPr>
    </cs:trendline>
    <cs:trendlineLabel>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1">
          <a:lumMod val="65000"/>
          <a:lumOff val="35000"/>
        </a:schemeClr>
      </cs:fontRef>
      <cs:defRPr sz="900" kern="1200"/>
    </cs:trendlineLabel>
    <cs:upBar>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="dk1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:solidFill>
          <a:schemeClr val="lt1"/>
        </a:solidFill>
        <a:ln w="9525">
          <a:solidFill>
            <a:schemeClr val="tx1">
              <a:lumMod val="15000"/>
              <a:lumOff val="85000"/>
            </a:schemeClr>
          </a:solidFill>
        </a:ln>
      </cs:spPr>
    </cs:upBar>
    <cs:valueAxis>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1">
          <a:lumMod val="65000"/>
          <a:lumOff val="35000"/>
        </a:schemeClr>
      </cs:fontRef>
      <cs:defRPr sz="900" kern="1200"/>
    </cs:valueAxis>
    <cs:wall>
      <cs:lnRef idx="0"/>
      <cs:fillRef idx="0"/>
      <cs:effectRef idx="0"/>
      <cs:fontRef idx="minor">
        <a:schemeClr val="tx1"/>
      </cs:fontRef>
      <cs:spPr>
        <a:noFill/>
        <a:ln>
          <a:noFill/>
        </a:ln>
      </cs:spPr>
    </cs:wall>
  </cs:chartStyle>`,"xl/drawings/_rels/drawing1.xml.rels":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
      {children}
    </Relationships>`,"xl/drawings/drawing1.xml":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <xdr:wsDr xmlns:xdr="http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"
      xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">
      {children}
    </xdr:wsDr>`,"xl/media/image1.jpeg":"","xl/theme/theme1.xml":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office ">
      <a:themeElements>
        <a:clrScheme name="Office">
          <a:dk1>
            <a:sysClr val="windowText" lastClr="000000"/>
          </a:dk1>
          <a:lt1>
            <a:sysClr val="window" lastClr="FFFFFF"/>
          </a:lt1>
          <a:dk2>
            <a:srgbClr val="44546A"/>
          </a:dk2>
          <a:lt2>
            <a:srgbClr val="E7E6E6"/>
          </a:lt2>
          <a:accent1>
            <a:srgbClr val="4472C4"/>
          </a:accent1>
          <a:accent2>
            <a:srgbClr val="ED7D31"/>
          </a:accent2>
          <a:accent3>
            <a:srgbClr val="A5A5A5"/>
          </a:accent3>
          <a:accent4>
            <a:srgbClr val="FFC000"/>
          </a:accent4>
          <a:accent5>
            <a:srgbClr val="5B9BD5"/>
          </a:accent5>
          <a:accent6>
            <a:srgbClr val="70AD47"/>
          </a:accent6>
          <a:hlink>
            <a:srgbClr val="0563C1"/>
          </a:hlink>
          <a:folHlink>
            <a:srgbClr val="954F72"/>
          </a:folHlink>
        </a:clrScheme>
        <a:fontScheme name="Office">
          <a:majorFont>
            <a:latin typeface="Calibri Light" panose="020F0302020204030204"/>
            <a:ea typeface=""/>
            <a:cs typeface=""/>
            <a:font script="Jpan" typeface=" Light"/>
            <a:font script="Hang" typeface=" "/>
            <a:font script="Hans" typeface=" Light"/>
            <a:font script="Hant" typeface=""/>
            <a:font script="Arab" typeface="Times New Roman"/>
            <a:font script="Hebr" typeface="Times New Roman"/>
            <a:font script="Thai" typeface="Tahoma"/>
            <a:font script="Ethi" typeface="Nyala"/>
            <a:font script="Beng" typeface="Vrinda"/>
            <a:font script="Gujr" typeface="Shruti"/>
            <a:font script="Khmr" typeface="MoolBoran"/>
            <a:font script="Knda" typeface="Tunga"/>
            <a:font script="Guru" typeface="Raavi"/>
            <a:font script="Cans" typeface="Euphemia"/>
            <a:font script="Cher" typeface="Plantagenet Cherokee"/>
            <a:font script="Yiii" typeface="Microsoft Yi Baiti"/>
            <a:font script="Tibt" typeface="Microsoft Himalaya"/>
            <a:font script="Thaa" typeface="MV Boli"/>
            <a:font script="Deva" typeface="Mangal"/>
            <a:font script="Telu" typeface="Gautami"/>
            <a:font script="Taml" typeface="Latha"/>
            <a:font script="Syrc" typeface="Estrangelo Edessa"/>
            <a:font script="Orya" typeface="Kalinga"/>
            <a:font script="Mlym" typeface="Kartika"/>
            <a:font script="Laoo" typeface="DokChampa"/>
            <a:font script="Sinh" typeface="Iskoola Pota"/>
            <a:font script="Mong" typeface="Mongolian Baiti"/>
            <a:font script="Viet" typeface="Times New Roman"/>
            <a:font script="Uigh" typeface="Microsoft Uighur"/>
            <a:font script="Geor" typeface="Sylfaen"/>
            <a:font script="Armn" typeface="Arial"/>
            <a:font script="Bugi" typeface="Leelawadee UI"/>
            <a:font script="Bopo" typeface="Microsoft JhengHei"/>
            <a:font script="Java" typeface="Javanese Text"/>
            <a:font script="Lisu" typeface="Segoe UI"/>
            <a:font script="Mymr" typeface="Myanmar Text"/>
            <a:font script="Nkoo" typeface="Ebrima"/>
            <a:font script="Olck" typeface="Nirmala UI"/>
            <a:font script="Osma" typeface="Ebrima"/>
            <a:font script="Phag" typeface="Phagspa"/>
            <a:font script="Syrn" typeface="Estrangelo Edessa"/>
            <a:font script="Syrj" typeface="Estrangelo Edessa"/>
            <a:font script="Syre" typeface="Estrangelo Edessa"/>
            <a:font script="Sora" typeface="Nirmala UI"/>
            <a:font script="Tale" typeface="Microsoft Tai Le"/>
            <a:font script="Talu" typeface="Microsoft New Tai Lue"/>
            <a:font script="Tfng" typeface="Ebrima"/>
          </a:majorFont>
          <a:minorFont>
            <a:latin typeface="Calibri" panose="020F0502020204030204"/>
            <a:ea typeface=""/>
            <a:cs typeface=""/>
            <a:font script="Jpan" typeface=""/>
            <a:font script="Hang" typeface=" "/>
            <a:font script="Hans" typeface=""/>
            <a:font script="Hant" typeface=""/>
            <a:font script="Arab" typeface="Arial"/>
            <a:font script="Hebr" typeface="Arial"/>
            <a:font script="Thai" typeface="Tahoma"/>
            <a:font script="Ethi" typeface="Nyala"/>
            <a:font script="Beng" typeface="Vrinda"/>
            <a:font script="Gujr" typeface="Shruti"/>
            <a:font script="Khmr" typeface="DaunPenh"/>
            <a:font script="Knda" typeface="Tunga"/>
            <a:font script="Guru" typeface="Raavi"/>
            <a:font script="Cans" typeface="Euphemia"/>
            <a:font script="Cher" typeface="Plantagenet Cherokee"/>
            <a:font script="Yiii" typeface="Microsoft Yi Baiti"/>
            <a:font script="Tibt" typeface="Microsoft Himalaya"/>
            <a:font script="Thaa" typeface="MV Boli"/>
            <a:font script="Deva" typeface="Mangal"/>
            <a:font script="Telu" typeface="Gautami"/>
            <a:font script="Taml" typeface="Latha"/>
            <a:font script="Syrc" typeface="Estrangelo Edessa"/>
            <a:font script="Orya" typeface="Kalinga"/>
            <a:font script="Mlym" typeface="Kartika"/>
            <a:font script="Laoo" typeface="DokChampa"/>
            <a:font script="Sinh" typeface="Iskoola Pota"/>
            <a:font script="Mong" typeface="Mongolian Baiti"/>
            <a:font script="Viet" typeface="Arial"/>
            <a:font script="Uigh" typeface="Microsoft Uighur"/>
            <a:font script="Geor" typeface="Sylfaen"/>
            <a:font script="Armn" typeface="Arial"/>
            <a:font script="Bugi" typeface="Leelawadee UI"/>
            <a:font script="Bopo" typeface="Microsoft JhengHei"/>
            <a:font script="Java" typeface="Javanese Text"/>
            <a:font script="Lisu" typeface="Segoe UI"/>
            <a:font script="Mymr" typeface="Myanmar Text"/>
            <a:font script="Nkoo" typeface="Ebrima"/>
            <a:font script="Olck" typeface="Nirmala UI"/>
            <a:font script="Osma" typeface="Ebrima"/>
            <a:font script="Phag" typeface="Phagspa"/>
            <a:font script="Syrn" typeface="Estrangelo Edessa"/>
            <a:font script="Syrj" typeface="Estrangelo Edessa"/>
            <a:font script="Syre" typeface="Estrangelo Edessa"/>
            <a:font script="Sora" typeface="Nirmala UI"/>
            <a:font script="Tale" typeface="Microsoft Tai Le"/>
            <a:font script="Talu" typeface="Microsoft New Tai Lue"/>
            <a:font script="Tfng" typeface="Ebrima"/>
          </a:minorFont>
        </a:fontScheme>
        <a:fmtScheme name="Office">
          <a:fillStyleLst>
            <a:solidFill>
              <a:schemeClr val="phClr"/>
            </a:solidFill>
            <a:gradFill rotWithShape="1">
              <a:gsLst>
                <a:gs pos="0">
                  <a:schemeClr val="phClr">
                    <a:lumMod val="110000"/>
                    <a:satMod val="105000"/>
                    <a:tint val="67000"/>
                  </a:schemeClr>
                </a:gs>
                <a:gs pos="50000">
                  <a:schemeClr val="phClr">
                    <a:lumMod val="105000"/>
                    <a:satMod val="103000"/>
                    <a:tint val="73000"/>
                  </a:schemeClr>
                </a:gs>
                <a:gs pos="100000">
                  <a:schemeClr val="phClr">
                    <a:lumMod val="105000"/>
                    <a:satMod val="109000"/>
                    <a:tint val="81000"/>
                  </a:schemeClr>
                </a:gs>
              </a:gsLst>
              <a:lin ang="5400000" scaled="0"/>
            </a:gradFill>
            <a:gradFill rotWithShape="1">
              <a:gsLst>
                <a:gs pos="0">
                  <a:schemeClr val="phClr">
                    <a:satMod val="103000"/>
                    <a:lumMod val="102000"/>
                    <a:tint val="94000"/>
                  </a:schemeClr>
                </a:gs>
                <a:gs pos="50000">
                  <a:schemeClr val="phClr">
                    <a:satMod val="110000"/>
                    <a:lumMod val="100000"/>
                    <a:shade val="100000"/>
                  </a:schemeClr>
                </a:gs>
                <a:gs pos="100000">
                  <a:schemeClr val="phClr">
                    <a:lumMod val="99000"/>
                    <a:satMod val="120000"/>
                    <a:shade val="78000"/>
                  </a:schemeClr>
                </a:gs>
              </a:gsLst>
              <a:lin ang="5400000" scaled="0"/>
            </a:gradFill>
          </a:fillStyleLst>
          <a:lnStyleLst>
            <a:ln w="6350" cap="flat" cmpd="sng" algn="ctr">
              <a:solidFill>
                <a:schemeClr val="phClr"/>
              </a:solidFill>
              <a:prstDash val="solid"/>
              <a:miter lim="800000"/>
            </a:ln>
            <a:ln w="12700" cap="flat" cmpd="sng" algn="ctr">
              <a:solidFill>
                <a:schemeClr val="phClr"/>
              </a:solidFill>
              <a:prstDash val="solid"/>
              <a:miter lim="800000"/>
            </a:ln>
            <a:ln w="19050" cap="flat" cmpd="sng" algn="ctr">
              <a:solidFill>
                <a:schemeClr val="phClr"/>
              </a:solidFill>
              <a:prstDash val="solid"/>
              <a:miter lim="800000"/>
            </a:ln>
          </a:lnStyleLst>
          <a:effectStyleLst>
            <a:effectStyle>
              <a:effectLst/>
            </a:effectStyle>
            <a:effectStyle>
              <a:effectLst/>
            </a:effectStyle>
            <a:effectStyle>
              <a:effectLst>
                <a:outerShdw blurRad="57150" dist="19050" dir="5400000" algn="ctr" rotWithShape="0">
                  <a:srgbClr val="000000">
                    <a:alpha val="63000"/>
                  </a:srgbClr>
                </a:outerShdw>
              </a:effectLst>
            </a:effectStyle>
          </a:effectStyleLst>
          <a:bgFillStyleLst>
            <a:solidFill>
              <a:schemeClr val="phClr"/>
            </a:solidFill>
            <a:solidFill>
              <a:schemeClr val="phClr">
                <a:tint val="95000"/>
                <a:satMod val="170000"/>
              </a:schemeClr>
            </a:solidFill>
            <a:gradFill rotWithShape="1">
              <a:gsLst>
                <a:gs pos="0">
                  <a:schemeClr val="phClr">
                    <a:tint val="93000"/>
                    <a:satMod val="150000"/>
                    <a:shade val="98000"/>
                    <a:lumMod val="102000"/>
                  </a:schemeClr>
                </a:gs>
                <a:gs pos="50000">
                  <a:schemeClr val="phClr">
                    <a:tint val="98000"/>
                    <a:satMod val="130000"/>
                    <a:shade val="90000"/>
                    <a:lumMod val="103000"/>
                  </a:schemeClr>
                </a:gs>
                <a:gs pos="100000">
                  <a:schemeClr val="phClr">
                    <a:shade val="63000"/>
                    <a:satMod val="120000"/>
                  </a:schemeClr>
                </a:gs>
              </a:gsLst>
              <a:lin ang="5400000" scaled="0"/>
            </a:gradFill>
          </a:bgFillStyleLst>
        </a:fmtScheme>
      </a:themeElements>
      <a:objectDefaults/>
      <a:extraClrSchemeLst/>
      <a:extLst>
        <a:ext uri="{05A4C25C-085E-4340-85A3-A5531E510DB2}">
          <thm15:themeFamily xmlns:thm15="http://schemas.microsoft.com/office/thememl/2012/main" name="Office Theme" id="{62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F}" vid="{4A3C46E8-61CC-4603-A589-7422A47A8E4A}"/>
        </a:ext>
      </a:extLst>
    </a:theme>`,"xl/worksheets/_rels/sheet1.xml.rels":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
      <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing" Target="../drawings/{children}"/>
    </Relationships>`,"xl/worksheets/sheet1.xml":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"
      xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac xr xr2 xr3"
      xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"
      xmlns:xr="http://schemas.microsoft.com/office/spreadsheetml/2014/revision"
      xmlns:xr2="http://schemas.microsoft.com/office/spreadsheetml/2015/revision2"
      xmlns:xr3="http://schemas.microsoft.com/office/spreadsheetml/2016/revision3" xr:uid="{9B2CBB7B-9BFB-4EF9-A18C-0B0DED5460D3}">
      {larger}
      <dimension ref="A1:D5"/>
      <sheetViews>
        {large}
      </sheetViews>
      <sheetFormatPr defaultRowHeight="13.9" x14ac:dyDescent="0.4"/>
      {size}
      {children}
      <phoneticPr fontId="0" type="noConversion"/>
      <pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/>
    </worksheet>`,"xl/sharedStrings.xml":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="4" uniqueCount="3">
      <si>
        <t>large text</t>
      </si>
      <si>
        <t>1a</t>
      </si>
    </sst>`,"xl/styles.xml":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac x16r2 xr"
      xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"
      xmlns:x16r2="http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"
      xmlns:xr="http://schemas.microsoft.com/office/spreadsheetml/2014/revision">
      {children}
      <cellStyleXfs count="1">
        <xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0">
          <alignment vertical="center"/>
        </xf>
      </cellStyleXfs>
      <cellStyles count="1">
        <cellStyle name="" xfId="0" builtinId="0"/>
      </cellStyles>
      <dxfs count="0"/>
      <tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleLight16"/>
      <extLst>
        <ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}"
          xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main">
          <x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/>
        </ext>
        <ext uri="{9260A510-F301-46a8-8635-F512D64BE5F5}"
          xmlns:x15="http://schemas.microsoft.com/office/spreadsheetml/2010/11/main">
          <x15:timelineStyles defaultTimelineStyle="TimeSlicerStyleLight1"/>
        </ext>
      </extLst>
    </styleSheet>`,"xl/workbook.xml":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"
      xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x15 xr xr6 xr10 xr2"
      xmlns:x15="http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"
      xmlns:xr="http://schemas.microsoft.com/office/spreadsheetml/2014/revision"
      xmlns:xr6="http://schemas.microsoft.com/office/spreadsheetml/2016/revision6"
      xmlns:xr10="http://schemas.microsoft.com/office/spreadsheetml/2016/revision10"
      xmlns:xr2="http://schemas.microsoft.com/office/spreadsheetml/2015/revision2">
      <fileVersion appName="xl" lastEdited="7" lowestEdited="7" rupBuild="27328"/>
      <workbookPr defaultThemeVersion="166925"/>
      <mc:AlternateContent xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006">
        <mc:Choice Requires="x15">
          <x15ac:absPath url="C:UsersstevexuDesktop"
            xmlns:x15ac="http://schemas.microsoft.com/office/spreadsheetml/2010/11/ac"/>
        </mc:Choice>
      </mc:AlternateContent>
      <xr:revisionPtr revIDLastSave="0" documentId="13_ncr:1_{39800FFC-1B5B-45A9-B956-6FB55C475C9F}" xr6:coauthVersionLast="47" xr6:coauthVersionMax="47" xr10:uidLastSave="{00000000-0000-0000-0000-000000000000}"/>
      <bookViews>
      <workbookView xWindow="-98" yWindow="-98" windowWidth="19396" windowHeight="11475" {size} xr2:uid="{11AE31A3-10C3-4738-A21D-56F9E9832A43}"/>
      </bookViews>
      <sheets>
        {children}
      </sheets>
      {large}
      <calcPr calcId="191029"/>
      <extLst>
        <ext uri="{140A7094-0E35-4892-8432-C4D2E57EDEB5}"
          xmlns:x15="http://schemas.microsoft.com/office/spreadsheetml/2010/11/main">
          <x15:workbookPr chartTrackingRefBase="1"/>
        </ext>
      </extLst>
    </workbook>`,"[Content_Types].xml":`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
      <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>
      <Default Extension="xml" ContentType="application/xml"/>
      {children}
      <Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>
      <Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/>
      <Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/>
      <Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/>
      <Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/>
      <Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/>
    </Types>`},Gh="xl",T9="xl/styles.xml",R9="xl/workbook.xml",M9="xl/_rels/workbook.xml.rels",N9="xl/theme/theme1.xml",A9="xl/sharedStrings.xml",ks="#text",PS="xl/drawings/",$S="../drawings/",EI=8;function D9(t){const e=parseFloat(t);return isNaN(e)?0:Math.floor(e*EI)}function O9(t){return Math.floor(t/EI)}const kI=["bar","line","pie"];function $t(t,e,n){const r=Tn(t,e,n);return Array.isArray(r)?r:[r]}function qm(t){let e={};if(t.nodeType===Node.ELEMENT_NODE){if(t.attributes.length>0)for(const n of t.attributes)e[n.nodeName]=n.nodeValue}else t.nodeType===Node.TEXT_NODE&&(e=t.nodeValue);if(t.childNodes.length>0)for(const n of t.childNodes){const r=n.nodeName;typeof n.nodeValue=="string"&&!n.nodeValue.trim()||(typeof e[r]>"u"?e[r]=qm(n):(typeof e[r].push>"u"&&(e[r]=[e[r]]),e[r].push(qm(n))))}return e}function L9(t){const n=new DOMParser().parseFromString(t,"text/xml");return qm(n)}function Xh(t){if(!t)return"";const e="#";return t.length===6?e+t:t.length===8&&t.startsWith("FF")?e+t.slice(2):""}function gl(t,e){var n,r,s,i;if(!e)return"";if(e.theme){const o=["a:lt1","a:dk1","a:lt2","a:dk2","a:accent1","a:accent2","a:accent3","a:accent4","a:accent5","a:accent6"],a=parseInt(e.theme,10);if(a>=0&&a<=1)return Xh((r=(n=t[o[a]])==null?void 0:n["a:sysClr"])==null?void 0:r.lastClr);if(a>1&&a<o.length)return Xh((i=(s=t[o[a]])==null?void 0:s["a:srgbClr"])==null?void 0:i.val)}return Xh(e.rgb)}function _u(t,e){if(!t.style)return;const n=t.style;if(typeof Tc[n]!="number")return;const r=gl(e,t.color);return{type:n,color:r}}function F9(t,e,n){var l,c,d;const r={},s=$t(t,"styleSheet.cellXfs.xf",[]),i=$t(t,"styleSheet.cellStyles.xf",[]),o=s.length>0?s:i;if(!e||o.length===0||!o[e])return r;const a=o[e];if(a.applyAlignment&&a.alignment){if(a.alignment.horizontal){const u={left:wt.LEFT,center:wt.CENTER,right:wt.RIGHT};r.horizontalAlign=u[a.alignment.horizontal]}if(a.alignment.vertical){const u={top:Et.TOP,center:Et.MIDDLE,bottom:Et.BOTTOM};r.verticalAlign=u[a.alignment.vertical]}else r.verticalAlign=Et.BOTTOM;r.isWrapText=!!a.alignment.wrapText}if(a.applyFont&&a.fontId){const u=$t(t,"styleSheet.fonts.font",[]),f=parseInt(a.fontId,10);if(u[f]){const h=u[f],p=(l=h==null?void 0:h.sz)!=null&&l.val?parseInt((c=h==null?void 0:h.sz)==null?void 0:c.val,10):void 0;r.fontSize=p||void 0,r.isBold=!!(h!=null&&h.b),r.isItalic=!!(h!=null&&h.i),r.isStrike=!!(h!=null&&h.strike),r.underline=h.u?Ze.SINGLE:Ze.NONE,r.fontFamily=(d=h==null?void 0:h.name)==null?void 0:d.val;const m=gl(n,h.color);m&&(r.fontColor=m)}}if(a.applyNumberFormat&&a.numFmtId){const f=$t(t,"styleSheet.numFmts.numFmt",[]).find(h=>h.numFmtId===a.numFmtId);if(f)r.numberFormat=f.formatCode;else{const h=parseInt(a.numFmtId,10),p=$0.find(m=>m.id===h);p&&(r.numberFormat=p.formatCode)}}if(a.applyFill&&a.fillId){const u=$t(t,"styleSheet.fills.fill",[]),f=parseInt(a.fillId,10);if(u[f]){const h=u[f].gradientFill,p=u[f].patternFill;if(h&&h.stop[0]){const m=gl(n,h.stop[0].color);m&&(r.fillColor=m)}else if(p){const m=gl(n,p.fgColor);m&&(r.fillColor=m)}}}if(a.applyBorder&&a.borderId){const u=$t(t,"styleSheet.borders.border",[]),f=parseInt(a.borderId,10);if(u[f]){const h=u[f];r.borderLeft=_u(h.left,n),r.borderRight=_u(h.right,n),r.borderTop=_u(h.top,n),r.borderBottom=_u(h.bottom,n)}}return r}function P9(t,e){var m,_,g,y,w;const n=t[R9],r=$t(t[A9],"sst.si",[]),s=Tn(t[N9],"a:theme.a:themeElements.a:clrScheme",{}),i={workbook:{},mergeCells:{},customHeight:{},customWidth:{},definedNames:{},currentSheetId:"",drawings:{},rangeMap:{},worksheets:{},autoFilter:{},scroll:{}},o=$t(t[M9],"Relationships.Relationship",[]),a={},l={};let c=0;const d=$t(n,"workbook.sheets.sheet",[]);let u=0;for(const v of d){if(!v)continue;const x=((m=o.find(ae=>ae.Id===v["r:id"]))==null?void 0:m.Target)||"",C="worksheets/",E=x.slice(C.length),A=`${Gh}/${C}_rels/${E}.rels`;if(t[A]){const ae=$t(t[A],"Relationships.Relationship",[]);for(const ce of ae)l[v.sheetId]||(l[v.sheetId]=[]),l[v.sheetId].push(ce.Target),ce.Target.startsWith($S)&&c++}const V=`${Gh}/${x}`;a[v.sheetId]=V;const D=es(Tn(t[V],"worksheet.sheetViews.sheetView.selection.sqref","")),$=Tn(t[V],"worksheet.sheetViews.sheetView.tabSelected",""),j=gl(s,Tn(t[V],"worksheet.sheetPr.tabColor",{rgb:""}));$==="1"&&(i.currentSheetId=v.sheetId);const Z={sheetId:v.sheetId,name:v.name,isHide:v.state==="hidden",rowCount:200,colCount:200,sort:u++,tabColor:j===""?void 0:j};i.workbook[Z.sheetId]=Z,D&&(D.sheetId=Z.sheetId,i.rangeMap[v.sheetId]=D.toIRange())}const f=Object.values(i.workbook);f.sort((v,x)=>v.sort-x.sort),i.currentSheetId=i.currentSheetId||f[0].sheetId;const h=v=>{var C;return((C=Object.values(i.workbook).find(E=>E.name===v))==null?void 0:C.sheetId)||""};for(const v of f){const x=a[v.sheetId],C=$t(t[x],"worksheet.sheetData.row",[]),E=$t(t[x],"worksheet.mergeCells.mergeCell",[]);for(const j of E){const Z=es(j.ref,h);if(Z){Z.sheetId=v.sheetId;const ae=`${v.name}!${j.ref}`;i.mergeCells[ae]=Z.toIRange()}}const A=$t(t[x],"worksheet.cols.col",[]),V=Tn(t[x],"worksheet.sheetFormatPr",{defaultColWidth:"",defaultRowHeight:"",outlineLevelRow:""});if(A.length>0){for(const j of A)if(j&&j.customWidth&&j.width&&j.min&&j.max){const ae=V.defaultColWidth===j.width?jl:D9(j.width),ce=!!j.hidden;for(let J=parseInt(j.min,10)-1,K=parseInt(j.max,10);J<K;J++)i.customWidth[kr(v.sheetId,J)]={len:ae,isHide:ce}}}if(C.length===0)continue;let{colCount:D}=v,{rowCount:$}=v;for(const j of C){if(!j)continue;const Z=parseInt(j.r,10)-1;if($=Math.max($,Z+1),$>Ic)continue;if(j.customHeight&&j.ht){const ce=V.defaultRowHeight===j.ht;i.customHeight[kr(v.sheetId,Z)]={len:ce?zl:Math.floor(parseInt(j.ht,10)),isHide:!!j.hidden}}const ae=Array.isArray(j.c)?j.c:[j.c];for(const ce of ae){if(!ce)continue;const J=es(ce.r);if(!J||(D=Math.max(D,J.col+1),D>xc))continue;const K=((_=ce==null?void 0:ce.v)==null?void 0:_[ks])??"",F=parseInt(ce.s,10),ne={...F9(t[T9],F,s),value:K},oe=((g=ce==null?void 0:ce.f)==null?void 0:g[ks])||"";if(oe&&(oe.startsWith(la)?ne.formula=oe:ne.formula=la+oe),ce.t==="s"){const Te=parseInt(K,10);if(!isNaN(Te)){const yt=r[Te];ne.value=((y=yt==null?void 0:yt.t)==null?void 0:y[ks])??""}}ce.t==="b"&&(ne.value=K==="1"),i.worksheets[qn(v.sheetId,Z,J.col)]=ne,D=Math.max(D,J.col+1)}}v.rowCount=Math.max(v.rowCount,$),v.colCount=Math.max(v.colCount,D)}const p=$t(n,"workbook.definedNames.definedName",[]);for(const v of p){const x=es(v[ks],h);x&&(v!=null&&v.name)&&(i.definedNames[v.name.toLowerCase()]=x.toIRange())}for(let v=1;v<=c;v++){const x=`drawing${v}.xml`,C=`${PS}${x}`,E=`${PS}_rels/${x}.rels`;if(!t[C]||!t[E])break;const A=$t(t[E],"Relationships.Relationship",[]);let V="";for(const[$,j]of Object.entries(l))if(j.some(Z=>Z===$S+x)){V=$;break}const D=$t(t[C],"xdr:wsDr.xdr:twoCellAnchor",[]);for(const $ of D){const j=Tn($,"xdr:graphicFrame.a:graphic.a:graphicData.c:chart.r:id",""),Z=Tn($,"xdr:pic.xdr:blipFill.a:blip.r:embed",""),ae=!!Z,ce=ae?Z:j,J=((w=A.find(Te=>Te.Id===ce))==null?void 0:w.Target)||"";if(!J)continue;const K=Gh+J.slice(2),F=$["xdr:from"]["xdr:col"][ks],q=$["xdr:from"]["xdr:row"][ks];if(!F||!q)continue;const ne=String(v),oe={title:"",type:ae?"floating-picture":"chart",uuid:ne,width:300,height:300,originHeight:300,originWidth:300,fromCol:parseInt(q,10),fromRow:parseInt(F,10),sheetId:V,marginX:0,marginY:0};if(ae){if(!t[K])continue;const Te=Tn($,"xdr:pic.xdr:nvPicPr.xdr:cNvPr.name",""),yt=Tn($,"xdr:pic.xdr:nvPicPr.xdr:cNvPr.title","");oe.title=yt||Te,oe.imageAngle=0,oe.imageSrc=t[K]||"";const $e=e[K];$e&&$e.width>0&&$e.height>0&&(oe.width=$e.width,oe.height=$e.height,oe.originWidth=$e.width,oe.originHeight=$e.height)}else{oe.title=Tn(t[K],"c:chartSpace.c:chart.c:title.c:tx.c:rich.a:p.0.a:r.a:t."+ks,"");let Te=[];for(const Ot of kI){const Je=Tn(t[K],`c:chartSpace.c:chart.c:plotArea.c:${Ot}Chart`,"");if(Je){oe.chartType=Ot,Te=$t(Je,"c:ser",[]).map(I=>Tn(I,`c:val.c:numRef.c:f.${ks}`,"")).filter(I=>I);break}}if(Te.length===0)continue;const yt=Ot=>{const Je=Object.values(i.workbook).find(mn=>mn.name===Ot);return(Je==null?void 0:Je.sheetId)||""};let $e;for(const Ot of Te){const Je=es(Ot,yt);Je&&($e?$e=N0($e,Je):$e=Je)}if(!$e)continue;$e.sheetId=$e.sheetId||V,oe.chartRange=$e.toIRange()}i.drawings[ne]=oe}}return i}async function $9(t){const n=await(await i1(()=>import("./jszip.min-D37_r1vr.js").then(a=>a.j),[])).default.loadAsync(t),{files:r}=n,s={},i={};for(const a of Object.keys(r))if(!r[a].dir)if(a.includes(".xml")){const l=await r[a].async("string");l&&(s[a]=L9(l))}else{let l="";for(const[d,u]of Object.entries(Uk))if(u.some(f=>a.endsWith(f))){l=d;break}if(!l)continue;const c=await r[a].async("base64");c&&(s[a]=`data:${l};base64,${c}`,i[a]=await P0(s[a]))}return P9(s,i)}const Cu="/";function Zd(t){return`FF${Mm(t).slice(1,-2)}`}function Eu(t,e="left"){if(!t)return`<${e}/>`;const n=t.color||it("black");let r="";return n===it("black")?r='auto="1"':r=`rgb="${Zd(n)}"`,`<${e} style="${t.type}">
  <color ${r}/>
</${e}>`}function U9(t,e){if(!e||dl(e))return;const n=[],r={fontId:"0",fillId:"0",numFmtId:"0",applyAlignment:"",applyFill:"",applyFont:"",applyNumberFormat:"",applyBorder:"",borderId:"0"};e.fillColor&&(r.fillId=String(t.fills.length),n.push('applyFill="1"'),t.fills.push(`<fill>
    <patternFill patternType="solid">
      <fgColor rgb="${Zd(e.fillColor)}"/>
      <bgColor indexed="64"/>
    </patternFill>
  </fill>`));const s=[];if((e.underline===Ze.SINGLE||e.underline===Ze.DOUBLE)&&s.push("<u/>"),e.isBold&&s.push("<b/>"),e.isItalic&&s.push("<i/>"),e.isStrike&&s.push("<strike/>"),typeof e.fontSize<"u"&&s.push(`<sz val="${e.fontSize}"/>`),e.fontColor&&s.push(`<color rgb="${Zd(e.fontColor)}"/>`),e.fontFamily&&s.push(`<name val="${e.fontFamily}"/>`),s.length>0&&(r.fontId=String(t.fonts.length),n.push('applyFont="1"'),t.fonts.push(`<font>
${s.join(`
`)}
<charset val="0"/>
<scheme val="minor"/>
</font>`)),e.numberFormat){const l=$0.find(c=>c.formatCode===e.numberFormat);l&&(n.push('applyNumberFormat="1"'),r.numFmtId=String(l.id))}let i='<alignment vertical="center"/>';const o=[];if(n.push('applyAlignment="1"'),e.isWrapText&&o.push('wrapText="1"'),e.horizontalAlign!==void 0){const l={[wt.LEFT]:"left",[wt.CENTER]:"center",[wt.RIGHT]:"right"};o.push(`horizontal="${l[e.horizontalAlign]}"`)}if(e.verticalAlign!==void 0){const l={[Et.TOP]:"top",[Et.MIDDLE]:"center",[Et.BOTTOM]:"bottom"};e.verticalAlign!==Et.BOTTOM&&o.push(`vertical="${l[e.verticalAlign]}"`)}o.length>0&&(i=`<alignment ${o.join(" ")}/>`),(e.borderBottom||e.borderLeft||e.borderTop||e.borderRight)&&(r.borderId=String(t.borders.length),n.push('applyBorder="1"'),t.borders.push(`<border>
    ${Eu(e.borderLeft,"left")}
    ${Eu(e.borderRight,"right")}
    ${Eu(e.borderTop,"top")}
    ${Eu(e.borderBottom,"bottom")}
    <diagonal/>
  </border>`));const a=`<xf numFmtId="${r.numFmtId}" fontId="${r.fontId}" fillId="${r.fillId}" borderId="${r.borderId}" xfId="0" ${n.join(" ")}>
${i}
</xf>`;t.cellXfs.push(a)}function Vn(t,e={}){return t.replace(/{([a-z]+)}/gi,function(r,s){if(s in e)return e[s];throw new Error(`compileTemplate not found key: "${s}"`)})}function B9(t){return t.includes(" ")?`'${t}'`:t}function H9(){const t=new Date,e=t.getFullYear(),n=("0"+(t.getMonth()+1)).slice(-2),r=("0"+t.getDate()).slice(-2),s=("0"+t.getHours()).slice(-2),i=("0"+t.getMinutes()).slice(-2),o=("0"+t.getSeconds()).slice(-2);return`${e}-${n}-${r}T${s}:${i}:${o}Z`}function z9(t,e){const n=[];for(const[r,s]of Object.entries(t)){const{sheetId:i,rowOrCol:o}=Vl(r);if(e!==i||!s)continue;const a=o+1,l=O9(s.len);n.push(`<col min="${a}" max="${a}" width="${l}" customWidth="1" ${s.isHide?'hidden="1"':""}/>`)}return n.length===0?"":`<cols>${n.join("")}</cols>`}function j9(t){const e=[],n=Object.entries(t);n.sort((r,s)=>r[0]>s[0]?-1:1);for(const[r,s]of n)s.length>0&&e.push(`<${r} count="${s.length}">
${s.join(`
`)}
</${r}>`);return e.join(`
`)}function W9(t,e){const{col:n,row:r,sheetId:s,value:i,formula:o,...a}=t,l=Zn({col:n,row:r,rowCount:1,colCount:1,sheetId:""}),c=o?`<f>${o.slice(1)}</f>`:"";let d=`<v>${oi(i,t==null?void 0:t.numberFormat)}</v>`,u="";return dl(a)||(u=`s="${e.cellXfs.length}"`,U9(e,a)),typeof t.value=="boolean"&&(d=`<v>${Number(t.value)}</v>`,u+=' t="b"'),`<c r="${l}" ${u}>${c}${d}</c>`}function V9(t){const e=t.toJSON(),n=Object.values(e.workbook);n.sort((u,f)=>u.sort-f.sort);const r=[],s={};for(let u=0;u<n.length;u++){const f=n[u],h=u+1;s[f.sheetId]={rid:`rId${h}`,target:`sheet${h}.xml`,name:f.name},r.push(`<Override PartName="/xl/worksheets/sheet${h}.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>`)}const i=u=>{var p;const f=u||e.currentSheetId,h=((p=n.find(m=>m.sheetId===f))==null?void 0:p.name)||"";return B9(h)},o=[];for(const[u,f]of Object.entries(e.definedNames)){const h=Zn(f,"absolute",i);o.push(`<definedName name="${u}">${h}</definedName>`)}const a=n.findIndex(u=>u.sheetId===e.currentSheetId),l={};if(l["_rels/.rels"]=qt["_rels/.rels"],l["docProps/app.xml"]=Vn(qt["docProps/app.xml"],{children:n.map(u=>`<vt:lpstr>${u.name}</vt:lpstr>`).join(""),size:String(n.length)}),l["docProps/core.xml"]=Vn(qt["docProps/core.xml"],{children:H9()}),l["xl/_rels/workbook.xml.rels"]=Vn(qt["xl/_rels/workbook.xml.rels"],{children:n.map(u=>{const f=s[u.sheetId];return`<Relationship Id="${f.rid}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/${f.target}"/>`}).join(""),size:`<Relationship Id="rId${String(n.length+1)}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/>
      <Relationship Id="rId${String(n.length+2)}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>
      <Relationship Id="rId${String(n.length+3)}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/>`}),Object.keys(e.drawings).length>0){const u=Object.values(e.drawings);let f=1;for(const h of n){const p=u.filter(C=>C.sheetId===h.sheetId);if(p.length===0)continue;const m=s[h.sheetId],_=`drawing${f}.xml`;l[`xl/worksheets/_rels/${m.target}.rels`]=Vn(qt["xl/worksheets/_rels/sheet1.xml.rels"],{children:_});let g=1,y=1,w=1;const v=[],x=[];for(const C of p){let E=C.fromCol,A=C.fromRow;for(let D=0;D<C.width;D++)D+=t.getColWidth(E++);for(let D=0;D<C.height;D++)D+=t.getRowHeight(A++);const V=`<xdr:from>
        <xdr:col>${C.fromCol}</xdr:col>
        <xdr:colOff>304800</xdr:colOff>
        <xdr:row>${C.fromRow}</xdr:row>
        <xdr:rowOff>165100</xdr:rowOff>
      </xdr:from>
      <xdr:to>
        <xdr:col>${E}</xdr:col>
        <xdr:colOff>457200</xdr:colOff>
        <xdr:row>${A}</xdr:row>
        <xdr:rowOff>63500</xdr:rowOff>
      </xdr:to>`;if(C.type==="chart"){v.push(`<Relationship Id="rId${g}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart" Target="../charts/chart${y}.xml"/>`),l[`xl/charts/_rels/chart${y}.xml.rels`]=Vn(qt["xl/charts/_rels/chart1.xml.rels"],{children:String(y)}),l[`xl/charts/colors${y}.xml`]=qt["xl/charts/colors1.xml"],l[`xl/charts/style${y}.xml`]=qt["xl/charts/style1.xml"],r.push(`<Override PartName="/xl/charts/chart${y}.xml" ContentType="application/vnd.openxmlformats-officedocument.drawingml.chart+xml"/>`),r.push(`<Override PartName="/xl/charts/colors${y}.xml" ContentType="application/vnd.ms-office.chartcolorstyle+xml"/>`),r.push(`<Override PartName="/xl/charts/style${y}.xml" ContentType="application/vnd.ms-office.chartstyle+xml"/>`);const D=[],$=C.chartRange;for(let j=0;j<$.colCount;j++){const Z=Zn({row:$.row,col:$.col+j,rowCount:1,colCount:1,sheetId:""},"absolute"),ae=Zn({row:$.row+$.rowCount-1,col:$.col+j,rowCount:1,colCount:1,sheetId:""},"absolute");D.push(` <c:ser>
            <c:idx val="${y}"/>
            <c:order val="${y}"/>
            <c:spPr>
              <a:solidFill>
                <a:schemeClr val="accent${y}"/>
              </a:solidFill>
              <a:ln>
                <a:noFill/>
              </a:ln>
              <a:effectLst/>
            </c:spPr>
            <c:invertIfNegative val="0"/>
            <c:dLbls>
              <c:delete val="1"/>
            </c:dLbls>
            <c:val>
              <c:numRef>
                <c:f>${i($.sheetId)}!${Z}:${ae}</c:f>
                <c:numCache>
                  <c:formatCode>General</c:formatCode>
                  <c:ptCount val="${$.rowCount}"/>
                </c:numCache>
              </c:numRef>
            </c:val>
          </c:ser>`)}l[`xl/charts/chart${y}.xml`]=Vn(qt["xl/charts/chart1.xml"],{size:C.title,children:D.join(`
`),large:kI.some(j=>j===C.chartType)?C.chartType:"bar"}),x.push(`<xdr:twoCellAnchor>
          ${V}
          <xdr:graphicFrame>
            <xdr:nvGraphicFramePr>
              <xdr:cNvPr id="${C.uuid}" name="Chart ${g}"/>
              <xdr:cNvGraphicFramePr/>
            </xdr:nvGraphicFramePr>
            <xdr:xfrm>
              <a:off x="8256270" y="1445260"/>
              <a:ext cx="4541520" cy="2885440"/>
            </xdr:xfrm>
            <a:graphic>
              <a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/chart">
                <c:chart xmlns:c="http://schemas.openxmlformats.org/drawingml/2006/chart"
                  xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" r:id="rId${g}"/>
              </a:graphicData>
            </a:graphic>
          </xdr:graphicFrame>
          <xdr:clientData/>
        </xdr:twoCellAnchor>`)}else if(C.type==="floating-picture"){const D=Bk(C.imageSrc);r.unshift(`<Default Extension="${D.ext.slice(1)}" ContentType="${D.type}"/>`);const $=`image${w}${D.ext}`;v.push(`<Relationship Id="rId${g}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="../media/${$}"/>`),l[`xl/media/${$}`]=D.base64,x.push(`<xdr:twoCellAnchor editAs="oneCell">
          ${V}
          <xdr:pic>
            <xdr:nvPicPr>
              <xdr:cNvPr id="${C.uuid}" name="Picture ${g}" descr="face"/>
              <xdr:cNvPicPr>
                <a:picLocks noChangeAspect="1"/>
              </xdr:cNvPicPr>
            </xdr:nvPicPr>
            <xdr:blipFill>
              <a:blip r:embed="rId${g}"/>
              <a:stretch>
                <a:fillRect/>
              </a:stretch>
            </xdr:blipFill>
            <xdr:spPr>
              <a:xfrm>
                <a:off x="744220" y="4693920"/>
                <a:ext cx="4770120" cy="5057140"/>
              </a:xfrm>
              <a:prstGeom prst="rect">
                <a:avLst/>
              </a:prstGeom>
            </xdr:spPr>
          </xdr:pic>
          <xdr:clientData/>
        </xdr:twoCellAnchor>`)}g++,w++,y++}l[`xl/drawings/${_}`]=Vn(qt["xl/drawings/drawing1.xml"],{children:x.join(`
`)}),r.push(`<Override PartName="/xl/drawings/${_}" ContentType="application/vnd.openxmlformats-officedocument.drawing+xml"/>`),l[`xl/drawings/_rels/${_}.rels`]=Vn(qt["xl/drawings/_rels/drawing1.xml.rels"],{children:v.join(`
`)}),f++}}l["xl/theme/theme1.xml"]=qt["xl/theme/theme1.xml"],l["xl/workbook.xml"]=Vn(qt["xl/workbook.xml"],{size:a>=0?` activeTab="${a}" `:"",large:o.length>0?`<definedNames>
${o.join(`
`)}
</definedNames>`:"",children:n.map(u=>{const f=s[u.sheetId];return`<sheet name="${u.name}" sheetId="${u.sheetId}" r:id="${f.rid}"/>`}).join(`
`)}),l["[Content_Types].xml"]=Vn(qt["[Content_Types].xml"],{children:r.join(`
`)});const c={numFmts:[],fonts:[`<font>
    <sz val="11"/>
    <color theme="1"/>
    <name val="Calibri"/>
    <charset val="134"/>
    <scheme val="minor"/>
  </font>`],fills:[`<fill>
    <patternFill patternType="none"/>
  </fill>`],cellXfs:[`<xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0">
    <alignment vertical="center"/>
  </xf>`],borders:[`<border>
      <left/>
      <right/>
      <top/>
      <bottom/>
      <diagonal/>
    </border>`]},d=[];for(const[u,f]of Object.entries(e.worksheets)){const h=fl(u);h&&d.push({...f,...h})}for(const u of n){const f=Object.values(e.mergeCells).filter(w=>w.sheetId===u.sheetId).map(w=>`<mergeCell ref="${Zn({...w,sheetId:""})}"/>`),h=s[u.sheetId],p=e.rangeMap[u.sheetId]||{row:0,col:0,rowCount:1,colCount:1,sheetId:""};p.sheetId="";const m={children:"<sheetData/>",size:z9(e.customWidth,u.sheetId),large:`<sheetView ${u.sheetId===e.currentSheetId?'tabSelected="1"':""} workbookViewId="0">
    <selection activeCell="${Zn({...p,rowCount:1,colCount:1})}" sqref="${Zn(p)}"/>
  </sheetView>`},_=new Map,g=[];for(const w of d)if(w.sheetId===u.sheetId){const v=_.get(w.row)||[];v.push(w),_.set(w.row,v)}const y=Array.from(_.keys());y.sort();for(const w of y){const v=e.customHeight[kr(u.sheetId,w)];let x="";v&&(x=`ht="${v.len}" customHeight="1" ${v.isHide?'hidden="1"':""}`);const C=_.get(w).map(E=>W9(E,c));g.push(`<row r="${w+1}" ${x} x14ac:dyDescent="0.4">
${C.join(`
`)}
</row>`)}g.length>0&&(m.children=`<sheetData>
${g.join(`
`)}
</sheetData>`),f.length>0&&(m.children+=`<mergeCells count="${f.length}">
${f.join(`
`)}
</mergeCells>`),u.tabColor?m.larger=`<sheetPr>
      <tabColor rgb="${Zd(u.tabColor)}"/>
    </sheetPr>`:m.larger="<sheetPr/>",l[`xl/worksheets/${h.target}`]=Vn(qt["xl/worksheets/sheet1.xml"],m)}return l["xl/styles.xml"]=Vn(qt["xl/styles.xml"],{children:j9(c)}),l}async function G9(t,e){const n=V9(e),r=(await i1(async()=>{const{default:l}=await import("./jszip.min-D37_r1vr.js").then(c=>c.j);return{default:l}},[])).default,s=new r,i=new Map,o=l=>{if(l.length!==0)for(let c=0;c<l.length;c++)if(c===0)i.has(l[c])||i.set(l[c],s.folder(l[c]));else{const d=l.slice(0,c).join(Cu),u=l.slice(0,c+1).join(Cu);i.has(u)||i.set(u,i.get(d).folder(l[c]))}};for(const[l,c]of Object.entries(n)){const d=l.split(Cu).map(h=>h.trim()).filter(h=>h),u=d.pop();o(d);let f=s;if(d.length>0&&(f=i.get(d.join(Cu))),l.startsWith("xl/media"))f.file(u,c,{base64:!0});else{const h=c.trim().split("/n").map(p=>p.trim()).filter(p=>p).join("");f.file(u,h)}}const a=await s.generateAsync({type:"blob"});Yl(a,t)}const Ku=wk,xI=kc;function X9(t){const e='"',n='"',r=new RegExp(n,"g"),s=new RegExp(e,"g");let i="";for(let o=0;o<t.length;o++){let a=t[o];if(a==="")i+=a;else if(a){const l=Ku.length&&a.indexOf(Ku)>=0,c=a.indexOf(e)>=0,d=a.indexOf(xI)>=0,u=c||l||d;u&&(a=a.replace(r,n+n)),c&&(a=a.replace(s,n+e)),u&&(a=e+a+e),i+=a}o!==t.length-1&&(i+=Ku)}return i}function Y9(t){const e=t.getCurrentSheetId(),n=[],r=t.getSheetInfo(e);if(!r)return"";for(let i=0;i<r.rowCount;i++){const o=[];for(let a=0;a<r.colCount;a++){const l=t.getCell({row:i,col:a,colCount:1,rowCount:1,sheetId:e});o.push(oi(l==null?void 0:l.value,l==null?void 0:l.numberFormat))}n.push(X9(o))}const s=Array.from({length:r.colCount}).fill("").join(Ku);for(;n.length>0&&n[n.length-1]===s;)n.pop();return n.join(xI)}async function q9(t,e){const n=await F0(t,!1),r=Ik(n,wk),s=[],i=e.getCurrentSheetId();let o=0;for(const a of r){let l=0;for(const c of a)s.push({row:o,col:l,value:c,sheetId:i}),l++;o++}e.transaction(()=>{e.deleteAll(),e.setWorksheet(s)})}const K9="_i18n_1vi6o_21",J9="_fps_1vi6o_22",Q9="_theme_1vi6o_16",$i={"menubar-container":"_menubar-container_1vi6o_1","menubar-menu":"_menubar-menu_1vi6o_10","theme-button":"_theme-button_1vi6o_16",i18n:K9,fps:J9,theme:Q9};function Km(t){const e=Object.keys(t);for(const n of e){const r=`--${n}`,s=String(t[n]||"");document.documentElement.style.setProperty(r,s)}}function Z9(t){Km(t==="dark"?Dk:A0)}const II=T.memo(()=>{const[t,e]=T.useState("light");T.useEffect(()=>{Km(da)},[]),T.useEffect(()=>{e(D0()),typeof window.matchMedia=="function"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",r=>{e(r.matches?"dark":"light")})},[]),T.useEffect(()=>{f8(t),Z9(t),Lf.emit("modelChange",{changeSet:new Set(["cellStyle"])})},[t]);const n=T.useCallback(()=>{e(r=>r==="dark"?"light":"dark")},[]);return S.jsx("div",{"data-testid":"menubar-theme",className:$i.theme,children:S.jsx(ee,{onClick:n,className:$i["theme-button"],testId:"menubar-theme-toggle",children:S.jsx(Mt,{name:t==="dark"?"sun":"moon"})})})});II.displayName="Theme";const e$=Nm.map(t=>({value:t,label:t,disabled:!1})),t$=zk(),bI=T.memo(()=>{const t=T.useCallback(e=>{xL(String(e)),window.location.reload()},[]);return S.jsx("div",{className:$i.i18n,"data-testid":"menubar-i18n",children:S.jsx(Fi,{data:e$,defaultValue:t$,onChange:t,testId:"menubar-i18n-select"})})});bI.displayName="I18N";const TI=T.memo(()=>{const t=g5();return S.jsxs("div",{"data-testid":"menubar-fps",className:$i.fps,children:[S.jsx("span",{children:"FPS:"}),S.jsx("span",{"data-testid":"menubar-fps-num",children:t})]})});TI.displayName="FPS";const RI=T.memo(({controller:t})=>{const e=T.useCallback(()=>{G9(`excel_${Date.now()}.xlsx`,t)},[]),n=T.useCallback(()=>{const o=Y9(t),a=new Blob([o],{type:"text/csv;charset=utf-8;"});Yl(a,`excel_${Date.now()}.csv`)},[]),r=T.useCallback(async o=>{var c;const a=(c=o.target.files)==null?void 0:c[0];if(!a)return;const l=await $9(a);await t.fromJSON(l),o.target.value="",o.target.blur()},[]),s=T.useCallback(async o=>{var l;const a=(l=o.target.files)==null?void 0:l[0];a&&(await q9(a,t),o.target.value="",o.target.blur())},[]),i=T.useCallback(()=>{const o=new Blob([JSON.stringify(t.toJSON())],{type:"application/json"});Yl(o,`excel_${Date.now()}.json`)},[]);return S.jsxs("div",{className:$i["menubar-container"],"data-testid":"menubar",children:[S.jsxs("div",{className:$i["menubar-menu"],children:[S.jsxs(z0,{label:P("file"),className:$i.menu,testId:"menubar-excel",children:[S.jsxs(sn,{testId:"menubar-import-xlsx",children:[S.jsx("input",{type:"file",hidden:!0,onChange:r,accept:".xlsx",id:"import_xlsx","data-testid":"menubar-import-xlsx-input"}),S.jsx("label",{htmlFor:"import_xlsx",children:P("import-xlsx")})]}),S.jsxs(sn,{testId:"menubar-import-csv",children:[S.jsx("input",{type:"file",hidden:!0,onChange:s,accept:".csv",id:"import_csv","data-testid":"menubar-import-csv-input"}),S.jsx("label",{htmlFor:"import_csv",children:P("import-csv")})]}),S.jsx(sn,{onClick:e,testId:"menubar-export-xlsx",children:P("export-xlsx")}),S.jsx(sn,{testId:"menubar-export-csv",onClick:n,children:P("export-csv")}),S.jsx(sn,{testId:"menubar-export-json",onClick:i,children:P("export-json")})]}),!$O()&&S.jsx(ee,{style:{marginLeft:10},onClick:()=>{location.href=`${location.origin}${location.pathname.replace("/app","")}#${kk()}`},children:"Collaboration"})]}),S.jsx(bI,{}),S.jsx(II,{}),S.jsx(TI,{})]})});RI.displayName="MenuBarContainer";const MI=T.memo(({controller:t})=>S.jsxs("div",{className:yO["app-container"],"data-testid":"app-container",children:[S.jsx(RI,{controller:t}),S.jsx(gx,{controller:t}),S.jsx(dx,{controller:t}),S.jsx(vI,{controller:t}),S.jsx(CI,{controller:t})]}));MI.displayName="App";function Ie(){return function(t,e,n){const r=n.value;return n.value=function(...s){return this.hooks.doc.transact(()=>r.apply(this,s),_r.MODEL)},n}}var n$=Object.defineProperty,r$=Object.getOwnPropertyDescriptor,be=(t,e,n,r)=>{for(var s=r$(e,n),i=t.length-1,o;i>=0;i--)(o=t[i])&&(s=o(e,n,s)||s);return s&&n$(e,n,s),s};const s$={top:0,left:0,scrollLeft:0,scrollTop:0};class ke{constructor(e,n){H(this,"scrollValue",{});H(this,"model");H(this,"changeSet",new Set);H(this,"floatElementUuid","");H(this,"copyRange");H(this,"isCut",!1);H(this,"hooks");H(this,"transaction",(e,n)=>this.model.transaction(e,n));H(this,"getCell",e=>this.model.getCell(e));this.model=e,this.hooks=n}clearHistory(){this.model.clearHistory()}getHooks(){return this.hooks}validateDefinedName(e){return this.model.validateDefinedName(e)}validateDrawing(e){return this.model.validateDrawing(e)}validateRange(e){return this.model.validateRange(e)}getCurrentSheetId(){return this.model.getCurrentSheetId()}getSheetList(){return this.model.getSheetList()}getSheetInfo(e){return this.model.getSheetInfo(e)}emitChange(){this.model.emitChange(this.changeSet),this.changeSet=new Set}getActiveRange(e){return this.model.getActiveRange(e)}setNextActiveCell(e){const{range:n,isMerged:r}=this.getActiveRange();let s=n.col,i=n.row;const o=this.getSheetInfo(n.sheetId),a={...n,rowCount:1,colCount:1};if(e==="left"){for(s--;s>0&&this.getColWidth(s)<=0;)s--;a.col=s}if(e==="right"){for(r?s=n.col+n.colCount:s++;s<o.colCount&&this.getColWidth(s)<=0;)s++;a.col=s}if(e==="up"){for(i--;i>0&&this.getRowHeight(i)<=0;)i--;a.row=i}if(e==="down"){for(r?i=n.row+n.rowCount:i++;i<o.rowCount&&this.getRowHeight(i)<=0;)i++;a.row=i}this.setActiveRange(a)}setActiveRange(e){this.model.setActiveRange(e),this.changeSet.add("rangeMap"),this.emitChange()}setCurrentSheetId(e){this.model.setCurrentSheetId(e),this.changeSet.add("currentSheetId"),this.emitChange()}getWorksheet(e){return this.model.getWorksheet(e)}setWorksheet(e){this.model.setWorksheet(e),this.changeSet.add("worksheets"),this.changeSet.add("cellStyle"),this.changeSet.add("cellValue"),this.emitChange()}addSheet(){const e=this.model.addSheet();return this.changeSet.add("workbook"),this.emitChange(),e}deleteSheet(e){this.model.deleteSheet(e),this.changeSet.add("workbook"),this.emitChange()}updateSheetInfo(e,n){this.model.updateSheetInfo(e,n),this.changeSet.add("workbook"),this.emitChange()}hideSheet(e){this.model.hideSheet(e),this.changeSet.add("workbook"),this.emitChange()}unhideSheet(e){this.model.unhideSheet(e),this.changeSet.add("workbook"),this.emitChange()}renameSheet(e,n){this.model.renameSheet(e,n),this.changeSet.add("workbook"),this.emitChange()}fromJSON(e){this.model.fromJSON(e)}toJSON(){return this.model.toJSON()}setCell(e,n,r){this.model.setCell(e,n,r),this.changeSet.add("cellValue"),this.changeSet.add("cellStyle"),this.emitChange()}setCellValue(e,n){const r=this.getCell(n);if(s1(r==null?void 0:r.numberFormat)&&typeof e=="string"&&!isNaN(Date.parse(e))){const s=t9(new Date(e));this.model.setCellValue(s,n)}else this.model.setCellValue(e,n);this.changeSet.add("cellValue"),this.emitChange()}updateCellStyle(e,n){this.model.updateCellStyle(e,n),this.changeSet.add("cellStyle"),this.emitChange()}canRedo(){return this.model.canRedo()}canUndo(){return this.model.canUndo()}undo(){this.model.undo(),this.changeSet.add("undo"),this.emitChange()}redo(){this.model.redo(),this.changeSet.add("redo"),this.emitChange()}getCol(e,n){return this.model.getCol(e,n)}getColWidth(e,n){const r=this.model.getCol(e,n);return r.isHide?0:r.len}setColWidth(e,n,r){this.model.setColWidth(e,n,r),this.changeSet.add("customWidth"),this.emitChange()}getRow(e,n){return this.model.getRow(e,n)}getRowHeight(e,n){const r=this.model.getRow(e,n);return r.isHide?0:r.len}setRowHeight(e,n,r){this.model.setRowHeight(e,n,r),this.changeSet.add("customHeight"),this.emitChange()}getCellSize(e){return e.sheetId=e.sheetId||this.getCurrentSheetId(),this.getRangeSize(e)}getRangeSize(e){let{row:n,col:r,colCount:s,rowCount:i}=e,o=n,a=r,l=n+i,c=r+s;const d=e.sheetId||this.getCurrentSheetId(),u=this.getSheetInfo(d);if(!u)return{width:0,height:0};Ao(e)?(a=0,c=u.colCount,o=0,l=u.rowCount):Js(e)?(o=0,l=u.rowCount):Ks(e)&&(a=0,c=u.colCount);let f=0,h=0;for(;o<l;o++)h+=this.getRowHeight(o,d);for(;a<c;a++)f+=this.getColWidth(a,d);return{width:f,height:h}}computeCellPosition(e){const{row:n,col:r}=e,s=e.sheetId||this.model.getCurrentSheetId(),i=ar.get(),o=this.getScroll(s);let a=i.width,l=i.height,c=o.row,d=o.col;if(r>=o.col)for(;d<r;)a+=this.getColWidth(d,s),d++;else for(a=-i.width;d>r;)a-=this.getColWidth(d,s),d--;if(n>=o.row)for(;c<n;)l+=this.getRowHeight(c,s),c++;else for(l=-i.height;c>n;)l-=this.getRowHeight(c,s),c--;return{top:l,left:a}}addRow(e,n,r=!1){this.model.addRow(e,n,r),this.changeSet.add("customHeight"),this.emitChange()}addCol(e,n,r=!1){this.model.addCol(e,n,r),this.changeSet.add("customWidth"),this.emitChange()}deleteCol(e,n){this.model.deleteCol(e,n),this.changeSet.add("customWidth"),this.emitChange()}deleteRow(e,n){this.model.deleteRow(e,n),this.changeSet.add("customHeight"),this.emitChange()}hideCol(e,n){this.model.hideCol(e,n),this.changeSet.add("customWidth"),this.emitChange()}hideRow(e,n){this.model.hideRow(e,n),this.changeSet.add("customHeight"),this.emitChange()}unhideRow(e,n){this.model.unhideRow(e,n),this.changeSet.add("customHeight"),this.emitChange()}unhideCol(e,n){this.model.unhideCol(e,n),this.changeSet.add("customWidth"),this.emitChange()}getScroll(e){const n=e||this.model.getCurrentSheetId(),r=this.model.getScroll(n);return{...this.scrollValue[n]||{...s$},...r}}setScroll(e,n){const r=n||this.model.getCurrentSheetId();let{row:s,col:i,...o}=e;const a=this.getSheetInfo(r);a&&(s<0?s=0:s>=a.rowCount-1&&(s=a.rowCount-1),i<0?i=0:i>=a.colCount-1&&(i=a.colCount-1)),this.scrollValue[r]=o,s>9999?ar.set({width:Math.floor(_m*2),height:vm}):ar.set({width:_m,height:vm}),this.model.setScroll({row:s,col:i})&&this.changeSet.add("scroll"),this.emitChange()}getPasteRange(e){const n=e.length,r=this.getActiveRange().range,s=Math.max(...e.map(i=>i.length));return{...r,rowCount:n,colCount:s}}parseText(e){const n=Ik(e),r=this.getPasteRange(n);if(n.length>0)return this.model.setCell(n,[],r),r}parseHTML(e){const{textList:n,styleList:r,rowMap:s,colMap:i}=jO(e),o=this.getPasteRange(n);for(const[a,l]of s.entries())this.model.setRowHeight(a,l);for(const[a,l]of i.entries())this.model.setColWidth(a,l);if(n.length>0||r.length>0)return this.model.setCell(n,r,o),o}async getCopyData(e){const{range:n,isMerged:r}=this.getActiveRange(),{row:s,col:i,rowCount:o,colCount:a}=n,l=[],c=[];let d=1;const u=[],f=this.model.getCurrentSheetId(),h=new Set;for(let v=s,x=s+o;v<x;v++){const C=[],E=[],A=Uw(this.getRow(v).len,"");for(let V=i,D=i+a;V<D;V++){const $=this.model.getCell({row:v,col:V,rowCount:1,colCount:1,sheetId:f});if(!$)continue;const j=oi($.value,$==null?void 0:$.numberFormat);C.push(j);const Z=Uw(this.getCol(V).len,""),ae=`height=${A} width=${Z} style='height:${A}pt;width:${Z}pt;'`;if(h.add(`<col width=${Z} style='width:${Z}pt;'>`),$){let ce=BO($);j||(ce+="mso-pattern:black none;");const J=`xl${d++}`;u.push(`.${J}{${ce}}`),E.push(`<td ${ae} class="${J}"> ${j} </td>`)}else E.push(`<td ${ae}> ${j} </td>`);if(r)break}if(l.push(C),c.push(`<tr height=${A} style='height:${A}pt;'>${E.join(`
`)}</tr>`),r)break}const p={range:n,type:e,floatElementUuid:this.floatElementUuid},m=JSON.stringify(p),_=e8(u.join(`
`),`
      ${Array.from(h).join(`
`)}
      ${c.join(`
`)}`,t8(m)),g=`${l.map(v=>v.join("	")).join(`\r
`)}\r
`,y={[Ut]:g,[Bt]:_,[Kt]:p,[an]:null};let w="";if(this.floatElementUuid){const x=this.getDrawingList(this.getCurrentSheetId()).find(C=>C.uuid===this.floatElementUuid);if(x)if(x.type==="floating-picture"){const C=document.querySelector(`canvas[data-uuid="${x.uuid}"]`);C&&(C.toBlob(E=>{E&&(y[an]=E)}),w=C.toDataURL())}else w=x.imageSrc||"",y[an]=C8(w)}return[y,w]}pasteFloatElement(e,n){if(!e)return!1;if(n){const c=this.getActiveRange().range;return this.model.updateDrawing(e,{fromCol:c.col,fromRow:c.row,marginX:0,marginY:0}),this.floatElementUuid="",this.isCut=!1,this.emitChange(),!0}const s=this.getDrawingList(this.getCurrentSheetId()).find(c=>c.uuid===e);if(!s)return!1;const i=this.getCellSize({row:s.fromRow,col:s.fromCol,rowCount:1,colCount:1,sheetId:s.sheetId});let{marginX:o,marginY:a}=s;const l=14;return o+l<i.width?o+=l:o-l>=0&&(o-=l),a+l<i.width?a+=l:a-l>=0&&(a-=l),this.addDrawing({...s,uuid:ua(),marginX:o,marginY:a}),!0}async paste(e){if(this.floatElementUuid&&this.pasteFloatElement(this.floatElementUuid,this.isCut))return this.changeSet.add("drawings"),this.emitChange(),Promise.resolve();await this.basePaste(e),this.changeSet.add("cellValue"),this.changeSet.add("cellStyle"),this.emitChange()}async basePaste(e){var o,a,l,c,d,u,f,h,p;let n="",r="",s=null,i=null;if(e){n=((o=e.clipboardData)==null?void 0:o.getData(Bt))||"",r=((a=e.clipboardData)==null?void 0:a.getData(Ut))||"";const m=((l=e.clipboardData)==null?void 0:l.getData(Kt))||"";m&&(s=JSON.parse(m)),s&&s.type==="cut"&&((c=e.clipboardData)==null||c.setData(Bt,""),(d=e.clipboardData)==null||d.setData(Ut,""),(u=e.clipboardData)==null||u.setData(Kt,""),(f=e.clipboardData)==null||f.setData(an,"")),(h=e.clipboardData)!=null&&h.files&&(i=(p=e.clipboardData)==null?void 0:p.files)}else{const m=await this.hooks.paste();n=m[Bt],r=m[Ut],m[Kt]&&(s=m[Kt]),s&&s.type==="cut"&&this.hooks.copyOrCut({[Ut]:"",[Bt]:"",[Kt]:null,[an]:null},"copy")}if(i){const m=[];for(const _ of i){if(_.size<=0)continue;let g=_.name;const y=_.type.slice(6);g=g.slice(0,-(y.length+1));const w=await F0(_,!0);if(!w)continue;const v=await P0(w),x=this.getActiveRange().range;m.push({width:v.width,height:v.height,originHeight:v.height,originWidth:v.width,title:g,type:"floating-picture",uuid:ua(),imageSrc:w,sheetId:x.sheetId,fromRow:x.row,fromCol:x.col,marginX:0,marginY:0})}if(m.length>0){this.addDrawing(...m);return}}if(!(s&&s.floatElementUuid&&this.pasteFloatElement(s.floatElementUuid,s.type==="cut"))){if(s){const m=this.model.pasteRange(s.range,s.type==="cut");this.setActiveRange(m);return}if(n=n.trim(),r=r.trim(),n){const m=this.parseHTML(n);if(m){this.setActiveRange(m);return}}if(r){const m=this.parseText(r);if(m){this.setActiveRange(m);return}}if(this.copyRange){const m=this.model.pasteRange(this.copyRange,this.isCut);this.setActiveRange(m),this.isCut&&(this.copyRange=void 0,this.isCut=!1);return}}}copy(e){return this.copyRange=this.getActiveRange().range,this.isCut=!1,this.baseCopy("copy",e)}cut(e){return this.copyRange=this.getActiveRange().range,this.isCut=!0,this.baseCopy("cut",e)}async baseCopy(e,n){var i,o,a,l;const[r,s]=await this.getCopyData(e);n?((i=n.clipboardData)==null||i.setData(Bt,r[Bt]),(o=n.clipboardData)==null||o.setData(Ut,r[Ut]),(a=n.clipboardData)==null||a.setData(Kt,r[Kt]?JSON.stringify(r[Kt]):""),(l=n.clipboardData)==null||l.setData(an,s)):this.hooks.copyOrCut(r,e),this.changeSet.add("antLine"),this.emitChange()}getCopyRange(){return this.copyRange}setCopyRange(e){this.copyRange=e}deleteAll(e){this.model.deleteAll(e),this.changeSet.add("definedNames"),this.changeSet.add("cellValue"),this.changeSet.add("mergeCells"),this.changeSet.add("cellStyle"),this.changeSet.add("autoFilter"),this.changeSet.add("drawings"),this.emitChange()}getDefineName(e){return this.model.getDefineName(e)}getDefineNameList(){return this.model.getDefineNameList()}setDefineName(e,n){const r=this.model.setDefineName(e,n);return this.changeSet.add("definedNames"),this.emitChange(),r}checkDefineName(e){return this.model.checkDefineName(e)}getDrawingList(e){return this.model.getDrawingList(e)}addDrawing(...e){this.model.addDrawing(...e),this.changeSet.add("drawings"),this.emitChange()}updateDrawing(e,n){this.model.updateDrawing(e,n),this.changeSet.add("drawings"),this.emitChange()}deleteDrawing(e){this.model.deleteDrawing(e),this.changeSet.add("drawings"),this.emitChange()}getMergeCellList(e){return this.model.getMergeCellList(e)}addMergeCell(e,n){this.model.addMergeCell(e,n),this.changeSet.add("mergeCells"),this.emitChange()}deleteMergeCell(e){this.model.deleteMergeCell(e),this.changeSet.add("mergeCells"),this.emitChange()}setFloatElementUuid(e){this.floatElementUuid=e}getFilter(e){return this.model.getFilter(e)}addFilter(e){this.model.addFilter(e),this.changeSet.add("autoFilter"),this.emitChange()}deleteFilter(e){this.model.deleteFilter(e),this.changeSet.add("autoFilter"),this.emitChange()}updateFilter(e,n){this.model.updateFilter(e,n),this.changeSet.add("autoFilter"),this.emitChange()}}be([Ie()],ke.prototype,"setNextActiveCell");be([Ie()],ke.prototype,"setActiveRange");be([Ie()],ke.prototype,"setCurrentSheetId");be([Ie()],ke.prototype,"setWorksheet");be([Ie()],ke.prototype,"addSheet");be([Ie()],ke.prototype,"deleteSheet");be([Ie()],ke.prototype,"updateSheetInfo");be([Ie()],ke.prototype,"hideSheet");be([Ie()],ke.prototype,"unhideSheet");be([Ie()],ke.prototype,"renameSheet");be([Ie()],ke.prototype,"fromJSON");be([Ie()],ke.prototype,"setCell");be([Ie()],ke.prototype,"setCellValue");be([Ie()],ke.prototype,"updateCellStyle");be([Ie()],ke.prototype,"setColWidth");be([Ie()],ke.prototype,"setRowHeight");be([Ie()],ke.prototype,"addRow");be([Ie()],ke.prototype,"addCol");be([Ie()],ke.prototype,"deleteCol");be([Ie()],ke.prototype,"deleteRow");be([Ie()],ke.prototype,"hideCol");be([Ie()],ke.prototype,"hideRow");be([Ie()],ke.prototype,"unhideRow");be([Ie()],ke.prototype,"unhideCol");be([Ie()],ke.prototype,"setScroll");be([Ie()],ke.prototype,"paste");be([Ie()],ke.prototype,"setCopyRange");be([Ie()],ke.prototype,"deleteAll");be([Ie()],ke.prototype,"setDefineName");be([Ie()],ke.prototype,"addDrawing");be([Ie()],ke.prototype,"updateDrawing");be([Ie()],ke.prototype,"deleteDrawing");be([Ie()],ke.prototype,"addMergeCell");be([Ie()],ke.prototype,"deleteMergeCell");be([Ie()],ke.prototype,"addFilter");be([Ie()],ke.prototype,"deleteFilter");be([Ie()],ke.prototype,"updateFilter");class pr{constructor(e,n){H(this,"type");H(this,"value");this.type=e,this.value=n}toString(){return this.value}}class We extends Error{constructor(n){super(n);H(this,"value");this.value=n}}function en(t,e="#VALUE!"){if(!t)throw new We(e)}function o1(t){en(t.length===1);const[e]=t;return e}function Lc(t){const e=o1(t);return en(typeof e=="string"),e}function pn(t){const e=o1(t),[n,r]=ni(e);return en(n),r}function i$(t){en(t.length===0)}const o$=(...t)=>{const e=o1(t);return typeof e=="string"?e:""},a$=(...t)=>Lc(t).toLowerCase(),US=(...t)=>{const e=pn(t);return String.fromCharCode(e)},BS=(...t)=>Lc(t).charCodeAt(0),l$=(...t)=>Lc(t).length,c$=(...t)=>{en(t.length===2);const[e,n]=t;return en(typeof e=="string"),en(typeof n=="string"),e.split(n)},u$=(...t)=>Lc(t).toUpperCase(),d$=(...t)=>{en(t.length===2);const[e,n]=t;return en(typeof e=="string"||typeof e=="number"),en(typeof n=="string"),oi(e,n)},f$=(...t)=>Lc(t).replace(/ +/g," ").trim(),HS=(...t)=>(en(t.length<=bc),t.join("")),h$={CONCAT:HS,CONCATENATE:HS,SPLIT:c$,CHAR:US,CODE:BS,UNICHAR:US,UNICODE:BS,LEN:l$,LOWER:a$,UPPER:u$,TRIM:f$,TEXT:d$,T:o$};function NI(t){const e=[];for(let n=0;n<t.length;n++){const[r,s]=ni(t[n]);r&&e.push(s)}return e}const p$=(...t)=>{const e=pn(t);return Math.abs(e)},m$=(...t)=>{const e=pn(t);return Math.acos(e)},g$=(...t)=>{const e=pn(t);return Math.log(e+Math.sqrt(e*e-1))},y$=(...t)=>{const e=pn(t);return Math.atan(1/e)},w$=(...t)=>{const e=pn(t);return .5*Math.log((e+1)/(e-1))},S$=(...t)=>{const e=pn(t);return Math.asin(e)},v$=(...t)=>{const e=pn(t);return Math.log(e+Math.sqrt(e*e+1))},_$=(...t)=>{const e=pn(t);return Math.atan(e)},C$=(...t)=>{en(t.length===2);const[e,n]=t;return en(typeof e=="number"),en(typeof n=="number"),Math.atan2(e,n)},E$=(...t)=>{const e=pn(t);return Math.log((1+e)/(e+1))/2},k$=(...t)=>{const e=NI(t);return en(e.length<=bc&&e.length>=1),e.reduce((n,r)=>n+r,0)/e.length},x$=(...t)=>{const e=pn(t);return Math.cos(e)},I$=(...t)=>{const e=pn(t);return 1/Math.tan(e)},b$=(...t)=>{const e=pn(t);return Math.exp(e)},T$=(...t)=>{const e=pn(t);return Math.floor(e)},R$=(...t)=>(i$(t),Math.PI),M$=(...t)=>{const e=pn(t);return Math.sin(e)},N$=(...t)=>{const e=NI(t);return en(e.length<=bc),e.reduce((n,r)=>n+r,0)},A$={ABS:p$,ACOS:m$,ACOSH:g$,ACOT:y$,ACOTH:w$,ASIN:S$,ASINH:v$,ATAN:_$,ATAN2:C$,ATANH:E$,AVERAGE:k$,COT:I$,COS:x$,EXP:b$,INT:T$,PI:R$,SIN:M$,SUM:N$};function D$(t){const e=String(t),n=/[.](\d*)/.exec(e);if(n&&n[1]){const r=Math.pow(10,Math.min(n[1].length,Fw)),s=e.split("."),i=s[0]+s[1].slice(0,Fw);return Number(i)/r}else return t}const AI={...h$,...A$},zS="";class O${constructor(e){H(this,"list");H(this,"current",0);H(this,"start",0);H(this,"tokens",[]);this.list=[...e]}scan(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();return this.tokens.push(new pr(L.EOF,"")),this.tokens.length>0&&this.tokens[0].type===L.EQUAL&&this.tokens.shift(),this.tokens}peek(){return this.isAtEnd()?zS:this.list[this.current]}match(e){return this.peek()!==e?!1:(this.next(),!0)}next(){return this.isAtEnd()?zS:this.list[this.current++]}isAtEnd(){return this.current>=this.list.length}addToken(e){const n=this.list.slice(this.start,this.current).join("");this.tokens.push(new pr(e,n))}string(e){for(;!this.isAtEnd()&&this.peek()!==e;)this.next();if(this.peek()!==e)throw new We("#VALUE!");this.next();const n=this.list.slice(this.start+1,this.current-1).join("");if(e==="'"&&this.match("!")){this.tokens.push(new pr(L.SHEET_NAME,n));return}this.tokens.push(new pr(L.STRING,n))}getDigits(){for(;!this.isAtEnd()&&xs(this.peek());)this.next()}getAlphas(){for(;!this.isAtEnd()&&Im(this.peek());)this.next()}matchR1C1(){if(this.match("[")){if(this.match("-"),xs(this.peek()))this.getDigits();else throw new We("#VALUE!");if(this.peek()!=="]")throw new We("#VALUE!");this.next()}else this.getDigits()}matchScientificCounting(){if(this.match("E")||this.match("e")){if(this.match("+")||this.match("-"))return this.getDigits(),this.addToken(L.NUMBER),!0;if(xs(this.peek()))return this.getDigits(),this.addToken(L.NUMBER),!0;throw new We("#VALUE!")}return!1}number(){this.getDigits(),!(this.matchScientificCounting()||(this.match(".")&&this.getDigits(),this.matchScientificCounting()))&&this.addToken(L.NUMBER)}addIdentifier(){for(;!this.isAtEnd()&&this.anyChar(this.peek());)this.next();let e=this.list.slice(this.start,this.current).join("");const n=e.toUpperCase();if(bO.has(n)&&this.match("(")){this.tokens.push(new pr(L.EXCEL_FUNCTION,n));return}if(["IF","CHOOSE"].includes(n)&&this.match("(")){this.tokens.push(new pr(L.REF_FUNCTION_COND,n));return}if(["INDEX","OFFSET","INDIRECT"].includes(n)&&this.match("(")){this.tokens.push(new pr(L.REF_FUNCTION,n));return}if(this.match("!")){this.tokens.push(new pr(L.SHEET_NAME,e));return}let r=L.BOOL;if(n==="TRUE"||n==="FALSE")e=n,r=L.BOOL;else if(Ck.has(n))e=n,r=n==="#REF!"?L.ERROR_REF:L.ERROR;else if(kO.test(n))r=L.CELL;else if(xO.test(n))r=L.COLUMN;else if(IO.test(n))r=L.ROW;else if(b0.test(n))r=L.DEFINED_NAME;else throw new We("#NAME?");this.tokens.push(new pr(r,e))}scanToken(){const e=this.next();switch(e){case"$":{Im(this.peek())?(this.getAlphas(),this.match("$")?xs(this.peek())?(this.getDigits(),this.addToken(L.CELL)):this.addIdentifier():xs(this.peek())?(this.getDigits(),this.addToken(L.CELL)):this.addToken(L.COLUMN)):xs(this.peek())?(this.getDigits(),this.addToken(L.ROW)):this.addIdentifier();break}case"r":case"R":{if(this.matchR1C1(),this.match("C")||this.match("c")){this.matchR1C1();const n=this.list.slice(this.start,this.current).join("").toUpperCase();this.tokens.push(new pr(L.R1C1,n))}else this.addIdentifier();break}case"(":this.addToken(L.LEFT_BRACKET);break;case")":this.addToken(L.RIGHT_BRACKET);break;case",":this.addToken(L.COMMA);break;case":":this.addToken(L.COLON);break;case la:this.addToken(L.EQUAL);break;case"<":this.match(">")?this.addToken(L.NOT_EQUAL):this.match("=")?this.addToken(L.LESS_EQUAL):this.addToken(L.LESS);break;case">":this.match("=")?this.addToken(L.GREATER_EQUAL):this.addToken(L.GREATER);break;case"+":this.addToken(L.PLUS);break;case"-":this.addToken(L.MINUS);break;case"*":this.addToken(L.STAR);break;case"/":this.addToken(L.SLASH);break;case"^":this.addToken(L.EXPONENT);break;case"&":this.addToken(L.CONCATENATE);break;case"%":this.addToken(L.PERCENT);break;case'"':this.string(e);break;case"'":this.string(e);break;case"!":this.addToken(L.EXCLAMATION);break;case";":this.addToken(L.SEMICOLON);break;case"{":this.addToken(L.lEFT_BRACE);break;case"}":this.addToken(L.RIGHT_BRACE);break;case" ":break;case"\r":case"	":case`
`:break;default:xs(e)?this.number():this.addIdentifier();break}}anyChar(e){return!'(),:=<>+-*/^&%"{}!'.includes(e)&&!this.isWhiteSpace(e)}isWhiteSpace(e){return e===" "||e==="\r"||e===`
`||e==="	"}}class Wa{constructor(e,n,r){H(this,"left");H(this,"right");H(this,"operator");this.left=e,this.operator=n,this.right=r}accept(e){return e.visitBinaryExpression(this)}handleConcatenate(e){const n=e.toString();return this.operator.type===L.CONCATENATE&&e instanceof Jm&&e.value.type===L.STRING?JSON.stringify(n):n}toString(){const e=this.handleConcatenate(this.left),n=this.handleConcatenate(this.right);return`${e}${this.operator.toString()}${n}`}}class L${constructor(e,n){H(this,"right");H(this,"operator");this.operator=e,this.right=n}accept(e){return e.visitUnaryExpression(this)}toString(){return this.operator.toString()+this.right.toString()}}class F${constructor(e,n){H(this,"left");H(this,"operator");this.operator=e,this.left=n}accept(e){return e.visitPostUnaryExpression(this)}toString(){return this.left.toString()+this.operator.toString()}}class Jm{constructor(e){H(this,"value");this.value=e}accept(e){return e.visitLiteralExpression(this)}toString(){return this.value.toString()}}class Va{constructor(e,n){H(this,"value");H(this,"sheetName");this.value=e,this.sheetName=n}accept(e){return e.visitCellExpression(this)}toString(){const e=this.value.toString().toUpperCase();if(this.sheetName){let n=this.sheetName.toString();return n.includes(" ")&&(n=`'${n}'`),`${n}!${e}`}else return e}}class P${constructor(e,n){H(this,"name");H(this,"params");this.name=e,this.params=n}accept(e){return e.visitCallExpression(this)}toString(){return`${this.name.toString()}(${this.params.map(e=>e.toString()).join(",")})`}}class $${constructor(e,n,r){H(this,"right");H(this,"operator");H(this,"left");this.left=e,this.operator=n,this.right=r}accept(e){return e.visitCellRangeExpression(this)}toString(){return this.left.toString()+this.operator.toString()+this.right.toString()}}class U${constructor(e){H(this,"value");this.value=e}accept(e){return e.visitGroupExpression(this)}toString(){return`(${this.value.toString()})`}}class B${constructor(e){H(this,"value");this.value=e}accept(e){return e.visitArrayExpression(this)}toString(){return`{${this.value.map(n=>n.toString()).join(",")}}`}}class H${constructor(e){H(this,"tokens");H(this,"current",0);this.tokens=e}parse(){const e=[];for(;!this.isAtEnd();)e.push(this.expression());return e}expression(){return this.comparison()}comparison(){let e=this.concatenate();for(;this.match(L.EQUAL,L.NOT_EQUAL,L.GREATER,L.GREATER_EQUAL,L.LESS,L.LESS_EQUAL);){const n=this.previous(),r=this.concatenate();e=new Wa(e,n,r)}return e}concatenate(){let e=this.term();for(;this.match(L.CONCATENATE);){const n=this.previous(),r=this.term();e=new Wa(e,n,r)}return e}term(){let e=this.factor();for(;this.match(L.PLUS,L.MINUS);){const n=this.previous(),r=this.factor();e=new Wa(e,n,r)}return e}factor(){let e=this.expo();for(;this.match(L.SLASH,L.STAR);){const n=this.previous(),r=this.expo();e=new Wa(e,n,r)}return e}expo(){let e=this.unary();for(;this.match(L.EXPONENT);){const n=this.previous(),r=this.unary();e=new Wa(e,n,r)}return e}unary(){if(this.match(L.PLUS,L.MINUS)){const e=this.previous(),n=this.unary();return new L$(e,n)}return this.postUnary()}postUnary(){let e=this.cellRange();if(this.match(L.PERCENT)){const n=this.previous();e=new F$(n,e)}return e}cellRange(){let e=this.sheetRange();for(;this.match(L.COLON);){const n=this.previous(),r=this.sheetRange(),s=this.convertToCellExpression(r),i=this.convertToCellExpression(e);e=new $$(i,n,s)}return e}convertToCellExpression(e){if(e instanceof Va)return e;if(e instanceof Jm&&e.value.type===L.NUMBER)return new Va(e.value,void 0);throw new We("#NAME?")}sheetRange(){if(this.match(L.SHEET_NAME)){const e=this.previous();let n=this.call();if(n instanceof Va)return new Va(n.value,e);throw new We("#REF!")}return this.call()}call(){for(;this.match(L.EXCEL_FUNCTION,L.REF_FUNCTION,L.REF_FUNCTION_COND);){const e=this.previous(),n=[];if(!this.check(L.RIGHT_BRACKET))do{if(this.peek().type==L.RIGHT_BRACKET)break;n.push(this.expression())}while(this.match(L.COMMA));return this.expect(L.RIGHT_BRACKET),new P$(e,n)}return this.primary()}primary(){if(this.match(L.lEFT_BRACE)){const e=[];do{if(this.peek().type==L.RIGHT_BRACE)break;e.push(this.expression())}while(this.match(L.COMMA));return this.expect(L.RIGHT_BRACE),new B$(e)}if(this.match(L.LEFT_BRACKET)){const e=this.expression();return this.expect(L.RIGHT_BRACKET),new U$(e)}if(this.match(L.NUMBER,L.STRING,L.BOOL))return new Jm(this.previous());if(this.match(L.CELL,L.COLUMN,L.ROW,L.DEFINED_NAME,L.R1C1)){const e=this.previous();return new Va(e,void 0)}throw this.match(L.ERROR,L.ERROR_REF)?new We(this.previous().value):new We("#VALUE!")}match(...e){const{type:n}=this.peek();return e.includes(n)?(this.next(),!0):!1}previous(){return this.tokens[this.current-1]}check(e){return this.peek().type===e}expect(e){if(this.check(e))return this.next(),this.previous();throw new We("#VALUE!")}next(){this.current++}isAtEnd(){return this.peek().type===L.EOF}peek(){return this.current<this.tokens.length?this.tokens[this.current]:new pr(L.EOF,"")}}class z${constructor(e,n,r){H(this,"expressions");H(this,"cellDataMap");H(this,"currentCoord");this.expressions=e,this.cellDataMap=r,this.currentCoord=n}interpret(){let e=[];for(const n of this.expressions){const r=this.evaluate(n),s=this.getRangeCellValue(r);Array.isArray(s)?e=e.concat(s):e.push(s)}return e}visitBinaryExpression(e){let n=this.evaluate(e.left),r=this.evaluate(e.right);switch(n=this.getOneValue(n),r=this.getOneValue(r),[L.MINUS,L.PLUS,L.SLASH,L.STAR,L.EXPONENT].includes(e.operator.type)&&(n=this.parseNumber(n),r=this.parseNumber(r)),e.operator.type){case L.MINUS:return n-r;case L.PLUS:return n+r;case L.SLASH:{if(r===0)throw new We("#DIV/0!");return n/r}case L.STAR:return n*r;case L.EXPONENT:return Math.pow(n,r);case L.EQUAL:return n===r;case L.NOT_EQUAL:return n!==r;case L.GREATER:return n>r;case L.GREATER_EQUAL:return n>=r;case L.LESS:return n<r;case L.LESS_EQUAL:return n<=r;case L.CONCATENATE:return`${n}${r}`;default:throw new We("#TEXT")}}visitCallExpression(e){const n=this.cellDataMap.getFunction(e.name.value);if(n&&typeof n=="function"){let r=[];for(const s of e.params){const i=this.evaluate(s);if(i instanceof Tr){const o=this.getCellValue(i,!1);r=r.concat(o)}else r.push(i)}return n(...r)}throw new We("#NAME?")}visitCellExpression(e){let n="";if(e.sheetName){const s=this.cellDataMap.getSheetInfo("",e.sheetName.value);if(!(s!=null&&s.sheetId))throw new We("#REF!");n=s.sheetId}let r;if([L.DEFINED_NAME,L.CELL,L.COLUMN,L.R1C1].includes(e.value.type)&&(r=this.cellDataMap.getDefinedName(e.value.value)),r||(e.value.type===L.R1C1?r=XO(e.value.value,this.currentCoord):r=es(e.value.value)),!r)throw new We("#REF!");return n&&(r.sheetId=n),r}visitLiteralExpression(e){const{type:n,value:r}=e.value;switch(n){case L.STRING:return r;case L.NUMBER:{const[s,i]=ni(r);if(s)return i;throw new We("#VALUE!")}case L.BOOL:return r==="TRUE";default:throw new We("#VALUE!")}}visitUnaryExpression(e){const n=this.evaluate(e.right),r=this.parseNumber(this.getOneValue(n));switch(e.operator.type){case L.MINUS:return-r;case L.PLUS:return r;default:throw new We("#VALUE!")}}visitCellRangeExpression(e){switch(e.operator.type){case L.COLON:{const n=this.visitCellExpression(e.left),r=this.visitCellExpression(e.right),s=N0(n,r);if(!s)throw new We("#NAME?");return s}default:throw new We("#NAME?")}}visitGroupExpression(e){return this.evaluate(e.value)}visitArrayExpression(e){const n=[];for(const r of e.value)n.push(this.evaluate(r));return n}visitPostUnaryExpression(e){const n=this.evaluate(e.left),r=this.parseNumber(this.getOneValue(n));switch(e.operator.type){case L.PERCENT:return r*.01;default:throw new We("#VALUE!")}}evaluate(e){return e.accept(this)}getRangeCellValue(e){if(e instanceof Tr){if(e.colCount===e.rowCount&&e.colCount===1)return this.getCellValue(e,!0);throw new We("#REF!")}return e}getOneValue(e){const n=this.getRangeCellValue(e);return Array.isArray(n)?n[0]:n}parseNumber(e){const[n,r]=ni(e);if(!n)throw new We("#VALUE!");return r}getCellValue(e,n){let r=[];if(n){const l=this.cellDataMap.getCell(e),c=this.cellDataMap.handleCell(l,{row:e.row,col:e.col});return r=r.concat(c),r}const{row:s,col:i,sheetId:o}=e,a=this.cellDataMap.getSheetInfo(o);if(!a||s>=a.rowCount||i>=a.colCount)throw new We("#REF!");return hl(e,a.rowCount,a.colCount,(l,c)=>{const d=this.cellDataMap.getCell({row:l,col:c,rowCount:1,colCount:1,sheetId:o}),u=this.cellDataMap.handleCell(d,{row:l,col:c});return r=r.concat(u),!1}),r}}function DI(t,e={row:0,col:0},n=new j$,r=new Map){if(r.has(t)){const s=r.get(t);return s.result.length===0?{result:[0]}:s}try{n.handleCell=(c,d)=>c?c.formula?DI(c.formula,d,n,r).result:[c.value]:[];const s={result:[],expressionStr:""};r.set(t,s);const i=new O$(t).scan(),o=new H$(i).parse(),a=new z$(o,e,n).interpret(),l=[];for(const c of o)l.push(c.toString());s.expressionStr=l.join("");for(const c of a)typeof c=="number"&&!isNaN(c)?s.result.push(D$(c)):s.result.push(c);return s}catch(s){if(s instanceof We){const i={result:[s.value]};return r.set(t,i),i}throw s}}const Yh="_test_";class j${constructor(){H(this,"map",new Map);H(this,"definedNameMap",new Map);H(this,"currentSheetId",Yh);H(this,"sheetList",[{sheetId:Yh,name:"_test_",rowCount:200,colCount:30,isHide:!1,sort:1}]);H(this,"getFunction",e=>AI[e]);H(this,"handleCell",(e,n)=>e?[e.value]:[])}getKey(e,n,r){return`${e}_${n}_${r||Yh}`}setSheetList(e){this.sheetList=e}set(e,n){const{row:r,col:s,sheetId:i}=e;for(let o=0;o<n.length;o++)for(let a=0;a<n[o].length;a++){const l=this.getKey(r+o,s+a,i),c=n[o][a];typeof c=="string"&&Ek(c)?this.map.set(l,{formula:c,value:""}):this.map.set(l,{value:c})}}getCell(e){const{row:n,col:r,sheetId:s}=e,i=this.getKey(n,r,s);return this.map.get(i)}getSheetInfo(e,n){if(n)return this.sheetList.find(s=>s.name===n);const r=e||this.currentSheetId;return this.sheetList.find(s=>s.sheetId===r)}setDefinedName(e,n){const r=Tr.makeRange(n);this.definedNameMap.set(e,r)}getDefinedName(e){return this.definedNameMap.get(e)}}function W$(t,e){const{currentSheetId:n,worksheets:r,workbook:s,definedNames:i}=t,o=new Map,a={list:[]},l={handleCell:()=>[],getFunction:c=>AI[c],getCell:c=>{const{row:d,col:u,sheetId:f}=c,h=qn(f||n,d,u);return r[h]},set:()=>{throw new We("#REF!")},getSheetInfo:(c,d)=>{if(d)return s.find(f=>f.name===d);const u=c||n;return s.find(f=>f.sheetId===u)},setDefinedName:()=>{throw new We("#REF!")},getDefinedName:c=>{const d=i[c];return d&&Tr.makeRange(d)}};for(const[c,d]of Object.entries(r)){const u=fl(c);if(!u||u.sheetId!==n||!(d!=null&&d.formula))continue;const f=DI(d==null?void 0:d.formula,DO(c),l,o);if(!f)continue;const h=f.result[0];h!==d.value&&a.list.push({key:c,newValue:h,sheetId:n})}return e(a)}function jS(t){return t?typeof Intl>"u"||typeof Intl.Segmenter!="function"?[...t]:[...new Intl.Segmenter([],{granularity:"word"}).segment(t)].map(r=>r.segment):[]}const qh=new Map;function V$(t,e){const n=`${e}__${t.font}`;if(qh.has(n))return qh.get(n);const r=t.measureText(e),{actualBoundingBoxAscent:s,actualBoundingBoxDescent:i}=r,o=s+i,a=r.width,l=Math.ceil(a/Gl()),c=Math.ceil(o/Gl()),d={width:l,height:c};return qh.set(n,d),d}function Yn(t,e,n,r,s){t.fillRect(He(e),He(n),He(r),He(s))}function Qm(t,e,n,r,s){t.strokeRect(He(e),He(n),He(r),He(s))}function WS(t,e,n,r,s){t.clearRect(He(e),He(n),He(r),He(s))}function Zm(t,e,n,r){t.fillText(e,He(n),He(r))}function Os(t,e){if(e.length!==0){t.beginPath();for(let n=0;n<e.length;n+=2){const r=e[n],s=e[n+1];t.moveTo(He(r[0]),He(r[1])),t.lineTo(He(s[0]),He(s[1]))}t.stroke()}}function VS(t,e,n,r){t.beginPath(),t.moveTo(He(e[0]),He(e[1])),t.lineTo(He(n[0]),He(n[1])),t.lineTo(He(r[0]),He(r[1])),t.fill()}function OI(t,e,n){const r=t.slice(),[s,i]=t,o=ve*2,a=n?o:0;return e==="bottom"?r.push([s[0]+a,s[1]-o],[i[0]-a,i[1]-o]):e==="top"?r.push([s[0]+a,s[1]+o],[i[0]-a,i[1]+o]):e==="left"?r.push([s[0]+o,s[1]+a],[i[0]+o,i[1]-a]):e==="right"&&r.push([s[0]-o,s[1]+a],[i[0]-o,i[1]-a]),r}function G$(t,e,n){return n?e?t.split(Hn):jS(t.replaceAll(Hn,"")):jS(t)}function X$(t,e,n,r,s){t.setLineDash([He(8),He(6)]);const i=ve;Qm(t,e+i,n+i,r-i*2,s-i*2),t.setLineDash([])}function Y$(t){let e=[];return t==="hair"?e=[ve,ve]:t==="dotted"||t==="mediumDashed"?e=[ve*2,ve*2]:t==="dashed"?e=[ve*4,ve*4]:t==="dashDot"||t==="mediumDashDot"?e=[ve*4,ve*4,ve*8,ve*4]:(t==="dashDotDot"||t==="mediumDashDotDot")&&(e=[ve*4,ve*4,ve*8,ve*4,ve*4,ve*4]),e}function ku(t,e,n,r,s){if(!n)return;const{top:i,left:o,width:a,height:l}=e;let c=[];r==="top"?c=[[o,i],[o+a,i]]:r==="bottom"?c=[[o,i+l],[o+a,i+l]]:r==="left"?c=[[o,i],[o,i+l]]:r==="right"&&(c=[[o+a,i],[o+a,i+l]]);const{type:d,color:u}=n;t.lineWidth=Tc[d],t.strokeStyle=u||it("black",s);const f=Y$(d);d==="double"&&(c=OI(c,r,!0)),f.length>0&&t.setLineDash(f.map(h=>He(h))),Os(t,c),f.length>0&&t.setLineDash([])}function q$(t,e,n,r,s){const i=n.value,o={height:0,width:0};if(i==="")return o;const a=(n==null?void 0:n.numberFormat)||Xi,l=a===Xi&&typeof i=="number",c=oi(i,a),d=n!=null&&n.fontSize?n.fontSize:no,u=xk(n!=null&&n.isItalic?"italic":"normal",n!=null&&n.isBold?"bold":"500",He(d),n==null?void 0:n.fontFamily);n!=null&&n.fillColor&&(t.fillStyle=n==null?void 0:n.fillColor,Yn(t,e.left,e.top,e.width,e.height));let f=(n==null?void 0:n.fontColor)||it("contentColor",s);Ck.has(c)&&(f=it("errorFormulaColor",s)),t.font=u,t.fillStyle=f;const h={...n};let p=h==null?void 0:h.horizontalAlign;(h==null?void 0:h.horizontalAlign)===void 0&&l&&(p=wt.RIGHT),h.horizontalAlign=p;const g=(!(h!=null&&h.isWrapText)&&s1(a)?[c]:G$(c,n==null?void 0:n.isWrapText,r)).map(x=>{const C=V$(t,x);return{str:x,width:C.width,height:C.height===0?d:C.height}}),{width:y,height:w,resultList:v}=K$(g,e,h,R0(!!r,c));if(y>0&&w>0){const x=Math.ceil(d*(da.lineHeight-1)/2);let C=[];for(const E of v){if(Zm(t,E.text,E.x,E.y),h!=null&&h.underline){t.strokeStyle=f;const A=E.y+E.height+x/2,V=[[E.x,A],[E.x+E.width,A]];(h==null?void 0:h.underline)===Ze.DOUBLE?C=C.concat(OI(V,"bottom",!1)):C=C.concat(V)}if(h!=null&&h.isStrike){t.strokeStyle=f;const A=E.y+E.height/2+x/2;C=C.concat([[E.x,A],[E.x+E.width,A]])}}Os(t,C)}return o.height=Math.ceil(w),o.width=Math.ceil(y),o}function K$(t,e,n,r){const s=n!=null&&n.fontSize?n.fontSize:no,i=Math.ceil(s*(da.lineHeight-1)/2),o=(n==null?void 0:n.verticalAlign)??Et.MIDDLE,{left:a,top:l,height:c}=e,d=Math.max(e.width,...t.map(p=>p.width)),u=[];let f=0,h=0;if(n!=null&&n.isWrapText&&r){let p=0;for(let m=0;m<t.length;m++){const _=t[m];f=Math.max(f,_.width);const g=_.height+i*2;h+=g,u.push({text:_.str,x:0,y:p,width:_.width,height:_.height}),p+=g}}else if(n!=null&&n.isWrapText){let p=0;for(let m=0;m<t.length;){let _=d,g="",y=0,w=0;for(;m<t.length;){const v=t[m];if(_>=v.width)y+=v.width,w=Math.max(w,v.height),_-=v.width,g+=v.str,m++;else break}if(g){f=Math.max(f,y);const v=w+i*2;h+=v,u.push({text:g,x:0,y:p,width:y,height:w}),p+=v}}}else{let p="",m=d;for(let _=0;_<t.length;_++){const g=t[_];if(m>=g.width)f+=g.width,h=Math.max(h,g.height),p+=g.str,m-=g.width;else break}u.push({text:p,x:0,y:0,width:f,height:h})}if(h=Math.max(h,s*da.lineHeight),f+=i,h+=i,f<=d&&h<=c){let p=a+i,m=l+(c-h)/2+i;o===Et.TOP?m=l+i:o===Et.BOTTOM&&(m=l+(c-h)+i),(n==null?void 0:n.horizontalAlign)===wt.CENTER?p=a+(d-f)/2:(n==null?void 0:n.horizontalAlign)===wt.RIGHT&&(p=a+(d-f)-i);for(const _ of u)_.x=_.x+p,_.y=_.y+m}return{width:f,height:h,resultList:u}}function GS(t){return{textAlign:"center",textBaseline:"middle",font:xk(void 0,"500",He(no)),fillStyle:it("black",t),lineWidth:ve,strokeStyle:it("borderColor",t)}}const XS=Math.max(...Object.values(Tc));class J${constructor(e){H(this,"canvas");H(this,"ctx");H(this,"width",0);H(this,"height",0);H(this,"isRendering",!1);H(this,"rowMap",{});H(this,"colMap",{});H(this,"eventData",{theme:"light",sheetData:{},canvasSize:{top:0,left:0,width:0,height:0},headerSize:{width:0,height:0},currentSheetInfo:{isHide:!1,rowCount:0,colCount:0,name:"",sheetId:"",tabColor:"",sort:1},scroll:{row:0,col:0,top:0,left:0,scrollLeft:0,scrollTop:0},range:{row:0,col:0,rowCount:1,colCount:1,sheetId:""},copyRange:void 0,customHeight:{},customWidth:{},currentMergeCells:[],autoFilter:void 0});this.canvas=e,this.ctx=e.getContext("2d");const n=Gl();this.ctx.scale(n,n)}render(e){if(e.changeSet.size===0||this.isRendering)return;this.isRendering=!0,this.eventData=e,this.clear();const{ctx:n}=this;n.strokeStyle=it("primaryColor",e.theme),n.fillStyle=it("white",e.theme),n.lineWidth=ve*2;const{width:r,height:s}=this.eventData.canvasSize,i=this.eventData.headerSize,{endRow:o,contentHeight:a}=this.renderRowsHeader(s),{endCol:l,contentWidth:c}=this.renderColsHeader(r);this.renderGrid(r-i.width,s-i.height),this.renderTriangle(),this.renderMergeCell(),this.ctx.fillStyle=it("selectionColor",this.eventData.theme);const d=this.renderSelection({endRow:o,endCol:l,contentHeight:a,contentWidth:c});return this.renderAntLine(d),this.renderContent({endRow:o,endCol:l,contentHeight:a,contentWidth:c}),this.ctx.lineWidth=XS,Qm(this.ctx,d.left,d.top,d.width,d.height),this.isRendering=!1,{rowMap:{...this.rowMap},colMap:{...this.colMap}}}resize(e){this.width=e.width,this.height=e.height,this.canvas.width=He(e.width),this.canvas.height=He(e.height)}clear(){WS(this.ctx,0,0,this.width,this.height)}renderRowsHeader(e){const{row:n}=this.eventData.scroll,r=this.eventData.headerSize,{rowCount:s}=this.eventData.currentSheetInfo;this.ctx.save();const i=this.eventData.range;Yn(this.ctx,0,r.height,r.width,e),Object.assign(this.ctx,GS(this.eventData.theme));const o=[];let a=r.height,l=n;for(;l<s&&a<e;l++){const d=this.getRowHeight(l);let u=a;if(l===n&&(u+=ve/2),o.push([0,u],[r.width,u]),d>0){const f=this.isHighlightRow(i,l);this.ctx.fillStyle=f?it("primaryColor",this.eventData.theme):it("black",this.eventData.theme),Zm(this.ctx,String(l+1),r.width/2,u+d/2)}a+=d}o.push([0,a],[r.width,a]),o.push([0,0],[0,a]),Os(this.ctx,o),this.ctx.restore();const c=l>=s?a:e;return{endRow:l,contentHeight:Math.floor(c)}}renderColsHeader(e){const{col:n,row:r}=this.eventData.scroll,s=this.eventData.headerSize,{colCount:i}=this.eventData.currentSheetInfo,o=this.eventData.range,a=[];this.ctx.save(),Yn(this.ctx,s.width,0,e,s.height),Object.assign(this.ctx,GS());let l=s.width,c=n;const d=this.eventData.autoFilter;let u=0;for(let h=r;h<this.eventData.currentSheetInfo.rowCount&&(u=this.getRowHeight(r),u===0);h++);for(;c<i&&l<=e;c++){const h=this.getColWidth(c);let p=l;if(c===n&&(p+=ve/2),a.push([p,0],[p,s.height]),h>0){const m=this.isHighlightCol(o,c);this.ctx.fillStyle=m?it("primaryColor",this.eventData.theme):it("black",this.eventData.theme),Zm(this.ctx,bk(c),p+h/2,s.height/2)}d&&c>=d.range.col&&c<d.range.col+d.range.colCount&&this.renderFilter(l+h,s.height+u,d.col===c),l+=h}a.push([l,0],[l,s.height]),a.push([0,0],[l,0]),Os(this.ctx,a),this.ctx.restore();const f=c>=i?l:e;return{endCol:c,contentWidth:Math.floor(f)}}renderFilter(e,n,r){const s=Em,i=ve*4,o=e-s-i,a=n-s-i;this.ctx.fillStyle=r?it("primaryColor",this.eventData.theme):it("borderColor",this.eventData.theme),this.ctx.strokeStyle=r?it("primaryColor",this.eventData.theme):it("borderColor",this.eventData.theme),Qm(this.ctx,o,a,s,s),VS(this.ctx,[o+s/4,a+s*3/8],[o+s*3/4,a+s*3/8],[o+s/2,a+s*5/8])}renderGrid(e,n){const r=this.eventData.headerSize,{row:s,col:i}=this.eventData.scroll,{rowCount:o,colCount:a}=this.eventData.currentSheetInfo;this.ctx.save(),this.ctx.lineWidth=ve,this.ctx.strokeStyle=it("borderColor",this.eventData.theme),this.ctx.translate(He(r.width),He(r.height));const l=[];let c=0,d=0;for(let u=s;u<o&&c<=n;u++){for(;u<o&&this.getRowHeight(u)===0;)u++;l.push([0,c],[e,c]);const f=this.getRowHeight(u);c+=f}for(let u=i;u<a&&d<=e;u++){for(;u<a&&this.getColWidth(u)===0;)u++;l.push([d,0],[d,c]);const f=this.getColWidth(u);d+=f}l.push([0,c],[d,c]),l.push([d,0],[d,c]),Os(this.ctx,l),this.ctx.restore()}renderTriangle(){const e=this.eventData.headerSize;this.ctx.save(),Yn(this.ctx,0,0,e.width,e.height),this.ctx.fillStyle=it("triangleFillColor",this.eventData.theme);const n=2,r=Math.floor(n),s=Math.floor(e.height-n),i=Math.floor(e.width*.4),o=Math.floor(e.width-n);VS(this.ctx,[o,r],[i,s],[o,s]),this.ctx.restore()}getRowHeight(e){const n=kr(this.eventData.currentSheetInfo.sheetId,e),r=this.eventData.customHeight[n];return r?r.isHide?Cm:r.len:zl}getColWidth(e){const n=kr(this.eventData.currentSheetInfo.sheetId,e),r=this.eventData.customWidth[n];return r?r.isHide?Cm:r.len:jl}isHighlightRow(e,n){return!!(Ao(e)||Js(e)||n>=e.row&&n<e.row+e.rowCount)}isHighlightCol(e,n){return!!(Ao(e)||Ks(e)||n>=e.col&&n<e.col+e.colCount)}renderAntLine(e){const n=this.eventData.copyRange;!n||n.sheetId!==this.eventData.currentSheetInfo.sheetId||(this.ctx.lineWidth=XS,this.ctx.strokeStyle=it("primaryColor",this.eventData.theme),X$(this.ctx,e.left,e.top,e.width,e.height))}renderMergeCell(){const e=this.eventData.currentMergeCells;if(e.length===0)return;const n=this.eventData.range;for(const r of e)n.row===r.row&&n.col===r.col||this.clearRect(r)}getCellSize(e){let{row:n,col:r,colCount:s,rowCount:i}=e,o=n,a=r,l=n+i,c=r+s;const d=this.eventData.currentSheetInfo;Ao(e)?(a=0,c=d.colCount,o=0,l=d.rowCount):Js(e)?(o=0,l=d.rowCount):Ks(e)&&(a=0,c=d.colCount);let u=0,f=0;for(;o<l;o++)f+=this.getRowHeight(o);for(;a<c;a++)u+=this.getColWidth(a);return{width:u,height:f}}computeCellPosition(e){const{row:n,col:r}=e,s=this.eventData.headerSize,i=this.eventData.scroll;let o=s.width,a=s.height,l=i.row,c=i.col;if(r>=i.col)for(;c<r;)o+=this.getColWidth(c),c++;else for(o=-s.width;c>r;)o-=this.getColWidth(c),c--;if(n>=i.row)for(;l<n;)a+=this.getRowHeight(l),l++;else for(a=-s.height;l>n;)a-=this.getRowHeight(l),l--;return{top:a,left:o}}getActiveRange(e){const n=e||this.eventData.range,r=this.eventData.currentMergeCells;for(const s of r)if(Tk(n,s))return{range:{...s,sheetId:s.sheetId},isMerged:!0};return{range:n,isMerged:!1}}clearRect(e){const n=this.getCellSize(e);if(n.width<=0||n.height<=0)return;const r=this.computeCellPosition(e),s=ve;WS(this.ctx,r.left+s,r.top+s,n.width-s*2,n.height-s*2)}renderContent(e){const{endCol:n,endRow:r,contentHeight:s,contentWidth:i}=e,{ctx:o}=this;o.textAlign="left",o.textBaseline="top",o.lineWidth=ve*2;const a=this.eventData.headerSize,{row:l,col:c}=this.eventData.scroll,d=Math.floor(i-a.width),u=Math.floor(s-a.height);o.save(),this.rowMap={},this.colMap={};const f=this.eventData.currentMergeCells;for(let h=l;h<r;h++)for(let p=c;p<n;p++){const m=f.find(_=>_.row===h&&_.col===p);this.renderCell(h,p,m,d,u)}o.restore()}renderCell(e,n,r,s,i){const{ctx:o}=this,a={row:e,col:n,rowCount:1,colCount:1,sheetId:""},l=qn(this.eventData.currentSheetInfo.sheetId,e,n),c=this.eventData.sheetData[l];if(!c)return;const d=this.getCellSize(r||a);if(d.width<=0||d.height<=0)return;const u=this.computeCellPosition(a);o.lineWidth=ve*2;const f=this.eventData.theme,h=q$(o,{top:u.top,left:u.left,width:Math.min(d.width,s),height:Math.min(d.height,i)},c,!!r,f),p=Math.max(this.rowMap[e]??0,h.height),m=Math.max(this.colMap[n]??0,h.width);p>=zl&&(this.rowMap[e]=p),m>=jl&&(this.colMap[n]=m);const _={top:u.top,left:u.left,height:Math.max(p,d.height),width:Math.max(m,d.width)};ku(o,_,c.borderTop,"top",f),ku(o,_,c.borderBottom,"bottom",f),ku(o,_,c.borderLeft,"left",f),ku(o,_,c.borderRight,"right",f)}renderSelection(e){const n=this.eventData.range;return Ao(n)?this.renderSelectAll(e):Js(n)?this.renderSelectCol(e):Ks(n)?this.renderSelectRow(e):this.renderSelectRange()}renderSelectRange(){const e=this.eventData.headerSize,n=this.eventData.range,r=this.computeCellPosition({row:n.row,col:n.col,rowCount:1,colCount:1,sheetId:""}),s=n.row+n.rowCount-1,i=n.col+n.colCount-1,o={row:s,col:i,rowCount:1,colCount:1,sheetId:""},a=this.computeCellPosition(o),l=this.getCellSize(o),c=a.left+l.width-r.left,d=a.top+l.height-r.top;Yn(this.ctx,r.left,0,c,e.height),Yn(this.ctx,0,r.top,e.width,d);const u=n.rowCount>1||n.colCount>1;u&&Yn(this.ctx,r.left,r.top,c,d);const f=[[r.left,e.height],[r.left+c,e.height]];return f.push([e.width,r.top],[e.width,r.top+d]),Os(this.ctx,f),u&&this.renderActiveCell(),{left:r.left,top:r.top,width:c,height:d}}renderSelectAll(e){const{contentHeight:n,contentWidth:r}=e,s=this.eventData.headerSize;Yn(this.ctx,0,0,r,n),this.renderActiveCell();const i=r-s.width,o=n-s.height;return{left:s.width,top:s.height,width:i,height:o}}renderSelectCol({contentHeight:e}){const n=this.eventData.headerSize,r=this.eventData.range,s=this.computeCellPosition(r);let i=0;for(let l=r.col,c=r.col+r.colCount;l<c;l++)i+=this.getColWidth(l);const o=e-n.height;Yn(this.ctx,s.left,0,i,e),Yn(this.ctx,0,s.top,n.width,o);const a=[[n.width,n.height],[n.width,e]];return Os(this.ctx,a),this.renderActiveCell(),{left:s.left,top:n.height,width:i,height:o}}renderSelectRow({contentWidth:e}){const n=this.eventData.headerSize,r=this.eventData.range,s=this.computeCellPosition(r);let i=0;for(let l=r.row,c=r.row+r.rowCount;l<c;l++)i+=this.getRowHeight(l);const o=e-n.width-ve;Yn(this.ctx,s.left,0,o,n.height),Yn(this.ctx,0,s.top,e,i);const a=[[s.left,n.height],[e,n.height]];return Os(this.ctx,a),this.renderActiveCell(),{left:n.width,top:s.top,width:o,height:i}}renderActiveCell(){const e=this.eventData.range,n=this.getActiveRange({row:e.row,col:e.col,rowCount:1,colCount:1,sheetId:e.sheetId}).range;this.clearRect(n)}}let gi=null;const Q$={init(t){gi=new J$(t.canvas),WO(t.dpr)},resize(t){gi==null||gi.resize(t)},async render(t,e){const n=gi==null?void 0:gi.render(t);n&&await e(n)},async computeFormulas(t,e){return await W$(t,e)}};function Z$(){return{async copyOrCut(){},async paste(){return{[Bt]:"",[Ut]:"",[Kt]:null,[an]:null}},worker:Q$,doc:new ro}}function eU(t=Z$()){const e=new ZP(t);return new ke(e,t)}function tU(t){return new Worker("/excel/assets/worker-DsHjpO_5.js",{name:t==null?void 0:t.name})}const nU=Uint8Array.from([1,10,175,219,170,202,8,0,39,1,5,101,120,99,101,108,8,119,111,114,107,98,111,111,107,1,39,0,175,219,170,202,8,0,1,49,1,40,0,175,219,170,202,8,1,4,110,97,109,101,1,119,6,83,104,101,101,116,49,40,0,175,219,170,202,8,1,7,115,104,101,101,116,73,100,1,119,1,49,40,0,175,219,170,202,8,1,4,115,111,114,116,1,125,1,40,0,175,219,170,202,8,1,6,105,115,72,105,100,101,1,121,40,0,175,219,170,202,8,1,8,99,111,108,67,111,117,110,116,1,125,30,40,0,175,219,170,202,8,1,8,114,111,119,67,111,117,110,116,1,125,136,3,40,1,5,101,120,99,101,108,14,99,117,114,114,101,110,116,83,104,101,101,116,73,100,1,119,0,168,175,219,170,202,8,8,1,119,1,49,1,175,219,170,202,8,1,8,1]);class rU{constructor(e){H(this,"broadcastChannel");H(this,"doc");H(this,"addHistory",async e=>{this.broadcastChannel.postMessage({update:e})});H(this,"retrieveHistory",async()=>[]);this.doc=e,this.broadcastChannel=new BroadcastChannel(this.doc.guid)}subscribe(){this.broadcastChannel.addEventListener("message",e=>{const{update:n}=e.data;Mk("onmessage",e),Wm(this.doc,n,_r.REMOTE)})}}function sU(t){let e=!1,n;return n=new rU(t),{provider:n,isServer:e}}function iU(t){if(t.origin===_r.REMOTE||t.origin===_r.INIT)return!0;for(const e of t.changed.values())if(e.has("drawings"))return!0;return!1}async function oU(t){const{provider:e,isServer:n}=sU(t);t.on("update",(s,i,o,a)=>{n&&iU(a)||(Mk("doc update",a),e.addHistory(s))}),e.subscribe();const r=await e.retrieveHistory();return r.length>0?Wm(t,JF(r),_r.INIT):Wm(t,nU,_r.EMPTY),{isServer:n}}location.hostname==="nusr.github.io"&&uA({dsn:"https://b292d91ba509038c141ecfc7d10e7bb7@o4506851168092160.ingest.sentry.io/4506851171041280",integrations:[oA(),XN({maskAllText:!1,blockAllMedia:!1})],tracesSampleRate:1,tracePropagationTargets:["nusr.github.io"],replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1});async function aU(){const t=kk();location.hash=`#${t}`;const e=new ro({guid:t});await oU(e);const n=eU({copyOrCut:QO,paste:Ak,worker:Jk(new tU),doc:e});window.controller=n,window.doc=e,Df(document.getElementById("root")).render(S.jsx(T.StrictMode,{children:S.jsx(MI,{controller:n})}))}aU();export{km as C,it as a,cU as c,Of as d,YS as g,S as j,ni as p,T as r};
//# sourceMappingURL=app-DJvJWbiD.js.map
