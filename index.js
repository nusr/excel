/* 
MIT License

Copyright (c) 2020 Steve Xu

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/
import{$ as Zr,A as Or,B as zr,C as Wr,D as Ur,E as jr,F as ro,G as U,H as _e,I as ge,J as Fe,K as no,L as io,M as A,N as Pt,O as so,P as lo,Q as ao,R as co,S as Le,T as ve,U as Vr,V as Re,W as Xr,X as Ct,Y as Kr,Z as Gr,_ as Qr,a as q,aa as Yr,b as T,ba as yt,c as ft,ca as bt,d as be,da as qr,e as qt,ea as Jr,f as Mr,fa as _r,g as Lr,ga as $r,h as Jt,ha as z,i as Dr,ia as xe,j as Hr,ja as ho,k as ce,ka as en,l as Ee,la as tn,m as Te,ma as $e,n as gt,na as Uo,o as Wo,oa as on,p as J,pa as L,q as _t,qa as Nt,ra as et,s as $t,sa as Mt,t as Br,u as eo,v as Ye,w as qe,x as Je,y as to,z as oo}from"./chunk-Y2HUKE5U.js";import{a as N}from"./chunk-S76M7AWC.js";import{b as Nr,d as E}from"./chunk-RBTA6K5V.js";var Jo=Nr((Ga,fn)=>{"use strict";fn.exports=window.ReactDOM});var xo=Nr(_o=>{"use strict";var gn=Jo();_o.createRoot=gn.createRoot,_o.hydrateRoot=gn.hydrateRoot;var Qa});var Q=E(N());var re={"canvas-container":"C","vertical-scroll-bar":"P","vertical-scroll-bar-content":"d","horizontal-scroll-bar":"R","horizontal-scroll-bar-content":"a","context-menu":"n","bottom-bar":"I","bottom-bar-text":"Z"};var ne=class{constructor(e){this.listeners=[];this.setState=e=>{this.state=e,this.emitChange()};this.mergeState=e=>{let t={...this.state,...e};ho(t,this.state)||(this.state=t,this.emitChange())};this.subscribe=e=>(this.listeners=[...this.listeners,e],()=>{this.listeners=this.listeners.filter(t=>t!==e)});this.getSnapshot=()=>this.state;this.state=e}emitChange(){for(let e of this.listeners)e()}};var vt=new ne([]);var yi={value:"",formula:"",row:0,col:0,left:J,top:J,width:0,height:0,defineName:"",isMergeCell:!1,rowCount:1,colCount:1,tabColor:"",sheetId:""},te=new ne(yi);var W=new ne({editorStatus:0,canRedo:!1,canUndo:!1,activeUuid:""});var tt=new ne(Yr());var De=new ne({scrollTop:0,scrollLeft:0});var xt=new ne([]);var Ce=E(N());var jo=new Map;function rn(o,e){let t=`${e}__${o.font}`;if(jo.has(t))return jo.get(t);let r=o.measureText(e),{actualBoundingBoxAscent:n,actualBoundingBoxDescent:i}=r,s=n+i,a=r.width,l=Math.ceil(a/q()),c=Math.ceil(s/q()),d={width:l,height:c};return jo.set(t,d),d}function oe(o,e,t,r,n){o.fillRect(T(e),T(t),T(r),T(n))}function rt(o,e,t,r,n){o.strokeRect(T(e),T(t),T(r),T(n))}function Xo(o,e,t,r,n){o.clearRect(T(e),T(t),T(r),T(n))}function ot(o,e,t,r){o.fillText(e,T(t),T(r))}function Vo(o,e,t,r,n,i,s){let a=[];if(t?.underline){let l=[],c=t?.underline===2,d=Math.floor(i+r);e?l=[[n-s,d],[n,d]]:l=[[n,d],[n+s,d]],a=a.concat(nn(l,c))}if(t?.isStrike){let l=[],c=Math.floor(i+r*.2);e?l=[[n-s,c],[n,c]]:l=[[n,c],[n+s,c]],a=a.concat(nn(l,!1))}je(o,a)}function Dt(o,e,t,r){let n={row:t,col:r,colCount:1,rowCount:1,sheetId:""},i=o.getCell(n),s={width:0,height:0};if(!i)return s;let a=o.getCellSize(n);if(a.width<=0||a.height<=0)return s;let l=o.computeCellPosition(n),c=bi(e,{...i,top:l.top,left:l.left,width:a.width,height:a.height});return s.height=Math.ceil(c.height),s.width=Math.ceil(c.width),s}function bi(o,e){let{style:t,value:r,left:n,top:i,width:s,height:a}=e,l={height:0,width:0};if(xe(e.value)&&xe(e.style))return l;let c=Or(r),d=Jt,h=L("contentColor"),p=t?.fontSize?t.fontSize:qt;xe(t)||(d=Lr(t?.isItalic?"italic":"normal",t?.isBold?"bold":"500",T(p),t?.fontFamily),h=t?.fontColor||L("contentColor"),t?.fillColor&&(o.fillStyle=t?.fillColor,oe(o,n,i,s,a)));let g=ro(r);Br.has(g)&&(h=L("errorFormulaColor"));let C=jr(g);if(C.length===0||(o.textAlign=c?"right":"left",o.font=d,o.fillStyle=h,o.textBaseline="middle",C.length===0))return l;t?.underline&&(o.strokeStyle=h);let u=Math.ceil(p*$e.lineHeight),m=Math.ceil(p*($e.lineHeight-1)/2),f=n+(c?s-m:m);if(l.height=u,t?.isWrapText){l.height=m*2;let b=i+l.height,x="",v=0,S=0;for(let y=0;y<C.length;y++){let I=x+C[y],k=rn(o,I);k.width>s?(b+=m,y===0?(v=k.width,S=k.height,ot(o,C[y],f,b),x=""):(ot(o,x,f,b),x=C[y]),Vo(o,c,t,S,f,b,v),b+=S+m,l.height+=S+m*2,l.width=Math.max(v,l.width)):(v=k.width,S=k.height,x=I)}x&&(l.height+=S+m,l.width=Math.max(v,l.width),ot(o,x,f,b),Vo(o,c,t,S,f,b,v)),l.width+=m*2}else{let b="",x=0,v=0;for(let I=0;I<C.length;I++){let k=b+C[I],D=rn(o,k);if(D.width>s){I===0&&(x=D.width,v=D.height,b=k);break}else x=D.width,v=D.height,b=k}let S=v>a?v:a,y=i+S/2;l.height=v,ot(o,b,f,y),Vo(o,c,t,v,f,y,x),l.width=x+m*2}return l}function je(o,e){if(e.length!==0){o.beginPath();for(let t=0;t<e.length;t+=2){let r=e[t],n=e[t+1];o.moveTo(T(r[0]),T(r[1])),o.lineTo(T(n[0]),T(n[1]))}o.stroke()}}function sn(o,e,t,r){o.beginPath(),o.moveTo(T(e[0]),T(e[1])),o.lineTo(T(t[0]),T(t[1])),o.lineTo(T(r[0]),T(r[1])),o.fill()}function ln(o,e,t,r,n){let i=o.getLineDash();o.setLineDash([T(8),T(6)]);let s=q()/2;rt(o,e+s,t+s,r-s*2,n-s*2),o.setLineDash(i)}function nn(o,e){let[t,r]=o,n=q(),i=[[t[0],t[1]-n],[r[0],r[1]-n]];if(e){let s=n*2;i.push([t[0],t[1]-s],[r[0],r[1]-s])}return i}function po(o,e,t){o.style.width=`${e}px`,o.style.height=`${t}px`;let r=T(e),n=T(t);o.width=r,o.height=n}function Ko(){return{textAlign:"center",textBaseline:"middle",font:Jt,fillStyle:L("black"),lineWidth:ft(),strokeStyle:L("borderColor")}}var Ht=class{constructor(e,t){this.isRendering=!1;this.render=e=>{if(e.changeSet.size===0)return;if(this.isRendering){Ct("It is rendering");return}this.isRendering=!0,this.content.render(e),this.clear(),this.ctx.drawImage(this.content.getCanvas(),0,0);let{width:t,height:r}=this.controller.getDomRect(),n=this.controller.getHeaderSize(),i=t-n.width,s=r-n.height;this.renderGrid(i,s),this.renderRowsHeader(s),this.renderColsHeader(i),this.renderTriangle();let a=this.renderSelection();this.renderAntLine(a),this.renderMergeCell(),this.isRendering=!1};let r=e.getMainDom().canvas;this.controller=e,this.ctx=r.getContext("2d"),this.content=t;let n=q();this.ctx.scale(n,n)}resize(){let e=this.controller.getDomRect(),{width:t,height:r}=e;po(this.ctx.canvas,t,r),this.content.resize()}clear(){let{width:e,height:t}=this.controller.getDomRect();this.ctx.clearRect(0,0,T(e),T(t))}renderMergeCell(){let{controller:e}=this,t=e.getActiveCell(),r=e.getMergeCells(e.getCurrentSheetId());if(r.length!==0)for(let n of r){let i=e.computeCellPosition(n),s=e.getCellSize(n);s.width<=0||s.height<=0||(Xo(this.ctx,i.left,i.top,s.width,s.height),Dt(e,this.ctx,n.row,n.col),!(Pt(t)||so(t)||lo(t))&&co(t.row,t.col,n)&&(this.ctx.strokeStyle=L("primaryColor"),this.ctx.lineWidth=q(),rt(this.ctx,i.left,i.top,s.width,s.height)))}}renderGrid(e,t){let{controller:r}=this,n=r.getHeaderSize(),{row:i,col:s}=r.getScroll(),{rowCount:a,colCount:l}=this.controller.getSheetInfo(this.controller.getCurrentSheetId()),c=ft();this.ctx.save(),this.ctx.fillStyle=L("white"),this.ctx.lineWidth=c,this.ctx.strokeStyle=L("borderColor"),this.ctx.translate(T(n.width),T(n.height));let d=[],h=0,p=0,g=0;for(let m=s;m<l&&(g+=r.getColWidth(m).len,!(g>e));m++);let C=Math.min(g,e),u=!1;for(let m=i;m<a;m++){u?u=!1:d.push([0,h],[C,h]);let f=r.getRowHeight(m).len;if(f===0&&(u=!0),h+=f,h>t)break}for(let m=s;m<l;m++){u?u=!1:d.push([p,0],[p,h]);let f=r.getColWidth(m).len;if(f===0&&(u=!0),p+=f,p>C)break}d.push([0,h],[p,h]),d.push([p,0],[p,h]),je(this.ctx,d),this.ctx.restore()}isHighlightRow(e,t,r){return Pt(t)||lo(t)||r>=t.row&&r<t.row+t.rowCount?!0:e.some(n=>r>=n.row&&r<n.row+n.rowCount)}isHighlightCol(e,t,r){return Pt(t)||so(t)||r>=t.col&&r<t.col+t.colCount?!0:e.some(n=>r>=n.col&&r<n.col+n.colCount)}renderRowsHeader(e){let{controller:t}=this,{row:r}=t.getScroll(),n=t.getHeaderSize(),{rowCount:i}=t.getSheetInfo(t.getCurrentSheetId()),s=t.getMergeCells(t.getCurrentSheetId());this.ctx.save();let a=this.controller.getActiveCell();this.ctx.fillStyle=L("white"),oe(this.ctx,0,n.height,n.width,e),Object.assign(this.ctx,Ko());let l=[],c=n.height,d=r;for(;d<i;d++){let h=t.getRowHeight(d).len,p=c;if(d===r&&(p+=ft()/2),l.push([0,p],[n.width,p]),h>0){let g=this.isHighlightRow(s,a,d);this.ctx.fillStyle=g?L("primaryColor"):L("black"),ot(this.ctx,String(d+1),n.width/2,p+h/2)}if(c+=h,c>e)break}l.push([0,c],[n.width,c]),l.push([0,0],[0,c]),je(this.ctx,l),this.ctx.restore()}renderColsHeader(e){let{controller:t}=this,{col:r}=t.getScroll(),n=t.getHeaderSize(),{colCount:i}=t.getSheetInfo(t.getCurrentSheetId()),s=t.getMergeCells(t.getCurrentSheetId()),a=this.controller.getActiveCell(),l=[];this.ctx.save(),this.ctx.fillStyle=L("white"),oe(this.ctx,n.width,0,e,n.height),Object.assign(this.ctx,Ko());let c=n.width,d=r;for(;d<i;d++){let h=t.getColWidth(d).len,p=c;if(d===r&&(p+=ft()/2),l.push([p,0],[p,n.height]),h>0){let g=this.isHighlightCol(s,a,d);this.ctx.fillStyle=g?L("primaryColor"):L("black"),ot(this.ctx,io(d),p+h/2,n.height/2+q())}if(c+=h,c>e)break}l.push([c,0],[c,n.height]),l.push([0,0],[c,0]),je(this.ctx,l),this.ctx.restore()}renderTriangle(){let e=this.controller.getHeaderSize();this.ctx.save(),this.ctx.fillStyle=L("white"),oe(this.ctx,0,0,e.width,e.height),this.ctx.fillStyle=L("triangleFillColor");let t=2,r=Math.floor(t),n=Math.floor(e.height-t),i=Math.floor(e.width*.4),s=Math.floor(e.width-t);sn(this.ctx,[s,r],[i,n],[s,n]),this.ctx.restore()}renderAntLine(e){let{controller:t}=this,r=t.getCopyRanges();if(r.length===0)return;let[n]=r;n.sheetId===t.getCurrentSheetId()&&(Ct("render canvas ant line"),this.ctx.strokeStyle=L("primaryColor"),this.ctx.lineWidth=q(),ln(this.ctx,e.left,e.top,e.width,e.height))}renderSelection(){let{controller:e}=this,t=e.getActiveCell();return Ct("render canvas selection"),Pt(t)?this.renderSelectAll():lo(t)?this.renderSelectCol():so(t)?this.renderSelectRow():this.renderSelectRange()}renderActiveCell(){let{controller:e}=this,t=e.getActiveCell();if(t.rowCount===t.colCount&&t.rowCount===1)return;let r={row:t.row,col:t.col,rowCount:1,colCount:1,sheetId:""},n=e.computeCellPosition(r),i=e.getCellSize(r);Xo(this.ctx,n.left,n.top,i.width,i.height),Dt(e,this.ctx,t.row,t.col)}renderSelectRange(){let{controller:e}=this,t=e.getHeaderSize(),r=e.getActiveCell(),n=e.computeCellPosition({row:r.row,col:r.col,rowCount:1,colCount:1,sheetId:""}),i=r.row+r.rowCount-1,s=r.col+r.colCount-1,a={row:i,col:s,rowCount:1,colCount:1,sheetId:""},l=e.computeCellPosition(a),c=e.getCellSize(a),d=l.left+c.width-n.left,h=l.top+c.height-n.top;this.ctx.fillStyle=L("selectionColor"),oe(this.ctx,n.left,0,d,t.height),oe(this.ctx,0,n.top,t.width,h);let p=r.rowCount>1||r.colCount>1;p&&oe(this.ctx,n.left,n.top,d,h),this.ctx.strokeStyle=L("primaryColor"),this.ctx.lineWidth=q();let g=[[n.left,t.height],[n.left+d,t.height]];return g.push([t.width,n.top],[t.width,n.top+h]),je(this.ctx,g),p&&this.renderActiveCell(),rt(this.ctx,n.left,n.top,d,h),{left:n.left,top:n.top,width:d,height:h}}renderSelectAll(){let{controller:e}=this,{width:t,height:r}=this.controller.getDomRect();this.ctx.fillStyle=L("selectionColor"),oe(this.ctx,0,0,t,r);let n=e.getHeaderSize();return this.ctx.strokeStyle=L("primaryColor"),this.ctx.lineWidth=q(),this.renderActiveCell(),rt(this.ctx,n.width,n.height,t,r),{left:n.width,top:n.height,width:t,height:r}}renderSelectCol(){let{controller:e}=this,t=e.getHeaderSize(),r=e.getActiveCell(),{height:n}=e.getDomRect();this.ctx.fillStyle=L("selectionColor");let i=e.computeCellPosition({row:r.row,col:r.col,colCount:1,rowCount:1,sheetId:""}),s=0;for(let l=r.col,c=r.col+r.colCount;l<c;l++)s+=e.getColWidth(l).len;oe(this.ctx,i.left,0,s,t.height),oe(this.ctx,0,i.top,t.width,n),oe(this.ctx,i.left,i.top,s,n),this.ctx.strokeStyle=L("primaryColor"),this.ctx.lineWidth=q();let a=[[t.width,t.height],[t.width,n]];return je(this.ctx,a),this.renderActiveCell(),rt(this.ctx,i.left,i.top,s,n),{left:i.left,top:i.top,width:s,height:n}}renderSelectRow(){let{controller:e}=this,t=e.getHeaderSize(),r=e.getActiveCell(),{width:n}=e.getDomRect();this.ctx.fillStyle=L("selectionColor");let i=e.computeCellPosition({row:r.row,col:r.col,colCount:1,rowCount:1,sheetId:""}),s=0;for(let l=r.row,c=r.row+r.rowCount;l<c;l++)s+=e.getRowHeight(l).len;oe(this.ctx,i.left,0,n,t.height),oe(this.ctx,0,i.top,t.width,s),oe(this.ctx,i.left,i.top,n,s),this.ctx.strokeStyle=L("primaryColor"),this.ctx.lineWidth=q();let a=[[i.left,t.height],[n,t.height]];return je(this.ctx,a),this.renderActiveCell(),rt(this.ctx,i.left,i.top,n,s),{left:i.left,top:i.top,width:n,height:s}}};function mo(o){Ve(o),o.setNextActiveCell("right"),fo(o)}function uo(o){Ve(o),o.setNextActiveCell("down"),fo(o)}function go(o,e,t){let r=o.getScroll(),{row:n,col:i}=r;if(r.top!==t){n=0;let s=t;for(;s>0;){let a=o.getRowHeight(n).len;if(a>s)break;s-=a,n++}}if(r.left!==e){i=0;let s=e;for(;s>0;){let a=o.getColWidth(i).len;if(a>s)break;s-=a,i++}}return{row:n,col:i}}function Bt(o,e,t){let r=o.getDomRect(),n=o.getViewSize(),i=n.height-r.height+Wo,s=n.width-r.width+Wo,a=r.height-gt*1,l=r.width-gt*1,c=Math.floor(t*a/i),d=Math.floor(e*l/s);return{maxHeight:i,maxWidth:s,maxScrollHeight:a,maxScrollWidth:l,scrollTop:c,scrollLeft:d}}function He(o,e,t){let r=o.getScroll(),{maxHeight:n,maxWidth:i,maxScrollHeight:s,maxScrollWidth:a}=Bt(o,r.left,r.top),l=r.top+Math.ceil(t);l<0?l=0:l>n&&(l=n);let c=r.left+Math.ceil(e);c<0?c=0:c>i&&(c=i);let{row:d,col:h}=go(o,c,l),p=Math.floor(l*s/n),g=Math.floor(c*a/i);o.setScroll({row:d,col:h,top:l,left:c,scrollTop:p,scrollLeft:g})}function fo(o){let e=o.getActiveCell(),t={row:e.row,col:e.col,colCount:1,rowCount:1,sheetId:""},r=o.computeCellPosition(t),n=o.getCellSize(t),i=o.getDomRect(),s=o.getScroll(),a=o.getSheetInfo(o.getCurrentSheetId()),l=o.getHeaderSize(),c=5,{maxHeight:d,maxWidth:h,maxScrollHeight:p,maxScrollWidth:g}=Bt(o,s.left,s.top);if(r.left+n.width+c>i.width&&s.col<=a.colCount-2){let C=s.col+1,u=s.left+o.getColWidth(s.col).len,m=Math.floor(u*g/h);o.setScroll({...s,col:C,left:u,scrollLeft:m})}if(r.left-l.width<i.left+c&&s.col>=1){let C=s.col-1,u=s.left-o.getColWidth(s.col).len,m=Math.floor(u*g/h);o.setScroll({...s,col:C,left:u,scrollLeft:m})}if(r.top+n.height+c>i.height&&s.row<=a.rowCount-2){let C=s.row+1,u=s.top+o.getRowHeight(s.row).len,m=Math.floor(u*p/d);o.setScroll({...s,row:C,top:u,scrollTop:m})}if(r.top-l.height<i.top+c&&s.row>=1){let C=s.row-1,u=s.top-o.getRowHeight(s.row).len,m=Math.floor(u*p/d);o.setScroll({...s,row:C,top:u,scrollTop:m})}}function _(o){let e=o.getMainDom()?.input;return e?document.activeElement===e:!1}function Co(o){let e=o.getMainDom().input;o.setCellValues([[e.value]],[],[o.getActiveRange().range]),e.value="",e.blur(),W.mergeState({editorStatus:0})}function Ve(o){return _(o)?(Co(o),!0):!1}var an=[{key:"Enter",modifierKey:[],handler:uo},{key:"Tab",modifierKey:[],handler:mo},{key:"ArrowDown",modifierKey:[be()?"meta":"ctrl"],handler:o=>{if(_(o))return;Ve(o);let e=o.getViewSize();He(o,0,e.height)}},{key:"ArrowUp",modifierKey:[be()?"meta":"ctrl"],handler:o=>{if(_(o))return;Ve(o);let e=o.getViewSize();He(o,0,-e.height)}},{key:"ArrowRight",modifierKey:[be()?"meta":"ctrl"],handler:o=>{if(_(o))return;Ve(o);let e=o.getViewSize();He(o,e.width,0)}},{key:"ArrowLeft",modifierKey:[be()?"meta":"ctrl"],handler:o=>{if(_(o))return;Ve(o);let e=o.getViewSize();He(o,-e.width,0)}},{key:"ArrowDown",modifierKey:[],handler:o=>{_(o)||uo(o)}},{key:"ArrowUp",modifierKey:[],handler:o=>{_(o)||(Ve(o),o.setNextActiveCell("up"),fo(o))}},{key:"ArrowRight",modifierKey:[],handler:o=>{_(o)||mo(o)}},{key:"ArrowLeft",modifierKey:[],handler:o=>{_(o)||(Ve(o),o.setNextActiveCell("left"),fo(o))}},{key:"b",modifierKey:[be()?"meta":"ctrl"],handler:o=>{if(_(o))return;let e=o.getCell(o.getActiveCell());o.updateCellStyle({isBold:!e?.style?.isBold},[o.getActiveCell()])}},{key:"i",modifierKey:[be()?"meta":"ctrl"],handler:o=>{if(_(o))return;let e=o.getCell(o.getActiveCell());o.updateCellStyle({isItalic:!e?.style?.isItalic},[o.getActiveCell()])}},{key:"5",modifierKey:[be()?"meta":"ctrl"],handler:o=>{if(_(o))return;let e=o.getCell(o.getActiveCell());o.updateCellStyle({isStrike:!e?.style?.isStrike},[o.getActiveCell()])}},{key:"u",modifierKey:[be()?"meta":"ctrl"],handler:o=>{if(_(o))return;let t=o.getCell(o.getActiveCell())?.style?.underline,r=0;t===void 0||t===0?r=1:r=0,o.updateCellStyle({underline:r},[o.getActiveCell()])}},{key:"z",modifierKey:[be()?"meta":"ctrl"],handler:o=>{o.undo()}},{key:"y",modifierKey:[be()?"meta":"ctrl"],handler:o=>{o.redo()}}];function yo(o){let e=(o?.target?.tagName||"").toLowerCase();return e==="input"||e==="textarea"}function Go(o,e){function t(l){if(yo(l))return;let c=an.filter(h=>h.key===l.key);c.sort((h,p)=>p.modifierKey.length-h.modifierKey.length);let d=null;for(let h of c)if(h.modifierKey.length>0){if(h.modifierKey.some(p=>l[`${p}Key`])){d=h;break}}else{d=h;break}if(d){l.preventDefault(),d.handler(o);return}l.metaKey||l.ctrlKey||(W.mergeState({editorStatus:1}),o.getMainDom().input?.focus())}let r=$r(l=>{l.target===o.getMainDom().canvas&&He(o,l.deltaX,l.deltaY)},1e3/60);function n(l){yo(l)||(l.preventDefault(),o.paste(l))}function i(l){yo(l)||(l.preventDefault(),o.copy(l))}function s(l){yo(l)||(l.preventDefault(),o.cut(l))}function a(){e(new Set(["row"]))}return window.addEventListener("resize",a),document.body.addEventListener("keydown",t),document.body.addEventListener("wheel",r),document.body.addEventListener("paste",n),document.body.addEventListener("copy",i),document.body.addEventListener("cut",s),()=>{window.removeEventListener("resize",a),document.body.removeEventListener("keydown",t),document.body.removeEventListener("wheel",r),document.body.removeEventListener("paste",n),document.body.removeEventListener("copy",i),document.body.removeEventListener("cut",s)}}var Ot=class{constructor(e,t){this.controller=e;let r=t.getContext("2d");this.ctx=r;let n=q();this.ctx.scale(n,n)}getCanvas(){return this.ctx.canvas}resize(){let{width:e,height:t}=this.controller.getDomRect();po(this.ctx.canvas,e,t)}render({changeSet:e}){e.size===0||!(e.has("row")||e.has("col")||e.has("sheetList")||e.has("sheetId")||e.has("cellStyle")||e.has("cellValue")||e.has("scroll"))||(Ct("render canvas content"),this.clear(),this.renderContent())}clear(){let{width:e,height:t}=this.controller.getDomRect();this.ctx.clearRect(0,0,T(e),T(t))}renderContent(){let{controller:e,ctx:t}=this,{width:r,height:n}=e.getDomRect(),i=e.getHeaderSize(),{row:s,col:a}=e.getScroll(),l=i.width,c=a,d=i.height,h=s;for(;l+e.getColWidth(c).len<r;)l+=e.getColWidth(c).len,c++;for(;d+e.getRowHeight(h).len<n;)d+=e.getRowHeight(h).len,h++;let p=h,g=c;t.save();let C=new Map,u=new Map;for(let m=s;m<p;m++)for(let f=a;f<g;f++){let b=Dt(e,t,m,f);C.set(m,Math.max(C.get(m)||0,Ye,b.height)),u.set(f,Math.max(u.get(f)||0,qe,b.width))}for(let[m,f]of C.entries())f<=0||e.setRowHeight(m,f,!1);for(let[m,f]of u.entries())f<=0||e.setColWidth(m,f,!1);t.restore()}};function cn(o,e,t){let r=o.getScroll(),{maxHeight:n,maxScrollHeight:i,maxScrollWidth:s,maxWidth:a}=Bt(o,r.left,r.top),l=r.scrollTop+Math.ceil(t),c=r.scrollLeft+Math.ceil(e);l<0?l=0:l>i&&(l=i),c<0?c=0:c>s&&(c=s);let d=Math.floor(n*l/i),h=Math.floor(a*c/s),{row:p,col:g}=go(o,h,d),C={top:d,left:h,row:p,col:g,scrollLeft:c,scrollTop:l};o.setScroll(C)}var Qo=({controller:o})=>{let e=(0,Ce.useRef)({prevPageX:0,prevPageY:0,scrollStatus:0}),{scrollLeft:t,scrollTop:r}=(0,Ce.useSyncExternalStore)(De.subscribe,De.getSnapshot);function n(a){a.buttons===1&&(a.stopPropagation(),e.current.scrollStatus===1?(e.current.prevPageY&&cn(o,0,a.pageY-e.current.prevPageY),e.current.prevPageY=a.pageY):e.current.scrollStatus===2&&(e.current.prevPageX&&cn(o,a.pageX-e.current.prevPageX,0),e.current.prevPageX=a.pageX))}function i(){e.current.scrollStatus=0,e.current.prevPageY=0,e.current.prevPageX=0,document.removeEventListener("pointermove",n),document.removeEventListener("pointerup",i)}function s(a,l){a.buttons===1&&(e.current.scrollStatus||(e.current.scrollStatus=l,document.addEventListener("pointermove",n),document.addEventListener("pointerup",i)))}return Ce.default.createElement(Ce.Fragment,null,Ce.default.createElement("div",{className:re["vertical-scroll-bar"],"data-testid":"vertical-scroll-bar",onPointerLeave:i,onPointerDown:a=>{s(a,1)}},Ce.default.createElement("div",{className:re["vertical-scroll-bar-content"],style:{height:gt,transform:`translateY(${r}px)`}})),Ce.default.createElement("div",{className:re["horizontal-scroll-bar"],"data-testid":"horizontal-scroll-bar",onPointerLeave:i,onPointerDown:a=>{s(a,2)}},Ce.default.createElement("div",{className:re["horizontal-scroll-bar-content"],style:{width:gt,transform:`translateX(${t}px)`}})))};Qo.displayName="ScrollBar";var H=E(N());var dn=E(N());var nt={buttonWrapper:"r",circle:"j",disabled:"B",active:"A",plain:"F",primary:"H"};var w=o=>{let{className:e="",onClick:t=()=>{},disabled:r=!1,active:n=!1,type:i="normal",style:s={},testId:a=void 0,title:l,dataType:c,buttonType:d,children:h}=o,p=A(nt.buttonWrapper,e,{[nt.disabled]:r,[nt.active]:n,[nt.circle]:i==="circle",[nt.plain]:i==="plain",[nt.primary]:i==="primary"});return dn.default.createElement("button",{onClick:t,style:s,title:l,className:p,"data-testid":a,"data-type":c,type:d},h)};w.displayName="Button";var St=E(N());var hn={githubWrapper:"S"};var pn={transformOrigin:"130px 106px"},Zo=()=>St.default.createElement("a",{href:"https://github.com/nusr/excel","aria-label":"View source on Github",target:"_blank",title:"github link",rel:"noreferrer"},St.default.createElement("svg",{className:hn.githubWrapper,viewBox:"0 0 250 250","aria-hidden":!0},St.default.createElement("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}),St.default.createElement("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:pn}),St.default.createElement("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",style:pn})));Zo.displayName="Github";var wi={alignCenter:["M142.2 227.6h739.6v56.9H142.2zM142.2 568.9h739.6v56.9H142.2zM256 398.2h512v56.9H256zM256 739.6h512v56.9H256z"],alignLeft:["M627.712 788.48c11.305 0 20.48-9.155 20.48-20.48s-9.175-20.48-20.48-20.48H218.46c-11.305 0-20.48 9.155-20.48 20.48s9.175 20.48 20.48 20.48h409.252zM832.86 583.68h-614.4c-11.305 0-20.48 9.155-20.48 20.48s9.175 20.48 20.48 20.48h614.4c11.305 0 20.48-9.155 20.48-20.48s-9.175-20.48-20.48-20.48zM832.86 256h-614.4c-11.305 0-20.48 9.155-20.48 20.48s9.175 20.48 20.48 20.48h614.4c11.305 0 20.48-9.155 20.48-20.48S844.165 256 832.86 256zM218.46 460.8h409.252c11.305 0 20.48-9.155 20.48-20.48s-9.175-20.48-20.48-20.48H218.46c-11.305 0-20.48 9.155-20.48 20.48s9.155 20.48 20.48 20.48z"],alignRight:["M832.86 747.52H423.588a20.48 20.48 0 1 0 0 40.96H832.84a20.48 20.48 0 0 0 0.02-40.96z m20.48-143.36a20.48 20.48 0 0 0-20.48-20.48h-614.4a20.48 20.48 0 1 0 0 40.96h614.4a20.48 20.48 0 0 0 20.48-20.48zM832.86 256h-614.4a20.48 20.48 0 1 0 0 40.96h614.4a20.48 20.48 0 1 0 0-40.96z m0 163.84H423.588a20.48 20.48 0 1 0 0 40.96H832.84a20.48 20.48 0 0 0 0.02-40.96z"],bold:["M724.342857 477.028571c38.4-40 61.942857-94.057143 61.942857-153.485714v-11.657143C786.285714 188.914286 685.6 89.142857 561.485714 89.142857H223.314286c-17.257143 0-31.314286 14.057143-31.314286 31.314286v776.114286c0 18.628571 15.085714 33.714286 33.714286 33.714285h364.228571c133.714286 0 242.057143-107.657143 242.057143-240.571428v-12.571429c0-83.428571-42.742857-156.914286-107.657143-200.114286zM301.714286 198.857143h256.8c65.257143 0 118.057143 50.742857 118.057143 113.485714v10.857143c0 62.628571-52.914286 113.485714-118.057143 113.485714H301.714286V198.857143z m418.971428 490.742857c0 71.885714-59.085714 130.171429-132 130.171429H301.714286V547.085714h286.971428c72.914286 0 132 58.285714 132 130.171429v12.342857z"],fontColor:["M650.496 597.333333H373.504l-68.266667 170.666667H213.333333l256-640h85.333334l256 640h-91.904l-68.266667-170.666667z m-34.133333-85.333333L512 251.093333 407.637333 512h208.725334zM128 853.333333h768v85.333334H128v-85.333334z"],italic:["M219.428571 949.714286l9.714286-48.571429q3.428571-1.142857 46.571429-12.285714t63.714286-21.428571q16-20 23.428571-57.714286 0.571429-4 35.428571-165.142857t65.142857-310.571429 29.714286-169.428571l0-14.285714q-13.714286-7.428571-31.142857-10.571429t-39.714286-4.571429-33.142857-3.142857l10.857143-58.857143q18.857143 1.142857 68.571429 3.714286t85.428571 4 68.857143 1.428571q27.428571 0 56.285714-1.428571t69.142857-4 56.285714-3.714286q-2.857143 22.285714-10.857143 50.857143-17.142857 5.714286-58 16.285714t-62 19.142857q-4.571429 10.857143-8 24.285714t-5.142857 22.857143-4.285714 26-3.714286 24q-15.428571 84.571429-50 239.714286t-44.285714 203.142857q-1.142857 5.142857-7.428571 33.142857t-11.428571 51.428571-9.142857 47.714286-3.428571 32.857143l0.571429 10.285714q9.714286 2.285714 105.714286 17.714286-1.714286 25.142857-9.142857 56.571429-6.285714 0-18.571429 0.857143t-18.571429 0.857143q-16.571429 0-49.714286-5.714286t-49.142857-5.714286q-78.857143-1.142857-117.714286-1.142857-29.142857 0-81.714286 5.142857t-69.142857 6.285714z"],middleAlign:["M740.43392 788.48c11.30496 0 20.48-9.15456 20.48-20.48s-9.17504-20.48-20.48-20.48L331.18208 747.52c-11.30496 0-20.48 9.15456-20.48 20.48s9.17504 20.48 20.48 20.48L740.43392 788.48zM863.49824 604.16c0-11.32544-9.17504-20.48-20.48-20.48l-614.4 0c-11.30496 0-20.48 9.15456-20.48 20.48s9.17504 20.48 20.48 20.48l614.4 0C854.3232 624.64 863.49824 615.48544 863.49824 604.16zM208.13824 276.48c0 11.32544 9.17504 20.48 20.48 20.48l614.4 0c11.30496 0 20.48-9.15456 20.48-20.48s-9.17504-20.48-20.48-20.48l-614.4 0C217.2928 256 208.13824 265.15456 208.13824 276.48zM740.43392 460.8c11.30496 0 20.48-9.15456 20.48-20.48s-9.17504-20.48-20.48-20.48L331.18208 419.84c-11.30496 0-20.48 9.15456-20.48 20.48s9.17504 20.48 20.48 20.48L740.43392 460.8z"],plus:["M896 468.571429H555.428571V100.571429h-86.857142v368H128c-5.028571 0-9.142857 4.114286-9.142857 9.142857v68.571428c0 5.028571 4.114286 9.142857 9.142857 9.142857h340.571429v368h86.857142V555.428571h340.571429c5.028571 0 9.142857-4.114286 9.142857-9.142857v-68.571428c0-5.028571-4.114286-9.142857-9.142857-9.142857z"],redo:["M611.783111 569.344L549.622519 644.740741h284.444444l-65.498074-265.481482-59.922963 72.666074c-35.422815-28.48237-108.278519-68.342519-238.667852-68.342518-202.827852 0-280.651852 206.01363-280.651852 206.013629s116.318815-132.778667 246.215111-132.778666c97.204148-0.037926 153.865481 74.827852 176.241778 112.526222z"],underline:["M512 725.333333c166.4 0 298.666667-132.266667 298.666667-298.666666V128c0-25.6-17.066667-42.666667-42.666667-42.666667s-42.666667 17.066667-42.666667 42.666667v298.666667c0 119.466667-93.866667 213.333333-213.333333 213.333333s-213.333333-93.866667-213.333333-213.333333V128c0-25.6-17.066667-42.666667-42.666667-42.666667s-42.666667 17.066667-42.666667 42.666667v298.666667c0 166.4 132.266667 298.666667 298.666667 298.666666zM853.333333 853.333333H170.666667c-25.6 0-42.666667 17.066667-42.666667 42.666667s17.066667 42.666667 42.666667 42.666667h682.666666c25.6 0 42.666667-17.066667 42.666667-42.666667s-17.066667-42.666667-42.666667-42.666667z"],undo:["M489.244444 568.888889l60.681482 75.851852H265.481481l64.474075-265.481482 60.681481 72.05926c34.133333-30.340741 109.985185-68.266667 238.933333-68.266667 201.007407 0 280.651852 204.8 280.651852 204.8S792.651852 455.111111 663.703704 455.111111c-98.607407 0-155.496296 75.851852-174.45926 113.777778z"],success:["M666.272 472.288l-175.616 192a31.904 31.904 0 0 1-23.616 10.4h-0.192a32 32 0 0 1-23.68-10.688l-85.728-96a32 32 0 1 1 47.744-42.624l62.144 69.6 151.712-165.888a32 32 0 1 1 47.232 43.2m-154.24-344.32C300.224 128 128 300.32 128 512c0 211.776 172.224 384 384 384 211.68 0 384-172.224 384-384 0-211.68-172.32-384-384-384"],info:["M512 97.52381c228.912762 0 414.47619 185.563429 414.47619 414.47619s-185.563429 414.47619-414.47619 414.47619S97.52381 740.912762 97.52381 512 283.087238 97.52381 512 97.52381z m36.571429 341.333333h-73.142858v292.571428h73.142858V438.857143z m0-121.904762h-73.142858v73.142857h73.142858v-73.142857z"],warning:["M512 64q190.016 4.992 316.512 131.488T960 512q-4.992 190.016-131.488 316.512T512 960q-190.016-4.992-316.512-131.488T64 512q4.992-190.016 131.488-316.512T512 64z m0 192q-26.016 0-43.008 19.008T453.984 320l23.008 256q2.016 14.016 11.488 22.496t23.488 8.512 23.488-8.512 11.488-22.496l23.008-256q2.016-26.016-15.008-44.992T511.936 256z m0 512q22.016-0.992 36.512-15.008t14.496-36-14.496-36.512T512 665.984t-36.512 14.496-14.496 36.512 14.496 36T512 768z"],error:["M512 97.52381c228.912762 0 414.47619 185.563429 414.47619 414.47619s-185.563429 414.47619-414.47619 414.47619S97.52381 740.912762 97.52381 512 283.087238 97.52381 512 97.52381z m129.29219 233.447619l-129.267809 129.29219-129.316571-129.29219-51.736381 51.736381 129.316571 129.267809-129.316571 129.316571 51.736381 51.736381L512 563.687619l129.29219 129.316571 51.736381-51.73638L563.687619 512l129.316571-129.29219-51.73638-51.736381z"],rotate:["M934.08 416.448h-220.352a46.4 46.4 0 0 1-47.232-47.232c0-26.752 20.48-47.232 47.232-47.232h173.184V148.8c0-26.752 20.48-47.168 47.168-47.168 26.816 0 47.232 20.48 47.232 47.168V369.28a47.36 47.36 0 0 1-47.232 47.232z","M509.056 978.432A470.976 470.976 0 0 1 38.4 507.712 470.976 470.976 0 0 1 509.056 37.12a472.32 472.32 0 0 1 434.56 288.064c9.408 23.68-1.6 51.968-25.216 61.44-23.68 9.408-51.968-1.6-61.44-25.216a377.92 377.92 0 0 0-347.904-229.824 376.192 376.192 0 1 0 0 752.448c190.528 0 351.104-141.696 373.12-328.96a47.36 47.36 0 0 1 51.904-40.96 47.36 47.36 0 0 1 40.96 51.904 469.504 469.504 0 0 1-465.92 412.48z"],moon:["M735.996 244.2C693.136 221.106 644.1 208 592 208c-167.894 0-304 136.106-304 304s136.106 304 304 304c52.1 0 101.136-13.106 143.996-36.2C621.368 744.742 538 638.108 538 512s83.368-232.742 197.996-267.8z m26.32 86.064C683.17 354.472 628 427.888 628 512s55.168 157.528 134.318 181.736c76.442 23.378 86.74 127.376 16.37 165.294C721.764 889.702 657.958 906 592 906c-217.6 0-394-176.4-394-394S374.4 118 592 118c65.96 0 129.764 16.298 186.688 46.97 70.372 37.918 60.072 141.916-16.37 165.294z"],sun:["M512 768c-140.8 0-256-115.2-256-256s115.2-256 256-256 256 115.2 256 256-115.2 256-256 256z m0-426.666667c-93.866667 0-170.666667 76.8-170.666667 170.666667s76.8 170.666667 170.666667 170.666667 170.666667-76.8 170.666667-170.666667-76.8-170.666667-170.666667-170.666667zM512 170.666667c-25.6 0-42.666667-17.066667-42.666667-42.666667V42.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667v85.333333c0 25.6-17.066667 42.666667-42.666667 42.666667zM512 1024c-25.6 0-42.666667-17.066667-42.666667-42.666667v-85.333333c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667v85.333333c0 25.6-17.066667 42.666667-42.666667 42.666667zM238.933333 281.6c-12.8 0-21.333333-4.266667-29.866666-12.8L149.333333 209.066667c-17.066667-17.066667-17.066667-42.666667 0-59.733334s42.666667-17.066667 59.733334 0l59.733333 59.733334c17.066667 17.066667 17.066667 42.666667 0 59.733333-4.266667 8.533333-17.066667 12.8-29.866667 12.8zM844.8 887.466667c-12.8 0-21.333333-4.266667-29.866667-12.8l-59.733333-59.733334c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l59.733334 59.733333c17.066667 17.066667 17.066667 42.666667 0 59.733334-8.533333 8.533333-21.333333 12.8-29.866667 12.8zM128 554.666667H42.666667c-25.6 0-42.666667-17.066667-42.666667-42.666667s17.066667-42.666667 42.666667-42.666667h85.333333c25.6 0 42.666667 17.066667 42.666667 42.666667s-17.066667 42.666667-42.666667 42.666667zM981.333333 554.666667h-85.333333c-25.6 0-42.666667-17.066667-42.666667-42.666667s17.066667-42.666667 42.666667-42.666667h85.333333c25.6 0 42.666667 17.066667 42.666667 42.666667s-17.066667 42.666667-42.666667 42.666667zM179.2 887.466667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733334l59.733334-59.733333c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-59.733333 59.733334c-8.533333 8.533333-17.066667 12.8-29.866667 12.8zM785.066667 281.6c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l59.733333-59.733334c17.066667-17.066667 42.666667-17.066667 59.733334 0s17.066667 42.666667 0 59.733334l-59.733334 59.733333c-8.533333 8.533333-21.333333 12.8-29.866666 12.8z"]},mn=wi;var un={baseIcon:"L"};var Yo=E(N()),zt=({className:o="",paths:e=[],fill:t="currentcolor"})=>Yo.default.createElement("svg",{fill:t,className:A(un.baseIcon,o),viewBox:"0 0 1137 1024","aria-hidden":!0},e.map((r,n)=>Yo.default.createElement("path",{d:r.d,key:n,fillOpacity:r["fill-opacity"]})));zt.displayName="BaseIcon";var bo=({fill:o})=>zt({fill:o,paths:[{d:"M0 0h1024v1024H0z","fill-opacity":".01"},{d:"M496.512 32a128 128 0 0 1 127.84 121.6l0.16 6.4-0.032 113.504 264.256 264.256a32 32 0 0 1-8.16 51.2l-144.064 72.96-269.12 269.12a64 64 0 0 1-90.496 0l-294.144-294.176a64 64 0 0 1 0-90.496l286.016-286.08-0.192-2.048-0.064-2.08V160a128 128 0 0 1 128-128z m-6.464 197.568L128 591.616l294.144 294.144 276.32-276.32 113.792-57.632-187.776-187.776V416a32 32 0 0 1-28.256 31.776l-3.712 0.224a32 32 0 0 1-31.808-28.256L560.512 416l-0.032-115.968-70.432-70.464z m402.016 395.936l1.792 2.24 5.472 8.416c30.112 46.752 45.184 80.032 45.184 99.84a64 64 0 1 1-128 0c0-20.96 16.864-57.024 50.624-108.224a16 16 0 0 1 24.928-2.24zM496.512 96a64 64 0 0 0-63.84 59.2l-0.16 4.8-0.032 36.576 34.944-34.88a32 32 0 0 1 45.248 0l47.808 47.808V160a64 64 0 0 0-59.2-63.84L496.48 96z"}]});bo.displayName="FillColorIcon";var de=({name:o,className:e="",fill:t})=>{let r=mn[o].map(n=>({d:n}));return zt({className:e,paths:r,fill:t})};de.displayName="Icon";var qo=E(N());var vo={selectList:"M",selectItem:"e",disabled:"l"};var Be=o=>{let{data:e,value:t,style:r={},onChange:n,getItemStyle:i=()=>({}),title:s,defaultValue:a}=o;return qo.default.createElement("select",{onChange:c=>{n(c.currentTarget.value)},value:t,style:r,defaultValue:a,name:"select",className:vo.selectList,title:s},e.map(c=>{let d=typeof c=="object"?c.value:c,h=typeof c=="object"?c.label:c,p=typeof c=="object"?c.disabled:!1,g=i(d),C=A(vo.selectItem,{[vo.disabled]:p});return qo.default.createElement("option",{key:d,value:d,disabled:!!p,className:C,style:g},h)}))};Be.displayName="Select";var Oe=E(N()),Cn=E(Jo()),yn=E(xo());var it={"dialog-modal":"U","dialog-container":"Y","dialog-title":"q","dialog-content":"D","dialog-button":"E","dialog-cancel":"G"};var bn=o=>{let{children:e,title:t,dialogStyle:r,onCancel:n,onOk:i,visible:s,getContainer:a=()=>document.body}=o;return s?(0,Cn.createPortal)(Oe.default.createElement("div",{className:A(it["dialog-modal"])},Oe.default.createElement("div",{className:it["dialog-container"],style:r},Oe.default.createElement("div",{className:it["dialog-title"]},t),Oe.default.createElement("div",{className:it["dialog-content"]},e),Oe.default.createElement("div",{className:it["dialog-button"]},Oe.default.createElement(w,{onClick:n},"Cancel"),Oe.default.createElement(w,{onClick:i,className:it["dialog-cancel"],type:"primary"},"Confirm")))),a()):null};bn.displayName="Dialog";function Xe(o){let e=document.createDocumentFragment(),t=null;function r(){t?.unmount(),t=null}function n(s){t=t||(0,yn.createRoot)(e),t.render(Oe.default.createElement(bn,{visible:s.visible,title:s.title,dialogStyle:s.dialogStyle,onCancel:a=>{a.stopPropagation(),s.onCancel&&s.onCancel(a),r()},onOk:a=>{a.stopPropagation(),s.onOk&&s.onOk(a),r()}},s.children))}function i(s){n(s)}return n(o),{close:r,update:i}}var he=E(N());var Pe={container:"J",portal:"K",menuContainer:"N",subMenuContainer:"O",menu:"Q",menuItem:"o"};var It=E(N());function we(o){let e=(0,It.useRef)(null),[t,r]=(0,It.useState)(!1);function n(i){e&&e.current&&(e.current.contains(i.target)?r(!1):(r(!0),o()))}return(0,It.useEffect)(()=>(document.addEventListener("pointerdown",n),()=>{document.removeEventListener("pointerdown",n)}),[]),[e,t]}var $o=E(N());function At(o){let e=(0,$o.useRef)(o),t=(0,$o.useRef)(r=>{e.current&&e.current(r)});return e.current=o,t.current}var wo=({onClick:o,children:e,testId:t})=>he.default.createElement("li",{className:Pe.menuItem,onClick:o,"data-testid":t},e),vn=({label:o,children:e,style:t,testId:r,className:n})=>{let[i,s]=(0,he.useState)(!1),a=()=>{s(l=>!l)};return he.default.createElement("li",{className:A(Pe.menuItem,n),onClick:a,"data-testid":r},he.default.createElement("div",null,o),i&&he.default.createElement("div",{className:A(Pe.subMenuContainer,Pe.portal),style:t},he.default.createElement("ul",{className:Pe.menu},e)))},xn=({menuButton:o,children:e,style:t,testId:r,className:n})=>{let[i,s]=(0,he.useState)(!1),a=()=>{s(c=>!c)},[l]=we(()=>s(!1));return he.default.createElement("div",{className:A(Pe.container,n),ref:l},he.default.createElement("div",{onClick:a,"data-testid":r},o),i&&he.default.createElement("div",{className:A(Pe.menuContainer,Pe.portal),style:t},he.default.createElement("ul",{className:Pe.menu},e)))};var Wt=E(N()),wn=E(xo());var st={container:"T",content:"V",toast:"W",icon:"X",success:"_",success_icon:"rr",error:"or",error_icon:"er",info:"ir",info_icon:"tr",warning:"dr",warning_icon:"ar"};var Ti=({message:o,type:e})=>Wt.default.createElement("div",{className:A(st.toast,st[e])},Wt.default.createElement(de,{name:e,className:A(st[`${e}_icon`],st.icon)}),Wt.default.createElement("div",{className:st.content},o));function kt(o){let{duration:e=3,...t}=o,r=document.createElement("div");r.className=st.container,document.body.appendChild(r);let n=(0,wn.createRoot)(r);n.render(Wt.default.createElement(Ti,{...t}));function i(){r&&(n.unmount(),document.body.removeChild(r),r=null)}return setTimeout(i,e*1e3),i}var tr=E(N());var er={container:"nr",loading:"lr",rotation:"s"};var or=()=>tr.default.createElement("div",{className:er.container},tr.default.createElement("div",{className:er.loading}));or.displayName="Loading";var ye=E(N());var ze={"color-picker":"b","color-picker-wrapper":"i",top:"sr",show:"br","color-picker-list":"gr","color-picker-item":"t","no-fill":"pr",reset:"cr"};var lt=E(N());var Vt=E(N());var Se=E(N());var Ke=(o,e=0,t=1)=>o>t?t:o<e?e:o;var ie={"color-picker-panel":"xr","color-picker-panel__saturation":"g","color-picker-panel__pointer-fill":"hr","color-picker-panel__hue":"p","color-picker-panel__last-control":"vr","color-picker-panel__interactive":"c","color-picker-panel__pointer":"x","color-picker-panel__saturation-pointer":"ur","color-picker-panel__hue-pointer":"fr"};var Ut=o=>"touches"in o,Ni=(o,e)=>{for(let t=0;t<o.length;t++)if(o[t].identifier===e)return o[t];return o[0]},rr=o=>o&&o.ownerDocument.defaultView||self,Sn=(o,e,t)=>{let r=o.getBoundingClientRect(),n=Ut(e)?Ni(e.touches,t):e;return{left:Ke((n.pageX-(r.left+rr(o).pageXOffset))/r.width),top:Ke((n.pageY-(r.top+rr(o).pageYOffset))/r.height)}},In=o=>{!Ut(o)&&o.preventDefault()},Mi=(o,e)=>e&&!Ut(o),Li=({onMove:o,onKey:e,...t})=>{let r=(0,Se.useRef)(null),n=At(o),i=At(e),s=(0,Se.useRef)(null),a=(0,Se.useRef)(!1),[l,c,d]=(0,Se.useMemo)(()=>{let h=({nativeEvent:m})=>{let f=r.current;if(f&&(In(m),!(Mi(m,a.current)||!f))){if(Ut(m)){a.current=!0;let b=m.changedTouches||[];b.length&&(s.current=b[0].identifier)}f.focus(),n(Sn(f,m,s.current)),u(!0)}},p=m=>{In(m),(Ut(m)?m.touches.length>0:m.buttons>0)&&r.current?n(Sn(r.current,m,s.current)):u(!1)},g=()=>u(!1),C=m=>{let f=m.which||m.keyCode;f<37||f>40||(m.preventDefault(),i({left:f===39?.05:f===37?-.05:0,top:f===40?.05:f===38?-.05:0}))};function u(m){let f=a.current,b=r.current,x=rr(b),v=m?x.addEventListener:x.removeEventListener;v(f?"touchmove":"mousemove",p),v(f?"touchend":"mouseup",g)}return[h,C,u]},[i,n]);return(0,Se.useEffect)(()=>d,[d]),Se.default.createElement("div",{...t,onTouchStart:l,onMouseDown:l,className:ie["color-picker-panel__interactive"],ref:r,onKeyDown:c,tabIndex:0,role:"slider"})},So=Se.default.memo(Li);var nr=E(N());var Io=({className:o,color:e,left:t,top:r=.5})=>{let n={top:`${r*100}%`,left:`${t*100}%`};return nr.default.createElement("div",{className:A(ie["color-picker-panel__pointer"],o),style:n},nr.default.createElement("div",{className:ie["color-picker-panel__pointer-fill"],style:{backgroundColor:e}}))};var j=(o,e=0,t=Math.pow(10,e))=>Math.round(t*o)/t;var Dc={grad:360/400,turn:360,rad:360/(Math.PI*2)},An=o=>zi(Di(o)),Di=o=>(o[0]==="#"&&(o=o.substring(1)),o.length<6?{r:parseInt(o[0]+o[0],16),g:parseInt(o[1]+o[1],16),b:parseInt(o[2]+o[2],16),a:o.length===4?j(parseInt(o[3]+o[3],16)/255,2):1}:{r:parseInt(o.substring(0,2),16),g:parseInt(o.substring(2,4),16),b:parseInt(o.substring(4,6),16),a:o.length===8?j(parseInt(o.substring(6,8),16)/255,2):1});var kn=o=>Oi(Bi(o)),Hi=({h:o,s:e,v:t,a:r})=>{let n=(200-e)*t/100;return{h:j(o),s:j(n>0&&n<200?e*t/100/(n<=100?n:200-n)*100:0),l:j(n/2),a:j(r,2)}},jt=o=>{let{h:e,s:t,l:r}=Hi(o);return`hsl(${e}, ${t}%, ${r}%)`};var Bi=({h:o,s:e,v:t,a:r})=>{o=o/360*6,e=e/100,t=t/100;let n=Math.floor(o),i=t*(1-e),s=t*(1-(o-n)*e),a=t*(1-(1-o+n)*e),l=n%6;return{r:j([t,s,i,i,a,t][l]*255),g:j([a,t,t,s,i,i][l]*255),b:j([i,i,a,t,t,s][l]*255),a:j(r,2)}};var Ao=o=>{let e=o.toString(16);return e.length<2?"0"+e:e},Oi=({r:o,g:e,b:t,a:r})=>{let n=r<1?Ao(j(r*255)):"";return"#"+Ao(o)+Ao(e)+Ao(t)+n},zi=({r:o,g:e,b:t,a:r})=>{let n=Math.max(o,e,t),i=n-Math.min(o,e,t),s=i?n===o?(e-t)/i:n===e?2+(t-o)/i:4+(o-e)/i:0;return{h:j(60*(s<0?s+6:s)),s:j(n?i/n*100:0),v:j(n/255*100),a:r}};var Wi=({className:o,hue:e,onChange:t})=>{let r=i=>{t({h:360*i.left})},n=i=>{t({h:Ke(e+i.left*360,0,360)})};return Vt.default.createElement("div",{className:A(ie["color-picker-panel__hue"],o)},Vt.default.createElement(So,{onMove:r,onKey:n,"aria-label":"Hue","aria-valuenow":j(e),"aria-valuemax":"360","aria-valuemin":"0"},Vt.default.createElement(Io,{className:ie["color-picker-panel__hue-pointer"],left:e/360,color:jt({h:e,s:100,v:100,a:1})})))},En=Vt.default.memo(Wi);var Xt=E(N());var Ui=({hsva:o,onChange:e})=>{let t=i=>{e({s:i.left*100,v:100-i.top*100})},r=i=>{e({s:Ke(o.s+i.left*100,0,100),v:Ke(o.v-i.top*100,0,100)})},n={backgroundColor:jt({h:o.h,s:100,v:100,a:1})};return Xt.default.createElement("div",{className:ie["color-picker-panel__saturation"],style:n},Xt.default.createElement(So,{onMove:t,onKey:r,"aria-label":"Color","aria-valuetext":`Saturation ${j(o.s)}%, Brightness ${j(o.v)}%`},Xt.default.createElement(Io,{className:ie["color-picker-panel__saturation-pointer"],top:1-o.v/100,left:o.s/100,color:jt(o)})))},Tn=Xt.default.memo(Ui);var We=E(N());function Fn(o,e,t){let r=At(t),[n,i]=(0,We.useState)(()=>o.toHsva(e)),s=(0,We.useRef)({color:e,hsva:n});(0,We.useEffect)(()=>{if(!o.equal(e,s.current.color)){let l=o.toHsva(e);s.current={hsva:l,color:e},i(l)}},[e,o]),(0,We.useEffect)(()=>{let l;!ho(n,s.current.hsva)&&!o.equal(l=o.fromHsva(n),s.current.color)&&(s.current={hsva:n,color:l},r(l))},[n,o,r]);let a=(0,We.useCallback)(l=>{i(c=>Object.assign({},c,l))},[]);return[n,a]}var ji=({className:o,colorModel:e,color:t=e.defaultColor,onChange:r})=>{let[n,i]=Fn(e,t,r);return lt.default.createElement("div",{className:A(ie["color-picker-panel"],o)},lt.default.createElement(Tn,{hsva:n,onChange:i}),lt.default.createElement(En,{hue:n.h,onChange:i,className:ie["color-picker-panel__last-control"]}))},Vi={defaultColor:"000",toHsva:An,fromHsva:({h:o,s:e,v:t})=>kn({h:o,s:e,v:t,a:1}),equal:(o,e)=>{let t=Mt(o),r=Mt(e);return t===r}},Rn=(0,lt.memo)(o=>lt.default.createElement(ji,{className:o.className,color:o.color,onChange:o.onChange,colorModel:Vi}));var Pn=["#35322B","#505050","#606060","#6F6F6F","#8B8B8B","#B2B2B2","#CCCCCC","#E5E5E5","#F5F5F5","#FFFFFF","#9D0000","#B20000","#CD0F0F","#E30909","#F30B0B","#FE4B4B","#FA7979","#FB9D9D","#FDCECE","#FEE7E7","#B24000","#CC4F10","#DF5D00","#F96800","#FB8937","#FF8C51","#FCA669","#FDC49B","#FEE1CD","#FEF0E6","#B19401","#C5A300","#D8B300","#EBC301","#F9D700","#FBE137","#FCE869","#FDF09B","#FEF7CD","#FEFBE6","#58770A","#688C0D","#7AA017","#8BBB11","#A4DC16","#BEEE44","#CEF273","#DEF6A2","#EFFBD0","#F7FDE8","#007676","#008A8A","#009E9E","#00BBBB","#1CD8D8","#2AEAEA","#76EFEF","#A3F5F5","#D1FAFA","#E8FCFC","#001F9C","#0025B7","#012BD2","#133DE3","#2F55EB","#4567ED","#738DF2","#A2B3F6","#D0D9FB","#E8ECFD","#3F0198","#510EB0","#6721CB","#7735D4","#894EDE","#9E6DE3","#AA82E3","#C7ABED","#E3D5F6","#F1EAFA","#8F0550","#A1095C","#C1026B","#D4157E","#E7258F","#F248A6","#F273B9","#F6A2D0","#FBD0E8","#FDE8F3"];var Et=o=>{let{style:e={},onChange:t,children:r,color:n,position:i="bottom"}=o,[s,a]=(0,ye.useState)(!1),[l]=we(()=>{a(!1)});return ye.default.createElement("div",{className:A(ze["color-picker"],i==="top"?ze.top:""),style:e,ref:l},ye.default.createElement("div",{className:ze["color-picker-trigger"],style:{color:n},onClick:()=>a(!0)},r),ye.default.createElement("div",{className:A(ze["color-picker-wrapper"],{[ze.show]:s})},ye.default.createElement("div",{className:ze["color-picker-list"]},Pn.map(c=>ye.default.createElement("div",{key:c,className:ze["color-picker-item"],style:{backgroundColor:c},onClick:()=>{t(c)}}))),ye.default.createElement("div",null,ye.default.createElement(Rn,{color:n,onChange:c=>{t(c)}})),ye.default.createElement("div",null,ye.default.createElement(w,{type:"normal",className:ze.reset,onClick:()=>{t("")}},"Reset"))))};Et.displayName="ColorPicker";var Nn=110,ir=20;function Xi(o,e,t){let r=o.getHeaderSize(),n=o.getMainDom().canvas.getBoundingClientRect(),i=3,s=ir*3,a=e-n.top,l=t-n.left;a<r.height&&l<r.width?i=2:a<r.height?(i=0,s=ir*6):l<r.width&&(i=1,s=ir*6);let c=e,d=t,h=18,p=n.height+n.top;return c+s>p&&(c=p-s-h),d+Nn>n.width&&(d=n.width-Nn-h),{style:{top:c,left:d},position:i}}var sr=(0,H.memo)(o=>{let{controller:e,top:t,left:r,hideContextMenu:n}=o,{row:i,col:s,colCount:a,rowCount:l}=(0,H.useSyncExternalStore)(te.subscribe,te.getSnapshot),[c]=we(n),{style:d,position:h}=(0,H.useMemo)(()=>Xi(e,t,r),[t,r]),p=g=>{let C=g?e.getRowHeight(i).len:e.getColWidth(s).len;Xe({visible:!0,title:g?"Row Height":"Column Width",children:H.default.createElement("input",{type:"number",min:"0",max:"10000",style:{width:"200px"},defaultValue:C,onChange:m=>{C=parseInt(m.currentTarget.value,10),m.stopPropagation()}}),onOk:()=>{if(C<0){kt({type:"error",message:"invalid data"});return}if(g)for(let m=0;m<l;m++)e.setRowHeight(i+m,C,!0);else for(let m=0;m<a;m++)e.setColWidth(s+m,C,!0);n()},onCancel:()=>{n()}})};return H.default.createElement("div",{className:re["context-menu"],"data-testid":"context-menu",style:d,ref:c},H.default.createElement(w,{onClick:()=>{n(),e.setFloatElementUuid(""),e.copy()}},"Copy"),H.default.createElement(w,{onClick:()=>{n(),e.setFloatElementUuid(""),e.cut()}},"Cut"),H.default.createElement(w,{onClick:()=>{n(),e.paste()}},"Paste"),h===2&&H.default.createElement(w,{onClick:()=>{n(),e.deleteAll(e.getCurrentSheetId())}},"Delete"),h===0&&H.default.createElement(H.Fragment,null,H.default.createElement(w,{onClick:()=>{n(),e.addCol(s,a)}},a>1?"Insert Columns":"Insert a Column"),H.default.createElement(w,{onClick:()=>{n(),e.deleteCol(s,a)}},a>1?"Delete Columns":"Delete a Column"),H.default.createElement(w,{onClick:()=>{n(),e.hideCol(s,a)}},a>1?"Hide Columns":"Hide a Column"),H.default.createElement(w,{onClick:()=>{p(!1)}},"Column Width")),h===1&&H.default.createElement(H.Fragment,null,H.default.createElement(w,{onClick:()=>{n(),e.addRow(i,l)}},l>1?"Insert Rows":"Insert a Row"),H.default.createElement(w,{onClick:()=>{n(),e.deleteRow(i,l)}},l>1?"Delete Rows":"Delete a Row"),H.default.createElement(w,{onClick:()=>{n(),e.hideRow(i,l)}},l>1?"Hide Rows":"Hide a Row"),H.default.createElement(w,{onClick:()=>{p(!0)}},"Row Height")))});sr.displayName="ContextMenuContainer";function Ki(){let o=document.createElement("canvas");return o.style.display="none",document.body.appendChild(o),o}function Gi(o,e){let{row:t,col:r,rowCount:n,colCount:i,sheetId:s}=o,a={labels:[],datasets:[]};for(let l=t,c=1,d=t+n;l<d;l++,c++){if(e.getRowHeight(l).len===Je)continue;let p=[];for(let g=r,C=r+i;g<C;g++){let u=e.getCell({row:l,col:g,rowCount:1,colCount:1,sheetId:s});!u||typeof u.value>"u"||p.push(zr(u.value))}p.length>0&&a.datasets.push({label:`Series${c}`,data:p})}return a.datasets[0]&&a.datasets[0].data.length>0&&(a.labels=Array.from({length:a.datasets[0].data.length}).fill("").map((l,c)=>String(c+1))),a}function Qi(o){let{top:e}=o.getDomRect(),{range:t,isMerged:r}=o.getActiveRange(),n=t.sheetId||o.getCurrentSheetId(),i=o.getSheetInfo(n)?.tabColor||"",s=o.getCell(t),a=o.getDefineName(new Le(t.row,t.col,1,1,n)),l=o.getCellSize(t),c=o.computeCellPosition(t);c.top=e+c.top;let d=s?.style?.fontFamily||"";if(!d){let v="",S=tt.getSnapshot();for(let y of S)if(!y.disabled){v=String(y.value);break}d=v}let{isBold:h=!1,isItalic:p=!1,isStrike:g=!1,fontSize:C=qt,fontColor:u=L("contentColor"),fillColor:m="",isWrapText:f=!1,underline:b=0,numberFormat:x=0}=s?.style||{};te.setState({top:c.top,left:c.left,width:l.width,height:l.height,row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount,sheetId:n,value:s?.value,formula:s?.formula,isBold:h,isItalic:p,isStrike:g,fontColor:u,fontSize:C,fontFamily:d,fillColor:m,isWrapText:f,underline:b,numberFormat:x,defineName:a,isMergeCell:r,tabColor:i})}var Mn=(o,e)=>{if((o.has("range")||o.has("cellStyle")||o.has("cellValue"))&&Qi(e),o.has("sheetList")){let t=e.getSheetList().map(r=>({sheetId:r.sheetId,name:r.name,isHide:r.isHide,tabColor:r.tabColor}));vt.setState(t)}if(o.has("sheetId")?W.mergeState({canRedo:e.canRedo(),canUndo:e.canUndo(),activeUuid:""}):W.mergeState({canRedo:e.canRedo(),canUndo:e.canUndo()}),o.has("scroll")){let t=e.getScroll();De.setState({scrollLeft:t.scrollLeft,scrollTop:t.scrollTop})}if(o.has("floatElement")||o.has("cellValue")||o.has("row")||o.has("col")||o.has("sheetId")||o.has("scroll")){let t=e.getScroll(),r=e.getDomRect(),n=t.left,i=t.top,s=r.width+n,a=r.height+i,l=e.getFloatElementList(e.getCurrentSheetId()),c=[];for(let d of l){let h=e.computeCellPosition({row:d.fromRow,col:d.fromCol,colCount:1,rowCount:1,sheetId:""}),p=h.top+d.marginY,g=h.left+d.marginX;if(p>i&&p<a||g>n&&g<s||p+d.height>i&&p+d.height<a||g+d.width>n&&g+d.width<s){let u={...d,top:p,left:g,labels:[],datasets:[]};if(d.type==="chart"){let m=Gi(d.chartRange,e);u.labels=m.labels,u.datasets=m.datasets}c.push(u)}}xt.setState(c)}};function Ln(o){let e=new Ht(o,new Ot(o,Ki())),t=s=>{e.render({changeSet:s}),e.render({changeSet:o.getChangeSet()})},r=s=>{e.resize(),t(s)},n=Go(o,r);o.setHooks({copyOrCut:qr,paste:Jr,modelChange:s=>{Mn(s,o),t(s)}});let i=new Set(["sheetId","scroll","range","sheetList","floatElement","cellValue","row","col","cellStyle","defineName","mergeCell","undoRedo","antLine"]);return Mn(i,o),r(i),()=>{n()}}var Ne=E(N());var Dn=({controller:o})=>{let{scrollTop:e}=(0,Ne.useSyncExternalStore)(De.subscribe,De.getSnapshot),t=o.getHeaderSize(),r=o.getDomRect(),[n,i]=(0,Ne.useState)(10),s=l=>{let c=l.currentTarget.value;i(parseInt(c,10)),l.stopPropagation()},a=()=>{let l=o.getSheetInfo(o.getCurrentSheetId());o.addRow(l.rowCount-1,n);let c=o.getViewSize();He(o,0,c.height)};return Ne.default.createElement("div",{className:re["bottom-bar"],"data-testid":"canvas-bottom-bar",style:{left:t.width,display:e/r.height>=.856?"flex":"none"}},Ne.default.createElement("div",{className:re["bottom-bar-text"]},"\u5728\u5E95\u90E8\u6DFB\u52A0"),Ne.default.createElement("input",{value:n,onChange:s,type:"number",min:1,max:200}),Ne.default.createElement("div",{className:re["bottom-bar-text"]},"\u884C"),Ne.default.createElement(w,{onClick:a},"\u6DFB\u52A0"))};var G=E(N());var F=E(N());var R={"float-element":"h",active:"v","float-element-mask":"u","context-menu":"f",title:"mr",image:"wr","resize-handler":"kr","resize-handler-rect":"yr","scale-dot":"zr","rotate-icon":"Cr",top:"Pr",bottom:"Rr","top-right":"Ir","top-left":"Zr","bottom-right":"jr","bottom-left":"Br",right:"Ar",left:"Fr",rotate:"m"};var X=E(N());function Yi(o){let e="data:image/",t=e.length;for(;t<o.length&&o[t]!==";";t++);return o.slice(e.length,t)}var qi=[{value:"line",label:"Line Chart"},{value:"bar",label:"Bar Chart"},{value:"pie",label:"Pie Chart"},{value:"scatter",label:"Scatter Chart"},{value:"radar",label:"Radar Chart"},{value:"polarArea",label:"PolarArea Chart"}],lr=(0,X.memo)(o=>{let{controller:e,menuLeft:t,menuTop:r,uuid:n,type:i,chartType:s,title:a,resetResize:l,hideContextMenu:c,originHeight:d,originWidth:h,width:p,height:g}=o,[C]=we(c),u=()=>{let x=Re(o.chartRange,"absolute",S=>e.getSheetInfo(S)?.name||"");Xe({visible:!0,title:"Edit Data Source",children:X.default.createElement("input",{type:"text",spellCheck:!0,style:{width:"400px"},defaultValue:x,onChange:S=>{x=S.currentTarget.value,S.stopPropagation()}}),onOk:()=>{let S=x.trim();if(!S){kt({type:"error",message:"empty reference"});return}let y=e.getSheetList(),I=ve(S,k=>y.find(D=>D.name===k)?.sheetId||"");if(!I||!I.isValid()||ao(I,o.chartRange)){kt({type:"error",message:"reference is not valid"});return}e.updateFloatElement(n,{chartRange:I}),c()},onCancel:()=>{c()}})},m=()=>{let x=a;Xe({visible:!0,title:"Change Chart Title",children:X.default.createElement("input",{type:"text",spellCheck:!0,style:{width:"200px"},defaultValue:x,onChange:S=>{x=S.currentTarget.value,S.stopPropagation()}}),onOk:()=>{let S=x.trim();if(!S){kt({type:"error",message:"empty title"});return}e.updateFloatElement(n,{title:S}),c()},onCancel:()=>{c()}})},f=()=>{let x=s;Xe({title:"Change Chart Type",visible:!0,children:X.default.createElement(Be,{style:{width:"100%"},defaultValue:x,data:qi.map(v=>({...v,disabled:!1})),onChange:v=>x=String(v)}),onCancel(){c()},onOk(){e.updateFloatElement(n,{chartType:x}),c()}})},b=()=>{c();let v=e.getFloatElementList(e.getCurrentSheetId()).find(S=>S.uuid===n);if(v&&(i==="floating-picture"&&v.imageSrc&&et(v.imageSrc,v.title+"."+Yi(v.imageSrc)),i==="chart")){let S=document.querySelector(`canvas[data-uuid="${n}"]`);if(!S)return;et(S.toDataURL(),v.title+".png")}};return X.default.createElement("div",{className:R["context-menu"],"data-testid":"float-element-context-menu",ref:C,style:{top:r,left:t}},X.default.createElement(w,{onClick:()=>{c(),e.setFloatElementUuid(n),e.copy()}},"Copy"),X.default.createElement(w,{onClick:()=>{c(),e.setFloatElementUuid(n),e.cut()}},"Cut"),X.default.createElement(w,{onClick:()=>{c(),e.paste()}},"Paste"),X.default.createElement(w,{onClick:()=>{c(),e.setFloatElementUuid(n),e.copy(),e.paste(),e.setFloatElementUuid("")}},"Duplicate"),i==="chart"?X.default.createElement(X.default.Fragment,null,X.default.createElement(w,{onClick:u},"Select Data"),X.default.createElement(w,{onClick:m},"Change Chart Title"),X.default.createElement(w,{onClick:f},"Change Chart Type")):null,X.default.createElement(w,{onClick:b},"Save as Picture"),X.default.createElement(w,{disabled:p===h&&g===d,onClick:()=>{c(),e.updateFloatElement(n,{height:d,width:h}),l({width:h,height:d})}},"Reset Size"),X.default.createElement(w,{onClick:()=>{c(),e.deleteFloatElement(n)}},"Delete"))});lr.displayName="FloatElementContextMenu";var at={resizePosition:"",moveStartX:0,moveStartY:0,position:{width:-1,height:-1,imageAngle:0,top:-1,left:-1}};function ar(o,e,t){let r=t.getHeaderSize(),n=t.getDomRect(),i=r.height,s=r.width;return o<i&&(o=i),o>n.height&&(o=n.height),e<s&&(e=s),e>n.width&&(e=n.width),{top:o,left:e}}var _i=(0,F.lazy)(()=>import("./Chart-PWTJDKUU.js")),Hn=(0,F.memo)(o=>{let{top:e,left:t,active:r,width:n,height:i,type:s,imageAngle:a=0,resetResize:l,pointerDown:c,resizeDown:d}=o,[h,p]=(0,F.useState)({top:J,left:J}),g=m=>(m.preventDefault(),m.stopPropagation(),p({top:m.clientY,left:m.clientX}),!1),C=()=>{p({top:J,left:J})},u=null;return s==="floating-picture"?u=F.default.createElement("img",{title:o.title,alt:o.title,src:o.imageSrc,className:R.image}):s==="chart"&&(u=F.default.createElement(F.Suspense,{fallback:F.default.createElement(or,null)},F.default.createElement(_i,{...o}),";")),u?F.default.createElement(F.default.Fragment,null,F.default.createElement("div",{onPointerDown:c,onContextMenu:g,className:A(R["float-element"],{[R.active]:r}),style:{transform:`translateX(${t}px) translateY(${e}px) ${s==="floating-picture"?`rotate(${a}deg)`:""} `,width:n,height:i}},u,r&&F.default.createElement(F.default.Fragment,null,F.default.createElement("div",{className:A(R["resize-handler"],R.top),"data-position":"top",onPointerDown:d},F.default.createElement("div",{className:R["scale-dot"]})),F.default.createElement("div",{className:A(R["resize-handler"],R["top-right"]),"data-position":"top-right",onPointerDown:d},F.default.createElement("div",{className:R["scale-dot"]})),F.default.createElement("div",{className:A(R["resize-handler"],R["top-left"]),"data-position":"top-left",onPointerDown:d},F.default.createElement("div",{className:R["scale-dot"]})),F.default.createElement("div",{className:A(R["resize-handler"],R.left),"data-position":"left",onPointerDown:d},F.default.createElement("div",{className:R["scale-dot"]})),F.default.createElement("div",{className:A(R["resize-handler"],R.right),"data-position":"right",onPointerDown:d},F.default.createElement("div",{className:R["scale-dot"]})),F.default.createElement("div",{className:A(R["resize-handler"],R["bottom-right"]),"data-position":"bottom-right",onPointerDown:d},F.default.createElement("div",{className:R["scale-dot"]})),F.default.createElement("div",{className:A(R["resize-handler"],R["bottom-left"]),"data-position":"bottom-left",onPointerDown:d},F.default.createElement("div",{className:R["scale-dot"]})),F.default.createElement("div",{className:A(R["resize-handler"],R.bottom),"data-position":"bottom",onPointerDown:d},F.default.createElement("div",{className:R["scale-dot"]})),s==="floating-picture"&&F.default.createElement("div",{className:A(R["resize-handler"],R.rotate),"data-position":"rotate",onPointerDown:d},F.default.createElement("div",{className:R["rotate-icon"]},F.default.createElement(de,{name:"rotate"}))))),h.top>=0&&h.left>=0&&F.default.createElement(lr,{...o,resetResize:l,menuLeft:h.left,menuTop:h.top,hideContextMenu:C})):null});var ct=E(N());var cr=({controller:o})=>{let e=(0,ct.useRef)(null),t=(n,i)=>{let s=new Image;s.src=n,s.onload=function(){let a=o.getActiveCell();o.addFloatElement({width:s.width,height:s.height,originHeight:s.height,originWidth:s.width,title:i,type:"floating-picture",uuid:Fe(),imageSrc:n,sheetId:a.sheetId,fromRow:a.row,fromCol:a.col,marginX:0,marginY:0})}};return ct.default.createElement(w,null,ct.default.createElement("input",{type:"file",hidden:!0,onChange:async n=>{n.stopPropagation();let i=n.target.files?.[0];if(!i)return;let s=i.name,a=i.type.slice(6);s=s.slice(0,-(a.length+1));let l=new FileReader;l.onload=function(c){e.current.value="",e.current.blur();let d=c.target?.result;!d||typeof d!="string"||t(d,s)},l.readAsDataURL(i)},accept:"image/*",ref:e,id:"upload_float_image"}),ct.default.createElement("label",{htmlFor:"upload_float_image"},"Floating Picture"))},dr=({controller:o})=>ct.default.createElement(w,{onClick:()=>{let t=o.getActiveCell();o.addFloatElement({width:400,height:300,originHeight:300,originWidth:400,title:"Chart Title",type:"chart",uuid:Fe(),sheetId:t.sheetId,fromRow:t.row,fromCol:t.col,chartRange:t,chartType:"line",marginX:0,marginY:0})}},"Chart");var Bn=(0,G.memo)(({controller:o})=>{let e=(0,G.useSyncExternalStore)(xt.subscribe,xt.getSnapshot),{activeUuid:t}=(0,G.useSyncExternalStore)(W.subscribe,W.getSnapshot),r=(0,G.useRef)({...at}),[n,i]=(0,G.useState)({...at.position}),s=c=>{if(c.stopPropagation(),c.preventDefault(),c.buttons!==1)return;let d=c.currentTarget.dataset.position||"";d&&(r.current.resizePosition=d,r.current.moveStartX=c.clientX,r.current.moveStartY=c.clientY)},a=c=>{let d=Math.round(c.clientX-r.current.moveStartX),h=Math.round(c.clientY-r.current.moveStartY);i(p=>{let g=r.current.resizePosition,{top:C,left:u,width:m,height:f}=p;["top-right","top-left","top"].includes(g)?(f-=h,C+=h):["bottom-right","bottom","bottom-left"].includes(g)&&(f+=h),["top-left","bottom-left","left"].includes(g)?(m-=d,u+=d):["top-right","bottom-right","right"].includes(g)&&(m+=d);let b={...ar(C,u,o),imageAngle:p.imageAngle,width:m,height:f};return r.current.position=b,b})},l=c=>{let d=c.clientX-r.current.moveStartX,h=c.clientY-r.current.moveStartY,p=Math.atan2(h,d)*180/Math.PI;i(g=>{let C={...g,imageAngle:p};return r.current.position=C,C})};return(0,G.useEffect)(()=>{let c=h=>{if(h.stopPropagation(),h.preventDefault(),!t){r.current={...at};return}r.current.resizePosition&&(r.current.resizePosition==="rotate"?o.updateFloatElement(t,{imageAngle:r.current.position.imageAngle}):r.current.position.height>0&&r.current.position.width>0&&o.updateFloatElement(t,{height:r.current.position.height,width:r.current.position.width}));let p=o.getDomRect(),{left:g,top:C}=r.current.position;if(g>=0&&C>=0&&g<p.width&&C<p.height){let u=Nt(o,g,C);u&&o.updateFloatElement(t,{fromCol:u.col,fromRow:u.row,marginX:u.marginX,marginY:u.marginY})}r.current={...at}},d=h=>{if(!t||h.buttons!==1)return;if(h.stopPropagation(),h.preventDefault(),r.current.resizePosition){r.current.resizePosition==="rotate"?l(h):(a(h),r.current.moveStartX=h.clientX,r.current.moveStartY=h.clientY);return}let p=Math.round(h.clientX-r.current.moveStartX),g=Math.round(h.clientY-r.current.moveStartY);i(C=>{let u=C.top+g,m=C.left+p,f={...ar(u,m,o),imageAngle:C.imageAngle,width:C.width,height:C.height};return r.current.position=f,f}),r.current.moveStartX=h.clientX,r.current.moveStartY=h.clientY};return document.addEventListener("pointerup",c),document.addEventListener("pointermove",d),()=>{document.removeEventListener("pointerup",c),document.removeEventListener("pointermove",d)}},[t]),G.default.createElement(G.Fragment,null,G.default.createElement("div",{className:A(R["float-element-mask"],{[R.active]:!!t}),onPointerDown:()=>{r.current={...at},W.mergeState({activeUuid:""}),o.setFloatElementUuid("")}}),e.map(c=>{let d=c.uuid===t,h={...c,...d?n:{}};return G.default.createElement(Hn,{key:c.uuid,...h,active:d,controller:o,resetResize:p=>i(g=>({...g,...p})),pointerDown:p=>{p.stopPropagation(),p.preventDefault(),p.buttons===1&&(r.current.moveStartX=p.clientX,r.current.moveStartY=p.clientY,r.current.position={...at.position},o.setFloatElementUuid(c.uuid),W.mergeState({activeUuid:c.uuid}),i({top:c.top,left:c.left,width:c.width,height:c.height,imageAngle:c.imageAngle||0}))},resizeDown:s})}))});var $i=300,hr=o=>{let{controller:e}=o,t=(0,Q.useRef)({timeStamp:0}),[r,n]=(0,Q.useState)({top:J,left:J}),i=(0,Q.useRef)(null);(0,Q.useEffect)(()=>{if(i.current)return e.setMainDom({canvas:i.current}),Ln(e)},[]);let s=d=>(d.preventDefault(),n({top:d.clientY,left:d.clientX}),!1),a=()=>{n({top:J,left:J})},l=d=>{if(d.buttons!==1)return;let h=e.getHeaderSize(),p=e.getDomRect(),{clientX:g,clientY:C}=d,u=g-p.left,m=C-p.top,f=Nt(e,u,m);if(!f)return;let b=e.getActiveCell();if(!(b.row===f.row&&b.col===f.col)){if(u>h.width&&m>h.height){let x=Math.abs(f.col-b.col)+1,v=Math.abs(f.row-b.row)+1;e.setActiveCell({row:Math.min(f.row,b.row),col:Math.min(f.col,b.col),rowCount:v,colCount:x,sheetId:""});return}if(h.width>u&&h.height<=m){let x=Math.abs(f.row-b.row)+1;e.setActiveCell({row:Math.min(f.row,b.row),col:Math.min(f.col,b.col),rowCount:x,colCount:0,sheetId:""});return}if(h.width<=u&&h.height>m){let x=Math.abs(f.col-b.col)+1;e.setActiveCell({row:Math.min(f.row,b.row),col:Math.min(f.col,b.col),rowCount:0,colCount:x,sheetId:""});return}}},c=d=>{if(d.buttons!==1)return;let h=e.getHeaderSize(),p=e.getDomRect(),{timeStamp:g,clientX:C,clientY:u}=d,m=C-p.left,f=u-p.top,b=Nt(e,m,f);if(!b)return;if(h.width>m&&h.height>f){e.setActiveCell({row:0,col:0,colCount:0,rowCount:0,sheetId:""});return}if(h.width>m&&h.height<=f){e.setActiveCell({row:b.row,col:b.col,rowCount:1,colCount:0,sheetId:""});return}if(h.width<=m&&h.height>f){e.setActiveCell({row:b.row,col:b.col,rowCount:0,colCount:1,sheetId:""});return}let x=e.getActiveCell();x.row>=0&&x.row===b.row&&x.col===b.col?g-t.current.timeStamp<$i&&W.mergeState({editorStatus:1}):(_(e)&&Co(e),e.setActiveCell({row:b.row,col:b.col,rowCount:1,colCount:1,sheetId:""})),t.current.timeStamp=g};return Q.default.createElement(Q.Fragment,null,Q.default.createElement("div",{className:re["canvas-container"],"data-testid":"canvas-container"},Q.default.createElement("canvas",{className:re["canvas-content"],onContextMenu:s,onPointerMove:l,onPointerDown:c,ref:i,"data-testid":"canvas-main"}),Q.default.createElement(Qo,{controller:e}),Q.default.createElement(Dn,{controller:e}),Q.default.createElement(Bn,{controller:e})),r.top>=0&&r.left>=0&&Q.default.createElement(sr,{...r,controller:e,hideContextMenu:a}))};hr.displayName="CanvasContainer";var Ie=E(N());var Tt=E(N());var Me={"formula-bar-wrapper":"Sr","formula-bar-name":"Lr","formula-bar-name-editor":"Mr","formula-bar-editor-wrapper":"Ur","formula-bar-value":"w",show:"Yr","base-editor":"qr"};function pr(o,e=!0){let t={};return o?.isItalic&&(t.fontStyle="italic"),o?.isBold&&(t.fontWeight="bold"),o?.fontFamily&&(t.fontFamily=o?.fontFamily),o?.fontSize&&!e&&(t.fontSize=o?.fontSize),o?.fillColor&&!e&&(t.backgroundColor=o.fillColor),o?.fontColor&&!e&&(t.color=o?.fontColor),o?.underline&&o?.isStrike?t.textDecorationLine="underline line-through":o?.underline?t.textDecorationLine="underline":o?.isStrike&&(t.textDecorationLine="line-through"),t}function On(o,e){if(e===0)return;let t=e===2,r=pr(o,t);if(t)return r;let n={top:o.top,left:o.left,width:o.width,height:o.height};return{...r,...n,border:"1px solid var(--primaryColor)"}}var mr=({controller:o,initValue:e,style:t,testId:r})=>{let n=(0,Tt.useRef)(null);(0,Tt.useEffect)(()=>{n.current&&o.setMainDom({input:n.current})},[]);let i=s=>{s.stopPropagation(),s.key==="Enter"?uo(o):s.key==="Tab"&&mo(o)};return Tt.default.createElement("input",{className:Me["base-editor"],ref:n,spellCheck:!0,defaultValue:e,onKeyDown:i,type:"text",style:t,"data-testid":r})};mr.displayName="FormulaEditor";var Ue=E(N());var zn=({controller:o,displayName:e})=>{let t=(0,Ue.useRef)(null),[r,n]=(0,Ue.useState)(e);(0,Ue.useEffect)(()=>{n(e)},[e]);let i=a=>{if(a.stopPropagation(),a.key==="Enter"){let l=a.currentTarget.value.trim().toLowerCase();if(!l)return;t.current?.blur();let c=o.checkDefineName(l);if(c){n(e),o.setActiveCell(c);return}let d=ve(l),h=o.getSheetInfo(o.getCurrentSheetId());if(d&&d.col<h.colCount&&d.row<h.rowCount){n(e),o.setActiveCell(d);return}/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(l)&&l.length<=255?o.setDefineName(o.getActiveCell(),l):n(e)}},s=a=>{n(a.currentTarget.value)};return Ue.default.createElement("div",{className:Me["formula-bar-name"],"data-testid":"formula-bar-name"},Ue.default.createElement("input",{value:r,ref:t,spellCheck:!0,type:"text",onChange:s,className:Me["formula-bar-name-editor"],onKeyDown:i}))};var ur=({controller:o})=>{let e=(0,Ie.useSyncExternalStore)(te.subscribe,te.getSnapshot),{editorStatus:t}=(0,Ie.useSyncExternalStore)(W.subscribe,W.getSnapshot),r=(0,Ie.useMemo)(()=>e.defineName||`${io(e.col)}${e.row+1}`,[e]),n=e.formula||String(e.value||""),i=()=>{W.mergeState({editorStatus:2}),o.getMainDom().input?.focus()};return Ie.default.createElement("div",{className:Me["formula-bar-wrapper"],"data-testid":"formula-bar"},Ie.default.createElement(zn,{controller:o,displayName:r}),Ie.default.createElement("div",{className:Me["formula-bar-editor-wrapper"]},t!==0?Ie.default.createElement(mr,{controller:o,initValue:n,style:On(e,t),testId:"formula-editor"}):null,Ie.default.createElement("div",{className:A(Me["formula-bar-value"],{[Me.show]:t!==2}),style:pr(e),onClick:i},n)))};ur.displayName="FormulaBarContainer";var M=E(N());var Wn={"toolbar-wrapper":"k"};var os=[{value:0,label:"none",disabled:!1},{value:1,label:"single underline",disabled:!1},{value:2,label:"double underline",disabled:!1}],fr=({controller:o})=>{let{canRedo:e,canUndo:t}=(0,M.useSyncExternalStore)(W.subscribe,W.getSnapshot),r=(0,M.useSyncExternalStore)(te.subscribe,te.getSnapshot),n=(0,M.useSyncExternalStore)(tt.subscribe,tt.getSnapshot),i=f=>({fontFamily:String(f),fontSize:"16px"}),s=f=>{o.updateCellStyle(f,[o.getActiveCell()])},{isBold:a,isItalic:l,isStrike:c,fontSize:d,fontColor:h="",fillColor:p="",isWrapText:g,underline:C,fontFamily:u}=r,m=f=>{let b=String(f),x=window.queryLocalFonts;b===Gr&&typeof x=="function"?x().then(v=>{let S=v.map(I=>I.fullName);S=Array.from(new Set(S)).filter(I=>Zr(I)),S.sort((I,k)=>I.localeCompare(k)),localStorage.setItem(Qr,JSON.stringify(S));let y=S.map(I=>({label:I,value:I,disabled:!1}));tt.setState(y)}):s({fontFamily:String(f)})};return M.default.createElement("div",{className:Wn["toolbar-wrapper"],"data-testid":"toolbar"},M.default.createElement(w,{disabled:!t,onClick:()=>o.undo(),testId:"toolbar-undo",title:"undo"},M.default.createElement(de,{name:"undo"})),M.default.createElement(w,{disabled:!e,onClick:()=>o.redo(),testId:"toolbar-redo",title:"redo"},M.default.createElement(de,{name:"redo"})),M.default.createElement(w,{onClick:()=>o.copy(),testId:"toolbar-copy"},"Copy"),M.default.createElement(w,{onClick:()=>o.cut(),testId:"toolbar-cut"},"Cut"),M.default.createElement(w,{onClick:()=>o.paste(),testId:"toolbar-paste"},"Paste"),M.default.createElement(Be,{data:n,value:u,style:{width:140},getItemStyle:i,onChange:m}),M.default.createElement(Be,{data:Mr,value:d,onChange:f=>s({fontSize:Number(f)})}),M.default.createElement(w,{active:a,onClick:()=>s({isBold:!a}),testId:"toolbar-bold",title:"Bold"},M.default.createElement("span",{style:{fontWeight:"bold"}},"B")),M.default.createElement(w,{active:l,onClick:()=>s({isItalic:!l}),testId:"toolbar-italic",title:"Italic"},M.default.createElement("span",{style:{fontStyle:"italic"}},"I")),M.default.createElement(w,{active:c,onClick:()=>s({isStrike:!c}),testId:"toolbar-strike",title:"Strike"},M.default.createElement("span",{style:{textDecorationLine:"line-through"}},"A")),M.default.createElement(Be,{data:os,value:C,style:{width:130},title:"Underline",onChange:f=>s({underline:Number(f)})}),M.default.createElement(Et,{key:"fill-color",color:p,onChange:f=>s({fillColor:f})},M.default.createElement(w,{style:{color:p}},M.default.createElement(bo,null))),M.default.createElement(Et,{key:"font-color",color:h,onChange:f=>s({fontColor:f})},M.default.createElement(w,{style:{color:h}},M.default.createElement(de,{name:"fontColor"}))),M.default.createElement(w,{active:g,onClick:()=>s({isWrapText:!g}),testId:"toolbar-wrap-text",style:{minWidth:80}},"Wrap Text"),M.default.createElement(cr,{controller:o}),no()?null:M.default.createElement(dr,{controller:o}),M.default.createElement(Zo,null))};fr.displayName="ToolbarContainer";var K=E(N());var pe=E(N());var se={"sheet-bar-wrapper":"Dr","sheet-bar-list":"Er","sheet-bar-item":"y",active:"Gr","sheet-bar-item-color":"Jr","sheet-bar-context-menu":"z","sheet-bar-input":"Kr","show-block":"Nr","sheet-bar-add":"Or","sheet-bar-unhide":"Qr","add-button":"Tr"};var gr=({controller:o,position:e,sheetList:t,currentSheetId:r,hideMenu:n,editSheetName:i})=>{let[s]=we(()=>{n()}),a=(0,pe.useMemo)(()=>t.find(h=>h.sheetId===r)?.tabColor||"",[t,r]),l=(0,pe.useMemo)(()=>t.filter(h=>h.isHide).map(h=>({value:String(h.sheetId),label:h.name,disabled:!1})),[t]),c=()=>{let h=String(l[0]?.value)||"";Xe({visible:!0,title:"Unhide sheet:",children:pe.default.createElement(Be,{data:l,onChange:p=>h=String(p),style:{width:300},defaultValue:h}),onCancel:n,onOk(){o.unhideSheet(h),n()}})},d=h=>{o.setTabColor(h),n()};return pe.default.createElement("div",{className:se["sheet-bar-context-menu"],style:{left:e},ref:s,"data-testid":"sheet-bar-context-menu"},pe.default.createElement(w,{onClick:()=>{n(),o.addSheet()}},"Insert"),pe.default.createElement(w,{onClick:()=>{n(),o.deleteSheet()}},"Delete"),pe.default.createElement(w,{onClick:()=>{n(),i()}},"Rename"),pe.default.createElement(w,{onClick:()=>{n(),o.hideSheet()}},"Hide"),pe.default.createElement(w,{className:se["sheet-bar-unhide"],disabled:l.length===0,onClick:c},"Unhide"),pe.default.createElement(Et,{color:a,onChange:d,position:"top"},pe.default.createElement(w,{className:se["sheet-bar-unhide"]},"Tab Color")))};gr.displayName="SheetBarContextMenu";var Cr=({controller:o})=>{let e=(0,K.useSyncExternalStore)(vt.subscribe,vt.getSnapshot),t=e.filter(h=>!h.isHide),{sheetId:r}=(0,K.useSyncExternalStore)(te.subscribe,te.getSnapshot),[n,i]=(0,K.useState)(J),[s,a]=(0,K.useState)(!1),l=h=>{o.renameSheet(h),a(!1)},c=h=>{h.preventDefault();let p=(h.clientX||0)-30;return i(p),!1},d=h=>{if(h.stopPropagation(),h.key==="Enter"){let p=h.currentTarget.value;if(!p)return;l(p)}};return K.default.createElement("div",{className:se["sheet-bar-wrapper"]},K.default.createElement("div",{className:se["sheet-bar-list"],"data-testid":"sheet-bar-list"},t.map(h=>{let p=r===h.sheetId,g=p&&s,C=h.tabColor||"",u=A(se["sheet-bar-item"],{[se.active]:p}),m;return!p&&!s&&C&&(m={backgroundColor:C}),K.default.createElement("div",{key:h.sheetId,className:u,style:m,onContextMenu:c,onClick:()=>{a(!1),o.setCurrentSheetId(h.sheetId)}},g?K.default.createElement("input",{className:se["sheet-bar-input"],defaultValue:h.name,onKeyDown:d,type:"text",spellCheck:!0}):K.default.createElement(K.default.Fragment,null,p&&C&&K.default.createElement("span",{className:se["sheet-bar-item-color"],style:{backgroundColor:C}}),K.default.createElement("span",{className:se["sheet-bar-item-text"]},h.name)))})),K.default.createElement("div",{className:se["sheet-bar-add"]},K.default.createElement(w,{onClick:()=>o.addSheet(),type:"circle",className:se["add-button"]},K.default.createElement(de,{name:"plus"}))),n>=0&&K.default.createElement(gr,{controller:o,position:n,sheetList:e,currentSheetId:r,hideMenu:()=>i(J),editSheetName:()=>a(!0)}))};Cr.displayName="SheetBarContainer";var Un={"app-container":"Vr"};var ht=E(N());var le=E(N());function ls(o){return new Promise((e,t)=>{let r=new Image;r.onload=()=>{let n=r.width,i=r.height;e({width:n,height:i})},r.onerror=n=>{t(n)},r.src=o})}var yr="xl",as="xl/styles.xml",cs="xl/workbook.xml",ds="xl/_rels/workbook.xml.rels",hs="xl/theme/theme1.xml",ps="xl/sharedStrings.xml",dt="#text",jn="xl/drawings/",Vn="../drawings/",ms={"image/apng":[".apng"],"image/bmp":[".bmp"],"image/x-icon":[".ico",".cur"],"image/png":[".png"],"image/webp":[".webp"],"image/svg+xml":[".svg"],"image/avif":[".avif"],"image/gif":[".gif"],"image/jpeg":[".jpeg",".jpg",".jfif",".pjpeg",".pjp"]},us=["bar","line","pie"],wr=8;function xr(o){let e={};if(o.nodeType===Node.ELEMENT_NODE){if(o.attributes.length>0)for(let t of o.attributes)e[t.nodeName]=t.nodeValue}else o.nodeType===Node.TEXT_NODE&&(e=o.nodeValue);if(o.childNodes.length>0)for(let t of o.childNodes){let r=t.nodeName;typeof t.nodeValue=="string"&&!t.nodeValue.trim()||(typeof e[r]>"u"?e[r]=xr(t):(typeof e[r].push>"u"&&(e[r]=[e[r]]),e[r].push(xr(t))))}return e}function fs(o){let t=new DOMParser().parseFromString(o,"text/xml");return xr(t)}function br(o){if(!o)return"";let e="#";return o.length===6?e+o:o.length===8&&o.startsWith("FF")?e+o.slice(2):""}function vr(o,e){if(!e)return"";if(e.theme){let t=["a:lt1","a:dk1","a:lt2","a:dk2","a:accent1","a:accent2","a:accent3","a:accent4","a:accent5","a:accent6"],r=parseInt(e.theme,10);if(r>=0&&r<=1)return br(o[t[r]]["a:sysClr"].lastClr);if(r>1&&r<t.length)return br(o[t[r]]["a:srgbClr"].val)}return br(e.rgb)}function gs(o,e,t){let r={},n=z(o,"styleSheet.cellXfs.xf",[]);if(!e||n.length===0||!n[e])return r;let i=n[e];if(i.applyAlignment&&i.alignment){if(i.alignment.horizontal){let s={left:0,center:1,right:2};r.horizontalAlign=s[i.alignment.horizontal]}if(i.alignment.vertical){let s={top:0,center:1,bottom:2};r.verticalAlign=s[i.alignment.vertical]}else r.verticalAlign=2;r.isWrapText=!!i.alignment.wrapText}if(i.applyFont&&i.fontId){let s=z(o,"styleSheet.fonts.font",[]),a=parseInt(i.fontId,10);if(!isNaN(a)&&s.length>0&&s[a]){let l=s[a],c=l?.sz?.val?parseInt(l?.sz?.val,10):void 0;r.fontSize=c||void 0,r.isBold=!!l?.b,r.isItalic=!!l?.i,r.isStrike=!!l?.strike,r.underline=l.u?1:0,r.fontFamily=l?.name?.val;let d=vr(t,l.color);d&&(r.fontColor=d)}}if(i.applyNumberFormat&&i.numFmtId){let s=parseInt(i.numFmtId,10);eo.some(a=>a.id===s)&&(r.numberFormat=s)}if(i.applyFill&&i.fillId){let s=z(o,"styleSheet.fills.fill",[]),a=parseInt(i.fillId,10);if(s.length>0&&!isNaN(a)&&s[a]){let l=s[a].gradientFill,c=s[a].patternFill;if(l&&l.stop[0]){let d=vr(t,l.stop[0].color);d&&(r.fillColor=d)}else if(c){let d=vr(t,c.fgColor);d&&(r.fillColor=d)}}}return r}function Cs(o,e){let t=o[cs],r=z(o[ps],"sst.si",[]);Array.isArray(r)||(r=[r]);let n=z(o[hs],"a:theme.a:themeElements.a:clrScheme",{}),i={workbook:{},mergeCells:{},customHeight:{},customWidth:{},definedNames:{},currentSheetId:"",drawings:{},rangeMap:{},worksheets:{}},s=z(o[ds],"Relationships.Relationship",[]),a={},l={},c=0,d=z(t,"workbook.sheets.sheet",[]);Array.isArray(d)||(d=[d]);let h=0;for(let u of d){if(!u)continue;let m=s.find(k=>k.Id===u["r:id"])?.Target||"",f="worksheets/",b=m.slice(f.length),x=`${yr}/${f}_rels/${b}.rels`;if(o[x]){let k=z(o[x],"Relationships.Relationship",[]);Array.isArray(k)||(k=[k]);for(let D of k)l[u.sheetId]||(l[u.sheetId]=[]),l[u.sheetId].push(D.Target),D.Target.startsWith(Vn)&&c++}let v=`${yr}/${m}`;a[u.sheetId]=v;let S=ve(z(o[v],"worksheet.sheetViews.sheetView.selection.sqref",""));z(o[v],"worksheet.sheetViews.sheetView.tabSelected","")==="1"&&(i.currentSheetId=u.sheetId);let I={sheetId:u.sheetId,name:u.name,isHide:u.state==="hidden",rowCount:200,colCount:200,sort:h++};i.workbook[I.sheetId]=I,S&&(i.rangeMap[u.sheetId]=S,S.sheetId=u.sheetId)}let p=Object.values(i.workbook);p.sort((u,m)=>u.sort-m.sort),i.currentSheetId=i.currentSheetId||p[0].sheetId;for(let u of p){let m=a[u.sheetId],f=z(o[m],"worksheet.sheetData.row");Array.isArray(f)||(f=[f]);let b=z(o[m],"worksheet.cols.col",[]);b=Array.isArray(b)?b:[b];let x=z(o[m],"worksheet.sheetFormatPr",{defaultColWidth:"",defaultRowHeight:"",outlineLevelRow:""});if(b.length>0){for(let y of b)if(y&&y.customWidth&&y.width&&y.min&&y.max){let k=x.defaultColWidth===y.width?qe:parseFloat(y.width)*wr,D=!!y.hidden;for(let ae=parseInt(y.min,10)-1,$=parseInt(y.max,10);ae<$;ae++)i.customWidth[ge(u.sheetId,ae)]={len:k,isHide:D}}}if(f.length===0)continue;let{colCount:v}=u,{rowCount:S}=u;for(let y of f){if(!y)continue;let I=parseInt(y.r,10)-1;if(S=Math.max(S,I+1),S>oo)continue;if(y.customHeight&&y.ht){let D=x.defaultRowHeight===y.ht;i.customHeight[ge(u.sheetId,I)]={len:D?Ye:parseFloat(y.ht),isHide:!!y.hidden}}let k=Array.isArray(y.c)?y.c:[y.c];for(let D of k){if(!D)continue;let ae=ve(D.r);if(!ae||(v=Math.max(v,ae.col+1),v>to))continue;let $=D?.v?.[dt]||"",ke=parseInt(D.s,10),ue={style:gs(o[as],ke,n)};if(D.t==="s"){let Y=parseInt($,10);if(!isNaN(Y)){let fe=r[Y]?.t?.[dt]||"";fe&&($=fe)}}$.startsWith("=")?ue.formula=$:ue.value=$,i.worksheets[u.sheetId]=i.worksheets[u.sheetId]||{},i.worksheets[u.sheetId][U(I,ae.col)]=ue,v=Math.max(v,ae.col+1)}}u.rowCount=Math.max(u.rowCount,S),u.colCount=Math.max(u.colCount,v)}let g=z(t,"workbook.definedNames.definedName",[]);g=Array.isArray(g)?g:[g];let C=u=>Object.values(i.workbook).find(f=>f.name===u)?.sheetId||"";for(let u of g){let m=ve(u[dt],C);m&&m.sheetId&&m.isValid()&&u?.name&&(i.definedNames[u.name.toLowerCase()]=m.toIRange())}for(let u=1;u<=c;u++){let m=`drawing${u}.xml`,f=`${jn}${m}`,b=`${jn}_rels/${m}.rels`;if(!o[f]||!o[b])break;let x=z(o[b],"Relationships.Relationship",[]);Array.isArray(x)||(x=[x]);let v="";for(let[y,I]of Object.entries(l))if(I.some(k=>k===Vn+m)){v=y;break}let S=z(o[f],"xdr:wsDr.xdr:twoCellAnchor",[]);Array.isArray(S)||(S=[S]);for(let y of S){let I=z(y,"xdr:graphicFrame.a:graphic.a:graphicData.c:chart.r:id",""),k=z(y,"xdr:pic.xdr:blipFill.a:blip.r:embed",""),D=!!k,ae=D?k:I,$=x.find(fe=>fe.Id===ae)?.Target||"";if(!$)continue;let ke=yr+$.slice(2),ut=y["xdr:from"]["xdr:col"][dt],ue=y["xdr:from"]["xdr:row"][dt];if(!ut||!ue)continue;let Y=Fe(),V={title:"",type:D?"floating-picture":"chart",uuid:Y,width:300,height:300,originHeight:300,originWidth:300,fromCol:parseInt(ue,10),fromRow:parseInt(ut,10),sheetId:v,marginX:0,marginY:0};if(D){if(!o[ke])continue;let fe=z(y,"xdr:pic.xdr:nvPicPr.xdr:cNvPr.name",""),Ze=z(y,"xdr:pic.xdr:nvPicPr.xdr:cNvPr.title","");V.title=Ze||fe,V.imageAngle=0,V.imageSrc=o[ke]||"";let ee=e[ke];ee&&ee.width>0&&ee.height>0&&(V.width=ee.width,V.height=ee.height,V.originWidth=ee.width,V.originHeight=ee.height)}else{V.title=z(o[ke],"c:chartSpace.c:chart.c:title.c:tx.c:rich.a:p.0.a:r.a:t."+dt,"");let fe="";for(let ee of us){let Rt=z(o[ke],`c:chartSpace.c:chart.c:plotArea.c:${ee}Chart.c:ser.0.c:val.c:numRef.c:f.${dt}`,"");if(Rt){fe=Rt,V.chartType=ee;break}}if(!fe)continue;let Ze=ve(fe,ee=>Object.values(i.workbook).find(Yt=>Yt.name===ee)?.sheetId||"");if(!Ze)continue;V.chartRange=Ze}i.drawings[Y]=V}}return i}async function Xn(o){let t=await(await import("./jszip.min-5GWVJJCY.js")).default.loadAsync(o),{files:r}=t,n={},i={};for(let a of Object.keys(r))if(!r[a].dir)if(a.includes(".xml")){let l=await r[a].async("string");l&&(n[a]=fs(l))}else{let l="";for(let[d,h]of Object.entries(ms))if(h.some(p=>a.endsWith(p))){l=d;break}if(!l)continue;let c=await r[a].async("base64");c&&(n[a]=`data:${l};base64,${c}`,i[a]=await ls(n[a]))}return Cs(n,i)}function Kn(){let o=new Date().toLocaleDateString("zh").replaceAll("/","-"),e=new Date().toLocaleTimeString("zh");return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
<cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties"
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:dcterms="http://purl.org/dc/terms/"
  xmlns:dcmitype="http://purl.org/dc/dcmitype/"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <dc:creator>Steve Xu</dc:creator>
  <cp:lastModifiedBy>Steve Xu</cp:lastModifiedBy>
  <dcterms:created xsi:type="dcterms:W3CDTF">${o}T${e}Z</dcterms:created>
  <dcterms:modified xsi:type="dcterms:W3CDTF">${o}T${e}Z</dcterms:modified>
</cp:coreProperties>`}function Gn(o){return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
  <styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"
    xmlns:xr9="http://schemas.microsoft.com/office/spreadsheetml/2016/revision9">
    <numFmts count="${o.numFmts.length}">
    ${o.numFmts.join(`
`)}
    </numFmts>
    <fonts count="${o.fonts.length}">
    ${o.fonts.join(`
`)}
    </fonts>
    <fills count="${o.fills.length}">
    ${o.fills.join(`
`)}
    </fills>
    <borders count="9">
      <border>
        <left/>
        <right/>
        <top/>
        <bottom/>
        <diagonal/>
      </border>
      <border>
        <left style="thin">
          <color rgb="FFB2B2B2"/>
        </left>
        <right style="thin">
          <color rgb="FFB2B2B2"/>
        </right>
        <top style="thin">
          <color rgb="FFB2B2B2"/>
        </top>
        <bottom style="thin">
          <color rgb="FFB2B2B2"/>
        </bottom>
        <diagonal/>
      </border>
      <border>
        <left/>
        <right/>
        <top/>
        <bottom style="medium">
          <color theme="4"/>
        </bottom>
        <diagonal/>
      </border>
      <border>
        <left/>
        <right/>
        <top/>
        <bottom style="medium">
          <color theme="4" tint="0.499984740745262"/>
        </bottom>
        <diagonal/>
      </border>
      <border>
        <left style="thin">
          <color rgb="FF7F7F7F"/>
        </left>
        <right style="thin">
          <color rgb="FF7F7F7F"/>
        </right>
        <top style="thin">
          <color rgb="FF7F7F7F"/>
        </top>
        <bottom style="thin">
          <color rgb="FF7F7F7F"/>
        </bottom>
        <diagonal/>
      </border>
      <border>
        <left style="thin">
          <color rgb="FF3F3F3F"/>
        </left>
        <right style="thin">
          <color rgb="FF3F3F3F"/>
        </right>
        <top style="thin">
          <color rgb="FF3F3F3F"/>
        </top>
        <bottom style="thin">
          <color rgb="FF3F3F3F"/>
        </bottom>
        <diagonal/>
      </border>
      <border>
        <left style="double">
          <color rgb="FF3F3F3F"/>
        </left>
        <right style="double">
          <color rgb="FF3F3F3F"/>
        </right>
        <top style="double">
          <color rgb="FF3F3F3F"/>
        </top>
        <bottom style="double">
          <color rgb="FF3F3F3F"/>
        </bottom>
        <diagonal/>
      </border>
      <border>
        <left/>
        <right/>
        <top/>
        <bottom style="double">
          <color rgb="FFFF8001"/>
        </bottom>
        <diagonal/>
      </border>
      <border>
        <left/>
        <right/>
        <top style="thin">
          <color theme="4"/>
        </top>
        <bottom style="double">
          <color theme="4"/>
        </bottom>
        <diagonal/>
      </border>
    </borders>
    <cellStyleXfs count="49">
      <xf numFmtId="0" fontId="0" fillId="0" borderId="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="43" fontId="0" fillId="0" borderId="0" applyFont="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="44" fontId="0" fillId="0" borderId="0" applyFont="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="9" fontId="0" fillId="0" borderId="0" applyFont="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="41" fontId="0" fillId="0" borderId="0" applyFont="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="42" fontId="0" fillId="0" borderId="0" applyFont="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyNumberFormat="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyNumberFormat="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyNumberFormat="0" applyFont="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyNumberFormat="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyNumberFormat="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="5" fillId="0" borderId="0" applyNumberFormat="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="6" fillId="0" borderId="2" applyNumberFormat="0" applyFill="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="7" fillId="0" borderId="2" applyNumberFormat="0" applyFill="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="8" fillId="0" borderId="3" applyNumberFormat="0" applyFill="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="8" fillId="0" borderId="0" applyNumberFormat="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="9" fillId="3" borderId="4" applyNumberFormat="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="10" fillId="4" borderId="5" applyNumberFormat="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="11" fillId="4" borderId="4" applyNumberFormat="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="12" fillId="5" borderId="6" applyNumberFormat="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="13" fillId="0" borderId="7" applyNumberFormat="0" applyFill="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="14" fillId="0" borderId="8" applyNumberFormat="0" applyFill="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="15" fillId="6" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="16" fillId="7" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="17" fillId="8" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="18" fillId="9" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="19" fillId="10" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="19" fillId="11" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="18" fillId="12" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="18" fillId="13" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="19" fillId="14" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="19" fillId="15" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="18" fillId="16" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="18" fillId="17" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="19" fillId="18" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="19" fillId="19" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="18" fillId="20" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="18" fillId="21" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="19" fillId="22" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="19" fillId="23" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="18" fillId="24" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="18" fillId="25" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="19" fillId="26" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="19" fillId="27" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="18" fillId="28" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="18" fillId="29" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="19" fillId="30" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="19" fillId="31" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
      <xf numFmtId="0" fontId="18" fillId="32" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0">
        <alignment vertical="center"/>
      </xf>
    </cellStyleXfs>
    <cellXfs count="${o.cellXfs.length}">
    ${o.cellXfs.join(`
`)}
    </cellXfs>
    <cellStyles count="49">
      <cellStyle name="Normal" xfId="0" builtinId="0"/>
      <cellStyle name="Comma" xfId="1" builtinId="3"/>
      <cellStyle name="Currency" xfId="2" builtinId="4"/>
      <cellStyle name="Percent" xfId="3" builtinId="5"/>
      <cellStyle name="Comma [0]" xfId="4" builtinId="6"/>
      <cellStyle name="Currency [0]" xfId="5" builtinId="7"/>
      <cellStyle name="Hyperlink" xfId="6" builtinId="8"/>
      <cellStyle name="Followed Hyperlink" xfId="7" builtinId="9"/>
      <cellStyle name="Note" xfId="8" builtinId="10"/>
      <cellStyle name="Warning Text" xfId="9" builtinId="11"/>
      <cellStyle name="Title" xfId="10" builtinId="15"/>
      <cellStyle name="CExplanatory Text" xfId="11" builtinId="53"/>
      <cellStyle name="Heading 1" xfId="12" builtinId="16"/>
      <cellStyle name="Heading 2" xfId="13" builtinId="17"/>
      <cellStyle name="Heading 3" xfId="14" builtinId="18"/>
      <cellStyle name="Heading 4" xfId="15" builtinId="19"/>
      <cellStyle name="Input" xfId="16" builtinId="20"/>
      <cellStyle name="Output" xfId="17" builtinId="21"/>
      <cellStyle name="Calculation" xfId="18" builtinId="22"/>
      <cellStyle name="Check Cell" xfId="19" builtinId="23"/>
      <cellStyle name="Linked Cell" xfId="20" builtinId="24"/>
      <cellStyle name="Total" xfId="21" builtinId="25"/>
      <cellStyle name="Good" xfId="22" builtinId="26"/>
      <cellStyle name="Bad" xfId="23" builtinId="27"/>
      <cellStyle name="Neutral" xfId="24" builtinId="28"/>
      <cellStyle name="Accent1" xfId="25" builtinId="29"/>
      <cellStyle name="20% - Accent1" xfId="26" builtinId="30"/>
      <cellStyle name="40% - Accent1" xfId="27" builtinId="31"/>
      <cellStyle name="60% - Accent1" xfId="28" builtinId="32"/>
      <cellStyle name="Accent2" xfId="29" builtinId="33"/>
      <cellStyle name="20% - Accent2" xfId="30" builtinId="34"/>
      <cellStyle name="40% - Accent2" xfId="31" builtinId="35"/>
      <cellStyle name="60% - Accent2" xfId="32" builtinId="36"/>
      <cellStyle name="Accent3" xfId="33" builtinId="37"/>
      <cellStyle name="20% - Accent3" xfId="34" builtinId="38"/>
      <cellStyle name="40% - Accent3" xfId="35" builtinId="39"/>
      <cellStyle name="60% - Accent3" xfId="36" builtinId="40"/>
      <cellStyle name="Accent4" xfId="37" builtinId="41"/>
      <cellStyle name="20% - Accent4" xfId="38" builtinId="42"/>
      <cellStyle name="40% - Accent4" xfId="39" builtinId="43"/>
      <cellStyle name="60% - Accent4" xfId="40" builtinId="44"/>
      <cellStyle name="Accent5" xfId="41" builtinId="45"/>
      <cellStyle name="20% - Accent5" xfId="42" builtinId="46"/>
      <cellStyle name="40% - Accent5" xfId="43" builtinId="47"/>
      <cellStyle name="60% - Accent5" xfId="44" builtinId="48"/>
      <cellStyle name="Accent6" xfId="45" builtinId="49"/>
      <cellStyle name="20% - Accent6" xfId="46" builtinId="50"/>
      <cellStyle name="40% - Accent6" xfId="47" builtinId="51"/>
      <cellStyle name="60% - Accent6" xfId="48" builtinId="52"/>
    </cellStyles>
    <dxfs count="17">
      <dxf>
        <fill>
          <patternFill patternType="solid">
            <fgColor theme="4" tint="0.799981688894314"/>
            <bgColor theme="4" tint="0.799981688894314"/>
          </patternFill>
        </fill>
      </dxf>
      <dxf>
        <fill>
          <patternFill patternType="solid">
            <fgColor theme="4" tint="0.799981688894314"/>
            <bgColor theme="4" tint="0.799981688894314"/>
          </patternFill>
        </fill>
      </dxf>
      <dxf>
        <font>
          <b val="1"/>
          <color theme="1"/>
        </font>
      </dxf>
      <dxf>
        <font>
          <b val="1"/>
          <color theme="1"/>
        </font>
      </dxf>
      <dxf>
        <font>
          <b val="1"/>
          <color theme="1"/>
        </font>
        <border>
          <top style="double">
            <color theme="4"/>
          </top>
        </border>
      </dxf>
      <dxf>
        <font>
          <b val="1"/>
          <color theme="0"/>
        </font>
        <fill>
          <patternFill patternType="solid">
            <fgColor theme="4"/>
            <bgColor theme="4"/>
          </patternFill>
        </fill>
      </dxf>
      <dxf>
        <font>
          <color theme="1"/>
        </font>
        <border>
          <left style="thin">
            <color theme="4"/>
          </left>
          <right style="thin">
            <color theme="4"/>
          </right>
          <top style="thin">
            <color theme="4"/>
          </top>
          <bottom style="thin">
            <color theme="4"/>
          </bottom>
          <horizontal style="thin">
            <color theme="4" tint="0.399975585192419"/>
          </horizontal>
        </border>
      </dxf>
      <dxf>
        <fill>
          <patternFill patternType="solid">
            <fgColor theme="4" tint="0.799981688894314"/>
            <bgColor theme="4" tint="0.799981688894314"/>
          </patternFill>
        </fill>
        <border>
          <bottom style="thin">
            <color theme="4" tint="0.399975585192419"/>
          </bottom>
        </border>
      </dxf>
      <dxf>
        <font>
          <b val="1"/>
        </font>
        <fill>
          <patternFill patternType="solid">
            <fgColor theme="4" tint="0.799981688894314"/>
            <bgColor theme="4" tint="0.799981688894314"/>
          </patternFill>
        </fill>
        <border>
          <bottom style="thin">
            <color theme="4" tint="0.399975585192419"/>
          </bottom>
        </border>
      </dxf>
      <dxf>
        <font>
          <color theme="1"/>
        </font>
      </dxf>
      <dxf>
        <font>
          <color theme="1"/>
        </font>
        <border>
          <bottom style="thin">
            <color theme="4" tint="0.399975585192419"/>
          </bottom>
        </border>
      </dxf>
      <dxf>
        <font>
          <b val="1"/>
          <color theme="1"/>
        </font>
      </dxf>
      <dxf>
        <font>
          <b val="1"/>
          <color theme="1"/>
        </font>
        <border>
          <top style="thin">
            <color theme="4"/>
          </top>
          <bottom style="thin">
            <color theme="4"/>
          </bottom>
        </border>
      </dxf>
      <dxf>
        <fill>
          <patternFill patternType="solid">
            <fgColor theme="4" tint="0.799981688894314"/>
            <bgColor theme="4" tint="0.799981688894314"/>
          </patternFill>
        </fill>
      </dxf>
      <dxf>
        <fill>
          <patternFill patternType="solid">
            <fgColor theme="4" tint="0.799981688894314"/>
            <bgColor theme="4" tint="0.799981688894314"/>
          </patternFill>
        </fill>
      </dxf>
      <dxf>
        <font>
          <b val="1"/>
          <color theme="1"/>
        </font>
        <fill>
          <patternFill patternType="solid">
            <fgColor theme="4" tint="0.799981688894314"/>
            <bgColor theme="4" tint="0.799981688894314"/>
          </patternFill>
        </fill>
        <border>
          <top style="thin">
            <color theme="4" tint="0.399975585192419"/>
          </top>
          <bottom style="thin">
            <color theme="4" tint="0.399975585192419"/>
          </bottom>
        </border>
      </dxf>
      <dxf>
        <font>
          <b val="1"/>
          <color theme="1"/>
        </font>
        <fill>
          <patternFill patternType="solid">
            <fgColor theme="4" tint="0.799981688894314"/>
            <bgColor theme="4" tint="0.799981688894314"/>
          </patternFill>
        </fill>
        <border>
          <bottom style="thin">
            <color theme="4" tint="0.399975585192419"/>
          </bottom>
        </border>
      </dxf>
    </dxfs>
    <tableStyles count="2" defaultTableStyle="TableStylePreset3_Accent1" defaultPivotStyle="PivotStylePreset2_Accent1">
      <tableStyle name="TableStylePreset3_Accent1" pivot="0" count="7" xr9:uid="{59DB682C-5494-4EDE-A608-00C9E5F0F923}">
        <tableStyleElement type="wholeTable" dxfId="6"/>
        <tableStyleElement type="headerRow" dxfId="5"/>
        <tableStyleElement type="totalRow" dxfId="4"/>
        <tableStyleElement type="firstColumn" dxfId="3"/>
        <tableStyleElement type="lastColumn" dxfId="2"/>
        <tableStyleElement type="firstRowStripe" dxfId="1"/>
        <tableStyleElement type="firstColumnStripe" dxfId="0"/>
      </tableStyle>
      <tableStyle name="PivotStylePreset2_Accent1" table="0" count="10" xr9:uid="{267968C8-6FFD-4C36-ACC1-9EA1FD1885CA}">
        <tableStyleElement type="headerRow" dxfId="16"/>
        <tableStyleElement type="totalRow" dxfId="15"/>
        <tableStyleElement type="firstRowStripe" dxfId="14"/>
        <tableStyleElement type="firstColumnStripe" dxfId="13"/>
        <tableStyleElement type="firstSubtotalRow" dxfId="12"/>
        <tableStyleElement type="secondSubtotalRow" dxfId="11"/>
        <tableStyleElement type="firstRowSubheading" dxfId="10"/>
        <tableStyleElement type="secondRowSubheading" dxfId="9"/>
        <tableStyleElement type="pageFieldLabels" dxfId="8"/>
        <tableStyleElement type="pageFieldValues" dxfId="7"/>
      </tableStyle>
    </tableStyles>
    <extLst>
      <ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}"
        xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main">
        <x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/>
      </ext>
    </extLst>
  </styleSheet>`}var Qn=o=>`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
            <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>
            <Default Extension="xml" ContentType="application/xml"/>
            <Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/>
            <Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/>
            <Override PartName="/docProps/custom.xml" ContentType="application/vnd.openxmlformats-officedocument.custom-properties+xml"/>
            <Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/>
            <Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/>
            <Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>
            ${o}
          </Types>`,Zn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/>
<Relationship Id="rId3" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/>
<Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/>
<Relationship Id="rId4" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties" Target="docProps/custom.xml"/>
</Relationships>`,Yn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="WPS">
  <a:themeElements>
    <a:clrScheme name="WPS">
      <a:dk1>
        <a:sysClr val="windowText" lastClr="000000"/>
      </a:dk1>
      <a:lt1>
        <a:sysClr val="window" lastClr="FFFFFF"/>
      </a:lt1>
      <a:dk2>
        <a:srgbClr val="44546A"/>
      </a:dk2>
      <a:lt2>
        <a:srgbClr val="E7E6E6"/>
      </a:lt2>
      <a:accent1>
        <a:srgbClr val="4874CB"/>
      </a:accent1>
      <a:accent2>
        <a:srgbClr val="EE822F"/>
      </a:accent2>
      <a:accent3>
        <a:srgbClr val="F2BA02"/>
      </a:accent3>
      <a:accent4>
        <a:srgbClr val="75BD42"/>
      </a:accent4>
      <a:accent5>
        <a:srgbClr val="30C0B4"/>
      </a:accent5>
      <a:accent6>
        <a:srgbClr val="E54C5E"/>
      </a:accent6>
      <a:hlink>
        <a:srgbClr val="0026E5"/>
      </a:hlink>
      <a:folHlink>
        <a:srgbClr val="7E1FAD"/>
      </a:folHlink>
    </a:clrScheme>
    <a:fontScheme name="WPS">
      <a:majorFont>
        <a:latin typeface="Calibri Light"/>
        <a:ea typeface=""/>
        <a:cs typeface=""/>
        <a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>
        <a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>
        <a:font script="Hans" typeface="\u5B8B\u4F53"/>
        <a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>
        <a:font script="Arab" typeface="Times New Roman"/>
        <a:font script="Hebr" typeface="Times New Roman"/>
        <a:font script="Thai" typeface="Tahoma"/>
        <a:font script="Ethi" typeface="Nyala"/>
        <a:font script="Beng" typeface="Vrinda"/>
        <a:font script="Gujr" typeface="Shruti"/>
        <a:font script="Khmr" typeface="MoolBoran"/>
        <a:font script="Knda" typeface="Tunga"/>
        <a:font script="Guru" typeface="Raavi"/>
        <a:font script="Cans" typeface="Euphemia"/>
        <a:font script="Cher" typeface="Plantagenet Cherokee"/>
        <a:font script="Yiii" typeface="Microsoft Yi Baiti"/>
        <a:font script="Tibt" typeface="Microsoft Himalaya"/>
        <a:font script="Thaa" typeface="MV Boli"/>
        <a:font script="Deva" typeface="Mangal"/>
        <a:font script="Telu" typeface="Gautami"/>
        <a:font script="Taml" typeface="Latha"/>
        <a:font script="Syrc" typeface="Estrangelo Edessa"/>
        <a:font script="Orya" typeface="Kalinga"/>
        <a:font script="Mlym" typeface="Kartika"/>
        <a:font script="Laoo" typeface="DokChampa"/>
        <a:font script="Sinh" typeface="Iskoola Pota"/>
        <a:font script="Mong" typeface="Mongolian Baiti"/>
        <a:font script="Viet" typeface="Times New Roman"/>
        <a:font script="Uigh" typeface="Microsoft Uighur"/>
        <a:font script="Geor" typeface="Sylfaen"/>
      </a:majorFont>
      <a:minorFont>
        <a:latin typeface="Calibri"/>
        <a:ea typeface=""/>
        <a:cs typeface=""/>
        <a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>
        <a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>
        <a:font script="Hans" typeface="\u5B8B\u4F53"/>
        <a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>
        <a:font script="Arab" typeface="Arial"/>
        <a:font script="Hebr" typeface="Arial"/>
        <a:font script="Thai" typeface="Tahoma"/>
        <a:font script="Ethi" typeface="Nyala"/>
        <a:font script="Beng" typeface="Vrinda"/>
        <a:font script="Gujr" typeface="Shruti"/>
        <a:font script="Khmr" typeface="DaunPenh"/>
        <a:font script="Knda" typeface="Tunga"/>
        <a:font script="Guru" typeface="Raavi"/>
        <a:font script="Cans" typeface="Euphemia"/>
        <a:font script="Cher" typeface="Plantagenet Cherokee"/>
        <a:font script="Yiii" typeface="Microsoft Yi Baiti"/>
        <a:font script="Tibt" typeface="Microsoft Himalaya"/>
        <a:font script="Thaa" typeface="MV Boli"/>
        <a:font script="Deva" typeface="Mangal"/>
        <a:font script="Telu" typeface="Gautami"/>
        <a:font script="Taml" typeface="Latha"/>
        <a:font script="Syrc" typeface="Estrangelo Edessa"/>
        <a:font script="Orya" typeface="Kalinga"/>
        <a:font script="Mlym" typeface="Kartika"/>
        <a:font script="Laoo" typeface="DokChampa"/>
        <a:font script="Sinh" typeface="Iskoola Pota"/>
        <a:font script="Mong" typeface="Mongolian Baiti"/>
        <a:font script="Viet" typeface="Arial"/>
        <a:font script="Uigh" typeface="Microsoft Uighur"/>
        <a:font script="Geor" typeface="Sylfaen"/>
      </a:minorFont>
    </a:fontScheme>
    <a:fmtScheme name="WPS">
      <a:fillStyleLst>
        <a:solidFill>
          <a:schemeClr val="phClr"/>
        </a:solidFill>
        <a:gradFill>
          <a:gsLst>
            <a:gs pos="0">
              <a:schemeClr val="phClr">
                <a:lumOff val="17500"/>
              </a:schemeClr>
            </a:gs>
            <a:gs pos="100000">
              <a:schemeClr val="phClr"/>
            </a:gs>
          </a:gsLst>
          <a:lin ang="2700000" scaled="0"/>
        </a:gradFill>
        <a:gradFill>
          <a:gsLst>
            <a:gs pos="0">
              <a:schemeClr val="phClr">
                <a:hueOff val="-2520000"/>
              </a:schemeClr>
            </a:gs>
            <a:gs pos="100000">
              <a:schemeClr val="phClr"/>
            </a:gs>
          </a:gsLst>
          <a:lin ang="2700000" scaled="0"/>
        </a:gradFill>
      </a:fillStyleLst>
      <a:lnStyleLst>
        <a:ln w="12700" cap="flat" cmpd="sng" algn="ctr">
          <a:solidFill>
            <a:schemeClr val="phClr"/>
          </a:solidFill>
          <a:prstDash val="solid"/>
          <a:miter lim="800000"/>
        </a:ln>
        <a:ln w="12700" cap="flat" cmpd="sng" algn="ctr">
          <a:solidFill>
            <a:schemeClr val="phClr"/>
          </a:solidFill>
          <a:prstDash val="solid"/>
          <a:miter lim="800000"/>
        </a:ln>
        <a:ln w="12700" cap="flat" cmpd="sng" algn="ctr">
          <a:gradFill>
            <a:gsLst>
              <a:gs pos="0">
                <a:schemeClr val="phClr">
                  <a:hueOff val="-4200000"/>
                </a:schemeClr>
              </a:gs>
              <a:gs pos="100000">
                <a:schemeClr val="phClr"/>
              </a:gs>
            </a:gsLst>
            <a:lin ang="2700000" scaled="1"/>
          </a:gradFill>
          <a:prstDash val="solid"/>
          <a:miter lim="800000"/>
        </a:ln>
      </a:lnStyleLst>
      <a:effectStyleLst>
        <a:effectStyle>
          <a:effectLst>
            <a:outerShdw blurRad="101600" dist="50800" dir="5400000" algn="ctr" rotWithShape="0">
              <a:schemeClr val="phClr">
                <a:alpha val="60000"/>
              </a:schemeClr>
            </a:outerShdw>
          </a:effectLst>
        </a:effectStyle>
        <a:effectStyle>
          <a:effectLst>
            <a:reflection stA="50000" endA="300" endPos="40000" dist="25400" dir="5400000" sy="-100000" algn="bl" rotWithShape="0"/>
          </a:effectLst>
        </a:effectStyle>
        <a:effectStyle>
          <a:effectLst>
            <a:outerShdw blurRad="57150" dist="19050" dir="5400000" algn="ctr" rotWithShape="0">
              <a:srgbClr val="000000">
                <a:alpha val="63000"/>
              </a:srgbClr>
            </a:outerShdw>
          </a:effectLst>
        </a:effectStyle>
      </a:effectStyleLst>
      <a:bgFillStyleLst>
        <a:solidFill>
          <a:schemeClr val="phClr"/>
        </a:solidFill>
        <a:solidFill>
          <a:schemeClr val="phClr">
            <a:tint val="95000"/>
            <a:satMod val="170000"/>
          </a:schemeClr>
        </a:solidFill>
        <a:gradFill rotWithShape="1">
          <a:gsLst>
            <a:gs pos="0">
              <a:schemeClr val="phClr">
                <a:tint val="93000"/>
                <a:satMod val="150000"/>
                <a:shade val="98000"/>
                <a:lumMod val="102000"/>
              </a:schemeClr>
            </a:gs>
            <a:gs pos="50000">
              <a:schemeClr val="phClr">
                <a:tint val="98000"/>
                <a:satMod val="130000"/>
                <a:shade val="90000"/>
                <a:lumMod val="103000"/>
              </a:schemeClr>
            </a:gs>
            <a:gs pos="100000">
              <a:schemeClr val="phClr">
                <a:shade val="63000"/>
                <a:satMod val="120000"/>
              </a:schemeClr>
            </a:gs>
          </a:gsLst>
          <a:lin ang="5400000" scaled="0"/>
        </a:gradFill>
      </a:bgFillStyleLst>
    </a:fmtScheme>
  </a:themeElements>
  <a:objectDefaults/>
</a:theme>`,qn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
<Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties"
xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes">
<property fmtid="{D5CDD505-2E9C-101B-9397-08002B2CF9AE}" pid="2" name="ICV">
  <vt:lpwstr>A43D6FDBA27248266CF32D6511460B89_41</vt:lpwstr>
</property>
<property fmtid="{D5CDD505-2E9C-101B-9397-08002B2CF9AE}" pid="3" name="KSOProductBuildVer">
  <vt:lpwstr>1033-6.2.1.8344</vt:lpwstr>
</property>
</Properties>`;function Jn(o,e,t,r,n){let i="";if(r){let c=[];for(let[d,h]of Object.entries(r)){if(!d.startsWith(n)||!h)continue;let p=parseInt(d.slice(n.length+1),10)+1;c.push(`<col min="${p}" max="${p}" width="${h.len/wr}" customWidth="1" ${h.isHide?'hidden="1"':""}/>`)}i=`<cols>${c.join("")}</cols>`}let s={...o,sheetId:""},a=e?`<sheetData>${e}</sheetData>`:"<sheetData/>";return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"
      xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"
      xmlns:xdr="http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"
      xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:etc="http://www.wps.cn/officeDocument/2017/etCustomData">
      <sheetPr/>
      <dimension ref="A1:B1"/>
      <sheetViews>
        <sheetView ${t?'tabSelected="1"':""} workbookViewId="0">
          <selection activeCell="${Re({row:o.row,col:o.col,rowCount:1,colCount:1,sheetId:""})}" sqref="${Re(s)}"/>
        </sheetView>
      </sheetViews>
      <sheetFormatPr defaultColWidth="9" defaultRowHeight="16.8" outlineLevelCol="1"/>
      ${i}
      ${a}
      <pageMargins left="0.75" right="0.75" top="1" bottom="1" header="0.5" footer="0.5"/>
      <headerFooter/>
    </worksheet>`}function _n(o){return`FF${Mt(o).slice(1,-2)}`}function ys(o,e){if(!e||xe(e))return;let t=[],r={fontId:"0",fillId:"0",numFmtId:"0",applyAlignment:"",applyFill:"",applyFont:"",applyNumberFormat:""};e.fillColor&&(r.fillId=String(o.fills.length),t.push('applyFill="1"'),o.fills.push(`<fill>
    <patternFill patternType="solid">
      <fgColor rgb="${_n(e.fillColor)}"/>
      <bgColor indexed="64"/>
    </patternFill>
  </fill>`));let n=[];(e.underline===1||e.underline===2)&&n.push("<u/>"),e.isBold&&n.push("<b/>"),e.isItalic&&n.push("<i/>"),e.isStrike&&n.push("<strike/>"),typeof e.fontSize<"u"&&n.push(`<sz val="${e.fontSize}"/>`),e.fontColor&&n.push(`<color rgb="${_n(e.fontColor)}"/>`),e.fontFamily&&n.push(`<name val="${e.fontFamily}"/>`),n.length>0&&(r.fontId=String(o.fonts.length),t.push('applyFont="1"'),o.fonts.push(`<font>${n.join("")}<charset val="0"/><scheme val="minor"/></font>`));let i=eo.find(l=>l.id===e.numberFormat);i&&(t.push('applyNumberFormat="1"'),r.numFmtId=String(e.numberFormat),o.numFmts.push(`<numFmt numFmtId="${e.numberFormat}" formatCode="${i.formatCode}"/>`));let s='<alignment vertical="center"/>';if(e.isWrapText||e.horizontalAlign!==void 0||e.verticalAlign!==void 0){let l=[];if(t.push('applyAlignment="1"'),e.isWrapText&&l.push('wrapText="1"'),e.horizontalAlign!==void 0){let c={0:"left",1:"center",2:"right"};l.push(`horizontal="${c[e.horizontalAlign]}"`)}if(e.verticalAlign!==void 0){let c={0:"top",1:"center",2:"bottom"};e.verticalAlign!==2&&l.push(`vertical="${c[e.verticalAlign]}"`)}s=`<alignment ${l.join(" ")}/>`}let a=`<xf numFmtId="${r.numFmtId}" fontId="${r.fontId}" fillId="${r.fillId}" borderId="0" xfId="0" ${t.join(" ")}>${s}</xf>`;o.cellXfs.push(a)}async function $n(o,e){let t=(await import("./jszip.min-5GWVJJCY.js")).default,r=e.toJSON(),n=e.getCurrentSheetId(),i=Object.values(r.workbook),s={};for(let y=0;y<i.length;y++){let I=i[y],k=y+1;s[I.sheetId]={rid:`rId${k}`,target:`sheet${k}.xml`}}let a=new t,l=i.map(y=>`<Override PartName="/xl/worksheets/${s[y.sheetId].target}" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>`).join("");a.file("[Content_Types].xml",Qn(l)),a.folder("_rels").file(".rels",Zn);let d=a.folder("docProps");d.file("app.xml",`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
<Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"
  xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes">
  <Application>WPS Spreadsheets</Application>
  <HeadingPairs>
    <vt:vector size="2" baseType="variant">
      <vt:variant>
        <vt:lpstr>\u5DE5\u4F5C\u8868</vt:lpstr>
      </vt:variant>
      <vt:variant>
        <vt:i4>1</vt:i4>
      </vt:variant>
    </vt:vector>
  </HeadingPairs>
  <TitlesOfParts>
    <vt:vector size="${i.length}" baseType="lpstr">
      ${i.map(y=>`<vt:lpstr>${s[y.sheetId].target}</vt:lpstr>`).join("")}
    </vt:vector>
  </TitlesOfParts>
</Properties>`),d.file("core.xml",Kn()),d.file("custom.xml",qn);let h=a.folder("xl"),p={cellXfs:[`<xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0">
    <alignment vertical="center"/>
  </xf>`],numFmts:[],fonts:[`<font>
    <sz val="11"/>
    <color theme="1"/>
    <name val="Calibri"/>
    <charset val="134"/>
    <scheme val="minor"/>
  </font>`],fills:[`<fill>
    <patternFill patternType="none"/>
  </fill>`]},g=i.findIndex(y=>y.sheetId===n),C=y=>{let I=y||n;return i.find(k=>k.sheetId===I)?.name||""},u=[];for(let y of Object.keys(r.definedNames)){let I=r.definedNames[y],k=Re(I,"absolute",C);u.push(`<definedName name="${y}">${k}</definedName>`)}let m=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
  <workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"
    xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">
    <fileVersion appName="xl" lastEdited="3" lowestEdited="5" rupBuild="9302"/>
    <workbookPr/>
    <bookViews>
      <workbookView windowWidth="28800" windowHeight="11340" ${g>0?`activeTab="${g}"`:""} />
    </bookViews>
    <sheets>
      ${i.map(y=>`<sheet name="${y.name}" sheetId="${y.sheetId}" r:id="${s[y.sheetId].rid}" ${y.isHide?'state="hidden"':""}/>`).join("")}
    </sheets>
    ${u.length>0?`<definedNames>${u.join("")}</definedNames>`:""}
    <calcPr calcId="144525"/>
  </workbook>`;h.file("workbook.xml",m);let f=h.folder("_rels"),b=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
  <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
    <Relationship Id="rId${i.length+2}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>
    <Relationship Id="rId${i.length+1}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/>
    ${i.map(y=>{let I=s[y.sheetId];return`<Relationship Id="${I.rid}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/${I.target}"/>`}).reverse().join("")}
  </Relationships>`;f.file("workbook.xml.rels",b),h.folder("theme").file("theme1.xml",Yn);let v=h.folder("worksheets");for(let y of i){let I=r.rangeMap[y.sheetId],k=s[y.sheetId],D=r.worksheets[y.sheetId],ae=y.sheetId===n;if(!D){v.file(k.target,Jn(I,"",ae,r.customWidth,y.sheetId));continue}let $=new Map,ke=[];for(let[ue,Y]of Object.entries(D)){let V=_e(ue),fe=Re({...V,rowCount:1,colCount:1,sheetId:""}),Ze=$.get(V.row)||[],ee=Y.formula?`<f>${Y.formula.slice(1)}</f>`:"",Rt=ee?"":`<v>${ro(Y.value)}</v>`,Yt="";Y.style&&!xe(Y.style)&&(Yt=`s="${p.cellXfs.length}"`,ys(p,Y.style)),Ze.push(`<c r="${fe}" ${Yt}>${ee}${Rt}</c>`),$.set(V.row,Ze)}let ut=Array.from($.keys());ut.sort();for(let ue of ut){let Y=r.customHeight[ge(y.sheetId,ue)],V="";Y&&(V=`ht="${Y.len}" customHeight="1" ${Y.isHide?'hidden="1"':""}`),ke.push(`<row r="${ue+1}" ${V}>${$.get(ue).join("")}</row>`)}v.file(k.target,Jn(I,ke.join(""),ae,r.customWidth,y.sheetId))}h.file("styles.xml",Gn(p));let S=await a.generateAsync({type:"blob"});et(S,o)}var ko=",",ei=`
`;function bs(o){let e=typeof o;return e==="string"?o:e==="bigint"||e==="number"?""+o:e==="boolean"?o?"TRUE":"FALSE":o instanceof Date?""+o.getTime():e==="object"&&o!==null?JSON.stringify(o):""}function vs(o){let e='"',n='"',s="";for(let a=0;a<o.length;a++){let l=o[a],c=bs(l);if(c==="")s+=c;else if(c){ce(typeof c=="string",`Formatter must return a string, null or undefined, got ${JSON.stringify(c)}`);let d=ko.length&&c.indexOf(ko)>=0,h=c.indexOf(e)>=0,p=c.indexOf(n)>=0&&n!==e,g=c.indexOf(ei)>=0,C=!1;if(0)switch(c[0]){case"=":case"+":case"-":case"@":case"	":case"\r":case"\uFF1D":case"\uFF0B":case"\uFF0D":case"\uFF20":}let u=h===!0||d||g||!1||C;if(u===!0&&p===!0){let m=new RegExp(n,"g");c=c.replace(m,n+n)}if(h===!0){let m=new RegExp(e,"g");c=c.replace(m,n+e)}u===!0&&(c=e+c+e),s+=c}a!==o.length-1&&(s+=ko)}return s}function ti(o,e){let t=e.toJSON().worksheets[e.getCurrentSheetId()],r=[],n=e.getSheetInfo(e.getCurrentSheetId());if(t)for(let a=0;a<n.rowCount;a++){let l=[];for(let c=0;c<n.colCount;c++){let d=U(a,c);l.push(t[d]?.value)}r.push(vs(l))}let i=Array.from({length:n.colCount}).fill("").join(ko);for(;r.length>0&&r[r.length-1]===i;)r.pop();let s=new Blob([r.join(ei)],{type:"text/csv;charset=utf-8;"});et(s,o)}var Kt={"menubar-container":"Wr","menubar-menu":"Xr","theme-button":"_r"};var Ae=E(N());function Sr(o){let e=Object.keys(o);for(let t of e){let r=`--${t}`,n=String(o[t]||"");document.documentElement.style.setProperty(r,n)}}function oi(o){Sr(o==="dark"?tn:en),document.documentElement.setAttribute("data-theme",o)}var ri=(0,Ae.memo)(({toggleTheme:o})=>{let[e,t]=(0,Ae.useState)("light");(0,Ae.useEffect)(()=>{Sr($e)},[]),(0,Ae.useEffect)(()=>{let n=i=>{t(i),Uo(i),oi(i),o()};n(on()),window.matchMedia&&typeof window.matchMedia=="function"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",i=>{let{matches:s}=i;n(s?"dark":"light")})},[o]);let r=n=>{let i=n==="dark"?"light":"dark";oi(i),Uo(i),t(i),o()};return Ae.default.createElement("div",null,Ae.default.createElement(w,{onClick:()=>r(e),className:Kt["theme-button"]},Ae.default.createElement(de,{name:e==="light"?"moon":"sun"})))});var ni={width:150,flex:1},ii=({controller:o})=>{let e=(0,le.useRef)(null),t=()=>{$n(`excel_${Date.now()}.xlsx`,o)},r=()=>{ti(`excel_${Date.now()}.csv`,o)},n=async i=>{i.stopPropagation();let s=i.target.files?.[0];if(!s)return;let a=await Xn(s);o.fromJSON(a),e.current.value="",e.current.blur()};return le.default.createElement("div",{className:Kt["menubar-container"],"data-testid":"menubar"},le.default.createElement("div",{className:Kt["menubar-menu"]},le.default.createElement(xn,{menuButton:le.default.createElement(w,null,"Menu"),style:ni,testId:"menubar-excel"},le.default.createElement(wo,{testId:"menubar-import-xlsx"},le.default.createElement("input",{type:"file",hidden:!0,onChange:n,accept:".xlsx",ref:e,id:"import_xlsx"}),le.default.createElement("label",{htmlFor:"import_xlsx"},"import XLSX")),le.default.createElement(vn,{label:"Export",style:ni,testId:"menubar-export"},le.default.createElement(wo,{onClick:t,testId:"menubar-export-xlsx"},"Export XLSX"),le.default.createElement(wo,{testId:"menubar-export-csv",onClick:r},"Export CSV")))),le.default.createElement(ri,{toggleTheme:()=>o.setChangeSet(new Set(["cellStyle"]))}))};var Ir=({controller:o})=>ht.default.createElement("div",{className:Un["app-container"],"data-testid":"app-container"},ht.default.createElement(ii,{controller:o}),ht.default.createElement(fr,{controller:o}),ht.default.createElement(ur,{controller:o}),ht.default.createElement(hr,{controller:o}),ht.default.createElement(Cr,{controller:o}));Ir.displayName="App";var gi=E(xo()),Zt=E(N());var Ar=24,kr=34,ws={top:0,left:0,row:0,col:0,scrollLeft:0,scrollTop:0},Gt=class{constructor(e){this.scrollValue={};this.changeSet=new Set;this.copyRanges=[];this.isCut=!1;this.floatElementUuid="";this.hooks={modelChange(){},async copyOrCut(){return""},async paste(){return{[bt]:"",[yt]:""}}};this.viewSize={width:0,height:0};this.headerSize={width:kr,height:Ar};this.mainDom={};this.addSheet=()=>{this.changeSet.add("sheetList"),this.changeSet.add("range"),this.model.addSheet(),this.setScroll({top:0,left:0,row:0,col:0,scrollLeft:0,scrollTop:0})};this.deleteSheet=e=>{this.model.deleteSheet(e),this.changeSet.add("sheetList"),this.changeSet.add("sheetId"),this.changeSet.add("range"),this.emitChange()};this.getCell=e=>this.model.getCell(e);this.model=e}getCurrentSheetId(){return this.model.getCurrentSheetId()}getSheetList(){return this.model.getSheetList()}getSheetInfo(e){return this.model.getSheetInfo(e)}setHooks(e){this.hooks=e}emitChange(){if(this.changeSet.size===0)return;this.computeViewSize();let e=this.changeSet;this.changeSet=new Set,Xr(e),this.model.emitChange(e),this.hooks.modelChange(e)}getActiveCell(){return this.model.getActiveCell()}getRange(e){let t=this.getMergeCells(this.getCurrentSheetId());if(t.length===0)return{range:e,isMerged:!1};for(let r of t)if(co(e.row,e.col,r))return{range:{...r,sheetId:r.sheetId||this.getCurrentSheetId()},isMerged:!0};return{range:e,isMerged:!1}}getActiveRange(){let e=this.getActiveCell();return this.getRange(e)}setNextActiveCell(e){let t=this.getActiveCell(),r=t.col,n=t.row,i=this.getSheetInfo(t.sheetId),s=this.getMergeCells(t.sheetId),a={...t};if(e==="left"){for(r--;;){let c=!1,d=!1;for(let h of s)if(r>=h.col&&r<h.col+h.colCount){r=Math.min(r,h.col-1),c=!0;break}for(;r>0&&this.getColWidth(r).len<=0;)r--,d=!0;if(r<=0){r=0;break}if(!d&&!c)break}a.col=r}if(e==="right"){for(r++;;){let c=!1,d=!1;for(let h of s)if(r>=h.col&&r<h.col+h.colCount){r=Math.max(r,h.col+h.colCount),c=!0;break}for(;r<i.colCount&&this.getColWidth(r).len<=0;)r++,d=!0;if(r>=i.colCount-1){r=i.colCount-1;break}if(!d&&!c)break}a.col=r}if(e==="up"){for(n--;;){let c=!1,d=!1;for(let h of s)if(n>=h.row&&n<h.row+h.rowCount){n=Math.min(n,h.row-1),c=!0;break}for(;n>0&&this.getColWidth(n).len<=0;)n--,d=!0;if(n<=0){n=0;break}if(!d&&!c)break}a.row=n}if(e==="down"){for(n++;;){let c=!1,d=!1;for(let h of s)if(n>=h.row&&n<h.row+h.rowCount){n=Math.max(n,h.row+h.rowCount),c=!0;break}for(;n<i.rowCount&&this.getColWidth(n).len<=0;)n++,d=!0;if(n>=i.rowCount-1){n=i.rowCount-1;break}if(!d&&!c)break}a.row=n}let l=this.getRange(a).range;return this.setActiveCell(l),l}setSheetCell(e){let t=e.sheetId||this.model.getCurrentSheetId();e.sheetId=t,this.model.setActiveCell(e),this.changeSet.add("range")}setActiveCell(e){this.setSheetCell(e),this.emitChange()}setCurrentSheetId(e){if(e===this.getCurrentSheetId())return;this.model.setCurrentSheetId(e),this.changeSet.add("sheetId"),this.changeSet.add("cellValue");let t=this.getActiveCell();this.setSheetCell(t),this.setScroll(this.getScroll())}setTabColor(e,t){this.model.setTabColor(e,t),this.changeSet.add("sheetList"),this.emitChange()}hideSheet(e){this.model.hideSheet(e),this.changeSet.add("sheetList"),this.changeSet.add("sheetId"),this.changeSet.add("range"),this.emitChange()}unhideSheet(e){this.model.unhideSheet(e),this.changeSet.add("sheetList"),this.changeSet.add("sheetId"),this.changeSet.add("range"),this.emitChange()}renameSheet(e,t){this.model.renameSheet(e,t),this.changeSet.add("sheetList"),this.emitChange()}fromJSON(e){this.model.fromJSON(e),this.changeSet.add("sheetList"),this.changeSet.add("sheetId"),this.changeSet.add("range"),this.changeSet.add("floatElement"),this.changeSet.add("cellValue"),this.setSheetCell(this.getActiveCell()),this.emitChange()}toJSON(){return this.model.toJSON()}setCellValues(e,t,r){this.model.setCellValues(e,t,r),this.changeSet.add("cellValue"),this.emitChange()}updateCellStyle(e,t){this.model.updateCellStyle(e,t),this.changeSet.add("cellStyle"),this.emitChange()}canRedo(){return this.model.canRedo()}canUndo(){return this.model.canUndo()}undo(){this.model.undo(),this.changeSet.add("range"),this.changeSet.add("sheetList"),this.changeSet.add("sheetId"),this.changeSet.add("scroll"),this.changeSet.add("floatElement"),this.changeSet.add("cellValue"),this.changeSet.add("undoRedo"),this.emitChange()}redo(){this.model.redo(),this.changeSet.add("range"),this.changeSet.add("sheetList"),this.changeSet.add("sheetId"),this.changeSet.add("scroll"),this.changeSet.add("floatElement"),this.changeSet.add("cellValue"),this.changeSet.add("undoRedo"),this.emitChange()}getColWidth(e,t){return this.model.getColWidth(e,t)}setColWidth(e,t,r,n){this.model.setColWidth(e,t,r,n),this.changeSet.add("col"),r&&this.emitChange()}getRowHeight(e,t){return this.model.getRowHeight(e,t)}setRowHeight(e,t,r,n){this.model.setRowHeight(e,t,r,n),this.changeSet.add("row"),r&&this.emitChange()}computeViewSize(){let e=this.getHeaderSize(),t=this.model.getSheetInfo(this.model.getCurrentSheetId());if(!t)return;let{width:r}=e,{height:n}=e;for(let i=0;i<t.colCount;i++)r+=this.getColWidth(i).len;for(let i=0;i<t.rowCount;i++)n+=this.getRowHeight(i).len;this.viewSize={width:r,height:n}}getViewSize(){return{...this.viewSize}}getCellSize(e){return e.sheetId=e.sheetId||this.getCurrentSheetId(),this.getRangeSize(e)}getRangeSize(e){let{row:t,col:r,colCount:n,rowCount:i}=e,s=e.sheetId||this.getCurrentSheetId();if(n===0||i===0)return{width:this.getColWidth(r,s).len,height:this.getRowHeight(t,s).len};let a=0,l=0;for(let c=t,d=t+i;c<d;c++)l+=this.getRowHeight(c,s).len;for(let c=r,d=r+n;c<d;c++)a+=this.getColWidth(c,s).len;return{width:a,height:l}}getHeaderSize(){return{...this.headerSize}}computeCellPosition(e){let{row:t,col:r}=e,n=e.sheetId||this.model.getCurrentSheetId(),i=this.getHeaderSize(),s=this.getScroll(n),a=i.width,l=i.height,c=s.row,d=s.col;if(r>=s.col)for(;d<r;)a+=this.getColWidth(d,n).len,d++;else for(a=-i.width;d>r;)a-=this.getColWidth(d,n).len,d--;if(t>=s.row)for(;c<t;)l+=this.getRowHeight(c,n).len,c++;else for(l=-i.height;c>t;)l-=this.getRowHeight(c,n).len,c--;return{top:l,left:a}}addRow(e,t){this.model.addRow(e,t),this.changeSet.add("row"),this.emitChange()}addCol(e,t){this.model.addCol(e,t),this.changeSet.add("col"),this.emitChange()}deleteCol(e,t){this.model.deleteCol(e,t),this.changeSet.add("col"),this.emitChange()}deleteRow(e,t){this.model.deleteRow(e,t),this.changeSet.add("row"),this.emitChange()}hideCol(e,t){this.model.hideCol(e,t),this.changeSet.add("col"),this.emitChange()}hideRow(e,t){this.model.hideRow(e,t),this.changeSet.add("row"),this.emitChange()}getChangeSet(){let e=this.changeSet;return this.changeSet=new Set,e}setChangeSet(e){this.changeSet=e,this.emitChange()}getScroll(e){let t=e||this.model.getCurrentSheetId();return{...this.scrollValue[t]||{...ws}}}setScroll(e){let t=this.model.getCurrentSheetId();this.scrollValue[t]={...e},e.row>9999?this.headerSize={width:Math.floor(kr*2),height:Ar}:this.headerSize={width:kr,height:Ar},this.changeSet.add("scroll"),this.emitChange()}parseText(e){let t;if(e.indexOf(`\r
`)>-1?t=e.split(`\r
`).map(s=>s).map(s=>s.split("	")):t=e.split(`
`).map(s=>s).map(s=>s.split("	")),t[0].length!==t[t.length-1].length){let s=t[t.length-1];s.length===1&&!s[0]&&t.pop()}let r=t.length,n=0;for(let s of t)s.length>n&&(n=s.length);let i=this.getActiveCell();return{value:t,style:[],range:{...i,rowCount:r,colCount:n}}}parseHTML(e){let{textList:t,styleList:r}=Hr(e),n=t.length,i=this.getActiveCell(),s=Math.max(...t.map(a=>a.length));return{value:t,style:r,range:{...i,rowCount:n,colCount:s}}}getCopyData(){let e=this.getActiveCell(),{row:t,col:r,rowCount:n,colCount:i}=e,s=[],a=[],l=1,c=[],d=this.model.getCurrentSheetId();for(let g=t,C=t+n;g<C;g++){let u=[],m=[];for(let f=r,b=r+i;f<b;f++){let x=this.model.getCell(new Le(g,f,1,1,d));if(!x)continue;let v=String(x.value||"");if(u.push(v),x.style){let S=Dr(x.style);v||(S+="mso-pattern:black none;");let y=`xl${l++}`;c.push(`.${y}{${S}}`),m.push(`<td class="${y}"> ${v} </td>`)}else m.push(`<td> ${v} </td>`)}s.push(u),a.push(m)}let h=_r(c.join(`
`),a.map(g=>`<tr>${g.join(`
`)}</tr>`).join(`
`)),p=`${s.map(g=>g.join("	")).join(`\r
`)}\r
`;return{[yt]:p,[bt]:h}}paste(e){if(this.floatElementUuid){if(this.isCut){let t=this.floatElementUuid,r=this.getActiveCell();this.model.updateFloatElement(t,{fromCol:r.col,fromRow:r.row,marginX:0,marginY:0}),this.changeSet.add("floatElement"),this.copyRanges=[],this.isCut=!1,this.floatElementUuid="",this.emitChange()}else{let r=this.getFloatElementList(this.getCurrentSheetId()).find(n=>n.uuid===this.floatElementUuid);if(r){let n=this.getCellSize({row:r.fromRow,col:r.fromCol,rowCount:1,colCount:1,sheetId:r.sheetId}),{marginX:i,marginY:s}=r,a=14;i+a<n.width?i+=a:i-a>=0&&(i-=a),s+a<n.width?s+=a:s-a>=0&&(s-=a),this.addFloatElement({...r,uuid:Fe(),marginX:i,marginY:s})}}return}this.basePaste(e)}async basePaste(e){let t="",r="";if(e)t=e.clipboardData?.getData(bt)||"",r=e.clipboardData?.getData(yt)||"";else{let s=await this.hooks.paste();t=s[bt],r=s[yt]}t=t.trim(),r=r.trim();let n=this.getActiveCell();this.changeSet.add("cellValue");let i=!1;if(t){let s=this.parseHTML(t);s.value.length>0&&(n=s.range,this.changeSet.add("cellStyle"),this.model.setCellValues(s.value,s.style,[s.range]),i=!0)}if(!i&&r){let s=this.parseText(r);s.value.length>0&&(n=s.range,this.model.setCellValues(s.value,[],[s.range]),i=!0)}if(!i&&this.copyRanges.length>0){let[s]=this.copyRanges.slice();this.changeSet.add("cellStyle"),n=this.model.pasteRange(s,this.isCut)}this.isCut&&(this.copyRanges=[],this.isCut=!1,this.hooks.copyOrCut({[yt]:"",[bt]:""},"copy")),this.setActiveCell(n)}copy(e){this.copyRanges=[this.getActiveCell()],this.isCut=!1,this.baseCopy("copy",e)}cut(e){this.copyRanges=[this.getActiveCell()],this.isCut=!0,this.baseCopy("cut",e)}baseCopy(e,t){let r=this.getCopyData();if(t){let n=Object.keys(r);for(let i of n)t.clipboardData?.setData(i,r[i])}else this.hooks.copyOrCut(r,e);this.changeSet.add("antLine"),this.emitChange()}getCopyRanges(){return this.floatElementUuid?[]:this.copyRanges.slice()}getDomRect(){let{canvas:e}=this.getMainDom();if(!e)return{top:0,left:0,width:0,height:0};let t=e.parentElement,r=parseInt($e.scrollBarSize,10),n=t.getBoundingClientRect();return{top:n.top,left:n.left,width:t.clientWidth-r,height:t.clientHeight-r}}setMainDom(e){this.mainDom=Object.assign(this.mainDom,e)}getMainDom(){return this.mainDom}deleteAll(e){this.model.deleteAll(e),this.changeSet.add("cellValue"),this.emitChange()}getDefineName(e){return this.model.getDefineName(e)}setDefineName(e,t){this.model.setDefineName(e,t),this.changeSet.add("defineName"),this.changeSet.add("cellValue"),this.emitChange()}checkDefineName(e){return this.model.checkDefineName(e)}getFloatElementList(e){return this.model.getFloatElementList(e)}addFloatElement(e){this.model.addFloatElement(e),this.changeSet.add("floatElement"),this.emitChange()}updateFloatElement(e,t){this.model.updateFloatElement(e,t),this.changeSet.add("floatElement"),this.emitChange()}deleteFloatElement(e){this.model.deleteFloatElement(e),this.changeSet.add("floatElement"),this.emitChange()}getMergeCells(e){return this.model.getMergeCells(e)}addMergeCell(e){this.model.addMergeCell(e),this.changeSet.add("mergeCell"),this.changeSet.add("cellValue"),this.emitChange()}deleteMergeCell(e){this.model.deleteMergeCell(e),this.changeSet.add("mergeCell"),this.changeSet.add("cellValue"),this.emitChange()}setFloatElementUuid(e){this.floatElementUuid&&!e&&(this.copyRanges=[]),this.floatElementUuid=e}};var me=class{constructor(e,t){this.type=e,this.value=t}error(){return`type:${this.type},value:${this.value}`}toString(){return this.value}};var P=class extends Error{constructor(e){super(e),this.value=e}};function B(o,e="#VALUE!"){if(!o)throw new P(e)}function Eo(o){B(o.length===1);let[e]=o;return e}function Ft(o){let e=Eo(o);return B(typeof e=="string"),e}function Z(o){let e=Eo(o);return B(typeof e=="number"&&!isNaN(e)),e}function Er(o){B(o.length===0)}var Ss=(...o)=>{let e=Eo(o);return typeof e=="string"?e:""},Is=(...o)=>Ft(o).toLowerCase(),si=(...o)=>{let e=Z(o);return String.fromCharCode(e)},li=(...o)=>Ft(o).charCodeAt(0),As=(...o)=>Ft(o).length,ks=(...o)=>{B(o.length===2);let[e,t]=o;return B(typeof e=="string"),B(typeof t=="string"),e.split(t)},Es=(...o)=>Ft(o).toUpperCase(),Ts=(...o)=>Ft(o).replace(/ +/g," ").trim(),ai=(...o)=>(B(o.length<=$t),o.join("")),Fs={CONCAT:ai,CONCATENATE:ai,SPLIT:ks,CHAR:si,CODE:li,UNICHAR:si,UNICODE:li,LEN:As,LOWER:Is,UPPER:Es,TRIM:Ts,T:Ss},ci=Fs;var Rs=(...o)=>{let e=Z(o);return Math.abs(e)},Ps=(...o)=>{let e=Z(o);return Math.acos(e)},Ns=(...o)=>{let e=Z(o);return Math.log(e+Math.sqrt(e*e-1))},Ms=(...o)=>{let e=Z(o);return Math.atan(1/e)},Ls=(...o)=>{let e=Z(o);return .5*Math.log((e+1)/(e-1))},Ds=(...o)=>{let e=Z(o);return Math.asin(e)},Hs=(...o)=>{let e=Z(o);return Math.log(e+Math.sqrt(e*e+1))},Bs=(...o)=>{let e=Z(o);return Math.atan(e)},Os=(...o)=>{B(o.length===2);let[e,t]=o;return B(typeof e=="number"),B(typeof t=="number"),Math.atan2(e,t)},zs=(...o)=>{let e=Z(o);return Math.log((1+e)/(e+1))/2},Ws=(...o)=>{let e=Z(o);return Math.cos(e)},Us=(...o)=>{let e=Z(o);return 1/Math.tan(e)};var js=(...o)=>{let e=Z(o);return Math.exp(e)},Vs=(...o)=>{let e=Z(o);return Math.floor(e)};var Xs=(...o)=>(Er(o),Math.PI),Ks=(...o)=>(Er(o),Math.E),Gs=(...o)=>{let e=Z(o);return Math.sin(e)},Qs=(...o)=>{let e=Wr(o);return B(e.length<=$t),e.reduce((t,r)=>t+r,0)},Zs={ABS:Rs,ACOS:Ps,ACOSH:Ns,ACOT:Ms,ACOTH:Ls,ASIN:Ds,ASINH:Hs,ATAN:Bs,ATAN2:Os,ATANH:zs,COT:Us,COS:Ws,EXP:js,INT:Vs,PI:Xs,E:Ks,SIN:Gs,SUM:Qs},di=Zs;var Ys={...ci,...di},hi=Ys;var pi="",qs=new Map([["TRUE",19],["FALSE",20]]),To=class{constructor(e){this.current=0;this.start=0;this.tokens=[];this.list=[...e]}scan(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();return this.tokens.push(new me(27,"")),this.tokens.length>0&&this.tokens[0].type===0&&this.tokens.shift(),this.tokens}peek(){return this.isAtEnd()?pi:this.list[this.current]}match(e){return this.peek()!==e?!1:(this.next(),!0)}next(){return this.isAtEnd()?pi:this.list[this.current++]}isAtEnd(){return this.current>=this.list.length}addToken(e){let t=this.list.slice(this.start,this.current).join("");this.tokens.push(new me(e,t))}string(e){for(;!this.isAtEnd()&&this.peek()!==e;)this.next();if(this.peek()!==e)throw new P("#VALUE!");this.next();let t=this.list.slice(this.start+1,this.current-1).join("");this.tokens.push(new me(17,t))}allDigit(){for(;!this.isAtEnd()&&this.isDigit(this.peek());)this.next()}matchScientificCounting(){if(this.match("E")||this.match("e")){if(this.match("+")||this.match("-"))return this.allDigit(),this.addToken(18),!0;if(this.isDigit(this.peek()))return this.allDigit(),this.addToken(18),!0;throw new P("#VALUE!")}return!1}number(){this.allDigit(),!(this.matchScientificCounting()||(this.match(".")&&this.allDigit(),this.matchScientificCounting()))&&this.addToken(18)}isDigit(e){return e>="0"&&e<="9"}identifier(){for(;!this.isAtEnd()&&this.anyChar(this.peek());)this.next();let e=this.list.slice(this.start,this.current).join(""),t=qs.get(e.toUpperCase()),r=16;t&&(e=e.toUpperCase(),r=t),this.tokens.push(new me(r,e))}scanToken(){let e=this.next();switch(e){case"(":this.addToken(21);break;case")":this.addToken(22);break;case",":this.addToken(11);break;case":":this.addToken(10);break;case _t:this.addToken(0);break;case"<":this.match(">")?this.addToken(1):this.match("=")?this.addToken(15):this.addToken(14);break;case">":this.match("=")?this.addToken(8):this.addToken(7);break;case"+":this.addToken(2);break;case"-":this.addToken(3);break;case"*":this.addToken(4);break;case"/":this.addToken(5);break;case"^":this.addToken(6);break;case"&":this.addToken(9);break;case"%":this.addToken(13);break;case'"':this.string(e);break;case"!":this.addToken(26);break;case";":this.addToken(25);break;case"{":this.addToken(23);break;case"}":this.addToken(24);break;case" ":break;case"\r":case"	":case`
`:break;default:if(this.isDigit(e))this.number();else if(this.anyChar(e))this.identifier();else throw new P("#ERROR!");break}}anyChar(e){return!'(),:=<>+-*/^&%"{}!'.includes(e)&&!this.isWhiteSpace(e)}isWhiteSpace(e){return e===" "||e==="\r"||e===`
`||e==="	"}};var Ge=class{constructor(e,t,r){this.left=e,this.operator=t,this.right=r}accept(e){return e.visitBinaryExpression(this)}handleConcatenate(e){let t=e.toString();return this.operator.type===9&&e instanceof pt&&e.value.type===17?JSON.stringify(t):t}toString(){let e=this.handleConcatenate(this.left),t=this.handleConcatenate(this.right);return`${e}${this.operator.toString()}${t}`}},Fo=class{constructor(e,t){this.operator=e,this.right=t}accept(e){return e.visitUnaryExpression(this)}toString(){return this.operator.toString()+this.right.toString()}},Ro=class{constructor(e,t){this.operator=e,this.left=t}accept(e){return e.visitPostUnaryExpression(this)}toString(){return this.left.toString()+this.operator.toString()}},pt=class{constructor(e){this.value=e}accept(e){return e.visitLiteralExpression(this)}toString(){return this.value.toString()}},Qe=class{constructor(e,t,r){this.value=e,this.sheetName=r,this.type=t}accept(e){return e.visitCellExpression(this)}toString(){return this.sheetName?`${this.sheetName.toString()}!${this.value.toString()}`:this.value.toString()}},Po=class{constructor(e,t){this.name=e,this.params=t}accept(e){return e.visitCallExpression(this)}toString(){return`${this.name.toString().toUpperCase()}(${this.params.map(e=>e.toString()).join(",")})`}},No=class{constructor(e,t,r){this.left=e,this.operator=t,this.right=r}accept(e){return e.visitCellRangeExpression(this)}toString(){return this.left.toString()+this.operator.toString()+this.right.toString()}},Mo=class{constructor(e){this.value=e}accept(e){return e.visitGroupExpression(this)}toString(){return`(${this.value.toString()})`}},mt=class{constructor(e){this.value=e}accept(e){return e.visitTokenExpression(this)}toString(){return this.value.toString()}};var Js=new Set(["#ERROR!","#DIV/0!","#NULL!","#NUM!","#REF!","#VALUE!","#N/A","#NAME?"]),Lo=class{constructor(e){this.current=0;this.tokens=e}parse(){let e=[];for(;!this.isAtEnd();)e.push(this.expression());return e}expression(){return this.comparison()}comparison(){let e=this.concatenate();for(;this.match(0,1,7,8,14,15);){let t=this.previous(),r=this.concatenate();e=new Ge(e,t,r)}return e}concatenate(){let e=this.term();for(;this.match(9);){let t=this.previous(),r=this.term();e=new Ge(e,t,r)}return e}term(){let e=this.factor();for(;this.match(2,3);){let t=this.previous(),r=this.factor();e=new Ge(e,t,r)}return e}factor(){let e=this.expo();for(;this.match(5,4);){let t=this.previous(),r=this.expo();e=new Ge(e,t,r)}return e}expo(){let e=this.unary();for(;this.match(6);){let t=this.previous(),r=this.unary();e=new Ge(e,t,r)}return e}unary(){if(this.match(2,3)){let e=this.previous(),t=this.unary();return new Fo(e,t)}return this.postUnary()}postUnary(){let e=this.cellRange();if(this.match(13)){let t=this.previous();e=new Ro(t,e)}return e}cellRange(){let e=this.call();for(;this.match(10,26);){let t=this.previous(),r=this.call();e=new No(e,t,r)}return e}call(){let e=this.primary();for(;this.match(21);)e=this.finishCall(e);return e}finishCall(e){let t=[];if(!this.check(22))do{if(this.peek().type==22)break;t.push(this.expression())}while(this.match(11));return this.expect(22),new Po(e,t)}primary(){if(this.match(21)){let e=this.expression();return this.expect(22),new Mo(e)}if(this.match(18,17,19,20))return new pt(this.previous());if(this.match(16)){let e=this.previous(),t=e.value.toUpperCase();if(Js.has(t))throw new P(t);return new mt(e)}throw new P("#ERROR!")}match(...e){let{type:t}=this.peek();return e.includes(t)?(this.next(),!0):!1}previous(){return this.tokens[this.current-1]}check(e){return this.peek().type===e}expect(e){if(this.check(e))return this.next(),this.previous();throw new P("#ERROR!")}next(){this.current++}isAtEnd(){return this.peek().type===27}peek(){return this.current<this.tokens.length?this.tokens[this.current]:new me(27,"")}};var Do=class{constructor(e,t,r,n){this.expressions=e,this.functionMap=n,this.cellDataMap=t,this.definedNamesMap=r}interpret(){let e=[];for(let t of this.expressions)e.push(this.evaluate(t));if(e.length===1)return this.getRangeCellValue(e[0]);throw new P("#ERROR!")}visitBinaryExpression(e){let t=this.evaluate(e.left),r=this.evaluate(e.right);switch(t=this.getRangeCellValue(t),r=this.getRangeCellValue(r),e.operator.type){case 3:return B(typeof t=="number"),B(typeof r=="number"),t-r;case 2:return B(typeof t=="number"),B(typeof r=="number"),t+r;case 5:if(B(typeof t=="number"),B(typeof r=="number"),r===0)throw new P("#DIV/0!");return t/r;case 4:return B(typeof t=="number"),B(typeof r=="number"),t*r;case 6:return B(typeof t=="number"),B(typeof r=="number"),Math.pow(t,r);case 0:return t===r;case 1:return t!==r;case 7:return t>r;case 8:return t>=r;case 14:return t<r;case 15:return t<=r;case 9:return`${t}${r}`;default:throw new P("#VALUE!")}}visitCallExpression(e){let t=this.evaluate(e.name);if(t&&typeof t=="function"){let r=[];for(let n of e.params){let i=this.evaluate(n);if(i instanceof Le){let s=this.cellDataMap.get(i);r=r.concat(s)}else r.push(i)}return t(...r)}throw new P("#NAME?")}visitCellExpression(e){let t="";if(e.sheetName&&(t=this.cellDataMap.convertSheetNameToSheetId(e.sheetName.value),!t))throw new P("#NAME?");let r=ve(e.value.value);if(r===null)throw new P("#NAME?");return t&&(r.sheetId=t),r}visitLiteralExpression(e){let{type:t,value:r}=e.value;switch(t){case 17:return r;case 18:{let n=parseFloat(r);if(isNaN(n))throw new P("#VALUE!");return n}case 19:return!0;case 20:return!1;default:throw new P("#ERROR!")}}visitTokenExpression(e){let{value:t,type:r}=e.value,n=t.toLowerCase();if(this.definedNamesMap.has(n)){let c=this.definedNamesMap.get(n);return this.cellDataMap.get(c)[0]}let i=t.toUpperCase(),s=this.functionMap[i];if(s)return s;let a=i,l=new me(r,a);if(/^\$[A-Z]+\$\d+$/.test(a)||/^\$[A-Z]+$/.test(a)||/^\$\d+$/.test(a))return this.addCellExpression(l,"absolute",null);if(/^\$[A-Z]+\d+$/.test(a)||/^[A-Z]+\$\d+$/.test(a))return this.addCellExpression(l,"mixed",null);if(/^[A-Z]+\d+$/.test(a)||/^[A-Z]+$/.test(a))return this.addCellExpression(l,"relative",null);throw new P("#NAME?")}visitUnaryExpression(e){let t=this.evaluate(e.right);switch(e.operator.type){case 3:return-t;case 2:return t;default:throw new P("#VALUE!")}}visitCellRangeExpression(e){switch(e.operator.type){case 10:{let t=this.convertToCellExpression(e.left),r=this.convertToCellExpression(e.right);if(t!==null&&r!==null){let n=this.visitCellExpression(t),i=this.visitCellExpression(r),s=Vr(n,i);if(s===null)throw new P("#NAME?");return s}else throw new P("#NAME?")}case 26:{let t=this.convertToCellExpression(e.right);if(t===null)throw new P("#REF!");if(e.left instanceof mt)return this.visitCellExpression(new Qe(t.value,t.type,e.left.value));throw new P("#NAME?")}default:throw new P("#NAME?")}}visitGroupExpression(e){return this.evaluate(e.value)}visitPostUnaryExpression(e){let t=this.evaluate(e.left);switch(e.operator.type){case 13:return B(typeof t=="number"),t*.01;default:throw new P("#VALUE!")}}evaluate(e){return e.accept(this)}convertToCellExpression(e){return e instanceof Qe?e:e instanceof mt?new Qe(new me(16,e.value.value.toUpperCase()),"relative",null):e instanceof pt&&e.value.type===18&&/^\d+$/.test(e.value.value)?new Qe(new me(16,e.value.value),"relative",null):null}addCellExpression(e,t,r){e.value=e.value.toUpperCase();let n=new Qe(e,t,r);return this.visitCellExpression(n)}getRangeCellValue(e){if(e instanceof Le){if(e.colCount===e.rowCount&&e.colCount===1)return this.cellDataMap.get(e)[0];throw new P("#REF!")}return e}};function Fr(o,e=new Ho,t=new Bo,r=hi){let n="";try{let i=new To(o).scan(),s=new Lo(i).parse(),a=new Do(s,e,t,r).interpret(),l=[];for(let c of s)l.push(c.toString());return n=l.join(""),{result:a,error:null,expressionStr:n}}catch(i){if(i instanceof P)return{result:null,error:i.value,expressionStr:n}}return{result:null,error:"#ERROR!",expressionStr:n}}var Ho=class{constructor(){this.map=new Map;this.sheetNameMap={}}getKey(e,t,r="1"){return`${e}_${t}_${r}`}setSheetNameMap(e){this.sheetNameMap=e}set(e,t){let{row:r,col:n,sheetId:i}=e;for(let s=0;s<t.length;s++)for(let a=0;a<t[s].length;a++){let l=this.getKey(r+s,n+a,i);this.map.set(l,t[s][a])}}get(e){let t=[],{row:r,col:n,rowCount:i,colCount:s,sheetId:a}=e;for(let l=r,c=r+i;l<c;l++)for(let d=n,h=n+s;d<h;d++){let p=this.getKey(l,d,a);t.push(this.map.get(p))}return t}convertSheetNameToSheetId(e){return e&&this.sheetNameMap[e]||""}},Bo=class{constructor(){this.map=new Map}set(e,t){this.map.set(e,t)}get(e){return this.map.get(e)}has(e){return this.map.has(e)}};var Rr=()=>{},Oo=class{constructor(e){this.position=-1;this.commandList=[];this.commands=[];this.options={change:Rr,maxLength:100,redo:Rr,undo:Rr};this.clear(!0),this.options.maxLength=e.maxLength||this.options.maxLength,typeof e.change=="function"&&(this.options.change=e.change),typeof e.redo=="function"&&(this.options.redo=e.redo),typeof e.undo=="function"&&(this.options.undo=e.undo)}push(...e){e.length!==0&&(this.commands=this.commands.concat(e))}commit(){if(this.commands.length!==0){this.position++,this.commandList[this.position]=[...this.commands];for(let e=this.position+1;e<this.commandList.length;e++)this.commandList[e]=[];this.position>=this.options.maxLength&&(this.commandList[this.position-this.options.maxLength]=[]);for(let e=0;this.commandList.length>this.options.maxLength&&e<this.position;e++)this.commandList[0].length===0&&(this.commandList.shift(),this.position--);this.change(this.commands),this.commands=[]}}redo(){if(!this.canRedo())return;this.position++;let e=this.commandList[this.position];if(e.length>0)for(let t of e)this.options.redo(t);this.change(e)}undo(){if(!this.canUndo())return;let e=this.commandList[this.position];if(e.length>0)for(let t of e)this.options.undo(t);this.position--,this.change(e)}canRedo(){if(this.position>=this.commandList.length-1)return!1;let e=!1;for(let t=this.position+1;t<this.commandList.length;t++)if(this.commandList[t].length>0){e=!0;break}return e}canUndo(){let e=Math.max(this.commandList.length-this.options.maxLength,0);return this.position>e}clear(e=!1){e&&(this.position=-1,this.commandList=[]),this.commands=[]}change(e){this.options.change(e)}get(){return this.position>=0&&this.position<this.commandList.length?this.commandList[this.position]:[]}getLength(){return Math.min(this.commandList.length,this.options.maxLength)}};var O=Symbol("delete"),mi=o=>o.t+(o.k?"."+o.k:"");function ui(o,e,t){if(!o||typeof o!="object")return;e.split(".").reduce((n,i,s,a)=>(s===a.length-1?t===O?delete n[i]:n[i]=t:(n[i]===null||n[i]===void 0)&&(n[i]={}),n[i]),o)}var zo=class{constructor(){this.currentSheetId="";this.rangeMap={};this.workbook={};this.mergeCells={};this.worksheets={};this.definedNames={};this.customWidth={};this.customHeight={};this.drawings={};this.fromJSON=e=>{let{workbook:t={},mergeCells:r={},customHeight:n={},customWidth:i={},definedNames:s={},currentSheetId:a="",drawings:l={},rangeMap:c={},worksheets:d={}}=e;this.workbook=t,this.mergeCells=r,this.customWidth=i,this.customHeight=n,this.definedNames=s,this.drawings=l,this.rangeMap=c,this.worksheets=d,t[a]&&!t[a].isHide?this.currentSheetId=a:this.currentSheetId=this.getSheetId(),this.history.clear(!0)};this.toJSON=()=>({workbook:{...this.workbook},mergeCells:{...this.mergeCells},customHeight:{...this.customHeight},customWidth:{...this.customWidth},definedNames:{...this.definedNames},currentSheetId:this.currentSheetId,drawings:{...this.drawings},rangeMap:{...this.rangeMap},worksheets:{...this.worksheets}});this.getCell=e=>{let{row:t,col:r,sheetId:n}=e,i=n||this.currentSheetId;if(this.getRowHeight(t,i).len===Je||this.getColWidth(r,i).len===Je)return null;let s=U(t,r);return this.worksheets[i]=this.worksheets[i]||{},{...this.worksheets[i]?.[s]||{},row:t,col:r}};this.convertSheetIdToName=e=>this.workbook[e]?.name||"";this.convertSheetNameToSheetId=e=>this.getSheetList().find(r=>r.name===e)?.sheetId||"";this.history=new Oo({undo:e=>{if(e.t==="currentSheetId"){!this.workbook[e.o]||this.workbook[e.o].isHide?this.currentSheetId=this.getSheetId():this.currentSheetId=e.o;return}let t=mi(e);ui(this,t,e.o)},redo:e=>{if(e.t==="currentSheetId"){!this.workbook[e.n]||this.workbook[e.n].isHide?this.currentSheetId=this.getSheetId():this.currentSheetId=e.n;return}let t=mi(e);ui(this,t,e.n)},change:e=>{Kr(e)}})}getSheetList(){let e=Object.values(this.workbook);return e.sort((t,r)=>t.sort-r.sort),e}getActiveCell(){let e=this.currentSheetId,t=this.rangeMap[e];return t?{...t}:{row:0,col:0,rowCount:1,colCount:1,sheetId:e}}setActiveCell(e){e.sheetId=e.sheetId||this.currentSheetId;let t=this.workbook[e.sheetId];if(!t)return;let{row:r,col:n}=e;if(r<0||n<0||r>=t.rowCount||n>=t.colCount)return;let i=this.rangeMap[e.sheetId];i&&ao(i,e)||(this.rangeMap[e.sheetId]=e)}addSheet(){let e=this.getSheetList(),r={...Ur(e),isHide:!1,colCount:Te,rowCount:Ee,sort:e.length},n=this.workbook[r.sheetId];ce(!n,"The sheet id is duplicate"),this.worksheets[r.sheetId]=this.worksheets[r.sheetId]||{},this.workbook[r.sheetId]=r,this.history.push({t:"workbook",k:r.sheetId,n:{...r},o:O}),this.setCurrentSheetId(r.sheetId),this.setActiveCell({row:0,col:0,rowCount:1,colCount:1,sheetId:r.sheetId})}deleteSheet(e){let t=e||this.currentSheetId;if(!this.workbook[t])return;let n=this.getSheetList().filter(l=>!l.isHide);ce(n.length>=2,"A workbook must contains at least on visible worksheet");let i=this.getNextSheetId(t),s=this.workbook[t];delete this.workbook[t];let a=this.worksheets[t];delete this.worksheets[t],this.history.push({t:"workbook",k:t,n:O,o:s}),this.history.push({t:"worksheets",k:t,n:O,o:a}),this.setCurrentSheetId(i)}setTabColor(e,t){let r=t||this.currentSheetId;if(!this.workbook[r]||this.workbook[r].tabColor===e)return;let n=this.workbook[r].tabColor;this.workbook[r].tabColor=e,this.history.push({t:"workbook",k:`${r}.tabColor`,n:e,o:n})}hideSheet(e){let t=e||this.currentSheetId;if(!this.workbook[t]||this.workbook[t].isHide)return;let n=this.getSheetList().filter(s=>!s.isHide);ce(n.length>=2,"A workbook must contains at least on visible worksheet");let i=this.getNextSheetId(e);this.workbook[t].isHide=!0,this.history.push({t:"workbook",k:`${t}.isHide`,n:!0,o:!1}),this.setCurrentSheetId(i)}unhideSheet(e){let t=e||this.currentSheetId;this.workbook[t]&&this.workbook[t].isHide&&(this.workbook[t].isHide=!1,this.history.push({t:"workbook",k:`${t}.isHide`,n:!1,o:!0}),this.setCurrentSheetId(t))}renameSheet(e,t){ce(!!e,"You typed a invalid name for a sheet.");let r=t||this.currentSheetId,i=this.getSheetList().find(l=>l.name===e);if(i){if(i.sheetId===t)return;ce(!1,"Cannot rename a sheet to the same name as another sheet")}let s=this.workbook[r],a=s.name;s.name!==e&&(s.name=e,this.history.push({t:"workbook",k:`${r}.name`,n:e,o:a}))}getSheetInfo(e){let t=e||this.currentSheetId,r=this.workbook[t];return r&&(r.sheetId=t),r}setCurrentSheetId(e){if(this.currentSheetId!==e){let t=this.currentSheetId;this.currentSheetId=e,this.history.push({t:"currentSheetId",k:"",n:e,o:t})}}getCurrentSheetId(){return this.currentSheetId}setCellValues(e,t,r){if(xe(e))return;let[n]=r,{row:i,col:s}=n;for(let a=0;a<e.length;a++)for(let l=0;l<e[a].length;l++){let c=e[a][l],d={row:i+a,col:s+l};t[a]&&t[a][l]&&this.setStyle(t[a][l],d),c&&typeof c=="string"&&c.startsWith(_t)?this.setCellFormula(c,d):(this.setCellFormula("",d),this.setCellValue(c,d))}}updateCellStyle(e,t){if(xe(e))return;let[r]=t,{row:n,col:i,rowCount:s,colCount:a}=r;for(let l=n,c=n+s;l<c;l++)for(let d=i,h=i+a;d<h;d++)this.updateStyle(e,{row:l,col:d})}addRow(e,t){let r=this.getSheetInfo();if(r.rowCount>=oo)return;r.rowCount+=t;let n=this.currentSheetId,i=this.worksheets[n];if(!i)return;let s=Array.from(Object.keys(i)).map(a=>_e(a));s.sort((a,l)=>a.row-l.row);for(let a=s.length-1;a>=0;a--){let l=s[a];if(l.row<=e)break;let c=U(l.row,l.col),d=U(l.row+t,l.col),h=i[c],p=h?{...h}:{},g=i[d]?{...i[d]}:{};i[d]={...p},delete i[c],this.history.push({t:"worksheets",k:`${n}.${c}`,n:O,o:p}),this.history.push({t:"worksheets",k:`${n}.${d}`,n:p,o:g})}}addCol(e,t){let r=this.getSheetInfo();if(r.colCount>=to)return;r.colCount+=t;let n=this.currentSheetId,i=this.worksheets[n];if(!i)return;let s=Array.from(Object.keys(i)).map(a=>_e(a));s.sort((a,l)=>a.col-l.col);for(let a=s.length-1;a>=0;a--){let l=s[a];if(l.col<=e)break;let c=U(l.row,l.col),d=U(l.row,l.col+t),h=i[c],p=h?{...h}:{},g=i[d]?{...i[d]}:{};i[d]={...p},delete i[c],this.history.push({t:"worksheets",k:`${n}.${c}`,n:O,o:p}),this.history.push({t:"worksheets",k:`${n}.${d}`,n:p,o:g})}}deleteCol(e,t){let r=this.getSheetInfo();r.colCount-=t;let n=this.currentSheetId,i=this.worksheets[n];for(let[a,l]of Object.entries(this.drawings)){if(l.fromCol>=e){let c=l.fromCol;l.fromCol>=t?l.fromCol-=t:l.fromCol=0,this.history.push({t:"drawings",k:`${a}.fromCol`,n:l.fromCol,o:c})}if(l.type==="chart"&&l.chartRange.col>=e){let c=l.chartRange.col,d=l.chartRange.colCount;if(l.chartRange.col>=t)l.chartRange.col-=t;else{let h=t-l.chartRange.col;l.chartRange.col=0,l.chartRange.colCount>=h?l.chartRange.colCount-=h:l.chartRange.colCount=1,this.history.push({t:"drawings",k:`${a}.chartRange.colCount`,n:l.chartRange.col,o:d})}this.history.push({t:"drawings",k:`${a}.chartRange.col`,n:l.chartRange.col,o:c})}}if(!i)return;let s=Array.from(Object.keys(i)).map(a=>_e(a));s.sort((a,l)=>a.col-l.col);for(let a=0;a<s.length;a++){let l=s[a];if(l.col<e)continue;let c=U(l.row,l.col),d=i[c]?{...i[c]}:{};if(l.col>=e+t){let h=U(l.row,l.col-t),p=i[h]?{...i[h]}:{};i[h]={...d},this.history.push({t:"worksheets",k:`${n}.${h}`,n:d,o:p})}delete i[c],this.history.push({t:"worksheets",k:`${n}.${c}`,n:O,o:d})}}deleteRow(e,t){let r=this.getSheetInfo();r.rowCount-=t;let n=this.currentSheetId,i=this.worksheets[n];for(let[a,l]of Object.entries(this.drawings)){if(l.fromRow>=e){let c=l.fromRow;l.fromRow>=t?l.fromRow-=t:l.fromRow=0,this.history.push({t:"drawings",k:`${a}.fromRow`,n:l.fromRow,o:c})}if(l.type==="chart"&&l.chartRange.row>=e){let c=l.chartRange.row,d=l.chartRange.rowCount;if(l.chartRange.row>=t)l.chartRange.row-=t;else{let h=t-l.chartRange.row;l.chartRange.row=0,l.chartRange.rowCount>=h?l.chartRange.rowCount-=h:l.chartRange.rowCount=1,this.history.push({t:"drawings",k:`${a}.chartRange.rowCount`,n:l.chartRange.row,o:d})}this.history.push({t:"drawings",k:`${a}.chartRange.row`,n:l.chartRange.row,o:c})}}if(!i)return;let s=Array.from(Object.keys(i)).map(a=>_e(a));s.sort((a,l)=>a.row-l.row);for(let a=0;a<s.length;a++){let l=s[a];if(l.row<e)continue;let c=U(l.row,l.col),d=i[c]?{...i[c]}:{};if(l.row>=e+t){let h=U(l.row-t,l.col),p=i[h]?{...i[h]}:{};i[h]={...d},this.history.push({t:"worksheets",k:`${n}.${h}`,n:d,o:p})}delete i[c],this.history.push({t:"worksheets",k:`${n}.${c}`,n:O,o:d})}}hideCol(e,t){for(let r=0;r<t;r++){let n=e+r,i=ge(this.currentSheetId,n),s=this.customWidth[i];if(s&&s.isHide)continue;let a=s?{...s,isHide:!0}:{len:qe,isHide:!0};this.customWidth[i]=a,this.history.push({t:"customWidth",k:i,n:{...a},o:{...s}})}}getColWidth(e,t){let r=t||this.currentSheetId,n=ge(r,e),i=this.customWidth[n];return i?i.isHide?{isHide:!0,len:Je}:{...i}:{len:qe,isHide:!1}}setColWidth(e,t,r,n){let i=n||this.currentSheetId,s=ge(i,e),a=this.getColWidth(e,n);if(a.len===t)return;let l={...a};l.len=t,this.customWidth[s]=l,r&&this.history.push({t:"customWidth",k:s,n:l,o:this.customWidth[s]?this.customWidth[s]:O})}hideRow(e,t){for(let r=0;r<t;r++){let n=e+r,i=ge(this.currentSheetId,n),s=this.customHeight[i];if(s&&s.isHide)continue;let a=s?{...s,isHide:!0}:{len:Ye,isHide:!0};this.customHeight[i]=a,this.history.push({t:"customHeight",k:i,n:a,o:s})}}getRowHeight(e,t){let r=t||this.currentSheetId,n=ge(r,e),i=this.customHeight[n];return i?i.isHide?{isHide:!0,len:Je}:{...i}:{len:Ye,isHide:!1}}setRowHeight(e,t,r,n){let i=n||this.currentSheetId,s=ge(i,e),a=this.getRowHeight(e,n);if(a.len===t)return;let l={...a};l.len=t,this.customHeight[s]=l,r&&this.history.push({t:"customHeight",k:s,n:l,o:this.customHeight[s]?this.customHeight[s]:O})}canRedo(){return this.history.canRedo()}canUndo(){return this.history.canUndo()}undo(){this.history.undo()}redo(){this.history.redo()}pasteRange(e,t){let r=this.currentSheetId,n=this.getActiveCell(),{row:i,col:s,rowCount:a,colCount:l,sheetId:c}=e,d=c||r,h=this.worksheets[d],p={...n,rowCount:a,colCount:l};if(!h)return p;this.worksheets[r]=this.worksheets[r]||{};let g=this.worksheets[r];return this.iterateRange(e,(C,u)=>{let m=U(C,u),f=h[m]?{...h[m]}:{},b=n.row+(C-i),x=n.col+(u-s),v=U(b,x),S=g[v]?{...g[v]}:{};return g[v]={...f},this.history.push({t:"worksheets",k:`${r}.${v}`,n:f,o:S}),t&&(delete h[m],this.history.push({t:"worksheets",k:`${d}.${m}`,n:O,o:f})),!1}),p}deleteAll(e){let t=e||this.currentSheetId,r=this.worksheets[t]?{...this.worksheets[t]}:{};delete this.worksheets[t],this.history.push({t:"worksheets",k:t,n:O,o:r});for(let[n,i]of Object.entries(this.mergeCells))i.sheetId===t&&(delete this.mergeCells[n],this.history.push({t:"mergeCells",k:n,n:O,o:i}));for(let[n,i]of Object.entries(this.drawings))i.sheetId===t&&(delete this.drawings[n],this.history.push({t:"drawings",k:n,n:O,o:i}));for(let[n,i]of Object.entries(this.customHeight))n.startsWith(t)&&(delete this.customHeight[n],this.history.push({t:"customHeight",k:n,n:O,o:i}));for(let[n,i]of Object.entries(this.customWidth))n.startsWith(t)&&(delete this.customWidth[n],this.history.push({t:"customWidth",k:n,n:O,o:i}));for(let[n,i]of Object.entries(this.definedNames))n.startsWith(t)&&(delete this.definedNames[n],this.history.push({t:"definedNames",k:n,n:O,o:i}))}getDefineName(e){let t=e.sheetId||this.currentSheetId;for(let[r,n]of Object.entries(this.definedNames))if(n&&n.row===e.row&&n.col===e.col&&n.sheetId===t)return r;return""}setDefineName(e,t){let r=this.getDefineName(e);r&&Object.prototype.hasOwnProperty.call(this.definedNames,r)&&delete this.definedNames[r];let n={row:e.row,col:e.col,sheetId:this.currentSheetId,colCount:1,rowCount:1};this.definedNames[t]=n,r?(this.history.push({t:"definedNames",k:t,n,o:O}),this.history.push({t:"definedNames",k:r,n:O,o:n})):this.history.push({t:"definedNames",k:t,n,o:O})}checkDefineName(e){return this.definedNames[e]}setCellValue(e,t){let{row:r,col:n}=t,i=this.currentSheetId;this.worksheets[i]=this.worksheets[i]||{};let s=this.worksheets[i],a=U(r,n);s[a]=s[a]||{};let l=s[a];if(l.value===e)return;let c=l.value??"",d=e??"";s[a].value=d,this.history.push({t:"worksheets",k:`${i}.${a}.value`,n:d,o:c})}setCellFormula(e,t){let{row:r,col:n}=t,i=this.currentSheetId;this.worksheets[i]=this.worksheets[i]||{};let s=this.worksheets[i],a=U(r,n);s[a]=s[a]||{};let c=s[a].formula;c!==e&&(s[a].formula=e,this.history.push({t:"worksheets",k:`${i}.${a}.formula`,n:e,o:c}))}computeAllCell(){for(let[e,t]of Object.entries(this.worksheets))if(t){for(let[r,n]of Object.entries(t))if(n?.formula){let i=this.parseFormula(n.formula),s=i.error?i.error:i.result,a=n.value;s!==a&&(n.value=s,this.history.push({t:"worksheets",k:`${e}.${r}.value`,n:s,o:a}))}}}iterateRange(e,t){let{row:r,col:n,rowCount:i,colCount:s,sheetId:a}=e,l=this.getSheetInfo(a);if(l){if(s===0&&i>0)for(let c=r,d=r+l.rowCount;c<d&&!t(c,n);c++);else if(i===0&&s>0)for(let c=n,d=n+l.colCount;c<d&&!t(r,c);c++);else for(let c=r,d=r+(i||l.rowCount);c<d;c++)for(let h=n,p=n+(s||l.colCount);h<p;h++)if(t(c,h))return}}parseFormula(e){return Fr(e,{get:r=>{let{row:n,col:i,sheetId:s}=r,a=[],l=this.getSheetInfo(s);if(!l||n>=l.rowCount||i>=l.colCount)throw new P("#REF!");return this.iterateRange(r,(c,d)=>{let h=this.getCell(new Le(c,d,1,1,s));return h&&a.push(h.value),!1}),a},set:()=>{throw new P("#REF!")},convertSheetNameToSheetId:this.convertSheetNameToSheetId},{set:()=>{throw new P("#REF!")},get:r=>this.checkDefineName(r),has:r=>!!this.checkDefineName(r)})}getNextSheetId(e){let t=e||this.currentSheetId,r=this.getSheetList(),n=r.findIndex(a=>a.sheetId===t);ce(n>=0);let i=n===r.length-1,s=i?(n-1+r.length)%r.length:(n+1)%r.length;for(;s!==n&&r[s].isHide;)s=i?(s-1+r.length)%r.length:(s+1)%r.length;return r[s].sheetId}getSheetId(){return this.getSheetList().filter(r=>!r.isHide)[0].sheetId}updateStyle(e,t){if(xe(e))return;let r=U(t.row,t.col),n=this.currentSheetId;this.worksheets[n]=this.worksheets[n]||{};let i=this.worksheets[n];i[r]=i[r]||{},i[r].style=i[r].style||{};let s=Object.keys(e);for(let a of s){let l=i[r]?.style?.[a],c=e[a];i[r].style[a]=c,this.history.push({t:"worksheets",k:`${n}.${r}.style.${a}`,n:c,o:l===void 0?O:l})}}setStyle(e,t){let r=U(t.row,t.col),n=this.currentSheetId;this.worksheets[n]=this.worksheets[n]||{};let i=this.worksheets[n];i[r]=i[r]||{};let l={...i[r].style||{}};i[r].style=e,this.history.push({t:"worksheets",k:`${n}.${r}.style`,n:e,o:l})}getFloatElementList(e){let t=e||this.currentSheetId;return Object.values(this.drawings).filter(n=>n.sheetId===t)}addFloatElement(e){let t=this.drawings[e.uuid];if(ce(!t,"The uuid is duplicate"),e.type==="chart"){let r=e.chartRange,n=!1;this.iterateRange(r,(i,s)=>this.getCell({row:i,col:s,rowCount:1,colCount:1,sheetId:""})?.value?(n=!0,!0):!1),ce(n,"The cells must contain the data")}else e.type==="floating-picture"&&(ce(!!e.imageSrc,"Image is empty"),typeof e.imageAngle!="number"&&(e.imageAngle=0));this.drawings[e.uuid]=e,this.history.push({t:"drawings",k:e.uuid,n:e,o:O})}updateFloatElement(e,t){let r=this.drawings[e];if(!r)return;let n=Object.keys(t);for(let i of n)if(r[i]!==t[i]){let s=r[i];r[i]=t[i],this.history.push({t:"drawings",k:`${e}.${i}`,n:r[i],o:s})}}deleteFloatElement(e){let t=this.drawings[e];t&&(delete this.drawings[e],this.history.push({t:"drawings",k:e,n:O,o:t}))}getMergeCells(e){let t=e||this.currentSheetId;return Object.values(this.mergeCells).filter(r=>r.sheetId===t)}addMergeCell(e){if(e.colCount>1||e.rowCount>1){e.sheetId=e.sheetId||this.currentSheetId;let t=Re(e,"absolute",this.convertSheetIdToName);ce(!this.mergeCells[t],"The merging cell is duplicate"),this.mergeCells[t]=e,this.history.push({t:"mergeCells",k:t,n:e,o:O})}}deleteMergeCell(e){e.sheetId=e.sheetId||this.currentSheetId;let t=Re(e,"absolute",this.convertSheetIdToName);if(!this.mergeCells[t])return;let r=this.mergeCells[t];delete this.mergeCells[t],this.history.push({t:"mergeCells",k:t,n:O,o:r})}emitChange(e){e.has("cellValue")&&this.computeAllCell(),e.has("undoRedo")||this.history.commit(),this.history.clear(!1)}};var fi="data:image/jpeg;base64,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";var Qt={currentSheetId:"",rangeMap:{1:{row:2,col:2,rowCount:1,colCount:1,sheetId:"1"},2:{row:4,col:4,rowCount:2,colCount:2,sheetId:"2"},3:{row:4,col:4,rowCount:2,colCount:2,sheetId:"3"}},workbook:{1:{sheetId:"1",name:"basic",isHide:!1,colCount:Te,rowCount:Ee,sort:1},2:{sheetId:"2",name:"floating-picture",isHide:!1,colCount:Te,rowCount:Ee,sort:2,tabColor:"#FE4B4B"},3:{sheetId:"3",name:"hide",isHide:!0,colCount:Te,rowCount:Ee,sort:3},4:{sheetId:"4",name:"chart",isHide:!1,colCount:Te,rowCount:Ee,sort:4,tabColor:"#CEF273"},5:{sheetId:"5",name:"defined name",isHide:!1,colCount:Te,rowCount:Ee,sort:5,tabColor:"#76EFEF"},6:{sheetId:"6",name:"unicode",isHide:!1,colCount:Te,rowCount:Ee,sort:6,tabColor:"#9E6DE3"},7:{sheetId:"7",name:"formula",isHide:!1,colCount:Te,rowCount:Ee,sort:7,tabColor:"#E7258F"}},worksheets:{1:{"0_0":{value:"1",style:{fontColor:"#ff0000"}},"0_3":{value:"large text",style:{fontSize:36}},"0_4":{value:"This is a very long text that needs to be wrapped",style:{isWrapText:!0,isStrike:!0,isItalic:!0,underline:2}},"0_5":{value:"10"},"1_0":{formula:"=SUM(F:F)"},"1_5":{value:"5"},"3_0":{style:{fillColor:"red"}},"3_1":{style:{fillColor:"red"}},"4_0":{style:{fillColor:"red"}},"4_1":{style:{fillColor:"red"}}},2:{"0_0":{formula:"=basic!A1"}},4:{"6_6":{value:3},"6_7":{value:6},"6_8":{value:29},"7_6":{value:35},"7_7":{value:15},"7_8":{value:34},"8_6":{value:23},"8_7":{value:24},"8_8":{value:15}},5:{"0_0":{value:"1"},"0_2":{value:"",formula:"=foo"}},6:{"0_1":{value:"Z\u0351\u036B\u0343\u036A\u0302\u036B\u033D\u034F\u0334\u0319\u0324\u031E\u0349\u035A\u032F\u031E\u0320\u034DA\u036B\u0357\u0334\u0362\u0335\u031C\u0330\u0354L\u0368\u0367\u0369\u0358\u0320G\u0311\u0357\u030E\u0305\u035B\u0341\u0334\u033B\u0348\u034D\u0354\u0339O\u0342\u030C\u030C\u0358\u0328\u0335\u0339\u033B\u031D\u0333!\u033F\u030B\u0365\u0365\u0302\u0363\u0310\u0301\u0301\u035E\u035C\u0356\u032C\u0330\u0319\u0317",style:{fontSize:26}},"0_6":{formula:'=CONCAT("\u{1F60A}", "\u{1F468}\u200D\u{1F468}\u200D\u{1F467}\u200D\u{1F467}", "\u{1F466}\u{1F3FE}")',style:{fontSize:36}},"0_7":{value:"\u1103\u1167\u1109\u1170",style:{fontSize:36}},"0_8":{value:"L\u0301o\u0342r\u030Ce\u0327m\u0305",style:{fontSize:36}},"0_10":{value:"\u{1F337}\u{1F381}\u{1F4A9}\u{1F61C}\u{1F44D}\u{1F3F3}\uFE0F\u200D\u{1F308}"}},7:{"0_0":{formula:"=SUM(1,2)"},"0_1":{value:"test"},"0_2":{formula:"=CONCATENATE(A1,B1)"},"0_3":{formula:'=UNICODE("\u6D4B\u8BD5")'},"1_0":{formula:"=PI()"},"2_0":{formula:"=E()"},"3_0":{formula:"=E()*PI()"},"4_0":{formula:"=SUM(1, SIN(PI()/2),3)"}}},mergeCells:{},customHeight:{},customWidth:{},definedNames:{foo:{row:0,col:0,rowCount:1,colCount:1,sheetId:"5"}},drawings:{}};if(!no()){let o=Fe();Qt.drawings[o]={title:"icon",type:"floating-picture",uuid:o,imageSrc:fi,width:200,height:356,originHeight:356,originWidth:200,sheetId:"2",fromCol:1,fromRow:1,marginX:0,marginY:0};let e=Fe();Qt.drawings[e]={title:"Chart Title",type:"chart",uuid:e,width:400,height:250,originHeight:250,originWidth:400,marginX:0,marginY:0,sheetId:"4",fromCol:4,fromRow:4,chartType:"bar",chartRange:{row:6,col:6,colCount:3,rowCount:3,sheetId:"4"}}}function Pr(){let o=new zo,e=new Gt(o);return e.addSheet(),window.controller=e,window.model=o,e}function _s(){location.hostname!=="localhost"&&import("./esm-GQ5D4K7G.js").then(o=>{o.init({dsn:"https://b292d91ba509038c141ecfc7d10e7bb7@o4506851168092160.ingest.sentry.io/4506851171041280",integrations:[o.browserTracingIntegration(),o.replayIntegration({maskAllText:!1,blockAllMedia:!1})],tracesSampleRate:1,tracePropagationTargets:["nusr.github.io"],replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1})})}function $s(o="root"){let e=document.getElementById(o),t=Pr();return(0,gi.createRoot)(e).render(Zt.default.createElement(Zt.StrictMode,null,Zt.default.createElement(Ir,{controller:t}))),t}var Lu={initExcel:$s,defaultModel:Qt,initSentry:_s};export{Lu as default};
//# sourceMappingURL=index.js.map
