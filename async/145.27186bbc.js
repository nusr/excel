"use strict";(self.webpackChunkexcel=self.webpackChunkexcel||[]).push([["145"],{2666:function(e,t,s){s.r(t),s.d(t,{SheetBarContainer:()=>u,default:()=>b});var a=s("2676"),n=s("5271"),i=s("9111"),r=s("696");let l={"sheet-bar-wrapper":"sheet-bar-wrapper-E0WTcC","sheet-bar-list":"sheet-bar-list-ihqqHc","sheet-bar-item":"sheet-bar-item-f5HTuy",active:"active-iEtb0C","sheet-bar-item-text":"sheet-bar-item-text-Dycn9j","sheet-bar-item-color":"sheet-bar-item-color-_DNCQA","sheet-bar-context-menu":"sheet-bar-context-menu-WAAxcI","sheet-bar-input":"sheet-bar-input-vd3WCO","sheet-bar-unhide":"sheet-bar-unhide-vHlxGj","add-button":"add-button-J5mTkW","menu-button":"menu-button-A5dT1z","select-popup":"select-popup-JqxKfx","unhide-select":"unhide-select-ZhFyth"};var o=s("15"),h=s("88");let d=(0,n.memo)(e=>{let{controller:t,position:s,sheetList:i,currentSheetId:d,hideMenu:c,editSheetName:u}=e,b=(0,o.O8)(c),m=(0,n.useMemo)(()=>{var e;return(null===(e=i.find(e=>e.sheetId===d))||void 0===e?void 0:e.tabColor)||""},[i,d]),x=(0,n.useMemo)(()=>i.filter(e=>e.isHide).map(e=>({value:String(e.sheetId),label:e.name,disabled:!1})),[i]);return(0,a.jsxs)("div",{className:l["sheet-bar-context-menu"],style:{left:s},ref:b,"data-testid":"sheet-bar-context-menu",children:[(0,a.jsx)(r.zx,{testId:"sheet-bar-context-menu-insert",onClick:()=>{c(),t.addSheet()},children:(0,h.$)("insert")}),(0,a.jsx)(r.zx,{testId:"sheet-bar-context-menu-delete",onClick:()=>{c(),t.deleteSheet()},children:(0,h.$)("delete")}),(0,a.jsx)(r.zx,{testId:"sheet-bar-context-menu-rename",onClick:()=>{c(),u()},children:(0,h.$)("rename")}),(0,a.jsx)(r.zx,{testId:"sheet-bar-context-menu-hide",onClick:()=>{c(),t.hideSheet()},children:(0,h.$)("hide")}),(0,a.jsx)(r.zx,{testId:"sheet-bar-context-menu-unhide",className:l["sheet-bar-unhide"],disabled:0===x.length,onClick:()=>{var e;let s=String(null===(e=x[0])||void 0===e?void 0:e.value)||"";(0,r.um)({visible:!0,title:(0,h.$)("unhide-sheet"),testId:"sheet-bar-context-menu-unhide-dialog",children:(0,a.jsx)(r.Ph,{data:x,onChange:e=>{s=String(e)},className:l["unhide-select"],defaultValue:s,testId:"sheet-bar-context-menu-unhide-dialog-select"}),onCancel:c,onOk(){if(!s)return r.Am.error((0,h.$)("sheet-id-can-not-be-empty"));t.unhideSheet(s),c()}})},children:(0,h.$)("unhide")}),(0,a.jsx)(r.zH,{color:m,onChange:e=>{t.updateSheetInfo({tabColor:e}),c()},position:"top",testId:"sheet-bar-context-menu-tab-color",children:(0,a.jsx)(r.zx,{className:l["sheet-bar-unhide"],testId:"sheet-bar-context-menu-tab-color",children:(0,h.$)("tab-color")})})]})});d.displayName="SheetBarContextMenu";var c=s("2773");let u=(0,n.memo)(e=>{let{controller:t}=e,s=(0,n.useSyncExternalStore)(c.aj.subscribe,c.aj.getSnapshot),o=(0,n.useMemo)(()=>s.filter(e=>!e.isHide),[s]),h=(0,n.useMemo)(()=>s.filter(e=>!e.isHide).map(e=>({value:e.sheetId,label:e.name,disabled:!1})),[s]),[u,b]=(0,n.useState)(!1),{currentSheetId:m}=(0,n.useSyncExternalStore)(c.H_.subscribe,c.H_.getSnapshot),[x,p]=(0,n.useState)(i.Bg),[C,v]=(0,n.useState)(!1),I=(0,n.useCallback)(e=>(e.preventDefault(),p(e.clientX-30),!1),[]),f=(0,n.useCallback)(e=>{if(e.stopPropagation(),"Enter"===e.key){let s=e.currentTarget.value;if(v(!1),!!s)t.renameSheet(s)}},[]),j=(0,n.useCallback)(e=>{b(!1),t.setCurrentSheetId(e)},[]),S=(0,n.useCallback)(()=>{t.addSheet()},[]),N=(0,n.useCallback)(()=>{p(i.Bg)},[]),g=(0,n.useCallback)(()=>{v(!0)},[]),k=(0,n.useCallback)(()=>{b(e=>!e)},[]);return(0,a.jsxs)("div",{className:l["sheet-bar-wrapper"],"data-testid":"sheet-bar",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(r.zx,{onClick:k,className:l["menu-button"],testId:"sheet-bar-select-sheet",children:(0,a.jsx)(r.JO,{name:"menu"})}),u&&(0,a.jsx)(r.hs,{data:h,onChange:j,active:!0,position:"top",value:m,testId:"sheet-bar-select-sheet-popup",className:l["select-popup"]})]}),(0,a.jsx)("div",{className:l["sheet-bar-list"],"data-testid":"sheet-bar-list",children:o.map(e=>{let s,r=m===e.sheetId,o=r&&C,h=e.tabColor||"",d=(0,i.dh)(l["sheet-bar-item"],{[l.active]:r});!r&&!C&&h&&(s={backgroundColor:h});let c=r?"sheet-bar-active-item":void 0;return(0,a.jsx)("div",{"data-testid":`${i.YC}${e.sheetId}`,className:d,style:s,onContextMenu:I,onClick:()=>{if(m!==e.sheetId)v(!1),t.setCurrentSheetId(e.sheetId)},children:o?(0,a.jsx)("input",{className:l["sheet-bar-input"],defaultValue:e.name,onKeyDown:f,type:"text",spellCheck:!0,maxLength:i.ac,"data-testid":"sheet-bar-rename-input"}):(0,a.jsxs)(n.Fragment,{children:[r&&h&&(0,a.jsx)("span",{className:l["sheet-bar-item-color"],style:{backgroundColor:h},"data-testid":"sheet-bar-tab-color-item"}),(0,a.jsx)("span",{className:l["sheet-bar-item-text"],"data-testid":c,children:e.name})]})},e.sheetId)})}),(0,a.jsx)(r.zx,{onClick:S,type:"circle",className:l["add-button"],testId:"sheet-bar-add-sheet",children:(0,a.jsx)(r.JO,{name:"plus"})}),x>=0&&(0,a.jsx)(d,{controller:t,position:x,sheetList:s,currentSheetId:m,hideMenu:N,editSheetName:g})]})});u.displayName="SheetBarContainer";let b=u},2773:function(e,t,s){s.d(t,{MK:()=>c,c1:()=>h,gZ:()=>d,aj:()=>i,u1:()=>l,H_:()=>o,CF:()=>u,no:()=>m});var a=s("3438");class n{constructor(e){(0,a._)(this,"listeners",new Set),(0,a._)(this,"state",void 0),(0,a._)(this,"setState",(e,t)=>{Array.isArray(e)&&(t=!0);let s=!t&&e&&"object"==typeof e&&Object.entries(e).every(e=>{let[t,s]=e;return Object.is(this.state[t],s)});if(s)return s;if(!Object.is(this.state,e)){let s=this.state;for(let a of(this.state=t??("object"!=typeof e||null===e)?e:Object.assign({},this.state,e),this.listeners))a(this.state,s)}}),(0,a._)(this,"subscribe",e=>(this.listeners.add(e),()=>this.listeners.delete(e))),(0,a._)(this,"getSnapshot",()=>this.state),this.state=e}}let i=new n([]);var r=s("9111");let l=new n({value:"",displayValue:"",row:0,col:0,left:r.Bg,top:r.Bg,width:0,height:0,defineName:"",rowCount:1,colCount:1}),o=new n({editorStatus:s("1320").I.NONE,canRedo:!1,canUndo:!1,activeUuid:"",currentSheetId:"",isFilter:!1}),h=new n([]),d=new n({scrollTop:0,scrollLeft:0,showBottomBar:!1}),c=new n([]),u=new n([]);var b=s("7620");let m=new n({isBold:!1,isItalic:!1,isStrike:!1,fontColor:(0,r.pe)("contentColor"),fontSize:r.n5,fontFamily:"",fillColor:"",isWrapText:!1,underline:b.nI.NONE,verticalAlign:b._v.TOP,horizontalAlign:b.KM.LEFT,numberFormat:r.s8,isMergeCell:!1,mergeType:""})},1320:function(e,t,s){s.d(t,{D:function(){return i},I:function(){return r}});var a,n,i=((a={})[a.NONE=0]="NONE",a[a.VERTICAL=1]="VERTICAL",a[a.HORIZONTAL=2]="HORIZONTAL",a);var r=((n={})[n.NONE=0]="NONE",n[n.EDIT_CELL=1]="EDIT_CELL",n[n.EDIT_FORMULA_BAR=2]="EDIT_FORMULA_BAR",n)}}]);