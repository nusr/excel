"use strict";(self.webpackChunkexcel=self.webpackChunkexcel||[]).push([["838"],{1330:function(e,t,l){l.r(t),l.d(t,{ToolbarContainer:()=>w,default:()=>O});var r=l("2676"),a=l("5271"),o=l("696"),i=l("9111"),n=l("7620");let s="toolbar-wrapper-igY_tO",c="merge-cell-XbSUlT",d="merge-cell-button-R9_kvP",u="number-format-BdBuL9",b="number-format-value-eWQQ5B",g="fontFamily-Z1ndY0",h="bold-UWIpos",m="italic-YgmHkN",C="strike-C8u5xJ",p="wrap-text-axqsm6",x="icon-center-slm_QB";var f=l("2773"),v=l("88");let I=(0,a.memo)(e=>{let{controller:t}=e,l=(0,a.useRef)(null),n=(0,a.useCallback)(async e=>{var r;let a=null===(r=e.target.files)||void 0===r?void 0:r[0];if(!a)return;let o=a.name,n=a.type.slice(6);o=o.slice(0,-(n.length+1));let s=await (0,i.G6)(a,!0);if(l.current&&(l.current.value="",l.current.blur()),!s)return;let c=await (0,i.Ad)(s),d=t.getActiveRange().range;await t.addDrawing({width:c.width,height:c.height,originHeight:c.height,originWidth:c.width,title:o,type:"floating-picture",uuid:(0,i.DO)(),imageSrc:s,sheetId:d.sheetId,fromRow:d.row,fromCol:d.col,marginX:0,marginY:0})},[]);return(0,r.jsxs)(o.zx,{testId:"toolbar-floating-picture",title:"Floating Picture",children:[(0,r.jsx)("input",{type:"file",hidden:!0,onChange:n,accept:"image/*",ref:l,id:"upload_float_image","data-testid":"toolbar-floating-picture-input"}),(0,r.jsx)("label",{htmlFor:"upload_float_image",children:(0,v.$)("floating-picture")})]})});I.displayName="InsertFloatingPicture";let y=(0,a.memo)(e=>{let{controller:t}=e,l=(0,a.useCallback)(async()=>{let e=t.getActiveRange().range;await t.addDrawing({width:400,height:300,originHeight:300,originWidth:400,title:(0,v.$)("chart-title"),type:"chart",uuid:(0,i.DO)(),sheetId:e.sheetId,fromRow:e.row,fromCol:e.col,chartRange:e,chartType:"line",marginX:0,marginY:0})},[]);return(0,r.jsx)(o.zx,{testId:"toolbar-chart",onClick:l,title:"Chart",children:(0,v.$)("chart")})});y.displayName="InsertChart";let j="container-PWI5xN",k="main-Msg7ny",N="menu-Lx3fk0",S="portal-_rgAFr",A=(0,a.memo)(e=>{let{controller:t}=e,[l,n]=(0,a.useState)(""),[s,c]=(0,a.useState)("thin"),[d,u]=(0,a.useState)("all-borders"),b=(0,a.useRef)({color:l,borderType:s,type:d}),g=()=>({color:b.current.color,type:b.current.borderType}),h=()=>{u("all-borders");let e=g();t.updateCellStyle({borderLeft:e,borderRight:e,borderTop:e,borderBottom:e},t.getActiveRange().range)},m=e=>{b.current.borderType=e,c(e),h()},C=()=>{u("no-border"),t.updateCellStyle({borderLeft:void 0,borderRight:void 0,borderTop:void 0,borderBottom:void 0},t.getActiveRange().range)},p=()=>{u("bottom-border");let e=t.getActiveRange().range,l=g(),{row:r,col:a,colCount:o,rowCount:n}=e;t.updateCellStyle({borderBottom:l},{row:r+n-1,rowCount:1,colCount:o,col:(0,i.jC)(e)?0:a,sheetId:""})},x=()=>{u("top-border");let e=t.getActiveRange().range,l=g(),{row:r,col:a,colCount:o}=e,n={row:r,rowCount:1,colCount:o,col:(0,i.jC)(e)?0:a,sheetId:""};t.updateCellStyle({borderTop:l},n)},f=()=>{u("left-border");let e=t.getActiveRange().range,l=g(),{row:r,col:a,rowCount:o}=e;t.updateCellStyle({borderLeft:l},{row:(0,i.B1)(e)?0:r,rowCount:o,colCount:1,col:a,sheetId:""})},I=()=>{u("right-border");let e=t.getActiveRange().range,l=g(),{row:r,col:a,rowCount:o,colCount:n}=e;t.updateCellStyle({borderRight:l},{row:(0,i.B1)(e)?0:r,rowCount:o,colCount:1,col:a+n-1,sheetId:""})},y=()=>{x(),I(),p(),f(),u("outside-borders")},A=()=>{let e=b.current.borderType;b.current.borderType="medium",y(),b.current.borderType=e,u("thick-box-border")};return(0,r.jsxs)("div",{className:j,children:[(0,r.jsx)(o.zx,{onClick:()=>{({"all-borders":h,"no-border":C,"bottom-border":p,"top-border":x,"left-border":f,"right-border":I,"thick-box-border":A,"outside-borders":y})[d]()},type:"plain",className:k,testId:"toolbar-border-shortcut",title:(0,v.$)(d),children:(0,v.$)(d)}),(0,r.jsxs)(o.v2,{className:N,label:(0,r.jsx)(o.JO,{name:"down"}),isPlain:!0,testId:"toolbar-border",position:"bottom",size:"small",portalClassName:S,children:[(0,r.jsx)(o.sN,{onClick:C,testId:"toolbar-no-border",children:(0,v.$)("no-border")}),(0,r.jsx)(o.sN,{onClick:h,testId:"toolbar-all-borders",children:(0,v.$)("all-borders")}),(0,r.jsx)(o.sN,{onClick:y,testId:"toolbar-outside-borders",children:(0,v.$)("outside-borders")}),(0,r.jsx)(o.sN,{onClick:A,testId:"toolbar-thick-box-border",children:(0,v.$)("thick-box-border")}),(0,r.jsx)(o.sN,{onClick:p,testId:"toolbar-bottom-border",children:(0,v.$)("bottom-border")}),(0,r.jsx)(o.sN,{onClick:x,testId:"toolbar-top-border",children:(0,v.$)("top-border")}),(0,r.jsx)(o.sN,{onClick:f,testId:"toolbar-left-border",children:(0,v.$)("left-border")}),(0,r.jsx)(o.sN,{onClick:I,testId:"toolbar-right-border",children:(0,v.$)("right-border")}),(0,r.jsx)(o.sN,{children:(0,r.jsx)(o.zH,{color:l,onChange:e=>{b.current.color=e,n(e),h()},position:"right",testId:"toolbar-border-color",children:(0,r.jsxs)("span",{style:{color:l},children:[(0,v.$)("line-color")," >"]})})}),(0,r.jsx)(o.Wd,{label:`${(0,v.$)("line-style")} >`,testId:"toolbar-border-style",children:Object.keys(i.xS).map(e=>(0,r.jsx)(o.sN,{onClick:()=>m(e),testId:`toolbar-border-style-${e}`,active:s===e,children:e},e))})]})]})});A.displayName="BorderToolBar";var R=l("6604");let T=[{value:n.nI.NONE,label:(0,v.$)("none"),disabled:!1},{value:n.nI.SINGLE,label:(0,v.$)("single-underline"),disabled:!1},{value:n.nI.DOUBLE,label:(0,v.$)("double-underline"),disabled:!1}],E=[{value:n.WI.MERGE_CENTER,label:(0,v.$)("merge-and-center"),disabled:!1},{value:n.WI.MERGE_CELL,label:(0,v.$)("merge-cells"),disabled:!1},{value:n.WI.MERGE_CONTENT,label:(0,v.$)("merge-content"),disabled:!1}],w=(0,a.memo)(e=>{let{controller:t}=e,l=(0,a.useSyncExternalStore)(f.H_.subscribe,f.H_.getSnapshot),j=(0,a.useSyncExternalStore)(f.no.subscribe,f.no.getSnapshot),k=(0,a.useSyncExternalStore)(f.c1.subscribe,f.c1.getSnapshot),N=(0,a.useMemo)(()=>({color:j.fillColor}),[j.fillColor]),S=(0,a.useMemo)(()=>({color:j.fontColor}),[j.fontColor]),[w,O]=(0,a.useMemo)(()=>{let e=i.qL["0"];if(j.numberFormat){let t=i.qL.find(e=>e.value===j.numberFormat);e=t?t:i.qL[i.qL.length-1]}return[e.label,String(e.value)]},[j.numberFormat]),z=(0,a.useCallback)(e=>({fontFamily:String(e)}),[]),L=(0,a.useCallback)(e=>{String(e)===i.Hr&&"function"==typeof window.queryLocalFonts?window.queryLocalFonts().then(e=>{let t=e.map(e=>e.fullName);(t=Array.from(new Set(t)).filter(e=>(0,R._)(e))).sort((e,t)=>e.localeCompare(t));let l=t.map(e=>({label:e,value:e,disabled:!1}));t.length>0?(f.c1.setState(l),localStorage.setItem(i.JJ,JSON.stringify(t))):f.c1.setState(f.c1.getSnapshot().filter(e=>e.value!==i.Hr))}):t.updateCellStyle({fontFamily:String(e)},t.getActiveRange().range)},[]),_=(0,a.useCallback)(()=>{t.undo()},[]),F=(0,a.useCallback)(()=>{t.redo()},[]),B=(0,a.useCallback)(()=>{t.copy()},[]),M=(0,a.useCallback)(()=>{t.cut()},[]),$=(0,a.useCallback)(()=>{t.paste()},[]),D=(0,a.useCallback)(e=>{t.updateCellStyle({fontSize:Number(e)},t.getActiveRange().range)},[]),H=(0,a.useCallback)(()=>{t.updateCellStyle({isBold:!j.isBold},t.getActiveRange().range)},[j.isBold]),J=(0,a.useCallback)(()=>{t.updateCellStyle({isItalic:!j.isItalic},t.getActiveRange().range)},[j.isItalic]),W=(0,a.useCallback)(()=>{t.updateCellStyle({isStrike:!j.isStrike},t.getActiveRange().range)},[j.isStrike]),P=(0,a.useCallback)(e=>{let l=Number(e),r=n.nI.NONE;l===n.nI.SINGLE?r=n.nI.SINGLE:l===n.nI.DOUBLE&&(r=n.nI.DOUBLE),t.updateCellStyle({underline:r},t.getActiveRange().range)},[]),U=(0,a.useCallback)(e=>{t.updateCellStyle({fillColor:e},t.getActiveRange().range)},[]),q=(0,a.useCallback)(e=>{t.updateCellStyle({fontColor:e},t.getActiveRange().range)},[]),G=(0,a.useCallback)(()=>{t.updateCellStyle({isWrapText:!j.isWrapText},t.getActiveRange().range)},[j.isWrapText]),K=(0,a.useCallback)(()=>{let{range:e,isMerged:l}=t.getActiveRange();l?t.deleteMergeCell(e):t.addMergeCell(e)},[]),Y=(0,a.useCallback)(e=>{if(!e)return;let{range:l,isMerged:r}=t.getActiveRange();r?t.deleteMergeCell(l):t.addMergeCell(l,Number(e))},[]),Z=(0,a.useCallback)(e=>{if(!!e)t.updateCellStyle({numberFormat:e},t.getActiveRange().range)},[]),Q=(0,a.useCallback)(()=>{t.updateCellStyle({horizontalAlign:n.KM.LEFT},t.getActiveRange().range)},[]),V=(0,a.useCallback)(()=>{t.updateCellStyle({horizontalAlign:n.KM.CENTER},t.getActiveRange().range)},[]),X=(0,a.useCallback)(()=>{t.updateCellStyle({horizontalAlign:n.KM.RIGHT},t.getActiveRange().range)},[]),ee=(0,a.useCallback)(()=>{t.updateCellStyle({verticalAlign:n._v.TOP},t.getActiveRange().range)},[]),et=(0,a.useCallback)(()=>{t.updateCellStyle({verticalAlign:n._v.MIDDLE},t.getActiveRange().range)},[]),el=(0,a.useCallback)(()=>{t.updateCellStyle({verticalAlign:n._v.BOTTOM},t.getActiveRange().range)},[]),er=(0,a.useCallback)(()=>{t.getFilter()?t.deleteFilter():t.addFilter(t.getActiveRange().range)},[]);return(0,r.jsxs)("div",{className:s,"data-testid":"toolbar",children:[(0,r.jsx)(o.zx,{disabled:!l.canUndo,onClick:_,testId:"toolbar-undo",title:"Undo",className:x,children:(0,r.jsx)(o.JO,{name:"undo"})}),(0,r.jsx)(o.zx,{disabled:!l.canRedo,onClick:F,testId:"toolbar-redo",title:"Redo",className:x,children:(0,r.jsx)(o.JO,{name:"redo"})}),(0,r.jsx)(o.zx,{onClick:B,testId:"toolbar-copy",title:"Copy",children:(0,v.$)("copy")}),(0,r.jsx)(o.zx,{onClick:M,testId:"toolbar-cut",title:"Cut",children:(0,v.$)("cut")}),(0,r.jsx)(o.zx,{onClick:$,testId:"toolbar-paste",title:"Paste",children:(0,v.$)("paste")}),(0,r.jsx)(o.Ph,{data:k,value:j.fontFamily,getItemStyle:z,onChange:L,testId:"toolbar-font-family",className:g}),(0,r.jsx)(o.Ph,{data:i.DG,value:j.fontSize,onChange:D,testId:"toolbar-font-size"}),(0,r.jsx)(o.zx,{active:j.isBold,onClick:H,testId:"toolbar-bold",title:"Bold",children:(0,r.jsx)("span",{className:h,children:"B"})}),(0,r.jsx)(o.zx,{active:j.isItalic,onClick:J,testId:"toolbar-italic",title:"Italic",children:(0,r.jsx)("span",{className:m,children:"I"})}),(0,r.jsx)(o.zx,{active:j.isStrike,onClick:W,testId:"toolbar-strike",title:"Strike",children:(0,r.jsx)("span",{className:C,children:"A"})}),(0,r.jsx)(o.Ph,{data:T,value:j.underline,title:"Underline",onChange:P,testId:"toolbar-underline"}),(0,r.jsx)(A,{controller:t}),(0,r.jsx)(o.zH,{color:j.fillColor,onChange:U,testId:"toolbar-fill-color",children:(0,r.jsx)(o.zx,{style:N,testId:"toolbar-fill-color",className:x,title:"Fill Color",children:(0,r.jsx)(o.Yj,{})})},"fill-color"),(0,r.jsx)(o.zH,{color:j.fontColor,onChange:q,testId:"toolbar-font-color",children:(0,r.jsx)(o.zx,{style:S,testId:"toolbar-font-color",className:x,title:"Font Color",children:(0,r.jsx)(o.JO,{name:"fontColor"})})},"font-color"),(0,r.jsx)(o.zx,{active:j.verticalAlign===n._v.TOP,onClick:ee,testId:"toolbar-vertical-top",className:x,title:"Top Align",children:(0,r.jsx)(o.JO,{name:"verticalTop"})}),(0,r.jsx)(o.zx,{active:j.verticalAlign===n._v.MIDDLE,onClick:et,testId:"toolbar-vertical-middle",className:x,title:"Middle Align",children:(0,r.jsx)(o.JO,{name:"verticalMiddle"})}),(0,r.jsx)(o.zx,{active:j.verticalAlign===n._v.BOTTOM,onClick:el,testId:"toolbar-vertical-bottom",className:x,title:"Bottom Align",children:(0,r.jsx)(o.JO,{name:"verticalBottom"})}),(0,r.jsx)(o.zx,{active:j.horizontalAlign===n.KM.LEFT,onClick:Q,testId:"toolbar-horizontal-left",className:x,title:"Align Text Left",children:(0,r.jsx)(o.JO,{name:"horizontalLeft"})}),(0,r.jsx)(o.zx,{active:j.horizontalAlign===n.KM.CENTER,onClick:V,testId:"toolbar-horizontal-center",className:x,title:"Align Text Center",children:(0,r.jsx)(o.JO,{name:"horizontalCenter"})}),(0,r.jsx)(o.zx,{active:j.horizontalAlign===n.KM.RIGHT,onClick:X,testId:"toolbar-horizontal-right",className:x,title:"Align Text Right",children:(0,r.jsx)(o.JO,{name:"horizontalRight"})}),(0,r.jsx)(o.zx,{active:j.isWrapText,onClick:G,testId:"toolbar-wrap-text",className:p,title:"Wrap Text",children:(0,v.$)("wrap-text")}),(0,r.jsx)(o.EI,{data:E,value:j.mergeType,onChange:Y,className:c,testId:"toolbar-merge-cell-select",children:(0,r.jsx)(o.zx,{active:j.isMergeCell,onClick:K,testId:"toolbar-merge-cell",className:d,type:"plain",title:"Merge And Center",children:(0,v.$)("merge-and-center")})}),(0,r.jsx)(o.EI,{data:i.qL,value:O,onChange:Z,className:u,testId:"toolbar-number-format",children:(0,r.jsx)("div",{className:b,"data-testid":"toolbar-number-format-value",children:w})}),(0,r.jsx)(o.zx,{active:l.isFilter,onClick:er,testId:"toolbar-filter",className:p,title:"Filter",children:(0,v.$)("filter")}),(0,r.jsx)(I,{controller:t}),(0,r.jsx)(y,{controller:t}),(0,r.jsx)(o.Ey,{})]})});w.displayName="ToolbarContainer";let O=w},6604:function(e,t,l){l.d(t,{_:function(){return i},q:function(){return n}});var r=l(9111),a=l(88);function o(e){let t=document.createElement("span");t.style.fontSize="72px",t.innerHTML="mmmmmmmmmmlli",t.style.fontFamily=e,document.body.appendChild(t);let{offsetWidth:l,offsetHeight:r}=t;return document.body.removeChild(t),{offsetHeight:r,offsetWidth:l}}let i=function(){let e=[r.cA,"serif"],t={},l={};for(let r of e){let{offsetWidth:e,offsetHeight:a}=o(r);t[r]=e,l[r]=a}return function(r){for(let a of e){let{offsetWidth:e,offsetHeight:i}=o(r+","+a);if(e!==t[a]||i!==l[a])return!0}return!1}}();function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.d8,l=localStorage.getItem(r.JJ);if(l){let e=JSON.parse(l);if(e.length>0)return e.map(e=>({value:e,label:e,disabled:!1}))}let o=[];for(let l of t)e(l)&&o.push({label:l,value:l,disabled:!1});return"function"==typeof window.queryLocalFonts&&o.push({value:r.Hr,label:(0,a.$)("get-all-installed-fonts"),disabled:!1}),o}},2773:function(e,t,l){l.d(t,{MK:()=>u,c1:()=>c,gZ:()=>d,aj:()=>o,u1:()=>n,H_:()=>s,CF:()=>b,no:()=>h});var r=l("3438");class a{constructor(e){(0,r._)(this,"listeners",new Set),(0,r._)(this,"state",void 0),(0,r._)(this,"setState",(e,t)=>{Array.isArray(e)&&(t=!0);let l=!t&&e&&"object"==typeof e&&Object.entries(e).every(e=>{let[t,l]=e;return Object.is(this.state[t],l)});if(l)return l;if(!Object.is(this.state,e)){let l=this.state;for(let r of(this.state=t??("object"!=typeof e||null===e)?e:Object.assign({},this.state,e),this.listeners))r(this.state,l)}}),(0,r._)(this,"subscribe",e=>(this.listeners.add(e),()=>this.listeners.delete(e))),(0,r._)(this,"getSnapshot",()=>this.state),this.state=e}}let o=new a([]);var i=l("9111");let n=new a({value:"",displayValue:"",row:0,col:0,left:i.Bg,top:i.Bg,width:0,height:0,defineName:"",rowCount:1,colCount:1}),s=new a({editorStatus:l("1320").I.NONE,canRedo:!1,canUndo:!1,activeUuid:"",currentSheetId:"",isFilter:!1}),c=new a([]),d=new a({scrollTop:0,scrollLeft:0,showBottomBar:!1}),u=new a([]),b=new a([]);var g=l("7620");let h=new a({isBold:!1,isItalic:!1,isStrike:!1,fontColor:(0,i.pe)("contentColor"),fontSize:i.n5,fontFamily:"",fillColor:"",isWrapText:!1,underline:g.nI.NONE,verticalAlign:g._v.TOP,horizontalAlign:g.KM.LEFT,numberFormat:i.s8,isMergeCell:!1,mergeType:""})},1320:function(e,t,l){l.d(t,{D:function(){return o},I:function(){return i}});var r,a,o=((r={})[r.NONE=0]="NONE",r[r.VERTICAL=1]="VERTICAL",r[r.HORIZONTAL=2]="HORIZONTAL",r);var i=((a={})[a.NONE=0]="NONE",a[a.EDIT_CELL=1]="EDIT_CELL",a[a.EDIT_FORMULA_BAR=2]="EDIT_FORMULA_BAR",a)}}]);