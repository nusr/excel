/* 
MIT License

Copyright (c) 2020 Steve Xu

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/
import{a as le,b as ie}from"./chunk-NAXLYV6U.js";import{c as j,d as k,h as q}from"./chunk-JDBCPFQN.js";import{J as A,K as a,L as te,M as oe,N as g,Q as _,S as V,U as m,V as re,W as ne,Y as E,a as Q,e as Y,f as R,j as i,k as ee}from"./chunk-YWIWGZ5Y.js";import{C as Z,Y as X,ha as $,ia as H}from"./chunk-456IQKKT.js";import{c as K}from"./chunk-AI5EXC2Q.js";var e=K(Q());var s={"toolbar-wrapper":"e","merge-cell":"qr",border:"Dr","merge-cell-button":"Er","number-format":"Gr","number-format-value":"Jr",fontFamily:"Kr",bold:"Nr",italic:"Or",strike:"Qr","wrap-text":"Tr","icon-center":"Vr"};var l=K(Q());var F={container:"i",trigger:"xo",main:"co",menu:"j",portal:"ho"};var J=(0,l.memo)(({controller:t})=>{let[S,o]=(0,l.useState)(""),[O,D]=(0,l.useState)("thin"),[B,b]=(0,l.useState)("all-borders"),p=(0,l.useRef)({color:S,borderType:O,type:B}),I=()=>({color:p.current.color,type:p.current.borderType}),T=()=>{b("all-borders");let r=I();t.updateCellStyle({borderLeft:r,borderRight:r,borderTop:r,borderBottom:r},t.getActiveRange().range)},G=r=>{p.current.color=r,o(r),T()},U=r=>{p.current.borderType=r,D(r),T()},z=()=>{b("no-border"),t.updateCellStyle({borderLeft:void 0,borderRight:void 0,borderTop:void 0,borderBottom:void 0},t.getActiveRange().range)},x=()=>{b("bottom-border");let r=t.getActiveRange().range,C=I(),{row:f,col:h,colCount:y,rowCount:v}=r;t.updateCellStyle({borderBottom:C},{row:f+v-1,rowCount:1,colCount:y,col:$(r)?0:h,sheetId:""})},N=()=>{b("top-border");let r=t.getActiveRange().range,C=I(),{row:f,col:h,colCount:y}=r,v={row:f,rowCount:1,colCount:y,col:$(r)?0:h,sheetId:""};t.updateCellStyle({borderTop:C},v)},w=()=>{b("left-border");let r=t.getActiveRange().range,C=I(),{row:f,col:h,rowCount:y}=r;t.updateCellStyle({borderLeft:C},{row:H(r)?0:f,rowCount:y,colCount:1,col:h,sheetId:""})},L=()=>{b("right-border");let r=t.getActiveRange().range,C=I(),{row:f,col:h,rowCount:y,colCount:v}=r;t.updateCellStyle({borderRight:C},{row:H(r)?0:f,rowCount:y,colCount:1,col:h+v-1,sheetId:""})},M=()=>{N(),L(),x(),w(),b("outside-borders")},P=()=>{let r=p.current.borderType;p.current.borderType="medium",M(),p.current.borderType=r,b("thick-box-border")},W=()=>{({"all-borders":T,"no-border":z,"bottom-border":x,"top-border":N,"left-border":w,"right-border":L,"thick-box-border":P,"outside-borders":M})[B]()};return l.default.createElement("div",{className:F.container},l.default.createElement(a,{onClick:W,type:"plain",className:F.main,testId:"toolbar-border-shortcut",title:i(B)},i(B)),l.default.createElement(ne,{className:F.menu,label:l.default.createElement(g,{name:"down"}),isPlain:!0,testId:"toolbar-border",position:"bottom",size:"small",portalClassName:F.portal},l.default.createElement(m,{onClick:z,testId:"toolbar-no-border"},i("no-border")),l.default.createElement(m,{onClick:T,testId:"toolbar-all-borders"},i("all-borders")),l.default.createElement(m,{onClick:M,testId:"toolbar-outside-borders"},i("outside-borders")),l.default.createElement(m,{onClick:P,testId:"toolbar-thick-box-border"},i("thick-box-border")),l.default.createElement(m,{onClick:x,testId:"toolbar-bottom-border"},i("bottom-border")),l.default.createElement(m,{onClick:N,testId:"toolbar-top-border"},i("top-border")),l.default.createElement(m,{onClick:w,testId:"toolbar-left-border"},i("left-border")),l.default.createElement(m,{onClick:L,testId:"toolbar-right-border"},i("right-border")),l.default.createElement(m,null,l.default.createElement(E,{color:S,onChange:G,position:"right",testId:"toolbar-border-color"},l.default.createElement("span",{style:{color:S}},i("line-color")," >"))),l.default.createElement(re,{label:`${i("line-style")} >`,testId:"toolbar-border-style"},Object.keys(Z).map(r=>l.default.createElement(m,{key:r,onClick:()=>U(r),testId:`toolbar-border-style-${r}`,active:O===r},r)))))});J.displayName="BorderToolBar";var he=[{value:0,label:i("none"),disabled:!1},{value:1,label:i("single-underline"),disabled:!1},{value:2,label:i("double-underline"),disabled:!1}],ye=[{value:0,label:i("merge-and-center"),disabled:!1},{value:1,label:i("merge-cells"),disabled:!1},{value:2,label:i("merge-content"),disabled:!1}],ae=(0,e.memo)(({controller:t})=>{let S=(0,e.useSyncExternalStore)(j.subscribe,j.getSnapshot),o=(0,e.useSyncExternalStore)(q.subscribe,q.getSnapshot),O=(0,e.useSyncExternalStore)(k.subscribe,k.getSnapshot),D=(0,e.useMemo)(()=>({color:o.fillColor}),[o.fillColor]),B=(0,e.useMemo)(()=>({color:o.fontColor}),[o.fontColor]),[b,p]=(0,e.useMemo)(()=>{let n=A[0];if(o.numberFormat){let c=A.find(d=>d.value===o.numberFormat);c?n=c:n=A[A.length-1]}return[n.label,String(n.value)]},[o.numberFormat]),I=(0,e.useCallback)(n=>({fontFamily:String(n)}),[]),T=(0,e.useCallback)(n=>{String(n)===Y&&typeof window.queryLocalFonts=="function"?window.queryLocalFonts().then(c=>{let d=c.map(u=>u.fullName);d=Array.from(new Set(d)).filter(u=>ee(u)),d.sort((u,pe)=>u.localeCompare(pe));let ue=d.map(u=>({label:u,value:u,disabled:!1}));d.length>0?(k.setState(ue),localStorage.setItem(R,JSON.stringify(d))):k.setState(k.getSnapshot().filter(u=>u.value!==Y))}):t.updateCellStyle({fontFamily:String(n)},t.getActiveRange().range)},[]),G=(0,e.useCallback)(()=>{t.undo()},[]),U=(0,e.useCallback)(()=>{t.redo()},[]),z=(0,e.useCallback)(()=>{t.copy()},[]),x=(0,e.useCallback)(()=>{t.cut()},[]),N=(0,e.useCallback)(()=>{t.paste()},[]),w=(0,e.useCallback)(n=>{t.updateCellStyle({fontSize:Number(n)},t.getActiveRange().range)},[]),L=(0,e.useCallback)(()=>{t.updateCellStyle({isBold:!o.isBold},t.getActiveRange().range)},[o.isBold]),M=(0,e.useCallback)(()=>{t.updateCellStyle({isItalic:!o.isItalic},t.getActiveRange().range)},[o.isItalic]),P=(0,e.useCallback)(()=>{t.updateCellStyle({isStrike:!o.isStrike},t.getActiveRange().range)},[o.isStrike]),W=(0,e.useCallback)(n=>{let c=Number(n),d=0;c===1?d=1:c===2&&(d=2),t.updateCellStyle({underline:d},t.getActiveRange().range)},[]),r=(0,e.useCallback)(n=>{t.updateCellStyle({fillColor:n},t.getActiveRange().range)},[]),C=(0,e.useCallback)(n=>{t.updateCellStyle({fontColor:n},t.getActiveRange().range)},[]),f=(0,e.useCallback)(()=>{t.updateCellStyle({isWrapText:!o.isWrapText},t.getActiveRange().range)},[o.isWrapText]),h=(0,e.useCallback)(()=>{let{range:n,isMerged:c}=t.getActiveRange();c?t.deleteMergeCell(n):t.addMergeCell(n)},[]),y=(0,e.useCallback)(n=>{if(!n)return;let{range:c,isMerged:d}=t.getActiveRange();d?t.deleteMergeCell(c):t.addMergeCell(c,Number(n))},[]),v=(0,e.useCallback)(n=>{n&&t.updateCellStyle({numberFormat:n},t.getActiveRange().range)},[]),se=(0,e.useCallback)(()=>{t.updateCellStyle({horizontalAlign:0},t.getActiveRange().range)},[]),de=(0,e.useCallback)(()=>{t.updateCellStyle({horizontalAlign:1},t.getActiveRange().range)},[]),ce=(0,e.useCallback)(()=>{t.updateCellStyle({horizontalAlign:2},t.getActiveRange().range)},[]),ge=(0,e.useCallback)(()=>{t.updateCellStyle({verticalAlign:0},t.getActiveRange().range)},[]),me=(0,e.useCallback)(()=>{t.updateCellStyle({verticalAlign:1},t.getActiveRange().range)},[]),be=(0,e.useCallback)(()=>{t.updateCellStyle({verticalAlign:2},t.getActiveRange().range)},[]);return e.default.createElement("div",{className:s["toolbar-wrapper"],"data-testid":"toolbar"},e.default.createElement(a,{disabled:!S.canUndo,onClick:G,testId:"toolbar-undo",title:"Undo",className:s["icon-center"]},e.default.createElement(g,{name:"undo"})),e.default.createElement(a,{disabled:!S.canRedo,onClick:U,testId:"toolbar-redo",title:"Redo",className:s["icon-center"]},e.default.createElement(g,{name:"redo"})),e.default.createElement(a,{onClick:z,testId:"toolbar-copy",title:"Copy"},i("copy")),e.default.createElement(a,{onClick:x,testId:"toolbar-cut",title:"Cut"},i("cut")),e.default.createElement(a,{onClick:N,testId:"toolbar-paste",title:"Paste"},i("paste")),e.default.createElement(_,{data:O,value:o.fontFamily,getItemStyle:I,onChange:T,testId:"toolbar-font-family",className:s.fontFamily}),e.default.createElement(_,{data:X,value:o.fontSize,onChange:w,testId:"toolbar-font-size"}),e.default.createElement(a,{active:o.isBold,onClick:L,testId:"toolbar-bold",title:"Bold"},e.default.createElement("span",{className:s.bold},"B")),e.default.createElement(a,{active:o.isItalic,onClick:M,testId:"toolbar-italic",title:"Italic"},e.default.createElement("span",{className:s.italic},"I")),e.default.createElement(a,{active:o.isStrike,onClick:P,testId:"toolbar-strike",title:"Strike"},e.default.createElement("span",{className:s.strike},"A")),e.default.createElement(_,{data:he,value:o.underline,title:"Underline",onChange:W,testId:"toolbar-underline"}),e.default.createElement(J,{controller:t}),e.default.createElement(E,{key:"fill-color",color:o.fillColor,onChange:r,testId:"toolbar-fill-color"},e.default.createElement(a,{style:D,testId:"toolbar-fill-color",className:s["icon-center"],title:"Fill Color"},e.default.createElement(oe,null))),e.default.createElement(E,{key:"font-color",color:o.fontColor,onChange:C,testId:"toolbar-font-color"},e.default.createElement(a,{style:B,testId:"toolbar-font-color",className:s["icon-center"],title:"Font Color"},e.default.createElement(g,{name:"fontColor"}))),e.default.createElement(a,{active:o.verticalAlign===0,onClick:ge,testId:"toolbar-vertical-top",className:s["icon-center"],title:"Top Align"},e.default.createElement(g,{name:"verticalTop"})),e.default.createElement(a,{active:o.verticalAlign===1,onClick:me,testId:"toolbar-vertical-middle",className:s["icon-center"],title:"Middle Align"},e.default.createElement(g,{name:"verticalMiddle"})),e.default.createElement(a,{active:o.verticalAlign===2,onClick:be,testId:"toolbar-vertical-bottom",className:s["icon-center"],title:"Bottom Align"},e.default.createElement(g,{name:"verticalBottom"})),e.default.createElement(a,{active:o.horizontalAlign===0,onClick:se,testId:"toolbar-horizontal-left",className:s["icon-center"],title:"Align Text Left"},e.default.createElement(g,{name:"horizontalLeft"})),e.default.createElement(a,{active:o.horizontalAlign===1,onClick:de,testId:"toolbar-horizontal-center",className:s["icon-center"],title:"Align Text Center"},e.default.createElement(g,{name:"horizontalCenter"})),e.default.createElement(a,{active:o.horizontalAlign===2,onClick:ce,testId:"toolbar-horizontal-right",className:s["icon-center"],title:"Align Text Right"},e.default.createElement(g,{name:"horizontalRight"})),e.default.createElement(a,{active:o.isWrapText,onClick:f,testId:"toolbar-wrap-text",className:s["wrap-text"],title:"Wrap Text"},i("wrap-text")),e.default.createElement(V,{data:ye,value:o.mergeType,onChange:y,className:s["merge-cell"],testId:"toolbar-merge-cell-select"},e.default.createElement(a,{active:o.isMergeCell,onClick:h,testId:"toolbar-merge-cell",className:s["merge-cell-button"],type:"plain",title:"Merge And Center"},i("merge-and-center"))),e.default.createElement(V,{data:A,value:p,onChange:v,className:s["number-format"],testId:"toolbar-number-format"},e.default.createElement("div",{className:s["number-format-value"],"data-testid":"toolbar-number-format-value"},b)),e.default.createElement(le,{controller:t}),e.default.createElement(ie,{controller:t}),e.default.createElement(te,null))});ae.displayName="ToolbarContainer";var $e=ae;export{ae as ToolbarContainer,$e as default};
//# sourceMappingURL=ToolBar-ATXWOXCN.js.map
