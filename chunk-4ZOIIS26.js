/* 
MIT License

Copyright (c) 2020 Steve Xu

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/
import{D as Ye,E as Ze,F as et,G as tt,H as rt,N as ne,Q as nt,R as st,Z as at,qa as ae,r as ze,ra as it,sa as _e,t as le,ta as Y,u as Ce,ua as ot,va as ht,w as Je,xa as ut,y as qe}from"./chunk-3OL4F4KC.js";import{b as _t,c as vt}from"./chunk-AI5EXC2Q.js";var lt=_t((hr,ve)=>{"use strict";var ct={};function Ot(u){u.version="0.11.3";function e(s){for(var t="",n=s.length-1;n>=0;)t+=s.charAt(n--);return t}function r(s,t){for(var n="";n.length<t;)n+=s;return n}function c(s,t){var n=""+s;return n.length>=t?n:r("0",t-n.length)+n}function b(s,t){var n=""+s;return n.length>=t?n:r(" ",t-n.length)+n}function C(s,t){var n=""+s;return n.length>=t?n:n+r(" ",t-n.length)}function L(s,t){var n=""+Math.round(s);return n.length>=t?n:r("0",t-n.length)+n}function P(s,t){var n=""+s;return n.length>=t?n:r("0",t-n.length)+n}var G=Math.pow(2,32);function _(s,t){if(s>G||s<-G)return L(s,t);var n=Math.round(s);return P(n,t)}function I(s,t){return t=t||0,s.length>=7+t&&(s.charCodeAt(t)|32)===103&&(s.charCodeAt(t+1)|32)===101&&(s.charCodeAt(t+2)|32)===110&&(s.charCodeAt(t+3)|32)===101&&(s.charCodeAt(t+4)|32)===114&&(s.charCodeAt(t+5)|32)===97&&(s.charCodeAt(t+6)|32)===108}var $=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],W=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Q(s){s[0]="General",s[1]="0",s[2]="0.00",s[3]="#,##0",s[4]="#,##0.00",s[9]="0%",s[10]="0.00%",s[11]="0.00E+00",s[12]="# ?/?",s[13]="# ??/??",s[14]="m/d/yy",s[15]="d-mmm-yy",s[16]="d-mmm",s[17]="mmm-yy",s[18]="h:mm AM/PM",s[19]="h:mm:ss AM/PM",s[20]="h:mm",s[21]="h:mm:ss",s[22]="m/d/yy h:mm",s[37]="#,##0 ;(#,##0)",s[38]="#,##0 ;[Red](#,##0)",s[39]="#,##0.00;(#,##0.00)",s[40]="#,##0.00;[Red](#,##0.00)",s[45]="mm:ss",s[46]="[h]:mm:ss",s[47]="mmss.0",s[48]="##0.0E+0",s[49]="@",s[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'}var z={};Q(z);var B=[],T=0;for(T=5;T<=8;++T)B[T]=32+T;for(T=23;T<=26;++T)B[T]=0;for(T=27;T<=31;++T)B[T]=14;for(T=50;T<=58;++T)B[T]=14;for(T=59;T<=62;++T)B[T]=T-58;for(T=67;T<=68;++T)B[T]=T-58;for(T=72;T<=75;++T)B[T]=T-58;for(T=67;T<=68;++T)B[T]=T-57;for(T=76;T<=78;++T)B[T]=T-56;for(T=79;T<=81;++T)B[T]=T-34;var kt={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function pe(s,t,n){for(var E=s<0?-1:1,a=s*E,x=0,o=1,d=0,y=1,p=0,w=0,A=Math.floor(a);p<t&&(A=Math.floor(a),d=A*o+x,w=A*p+y,!(a-A<5e-8));)a=1/(a-A),x=o,o=d,y=p,p=w;if(w>t&&(p>t?(w=y,d=x):(w=p,d=o)),!n)return[0,E*d,w];var j=Math.floor(E*d/w);return[j,E*d-j*w,w]}function wt(s){var t=s.toPrecision(16);if(t.indexOf("e")>-1){var n=t.slice(0,t.indexOf("e"));return n=n.indexOf(".")>-1?n.slice(0,n.slice(0,2)=="0."?17:16):n.slice(0,15)+r("0",n.length-15),n+t.slice(t.indexOf("e"))}var E=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+r("0",t.length-15);return Number(E)}function te(s,t,n){if(s>2958465||s<0)return null;s=wt(s);var E=s|0,a=Math.floor(86400*(s-E)),x=0,o=[],d={D:E,T:a,u:86400*(s-E)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),t&&t.date1904&&(E+=1462),d.u>.9999&&(d.u=0,++a==86400&&(d.T=a=0,++E,++d.D)),E===60)o=n?[1317,10,29]:[1900,2,29],x=3;else if(E===0)o=n?[1317,8,29]:[1900,1,0],x=6;else{E>60&&--E;var y=new Date(1900,0,1);y.setDate(y.getDate()+E-1),o=[y.getFullYear(),y.getMonth()+1,y.getDate()],x=y.getDay(),E<60&&(x=(x+6)%7),n&&(x=Mt(y,o))}return d.y=o[0],d.m=o[1],d.d=o[2],d.S=a%60,a=Math.floor(a/60),d.M=a%60,a=Math.floor(a/60),d.H=a,d.q=x,d}u.parse_date_code=te;var Ue=new Date(1899,11,31,0,0,0),At=Ue.getTime(),Rt=new Date(1900,2,1,0,0,0);function De(s,t){var n=s.getTime();return t?n-=1461*24*60*60*1e3:s>=Rt&&(n+=24*60*60*1e3),(n-(At+(s.getTimezoneOffset()-Ue.getTimezoneOffset())*6e4))/(24*60*60*1e3)}var Fe=function(){var t=/(?:\.0*|(\.\d*[1-9])0+)$/;function n(p){return p.indexOf(".")==-1?p:p.replace(t,"$1")}var E=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,a=/(E[+-])(\d)$/;function x(p){return p.indexOf("E")==-1?p:p.replace(E,"$1E").replace(a,"$10$2")}function o(p){var w=p<0?12:11,A=n(p.toFixed(12));return A.length<=w||(A=p.toPrecision(10),A.length<=w)?A:p.toExponential(5)}function d(p){var w=n(p.toFixed(11));return w.length>(p<0?12:11)||w==="0"||w==="-0"?p.toPrecision(6):w}function y(p){var w=Math.floor(Math.log(Math.abs(p))*Math.LOG10E),A;return w>=-4&&w<=-1?A=p.toPrecision(10+w):Math.abs(w)<=9?A=o(p):w===10?A=p.toFixed(10).substr(0,12):A=d(p),n(x(A.toUpperCase()))}return y}();u._general_num=Fe;function fe(s,t){switch(typeof s){case"string":return s;case"boolean":return s?"TRUE":"FALSE";case"number":return(s|0)===s?s.toString(10):Fe(s);case"undefined":return"";case"object":if(s==null)return"";if(s instanceof Date)return Ke(14,De(s,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+s)}u._general=fe;function Mt(s,t){t[0]-=581;var n=s.getDay();return s<60&&(n=(n+6)%7),n}var or="\u0E50\u0E51\u0E52\u0E53\u0E54\u0E55\u0E56\u0E57\u0E58\u0E59".split("");function Ct(s,t,n,E){var a="",x=0,o=0,d=n.y,y,p=0;switch(s){case 98:d=n.y+543;case 121:switch(t.length){case 1:case 2:y=d%100,p=2;break;default:y=d%1e4,p=4;break}break;case 109:switch(t.length){case 1:case 2:y=n.m,p=t.length;break;case 3:return W[n.m-1][1];case 5:return W[n.m-1][0];default:return W[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:y=n.d,p=t.length;break;case 3:return $[n.q][0];default:return $[n.q][1]}break;case 104:switch(t.length){case 1:case 2:y=1+(n.H+11)%12,p=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:y=n.H,p=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:y=n.M,p=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?c(n.S,t.length):(E>=2?o=E===3?1e3:100:o=E===1?10:1,x=Math.round(o*(n.S+n.u)),x>=60*o&&(x=0),t==="s"?x===0?"0":""+x/o:(a=c(x,2+E),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":y=n.D*24+n.H;break;case"[m]":case"[mm]":y=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":y=((n.D*24+n.H)*60+n.M)*60+(E==0?Math.round(n.S+n.u):n.S);break;default:throw"bad abstime format: "+t}p=t.length===3?1:2;break;case 101:y=d,p=1;break}var w=p>0?c(y,p):"";return w}function q(s){var t=3;if(s.length<=t)return s;for(var n=s.length%t,E=s.substr(0,n);n!=s.length;n+=t)E+=(E.length>0?",":"")+s.substr(n,t);return E}var J=function(){var t=/%/g;function n(l,i,h){var m=i.replace(t,""),g=i.length-m.length;return J(l,m,h*Math.pow(10,2*g))+r("%",g)}function E(l,i,h){for(var m=i.length-1;i.charCodeAt(m-1)===44;)--m;return J(l,i.substr(0,m),h/Math.pow(10,3*(i.length-m)))}function a(l,i){var h,m=l.indexOf("E")-l.indexOf(".")-1;if(l.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+a(l,-i);var g=l.indexOf(".");g===-1&&(g=l.indexOf("E"));var f=Math.floor(Math.log(i)*Math.LOG10E)%g;if(f<0&&(f+=g),h=(i/Math.pow(10,f)).toPrecision(m+1+(g+f)%g),h.indexOf("e")===-1){var k=Math.floor(Math.log(i)*Math.LOG10E);for(h.indexOf(".")===-1?h=h.charAt(0)+"."+h.substr(1)+"E+"+(k-h.length+f):h+="E+"+(k-f);h.substr(0,2)==="0.";)h=h.charAt(0)+h.substr(2,g)+"."+h.substr(2+g),h=h.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");h=h.replace(/\+-/,"-")}h=h.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(O,N,S,M){return N+S+M.substr(0,(g+f)%g)+"."+M.substr(f)+"E"})}else h=i.toExponential(m);return l.match(/E\+00$/)&&h.match(/e[+-]\d$/)&&(h=h.substr(0,h.length-1)+"0"+h.charAt(h.length-1)),l.match(/E\-/)&&h.match(/e\+/)&&(h=h.replace(/e\+/,"e")),h.replace("e","E")}var x=/# (\?+)( ?)\/( ?)(\d+)/;function o(l,i,h){var m=parseInt(l[4],10),g=Math.round(i*m),f=Math.floor(g/m),k=g-f*m,O=m;return h+(f===0?"":""+f)+" "+(k===0?r(" ",l[1].length+1+l[4].length):b(k,l[1].length)+l[2]+"/"+l[3]+c(O,l[4].length))}function d(l,i,h){return h+(i===0?"":""+i)+r(" ",l[1].length+2+l[4].length)}var y=/^#*0*\.([0#]+)/,p=/\).*[0#]/,w=/\(###\) ###\\?-####/;function A(l){for(var i="",h,m=0;m!=l.length;++m)switch(h=l.charCodeAt(m)){case 35:break;case 63:i+=" ";break;case 48:i+="0";break;default:i+=String.fromCharCode(h)}return i}function j(l,i){var h=Math.pow(10,i);return""+Math.round(l*h)/h}function re(l,i){var h=l-Math.floor(l),m=Math.pow(10,i);return i<(""+Math.round(h*m)).length?0:Math.round(h*m)}function Re(l,i){return i<(""+Math.round((l-Math.floor(l))*Math.pow(10,i))).length?1:0}function K(l){return l<2147483647&&l>-2147483648?""+(l>=0?l|0:l-1|0):""+Math.floor(l)}function v(l,i,h){if(l.charCodeAt(0)===40&&!i.match(p)){var m=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return h>=0?v("n",m,h):"("+v("n",m,-h)+")"}if(i.charCodeAt(i.length-1)===44)return E(l,i,h);if(i.indexOf("%")!==-1)return n(l,i,h);if(i.indexOf("E")!==-1)return a(i,h);if(i.charCodeAt(0)===36)return"$"+v(l,i.substr(i.charAt(1)==" "?2:1),h);var g,f,k,O,N=Math.abs(h),S=h<0?"-":"";if(i.match(/^00+$/))return S+_(N,i.length);if(i.match(/^[#?]+$/))return g=_(h,0),g==="0"&&(g=""),g.length>i.length?g:A(i.substr(0,i.length-g.length))+g;if(f=i.match(x))return o(f,N,S);if(i.match(/^#+0+$/))return S+_(N,i.length-i.indexOf("0"));if(f=i.match(y))return g=j(h,f[1].length).replace(/^([^\.]+)$/,"$1."+A(f[1])).replace(/\.$/,"."+A(f[1])).replace(/\.(\d*)$/,function(X,ce){return"."+ce+r("0",A(f[1]).length-ce.length)}),i.indexOf("0.")!==-1?g:g.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),f=i.match(/^(0*)\.(#*)$/))return S+j(N,f[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=i.match(/^#{1,3},##0(\.?)$/))return S+q(_(N,0));if(f=i.match(/^#,##0\.([#0]*0)$/))return h<0?"-"+v(l,i,-h):q(""+(Math.floor(h)+Re(h,f[1].length)))+"."+c(re(h,f[1].length),f[1].length);if(f=i.match(/^#,#*,#0/))return v(l,i.replace(/^#,#*,/,""),h);if(f=i.match(/^([0#]+)(\\?-([0#]+))+$/))return g=e(v(l,i.replace(/[\\-]/g,""),h)),k=0,e(e(i.replace(/\\/g,"")).replace(/[0#]/g,function(X){return k<g.length?g.charAt(k++):X==="0"?"0":""}));if(i.match(w))return g=v(l,"##########",h),"("+g.substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var M="";if(f=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(f[4].length,7),O=pe(N,Math.pow(10,k)-1,!1),g=""+S,M=J("n",f[1],O[1]),M.charAt(M.length-1)==" "&&(M=M.substr(0,M.length-1)+"0"),g+=M+f[2]+"/"+f[3],M=C(O[2],k),M.length<f[4].length&&(M=A(f[4].substr(f[4].length-M.length))+M),g+=M,g;if(f=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max(f[1].length,f[4].length),7),O=pe(N,Math.pow(10,k)-1,!0),S+(O[0]||(O[1]?"":"0"))+" "+(O[1]?b(O[1],k)+f[2]+"/"+f[3]+C(O[2],k):r(" ",2*k+1+f[2].length+f[3].length));if(f=i.match(/^[#0?]+$/))return g=_(h,0),i.length<=g.length?g:A(i.substr(0,i.length-g.length))+g;if(f=i.match(/^([#0?]+)\.([#0]+)$/)){g=""+h.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),k=g.indexOf(".");var he=i.indexOf(".")-k,Me=i.length-g.length-he;return A(i.substr(0,he)+g+i.substr(i.length-Me))}if(f=i.match(/^00,000\.([#0]*0)$/))return k=re(h,f[1].length),h<0?"-"+v(l,i,-h):q(K(h)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(X){return"00,"+(X.length<3?c(0,3-X.length):"")+X})+"."+c(k,f[1].length);switch(i){case"###,##0.00":return v(l,"#,##0.00",h);case"###,###":case"##,###":case"#,###":var ue=q(_(N,0));return ue!=="0"?S+ue:"";case"###,###.00":return v(l,"###,##0.00",h).replace(/^0\./,".");case"#,###.00":return v(l,"#,##0.00",h).replace(/^0\./,".");default:}throw new Error("unsupported format |"+i+"|")}function se(l,i,h){for(var m=i.length-1;i.charCodeAt(m-1)===44;)--m;return J(l,i.substr(0,m),h/Math.pow(10,3*(i.length-m)))}function ge(l,i,h){var m=i.replace(t,""),g=i.length-m.length;return J(l,m,h*Math.pow(10,2*g))+r("%",g)}function H(l,i){var h,m=l.indexOf("E")-l.indexOf(".")-1;if(l.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+H(l,-i);var g=l.indexOf(".");g===-1&&(g=l.indexOf("E"));var f=Math.floor(Math.log(i)*Math.LOG10E)%g;if(f<0&&(f+=g),h=(i/Math.pow(10,f)).toPrecision(m+1+(g+f)%g),!h.match(/[Ee]/)){var k=Math.floor(Math.log(i)*Math.LOG10E);h.indexOf(".")===-1?h=h.charAt(0)+"."+h.substr(1)+"E+"+(k-h.length+f):h+="E+"+(k-f),h=h.replace(/\+-/,"-")}h=h.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(O,N,S,M){return N+S+M.substr(0,(g+f)%g)+"."+M.substr(f)+"E"})}else h=i.toExponential(m);return l.match(/E\+00$/)&&h.match(/e[+-]\d$/)&&(h=h.substr(0,h.length-1)+"0"+h.charAt(h.length-1)),l.match(/E\-/)&&h.match(/e\+/)&&(h=h.replace(/e\+/,"e")),h.replace("e","E")}function D(l,i,h){if(l.charCodeAt(0)===40&&!i.match(p)){var m=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return h>=0?D("n",m,h):"("+D("n",m,-h)+")"}if(i.charCodeAt(i.length-1)===44)return se(l,i,h);if(i.indexOf("%")!==-1)return ge(l,i,h);if(i.indexOf("E")!==-1)return H(i,h);if(i.charCodeAt(0)===36)return"$"+D(l,i.substr(i.charAt(1)==" "?2:1),h);var g,f,k,O,N=Math.abs(h),S=h<0?"-":"";if(i.match(/^00+$/))return S+c(N,i.length);if(i.match(/^[#?]+$/))return g=""+h,h===0&&(g=""),g.length>i.length?g:A(i.substr(0,i.length-g.length))+g;if(f=i.match(x))return d(f,N,S);if(i.match(/^#+0+$/))return S+c(N,i.length-i.indexOf("0"));if(f=i.match(y))return g=(""+h).replace(/^([^\.]+)$/,"$1."+A(f[1])).replace(/\.$/,"."+A(f[1])),g=g.replace(/\.(\d*)$/,function(X,ce){return"."+ce+r("0",A(f[1]).length-ce.length)}),i.indexOf("0.")!==-1?g:g.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),f=i.match(/^(0*)\.(#*)$/))return S+(""+N).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=i.match(/^#{1,3},##0(\.?)$/))return S+q(""+N);if(f=i.match(/^#,##0\.([#0]*0)$/))return h<0?"-"+D(l,i,-h):q(""+h)+"."+r("0",f[1].length);if(f=i.match(/^#,#*,#0/))return D(l,i.replace(/^#,#*,/,""),h);if(f=i.match(/^([0#]+)(\\?-([0#]+))+$/))return g=e(D(l,i.replace(/[\\-]/g,""),h)),k=0,e(e(i.replace(/\\/g,"")).replace(/[0#]/g,function(X){return k<g.length?g.charAt(k++):X==="0"?"0":""}));if(i.match(w))return g=D(l,"##########",h),"("+g.substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var M="";if(f=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(f[4].length,7),O=pe(N,Math.pow(10,k)-1,!1),g=""+S,M=J("n",f[1],O[1]),M.charAt(M.length-1)==" "&&(M=M.substr(0,M.length-1)+"0"),g+=M+f[2]+"/"+f[3],M=C(O[2],k),M.length<f[4].length&&(M=A(f[4].substr(f[4].length-M.length))+M),g+=M,g;if(f=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max(f[1].length,f[4].length),7),O=pe(N,Math.pow(10,k)-1,!0),S+(O[0]||(O[1]?"":"0"))+" "+(O[1]?b(O[1],k)+f[2]+"/"+f[3]+C(O[2],k):r(" ",2*k+1+f[2].length+f[3].length));if(f=i.match(/^[#0?]+$/))return g=""+h,i.length<=g.length?g:A(i.substr(0,i.length-g.length))+g;if(f=i.match(/^([#0]+)\.([#0]+)$/)){g=""+h.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),k=g.indexOf(".");var he=i.indexOf(".")-k,Me=i.length-g.length-he;return A(i.substr(0,he)+g+i.substr(i.length-Me))}if(f=i.match(/^00,000\.([#0]*0)$/))return h<0?"-"+D(l,i,-h):q(""+h).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(X){return"00,"+(X.length<3?c(0,3-X.length):"")+X})+"."+c(0,f[1].length);switch(i){case"###,###":case"##,###":case"#,###":var ue=q(""+N);return ue!=="0"?S+ue:"";default:if(i.match(/\.[0#?]*$/))return D(l,i.slice(0,i.lastIndexOf(".")),h)+A(i.slice(i.lastIndexOf(".")))}throw new Error("unsupported format |"+i+"|")}return function(i,h,m){return(m|0)===m?D(i,h,m):v(i,h,m)}}();function Ge(s){for(var t=[],n=!1,E=0,a=0;E<s.length;++E)switch(s.charCodeAt(E)){case 34:n=!n;break;case 95:case 42:case 92:++E;break;case 59:t[t.length]=s.substr(a,E-a),a=E+1}if(t[t.length]=s.substr(a),n===!0)throw new Error("Format |"+s+"| unterminated string ");return t}u._split=Ge;var Pe=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function He(s){for(var t=0,n="",E="";t<s.length;)switch(n=s.charAt(t)){case"G":I(s,t)&&(t+=6),t++;break;case'"':for(;s.charCodeAt(++t)!==34&&t<s.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(s.charAt(t+1)==="1"||s.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(s.substr(t,3).toUpperCase()==="A/P"||s.substr(t,5).toUpperCase()==="AM/PM"||s.substr(t,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++t;break;case"[":for(E=n;s.charAt(t++)!=="]"&&t<s.length;)E+=s.charAt(t);if(E.match(Pe))return!0;break;case".":case"0":case"#":for(;t<s.length&&("0#?.,E+-%".indexOf(n=s.charAt(++t))>-1||n=="\\"&&s.charAt(t+1)=="-"&&"0#".indexOf(s.charAt(t+2))>-1););break;case"?":for(;s.charAt(++t)===n;);break;case"*":++t,(s.charAt(t)==" "||s.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<s.length&&"0123456789".indexOf(s.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}u.is_date=He;function Ve(s,t,n,E){for(var a=[],x="",o=0,d="",y="t",p,w,A,j="H";o<s.length;)switch(d=s.charAt(o)){case"G":if(!I(s,o))throw new Error("unrecognized character "+d+" in "+s);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(x="";(A=s.charCodeAt(++o))!==34&&o<s.length;)x+=String.fromCharCode(A);a[a.length]={t:"t",v:x},++o;break;case"\\":var re=s.charAt(++o),Re=re==="("||re===")"?re:"t";a[a.length]={t:Re,v:re},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(s.charAt(o+1)==="1"||s.charAt(o+1)==="2"){if(p==null&&(p=te(t,n,s.charAt(o+1)==="2"),p==null))return"";a[a.length]={t:"X",v:s.substr(o,2)},y=d,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||p==null&&(p=te(t,n),p==null))return"";for(x=d;++o<s.length&&s.charAt(o).toLowerCase()===d;)x+=d;d==="m"&&y.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=j),a[a.length]={t:d,v:x},y=d;break;case"A":case"a":case"\u4E0A":var K={t:d,v:d};if(p==null&&(p=te(t,n)),s.substr(o,3).toUpperCase()==="A/P"?(p!=null&&(K.v=p.H>=12?s.charAt(o+2):d),K.t="T",j="h",o+=3):s.substr(o,5).toUpperCase()==="AM/PM"?(p!=null&&(K.v=p.H>=12?"PM":"AM"),K.t="T",o+=5,j="h"):s.substr(o,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(p!=null&&(K.v=p.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),K.t="T",o+=5,j="h"):(K.t="t",++o),p==null&&K.t==="T")return"";a[a.length]=K,y=d;break;case"[":for(x=d;s.charAt(o++)!=="]"&&o<s.length;)x+=s.charAt(o);if(x.slice(-1)!=="]")throw'unterminated "[" block: |'+x+"|";if(x.match(Pe)){if(p==null&&(p=te(t,n),p==null))return"";a[a.length]={t:"Z",v:x.toLowerCase()},y=x.charAt(1)}else x.indexOf("$")>-1&&(x=(x.match(/\$([^-\[\]]*)/)||[])[1]||"$",He(s)||(a[a.length]={t:"t",v:x}));break;case".":if(p!=null){for(x=d;++o<s.length&&(d=s.charAt(o))==="0";)x+=d;a[a.length]={t:"s",v:x};break}case"0":case"#":for(x=d;++o<s.length&&"0#?.,E+-%".indexOf(d=s.charAt(o))>-1;)x+=d;a[a.length]={t:"n",v:x};break;case"?":for(x=d;s.charAt(++o)===d;)x+=d;a[a.length]={t:d,v:x},y=d;break;case"*":++o,(s.charAt(o)==" "||s.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:E===1?"t":d,v:d},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(x=d;o<s.length&&"0123456789".indexOf(s.charAt(++o))>-1;)x+=s.charAt(o);a[a.length]={t:"D",v:x};break;case" ":a[a.length]={t:d,v:d},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+s);a[a.length]={t:"t",v:d},++o;break}var v=0,se=0,ge;for(o=a.length-1,y="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=j,y="h",v<1&&(v=1);break;case"s":(ge=a[o].v.match(/\.0+$/))&&(se=Math.max(se,ge[0].length-1),v=4),v<3&&(v=3);case"d":case"y":case"e":y=a[o].t;break;case"M":y=a[o].t,v<2&&(v=2);break;case"m":y==="s"&&(a[o].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[o].v.match(/[Hh]/)&&(v=1),v<2&&a[o].v.match(/[Mm]/)&&(v=2),v<3&&a[o].v.match(/[Ss]/)&&(v=3)}var H;switch(v){case 0:break;case 1:case 2:case 3:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H),p.H>=24&&(p.H=0,++p.D,H=te(p.D),H.u=p.u,H.S=p.S,H.M=p.M,H.H=p.H,p=H);break;case 4:switch(se){case 1:p.u=Math.round(p.u*10)/10;break;case 2:p.u=Math.round(p.u*100)/100;break;case 3:p.u=Math.round(p.u*1e3)/1e3;break}p.u>=1&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H),p.H>=24&&(p.H=0,++p.D,H=te(p.D),H.u=p.u,H.S=p.S,H.M=p.M,H.H=p.H,p=H);break}var D="",l;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=Ct(a[o].t.charCodeAt(0),a[o].v,p,se),a[o].t="t";break;case"n":case"?":for(l=o+1;a[l]!=null&&((d=a[l].t)==="?"||d==="D"||(d===" "||d==="t")&&a[l+1]!=null&&(a[l+1].t==="?"||a[l+1].t==="t"&&a[l+1].v==="/")||a[o].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(a[l].v==="/"||a[l].v===" "&&a[l+1]!=null&&a[l+1].t=="?"));)a[o].v+=a[l].v,a[l]={v:"",t:";"},++l;D+=a[o].v,o=l-1;break;case"G":a[o].t="t",a[o].v=fe(t,n);break}var i="",h,m;if(D.length>0){D.charCodeAt(0)==40?(h=t<0&&D.charCodeAt(0)===45?-t:t,m=J("n",D,h)):(h=t<0&&E>1?-t:t,m=J("n",D,h),h<0&&a[0]&&a[0].t=="t"&&(m=m.substr(1),a[0].v="-"+a[0].v)),l=m.length-1;var g=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){g=o;break}var f=a.length;if(g===a.length&&m.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(l>=a[o].v.length-1?(l-=a[o].v.length,a[o].v=m.substr(l+1,a[o].v.length)):l<0?a[o].v="":(a[o].v=m.substr(0,l+1),l=-1),a[o].t="t",f=o);l>=0&&f<a.length&&(a[f].v=m.substr(0,l+1)+a[f].v)}else if(g!==a.length&&m.indexOf("E")===-1){for(l=m.indexOf(".")-1,o=g;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(w=a[o].v.indexOf(".")>-1&&o===g?a[o].v.indexOf(".")-1:a[o].v.length-1,i=a[o].v.substr(w+1);w>=0;--w)l>=0&&(a[o].v.charAt(w)==="0"||a[o].v.charAt(w)==="#")&&(i=m.charAt(l--)+i);a[o].v=i,a[o].t="t",f=o}for(l>=0&&f<a.length&&(a[f].v=m.substr(0,l+1)+a[f].v),l=m.indexOf(".")+1,o=g;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==g)){for(w=a[o].v.indexOf(".")>-1&&o===g?a[o].v.indexOf(".")+1:0,i=a[o].v.substr(0,w);w<a[o].v.length;++w)l<m.length&&(i+=m.charAt(l++));a[o].v=i,a[o].t="t",f=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(h=E>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=J(a[o].t,a[o].v,h),a[o].t="t");var k="";for(o=0;o!==a.length;++o)a[o]!=null&&(k+=a[o].v);return k}u._eval=Ve;var Be=/\[[=<>]/,Xe=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Qe(s,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(s==n)return!0;break;case">":if(s>n)return!0;break;case"<":if(s<n)return!0;break;case"<>":if(s!=n)return!0;break;case">=":if(s>=n)return!0;break;case"<=":if(s<=n)return!0;break}return!1}function je(s,t){var n=Ge(s),E=n.length,a=n[E-1].indexOf("@");if(E<4&&a>-1&&--E,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break;case 4:break}var x=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[E,x];if(n[0].match(Be)!=null||n[1].match(Be)!=null){var o=n[0].match(Xe),d=n[1].match(Xe);return Qe(t,o)?[E,n[0]]:Qe(t,d)?[E,n[1]]:[E,n[o!=null&&d!=null?2:1]]}return[E,x]}function Ke(s,t,n){n==null&&(n={});var E="";switch(typeof s){case"string":s=="m/d/yy"&&n.dateNF?E=n.dateNF:E=s;break;case"number":s==14&&n.dateNF?E=n.dateNF:E=(n.table!=null?n.table:z)[s],E==null&&(E=n.table&&n.table[B[s]]||z[B[s]]),E==null&&(E=kt[s]||"General");break}if(I(E,0))return fe(t,n);t instanceof Date&&(t=De(t,n.date1904));var a=je(E,t);if(I(a[1]))return fe(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Ve(a[1],t,n,a[0])}function We(s,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(z[n]==null){t<0&&(t=n);continue}if(z[n]==s){t=n;break}}t<0&&(t=391)}return z[t]=s,t}u.load=We,u._table=z,u.get_table=function(){return z},u.load_table=function(t){for(var n=0;n!=392;++n)t[n]!==void 0&&We(t[n],n)},u.init_table=Q,u.format=Ke,u.choose_format=je}Ot(ct);typeof ve<"u"&&typeof DO_NOT_EXPORT_SSF>"u"&&(ve.exports=ct)});var Oe=vt(lt());function pt(u,e,r={}){return Oe.default.format(e||Je,u,r)}function cr(u){return u?Oe.default.is_date(u):!1}function lr(u,e){let r=new Date(1899,11,31,0,0,0),c=r.getTime(),b=new Date(1900,2,1,0,0,0),C=u.getTime();return e?C-=1461*24*60*60*1e3:u>=b&&(C+=24*60*60*1e3),(C-(c+(u.getTimezoneOffset()-r.getTimezoneOffset())*6e4))/(24*60*60*1e3)}var V=class{constructor(e,r){this.type=e,this.value=r}toString(){return this.value}};var R=class extends Error{constructor(e){super(e),this.value=e}};function U(u,e="#VALUE!"){if(!u)throw new R(e)}function de(u){U(u.length===1);let[e]=u;return e}function ie(u){let e=de(u);return U(typeof e=="string"),e}function F(u){let e=de(u),[r,c]=ne(e);return U(r),c}function Ne(u){U(u.length===0)}var Nt=(...u)=>{let e=de(u);return typeof e=="string"?e:""},St=(...u)=>ie(u).toLowerCase(),ft=(...u)=>{let e=F(u);return String.fromCharCode(e)},gt=(...u)=>ie(u).charCodeAt(0),Lt=(...u)=>ie(u).length,It=(...u)=>{U(u.length===2);let[e,r]=u;return U(typeof e=="string"),U(typeof r=="string"),e.split(r)},$t=(...u)=>ie(u).toUpperCase(),Ut=(...u)=>{U(u.length===2);let[e,r]=u;return U(typeof e=="string"||typeof e=="number"),U(typeof r=="string"),pt(e,r)},Dt=(...u)=>ie(u).replace(/ +/g," ").trim(),dt=(...u)=>(U(u.length<=le),u.join("")),Ft={CONCAT:dt,CONCATENATE:dt,SPLIT:It,CHAR:ft,CODE:gt,UNICHAR:ft,UNICODE:gt,LEN:Lt,LOWER:St,UPPER:$t,TRIM:Dt,TEXT:Ut,T:Nt},Et=Ft;function mt(u){let e=[];for(let r=0;r<u.length;r++){let[c,b]=ne(u[r]);c&&e.push(b)}return e}var Gt=(...u)=>{let e=F(u);return Math.abs(e)},Pt=(...u)=>{let e=F(u);return Math.acos(e)},Ht=(...u)=>{let e=F(u);return Math.log(e+Math.sqrt(e*e-1))},Vt=(...u)=>{let e=F(u);return Math.atan(1/e)},Bt=(...u)=>{let e=F(u);return .5*Math.log((e+1)/(e-1))},Xt=(...u)=>{let e=F(u);return Math.asin(e)},Qt=(...u)=>{let e=F(u);return Math.log(e+Math.sqrt(e*e+1))},jt=(...u)=>{let e=F(u);return Math.atan(e)},Kt=(...u)=>{U(u.length===2);let[e,r]=u;return U(typeof e=="number"),U(typeof r=="number"),Math.atan2(e,r)},Wt=(...u)=>{let e=F(u);return Math.log((1+e)/(e+1))/2},zt=(...u)=>{let e=mt(u);return U(e.length<=le&&e.length>=1),e.reduce((r,c)=>r+c,0)/e.length},Jt=(...u)=>{let e=F(u);return Math.cos(e)},qt=(...u)=>{let e=F(u);return 1/Math.tan(e)};var Yt=(...u)=>{let e=F(u);return Math.exp(e)},Zt=(...u)=>{let e=F(u);return Math.floor(e)};var er=(...u)=>(Ne(u),Math.PI),tr=(...u)=>(Ne(u),Math.E),rr=(...u)=>{let e=F(u);return Math.sin(e)},nr=(...u)=>{let e=mt(u);return U(e.length<=le),e.reduce((r,c)=>r+c,0)},sr={ABS:Gt,ACOS:Pt,ACOSH:Ht,ACOT:Vt,ACOTH:Bt,ASIN:Xt,ASINH:Qt,ATAN:jt,ATAN2:Kt,ATANH:Wt,AVERAGE:zt,COT:qt,COS:Jt,EXP:Yt,INT:Zt,PI:er,E:tr,SIN:rr,SUM:nr},xt=sr;function bt(u){let e=String(u),r=/[.](\d*)/.exec(e);if(r&&r[1]){let c=Math.pow(10,Math.min(r[1].length,Ce)),b=e.split("."),C=b[0]+b[1].slice(0,Ce);return Number(C)/c}else return u}var ar={...Et,...xt},Se=ar;var Tt="",Ee=class{constructor(e){this.current=0;this.start=0;this.tokens=[];this.list=[...e]}scan(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();return this.tokens.push(new V(36,"")),this.tokens.length>0&&this.tokens[0].type===0&&this.tokens.shift(),this.tokens}peek(){return this.isAtEnd()?Tt:this.list[this.current]}match(e){return this.peek()!==e?!1:(this.next(),!0)}next(){return this.isAtEnd()?Tt:this.list[this.current++]}isAtEnd(){return this.current>=this.list.length}addToken(e){let r=this.list.slice(this.start,this.current).join("");this.tokens.push(new V(e,r))}string(e){for(;!this.isAtEnd()&&this.peek()!==e;)this.next();if(this.peek()!==e)throw new R("#VALUE!");this.next();let r=this.list.slice(this.start+1,this.current-1).join("");if(e==="'"&&this.match("!")){this.tokens.push(new V(28,r));return}this.tokens.push(new V(16,r))}getDigits(){for(;!this.isAtEnd()&&Y(this.peek());)this.next()}getAlphas(){for(;!this.isAtEnd()&&_e(this.peek());)this.next()}matchR1C1(){if(this.match("[")){if(this.match("-"),Y(this.peek()))this.getDigits();else throw new R("#VALUE!");if(this.peek()!=="]")throw new R("#VALUE!");this.next()}else this.getDigits()}matchScientificCounting(){if(this.match("E")||this.match("e")){if(this.match("+")||this.match("-"))return this.getDigits(),this.addToken(17),!0;if(Y(this.peek()))return this.getDigits(),this.addToken(17),!0;throw new R("#VALUE!")}return!1}number(){this.getDigits(),!(this.matchScientificCounting()||(this.match(".")&&this.getDigits(),this.matchScientificCounting()))&&this.addToken(17)}addIdentifier(){for(;!this.isAtEnd()&&this.anyChar(this.peek());)this.next();let e=this.list.slice(this.start,this.current).join(""),r=e.toUpperCase();if(rt.has(r)&&this.match("(")){this.tokens.push(new V(33,r));return}if(["IF","CHOOSE"].includes(r)&&this.match("(")){this.tokens.push(new V(35,r));return}if(["INDEX","OFFSET","INDIRECT"].includes(r)&&this.match("(")){this.tokens.push(new V(34,r));return}if(this.match("!")){this.tokens.push(new V(28,e));return}let c=18;if(r==="TRUE"||r==="FALSE")e=r,c=18;else if(qe.has(r))e=r,c=r==="#REF!"?20:19;else if(Ye.test(r))c=29;else if(Ze.test(r))c=30;else if(et.test(r))c=31;else if(tt.test(r))c=32;else throw new R("#NAME?");this.tokens.push(new V(c,e))}scanToken(){let e=this.next();switch(e){case"$":{_e(this.peek())?(this.getAlphas(),this.match("$")?Y(this.peek())?(this.getDigits(),this.addToken(29)):this.addIdentifier():Y(this.peek())?(this.getDigits(),this.addToken(29)):this.addToken(30)):Y(this.peek())?(this.getDigits(),this.addToken(31)):this.addIdentifier();break}case"r":case"R":{if(this.matchR1C1(),this.match("C")||this.match("c")){this.matchR1C1();let r=this.list.slice(this.start,this.current).join("").toUpperCase();this.tokens.push(new V(27,r))}else this.addIdentifier();break}case"(":this.addToken(21);break;case")":this.addToken(22);break;case",":this.addToken(11);break;case":":this.addToken(10);break;case ze:this.addToken(0);break;case"<":this.match(">")?this.addToken(1):this.match("=")?this.addToken(15):this.addToken(14);break;case">":this.match("=")?this.addToken(8):this.addToken(7);break;case"+":this.addToken(2);break;case"-":this.addToken(3);break;case"*":this.addToken(4);break;case"/":this.addToken(5);break;case"^":this.addToken(6);break;case"&":this.addToken(9);break;case"%":this.addToken(13);break;case'"':this.string(e);break;case"'":this.string(e);break;case"!":this.addToken(26);break;case";":this.addToken(25);break;case"{":this.addToken(23);break;case"}":this.addToken(24);break;case" ":break;case"\r":case"	":case`
`:break;default:Y(e)?this.number():this.addIdentifier();break}}anyChar(e){return!'(),:=<>+-*/^&%"{}!'.includes(e)&&!this.isWhiteSpace(e)}isWhiteSpace(e){return e===" "||e==="\r"||e===`
`||e==="	"}};var Z=class{constructor(e,r,c){this.left=e,this.operator=r,this.right=c}accept(e){return e.visitBinaryExpression(this)}handleConcatenate(e){let r=e.toString();return this.operator.type===9&&e instanceof oe&&e.value.type===16?JSON.stringify(r):r}toString(){let e=this.handleConcatenate(this.left),r=this.handleConcatenate(this.right);return`${e}${this.operator.toString()}${r}`}},me=class{constructor(e,r){this.operator=e,this.right=r}accept(e){return e.visitUnaryExpression(this)}toString(){return this.operator.toString()+this.right.toString()}},xe=class{constructor(e,r){this.operator=e,this.left=r}accept(e){return e.visitPostUnaryExpression(this)}toString(){return this.left.toString()+this.operator.toString()}},oe=class{constructor(e){this.value=e}accept(e){return e.visitLiteralExpression(this)}toString(){return this.value.toString()}},ee=class{constructor(e,r){this.value=e,this.sheetName=r}accept(e){return e.visitCellExpression(this)}toString(){let e=this.value.toString().toUpperCase();if(this.sheetName){let r=this.sheetName.toString();return r.includes(" ")&&(r=`'${r}'`),`${r}!${e}`}else return e}},be=class{constructor(e,r){this.name=e,this.params=r}accept(e){return e.visitCallExpression(this)}toString(){return`${this.name.toString()}(${this.params.map(e=>e.toString()).join(",")})`}},Te=class{constructor(e,r,c){this.left=e,this.operator=r,this.right=c}accept(e){return e.visitCellRangeExpression(this)}toString(){return this.left.toString()+this.operator.toString()+this.right.toString()}},ye=class{constructor(e){this.value=e}accept(e){return e.visitGroupExpression(this)}toString(){return`(${this.value.toString()})`}},ke=class{constructor(e){this.value=e}accept(e){return e.visitArrayExpression(this)}toString(){return`{${this.value.map(r=>r.toString()).join(",")}}`}};var we=class{constructor(e){this.current=0;this.tokens=e}parse(){let e=[];for(;!this.isAtEnd();)e.push(this.expression());return e}expression(){return this.comparison()}comparison(){let e=this.concatenate();for(;this.match(0,1,7,8,14,15);){let r=this.previous(),c=this.concatenate();e=new Z(e,r,c)}return e}concatenate(){let e=this.term();for(;this.match(9);){let r=this.previous(),c=this.term();e=new Z(e,r,c)}return e}term(){let e=this.factor();for(;this.match(2,3);){let r=this.previous(),c=this.factor();e=new Z(e,r,c)}return e}factor(){let e=this.expo();for(;this.match(5,4);){let r=this.previous(),c=this.expo();e=new Z(e,r,c)}return e}expo(){let e=this.unary();for(;this.match(6);){let r=this.previous(),c=this.unary();e=new Z(e,r,c)}return e}unary(){if(this.match(2,3)){let e=this.previous(),r=this.unary();return new me(e,r)}return this.postUnary()}postUnary(){let e=this.cellRange();if(this.match(13)){let r=this.previous();e=new xe(r,e)}return e}cellRange(){let e=this.sheetRange();for(;this.match(10);){let r=this.previous(),c=this.sheetRange(),b=this.convertToCellExpression(c),C=this.convertToCellExpression(e);e=new Te(C,r,b)}return e}convertToCellExpression(e){if(e instanceof ee)return e;if(e instanceof oe&&e.value.type===17)return new ee(e.value,void 0);throw new R("#NAME?")}sheetRange(){if(this.match(28)){let e=this.previous(),r=this.call();if(r instanceof ee)return new ee(r.value,e);throw new R("#REF!")}return this.call()}call(){if(this.match(33,34,35)){let e=this.previous(),r=[];if(!this.check(22))do{if(this.peek().type==22)break;r.push(this.expression())}while(this.match(11));return this.expect(22),new be(e,r)}return this.primary()}primary(){if(this.match(23)){let e=[];do{if(this.peek().type==24)break;e.push(this.expression())}while(this.match(11));return this.expect(24),new ke(e)}if(this.match(21)){let e=this.expression();return this.expect(22),new ye(e)}if(this.match(17,16,18))return new oe(this.previous());if(this.match(29,30,31,32,27)){let e=this.previous();return new ee(e,void 0)}throw this.match(19,20)?new R(this.previous().value):new R("#VALUE!")}match(...e){let{type:r}=this.peek();return e.includes(r)?(this.next(),!0):!1}previous(){return this.tokens[this.current-1]}check(e){return this.peek().type===e}expect(e){if(this.check(e))return this.next(),this.previous();throw new R("#VALUE!")}next(){this.current++}isAtEnd(){return this.peek().type===36}peek(){return this.current<this.tokens.length?this.tokens[this.current]:new V(36,"")}};var Ae=class{constructor(e,r,c){this.expressions=e,this.cellDataMap=c,this.currentCoord=r}interpret(){let e=[];for(let r of this.expressions){let c=this.evaluate(r),b=this.getRangeCellValue(c);Array.isArray(b)?e=e.concat(b):e.push(b)}return e}visitBinaryExpression(e){let r=this.evaluate(e.left),c=this.evaluate(e.right);switch(r=this.getOneValue(r),c=this.getOneValue(c),[3,2,5,4,6].includes(e.operator.type)&&(r=this.parseNumber(r),c=this.parseNumber(c)),e.operator.type){case 3:return r-c;case 2:return r+c;case 5:{if(c===0)throw new R("#DIV/0!");return r/c}case 4:return r*c;case 6:return Math.pow(r,c);case 0:return r===c;case 1:return r!==c;case 7:return r>c;case 8:return r>=c;case 14:return r<c;case 15:return r<=c;case 9:return`${r}${c}`;default:throw new R("#TEXT")}}visitCallExpression(e){let r=this.cellDataMap.getFunction(e.name.value);if(r&&typeof r=="function"){let c=[];for(let b of e.params){let C=this.evaluate(b);if(C instanceof ae){let L=this.getCellValue(C,!1);c=c.concat(L)}else c.push(C)}return r(...c)}throw new R("#NAME?")}visitCellExpression(e){let r="";if(e.sheetName){let b=this.cellDataMap.getSheetInfo("",e.sheetName.value);if(!b?.sheetId)throw new R("#REF!");r=b.sheetId}let c;if([32,29,30,27].includes(e.value.type)&&(c=this.cellDataMap.getDefinedName(e.value.value)),c||(e.value.type===27?c=ut(e.value.value,this.currentCoord):c=ot(e.value.value)),!c)throw new R("#REF!");return r&&(c.sheetId=r),c}visitLiteralExpression(e){let{type:r,value:c}=e.value;switch(r){case 16:return c;case 17:{let[b,C]=ne(c);if(b)return C;throw new R("#VALUE!")}case 18:return c==="TRUE";default:throw new R("#VALUE!")}}visitUnaryExpression(e){let r=this.evaluate(e.right),c=this.parseNumber(this.getOneValue(r));switch(e.operator.type){case 3:return-c;case 2:return c;default:throw new R("#VALUE!")}}visitCellRangeExpression(e){switch(e.operator.type){case 10:{let r=this.visitCellExpression(e.left),c=this.visitCellExpression(e.right),b=ht(r,c);if(!b)throw new R("#NAME?");return b}default:throw new R("#NAME?")}}visitGroupExpression(e){return this.evaluate(e.value)}visitArrayExpression(e){let r=[];for(let c of e.value)r.push(this.evaluate(c));return r}visitPostUnaryExpression(e){let r=this.evaluate(e.left),c=this.parseNumber(this.getOneValue(r));switch(e.operator.type){case 13:return c*.01;default:throw new R("#VALUE!")}}evaluate(e){return e.accept(this)}getRangeCellValue(e){if(e instanceof ae){if(e.colCount===e.rowCount&&e.colCount===1)return this.getCellValue(e,!0);throw new R("#REF!")}return e}getOneValue(e){let r=this.getRangeCellValue(e);return Array.isArray(r)?r[0]:r}parseNumber(e){let[r,c]=ne(e);if(!r)throw new R("#VALUE!");return c}getCellValue(e,r){let c=[];if(r){let G=this.cellDataMap.getCell(e),_=this.cellDataMap.handleCell(G,{row:e.row,col:e.col});return c=c.concat(_),c}let{row:b,col:C,sheetId:L}=e,P=this.cellDataMap.getSheetInfo(L);if(!P||b>=P.rowCount||C>=P.colCount)throw new R("#REF!");return it(e,P,(G,_)=>{let I=this.cellDataMap.getCell({row:G,col:_,rowCount:1,colCount:1,sheetId:L}),$=this.cellDataMap.handleCell(I,{row:G,col:_});return c=c.concat($),!1}),c}};function yt(u,e={row:0,col:0},r=new $e,c=new Map){if(c.has(u)){let b=c.get(u);return b.result.length===0?{result:[0]}:b}try{r.handleCell=(_,I)=>_?_.formula?yt(_.formula,I,r,c).result:[_.value]:[];let b={result:[],expressionStr:""};c.set(u,b);let C=new Ee(u).scan(),L=new we(C).parse(),P=new Ae(L,e,r).interpret(),G=[];for(let _ of L)G.push(_.toString());b.expressionStr=G.join("");for(let _ of P)typeof _=="number"&&!isNaN(_)?b.result.push(bt(_)):b.result.push(_);return b}catch(b){if(b instanceof R){let C={result:[b.value]};return c.set(u,C),C}throw b}}var Ie="_test_",$e=class{constructor(){this.map=new Map;this.definedNameMap=new Map;this.currentSheetId=Ie;this.sheetList=[{sheetId:Ie,name:"_test_",rowCount:200,colCount:30,isHide:!1,sort:1}];this.getFunction=e=>Se[e];this.handleCell=(e,r)=>e?[e.value]:[]}getKey(e,r,c){return`${e}_${r}_${c||Ie}`}setSheetList(e){this.sheetList=e}set(e,r){let{row:c,col:b,sheetId:C}=e;for(let L=0;L<r.length;L++)for(let P=0;P<r[L].length;P++){let G=this.getKey(c+L,b+P,C),_=r[L][P];typeof _=="string"&&at(_)?this.map.set(G,{formula:_,value:""}):this.map.set(G,{value:_})}}getCell(e){let{row:r,col:c,sheetId:b}=e,C=this.getKey(r,c,b);return this.map.get(C)}getSheetInfo(e,r){if(r)return this.sheetList.find(b=>b.name===r);let c=e||this.currentSheetId;return this.sheetList.find(b=>b.sheetId===c)}setDefinedName(e,r){let c=ae.makeRange(r);this.definedNameMap.set(e,c)}getDefinedName(e){return this.definedNameMap.get(e)}};function ir(u,e){let{currentSheetId:r,worksheets:c,workbook:b,definedNames:C}=u,L=new Map,P=c[r]||{},G={list:[]},_={handleCell:()=>[],getFunction:I=>Se[I],getCell:I=>{let{row:$,col:W,sheetId:Q}=I,B=c[Q||r]||{},T=nt($,W);return B[T]},set:()=>{throw new R("#REF!")},getSheetInfo:(I,$)=>{if($)return b.find(Q=>Q.name===$);let W=I||r;return b.find(Q=>Q.sheetId===W)},setDefinedName:()=>{throw new R("#REF!")},getDefinedName:I=>{let $=C[I];return $&&ae.makeRange($)}};for(let[I,$]of Object.entries(P)){if(!$?.formula)continue;let W=yt($?.formula,st(I),_,L);if(!W)continue;let Q=W.result[0];Q!==$.value&&G.list.push({key:I,newValue:Q,sheetId:r})}e(G)}export{pt as a,cr as b,lr as c,ir as d};
//# sourceMappingURL=chunk-4ZOIIS26.js.map
