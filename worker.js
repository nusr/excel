/* 
MIT License

Copyright (c) 2020 Steve Xu

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/
var yr=Object.create;var $t=Object.defineProperty;var vr=Object.getOwnPropertyDescriptor;var Ir=Object.getOwnPropertyNames;var Mr=Object.getPrototypeOf,Sr=Object.prototype.hasOwnProperty;var Ar=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var kr=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Ir(e))!Sr.call(r,a)&&a!==t&&$t(r,a,{get:()=>e[a],enumerable:!(n=vr(e,a))||n.enumerable});return r};var Dr=(r,e,t)=>(t=r!=null?yr(Mr(r)):{},kr(e||!r||!r.__esModule?$t(t,"default",{value:r,enumerable:!0}):t,r));var dr=Ar((Si,wt)=>{"use strict";var pr={};function En(r){r.version="0.11.3";function e(s){for(var o="",i=s.length-1;i>=0;)o+=s.charAt(i--);return o}function t(s,o){for(var i="";i.length<o;)i+=s;return i}function n(s,o){var i=""+s;return i.length>=o?i:t("0",o-i.length)+i}function a(s,o){var i=""+s;return i.length>=o?i:t(" ",o-i.length)+i}function u(s,o){var i=""+s;return i.length>=o?i:i+t(" ",o-i.length)}function d(s,o){var i=""+Math.round(s);return i.length>=o?i:t("0",o-i.length)+i}function g(s,o){var i=""+s;return i.length>=o?i:t("0",o-i.length)+i}var b=Math.pow(2,32);function f(s,o){if(s>b||s<-b)return d(s,o);var i=Math.round(s);return g(i,o)}function w(s,o){return o=o||0,s.length>=7+o&&(s.charCodeAt(o)|32)===103&&(s.charCodeAt(o+1)|32)===101&&(s.charCodeAt(o+2)|32)===110&&(s.charCodeAt(o+3)|32)===101&&(s.charCodeAt(o+4)|32)===114&&(s.charCodeAt(o+5)|32)===97&&(s.charCodeAt(o+6)|32)===108}var I=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],S=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function k(s){s[0]="General",s[1]="0",s[2]="0.00",s[3]="#,##0",s[4]="#,##0.00",s[9]="0%",s[10]="0.00%",s[11]="0.00E+00",s[12]="# ?/?",s[13]="# ??/??",s[14]="m/d/yy",s[15]="d-mmm-yy",s[16]="d-mmm",s[17]="mmm-yy",s[18]="h:mm AM/PM",s[19]="h:mm:ss AM/PM",s[20]="h:mm",s[21]="h:mm:ss",s[22]="m/d/yy h:mm",s[37]="#,##0 ;(#,##0)",s[38]="#,##0 ;[Red](#,##0)",s[39]="#,##0.00;(#,##0.00)",s[40]="#,##0.00;[Red](#,##0.00)",s[45]="mm:ss",s[46]="[h]:mm:ss",s[47]="mmss.0",s[48]="##0.0E+0",s[49]="@",s[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'}var A={};k(A);var D=[],T=0;for(T=5;T<=8;++T)D[T]=32+T;for(T=23;T<=26;++T)D[T]=0;for(T=27;T<=31;++T)D[T]=14;for(T=50;T<=58;++T)D[T]=14;for(T=59;T<=62;++T)D[T]=T-58;for(T=67;T<=68;++T)D[T]=T-58;for(T=72;T<=75;++T)D[T]=T-58;for(T=67;T<=68;++T)D[T]=T-57;for(T=76;T<=78;++T)D[T]=T-56;for(T=79;T<=81;++T)D[T]=T-34;var z={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function q(s,o,i){for(var y=s<0?-1:1,l=s*y,M=0,h=1,R=0,_=1,x=0,L=0,P=Math.floor(l);x<o&&(P=Math.floor(l),R=P*h+M,L=P*x+_,!(l-P<5e-8));)l=1/(l-P),M=h,h=R,_=x,x=L;if(L>o&&(x>o?(L=_,R=M):(L=x,R=h)),!i)return[0,y*R,L];var ie=Math.floor(y*R/L);return[ie,y*R-ie*L,L]}function te(s){var o=s.toPrecision(16);if(o.indexOf("e")>-1){var i=o.slice(0,o.indexOf("e"));return i=i.indexOf(".")>-1?i.slice(0,i.slice(0,2)=="0."?17:16):i.slice(0,15)+t("0",i.length-15),i+o.slice(o.indexOf("e"))}var y=o.indexOf(".")>-1?o.slice(0,o.slice(0,2)=="0."?17:16):o.slice(0,15)+t("0",o.length-15);return Number(y)}function G(s,o,i){if(s>2958465||s<0)return null;s=te(s);var y=s|0,l=Math.floor(86400*(s-y)),M=0,h=[],R={D:y,T:l,u:86400*(s-y)-l,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(R.u)<1e-6&&(R.u=0),o&&o.date1904&&(y+=1462),R.u>.9999&&(R.u=0,++l==86400&&(R.T=l=0,++y,++R.D)),y===60)h=i?[1317,10,29]:[1900,2,29],M=3;else if(y===0)h=i?[1317,8,29]:[1900,1,0],M=6;else{y>60&&--y;var _=new Date(1900,0,1);_.setDate(_.getDate()+y-1),h=[_.getFullYear(),_.getMonth()+1,_.getDate()],M=_.getDay(),y<60&&(M=(M+6)%7),i&&(M=Rr(_,h))}return R.y=h[0],R.m=h[1],R.d=h[2],R.S=l%60,l=Math.floor(l/60),R.M=l%60,l=Math.floor(l/60),R.H=l,R.q=M,R}r.parse_date_code=G;var Y=new Date(1899,11,31,0,0,0),J=Y.getTime(),j=new Date(1900,2,1,0,0,0);function oe(s,o){var i=s.getTime();return o?i-=1461*24*60*60*1e3:s>=j&&(i+=24*60*60*1e3),(i-(J+(s.getTimezoneOffset()-Y.getTimezoneOffset())*6e4))/(24*60*60*1e3)}var Ie=function(){var o=/(?:\.0*|(\.\d*[1-9])0+)$/;function i(x){return x.indexOf(".")==-1?x:x.replace(o,"$1")}var y=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,l=/(E[+-])(\d)$/;function M(x){return x.indexOf("E")==-1?x:x.replace(y,"$1E").replace(l,"$10$2")}function h(x){var L=x<0?12:11,P=i(x.toFixed(12));return P.length<=L||(P=x.toPrecision(10),P.length<=L)?P:x.toExponential(5)}function R(x){var L=i(x.toFixed(11));return L.length>(x<0?12:11)||L==="0"||L==="-0"?x.toPrecision(6):L}function _(x){var L=Math.floor(Math.log(Math.abs(x))*Math.LOG10E),P;return L>=-4&&L<=-1?P=x.toPrecision(10+L):Math.abs(L)<=9?P=h(x):L===10?P=x.toFixed(10).substr(0,12):P=R(x),i(M(P.toUpperCase()))}return _}();r._general_num=Ie;function _e(s,o){switch(typeof s){case"string":return s;case"boolean":return s?"TRUE":"FALSE";case"number":return(s|0)===s?s.toString(10):Ie(s);case"undefined":return"";case"object":if(s==null)return"";if(s instanceof Date)return Ft(14,oe(s,o&&o.date1904),o)}throw new Error("unsupported value in General format: "+s)}r._general=_e;function Rr(s,o){o[0]-=581;var i=s.getDay();return s<60&&(i=(i+6)%7),i}var In="\u0E50\u0E51\u0E52\u0E53\u0E54\u0E55\u0E56\u0E57\u0E58\u0E59".split("");function Tr(s,o,i,y){var l="",M=0,h=0,R=i.y,_,x=0;switch(s){case 98:R=i.y+543;case 121:switch(o.length){case 1:case 2:_=R%100,x=2;break;default:_=R%1e4,x=4;break}break;case 109:switch(o.length){case 1:case 2:_=i.m,x=o.length;break;case 3:return S[i.m-1][1];case 5:return S[i.m-1][0];default:return S[i.m-1][2]}break;case 100:switch(o.length){case 1:case 2:_=i.d,x=o.length;break;case 3:return I[i.q][0];default:return I[i.q][1]}break;case 104:switch(o.length){case 1:case 2:_=1+(i.H+11)%12,x=o.length;break;default:throw"bad hour format: "+o}break;case 72:switch(o.length){case 1:case 2:_=i.H,x=o.length;break;default:throw"bad hour format: "+o}break;case 77:switch(o.length){case 1:case 2:_=i.M,x=o.length;break;default:throw"bad minute format: "+o}break;case 115:if(o!="s"&&o!="ss"&&o!=".0"&&o!=".00"&&o!=".000")throw"bad second format: "+o;return i.u===0&&(o=="s"||o=="ss")?n(i.S,o.length):(y>=2?h=y===3?1e3:100:h=y===1?10:1,M=Math.round(h*(i.S+i.u)),M>=60*h&&(M=0),o==="s"?M===0?"0":""+M/h:(l=n(M,2+y),o==="ss"?l.substr(0,2):"."+l.substr(2,o.length-1)));case 90:switch(o){case"[h]":case"[hh]":_=i.D*24+i.H;break;case"[m]":case"[mm]":_=(i.D*24+i.H)*60+i.M;break;case"[s]":case"[ss]":_=((i.D*24+i.H)*60+i.M)*60+(y==0?Math.round(i.S+i.u):i.S);break;default:throw"bad abstime format: "+o}x=o.length===3?1:2;break;case 101:_=R,x=1;break}var L=x>0?n(_,x):"";return L}function de(s){var o=3;if(s.length<=o)return s;for(var i=s.length%o,y=s.substr(0,i);i!=s.length;i+=o)y+=(y.length>0?",":"")+s.substr(i,o);return y}var ce=function(){var o=/%/g;function i(m,c,p){var v=c.replace(o,""),E=c.length-v.length;return ce(m,v,p*Math.pow(10,2*E))+t("%",E)}function y(m,c,p){for(var v=c.length-1;c.charCodeAt(v-1)===44;)--v;return ce(m,c.substr(0,v),p/Math.pow(10,3*(c.length-v)))}function l(m,c){var p,v=m.indexOf("E")-m.indexOf(".")-1;if(m.match(/^#+0.0E\+0$/)){if(c==0)return"0.0E+0";if(c<0)return"-"+l(m,-c);var E=m.indexOf(".");E===-1&&(E=m.indexOf("E"));var C=Math.floor(Math.log(c)*Math.LOG10E)%E;if(C<0&&(C+=E),p=(c/Math.pow(10,C)).toPrecision(v+1+(E+C)%E),p.indexOf("e")===-1){var N=Math.floor(Math.log(c)*Math.LOG10E);for(p.indexOf(".")===-1?p=p.charAt(0)+"."+p.substr(1)+"E+"+(N-p.length+C):p+="E+"+(N-C);p.substr(0,2)==="0.";)p=p.charAt(0)+p.substr(2,E)+"."+p.substr(2+E),p=p.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");p=p.replace(/\+-/,"-")}p=p.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(W,V,X,U){return V+X+U.substr(0,(E+C)%E)+"."+U.substr(C)+"E"})}else p=c.toExponential(v);return m.match(/E\+00$/)&&p.match(/e[+-]\d$/)&&(p=p.substr(0,p.length-1)+"0"+p.charAt(p.length-1)),m.match(/E\-/)&&p.match(/e\+/)&&(p=p.replace(/e\+/,"e")),p.replace("e","E")}var M=/# (\?+)( ?)\/( ?)(\d+)/;function h(m,c,p){var v=parseInt(m[4],10),E=Math.round(c*v),C=Math.floor(E/v),N=E-C*v,W=v;return p+(C===0?"":""+C)+" "+(N===0?t(" ",m[1].length+1+m[4].length):a(N,m[1].length)+m[2]+"/"+m[3]+n(W,m[4].length))}function R(m,c,p){return p+(c===0?"":""+c)+t(" ",m[1].length+2+m[4].length)}var _=/^#*0*\.([0#]+)/,x=/\).*[0#]/,L=/\(###\) ###\\?-####/;function P(m){for(var c="",p,v=0;v!=m.length;++v)switch(p=m.charCodeAt(v)){case 35:break;case 63:c+=" ";break;case 48:c+="0";break;default:c+=String.fromCharCode(p)}return c}function ie(m,c){var p=Math.pow(10,c);return""+Math.round(m*p)/p}function ge(m,c){var p=m-Math.floor(m),v=Math.pow(10,c);return c<(""+Math.round(p*v)).length?0:Math.round(p*v)}function nt(m,c){return c<(""+Math.round((m-Math.floor(m))*Math.pow(10,c))).length?1:0}function se(m){return m<2147483647&&m>-2147483648?""+(m>=0?m|0:m-1|0):""+Math.floor(m)}function B(m,c,p){if(m.charCodeAt(0)===40&&!c.match(x)){var v=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return p>=0?B("n",v,p):"("+B("n",v,-p)+")"}if(c.charCodeAt(c.length-1)===44)return y(m,c,p);if(c.indexOf("%")!==-1)return i(m,c,p);if(c.indexOf("E")!==-1)return l(c,p);if(c.charCodeAt(0)===36)return"$"+B(m,c.substr(c.charAt(1)==" "?2:1),p);var E,C,N,W,V=Math.abs(p),X=p<0?"-":"";if(c.match(/^00+$/))return X+f(V,c.length);if(c.match(/^[#?]+$/))return E=f(p,0),E==="0"&&(E=""),E.length>c.length?E:P(c.substr(0,c.length-E.length))+E;if(C=c.match(M))return h(C,V,X);if(c.match(/^#+0+$/))return X+f(V,c.length-c.indexOf("0"));if(C=c.match(_))return E=ie(p,C[1].length).replace(/^([^\.]+)$/,"$1."+P(C[1])).replace(/\.$/,"."+P(C[1])).replace(/\.(\d*)$/,function(re,Ae){return"."+Ae+t("0",P(C[1]).length-Ae.length)}),c.indexOf("0.")!==-1?E:E.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),C=c.match(/^(0*)\.(#*)$/))return X+ie(V,C[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,C[1].length?"0.":".");if(C=c.match(/^#{1,3},##0(\.?)$/))return X+de(f(V,0));if(C=c.match(/^#,##0\.([#0]*0)$/))return p<0?"-"+B(m,c,-p):de(""+(Math.floor(p)+nt(p,C[1].length)))+"."+n(ge(p,C[1].length),C[1].length);if(C=c.match(/^#,#*,#0/))return B(m,c.replace(/^#,#*,/,""),p);if(C=c.match(/^([0#]+)(\\?-([0#]+))+$/))return E=e(B(m,c.replace(/[\\-]/g,""),p)),N=0,e(e(c.replace(/\\/g,"")).replace(/[0#]/g,function(re){return N<E.length?E.charAt(N++):re==="0"?"0":""}));if(c.match(L))return E=B(m,"##########",p),"("+E.substr(0,3)+") "+E.substr(3,3)+"-"+E.substr(6);var U="";if(C=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return N=Math.min(C[4].length,7),W=q(V,Math.pow(10,N)-1,!1),E=""+X,U=ce("n",C[1],W[1]),U.charAt(U.length-1)==" "&&(U=U.substr(0,U.length-1)+"0"),E+=U+C[2]+"/"+C[3],U=u(W[2],N),U.length<C[4].length&&(U=P(C[4].substr(C[4].length-U.length))+U),E+=U,E;if(C=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return N=Math.min(Math.max(C[1].length,C[4].length),7),W=q(V,Math.pow(10,N)-1,!0),X+(W[0]||(W[1]?"":"0"))+" "+(W[1]?a(W[1],N)+C[2]+"/"+C[3]+u(W[2],N):t(" ",2*N+1+C[2].length+C[3].length));if(C=c.match(/^[#0?]+$/))return E=f(p,0),c.length<=E.length?E:P(c.substr(0,c.length-E.length))+E;if(C=c.match(/^([#0?]+)\.([#0]+)$/)){E=""+p.toFixed(Math.min(C[2].length,10)).replace(/([^0])0+$/,"$1"),N=E.indexOf(".");var Me=c.indexOf(".")-N,ot=c.length-E.length-Me;return P(c.substr(0,Me)+E+c.substr(c.length-ot))}if(C=c.match(/^00,000\.([#0]*0)$/))return N=ge(p,C[1].length),p<0?"-"+B(m,c,-p):de(se(p)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(re){return"00,"+(re.length<3?n(0,3-re.length):"")+re})+"."+n(N,C[1].length);switch(c){case"###,##0.00":return B(m,"#,##0.00",p);case"###,###":case"##,###":case"#,###":var Se=de(f(V,0));return Se!=="0"?X+Se:"";case"###,###.00":return B(m,"###,##0.00",p).replace(/^0\./,".");case"#,###.00":return B(m,"#,##0.00",p).replace(/^0\./,".");default:}throw new Error("unsupported format |"+c+"|")}function be(m,c,p){for(var v=c.length-1;c.charCodeAt(v-1)===44;)--v;return ce(m,c.substr(0,v),p/Math.pow(10,3*(c.length-v)))}function Ne(m,c,p){var v=c.replace(o,""),E=c.length-v.length;return ce(m,v,p*Math.pow(10,2*E))+t("%",E)}function ee(m,c){var p,v=m.indexOf("E")-m.indexOf(".")-1;if(m.match(/^#+0.0E\+0$/)){if(c==0)return"0.0E+0";if(c<0)return"-"+ee(m,-c);var E=m.indexOf(".");E===-1&&(E=m.indexOf("E"));var C=Math.floor(Math.log(c)*Math.LOG10E)%E;if(C<0&&(C+=E),p=(c/Math.pow(10,C)).toPrecision(v+1+(E+C)%E),!p.match(/[Ee]/)){var N=Math.floor(Math.log(c)*Math.LOG10E);p.indexOf(".")===-1?p=p.charAt(0)+"."+p.substr(1)+"E+"+(N-p.length+C):p+="E+"+(N-C),p=p.replace(/\+-/,"-")}p=p.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(W,V,X,U){return V+X+U.substr(0,(E+C)%E)+"."+U.substr(C)+"E"})}else p=c.toExponential(v);return m.match(/E\+00$/)&&p.match(/e[+-]\d$/)&&(p=p.substr(0,p.length-1)+"0"+p.charAt(p.length-1)),m.match(/E\-/)&&p.match(/e\+/)&&(p=p.replace(/e\+/,"e")),p.replace("e","E")}function Q(m,c,p){if(m.charCodeAt(0)===40&&!c.match(x)){var v=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return p>=0?Q("n",v,p):"("+Q("n",v,-p)+")"}if(c.charCodeAt(c.length-1)===44)return be(m,c,p);if(c.indexOf("%")!==-1)return Ne(m,c,p);if(c.indexOf("E")!==-1)return ee(c,p);if(c.charCodeAt(0)===36)return"$"+Q(m,c.substr(c.charAt(1)==" "?2:1),p);var E,C,N,W,V=Math.abs(p),X=p<0?"-":"";if(c.match(/^00+$/))return X+n(V,c.length);if(c.match(/^[#?]+$/))return E=""+p,p===0&&(E=""),E.length>c.length?E:P(c.substr(0,c.length-E.length))+E;if(C=c.match(M))return R(C,V,X);if(c.match(/^#+0+$/))return X+n(V,c.length-c.indexOf("0"));if(C=c.match(_))return E=(""+p).replace(/^([^\.]+)$/,"$1."+P(C[1])).replace(/\.$/,"."+P(C[1])),E=E.replace(/\.(\d*)$/,function(re,Ae){return"."+Ae+t("0",P(C[1]).length-Ae.length)}),c.indexOf("0.")!==-1?E:E.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),C=c.match(/^(0*)\.(#*)$/))return X+(""+V).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,C[1].length?"0.":".");if(C=c.match(/^#{1,3},##0(\.?)$/))return X+de(""+V);if(C=c.match(/^#,##0\.([#0]*0)$/))return p<0?"-"+Q(m,c,-p):de(""+p)+"."+t("0",C[1].length);if(C=c.match(/^#,#*,#0/))return Q(m,c.replace(/^#,#*,/,""),p);if(C=c.match(/^([0#]+)(\\?-([0#]+))+$/))return E=e(Q(m,c.replace(/[\\-]/g,""),p)),N=0,e(e(c.replace(/\\/g,"")).replace(/[0#]/g,function(re){return N<E.length?E.charAt(N++):re==="0"?"0":""}));if(c.match(L))return E=Q(m,"##########",p),"("+E.substr(0,3)+") "+E.substr(3,3)+"-"+E.substr(6);var U="";if(C=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return N=Math.min(C[4].length,7),W=q(V,Math.pow(10,N)-1,!1),E=""+X,U=ce("n",C[1],W[1]),U.charAt(U.length-1)==" "&&(U=U.substr(0,U.length-1)+"0"),E+=U+C[2]+"/"+C[3],U=u(W[2],N),U.length<C[4].length&&(U=P(C[4].substr(C[4].length-U.length))+U),E+=U,E;if(C=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return N=Math.min(Math.max(C[1].length,C[4].length),7),W=q(V,Math.pow(10,N)-1,!0),X+(W[0]||(W[1]?"":"0"))+" "+(W[1]?a(W[1],N)+C[2]+"/"+C[3]+u(W[2],N):t(" ",2*N+1+C[2].length+C[3].length));if(C=c.match(/^[#0?]+$/))return E=""+p,c.length<=E.length?E:P(c.substr(0,c.length-E.length))+E;if(C=c.match(/^([#0]+)\.([#0]+)$/)){E=""+p.toFixed(Math.min(C[2].length,10)).replace(/([^0])0+$/,"$1"),N=E.indexOf(".");var Me=c.indexOf(".")-N,ot=c.length-E.length-Me;return P(c.substr(0,Me)+E+c.substr(c.length-ot))}if(C=c.match(/^00,000\.([#0]*0)$/))return p<0?"-"+Q(m,c,-p):de(""+p).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(re){return"00,"+(re.length<3?n(0,3-re.length):"")+re})+"."+n(0,C[1].length);switch(c){case"###,###":case"##,###":case"#,###":var Se=de(""+V);return Se!=="0"?X+Se:"";default:if(c.match(/\.[0#?]*$/))return Q(m,c.slice(0,c.lastIndexOf(".")),p)+P(c.slice(c.lastIndexOf(".")))}throw new Error("unsupported format |"+c+"|")}return function(c,p,v){return(v|0)===v?Q(c,p,v):B(c,p,v)}}();function St(s){for(var o=[],i=!1,y=0,l=0;y<s.length;++y)switch(s.charCodeAt(y)){case 34:i=!i;break;case 95:case 42:case 92:++y;break;case 59:o[o.length]=s.substr(l,y-l),l=y+1}if(o[o.length]=s.substr(l),i===!0)throw new Error("Format |"+s+"| unterminated string ");return o}r._split=St;var At=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function kt(s){for(var o=0,i="",y="";o<s.length;)switch(i=s.charAt(o)){case"G":w(s,o)&&(o+=6),o++;break;case'"':for(;s.charCodeAt(++o)!==34&&o<s.length;);++o;break;case"\\":o+=2;break;case"_":o+=2;break;case"@":++o;break;case"B":case"b":if(s.charAt(o+1)==="1"||s.charAt(o+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(s.substr(o,3).toUpperCase()==="A/P"||s.substr(o,5).toUpperCase()==="AM/PM"||s.substr(o,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++o;break;case"[":for(y=i;s.charAt(o++)!=="]"&&o<s.length;)y+=s.charAt(o);if(y.match(At))return!0;break;case".":case"0":case"#":for(;o<s.length&&("0#?.,E+-%".indexOf(i=s.charAt(++o))>-1||i=="\\"&&s.charAt(o+1)=="-"&&"0#".indexOf(s.charAt(o+2))>-1););break;case"?":for(;s.charAt(++o)===i;);break;case"*":++o,(s.charAt(o)==" "||s.charAt(o)=="*")&&++o;break;case"(":case")":++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;o<s.length&&"0123456789".indexOf(s.charAt(++o))>-1;);break;case" ":++o;break;default:++o;break}return!1}r.is_date=kt;function Dt(s,o,i,y){for(var l=[],M="",h=0,R="",_="t",x,L,P,ie="H";h<s.length;)switch(R=s.charAt(h)){case"G":if(!w(s,h))throw new Error("unrecognized character "+R+" in "+s);l[l.length]={t:"G",v:"General"},h+=7;break;case'"':for(M="";(P=s.charCodeAt(++h))!==34&&h<s.length;)M+=String.fromCharCode(P);l[l.length]={t:"t",v:M},++h;break;case"\\":var ge=s.charAt(++h),nt=ge==="("||ge===")"?ge:"t";l[l.length]={t:nt,v:ge},++h;break;case"_":l[l.length]={t:"t",v:" "},h+=2;break;case"@":l[l.length]={t:"T",v:o},++h;break;case"B":case"b":if(s.charAt(h+1)==="1"||s.charAt(h+1)==="2"){if(x==null&&(x=G(o,i,s.charAt(h+1)==="2"),x==null))return"";l[l.length]={t:"X",v:s.substr(h,2)},_=R,h+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":R=R.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(o<0||x==null&&(x=G(o,i),x==null))return"";for(M=R;++h<s.length&&s.charAt(h).toLowerCase()===R;)M+=R;R==="m"&&_.toLowerCase()==="h"&&(R="M"),R==="h"&&(R=ie),l[l.length]={t:R,v:M},_=R;break;case"A":case"a":case"\u4E0A":var se={t:R,v:R};if(x==null&&(x=G(o,i)),s.substr(h,3).toUpperCase()==="A/P"?(x!=null&&(se.v=x.H>=12?s.charAt(h+2):R),se.t="T",ie="h",h+=3):s.substr(h,5).toUpperCase()==="AM/PM"?(x!=null&&(se.v=x.H>=12?"PM":"AM"),se.t="T",h+=5,ie="h"):s.substr(h,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(x!=null&&(se.v=x.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),se.t="T",h+=5,ie="h"):(se.t="t",++h),x==null&&se.t==="T")return"";l[l.length]=se,_=R;break;case"[":for(M=R;s.charAt(h++)!=="]"&&h<s.length;)M+=s.charAt(h);if(M.slice(-1)!=="]")throw'unterminated "[" block: |'+M+"|";if(M.match(At)){if(x==null&&(x=G(o,i),x==null))return"";l[l.length]={t:"Z",v:M.toLowerCase()},_=M.charAt(1)}else M.indexOf("$")>-1&&(M=(M.match(/\$([^-\[\]]*)/)||[])[1]||"$",kt(s)||(l[l.length]={t:"t",v:M}));break;case".":if(x!=null){for(M=R;++h<s.length&&(R=s.charAt(h))==="0";)M+=R;l[l.length]={t:"s",v:M};break}case"0":case"#":for(M=R;++h<s.length&&"0#?.,E+-%".indexOf(R=s.charAt(h))>-1;)M+=R;l[l.length]={t:"n",v:M};break;case"?":for(M=R;s.charAt(++h)===R;)M+=R;l[l.length]={t:R,v:M},_=R;break;case"*":++h,(s.charAt(h)==" "||s.charAt(h)=="*")&&++h;break;case"(":case")":l[l.length]={t:y===1?"t":R,v:R},++h;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(M=R;h<s.length&&"0123456789".indexOf(s.charAt(++h))>-1;)M+=s.charAt(h);l[l.length]={t:"D",v:M};break;case" ":l[l.length]={t:R,v:R},++h;break;case"$":l[l.length]={t:"t",v:"$"},++h;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(R)===-1)throw new Error("unrecognized character "+R+" in "+s);l[l.length]={t:"t",v:R},++h;break}var B=0,be=0,Ne;for(h=l.length-1,_="t";h>=0;--h)switch(l[h].t){case"h":case"H":l[h].t=ie,_="h",B<1&&(B=1);break;case"s":(Ne=l[h].v.match(/\.0+$/))&&(be=Math.max(be,Ne[0].length-1),B=4),B<3&&(B=3);case"d":case"y":case"e":_=l[h].t;break;case"M":_=l[h].t,B<2&&(B=2);break;case"m":_==="s"&&(l[h].t="M",B<2&&(B=2));break;case"X":break;case"Z":B<1&&l[h].v.match(/[Hh]/)&&(B=1),B<2&&l[h].v.match(/[Mm]/)&&(B=2),B<3&&l[h].v.match(/[Ss]/)&&(B=3)}var ee;switch(B){case 0:break;case 1:case 2:case 3:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H),x.H>=24&&(x.H=0,++x.D,ee=G(x.D),ee.u=x.u,ee.S=x.S,ee.M=x.M,ee.H=x.H,x=ee);break;case 4:switch(be){case 1:x.u=Math.round(x.u*10)/10;break;case 2:x.u=Math.round(x.u*100)/100;break;case 3:x.u=Math.round(x.u*1e3)/1e3;break}x.u>=1&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H),x.H>=24&&(x.H=0,++x.D,ee=G(x.D),ee.u=x.u,ee.S=x.S,ee.M=x.M,ee.H=x.H,x=ee);break}var Q="",m;for(h=0;h<l.length;++h)switch(l[h].t){case"t":case"T":case" ":case"D":break;case"X":l[h].v="",l[h].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[h].v=Tr(l[h].t.charCodeAt(0),l[h].v,x,be),l[h].t="t";break;case"n":case"?":for(m=h+1;l[m]!=null&&((R=l[m].t)==="?"||R==="D"||(R===" "||R==="t")&&l[m+1]!=null&&(l[m+1].t==="?"||l[m+1].t==="t"&&l[m+1].v==="/")||l[h].t==="("&&(R===" "||R==="n"||R===")")||R==="t"&&(l[m].v==="/"||l[m].v===" "&&l[m+1]!=null&&l[m+1].t=="?"));)l[h].v+=l[m].v,l[m]={v:"",t:";"},++m;Q+=l[h].v,h=m-1;break;case"G":l[h].t="t",l[h].v=_e(o,i);break}var c="",p,v;if(Q.length>0){Q.charCodeAt(0)==40?(p=o<0&&Q.charCodeAt(0)===45?-o:o,v=ce("n",Q,p)):(p=o<0&&y>1?-o:o,v=ce("n",Q,p),p<0&&l[0]&&l[0].t=="t"&&(v=v.substr(1),l[0].v="-"+l[0].v)),m=v.length-1;var E=l.length;for(h=0;h<l.length;++h)if(l[h]!=null&&l[h].t!="t"&&l[h].v.indexOf(".")>-1){E=h;break}var C=l.length;if(E===l.length&&v.indexOf("E")===-1){for(h=l.length-1;h>=0;--h)l[h]==null||"n?".indexOf(l[h].t)===-1||(m>=l[h].v.length-1?(m-=l[h].v.length,l[h].v=v.substr(m+1,l[h].v.length)):m<0?l[h].v="":(l[h].v=v.substr(0,m+1),m=-1),l[h].t="t",C=h);m>=0&&C<l.length&&(l[C].v=v.substr(0,m+1)+l[C].v)}else if(E!==l.length&&v.indexOf("E")===-1){for(m=v.indexOf(".")-1,h=E;h>=0;--h)if(!(l[h]==null||"n?".indexOf(l[h].t)===-1)){for(L=l[h].v.indexOf(".")>-1&&h===E?l[h].v.indexOf(".")-1:l[h].v.length-1,c=l[h].v.substr(L+1);L>=0;--L)m>=0&&(l[h].v.charAt(L)==="0"||l[h].v.charAt(L)==="#")&&(c=v.charAt(m--)+c);l[h].v=c,l[h].t="t",C=h}for(m>=0&&C<l.length&&(l[C].v=v.substr(0,m+1)+l[C].v),m=v.indexOf(".")+1,h=E;h<l.length;++h)if(!(l[h]==null||"n?(".indexOf(l[h].t)===-1&&h!==E)){for(L=l[h].v.indexOf(".")>-1&&h===E?l[h].v.indexOf(".")+1:0,c=l[h].v.substr(0,L);L<l[h].v.length;++L)m<v.length&&(c+=v.charAt(m++));l[h].v=c,l[h].t="t",C=h}}}for(h=0;h<l.length;++h)l[h]!=null&&"n?".indexOf(l[h].t)>-1&&(p=y>1&&o<0&&h>0&&l[h-1].v==="-"?-o:o,l[h].v=ce(l[h].t,l[h].v,p),l[h].t="t");var N="";for(h=0;h!==l.length;++h)l[h]!=null&&(N+=l[h].v);return N}r._eval=Dt;var Ot=/\[[=<>]/,_t=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Nt(s,o){if(o==null)return!1;var i=parseFloat(o[2]);switch(o[1]){case"=":if(s==i)return!0;break;case">":if(s>i)return!0;break;case"<":if(s<i)return!0;break;case"<>":if(s!=i)return!0;break;case">=":if(s>=i)return!0;break;case"<=":if(s<=i)return!0;break}return!1}function Lt(s,o){var i=St(s),y=i.length,l=i[y-1].indexOf("@");if(y<4&&l>-1&&--y,i.length>4)throw new Error("cannot find right format for |"+i.join("|")+"|");if(typeof o!="number")return[4,i.length===4||l>-1?i[i.length-1]:"@"];switch(i.length){case 1:i=l>-1?["General","General","General",i[0]]:[i[0],i[0],i[0],"@"];break;case 2:i=l>-1?[i[0],i[0],i[0],i[1]]:[i[0],i[1],i[0],"@"];break;case 3:i=l>-1?[i[0],i[1],i[0],i[2]]:[i[0],i[1],i[2],"@"];break;case 4:break}var M=o>0?i[0]:o<0?i[1]:i[2];if(i[0].indexOf("[")===-1&&i[1].indexOf("[")===-1)return[y,M];if(i[0].match(Ot)!=null||i[1].match(Ot)!=null){var h=i[0].match(_t),R=i[1].match(_t);return Nt(o,h)?[y,i[0]]:Nt(o,R)?[y,i[1]]:[y,i[h!=null&&R!=null?2:1]]}return[y,M]}function Ft(s,o,i){i==null&&(i={});var y="";switch(typeof s){case"string":s=="m/d/yy"&&i.dateNF?y=i.dateNF:y=s;break;case"number":s==14&&i.dateNF?y=i.dateNF:y=(i.table!=null?i.table:A)[s],y==null&&(y=i.table&&i.table[D[s]]||A[D[s]]),y==null&&(y=z[s]||"General");break}if(w(y,0))return _e(o,i);o instanceof Date&&(o=oe(o,i.date1904));var l=Lt(y,o);if(w(l[1]))return _e(o,i);if(o===!0)o="TRUE";else if(o===!1)o="FALSE";else if(o===""||o==null)return"";return Dt(l[1],o,i,l[0])}function Pt(s,o){if(typeof o!="number"){o=+o||-1;for(var i=0;i<392;++i){if(A[i]==null){o<0&&(o=i);continue}if(A[i]==s){o=i;break}}o<0&&(o=391)}return A[o]=s,o}r.load=Pt,r._table=A,r.get_table=function(){return A},r.load_table=function(o){for(var i=0;i!=392;++i)o[i]!==void 0&&Pt(o[i],i)},r.init_table=k,r.format=Ft,r.choose_format=Lt}En(pr);typeof wt<"u"&&typeof DO_NOT_EXPORT_SSF>"u"&&(wt.exports=pr)});var me=12,Ut="sans-serif";var it=22,Le=76;var Sn=Le/2,st=0;var Fe="&#10;";var at=16384,lt=1048576;var Bt="=",ct="_";var ke=256;var ht=9;var De="General";var Pe=new Set(["#ERROR!","#DIV/0!","#NULL!","#NUM!","#REF!","#VALUE!","#N/A","#NAME?"]),O=1,$e={thin:O,hair:O,dotted:O,dashed:O,dashDot:O,dashDotDot:O,double:O,medium:O*2,mediumDashed:O*2,mediumDashDot:O*2,mediumDashDotDot:O*2,thick:O*4};function xe(r){if(typeof r=="boolean")return[!0,Number(r)];if(typeof r=="number"&&!isNaN(r))return[!0,r];if(typeof r!="string")return[!1,0];if(r.length>12)return[!1,0];let e=Number(r);return isNaN(e)?[!1,0]:[!0,e]}function Ht(r,e){return`${r}${ct}${e}`}function Wt(r){let[e,t]=r.split(ct),n=parseInt(e,10),a=parseInt(t,10);return{row:isNaN(n)?-1:n,col:isNaN(a)?-1:a}}function zt(){return!1}var F=class extends Error{constructor(e){super(e),this.value=e}};function H(r,e="#VALUE!"){if(!r)throw new F(e)}function Ue(r){H(r.length===1);let[e]=r;return e}function Ee(r){let e=Ue(r);return H(typeof e=="string"),e}function Z(r){let e=Ue(r),[t,n]=xe(e);return H(t),n}function ut(r){H(r.length===0)}function Be(r){let e=r.toUpperCase();return/^[A-Z]+\d+$/.test(e)||/^[A-Z]+$/.test(e)}var Or=(...r)=>{let e=Ue(r);return typeof e=="string"?e:""},_r=(...r)=>Ee(r).toLowerCase(),Gt=(...r)=>{let e=Z(r);return String.fromCharCode(e)},Vt=(...r)=>Ee(r).charCodeAt(0),Nr=(...r)=>Ee(r).length,Lr=(...r)=>{H(r.length===2);let[e,t]=r;return H(typeof e=="string"),H(typeof t=="string"),e.split(t)},Fr=(...r)=>Ee(r).toUpperCase(),Pr=(...r)=>Ee(r).replace(/ +/g," ").trim(),Xt=(...r)=>(H(r.length<=ke),r.join("")),$r={CONCAT:Xt,CONCATENATE:Xt,SPLIT:Lr,CHAR:Gt,CODE:Vt,UNICHAR:Gt,UNICODE:Vt,LEN:Nr,LOWER:_r,UPPER:Fr,TRIM:Pr,T:Or},jt=$r;function Jt(r){let e=[];for(let t=0;t<r.length;t++){let[n,a]=xe(r[t]);n&&e.push(a)}return e}var Ur=(...r)=>{let e=Z(r);return Math.abs(e)},Br=(...r)=>{let e=Z(r);return Math.acos(e)},Hr=(...r)=>{let e=Z(r);return Math.log(e+Math.sqrt(e*e-1))},Wr=(...r)=>{let e=Z(r);return Math.atan(1/e)},zr=(...r)=>{let e=Z(r);return .5*Math.log((e+1)/(e-1))},Gr=(...r)=>{let e=Z(r);return Math.asin(e)},Vr=(...r)=>{let e=Z(r);return Math.log(e+Math.sqrt(e*e+1))},Xr=(...r)=>{let e=Z(r);return Math.atan(e)},jr=(...r)=>{H(r.length===2);let[e,t]=r;return H(typeof e=="number"),H(typeof t=="number"),Math.atan2(e,t)},Jr=(...r)=>{let e=Z(r);return Math.log((1+e)/(e+1))/2},Kr=(...r)=>{let e=Jt(r);return H(e.length<=ke&&e.length>=1),e.reduce((t,n)=>t+n,0)/e.length},Qr=(...r)=>{let e=Z(r);return Math.cos(e)},Zr=(...r)=>{let e=Z(r);return 1/Math.tan(e)};var qr=(...r)=>{let e=Z(r);return Math.exp(e)},Yr=(...r)=>{let e=Z(r);return Math.floor(e)};var en=(...r)=>(ut(r),Math.PI),tn=(...r)=>(ut(r),Math.E),rn=(...r)=>{let e=Z(r);return Math.sin(e)},nn=(...r)=>{let e=Jt(r);return H(e.length<=ke),e.reduce((t,n)=>t+n,0)},on={ABS:Ur,ACOS:Br,ACOSH:Hr,ACOT:Wr,ACOTH:zr,ASIN:Gr,ASINH:Vr,ATAN:Xr,ATAN2:jr,ATANH:Jr,AVERAGE:Kr,COT:Zr,COS:Qr,EXP:qr,INT:Yr,PI:en,E:tn,SIN:rn,SUM:nn},Kt=on;function Qt(r){let e=String(r),t=/[.](\d*)/.exec(e);if(t&&t[1]){let n=Math.pow(10,Math.min(t[1].length,ht)),a=e.split("."),u=a[0]+a[1].slice(0,ht);return Number(u)/n}else return r}var sn={...jt,...Kt},pt=sn;var le=class{constructor(e,t){this.type=e,this.value=t}toString(){return this.value}};function Zt(r){let e=r.toUpperCase(),t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)-64+t*26;return t-1}function dt(r){let e=r+1,t="",n=Math.floor(Math.abs(e)),a;for(;n>0;)a=(n-1)%26,t=String.fromCharCode(65+a)+t,n=Math.floor((n-a)/26);return t.toUpperCase()}function qt(r){let e=parseInt(r,10);return isNaN(e)?e=-1:e=Math.max(e-1,-1),e}function we(r){return Re(r)&&Te(r)}function Re(r){return r.colCount===0}function Te(r){return r.rowCount===0}function Yt(r,e){if(r.colCount===0&&e.colCount!==0||r.rowCount===0&&e.rowCount!==0)return!1;if(e.colCount===0&&e.row===r.row||e.rowCount===0&&e.col===r.col)return!0;let{row:t,col:n}=r;return t>=e.row&&t<e.row+e.rowCount&&n>=e.col&&n<e.col+e.colCount}var he=class r{constructor(e,t,n,a,u){this.row=0;this.col=0;this.colCount=0;this.rowCount=0;this.sheetId="";this.row=e,this.col=t,this.colCount=a,this.rowCount=n,this.sheetId=u}static makeRange(e){return new r(e.row,e.col,e.rowCount,e.colCount,e.sheetId)}toIRange(){return{row:this.row,col:this.col,rowCount:this.rowCount,colCount:this.colCount,sheetId:this.sheetId}}};function er(r,e,t){let{row:n,col:a,rowCount:u,colCount:d}=r;if(!e)return;if(we(r)){for(let f=0;f<e.rowCount;f++)for(let w=0;w<e.colCount;w++)if(t(f,w))return;return}if(Re(r)){for(let f=0;f<e.colCount;f++)if(t(n,f))return;return}if(Te(r)){for(let f=0;f<e.rowCount;f++)if(t(f,a))return;return}let g=n+u,b=a+d;for(let f=n;f<g;f++)for(let w=a;w<b;w++)if(t(f,w))return}var He=r=>r>="a"&&r<="z"||r>="A"&&r<="Z",ue=r=>r>="0"&&r<="9";function an(r){return r}function tr(r,e){if(!r)return;let t=r.trim(),[n,a=""]=t.split("!");t.includes("!")||(n="",a=t),n&&n[0]==="'"&&n[n.length-1]==="'"&&(n=n.slice(1,-1));let u=0,d="",g="";for(a[u]==="$"&&u++;u<a.length&&He(a[u]);)g+=a[u++];for(a[u]==="$"&&u++;u<a.length&&ue(a[u]);)d+=a[u++];if(u!==a.length||!d&&!g)return;let b=1,f=1,w=-1,I=-1;return d===""?(b=0,w=0):w=qt(d),g===""?(f=0,I=0):I=Zt(g),w<0||I<0||I>=at||w>=lt?void 0:new he(w,I,b,f,e(n))}function nr(r,e=an){let[t,n]=r.split(":"),a=tr(t,e);if(!a)return;let u=tr(n,e);return u?(u.sheetId=a.sheetId,ft(a,u)):a}function ft(r,e){if(r.sheetId!==e.sheetId)return;if(r.row===e.row&&r.col===e.col&&r.rowCount===e.rowCount&&r.colCount===e.colCount)return r;if(r.rowCount===0&&e.rowCount!==0||r.rowCount!==0&&e.rowCount===0||r.colCount===0&&e.colCount!==0||r.colCount!==0&&e.colCount===0)return;let t=Math.abs(r.row-e.row)+1,n=Math.abs(r.col-e.col)+1,a=r.row<e.row?r.row:e.row,u=r.col<e.col?r.col:e.col;return new he(a,u,t,n,r.sheetId)}function rr(r,e){let t=-1;if(r.startsWith("[")){let n=parseInt(r.slice(1,-1),10);isNaN(n)||(t=e+n)}else{let n=parseInt(r,10);isNaN(n)||(t=n-1)}return isNaN(t)?-1:t}function or(r,e={row:-1,col:-1}){let t=r.toUpperCase();if(t[0]!=="R")return;let n=t.slice(1).split("C");if(n.length!==2)return;let[a,u]=n,d=-1,g=-1;return a?d=rr(a,e.row):d=e.row,u?g=rr(u,e.col):g=e.col,g>=at||d>=lt||d<0||g<0?void 0:new he(d,g,1,1,"")}var ir="",ln=new Map([["TRUE",20],["FALSE",21]]),We=class{constructor(e){this.current=0;this.start=0;this.tokens=[];this.list=[...e]}scan(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();return this.tokens.push(new le(31,"")),this.tokens.length>0&&this.tokens[0].type===0&&this.tokens.shift(),this.tokens}peek(){return this.isAtEnd()?ir:this.list[this.current]}match(e){return this.peek()!==e?!1:(this.next(),!0)}next(){return this.isAtEnd()?ir:this.list[this.current++]}isAtEnd(){return this.current>=this.list.length}addToken(e){let t=this.list.slice(this.start,this.current).join("");this.tokens.push(new le(e,t))}string(e){for(;!this.isAtEnd()&&this.peek()!==e;)this.next();if(this.peek()!==e)throw new F("#VALUE!");this.next();let t=this.list.slice(this.start+1,this.current-1).join("");this.tokens.push(new le(17,t))}getDigits(){for(;!this.isAtEnd()&&ue(this.peek());)this.next()}getAlphas(){for(;!this.isAtEnd()&&He(this.peek());)this.next()}matchR1C1(){if(this.match("[")){if(this.match("-"),ue(this.peek()))this.getDigits();else throw new F("#VALUE!");if(this.peek()!=="]")throw new F("#VALUE!");this.next()}else this.getDigits()}matchScientificCounting(e){if(this.match("E")||this.match("e")){if(this.match("+")||this.match("-"))return this.getDigits(),this.addToken(e?18:19),!0;if(ue(this.peek()))return this.getDigits(),this.addToken(e?18:19),!0;throw new F("#VALUE!")}return!1}number(){if(this.getDigits(),this.matchScientificCounting(!1))return;let t=!1;this.match(".")&&(t=!0,this.getDigits()),!this.matchScientificCounting(!0)&&this.addToken(t?18:19)}addIdentifier(){for(;!this.isAtEnd()&&this.anyChar(this.peek());)this.next();let e=this.list.slice(this.start,this.current).join(""),t=e.toUpperCase(),n=ln.get(t),a=16;n&&(e=t,a=n),/^[A-Z]+\$\d+$/.test(t)&&(e=t,a=29),this.tokens.push(new le(a,e))}scanToken(){let e=this.next();switch(e){case"$":{He(this.peek())?(this.getAlphas(),this.match("$")?ue(this.peek())?(this.getDigits(),this.addToken(30)):this.addIdentifier():ue(this.peek())?(this.getDigits(),this.addToken(29)):this.addToken(30)):ue(this.peek())?(this.getDigits(),this.addToken(30)):this.addIdentifier();break}case"r":case"R":{if(this.matchR1C1(),this.match("C")||this.match("c")){this.matchR1C1();let t=this.list.slice(this.start,this.current).join("").toUpperCase();this.tokens.push(new le(28,t))}else this.addIdentifier();break}case"(":this.addToken(22);break;case")":this.addToken(23);break;case",":this.addToken(11);break;case":":this.addToken(10);break;case Bt:this.addToken(0);break;case"<":this.match(">")?this.addToken(1):this.match("=")?this.addToken(15):this.addToken(14);break;case">":this.match("=")?this.addToken(8):this.addToken(7);break;case"+":this.addToken(2);break;case"-":this.addToken(3);break;case"*":this.addToken(4);break;case"/":this.addToken(5);break;case"^":this.addToken(6);break;case"&":this.addToken(9);break;case"%":this.addToken(13);break;case'"':this.string(e);break;case"'":this.string(e);break;case"!":this.addToken(27);break;case";":this.addToken(26);break;case"{":this.addToken(24);break;case"}":this.addToken(25);break;case" ":break;case"\r":case"	":case`
`:break;default:if(ue(e))this.number();else if(this.anyChar(e))this.addIdentifier();else throw new F("#ERROR!");break}}anyChar(e){return!'(),:=<>+-*/^&%"{}!'.includes(e)&&!this.isWhiteSpace(e)}isWhiteSpace(e){return e===" "||e==="\r"||e===`
`||e==="	"}};var fe=class{constructor(e,t,n){this.left=e,this.operator=t,this.right=n}accept(e){return e.visitBinaryExpression(this)}handleConcatenate(e){let t=e.toString();return this.operator.type===9&&e instanceof Ce&&e.value.type===17?JSON.stringify(t):t}toString(){let e=this.handleConcatenate(this.left),t=this.handleConcatenate(this.right);return`${e}${this.operator.toString()}${t}`}},ze=class{constructor(e,t){this.operator=e,this.right=t}accept(e){return e.visitUnaryExpression(this)}toString(){return this.operator.toString()+this.right.toString()}},Ge=class{constructor(e,t){this.operator=e,this.left=t}accept(e){return e.visitPostUnaryExpression(this)}toString(){return this.left.toString()+this.operator.toString()}},Ce=class{constructor(e){this.value=e}accept(e){return e.visitLiteralExpression(this)}toString(){return this.value.toString()}},Ve=class{constructor(e){this.value=e}accept(e){return e.visitR1C1Expression(this)}toString(){return this.value.toString()}},ae=class{constructor(e,t,n){this.value=e,this.sheetName=n,this.type=t}accept(e){return e.visitCellExpression(this)}toString(){let e=this.value.toString().toUpperCase();if(this.sheetName){let t=this.sheetName.toString();return t.includes(" ")&&(t=`'${t}'`),`${t}!${e}`}else return e}},Xe=class{constructor(e,t){this.name=e,this.params=t}accept(e){return e.visitCallExpression(this)}toString(){return`${this.name.toString().toUpperCase()}(${this.params.map(e=>e.toString()).join(",")})`}},je=class{constructor(e,t,n){this.left=e,this.operator=t,this.right=n}accept(e){return e.visitCellRangeExpression(this)}toString(){return this.left.toString()+this.operator.toString()+this.right.toString()}},Je=class{constructor(e){this.value=e}accept(e){return e.visitGroupExpression(this)}toString(){return`(${this.value.toString()})`}},ye=class{constructor(e){this.value=e}accept(e){return e.visitTokenExpression(this)}toString(){return this.value.toString()}};var Ke=class{constructor(e){this.current=0;this.tokens=e}parse(){let e=[];for(;!this.isAtEnd();)e.push(this.expression());return e}expression(){return this.comparison()}comparison(){let e=this.concatenate();for(;this.match(0,1,7,8,14,15);){let t=this.previous(),n=this.concatenate();e=new fe(e,t,n)}return e}concatenate(){let e=this.term();for(;this.match(9);){let t=this.previous(),n=this.term();e=new fe(e,t,n)}return e}term(){let e=this.factor();for(;this.match(2,3);){let t=this.previous(),n=this.factor();e=new fe(e,t,n)}return e}factor(){let e=this.expo();for(;this.match(5,4);){let t=this.previous(),n=this.expo();e=new fe(e,t,n)}return e}expo(){let e=this.unary();for(;this.match(6);){let t=this.previous(),n=this.unary();e=new fe(e,t,n)}return e}unary(){if(this.match(2,3)){let e=this.previous(),t=this.unary();return new ze(e,t)}return this.postUnary()}postUnary(){let e=this.cellRange();if(this.match(13)){let t=this.previous();e=new Ge(t,e)}return e}cellRange(){let e=this.sheetRange();for(;this.match(10);){let t=this.previous(),n=this.sheetRange(),a=this.convertToCellExpression(n),u=this.convertToCellExpression(e);e=new je(u,t,a)}return e}convertToCellExpression(e){if(e instanceof ae)return e;if(e instanceof ye&&Be(e.value.value))return new ae(e.value,"relative",void 0);if(e instanceof Ce&&e.value.type===19)return new ae(e.value,"relative",void 0);throw new F("#NAME?")}sheetRange(){let e=this.call();if(this.match(27)){let t=this.call();if(e instanceof ye||e instanceof Ce){let n=this.convertToCellExpression(t);return new ae(n.value,n.type,e.value)}}return e}call(){let e=this.primary();for(;this.match(22);)e=this.finishCall(e);return e}finishCall(e){let t=[];if(!this.check(23))do{if(this.peek().type==23)break;t.push(this.expression())}while(this.match(11));return this.expect(23),new Xe(e,t)}primary(){if(this.match(22)){let e=this.expression();return this.expect(23),new Je(e)}if(this.match(19,18,17,20,21))return new Ce(this.previous());if(this.match(30)){let e=this.previous();return new ae(e,"absolute",void 0)}if(this.match(29)){let e=this.previous();return new ae(e,"mixed",void 0)}if(this.match(16)){let e=this.previous(),t=e.value.toUpperCase();if(Pe.has(t))throw new F(t);return new ye(e)}if(this.match(28))return new Ve(this.previous());throw new F("#ERROR!")}match(...e){let{type:t}=this.peek();return e.includes(t)?(this.next(),!0):!1}previous(){return this.tokens[this.current-1]}check(e){return this.peek().type===e}expect(e){if(this.check(e))return this.next(),this.previous();throw new F("#ERROR!")}next(){this.current++}isAtEnd(){return this.peek().type===31}peek(){return this.current<this.tokens.length?this.tokens[this.current]:new le(31,"")}};var Qe=class{constructor(e,t,n,a){this.expressions=e,this.functionMap=a,this.cellDataMap=t,this.definedNamesMap=n}interpret(){let e=[];for(let t of this.expressions)e.push(this.evaluate(t));if(e.length===1)return this.getRangeCellValue(e[0]);throw new F("#ERROR!")}visitBinaryExpression(e){let t=this.evaluate(e.left),n=this.evaluate(e.right);switch(t=this.getRangeCellValue(t),n=this.getRangeCellValue(n),e.operator.type){case 3:return H(typeof t=="number"),H(typeof n=="number"),t-n;case 2:return H(typeof t=="number"),H(typeof n=="number"),t+n;case 5:if(H(typeof t=="number"),H(typeof n=="number"),n===0)throw new F("#DIV/0!");return t/n;case 4:return H(typeof t=="number"),H(typeof n=="number"),t*n;case 6:return H(typeof t=="number"),H(typeof n=="number"),Math.pow(t,n);case 0:return t===n;case 1:return t!==n;case 7:return t>n;case 8:return t>=n;case 14:return t<n;case 15:return t<=n;case 9:return`${t}${n}`;default:throw new F("#VALUE!")}}visitCallExpression(e){let t=this.evaluate(e.name);if(t&&typeof t=="function"){let n=[];for(let a of e.params){let u=this.evaluate(a);if(u instanceof he){let d=this.cellDataMap.get(u);n=n.concat(d)}else n.push(u)}return t(...n)}throw new F("#NAME?")}visitR1C1Expression(e){let t=or(e.value.value,this.cellDataMap.getCurrentCell());if(!t)throw new F("#NAME?");return t}visitCellExpression(e){let t="";if(e.sheetName&&(t=this.cellDataMap.convertSheetNameToSheetId(e.sheetName.value),!t))throw new F("#NAME?");let n=nr(e.value.value);if(!n)throw new F("#NAME?");return t&&(n.sheetId=t),n}visitLiteralExpression(e){let{type:t,value:n}=e.value;switch(t){case 17:return n;case 18:case 19:{let[a,u]=xe(n);if(a)return u;throw new F("#VALUE!")}case 20:return!0;case 21:return!1;default:throw new F("#ERROR!")}}visitTokenExpression(e){let{value:t}=e.value,n=t.toLowerCase();if(this.definedNamesMap.get(n)){let d=this.definedNamesMap.get(n);return this.cellDataMap.get(d)[0]}let a=t.toUpperCase(),u=this.functionMap[a];if(u)return u;if(Be(t))return this.visitCellExpression(new ae(e.value,"relative",void 0));throw new F("#NAME?")}visitUnaryExpression(e){let t=this.evaluate(e.right);switch(e.operator.type){case 3:return H(typeof t=="number"),-t;case 2:return H(typeof t=="number"),t;default:throw new F("#VALUE!")}}visitCellRangeExpression(e){switch(e.operator.type){case 10:{let t=this.visitCellExpression(e.left),n=this.visitCellExpression(e.right),a=ft(t,n);if(!a)throw new F("#NAME?");return a}default:throw new F("#NAME?")}}visitGroupExpression(e){return this.evaluate(e.value)}visitPostUnaryExpression(e){let t=this.evaluate(e.left);switch(e.operator.type){case 13:return H(typeof t=="number"),t*.01;default:throw new F("#VALUE!")}}evaluate(e){return e.accept(this)}getRangeCellValue(e){if(e instanceof he){if(e.colCount===e.rowCount&&e.colCount===1)return this.cellDataMap.get(e)[0];throw new F("#REF!")}return e}};function mt(r,e=new Ze,t=new qe,n=pt){let a="";try{let u=new We(r).scan(),d=new Ke(u).parse(),g=new Qe(d,e,t,n).interpret(),b=[];for(let w of d)b.push(w.toString());a=b.join("");let f=g;return typeof f=="number"&&!isNaN(f)&&(f=Qt(f)),{result:f,isError:!1,expressionStr:a}}catch(u){if(u instanceof F)return{result:u.value,isError:!0,expressionStr:a}}return{result:"#ERROR!",isError:!0,expressionStr:a}}var Ze=class{constructor(){this.map=new Map;this.sheetNameMap={};this.cell={row:0,col:0}}getKey(e,t,n){return`${e}_${t}_${n}`}setCurrentCell(e){this.cell=e}setSheetNameMap(e){this.sheetNameMap=e}set(e,t){let{row:n,col:a,sheetId:u}=e;for(let d=0;d<t.length;d++)for(let g=0;g<t[d].length;g++){let b=this.getKey(n+d,a+g,u);this.map.set(b,t[d][g])}}get(e){let t=[],{row:n,col:a,rowCount:u,colCount:d,sheetId:g}=e;for(let b=n,f=n+u;b<f;b++)for(let w=a,I=a+d;w<I;w++){let S=this.getKey(b,w,g),k=this.map.get(S);typeof k<"u"&&t.push(k)}return t}convertSheetNameToSheetId(e){return this.sheetNameMap[e]||""}getCurrentCell(){return{...this.cell}}},qe=class{constructor(){this.map=new Map}set(e,t){this.map.set(e,t)}get(e){return this.map.get(e)}};function xt(r){return r?typeof Intl>"u"||typeof Intl.Segmenter!="function"?[...r]:[...new Intl.Segmenter([],{granularity:"word"}).segment(r)].map(n=>n.segment):[]}var cn={smallFont:"10px",font:"12px",largeFont:"14px",padding:"12px",lineHeight:1.5,mediumPadding:"8px",largePadding:"20px",borderRadius:"4px",borderLargeRadius:"8px",tinyPadding:"4px",scrollBarContent:"30px",formulaBarHeight:"25px"},sr=cn;var hn={lowZIndex:2,middleZIndex:3,highZIndex:4,highestZIndex:9},ar=hn;function un(r,e,t,n){e=e/100,t=t/100;let a=(1-Math.abs(2*t-1))*e,u=a*(1-Math.abs(r/60%2-1)),d=t-a/2,g,b,f;if(r>=0&&r<60?(g=a,b=u,f=0):r>=60&&r<120?(g=u,b=a,f=0):r>=120&&r<180?(g=0,b=a,f=u):r>=180&&r<240?(g=0,b=u,f=a):r>=240&&r<300?(g=u,b=0,f=a):(g=a,b=0,f=u),n!==1)return`rgba(${g},${b},${f},${n})`;let w=A=>Math.round(A*255).toString(16).padStart(2,"0"),I=w(g+d),S=w(b+d),k=w(f+d);return`#${I}${S}${k}`}var pn=(r,e,t)=>{let n=r/255,a=e/255,u=t/255,d=Math.min(n,a,u),g=Math.max(n,a,u),b=g-d,f=dn(n,a,u),w=gn(g,d),I=fn(b,w);return[f,I*100,w*100]},dn=(r,e,t)=>{let n=Math.max(r,e,t),a=Math.min(r,e,t),u=n-a,d=0;if(u==0)d=0;else switch(n){case r:{let f=(e-t)/u,w=0;f<0&&(w=360/60),d=f+w;break}case e:{let f=(t-r)/u,w=120/60;d=f+w;break}case t:let g=(r-e)/u,b=240/60;d=g+b;break}return d*60},fn=(r,e)=>r==0?0:r/(1-Math.abs(2*e-1)),gn=(r,e)=>(r+e)/2,lr=([r,e,t,n])=>{let[a,u,d]=pn(r,e,t);return un(a,u*.9,100-d,n)};function mn(r){r.startsWith("#")&&(r=r.slice(1));let e=parseInt(r.substring(0,2),16),t=parseInt(r.substring(2,4),16),n=parseInt(r.substring(4,6),16),a=parseInt(r.substring(6,8)||"ff",16);return[e,t,n,a/255]}var Ct=r=>{if(r.startsWith("rgb")){let t=r.replace("rgb","").replace("a","").replace("(","").replace(")","").split(",").map(Number);return t.length<=3&&t.push(1),lr(t)}else return lr(mn(r))};var bt=Object.freeze({primaryColor:"#217346",buttonActiveColor:"#c6c6c6",selectionColor:"rgba(198,198,198,0.3)",backgroundColor:"#e6e6e6",hoverColor:"rgba(0, 0, 0, 0.04)",scrollbarColor:"rgba(0, 0, 0, 0.1)",scrollbarHoveColor:"rgba(0, 0, 0, 0.2)",dialogBackground:"rgba(0, 0, 0, 0.6)",white:"#ffffff",black:"#000000",triangleFillColor:"#dddddd",contentColor:"#333333",borderColor:"#cccccc",activeBorderColor:"#808080",errorFormulaColor:"#ff0000"}),cr=Object.freeze(Object.fromEntries(Object.entries(bt).map(([r,e])=>[r,Ct(e)])));var Ye={...sr,...ar},xn="data-theme";function Cn(){if(typeof sessionStorage<"u"){let r=sessionStorage.getItem(xn);if(r&&(r==="dark"||r==="light"))return r}return typeof matchMedia=="function"&&matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function K(r,e){return e==="dark"||Cn()==="dark"?cr[r]:bt[r]}var Et;function ve(r=typeof devicePixelRatio>"u"?void 0:devicePixelRatio){return typeof Et=="number"?Et:Math.max(Math.floor(r||1),1)}function $(r){return Math.floor(r*ve())}function hr(r){Et=Math.max(Math.floor(r||1),1)}function ur(r){let e=r||{};return[Object,Array].includes(e.constructor)&&!Object.entries(e).length}function et(r="normal",e="normal",t=me,n=""){let a=`${r} ${e} ${t}px `,u=[Ut];return zt()&&u.unshift("Source Code Pro"),n&&u.unshift(n),a+u.join(",")}var Rt=Dr(dr());function fr(r,e,t={}){return Rt.default.format(e||De,r,t)}function gr(r){return r?Rt.default.is_date(r):!1}var Tt=new Map;function wn(r,e){let t=`${e}__${r.font}`;if(Tt.has(t))return Tt.get(t);let n=r.measureText(e),{actualBoundingBoxAscent:a,actualBoundingBoxDescent:u}=n,d=a+u,g=n.width,b=Math.ceil(g/ve()),f=Math.ceil(d/ve()),w={width:b,height:f};return Tt.set(t,w),w}function ne(r,e,t,n,a){r.fillRect($(e),$(t),$(n),$(a))}function yt(r,e,t,n,a){r.strokeRect($(e),$(t),$(n),$(a))}function vt(r,e,t,n,a){r.clearRect($(e),$(t),$(n),$(a))}function tt(r,e,t,n){r.fillText(e,$(t),$(n))}function pe(r,e){if(e.length!==0){r.beginPath();for(let t=0;t<e.length;t+=2){let n=e[t],a=e[t+1];r.moveTo($(n[0]),$(n[1])),r.lineTo($(a[0]),$(a[1]))}r.stroke()}}function mr(r,e,t,n){r.beginPath(),r.moveTo($(e[0]),$(e[1])),r.lineTo($(t[0]),$(t[1])),r.lineTo($(n[0]),$(n[1])),r.fill()}function xr(r,e="bottom",t=!1){let n=r.slice(),[a,u]=r,d=O*2,g=t?d:0;return e==="bottom"?n.push([a[0]+g,a[1]-d],[u[0]-g,u[1]-d]):e==="top"?n.push([a[0]+g,a[1]+d],[u[0]-g,u[1]+d]):e==="left"?n.push([a[0]+d,a[1]+g],[u[0]+d,u[1]-g]):e==="right"&&n.push([a[0]-d,a[1]+g],[u[0]-d,u[1]-g]),n}function Rn(r,e,t){return t?e?r.split(Fe):xt(r.replaceAll(Fe,"")):xt(r)}function Cr(r,e,t,n,a){r.setLineDash([$(8),$(6)]);let u=O;yt(r,e+u,t+u,n-u*2,a-u*2),r.setLineDash([])}function Tn(r){let e=[];return r==="hair"?e=[O,O]:r==="dotted"||r==="mediumDashed"?e=[O*2,O*2]:r==="dashed"?e=[O*4,O*4]:r==="dashDot"||r==="mediumDashDot"?e=[O*4,O*4,O*8,O*4]:(r==="dashDotDot"||r==="mediumDashDotDot")&&(e=[O*4,O*4,O*8,O*4,O*4,O*4]),e}function Oe(r,e,t,n,a){if(!t)return;let{top:u,left:d,width:g,height:b}=e,f=[];n==="top"?f=[[d,u],[d+g,u]]:n==="bottom"?f=[[d,u+b],[d+g,u+b]]:n==="left"?f=[[d,u],[d,u+b]]:n==="right"&&(f=[[d+g,u],[d+g,u+b]]);let{type:w,color:I}=t;r.lineWidth=$e[w],r.strokeStyle=I||K("black",a);let S=Tn(w);w==="double"&&(f=xr(f,n,!0)),S.length>0&&r.setLineDash(S.map(k=>$(k))),pe(r,f),S.length>0&&r.setLineDash([])}function br(r,e,t,n,a,u){let d={height:0,width:0};if(t===""&&ur(n))return d;let g=n?.numberFormat||De,b=g===De&&typeof t=="number",f=fr(t,g),w=n?.fontSize?n.fontSize:me,I=et(n?.isItalic?"italic":"normal",n?.isBold?"bold":"500",$(w),n?.fontFamily);n?.fillColor&&(r.fillStyle=n?.fillColor,ne(r,e.left,e.top,e.width,e.height));let S=n?.fontColor||K("contentColor",u);Pe.has(f)&&(S=K("errorFormulaColor",u)),r.font=I,r.fillStyle=S;let k=n?{...n}:{},A=k?.horizontalAlign;k?.horizontalAlign===void 0&&b&&(A=2),k.horizontalAlign=A;let D=a&&f.includes(Fe),z=Rn(f,n?.isWrapText,a).map(Y=>{let J=wn(r,Y);return{str:Y,width:J.width,height:J.height===0?w:J.height}}),{width:q,height:te,resultList:G}=yn(z,e,k,D);if(q>0&&te>0){let Y=Math.ceil(w*(Ye.lineHeight-1)/2),J=[];for(let j of G){if(tt(r,j.text,j.x,j.y),k?.underline){r.strokeStyle=S;let oe=j.y+j.height+Y/2,Ie=[[j.x,oe],[j.x+j.width,oe]];k?.underline===2?J=J.concat(xr(Ie,"bottom",!1)):J=J.concat(Ie)}if(k?.isStrike){r.strokeStyle=S;let oe=j.y+j.height/2+Y/2;J=J.concat([[j.x,oe],[j.x+j.width,oe]])}}pe(r,J)}if(d.height=Math.ceil(te),d.width=Math.ceil(q),!k?.isWrapText&&gr(g)){let Y=z.reduce((J,j)=>J+j.width,0);d.width=Math.max(Math.ceil(Y),d.width)}return d}function yn(r,e,t,n){let a=t?.fontSize?t.fontSize:me,u=Math.ceil(a*(Ye.lineHeight-1)/2),d=t?.verticalAlign??1,{left:g,top:b,height:f}=e,w=Math.max(e.width,...r.map(A=>A.width)),I=[],S=0,k=0;if(t?.isWrapText&&n){let A=0;for(let D=0;D<r.length;D++){let T=r[D];S=Math.max(S,T.width);let z=T.height+u*2;k+=z,I.push({text:T.str,x:0,y:A,width:T.width,height:T.height}),A+=z}}else if(t?.isWrapText){let A=0;for(let D=0;D<r.length;){let T=w,z="",q=0,te=0;for(;D<r.length;){let G=r[D];if(T>=G.width)q+=G.width,te=Math.max(te,G.height),T-=G.width,z+=G.str,D++;else break}if(z){S=Math.max(S,q);let G=te+u*2;k+=G,I.push({text:z,x:0,y:A,width:q,height:te}),A+=G}}}else{let A="",D=w;for(let T=0;T<r.length;T++){let z=r[T];if(D>=z.width)S+=z.width,k=Math.max(k,z.height),A+=z.str,D-=z.width;else break}I.push({text:A,x:0,y:0,width:S,height:k})}if(k=Math.max(k,a*Ye.lineHeight),S+=u,k+=u,S<=w&&k<=f){let A=g+u,D=b+(f-k)/2+u;d===0?D=b+u:d===2&&(D=b+(f-k)+u),t?.horizontalAlign===1?A=g+(w-S)/2:t?.horizontalAlign===2&&(A=g+(w-S)-u);for(let T of I)T.x=T.x+A,T.y=T.y+D}return{width:S,height:k,resultList:I}}function It(r){return{textAlign:"center",textBaseline:"middle",font:et(void 0,"500",$(me)),fillStyle:K("black",r),lineWidth:O,strokeStyle:K("borderColor",r)}}var Er=Math.max(...Object.values($e)),rt=class{constructor(e){this.width=0;this.height=0;this.isRendering=!1;this.rowMap={};this.colMap={};this.eventData={theme:"light",sheetData:{},canvasSize:{top:0,left:0,width:0,height:0},headerSize:{width:0,height:0},currentSheetInfo:{isHide:!1,rowCount:0,colCount:0,name:"",sheetId:"",tabColor:"",sort:1},scroll:{left:0,top:0,row:0,col:0,scrollLeft:0,scrollTop:0},range:{row:0,col:0,rowCount:1,colCount:1,sheetId:""},copyRange:void 0,customHeight:{},customWidth:{},currentMergeCells:[]};this.canvas=e,this.ctx=e.getContext("2d");let t=ve();this.ctx.scale(t,t)}render(e){if(e.changeSet.size===0||this.isRendering)return;this.isRendering=!0,this.eventData=e,this.clear();let{ctx:t}=this;t.strokeStyle=K("primaryColor",e.theme),t.fillStyle=K("white",e.theme),t.lineWidth=O*2;let{width:n,height:a}=this.eventData.canvasSize,u=this.eventData.headerSize,{endRow:d,contentHeight:g}=this.renderRowsHeader(a),{endCol:b,contentWidth:f}=this.renderColsHeader(n);this.renderGrid(n-u.width,a-u.height),this.renderTriangle(),this.renderMergeCell(),this.ctx.fillStyle=K("selectionColor",this.eventData.theme);let w=this.renderSelection({endRow:d,endCol:b,contentHeight:g,contentWidth:f});return this.renderAntLine(w),this.renderContent({endRow:d,endCol:b,contentHeight:g,contentWidth:f}),this.ctx.lineWidth=Er,yt(this.ctx,w.left,w.top,w.width,w.height),this.isRendering=!1,{rowMap:this.rowMap,colMap:this.colMap}}resize(e){this.width=e.width,this.height=e.height,this.canvas.width=$(e.width),this.canvas.height=$(e.height)}clear(){vt(this.ctx,0,0,this.width,this.height)}renderRowsHeader(e){let{row:t}=this.eventData.scroll,n=this.eventData.headerSize,{rowCount:a}=this.eventData.currentSheetInfo;this.ctx.save();let u=this.eventData.range;ne(this.ctx,0,n.height,n.width,e),Object.assign(this.ctx,It(this.eventData.theme));let d=[],g=n.height,b=t;for(;b<a&&g<e;b++){let w=this.getRowHeight(b),I=g;if(b===t&&(I+=O/2),d.push([0,I],[n.width,I]),w>0){let S=this.isHighlightRow(u,b);this.ctx.fillStyle=S?K("primaryColor",this.eventData.theme):K("black",this.eventData.theme),tt(this.ctx,String(b+1),n.width/2,I+w/2)}g+=w}d.push([0,g],[n.width,g]),d.push([0,0],[0,g]),pe(this.ctx,d),this.ctx.restore();let f=b>=a?g:e;return{endRow:b,contentHeight:Math.floor(f)}}renderColsHeader(e){let{col:t}=this.eventData.scroll,n=this.eventData.headerSize,{colCount:a}=this.eventData.currentSheetInfo,u=this.eventData.range,d=[];this.ctx.save(),ne(this.ctx,n.width,0,e,n.height),Object.assign(this.ctx,It());let g=n.width,b=t;for(;b<a&&g<=e;b++){let w=this.getColWidth(b),I=g;if(b===t&&(I+=O/2),d.push([I,0],[I,n.height]),w>0){let S=this.isHighlightCol(u,b);this.ctx.fillStyle=S?K("primaryColor",this.eventData.theme):K("black",this.eventData.theme),tt(this.ctx,dt(b),I+w/2,n.height/2)}g+=w}d.push([g,0],[g,n.height]),d.push([0,0],[g,0]),pe(this.ctx,d),this.ctx.restore();let f=b>=a?g:e;return{endCol:b,contentWidth:Math.floor(f)}}renderGrid(e,t){let n=this.eventData.headerSize,{row:a,col:u}=this.eventData.scroll,{rowCount:d,colCount:g}=this.eventData.currentSheetInfo;this.ctx.save(),this.ctx.lineWidth=O,this.ctx.strokeStyle=K("borderColor",this.eventData.theme),this.ctx.translate($(n.width),$(n.height));let b=[],f=0,w=0,I=0;for(let A=u;A<g&&(I+=this.getColWidth(A),!(I>e));A++);let S=Math.min(I,e),k=!1;for(let A=a;A<d;A++){k?k=!1:b.push([0,f],[S,f]);let D=this.getRowHeight(A);if(D===0&&(k=!0),f+=D,f>t)break}for(let A=u;A<g;A++){k?k=!1:b.push([w,0],[w,f]);let D=this.getColWidth(A);if(D===0&&(k=!0),w+=D,w>S)break}b.push([0,f],[w,f]),b.push([w,0],[w,f]),pe(this.ctx,b),this.ctx.restore()}renderTriangle(){let e=this.eventData.headerSize;this.ctx.save(),ne(this.ctx,0,0,e.width,e.height),this.ctx.fillStyle=K("triangleFillColor",this.eventData.theme);let t=2,n=Math.floor(t),a=Math.floor(e.height-t),u=Math.floor(e.width*.4),d=Math.floor(e.width-t);mr(this.ctx,[d,n],[u,a],[d,a]),this.ctx.restore()}getRowHeight(e){let t=`${this.eventData.currentSheetInfo.sheetId}_${e}`,n=this.eventData.customHeight[t];return n?n.isHide?st:n.len:it}getColWidth(e){let t=`${this.eventData.currentSheetInfo.sheetId}_${e}`,n=this.eventData.customWidth[t];return n?n.isHide?st:n.len:Le}isHighlightRow(e,t){return!!(we(e)||Te(e)||t>=e.row&&t<e.row+e.rowCount)}isHighlightCol(e,t){return!!(we(e)||Re(e)||t>=e.col&&t<e.col+e.colCount)}renderAntLine(e){let t=this.eventData.copyRange;!t||t.sheetId!==this.eventData.currentSheetInfo.sheetId||(this.ctx.lineWidth=Er,this.ctx.strokeStyle=K("primaryColor",this.eventData.theme),Cr(this.ctx,e.left,e.top,e.width,e.height))}renderMergeCell(){let e=this.eventData.currentMergeCells;if(e.length===0)return;let t=this.eventData.range;for(let n of e)t.row===n.row&&t.col===n.col||this.clearRect(n)}getCellSize(e){let{row:t,col:n,colCount:a,rowCount:u}=e,d=t,g=n,b=t+u,f=n+a,w=this.eventData.currentSheetInfo;we(e)?(g=0,f=w.colCount,d=0,b=w.rowCount):Te(e)?(d=0,b=w.rowCount):Re(e)&&(g=0,f=w.colCount);let I=0,S=0;for(;d<b;d++)S+=this.getRowHeight(d);for(;g<f;g++)I+=this.getColWidth(g);return{width:I,height:S}}computeCellPosition(e){let{row:t,col:n}=e,a=this.eventData.headerSize,u=this.eventData.scroll,d=a.width,g=a.height,b=u.row,f=u.col;if(n>=u.col)for(;f<n;)d+=this.getColWidth(f),f++;else for(d=-a.width;f>n;)d-=this.getColWidth(f),f--;if(t>=u.row)for(;b<t;)g+=this.getRowHeight(b),b++;else for(g=-a.height;b>t;)g-=this.getRowHeight(b),b--;return{top:g,left:d}}getActiveRange(e){let t=e||this.eventData.range,n=this.eventData.currentMergeCells;for(let a of n)if(Yt(t,a))return{range:{...a,sheetId:a.sheetId},isMerged:!0};return{range:t,isMerged:!1}}clearRect(e){let t=this.getCellSize(e);if(t.width<=0||t.height<=0)return;let n=this.computeCellPosition(e),a=O;vt(this.ctx,n.left+a,n.top+a,t.width-a*2,t.height-a*2)}renderContent(e){let{endCol:t,endRow:n,contentHeight:a,contentWidth:u}=e,{ctx:d}=this;d.textAlign="left",d.textBaseline="top",d.lineWidth=O*2;let g=this.eventData.headerSize,{row:b,col:f}=this.eventData.scroll,w=Math.floor(u-g.width),I=Math.floor(a-g.height);d.save(),this.rowMap={},this.colMap={};let S=this.eventData.currentMergeCells;for(let k=b;k<n;k++)for(let A=f;A<t;A++){let D=S.find(T=>T.row===k&&T.col===A);this.renderCell(k,A,D,w,I)}d.restore()}renderCell(e,t,n,a,u){let{ctx:d}=this,g={row:e,col:t,rowCount:1,colCount:1,sheetId:""},b=`${e}_${t}`,f=this.eventData.sheetData[b];if(!f)return;let w=this.getCellSize(n||g);if(w.width<=0||w.height<=0)return;let I=this.computeCellPosition(g);d.lineWidth=O*2;let S=this.eventData.theme,k=br(d,{top:I.top,left:I.left,width:Math.min(w.width,a),height:Math.min(w.height,u)},f.value,f.style,!!n,S),A=Math.max(this.rowMap[e]??0,k.height),D=Math.max(this.colMap[t]??0,k.width);A>=it&&(this.rowMap[e]=A),D>=Le&&(this.colMap[t]=D);let T={top:I.top,left:I.left,height:Math.max(A,w.height),width:Math.max(D,w.width)};Oe(d,T,f.style?.borderTop,"top",S),Oe(d,T,f.style?.borderBottom,"bottom",S),Oe(d,T,f.style?.borderLeft,"left",S),Oe(d,T,f.style?.borderRight,"right",S)}renderSelection(e){let t=this.eventData.range;return we(t)?this.renderSelectAll(e):Te(t)?this.renderSelectCol(e):Re(t)?this.renderSelectRow(e):this.renderSelectRange()}renderSelectRange(){let e=this.eventData.headerSize,t=this.eventData.range,n=this.computeCellPosition({row:t.row,col:t.col,rowCount:1,colCount:1,sheetId:""}),a=t.row+t.rowCount-1,u=t.col+t.colCount-1,d={row:a,col:u,rowCount:1,colCount:1,sheetId:""},g=this.computeCellPosition(d),b=this.getCellSize(d),f=g.left+b.width-n.left,w=g.top+b.height-n.top;ne(this.ctx,n.left,0,f,e.height),ne(this.ctx,0,n.top,e.width,w);let I=t.rowCount>1||t.colCount>1;I&&ne(this.ctx,n.left,n.top,f,w);let S=[[n.left,e.height],[n.left+f,e.height]];return S.push([e.width,n.top],[e.width,n.top+w]),pe(this.ctx,S),I&&this.renderActiveCell(),{left:n.left,top:n.top,width:f,height:w}}renderSelectAll(e){let{contentHeight:t,contentWidth:n}=e,a=this.eventData.headerSize;ne(this.ctx,0,0,n,t),this.renderActiveCell();let u=n-a.width,d=t-a.height;return{left:a.width,top:a.height,width:u,height:d}}renderSelectCol({contentHeight:e}){let t=this.eventData.headerSize,n=this.eventData.range,a=this.computeCellPosition(n),u=0;for(let b=n.col,f=n.col+n.colCount;b<f;b++)u+=this.getColWidth(b);let d=e-t.height;ne(this.ctx,a.left,0,u,e),ne(this.ctx,0,a.top,t.width,d);let g=[[t.width,t.height],[t.width,e]];return pe(this.ctx,g),this.renderActiveCell(),{left:a.left,top:t.height,width:u,height:d}}renderSelectRow({contentWidth:e}){let t=this.eventData.headerSize,n=this.eventData.range,a=this.computeCellPosition(n),u=0;for(let b=n.row,f=n.row+n.rowCount;b<f;b++)u+=this.getRowHeight(b);let d=e-t.width-O;ne(this.ctx,a.left,0,d,t.height),ne(this.ctx,0,a.top,e,u);let g=[[a.left,t.height],[e,t.height]];return pe(this.ctx,g),this.renderActiveCell(),{left:t.width,top:a.top,width:d,height:u}}renderActiveCell(){let e=this.eventData.range,t=this.getActiveRange({row:e.row,col:e.col,rowCount:1,colCount:1,sheetId:e.sheetId}).range;this.clearRect(t)}};var Mt;self.addEventListener("message",r=>{if(r.data.status==="formula"){let t={list:vn(r.data),status:"formula"};self.postMessage(t)}else if(r.data.status==="init")Mt=new rt(r.data.canvas),hr(r.data.dpr);else if(r.data.status==="render"){let e=Mt.render(r.data);if(e){let t={...e,status:"render"};self.postMessage(t)}}else r.data.status==="resize"&&Mt.resize(r.data)});function vn(r){let{currentSheetId:e,worksheets:t}=r,n=new Map,a=t[e]||{},u=[];for(let[d,g]of Object.entries(a))if(g?.formula){let b=wr(g.formula,r,n,Wt(d),u);b.result!==g.value&&u.push({key:d,newValue:b.result,sheetId:e})}return u}function wr(r,e,t,n,a){let u=t.get(r);if(u)return u;let{currentSheetId:d,worksheets:g,definedNames:b,workbook:f}=e,w=mt(r,{getCurrentCell:()=>n,get:I=>{let{row:S,col:k,sheetId:A}=I,D=A||d,T=[],z=f.find(te=>te.sheetId===D);if(!z||S>=z.rowCount||k>=z.colCount)throw new F("#REF!");let q=g[D]||{};return er(I,z,(te,G)=>{let Y=Ht(te,G);if(q[Y]){let J=q[Y].formula,j=q[Y].value;if(J){let oe=wr(J,e,t,{row:te,col:G},a);oe.result!==j&&a.push({key:Y,newValue:oe.result,sheetId:D}),T.push(oe?.result)}else T.push(j)}return!1}),T},set:()=>{throw new F("#REF!")},convertSheetNameToSheetId:I=>f.find(S=>S.name===I)?.sheetId||""},{set:()=>{throw new F("#REF!")},get:I=>b[I]});return t.set(r,w),w}
//# sourceMappingURL=worker.js.map
