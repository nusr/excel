/* 
MIT License

Copyright (c) 2020 Steve Xu

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/
var Mr=Object.create;var Wt=Object.defineProperty;var Sr=Object.getOwnPropertyDescriptor;var Ar=Object.getOwnPropertyNames;var Dr=Object.getPrototypeOf,kr=Object.prototype.hasOwnProperty;var _r=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Or=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Ar(e))!kr.call(r,o)&&o!==t&&Wt(r,o,{get:()=>e[o],enumerable:!(n=Sr(e,o))||n.enumerable});return r};var Nr=(r,e,t)=>(t=r!=null?Mr(Dr(r)):{},Or(e||!r||!r.__esModule?Wt(t,"default",{value:r,enumerable:!0}):t,r));var xr=_r((_i,vt)=>{"use strict";var mr={};function Tn(r){r.version="0.11.3";function e(a){for(var i="",s=a.length-1;s>=0;)i+=a.charAt(s--);return i}function t(a,i){for(var s="";s.length<i;)s+=a;return s}function n(a,i){var s=""+a;return s.length>=i?s:t("0",i-s.length)+s}function o(a,i){var s=""+a;return s.length>=i?s:t(" ",i-s.length)+s}function u(a,i){var s=""+a;return s.length>=i?s:s+t(" ",i-s.length)}function f(a,i){var s=""+Math.round(a);return s.length>=i?s:t("0",i-s.length)+s}function g(a,i){var s=""+a;return s.length>=i?s:t("0",i-s.length)+s}var b=Math.pow(2,32);function d(a,i){if(a>b||a<-b)return f(a,i);var s=Math.round(a);return g(s,i)}function E(a,i){return i=i||0,a.length>=7+i&&(a.charCodeAt(i)|32)===103&&(a.charCodeAt(i+1)|32)===101&&(a.charCodeAt(i+2)|32)===110&&(a.charCodeAt(i+3)|32)===101&&(a.charCodeAt(i+4)|32)===114&&(a.charCodeAt(i+5)|32)===97&&(a.charCodeAt(i+6)|32)===108}var y=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],M=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function N(a){a[0]="General",a[1]="0",a[2]="0.00",a[3]="#,##0",a[4]="#,##0.00",a[9]="0%",a[10]="0.00%",a[11]="0.00E+00",a[12]="# ?/?",a[13]="# ??/??",a[14]="m/d/yy",a[15]="d-mmm-yy",a[16]="d-mmm",a[17]="mmm-yy",a[18]="h:mm AM/PM",a[19]="h:mm:ss AM/PM",a[20]="h:mm",a[21]="h:mm:ss",a[22]="m/d/yy h:mm",a[37]="#,##0 ;(#,##0)",a[38]="#,##0 ;[Red](#,##0)",a[39]="#,##0.00;(#,##0.00)",a[40]="#,##0.00;[Red](#,##0.00)",a[45]="mm:ss",a[46]="[h]:mm:ss",a[47]="mmss.0",a[48]="##0.0E+0",a[49]="@",a[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'}var _={};N(_);var L=[],T=0;for(T=5;T<=8;++T)L[T]=32+T;for(T=23;T<=26;++T)L[T]=0;for(T=27;T<=31;++T)L[T]=14;for(T=50;T<=58;++T)L[T]=14;for(T=59;T<=62;++T)L[T]=T-58;for(T=67;T<=68;++T)L[T]=T-58;for(T=72;T<=75;++T)L[T]=T-58;for(T=67;T<=68;++T)L[T]=T-57;for(T=76;T<=78;++T)L[T]=T-56;for(T=79;T<=81;++T)L[T]=T-34;var J={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function te(a,i,s){for(var v=a<0?-1:1,l=a*v,S=0,h=1,R=0,D=1,x=0,O=0,F=Math.floor(l);x<i&&(F=Math.floor(l),R=F*h+S,O=F*x+D,!(l-F<5e-8));)l=1/(l-F),S=h,h=R,D=x,x=O;if(O>i&&(x>i?(O=D,R=S):(O=x,R=h)),!s)return[0,v*R,O];var re=Math.floor(v*R/O);return[re,v*R-re*O,O]}function se(a){var i=a.toPrecision(16);if(i.indexOf("e")>-1){var s=i.slice(0,i.indexOf("e"));return s=s.indexOf(".")>-1?s.slice(0,s.slice(0,2)=="0."?17:16):s.slice(0,15)+t("0",s.length-15),s+i.slice(i.indexOf("e"))}var v=i.indexOf(".")>-1?i.slice(0,i.slice(0,2)=="0."?17:16):i.slice(0,15)+t("0",i.length-15);return Number(v)}function z(a,i,s){if(a>2958465||a<0)return null;a=se(a);var v=a|0,l=Math.floor(86400*(a-v)),S=0,h=[],R={D:v,T:l,u:86400*(a-v)-l,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(R.u)<1e-6&&(R.u=0),i&&i.date1904&&(v+=1462),R.u>.9999&&(R.u=0,++l==86400&&(R.T=l=0,++v,++R.D)),v===60)h=s?[1317,10,29]:[1900,2,29],S=3;else if(v===0)h=s?[1317,8,29]:[1900,1,0],S=6;else{v>60&&--v;var D=new Date(1900,0,1);D.setDate(D.getDate()+v-1),h=[D.getFullYear(),D.getMonth()+1,D.getDate()],S=D.getDay(),v<60&&(S=(S+6)%7),s&&(S=vr(D,h))}return R.y=h[0],R.m=h[1],R.d=h[2],R.S=l%60,l=Math.floor(l/60),R.M=l%60,l=Math.floor(l/60),R.H=l,R.q=S,R}r.parse_date_code=z;var ue=new Date(1899,11,31,0,0,0),Y=ue.getTime(),K=new Date(1900,2,1,0,0,0);function pe(a,i){var s=a.getTime();return i?s-=1461*24*60*60*1e3:a>=K&&(s+=24*60*60*1e3),(s-(Y+(a.getTimezoneOffset()-ue.getTimezoneOffset())*6e4))/(24*60*60*1e3)}var Ie=function(){var i=/(?:\.0*|(\.\d*[1-9])0+)$/;function s(x){return x.indexOf(".")==-1?x:x.replace(i,"$1")}var v=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,l=/(E[+-])(\d)$/;function S(x){return x.indexOf("E")==-1?x:x.replace(v,"$1E").replace(l,"$10$2")}function h(x){var O=x<0?12:11,F=s(x.toFixed(12));return F.length<=O||(F=x.toPrecision(10),F.length<=O)?F:x.toExponential(5)}function R(x){var O=s(x.toFixed(11));return O.length>(x<0?12:11)||O==="0"||O==="-0"?x.toPrecision(6):O}function D(x){var O=Math.floor(Math.log(Math.abs(x))*Math.LOG10E),F;return O>=-4&&O<=-1?F=x.toPrecision(10+O):Math.abs(O)<=9?F=h(x):O===10?F=x.toFixed(10).substr(0,12):F=R(x),s(S(F.toUpperCase()))}return D}();r._general_num=Ie;function Le(a,i){switch(typeof a){case"string":return a;case"boolean":return a?"TRUE":"FALSE";case"number":return(a|0)===a?a.toString(10):Ie(a);case"undefined":return"";case"object":if(a==null)return"";if(a instanceof Date)return Bt(14,pe(a,i&&i.date1904),i)}throw new Error("unsupported value in General format: "+a)}r._general=Le;function vr(a,i){i[0]-=581;var s=a.getDay();return a<60&&(s=(s+6)%7),s}var An="\u0E50\u0E51\u0E52\u0E53\u0E54\u0E55\u0E56\u0E57\u0E58\u0E59".split("");function Ir(a,i,s,v){var l="",S=0,h=0,R=s.y,D,x=0;switch(a){case 98:R=s.y+543;case 121:switch(i.length){case 1:case 2:D=R%100,x=2;break;default:D=R%1e4,x=4;break}break;case 109:switch(i.length){case 1:case 2:D=s.m,x=i.length;break;case 3:return M[s.m-1][1];case 5:return M[s.m-1][0];default:return M[s.m-1][2]}break;case 100:switch(i.length){case 1:case 2:D=s.d,x=i.length;break;case 3:return y[s.q][0];default:return y[s.q][1]}break;case 104:switch(i.length){case 1:case 2:D=1+(s.H+11)%12,x=i.length;break;default:throw"bad hour format: "+i}break;case 72:switch(i.length){case 1:case 2:D=s.H,x=i.length;break;default:throw"bad hour format: "+i}break;case 77:switch(i.length){case 1:case 2:D=s.M,x=i.length;break;default:throw"bad minute format: "+i}break;case 115:if(i!="s"&&i!="ss"&&i!=".0"&&i!=".00"&&i!=".000")throw"bad second format: "+i;return s.u===0&&(i=="s"||i=="ss")?n(s.S,i.length):(v>=2?h=v===3?1e3:100:h=v===1?10:1,S=Math.round(h*(s.S+s.u)),S>=60*h&&(S=0),i==="s"?S===0?"0":""+S/h:(l=n(S,2+v),i==="ss"?l.substr(0,2):"."+l.substr(2,i.length-1)));case 90:switch(i){case"[h]":case"[hh]":D=s.D*24+s.H;break;case"[m]":case"[mm]":D=(s.D*24+s.H)*60+s.M;break;case"[s]":case"[ss]":D=((s.D*24+s.H)*60+s.M)*60+(v==0?Math.round(s.S+s.u):s.S);break;default:throw"bad abstime format: "+i}x=i.length===3?1:2;break;case 101:D=R,x=1;break}var O=x>0?n(D,x):"";return O}function de(a){var i=3;if(a.length<=i)return a;for(var s=a.length%i,v=a.substr(0,s);s!=a.length;s+=i)v+=(v.length>0?",":"")+a.substr(s,i);return v}var ae=function(){var i=/%/g;function s(m,c,p){var I=c.replace(i,""),w=c.length-I.length;return ae(m,I,p*Math.pow(10,2*w))+t("%",w)}function v(m,c,p){for(var I=c.length-1;c.charCodeAt(I-1)===44;)--I;return ae(m,c.substr(0,I),p/Math.pow(10,3*(c.length-I)))}function l(m,c){var p,I=m.indexOf("E")-m.indexOf(".")-1;if(m.match(/^#+0.0E\+0$/)){if(c==0)return"0.0E+0";if(c<0)return"-"+l(m,-c);var w=m.indexOf(".");w===-1&&(w=m.indexOf("E"));var C=Math.floor(Math.log(c)*Math.LOG10E)%w;if(C<0&&(C+=w),p=(c/Math.pow(10,C)).toPrecision(I+1+(w+C)%w),p.indexOf("e")===-1){var k=Math.floor(Math.log(c)*Math.LOG10E);for(p.indexOf(".")===-1?p=p.charAt(0)+"."+p.substr(1)+"E+"+(k-p.length+C):p+="E+"+(k-C);p.substr(0,2)==="0.";)p=p.charAt(0)+p.substr(2,w)+"."+p.substr(2+w),p=p.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");p=p.replace(/\+-/,"-")}p=p.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(H,W,G,U){return W+G+U.substr(0,(w+C)%w)+"."+U.substr(C)+"E"})}else p=c.toExponential(I);return m.match(/E\+00$/)&&p.match(/e[+-]\d$/)&&(p=p.substr(0,p.length-1)+"0"+p.charAt(p.length-1)),m.match(/E\-/)&&p.match(/e\+/)&&(p=p.replace(/e\+/,"e")),p.replace("e","E")}var S=/# (\?+)( ?)\/( ?)(\d+)/;function h(m,c,p){var I=parseInt(m[4],10),w=Math.round(c*I),C=Math.floor(w/I),k=w-C*I,H=I;return p+(C===0?"":""+C)+" "+(k===0?t(" ",m[1].length+1+m[4].length):o(k,m[1].length)+m[2]+"/"+m[3]+n(H,m[4].length))}function R(m,c,p){return p+(c===0?"":""+c)+t(" ",m[1].length+2+m[4].length)}var D=/^#*0*\.([0#]+)/,x=/\).*[0#]/,O=/\(###\) ###\\?-####/;function F(m){for(var c="",p,I=0;I!=m.length;++I)switch(p=m.charCodeAt(I)){case 35:break;case 63:c+=" ";break;case 48:c+="0";break;default:c+=String.fromCharCode(p)}return c}function re(m,c){var p=Math.pow(10,c);return""+Math.round(m*p)/p}function me(m,c){var p=m-Math.floor(m),I=Math.pow(10,c);return c<(""+Math.round(p*I)).length?0:Math.round(p*I)}function lt(m,c){return c<(""+Math.round((m-Math.floor(m))*Math.pow(10,c))).length?1:0}function ne(m){return m<2147483647&&m>-2147483648?""+(m>=0?m|0:m-1|0):""+Math.floor(m)}function B(m,c,p){if(m.charCodeAt(0)===40&&!c.match(x)){var I=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return p>=0?B("n",I,p):"("+B("n",I,-p)+")"}if(c.charCodeAt(c.length-1)===44)return v(m,c,p);if(c.indexOf("%")!==-1)return s(m,c,p);if(c.indexOf("E")!==-1)return l(c,p);if(c.charCodeAt(0)===36)return"$"+B(m,c.substr(c.charAt(1)==" "?2:1),p);var w,C,k,H,W=Math.abs(p),G=p<0?"-":"";if(c.match(/^00+$/))return G+d(W,c.length);if(c.match(/^[#?]+$/))return w=d(p,0),w==="0"&&(w=""),w.length>c.length?w:F(c.substr(0,c.length-w.length))+w;if(C=c.match(S))return h(C,W,G);if(c.match(/^#+0+$/))return G+d(W,c.length-c.indexOf("0"));if(C=c.match(D))return w=re(p,C[1].length).replace(/^([^\.]+)$/,"$1."+F(C[1])).replace(/\.$/,"."+F(C[1])).replace(/\.(\d*)$/,function(q,Ae){return"."+Ae+t("0",F(C[1]).length-Ae.length)}),c.indexOf("0.")!==-1?w:w.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),C=c.match(/^(0*)\.(#*)$/))return G+re(W,C[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,C[1].length?"0.":".");if(C=c.match(/^#{1,3},##0(\.?)$/))return G+de(d(W,0));if(C=c.match(/^#,##0\.([#0]*0)$/))return p<0?"-"+B(m,c,-p):de(""+(Math.floor(p)+lt(p,C[1].length)))+"."+n(me(p,C[1].length),C[1].length);if(C=c.match(/^#,#*,#0/))return B(m,c.replace(/^#,#*,/,""),p);if(C=c.match(/^([0#]+)(\\?-([0#]+))+$/))return w=e(B(m,c.replace(/[\\-]/g,""),p)),k=0,e(e(c.replace(/\\/g,"")).replace(/[0#]/g,function(q){return k<w.length?w.charAt(k++):q==="0"?"0":""}));if(c.match(O))return w=B(m,"##########",p),"("+w.substr(0,3)+") "+w.substr(3,3)+"-"+w.substr(6);var U="";if(C=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(C[4].length,7),H=te(W,Math.pow(10,k)-1,!1),w=""+G,U=ae("n",C[1],H[1]),U.charAt(U.length-1)==" "&&(U=U.substr(0,U.length-1)+"0"),w+=U+C[2]+"/"+C[3],U=u(H[2],k),U.length<C[4].length&&(U=F(C[4].substr(C[4].length-U.length))+U),w+=U,w;if(C=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max(C[1].length,C[4].length),7),H=te(W,Math.pow(10,k)-1,!0),G+(H[0]||(H[1]?"":"0"))+" "+(H[1]?o(H[1],k)+C[2]+"/"+C[3]+u(H[2],k):t(" ",2*k+1+C[2].length+C[3].length));if(C=c.match(/^[#0?]+$/))return w=d(p,0),c.length<=w.length?w:F(c.substr(0,c.length-w.length))+w;if(C=c.match(/^([#0?]+)\.([#0]+)$/)){w=""+p.toFixed(Math.min(C[2].length,10)).replace(/([^0])0+$/,"$1"),k=w.indexOf(".");var Me=c.indexOf(".")-k,ct=c.length-w.length-Me;return F(c.substr(0,Me)+w+c.substr(c.length-ct))}if(C=c.match(/^00,000\.([#0]*0)$/))return k=me(p,C[1].length),p<0?"-"+B(m,c,-p):de(ne(p)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(q){return"00,"+(q.length<3?n(0,3-q.length):"")+q})+"."+n(k,C[1].length);switch(c){case"###,##0.00":return B(m,"#,##0.00",p);case"###,###":case"##,###":case"#,###":var Se=de(d(W,0));return Se!=="0"?G+Se:"";case"###,###.00":return B(m,"###,##0.00",p).replace(/^0\./,".");case"#,###.00":return B(m,"#,##0.00",p).replace(/^0\./,".");default:}throw new Error("unsupported format |"+c+"|")}function Ee(m,c,p){for(var I=c.length-1;c.charCodeAt(I-1)===44;)--I;return ae(m,c.substr(0,I),p/Math.pow(10,3*(c.length-I)))}function Fe(m,c,p){var I=c.replace(i,""),w=c.length-I.length;return ae(m,I,p*Math.pow(10,2*w))+t("%",w)}function Q(m,c){var p,I=m.indexOf("E")-m.indexOf(".")-1;if(m.match(/^#+0.0E\+0$/)){if(c==0)return"0.0E+0";if(c<0)return"-"+Q(m,-c);var w=m.indexOf(".");w===-1&&(w=m.indexOf("E"));var C=Math.floor(Math.log(c)*Math.LOG10E)%w;if(C<0&&(C+=w),p=(c/Math.pow(10,C)).toPrecision(I+1+(w+C)%w),!p.match(/[Ee]/)){var k=Math.floor(Math.log(c)*Math.LOG10E);p.indexOf(".")===-1?p=p.charAt(0)+"."+p.substr(1)+"E+"+(k-p.length+C):p+="E+"+(k-C),p=p.replace(/\+-/,"-")}p=p.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(H,W,G,U){return W+G+U.substr(0,(w+C)%w)+"."+U.substr(C)+"E"})}else p=c.toExponential(I);return m.match(/E\+00$/)&&p.match(/e[+-]\d$/)&&(p=p.substr(0,p.length-1)+"0"+p.charAt(p.length-1)),m.match(/E\-/)&&p.match(/e\+/)&&(p=p.replace(/e\+/,"e")),p.replace("e","E")}function X(m,c,p){if(m.charCodeAt(0)===40&&!c.match(x)){var I=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return p>=0?X("n",I,p):"("+X("n",I,-p)+")"}if(c.charCodeAt(c.length-1)===44)return Ee(m,c,p);if(c.indexOf("%")!==-1)return Fe(m,c,p);if(c.indexOf("E")!==-1)return Q(c,p);if(c.charCodeAt(0)===36)return"$"+X(m,c.substr(c.charAt(1)==" "?2:1),p);var w,C,k,H,W=Math.abs(p),G=p<0?"-":"";if(c.match(/^00+$/))return G+n(W,c.length);if(c.match(/^[#?]+$/))return w=""+p,p===0&&(w=""),w.length>c.length?w:F(c.substr(0,c.length-w.length))+w;if(C=c.match(S))return R(C,W,G);if(c.match(/^#+0+$/))return G+n(W,c.length-c.indexOf("0"));if(C=c.match(D))return w=(""+p).replace(/^([^\.]+)$/,"$1."+F(C[1])).replace(/\.$/,"."+F(C[1])),w=w.replace(/\.(\d*)$/,function(q,Ae){return"."+Ae+t("0",F(C[1]).length-Ae.length)}),c.indexOf("0.")!==-1?w:w.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),C=c.match(/^(0*)\.(#*)$/))return G+(""+W).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,C[1].length?"0.":".");if(C=c.match(/^#{1,3},##0(\.?)$/))return G+de(""+W);if(C=c.match(/^#,##0\.([#0]*0)$/))return p<0?"-"+X(m,c,-p):de(""+p)+"."+t("0",C[1].length);if(C=c.match(/^#,#*,#0/))return X(m,c.replace(/^#,#*,/,""),p);if(C=c.match(/^([0#]+)(\\?-([0#]+))+$/))return w=e(X(m,c.replace(/[\\-]/g,""),p)),k=0,e(e(c.replace(/\\/g,"")).replace(/[0#]/g,function(q){return k<w.length?w.charAt(k++):q==="0"?"0":""}));if(c.match(O))return w=X(m,"##########",p),"("+w.substr(0,3)+") "+w.substr(3,3)+"-"+w.substr(6);var U="";if(C=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(C[4].length,7),H=te(W,Math.pow(10,k)-1,!1),w=""+G,U=ae("n",C[1],H[1]),U.charAt(U.length-1)==" "&&(U=U.substr(0,U.length-1)+"0"),w+=U+C[2]+"/"+C[3],U=u(H[2],k),U.length<C[4].length&&(U=F(C[4].substr(C[4].length-U.length))+U),w+=U,w;if(C=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max(C[1].length,C[4].length),7),H=te(W,Math.pow(10,k)-1,!0),G+(H[0]||(H[1]?"":"0"))+" "+(H[1]?o(H[1],k)+C[2]+"/"+C[3]+u(H[2],k):t(" ",2*k+1+C[2].length+C[3].length));if(C=c.match(/^[#0?]+$/))return w=""+p,c.length<=w.length?w:F(c.substr(0,c.length-w.length))+w;if(C=c.match(/^([#0]+)\.([#0]+)$/)){w=""+p.toFixed(Math.min(C[2].length,10)).replace(/([^0])0+$/,"$1"),k=w.indexOf(".");var Me=c.indexOf(".")-k,ct=c.length-w.length-Me;return F(c.substr(0,Me)+w+c.substr(c.length-ct))}if(C=c.match(/^00,000\.([#0]*0)$/))return p<0?"-"+X(m,c,-p):de(""+p).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(q){return"00,"+(q.length<3?n(0,3-q.length):"")+q})+"."+n(0,C[1].length);switch(c){case"###,###":case"##,###":case"#,###":var Se=de(""+W);return Se!=="0"?G+Se:"";default:if(c.match(/\.[0#?]*$/))return X(m,c.slice(0,c.lastIndexOf(".")),p)+F(c.slice(c.lastIndexOf(".")))}throw new Error("unsupported format |"+c+"|")}return function(c,p,I){return(I|0)===I?X(c,p,I):B(c,p,I)}}();function _t(a){for(var i=[],s=!1,v=0,l=0;v<a.length;++v)switch(a.charCodeAt(v)){case 34:s=!s;break;case 95:case 42:case 92:++v;break;case 59:i[i.length]=a.substr(l,v-l),l=v+1}if(i[i.length]=a.substr(l),s===!0)throw new Error("Format |"+a+"| unterminated string ");return i}r._split=_t;var Ot=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Nt(a){for(var i=0,s="",v="";i<a.length;)switch(s=a.charAt(i)){case"G":E(a,i)&&(i+=6),i++;break;case'"':for(;a.charCodeAt(++i)!==34&&i<a.length;);++i;break;case"\\":i+=2;break;case"_":i+=2;break;case"@":++i;break;case"B":case"b":if(a.charAt(i+1)==="1"||a.charAt(i+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(a.substr(i,3).toUpperCase()==="A/P"||a.substr(i,5).toUpperCase()==="AM/PM"||a.substr(i,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++i;break;case"[":for(v=s;a.charAt(i++)!=="]"&&i<a.length;)v+=a.charAt(i);if(v.match(Ot))return!0;break;case".":case"0":case"#":for(;i<a.length&&("0#?.,E+-%".indexOf(s=a.charAt(++i))>-1||s=="\\"&&a.charAt(i+1)=="-"&&"0#".indexOf(a.charAt(i+2))>-1););break;case"?":for(;a.charAt(++i)===s;);break;case"*":++i,(a.charAt(i)==" "||a.charAt(i)=="*")&&++i;break;case"(":case")":++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;i<a.length&&"0123456789".indexOf(a.charAt(++i))>-1;);break;case" ":++i;break;default:++i;break}return!1}r.is_date=Nt;function Lt(a,i,s,v){for(var l=[],S="",h=0,R="",D="t",x,O,F,re="H";h<a.length;)switch(R=a.charAt(h)){case"G":if(!E(a,h))throw new Error("unrecognized character "+R+" in "+a);l[l.length]={t:"G",v:"General"},h+=7;break;case'"':for(S="";(F=a.charCodeAt(++h))!==34&&h<a.length;)S+=String.fromCharCode(F);l[l.length]={t:"t",v:S},++h;break;case"\\":var me=a.charAt(++h),lt=me==="("||me===")"?me:"t";l[l.length]={t:lt,v:me},++h;break;case"_":l[l.length]={t:"t",v:" "},h+=2;break;case"@":l[l.length]={t:"T",v:i},++h;break;case"B":case"b":if(a.charAt(h+1)==="1"||a.charAt(h+1)==="2"){if(x==null&&(x=z(i,s,a.charAt(h+1)==="2"),x==null))return"";l[l.length]={t:"X",v:a.substr(h,2)},D=R,h+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":R=R.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(i<0||x==null&&(x=z(i,s),x==null))return"";for(S=R;++h<a.length&&a.charAt(h).toLowerCase()===R;)S+=R;R==="m"&&D.toLowerCase()==="h"&&(R="M"),R==="h"&&(R=re),l[l.length]={t:R,v:S},D=R;break;case"A":case"a":case"\u4E0A":var ne={t:R,v:R};if(x==null&&(x=z(i,s)),a.substr(h,3).toUpperCase()==="A/P"?(x!=null&&(ne.v=x.H>=12?a.charAt(h+2):R),ne.t="T",re="h",h+=3):a.substr(h,5).toUpperCase()==="AM/PM"?(x!=null&&(ne.v=x.H>=12?"PM":"AM"),ne.t="T",h+=5,re="h"):a.substr(h,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(x!=null&&(ne.v=x.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),ne.t="T",h+=5,re="h"):(ne.t="t",++h),x==null&&ne.t==="T")return"";l[l.length]=ne,D=R;break;case"[":for(S=R;a.charAt(h++)!=="]"&&h<a.length;)S+=a.charAt(h);if(S.slice(-1)!=="]")throw'unterminated "[" block: |'+S+"|";if(S.match(Ot)){if(x==null&&(x=z(i,s),x==null))return"";l[l.length]={t:"Z",v:S.toLowerCase()},D=S.charAt(1)}else S.indexOf("$")>-1&&(S=(S.match(/\$([^-\[\]]*)/)||[])[1]||"$",Nt(a)||(l[l.length]={t:"t",v:S}));break;case".":if(x!=null){for(S=R;++h<a.length&&(R=a.charAt(h))==="0";)S+=R;l[l.length]={t:"s",v:S};break}case"0":case"#":for(S=R;++h<a.length&&"0#?.,E+-%".indexOf(R=a.charAt(h))>-1;)S+=R;l[l.length]={t:"n",v:S};break;case"?":for(S=R;a.charAt(++h)===R;)S+=R;l[l.length]={t:R,v:S},D=R;break;case"*":++h,(a.charAt(h)==" "||a.charAt(h)=="*")&&++h;break;case"(":case")":l[l.length]={t:v===1?"t":R,v:R},++h;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(S=R;h<a.length&&"0123456789".indexOf(a.charAt(++h))>-1;)S+=a.charAt(h);l[l.length]={t:"D",v:S};break;case" ":l[l.length]={t:R,v:R},++h;break;case"$":l[l.length]={t:"t",v:"$"},++h;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(R)===-1)throw new Error("unrecognized character "+R+" in "+a);l[l.length]={t:"t",v:R},++h;break}var B=0,Ee=0,Fe;for(h=l.length-1,D="t";h>=0;--h)switch(l[h].t){case"h":case"H":l[h].t=re,D="h",B<1&&(B=1);break;case"s":(Fe=l[h].v.match(/\.0+$/))&&(Ee=Math.max(Ee,Fe[0].length-1),B=4),B<3&&(B=3);case"d":case"y":case"e":D=l[h].t;break;case"M":D=l[h].t,B<2&&(B=2);break;case"m":D==="s"&&(l[h].t="M",B<2&&(B=2));break;case"X":break;case"Z":B<1&&l[h].v.match(/[Hh]/)&&(B=1),B<2&&l[h].v.match(/[Mm]/)&&(B=2),B<3&&l[h].v.match(/[Ss]/)&&(B=3)}var Q;switch(B){case 0:break;case 1:case 2:case 3:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H),x.H>=24&&(x.H=0,++x.D,Q=z(x.D),Q.u=x.u,Q.S=x.S,Q.M=x.M,Q.H=x.H,x=Q);break;case 4:switch(Ee){case 1:x.u=Math.round(x.u*10)/10;break;case 2:x.u=Math.round(x.u*100)/100;break;case 3:x.u=Math.round(x.u*1e3)/1e3;break}x.u>=1&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H),x.H>=24&&(x.H=0,++x.D,Q=z(x.D),Q.u=x.u,Q.S=x.S,Q.M=x.M,Q.H=x.H,x=Q);break}var X="",m;for(h=0;h<l.length;++h)switch(l[h].t){case"t":case"T":case" ":case"D":break;case"X":l[h].v="",l[h].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[h].v=Ir(l[h].t.charCodeAt(0),l[h].v,x,Ee),l[h].t="t";break;case"n":case"?":for(m=h+1;l[m]!=null&&((R=l[m].t)==="?"||R==="D"||(R===" "||R==="t")&&l[m+1]!=null&&(l[m+1].t==="?"||l[m+1].t==="t"&&l[m+1].v==="/")||l[h].t==="("&&(R===" "||R==="n"||R===")")||R==="t"&&(l[m].v==="/"||l[m].v===" "&&l[m+1]!=null&&l[m+1].t=="?"));)l[h].v+=l[m].v,l[m]={v:"",t:";"},++m;X+=l[h].v,h=m-1;break;case"G":l[h].t="t",l[h].v=Le(i,s);break}var c="",p,I;if(X.length>0){X.charCodeAt(0)==40?(p=i<0&&X.charCodeAt(0)===45?-i:i,I=ae("n",X,p)):(p=i<0&&v>1?-i:i,I=ae("n",X,p),p<0&&l[0]&&l[0].t=="t"&&(I=I.substr(1),l[0].v="-"+l[0].v)),m=I.length-1;var w=l.length;for(h=0;h<l.length;++h)if(l[h]!=null&&l[h].t!="t"&&l[h].v.indexOf(".")>-1){w=h;break}var C=l.length;if(w===l.length&&I.indexOf("E")===-1){for(h=l.length-1;h>=0;--h)l[h]==null||"n?".indexOf(l[h].t)===-1||(m>=l[h].v.length-1?(m-=l[h].v.length,l[h].v=I.substr(m+1,l[h].v.length)):m<0?l[h].v="":(l[h].v=I.substr(0,m+1),m=-1),l[h].t="t",C=h);m>=0&&C<l.length&&(l[C].v=I.substr(0,m+1)+l[C].v)}else if(w!==l.length&&I.indexOf("E")===-1){for(m=I.indexOf(".")-1,h=w;h>=0;--h)if(!(l[h]==null||"n?".indexOf(l[h].t)===-1)){for(O=l[h].v.indexOf(".")>-1&&h===w?l[h].v.indexOf(".")-1:l[h].v.length-1,c=l[h].v.substr(O+1);O>=0;--O)m>=0&&(l[h].v.charAt(O)==="0"||l[h].v.charAt(O)==="#")&&(c=I.charAt(m--)+c);l[h].v=c,l[h].t="t",C=h}for(m>=0&&C<l.length&&(l[C].v=I.substr(0,m+1)+l[C].v),m=I.indexOf(".")+1,h=w;h<l.length;++h)if(!(l[h]==null||"n?(".indexOf(l[h].t)===-1&&h!==w)){for(O=l[h].v.indexOf(".")>-1&&h===w?l[h].v.indexOf(".")+1:0,c=l[h].v.substr(0,O);O<l[h].v.length;++O)m<I.length&&(c+=I.charAt(m++));l[h].v=c,l[h].t="t",C=h}}}for(h=0;h<l.length;++h)l[h]!=null&&"n?".indexOf(l[h].t)>-1&&(p=v>1&&i<0&&h>0&&l[h-1].v==="-"?-i:i,l[h].v=ae(l[h].t,l[h].v,p),l[h].t="t");var k="";for(h=0;h!==l.length;++h)l[h]!=null&&(k+=l[h].v);return k}r._eval=Lt;var Ft=/\[[=<>]/,Pt=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $t(a,i){if(i==null)return!1;var s=parseFloat(i[2]);switch(i[1]){case"=":if(a==s)return!0;break;case">":if(a>s)return!0;break;case"<":if(a<s)return!0;break;case"<>":if(a!=s)return!0;break;case">=":if(a>=s)return!0;break;case"<=":if(a<=s)return!0;break}return!1}function Ut(a,i){var s=_t(a),v=s.length,l=s[v-1].indexOf("@");if(v<4&&l>-1&&--v,s.length>4)throw new Error("cannot find right format for |"+s.join("|")+"|");if(typeof i!="number")return[4,s.length===4||l>-1?s[s.length-1]:"@"];switch(s.length){case 1:s=l>-1?["General","General","General",s[0]]:[s[0],s[0],s[0],"@"];break;case 2:s=l>-1?[s[0],s[0],s[0],s[1]]:[s[0],s[1],s[0],"@"];break;case 3:s=l>-1?[s[0],s[1],s[0],s[2]]:[s[0],s[1],s[2],"@"];break;case 4:break}var S=i>0?s[0]:i<0?s[1]:s[2];if(s[0].indexOf("[")===-1&&s[1].indexOf("[")===-1)return[v,S];if(s[0].match(Ft)!=null||s[1].match(Ft)!=null){var h=s[0].match(Pt),R=s[1].match(Pt);return $t(i,h)?[v,s[0]]:$t(i,R)?[v,s[1]]:[v,s[h!=null&&R!=null?2:1]]}return[v,S]}function Bt(a,i,s){s==null&&(s={});var v="";switch(typeof a){case"string":a=="m/d/yy"&&s.dateNF?v=s.dateNF:v=a;break;case"number":a==14&&s.dateNF?v=s.dateNF:v=(s.table!=null?s.table:_)[a],v==null&&(v=s.table&&s.table[L[a]]||_[L[a]]),v==null&&(v=J[a]||"General");break}if(E(v,0))return Le(i,s);i instanceof Date&&(i=pe(i,s.date1904));var l=Ut(v,i);if(E(l[1]))return Le(i,s);if(i===!0)i="TRUE";else if(i===!1)i="FALSE";else if(i===""||i==null)return"";return Lt(l[1],i,s,l[0])}function Ht(a,i){if(typeof i!="number"){i=+i||-1;for(var s=0;s<392;++s){if(_[s]==null){i<0&&(i=s);continue}if(_[s]==a){i=s;break}}i<0&&(i=391)}return _[i]=a,i}r.load=Ht,r._table=_,r.get_table=function(){return _},r.load_table=function(i){for(var s=0;s!=392;++s)i[s]!==void 0&&Ht(i[s],s)},r.init_table=N,r.format=Bt,r.choose_format=Ut}Tn(mr);typeof vt<"u"&&typeof DO_NOT_EXPORT_SSF>"u"&&(vt.exports=mr)});var xe=12,Gt="sans-serif";var ht=22,Pe=76;var kn=Pe/2,ut=0;var De="&#10;";var pt=16384,dt=1048576;var $e="=",Ue="_";var ke=256;var ft=9;var _e="General";var Be=new Set(["#GETTING_DATA","#DIV/0!","#NULL!","#NUM!","#REF!","#VALUE!","#N/A","#NAME?"]),A=1,He={thin:A,hair:A,dotted:A,dashed:A,dashDot:A,dashDotDot:A,double:A,medium:A*2,mediumDashed:A*2,mediumDashDot:A*2,mediumDashDotDot:A*2,thick:A*4};function fe(r){if(typeof r=="boolean")return[!0,Number(r)];if(typeof r=="number"&&!isNaN(r))return[!0,r];if(typeof r!="string")return[!1,0];if(r.length>12)return[!1,0];let e=Number(r);return isNaN(e)?[!1,0]:[!0,e]}function We(r,e){return`${r}${Ue}${e}`}function zt(r){let[e,t]=r.split(Ue),n=parseInt(e,10),o=parseInt(t,10);return{row:isNaN(n)?-1:n,col:isNaN(o)?-1:o}}function gt(r,e){return`${r}${Ue}${e}`}function Vt(){return!1}function Xt(r){return!!(typeof r=="string"&&r&&r.startsWith($e)&&r.length>1)}function jt(r,e){return r&&e.includes(De)}var P=class extends Error{constructor(e){super(e),this.value=e}};function Z(r,e="#VALUE!"){if(!r)throw new P(e)}function Ge(r){Z(r.length===1);let[e]=r;return e}function be(r){let e=Ge(r);return Z(typeof e=="string"),e}function j(r){let e=Ge(r),[t,n]=fe(e);return Z(t),n}function mt(r){Z(r.length===0)}function ze(r){let e=r.toUpperCase();return/^[A-Z]+\d+$/.test(e)||/^[A-Z]+$/.test(e)}var Lr=(...r)=>{let e=Ge(r);return typeof e=="string"?e:""},Fr=(...r)=>be(r).toLowerCase(),Jt=(...r)=>{let e=j(r);return String.fromCharCode(e)},Kt=(...r)=>be(r).charCodeAt(0),Pr=(...r)=>be(r).length,$r=(...r)=>{Z(r.length===2);let[e,t]=r;return Z(typeof e=="string"),Z(typeof t=="string"),e.split(t)},Ur=(...r)=>be(r).toUpperCase(),Br=(...r)=>be(r).replace(/ +/g," ").trim(),Qt=(...r)=>(Z(r.length<=ke),r.join("")),Hr={CONCAT:Qt,CONCATENATE:Qt,SPLIT:$r,CHAR:Jt,CODE:Kt,UNICHAR:Jt,UNICODE:Kt,LEN:Pr,LOWER:Fr,UPPER:Ur,TRIM:Br,T:Lr},Zt=Hr;function Yt(r){let e=[];for(let t=0;t<r.length;t++){let[n,o]=fe(r[t]);n&&e.push(o)}return e}var Wr=(...r)=>{let e=j(r);return Math.abs(e)},Gr=(...r)=>{let e=j(r);return Math.acos(e)},zr=(...r)=>{let e=j(r);return Math.log(e+Math.sqrt(e*e-1))},Vr=(...r)=>{let e=j(r);return Math.atan(1/e)},Xr=(...r)=>{let e=j(r);return .5*Math.log((e+1)/(e-1))},jr=(...r)=>{let e=j(r);return Math.asin(e)},Jr=(...r)=>{let e=j(r);return Math.log(e+Math.sqrt(e*e+1))},Kr=(...r)=>{let e=j(r);return Math.atan(e)},Qr=(...r)=>{Z(r.length===2);let[e,t]=r;return Z(typeof e=="number"),Z(typeof t=="number"),Math.atan2(e,t)},Zr=(...r)=>{let e=j(r);return Math.log((1+e)/(e+1))/2},Yr=(...r)=>{let e=Yt(r);return Z(e.length<=ke&&e.length>=1),e.reduce((t,n)=>t+n,0)/e.length},qr=(...r)=>{let e=j(r);return Math.cos(e)},en=(...r)=>{let e=j(r);return 1/Math.tan(e)};var tn=(...r)=>{let e=j(r);return Math.exp(e)},rn=(...r)=>{let e=j(r);return Math.floor(e)};var nn=(...r)=>(mt(r),Math.PI),on=(...r)=>(mt(r),Math.E),sn=(...r)=>{let e=j(r);return Math.sin(e)},an=(...r)=>{let e=Yt(r);return Z(e.length<=ke),e.reduce((t,n)=>t+n,0)},ln={ABS:Wr,ACOS:Gr,ACOSH:zr,ACOT:Vr,ACOTH:Xr,ASIN:jr,ASINH:Jr,ATAN:Kr,ATAN2:Qr,ATANH:Zr,AVERAGE:Yr,COT:en,COS:qr,EXP:tn,INT:rn,PI:nn,E:on,SIN:sn,SUM:an},qt=ln;function er(r){let e=String(r),t=/[.](\d*)/.exec(e);if(t&&t[1]){let n=Math.pow(10,Math.min(t[1].length,ft)),o=e.split("."),u=o[0]+o[1].slice(0,ft);return Number(u)/n}else return r}var cn={...Zt,...qt},Oe=cn;var ie=class{constructor(e,t){this.type=e,this.value=t}toString(){return this.value}};function tr(r){let e=r.toUpperCase(),t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)-64+t*26;return t-1}function xt(r){let e=r+1,t="",n=Math.floor(Math.abs(e)),o;for(;n>0;)o=(n-1)%26,t=String.fromCharCode(65+o)+t,n=Math.floor((n-o)/26);return t.toUpperCase()}function rr(r){let e=parseInt(r,10);return isNaN(e)?e=-1:e=Math.max(e-1,-1),e}function we(r){return Re(r)&&Te(r)}function Re(r){return r.colCount===0}function Te(r){return r.rowCount===0}function nr(r,e){if(r.colCount===0&&e.colCount!==0||r.rowCount===0&&e.rowCount!==0)return!1;if(e.colCount===0&&e.row===r.row||e.rowCount===0&&e.col===r.col)return!0;let{row:t,col:n}=r;return t>=e.row&&t<e.row+e.rowCount&&n>=e.col&&n<e.col+e.colCount}var le=class r{constructor(e,t,n,o,u){this.row=0;this.col=0;this.colCount=0;this.rowCount=0;this.sheetId="";this.row=e,this.col=t,this.colCount=o,this.rowCount=n,this.sheetId=u}static makeRange(e){return new r(e.row,e.col,e.rowCount,e.colCount,e.sheetId)}toIRange(){return{row:this.row,col:this.col,rowCount:this.rowCount,colCount:this.colCount,sheetId:this.sheetId}}};function or(r,e,t){let{row:n,col:o,rowCount:u,colCount:f}=r;if(!e)return;if(we(r)){for(let d=0;d<e.rowCount;d++)for(let E=0;E<e.colCount;E++)if(t(d,E))return;return}if(Re(r)){for(let d=0;d<e.colCount;d++)if(t(n,d))return;return}if(Te(r)){for(let d=0;d<e.rowCount;d++)if(t(d,o))return;return}let g=n+u,b=o+f;for(let d=n;d<g;d++)for(let E=o;E<b;E++)if(t(d,E))return}var Ve=r=>r>="a"&&r<="z"||r>="A"&&r<="Z",ce=r=>r>="0"&&r<="9";function hn(r){return r}function ir(r,e){if(!r)return;let t=r.trim(),[n,o=""]=t.split("!");t.includes("!")||(n="",o=t),n&&n[0]==="'"&&n[n.length-1]==="'"&&(n=n.slice(1,-1));let u=0,f="",g="";for(o[u]==="$"&&u++;u<o.length&&Ve(o[u]);)g+=o[u++];for(o[u]==="$"&&u++;u<o.length&&ce(o[u]);)f+=o[u++];if(u!==o.length||!f&&!g)return;let b=1,d=1,E=-1,y=-1;return f===""?(b=0,E=0):E=rr(f),g===""?(d=0,y=0):y=tr(g),E<0||y<0||y>=pt||E>=dt?void 0:new le(E,y,b,d,e(n))}function ar(r,e=hn){let[t,n]=r.split(":"),o=ir(t,e);if(!o)return;let u=ir(n,e);return u?(u.sheetId=o.sheetId,Ct(o,u)):o}function Ct(r,e){if(r.sheetId!==e.sheetId)return;if(r.row===e.row&&r.col===e.col&&r.rowCount===e.rowCount&&r.colCount===e.colCount)return r;if(r.rowCount===0&&e.rowCount!==0||r.rowCount!==0&&e.rowCount===0||r.colCount===0&&e.colCount!==0||r.colCount!==0&&e.colCount===0)return;let t=Math.abs(r.row-e.row)+1,n=Math.abs(r.col-e.col)+1,o=r.row<e.row?r.row:e.row,u=r.col<e.col?r.col:e.col;return new le(o,u,t,n,r.sheetId)}function sr(r,e){let t=-1;if(r.startsWith("[")){let n=parseInt(r.slice(1,-1),10);isNaN(n)||(t=e+n)}else{let n=parseInt(r,10);isNaN(n)||(t=n-1)}return isNaN(t)?-1:t}function lr(r,e={row:-1,col:-1}){let t=r.toUpperCase();if(t[0]!=="R")return;let n=t.slice(1).split("C");if(n.length!==2)return;let[o,u]=n,f=-1,g=-1;return o?f=sr(o,e.row):f=e.row,u?g=sr(u,e.col):g=e.col,g>=pt||f>=dt||f<0||g<0?void 0:new le(f,g,1,1,"")}var cr="",un=new Map([["TRUE",20],["FALSE",21]]),Xe=class{constructor(e){this.current=0;this.start=0;this.tokens=[];this.list=[...e]}scan(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();return this.tokens.push(new ie(31,"")),this.tokens.length>0&&this.tokens[0].type===0&&this.tokens.shift(),this.tokens}peek(){return this.isAtEnd()?cr:this.list[this.current]}match(e){return this.peek()!==e?!1:(this.next(),!0)}next(){return this.isAtEnd()?cr:this.list[this.current++]}isAtEnd(){return this.current>=this.list.length}addToken(e){let t=this.list.slice(this.start,this.current).join("");this.tokens.push(new ie(e,t))}string(e){for(;!this.isAtEnd()&&this.peek()!==e;)this.next();if(this.peek()!==e)throw new P("#VALUE!");this.next();let t=this.list.slice(this.start+1,this.current-1).join("");this.tokens.push(new ie(17,t))}getDigits(){for(;!this.isAtEnd()&&ce(this.peek());)this.next()}getAlphas(){for(;!this.isAtEnd()&&Ve(this.peek());)this.next()}matchR1C1(){if(this.match("[")){if(this.match("-"),ce(this.peek()))this.getDigits();else throw new P("#VALUE!");if(this.peek()!=="]")throw new P("#VALUE!");this.next()}else this.getDigits()}matchScientificCounting(e){if(this.match("E")||this.match("e")){if(this.match("+")||this.match("-"))return this.getDigits(),this.addToken(e?18:19),!0;if(ce(this.peek()))return this.getDigits(),this.addToken(e?18:19),!0;throw new P("#VALUE!")}return!1}number(){if(this.getDigits(),this.matchScientificCounting(!1))return;let t=!1;this.match(".")&&(t=!0,this.getDigits()),!this.matchScientificCounting(!0)&&this.addToken(t?18:19)}addIdentifier(){for(;!this.isAtEnd()&&this.anyChar(this.peek());)this.next();let e=this.list.slice(this.start,this.current).join(""),t=e.toUpperCase(),n=un.get(t),o=16;n&&(e=t,o=n),/^[A-Z]+\$\d+$/.test(t)&&(e=t,o=29),this.tokens.push(new ie(o,e))}scanToken(){let e=this.next();switch(e){case"$":{Ve(this.peek())?(this.getAlphas(),this.match("$")?ce(this.peek())?(this.getDigits(),this.addToken(30)):this.addIdentifier():ce(this.peek())?(this.getDigits(),this.addToken(29)):this.addToken(30)):ce(this.peek())?(this.getDigits(),this.addToken(30)):this.addIdentifier();break}case"r":case"R":{if(this.matchR1C1(),this.match("C")||this.match("c")){this.matchR1C1();let t=this.list.slice(this.start,this.current).join("").toUpperCase();this.tokens.push(new ie(28,t))}else this.addIdentifier();break}case"(":this.addToken(22);break;case")":this.addToken(23);break;case",":this.addToken(11);break;case":":this.addToken(10);break;case $e:this.addToken(0);break;case"<":this.match(">")?this.addToken(1):this.match("=")?this.addToken(15):this.addToken(14);break;case">":this.match("=")?this.addToken(8):this.addToken(7);break;case"+":this.addToken(2);break;case"-":this.addToken(3);break;case"*":this.addToken(4);break;case"/":this.addToken(5);break;case"^":this.addToken(6);break;case"&":this.addToken(9);break;case"%":this.addToken(13);break;case'"':this.string(e);break;case"'":this.string(e);break;case"!":this.addToken(27);break;case";":this.addToken(26);break;case"{":this.addToken(24);break;case"}":this.addToken(25);break;case" ":break;case"\r":case"	":case`
`:break;default:ce(e)?this.number():this.addIdentifier();break}}anyChar(e){return!'(),:=<>+-*/^&%"{}!'.includes(e)&&!this.isWhiteSpace(e)}isWhiteSpace(e){return e===" "||e==="\r"||e===`
`||e==="	"}};var ge=class{constructor(e,t,n){this.left=e,this.operator=t,this.right=n}accept(e){return e.visitBinaryExpression(this)}handleConcatenate(e){let t=e.toString();return this.operator.type===9&&e instanceof Ce&&e.value.type===17?JSON.stringify(t):t}toString(){let e=this.handleConcatenate(this.left),t=this.handleConcatenate(this.right);return`${e}${this.operator.toString()}${t}`}},je=class{constructor(e,t){this.operator=e,this.right=t}accept(e){return e.visitUnaryExpression(this)}toString(){return this.operator.toString()+this.right.toString()}},Je=class{constructor(e,t){this.operator=e,this.left=t}accept(e){return e.visitPostUnaryExpression(this)}toString(){return this.left.toString()+this.operator.toString()}},Ce=class{constructor(e){this.value=e}accept(e){return e.visitLiteralExpression(this)}toString(){return this.value.toString()}},Ke=class{constructor(e){this.value=e}accept(e){return e.visitR1C1Expression(this)}toString(){return this.value.toString()}},oe=class{constructor(e,t,n){this.value=e,this.sheetName=n,this.type=t}accept(e){return e.visitCellExpression(this)}toString(){let e=this.value.toString().toUpperCase();if(this.sheetName){let t=this.sheetName.toString();return t.includes(" ")&&(t=`'${t}'`),`${t}!${e}`}else return e}},Qe=class{constructor(e,t){this.name=e,this.params=t}accept(e){return e.visitCallExpression(this)}toString(){return`${this.name.toString().toUpperCase()}(${this.params.map(e=>e.toString()).join(",")})`}},Ze=class{constructor(e,t,n){this.left=e,this.operator=t,this.right=n}accept(e){return e.visitCellRangeExpression(this)}toString(){return this.left.toString()+this.operator.toString()+this.right.toString()}},Ye=class{constructor(e){this.value=e}accept(e){return e.visitGroupExpression(this)}toString(){return`(${this.value.toString()})`}},ye=class{constructor(e){this.value=e}accept(e){return e.visitTokenExpression(this)}toString(){return this.value.toString()}},qe=class{constructor(e){this.value=e}accept(e){return e.visitArrayExpression(this)}toString(){return`{${this.value.map(t=>t.toString()).join(",")}}`}};var et=class{constructor(e){this.current=0;this.tokens=e}parse(){let e=[];for(;!this.isAtEnd();)e.push(this.expression());return e}expression(){return this.comparison()}comparison(){let e=this.concatenate();for(;this.match(0,1,7,8,14,15);){let t=this.previous(),n=this.concatenate();e=new ge(e,t,n)}return e}concatenate(){let e=this.term();for(;this.match(9);){let t=this.previous(),n=this.term();e=new ge(e,t,n)}return e}term(){let e=this.factor();for(;this.match(2,3);){let t=this.previous(),n=this.factor();e=new ge(e,t,n)}return e}factor(){let e=this.expo();for(;this.match(5,4);){let t=this.previous(),n=this.expo();e=new ge(e,t,n)}return e}expo(){let e=this.unary();for(;this.match(6);){let t=this.previous(),n=this.unary();e=new ge(e,t,n)}return e}unary(){if(this.match(2,3)){let e=this.previous(),t=this.unary();return new je(e,t)}return this.postUnary()}postUnary(){let e=this.cellRange();if(this.match(13)){let t=this.previous();e=new Je(t,e)}return e}cellRange(){let e=this.sheetRange();for(;this.match(10);){let t=this.previous(),n=this.sheetRange(),o=this.convertToCellExpression(n),u=this.convertToCellExpression(e);e=new Ze(u,t,o)}return e}convertToCellExpression(e){if(e instanceof oe)return e;if(e instanceof ye&&ze(e.value.value))return new oe(e.value,"relative",void 0);if(e instanceof Ce&&e.value.type===19)return new oe(e.value,"relative",void 0);throw new P("#NAME?")}sheetRange(){let e=this.call();if(this.match(27)){let t=this.call();if(e instanceof ye||e instanceof Ce){let n=this.convertToCellExpression(t);return new oe(n.value,n.type,e.value)}}return e}call(){let e=this.primary();for(;this.match(22);)e=this.finishCall(e);return e}finishCall(e){let t=[];if(!this.check(23))do{if(this.peek().type==23)break;t.push(this.expression())}while(this.match(11));return this.expect(23),new Qe(e,t)}primary(){if(this.match(24)){let e=[];do{if(this.peek().type==25)break;e.push(this.expression())}while(this.match(11));return this.expect(25),new qe(e)}if(this.match(22)){let e=this.expression();return this.expect(23),new Ye(e)}if(this.match(19,18,17,20,21))return new Ce(this.previous());if(this.match(30)){let e=this.previous();return new oe(e,"absolute",void 0)}if(this.match(29)){let e=this.previous();return new oe(e,"mixed",void 0)}if(this.match(16)){let e=this.previous(),t=e.value.toUpperCase();if(Be.has(t))throw new P(t);return new ye(e)}if(this.match(28))return new Ke(this.previous());throw new P("#VALUE!")}match(...e){let{type:t}=this.peek();return e.includes(t)?(this.next(),!0):!1}previous(){return this.tokens[this.current-1]}check(e){return this.peek().type===e}expect(e){if(this.check(e))return this.next(),this.previous();throw new P("#VALUE!")}next(){this.current++}isAtEnd(){return this.peek().type===31}peek(){return this.current<this.tokens.length?this.tokens[this.current]:new ie(31,"")}};var tt=class{constructor(e,t,n){this.expressions=e,this.cellDataMap=n,this.currentCoord=t}interpret(){let e=[];for(let t of this.expressions){let n=this.evaluate(t),o=this.getRangeCellValue(n);Array.isArray(o)?e=e.concat(o):e.push(o)}return e}visitBinaryExpression(e){let t=this.evaluate(e.left),n=this.evaluate(e.right);switch(t=this.getOneValue(t),n=this.getOneValue(n),[3,2,5,4,6].includes(e.operator.type)&&(t=this.parseNumber(t),n=this.parseNumber(n)),e.operator.type){case 3:return t-n;case 2:return t+n;case 5:{if(n===0)throw new P("#DIV/0!");return t/n}case 4:return t*n;case 6:return Math.pow(t,n);case 0:return t===n;case 1:return t!==n;case 7:return t>n;case 8:return t>=n;case 14:return t<n;case 15:return t<=n;case 9:return`${t}${n}`;default:throw new P("#TEXT")}}visitCallExpression(e){let t=this.evaluate(e.name);if(t&&typeof t=="function"){let n=[];for(let o of e.params){let u=this.evaluate(o);if(u instanceof le){let f=this.getCellValue(u,!1);n=n.concat(f)}else n.push(u)}return t(...n)}throw new P("#NAME?")}visitR1C1Expression(e){let t=lr(e.value.value,this.currentCoord);if(!t)throw new P("#NAME?");return t}visitCellExpression(e){let t="";if(e.sheetName){let o=this.cellDataMap.getSheetInfo("",e.sheetName.value);if(!o)throw new P("#REF!");t=o.sheetId}let n=ar(e.value.value);if(!n)throw new P("#NAME?");return t&&(n.sheetId=t),n}visitLiteralExpression(e){let{type:t,value:n}=e.value;switch(t){case 17:return n;case 18:case 19:{let[o,u]=fe(n);if(o)return u;throw new P("#VALUE!")}case 20:return!0;case 21:return!1;default:throw new P("#VALUE!")}}visitTokenExpression(e){let{value:t}=e.value,n=t.toLowerCase();if(this.cellDataMap.getDefinedName(n)){let u=this.cellDataMap.getDefinedName(n);return this.getCellValue(u,!0)}let o=this.cellDataMap.getFunction(t.toUpperCase());if(o)return o;if(ze(t))return this.visitCellExpression(new oe(e.value,"relative",void 0));throw new P("#NAME?")}visitUnaryExpression(e){let t=this.evaluate(e.right),n=this.parseNumber(this.getOneValue(t));switch(e.operator.type){case 3:return-n;case 2:return n;default:throw new P("#VALUE!")}}visitCellRangeExpression(e){switch(e.operator.type){case 10:{let t=this.visitCellExpression(e.left),n=this.visitCellExpression(e.right),o=Ct(t,n);if(!o)throw new P("#NAME?");return o}default:throw new P("#NAME?")}}visitGroupExpression(e){return this.evaluate(e.value)}visitArrayExpression(e){let t=[];for(let n of e.value)t.push(this.evaluate(n));return t}visitPostUnaryExpression(e){let t=this.evaluate(e.left),n=this.parseNumber(this.getOneValue(t));switch(e.operator.type){case 13:return n*.01;default:throw new P("#VALUE!")}}evaluate(e){return e.accept(this)}getRangeCellValue(e){if(e instanceof le){if(e.colCount===e.rowCount&&e.colCount===1)return this.getCellValue(e,!0);throw new P("#REF!")}return e}getOneValue(e){let t=this.getRangeCellValue(e);return Array.isArray(t)?t[0]:t}parseNumber(e){let[t,n]=fe(e);if(!t)throw new P("#VALUE!");return n}getCellValue(e,t){let n=[];if(t){let b=this.cellDataMap.getCell(e),d=this.cellDataMap.handleCell(b,{row:e.row,col:e.col});return n=n.concat(d),n}let{row:o,col:u,sheetId:f}=e,g=this.cellDataMap.getSheetInfo(f);if(!g||o>=g.rowCount||u>=g.colCount)throw new P("#REF!");return or(e,g,(b,d)=>{let E=this.cellDataMap.getCell({row:b,col:d,rowCount:1,colCount:1,sheetId:f}),y=this.cellDataMap.handleCell(E,{row:b,col:d});return n=n.concat(y),!1}),n}};function nt(r,e={row:0,col:0},t=new rt,n=new Map){if(n.has(r))return n.get(r);try{t.handleCell=(d,E)=>d?d.formula?nt(d.formula,E,t,n).result:[d.value]:[];let o={result:[],expressionStr:""};n.set(r,o);let u=new Xe(r).scan(),f=new et(u).parse(),g=new tt(f,e,t).interpret(),b=[];for(let d of f)b.push(d.toString());o.expressionStr=b.join("");for(let d of g)typeof d=="number"&&!isNaN(d)?o.result.push(er(d)):o.result.push(d);return o}catch(o){if(o instanceof P){let u={result:[o.value]};return n.set(r,u),u}throw o}}var bt="_test_",rt=class{constructor(){this.map=new Map;this.definedNameMap=new Map;this.currentSheetId=bt;this.sheetList=[{sheetId:bt,name:"_test_",rowCount:200,colCount:30,isHide:!1,sort:1}];this.getFunction=e=>Oe[e];this.handleCell=(e,t)=>e?[e.value]:[]}getKey(e,t,n){return`${e}_${t}_${n||bt}`}setSheetList(e){this.sheetList=e}set(e,t){let{row:n,col:o,sheetId:u}=e;for(let f=0;f<t.length;f++)for(let g=0;g<t[f].length;g++){let b=this.getKey(n+f,o+g,u),d=t[f][g];typeof d=="string"&&Xt(d)?this.map.set(b,{formula:d,value:""}):this.map.set(b,{value:d})}}getCell(e){let{row:t,col:n,sheetId:o}=e,u=this.getKey(t,n,o);return this.map.get(u)}getSheetInfo(e,t){if(t)return this.sheetList.find(o=>o.name===t);let n=e||this.currentSheetId;return this.sheetList.find(o=>o.sheetId===n)}setDefinedName(e,t){this.definedNameMap.set(e,t)}getDefinedName(e){return this.definedNameMap.get(e)}};function wt(r){return r?typeof Intl>"u"||typeof Intl.Segmenter!="function"?[...r]:[...new Intl.Segmenter([],{granularity:"word"}).segment(r)].map(n=>n.segment):[]}var pn={smallFont:"10px",font:"12px",largeFont:"14px",padding:"12px",lineHeight:1.5,mediumPadding:"8px",largePadding:"20px",borderRadius:"4px",borderLargeRadius:"8px",tinyPadding:"4px",scrollBarContent:"30px",formulaBarHeight:"25px"},hr=pn;var dn={lowZIndex:2,middleZIndex:3,highZIndex:4,highestZIndex:9},ur=dn;function fn(r,e,t,n){e=e/100,t=t/100;let o=(1-Math.abs(2*t-1))*e,u=o*(1-Math.abs(r/60%2-1)),f=t-o/2,g,b,d;if(r>=0&&r<60?(g=o,b=u,d=0):r>=60&&r<120?(g=u,b=o,d=0):r>=120&&r<180?(g=0,b=o,d=u):r>=180&&r<240?(g=0,b=u,d=o):r>=240&&r<300?(g=u,b=0,d=o):(g=o,b=0,d=u),n!==1)return`rgba(${g},${b},${d},${n})`;let E=_=>Math.round(_*255).toString(16).padStart(2,"0"),y=E(g+f),M=E(b+f),N=E(d+f);return`#${y}${M}${N}`}var gn=(r,e,t)=>{let n=r/255,o=e/255,u=t/255,f=Math.min(n,o,u),g=Math.max(n,o,u),b=g-f,d=mn(n,o,u),E=Cn(g,f),y=xn(b,E);return[d,y*100,E*100]},mn=(r,e,t)=>{let n=Math.max(r,e,t),o=Math.min(r,e,t),u=n-o,f=0;if(u==0)f=0;else switch(n){case r:{let d=(e-t)/u,E=0;d<0&&(E=360/60),f=d+E;break}case e:{let d=(t-r)/u,E=120/60;f=d+E;break}case t:let g=(r-e)/u,b=240/60;f=g+b;break}return f*60},xn=(r,e)=>r==0?0:r/(1-Math.abs(2*e-1)),Cn=(r,e)=>(r+e)/2,pr=([r,e,t,n])=>{let[o,u,f]=gn(r,e,t);return fn(o,u*.9,100-f,n)};function En(r){r.startsWith("#")&&(r=r.slice(1));let e=parseInt(r.substring(0,2),16),t=parseInt(r.substring(2,4),16),n=parseInt(r.substring(4,6),16),o=parseInt(r.substring(6,8)||"ff",16);return[e,t,n,o/255]}var Rt=r=>{if(r.startsWith("rgb")){let t=r.replace("rgb","").replace("a","").replace("(","").replace(")","").split(",").map(Number);return t.length<=3&&t.push(1),pr(t)}else return pr(En(r))};var Tt=Object.freeze({primaryColor:"#217346",buttonActiveColor:"#c6c6c6",selectionColor:"rgba(198,198,198,0.3)",backgroundColor:"#e6e6e6",hoverColor:"rgba(0, 0, 0, 0.04)",scrollbarColor:"rgba(0, 0, 0, 0.1)",scrollbarHoveColor:"rgba(0, 0, 0, 0.2)",dialogBackground:"rgba(0, 0, 0, 0.6)",white:"#ffffff",black:"#000000",triangleFillColor:"#dddddd",contentColor:"#333333",borderColor:"#cccccc",activeBorderColor:"#808080",errorFormulaColor:"#ff0000"}),dr=Object.freeze(Object.fromEntries(Object.entries(Tt).map(([r,e])=>[r,Rt(e)])));var ot={...hr,...ur},bn="data-theme";function wn(){if(typeof sessionStorage<"u"){let r=sessionStorage.getItem(bn);if(r&&(r==="dark"||r==="light"))return r}return typeof matchMedia=="function"&&matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function V(r,e){return e==="dark"||wn()==="dark"?dr[r]:Tt[r]}var yt;function ve(r=typeof devicePixelRatio>"u"?void 0:devicePixelRatio){return typeof yt=="number"?yt:Math.max(Math.floor(r||1),1)}function $(r){return Math.floor(r*ve())}function fr(r){yt=Math.max(Math.floor(r||1),1)}function gr(r){let e=r||{};return[Object,Array].includes(e.constructor)&&!Object.entries(e).length}function it(r="normal",e="normal",t=xe,n=""){let o=`${r} ${e} ${t}px `,u=[Gt];return Vt()&&u.unshift("Source Code Pro"),n&&u.unshift(n),o+u.join(",")}var It=Nr(xr());function Cr(r,e,t={}){return It.default.format(e||_e,r,t)}function Er(r){return r?It.default.is_date(r):!1}var Mt=new Map;function yn(r,e){let t=`${e}__${r.font}`;if(Mt.has(t))return Mt.get(t);let n=r.measureText(e),{actualBoundingBoxAscent:o,actualBoundingBoxDescent:u}=n,f=o+u,g=n.width,b=Math.ceil(g/ve()),d=Math.ceil(f/ve()),E={width:b,height:d};return Mt.set(t,E),E}function ee(r,e,t,n,o){r.fillRect($(e),$(t),$(n),$(o))}function St(r,e,t,n,o){r.strokeRect($(e),$(t),$(n),$(o))}function At(r,e,t,n,o){r.clearRect($(e),$(t),$(n),$(o))}function st(r,e,t,n){r.fillText(e,$(t),$(n))}function he(r,e){if(e.length!==0){r.beginPath();for(let t=0;t<e.length;t+=2){let n=e[t],o=e[t+1];r.moveTo($(n[0]),$(n[1])),r.lineTo($(o[0]),$(o[1]))}r.stroke()}}function br(r,e,t,n){r.beginPath(),r.moveTo($(e[0]),$(e[1])),r.lineTo($(t[0]),$(t[1])),r.lineTo($(n[0]),$(n[1])),r.fill()}function wr(r,e,t){let n=r.slice(),[o,u]=r,f=A*2,g=t?f:0;return e==="bottom"?n.push([o[0]+g,o[1]-f],[u[0]-g,u[1]-f]):e==="top"?n.push([o[0]+g,o[1]+f],[u[0]-g,u[1]+f]):e==="left"?n.push([o[0]+f,o[1]+g],[u[0]+f,u[1]-g]):e==="right"&&n.push([o[0]-f,o[1]+g],[u[0]-f,u[1]-g]),n}function vn(r,e,t){return t?e?r.split(De):wt(r.replaceAll(De,"")):wt(r)}function Rr(r,e,t,n,o){r.setLineDash([$(8),$(6)]);let u=A;St(r,e+u,t+u,n-u*2,o-u*2),r.setLineDash([])}function In(r){let e=[];return r==="hair"?e=[A,A]:r==="dotted"||r==="mediumDashed"?e=[A*2,A*2]:r==="dashed"?e=[A*4,A*4]:r==="dashDot"||r==="mediumDashDot"?e=[A*4,A*4,A*8,A*4]:(r==="dashDotDot"||r==="mediumDashDotDot")&&(e=[A*4,A*4,A*8,A*4,A*4,A*4]),e}function Ne(r,e,t,n,o){if(!t)return;let{top:u,left:f,width:g,height:b}=e,d=[];n==="top"?d=[[f,u],[f+g,u]]:n==="bottom"?d=[[f,u+b],[f+g,u+b]]:n==="left"?d=[[f,u],[f,u+b]]:n==="right"&&(d=[[f+g,u],[f+g,u+b]]);let{type:E,color:y}=t;r.lineWidth=He[E],r.strokeStyle=y||V("black",o);let M=In(E);E==="double"&&(d=wr(d,n,!0)),M.length>0&&r.setLineDash(M.map(N=>$(N))),he(r,d),M.length>0&&r.setLineDash([])}function Tr(r,e,t,n,o,u){let f={height:0,width:0};if(t===""&&gr(n))return f;let g=n?.numberFormat||_e,b=g===_e&&typeof t=="number",d=Cr(t,g),E=n?.fontSize?n.fontSize:xe,y=it(n?.isItalic?"italic":"normal",n?.isBold?"bold":"500",$(E),n?.fontFamily);n?.fillColor&&(r.fillStyle=n?.fillColor,ee(r,e.left,e.top,e.width,e.height));let M=n?.fontColor||V("contentColor",u);Be.has(d)&&(M=V("errorFormulaColor",u)),r.font=y,r.fillStyle=M;let N=n?{...n}:{},_=N?.horizontalAlign;N?.horizontalAlign===void 0&&b&&(_=2),N.horizontalAlign=_;let J=(!N?.isWrapText&&Er(g)?[d]:vn(d,n?.isWrapText,o)).map(ue=>{let Y=yn(r,ue);return{str:ue,width:Y.width,height:Y.height===0?E:Y.height}}),{width:te,height:se,resultList:z}=Mn(J,e,N,jt(!!o,d));if(te>0&&se>0){let ue=Math.ceil(E*(ot.lineHeight-1)/2),Y=[];for(let K of z){if(st(r,K.text,K.x,K.y),N?.underline){r.strokeStyle=M;let pe=K.y+K.height+ue/2,Ie=[[K.x,pe],[K.x+K.width,pe]];N?.underline===2?Y=Y.concat(wr(Ie,"bottom",!1)):Y=Y.concat(Ie)}if(N?.isStrike){r.strokeStyle=M;let pe=K.y+K.height/2+ue/2;Y=Y.concat([[K.x,pe],[K.x+K.width,pe]])}}he(r,Y)}return f.height=Math.ceil(se),f.width=Math.ceil(te),f}function Mn(r,e,t,n){let o=t?.fontSize?t.fontSize:xe,u=Math.ceil(o*(ot.lineHeight-1)/2),f=t?.verticalAlign??1,{left:g,top:b,height:d}=e,E=Math.max(e.width,...r.map(_=>_.width)),y=[],M=0,N=0;if(t?.isWrapText&&n){let _=0;for(let L=0;L<r.length;L++){let T=r[L];M=Math.max(M,T.width);let J=T.height+u*2;N+=J,y.push({text:T.str,x:0,y:_,width:T.width,height:T.height}),_+=J}}else if(t?.isWrapText){let _=0;for(let L=0;L<r.length;){let T=E,J="",te=0,se=0;for(;L<r.length;){let z=r[L];if(T>=z.width)te+=z.width,se=Math.max(se,z.height),T-=z.width,J+=z.str,L++;else break}if(J){M=Math.max(M,te);let z=se+u*2;N+=z,y.push({text:J,x:0,y:_,width:te,height:se}),_+=z}}}else{let _="",L=E;for(let T=0;T<r.length;T++){let J=r[T];if(L>=J.width)M+=J.width,N=Math.max(N,J.height),_+=J.str,L-=J.width;else break}y.push({text:_,x:0,y:0,width:M,height:N})}if(N=Math.max(N,o*ot.lineHeight),M+=u,N+=u,M<=E&&N<=d){let _=g+u,L=b+(d-N)/2+u;f===0?L=b+u:f===2&&(L=b+(d-N)+u),t?.horizontalAlign===1?_=g+(E-M)/2:t?.horizontalAlign===2&&(_=g+(E-M)-u);for(let T of y)T.x=T.x+_,T.y=T.y+L}return{width:M,height:N,resultList:y}}function Dt(r){return{textAlign:"center",textBaseline:"middle",font:it(void 0,"500",$(xe)),fillStyle:V("black",r),lineWidth:A,strokeStyle:V("borderColor",r)}}var yr=Math.max(...Object.values(He)),at=class{constructor(e){this.width=0;this.height=0;this.isRendering=!1;this.rowMap={};this.colMap={};this.eventData={theme:"light",sheetData:{},canvasSize:{top:0,left:0,width:0,height:0},headerSize:{width:0,height:0},currentSheetInfo:{isHide:!1,rowCount:0,colCount:0,name:"",sheetId:"",tabColor:"",sort:1},scroll:{left:0,top:0,row:0,col:0,scrollLeft:0,scrollTop:0},range:{row:0,col:0,rowCount:1,colCount:1,sheetId:""},copyRange:void 0,customHeight:{},customWidth:{},currentMergeCells:[]};this.canvas=e,this.ctx=e.getContext("2d");let t=ve();this.ctx.scale(t,t)}render(e){if(e.changeSet.size===0||this.isRendering)return;this.isRendering=!0,this.eventData=e,this.clear();let{ctx:t}=this;t.strokeStyle=V("primaryColor",e.theme),t.fillStyle=V("white",e.theme),t.lineWidth=A*2;let{width:n,height:o}=this.eventData.canvasSize,u=this.eventData.headerSize,{endRow:f,contentHeight:g}=this.renderRowsHeader(o),{endCol:b,contentWidth:d}=this.renderColsHeader(n);this.renderGrid(n-u.width,o-u.height),this.renderTriangle(),this.renderMergeCell(),this.ctx.fillStyle=V("selectionColor",this.eventData.theme);let E=this.renderSelection({endRow:f,endCol:b,contentHeight:g,contentWidth:d});return this.renderAntLine(E),this.renderContent({endRow:f,endCol:b,contentHeight:g,contentWidth:d}),this.ctx.lineWidth=yr,St(this.ctx,E.left,E.top,E.width,E.height),this.isRendering=!1,{rowMap:this.rowMap,colMap:this.colMap}}resize(e){this.width=e.width,this.height=e.height,this.canvas.width=$(e.width),this.canvas.height=$(e.height)}clear(){At(this.ctx,0,0,this.width,this.height)}renderRowsHeader(e){let{row:t}=this.eventData.scroll,n=this.eventData.headerSize,{rowCount:o}=this.eventData.currentSheetInfo;this.ctx.save();let u=this.eventData.range;ee(this.ctx,0,n.height,n.width,e),Object.assign(this.ctx,Dt(this.eventData.theme));let f=[],g=n.height,b=t;for(;b<o&&g<e;b++){let E=this.getRowHeight(b),y=g;if(b===t&&(y+=A/2),f.push([0,y],[n.width,y]),E>0){let M=this.isHighlightRow(u,b);this.ctx.fillStyle=M?V("primaryColor",this.eventData.theme):V("black",this.eventData.theme),st(this.ctx,String(b+1),n.width/2,y+E/2)}g+=E}f.push([0,g],[n.width,g]),f.push([0,0],[0,g]),he(this.ctx,f),this.ctx.restore();let d=b>=o?g:e;return{endRow:b,contentHeight:Math.floor(d)}}renderColsHeader(e){let{col:t}=this.eventData.scroll,n=this.eventData.headerSize,{colCount:o}=this.eventData.currentSheetInfo,u=this.eventData.range,f=[];this.ctx.save(),ee(this.ctx,n.width,0,e,n.height),Object.assign(this.ctx,Dt());let g=n.width,b=t;for(;b<o&&g<=e;b++){let E=this.getColWidth(b),y=g;if(b===t&&(y+=A/2),f.push([y,0],[y,n.height]),E>0){let M=this.isHighlightCol(u,b);this.ctx.fillStyle=M?V("primaryColor",this.eventData.theme):V("black",this.eventData.theme),st(this.ctx,xt(b),y+E/2,n.height/2)}g+=E}f.push([g,0],[g,n.height]),f.push([0,0],[g,0]),he(this.ctx,f),this.ctx.restore();let d=b>=o?g:e;return{endCol:b,contentWidth:Math.floor(d)}}renderGrid(e,t){let n=this.eventData.headerSize,{row:o,col:u}=this.eventData.scroll,{rowCount:f,colCount:g}=this.eventData.currentSheetInfo;this.ctx.save(),this.ctx.lineWidth=A,this.ctx.strokeStyle=V("borderColor",this.eventData.theme),this.ctx.translate($(n.width),$(n.height));let b=[],d=0,E=0;for(let y=o;y<f&&d<=t;y++){for(;y<f&&this.getRowHeight(y)===0;)y++;b.push([0,d],[e,d]);let M=this.getRowHeight(y);d+=M}for(let y=u;y<g&&E<=e;y++){for(;y<g&&this.getColWidth(y)===0;)y++;b.push([E,0],[E,d]);let M=this.getColWidth(y);E+=M}b.push([0,d],[E,d]),b.push([E,0],[E,d]),he(this.ctx,b),this.ctx.restore()}renderTriangle(){let e=this.eventData.headerSize;this.ctx.save(),ee(this.ctx,0,0,e.width,e.height),this.ctx.fillStyle=V("triangleFillColor",this.eventData.theme);let t=2,n=Math.floor(t),o=Math.floor(e.height-t),u=Math.floor(e.width*.4),f=Math.floor(e.width-t);br(this.ctx,[f,n],[u,o],[f,o]),this.ctx.restore()}getRowHeight(e){let t=gt(this.eventData.currentSheetInfo.sheetId,e),n=this.eventData.customHeight[t];return n?n.isHide?ut:n.len:ht}getColWidth(e){let t=gt(this.eventData.currentSheetInfo.sheetId,e),n=this.eventData.customWidth[t];return n?n.isHide?ut:n.len:Pe}isHighlightRow(e,t){return!!(we(e)||Te(e)||t>=e.row&&t<e.row+e.rowCount)}isHighlightCol(e,t){return!!(we(e)||Re(e)||t>=e.col&&t<e.col+e.colCount)}renderAntLine(e){let t=this.eventData.copyRange;!t||t.sheetId!==this.eventData.currentSheetInfo.sheetId||(this.ctx.lineWidth=yr,this.ctx.strokeStyle=V("primaryColor",this.eventData.theme),Rr(this.ctx,e.left,e.top,e.width,e.height))}renderMergeCell(){let e=this.eventData.currentMergeCells;if(e.length===0)return;let t=this.eventData.range;for(let n of e)t.row===n.row&&t.col===n.col||this.clearRect(n)}getCellSize(e){let{row:t,col:n,colCount:o,rowCount:u}=e,f=t,g=n,b=t+u,d=n+o,E=this.eventData.currentSheetInfo;we(e)?(g=0,d=E.colCount,f=0,b=E.rowCount):Te(e)?(f=0,b=E.rowCount):Re(e)&&(g=0,d=E.colCount);let y=0,M=0;for(;f<b;f++)M+=this.getRowHeight(f);for(;g<d;g++)y+=this.getColWidth(g);return{width:y,height:M}}computeCellPosition(e){let{row:t,col:n}=e,o=this.eventData.headerSize,u=this.eventData.scroll,f=o.width,g=o.height,b=u.row,d=u.col;if(n>=u.col)for(;d<n;)f+=this.getColWidth(d),d++;else for(f=-o.width;d>n;)f-=this.getColWidth(d),d--;if(t>=u.row)for(;b<t;)g+=this.getRowHeight(b),b++;else for(g=-o.height;b>t;)g-=this.getRowHeight(b),b--;return{top:g,left:f}}getActiveRange(e){let t=e||this.eventData.range,n=this.eventData.currentMergeCells;for(let o of n)if(nr(t,o))return{range:{...o,sheetId:o.sheetId},isMerged:!0};return{range:t,isMerged:!1}}clearRect(e){let t=this.getCellSize(e);if(t.width<=0||t.height<=0)return;let n=this.computeCellPosition(e),o=A;At(this.ctx,n.left+o,n.top+o,t.width-o*2,t.height-o*2)}renderContent(e){let{endCol:t,endRow:n,contentHeight:o,contentWidth:u}=e,{ctx:f}=this;f.textAlign="left",f.textBaseline="top",f.lineWidth=A*2;let g=this.eventData.headerSize,{row:b,col:d}=this.eventData.scroll,E=Math.floor(u-g.width),y=Math.floor(o-g.height);f.save(),this.rowMap={},this.colMap={};let M=this.eventData.currentMergeCells;for(let N=b;N<n;N++)for(let _=d;_<t;_++){let L=M.find(T=>T.row===N&&T.col===_);this.renderCell(N,_,L,E,y)}f.restore()}renderCell(e,t,n,o,u){let{ctx:f}=this,g={row:e,col:t,rowCount:1,colCount:1,sheetId:""},b=We(e,t),d=this.eventData.sheetData[b];if(!d)return;let E=this.getCellSize(n||g);if(E.width<=0||E.height<=0)return;let y=this.computeCellPosition(g);f.lineWidth=A*2;let M=this.eventData.theme,N=Tr(f,{top:y.top,left:y.left,width:Math.min(E.width,o),height:Math.min(E.height,u)},d.value,d.style,!!n,M),_=Math.max(this.rowMap[e]??0,N.height),L=Math.max(this.colMap[t]??0,N.width);_>=ht&&(this.rowMap[e]=_),L>=Pe&&(this.colMap[t]=L);let T={top:y.top,left:y.left,height:Math.max(_,E.height),width:Math.max(L,E.width)};Ne(f,T,d.style?.borderTop,"top",M),Ne(f,T,d.style?.borderBottom,"bottom",M),Ne(f,T,d.style?.borderLeft,"left",M),Ne(f,T,d.style?.borderRight,"right",M)}renderSelection(e){let t=this.eventData.range;return we(t)?this.renderSelectAll(e):Te(t)?this.renderSelectCol(e):Re(t)?this.renderSelectRow(e):this.renderSelectRange()}renderSelectRange(){let e=this.eventData.headerSize,t=this.eventData.range,n=this.computeCellPosition({row:t.row,col:t.col,rowCount:1,colCount:1,sheetId:""}),o=t.row+t.rowCount-1,u=t.col+t.colCount-1,f={row:o,col:u,rowCount:1,colCount:1,sheetId:""},g=this.computeCellPosition(f),b=this.getCellSize(f),d=g.left+b.width-n.left,E=g.top+b.height-n.top;ee(this.ctx,n.left,0,d,e.height),ee(this.ctx,0,n.top,e.width,E);let y=t.rowCount>1||t.colCount>1;y&&ee(this.ctx,n.left,n.top,d,E);let M=[[n.left,e.height],[n.left+d,e.height]];return M.push([e.width,n.top],[e.width,n.top+E]),he(this.ctx,M),y&&this.renderActiveCell(),{left:n.left,top:n.top,width:d,height:E}}renderSelectAll(e){let{contentHeight:t,contentWidth:n}=e,o=this.eventData.headerSize;ee(this.ctx,0,0,n,t),this.renderActiveCell();let u=n-o.width,f=t-o.height;return{left:o.width,top:o.height,width:u,height:f}}renderSelectCol({contentHeight:e}){let t=this.eventData.headerSize,n=this.eventData.range,o=this.computeCellPosition(n),u=0;for(let b=n.col,d=n.col+n.colCount;b<d;b++)u+=this.getColWidth(b);let f=e-t.height;ee(this.ctx,o.left,0,u,e),ee(this.ctx,0,o.top,t.width,f);let g=[[t.width,t.height],[t.width,e]];return he(this.ctx,g),this.renderActiveCell(),{left:o.left,top:t.height,width:u,height:f}}renderSelectRow({contentWidth:e}){let t=this.eventData.headerSize,n=this.eventData.range,o=this.computeCellPosition(n),u=0;for(let b=n.row,d=n.row+n.rowCount;b<d;b++)u+=this.getRowHeight(b);let f=e-t.width-A;ee(this.ctx,o.left,0,f,t.height),ee(this.ctx,0,o.top,e,u);let g=[[o.left,t.height],[e,t.height]];return he(this.ctx,g),this.renderActiveCell(),{left:t.width,top:o.top,width:f,height:u}}renderActiveCell(){let e=this.eventData.range,t=this.getActiveRange({row:e.row,col:e.col,rowCount:1,colCount:1,sheetId:e.sheetId}).range;this.clearRect(t)}};var kt;self.addEventListener("message",r=>{if(r.data.status==="formula"){let t={list:Sn(r.data),status:"formula"};self.postMessage(t)}else if(r.data.status==="init")kt=new at(r.data.canvas),fr(r.data.dpr);else if(r.data.status==="render"){let e=kt.render(r.data);if(e){let t={...e,status:"render"};self.postMessage(t)}}else r.data.status==="resize"&&kt.resize(r.data)});function Sn(r){let{currentSheetId:e,worksheets:t,workbook:n,definedNames:o}=r,u=new Map,f=t[e]||{},g=[],b={handleCell:()=>[],getFunction:d=>Oe[d],getCell:d=>{let{row:E,col:y,sheetId:M}=d,_=t[M||e]||{},L=We(E,y);return _[L]},set:()=>{throw new P("#REF!")},getSheetInfo:(d,E)=>{if(E)return n.find(M=>M.name===E);let y=d||e;return n.find(M=>M.sheetId===y)},setDefinedName:()=>{throw new P("#REF!")},getDefinedName:d=>o[d]};for(let[d,E]of Object.entries(f)){if(!E?.formula)continue;let y=nt(E?.formula,zt(d),b,u);if(!y)continue;let M=y.result[0];M!==E.value&&g.push({key:d,newValue:M,sheetId:e})}return g}
//# sourceMappingURL=worker.js.map
