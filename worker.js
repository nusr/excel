/* 
MIT License

Copyright (c) 2020 Steve Xu

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/
var yr=Object.create;var $t=Object.defineProperty;var vr=Object.getOwnPropertyDescriptor;var Ir=Object.getOwnPropertyNames;var Mr=Object.getPrototypeOf,Sr=Object.prototype.hasOwnProperty;var Ar=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Dr=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Ir(e))!Sr.call(r,a)&&a!==t&&$t(r,a,{get:()=>e[a],enumerable:!(n=vr(e,a))||n.enumerable});return r};var kr=(r,e,t)=>(t=r!=null?yr(Mr(r)):{},Dr(e||!r||!r.__esModule?$t(t,"default",{value:r,enumerable:!0}):t,r));var dr=Ar((Si,wt)=>{"use strict";var pr={};function En(r){r.version="0.11.3";function e(s){for(var o="",i=s.length-1;i>=0;)o+=s.charAt(i--);return o}function t(s,o){for(var i="";i.length<o;)i+=s;return i}function n(s,o){var i=""+s;return i.length>=o?i:t("0",o-i.length)+i}function a(s,o){var i=""+s;return i.length>=o?i:t(" ",o-i.length)+i}function u(s,o){var i=""+s;return i.length>=o?i:i+t(" ",o-i.length)}function d(s,o){var i=""+Math.round(s);return i.length>=o?i:t("0",o-i.length)+i}function g(s,o){var i=""+s;return i.length>=o?i:t("0",o-i.length)+i}var b=Math.pow(2,32);function f(s,o){if(s>b||s<-b)return d(s,o);var i=Math.round(s);return g(i,o)}function w(s,o){return o=o||0,s.length>=7+o&&(s.charCodeAt(o)|32)===103&&(s.charCodeAt(o+1)|32)===101&&(s.charCodeAt(o+2)|32)===110&&(s.charCodeAt(o+3)|32)===101&&(s.charCodeAt(o+4)|32)===114&&(s.charCodeAt(o+5)|32)===97&&(s.charCodeAt(o+6)|32)===108}var y=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],S=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function D(s){s[0]="General",s[1]="0",s[2]="0.00",s[3]="#,##0",s[4]="#,##0.00",s[9]="0%",s[10]="0.00%",s[11]="0.00E+00",s[12]="# ?/?",s[13]="# ??/??",s[14]="m/d/yy",s[15]="d-mmm-yy",s[16]="d-mmm",s[17]="mmm-yy",s[18]="h:mm AM/PM",s[19]="h:mm:ss AM/PM",s[20]="h:mm",s[21]="h:mm:ss",s[22]="m/d/yy h:mm",s[37]="#,##0 ;(#,##0)",s[38]="#,##0 ;[Red](#,##0)",s[39]="#,##0.00;(#,##0.00)",s[40]="#,##0.00;[Red](#,##0.00)",s[45]="mm:ss",s[46]="[h]:mm:ss",s[47]="mmss.0",s[48]="##0.0E+0",s[49]="@",s[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'}var N={};D(N);var _=[],T=0;for(T=5;T<=8;++T)_[T]=32+T;for(T=23;T<=26;++T)_[T]=0;for(T=27;T<=31;++T)_[T]=14;for(T=50;T<=58;++T)_[T]=14;for(T=59;T<=62;++T)_[T]=T-58;for(T=67;T<=68;++T)_[T]=T-58;for(T=72;T<=75;++T)_[T]=T-58;for(T=67;T<=68;++T)_[T]=T-57;for(T=76;T<=78;++T)_[T]=T-56;for(T=79;T<=81;++T)_[T]=T-34;var X={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Y(s,o,i){for(var v=s<0?-1:1,l=s*v,M=0,h=1,R=0,k=1,x=0,L=0,F=Math.floor(l);x<o&&(F=Math.floor(l),R=F*h+M,L=F*x+k,!(l-F<5e-8));)l=1/(l-F),M=h,h=R,k=x,x=L;if(L>o&&(x>o?(L=k,R=M):(L=x,R=h)),!i)return[0,v*R,L];var ne=Math.floor(v*R/L);return[ne,v*R-ne*L,L]}function ee(s){var o=s.toPrecision(16);if(o.indexOf("e")>-1){var i=o.slice(0,o.indexOf("e"));return i=i.indexOf(".")>-1?i.slice(0,i.slice(0,2)=="0."?17:16):i.slice(0,15)+t("0",i.length-15),i+o.slice(o.indexOf("e"))}var v=o.indexOf(".")>-1?o.slice(0,o.slice(0,2)=="0."?17:16):o.slice(0,15)+t("0",o.length-15);return Number(v)}function z(s,o,i){if(s>2958465||s<0)return null;s=ee(s);var v=s|0,l=Math.floor(86400*(s-v)),M=0,h=[],R={D:v,T:l,u:86400*(s-v)-l,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(R.u)<1e-6&&(R.u=0),o&&o.date1904&&(v+=1462),R.u>.9999&&(R.u=0,++l==86400&&(R.T=l=0,++v,++R.D)),v===60)h=i?[1317,10,29]:[1900,2,29],M=3;else if(v===0)h=i?[1317,8,29]:[1900,1,0],M=6;else{v>60&&--v;var k=new Date(1900,0,1);k.setDate(k.getDate()+v-1),h=[k.getFullYear(),k.getMonth()+1,k.getDate()],M=k.getDay(),v<60&&(M=(M+6)%7),i&&(M=Rr(k,h))}return R.y=h[0],R.m=h[1],R.d=h[2],R.S=l%60,l=Math.floor(l/60),R.M=l%60,l=Math.floor(l/60),R.H=l,R.q=M,R}r.parse_date_code=z;var le=new Date(1899,11,31,0,0,0),se=le.getTime(),Z=new Date(1900,2,1,0,0,0);function j(s,o){var i=s.getTime();return o?i-=1461*24*60*60*1e3:s>=Z&&(i+=24*60*60*1e3),(i-(se+(s.getTimezoneOffset()-le.getTimezoneOffset())*6e4))/(24*60*60*1e3)}var de=function(){var o=/(?:\.0*|(\.\d*[1-9])0+)$/;function i(x){return x.indexOf(".")==-1?x:x.replace(o,"$1")}var v=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,l=/(E[+-])(\d)$/;function M(x){return x.indexOf("E")==-1?x:x.replace(v,"$1E").replace(l,"$10$2")}function h(x){var L=x<0?12:11,F=i(x.toFixed(12));return F.length<=L||(F=x.toPrecision(10),F.length<=L)?F:x.toExponential(5)}function R(x){var L=i(x.toFixed(11));return L.length>(x<0?12:11)||L==="0"||L==="-0"?x.toPrecision(6):L}function k(x){var L=Math.floor(Math.log(Math.abs(x))*Math.LOG10E),F;return L>=-4&&L<=-1?F=x.toPrecision(10+L):Math.abs(L)<=9?F=h(x):L===10?F=x.toFixed(10).substr(0,12):F=R(x),i(M(F.toUpperCase()))}return k}();r._general_num=de;function me(s,o){switch(typeof s){case"string":return s;case"boolean":return s?"TRUE":"FALSE";case"number":return(s|0)===s?s.toString(10):de(s);case"undefined":return"";case"object":if(s==null)return"";if(s instanceof Date)return Ft(14,j(s,o&&o.date1904),o)}throw new Error("unsupported value in General format: "+s)}r._general=me;function Rr(s,o){o[0]-=581;var i=s.getDay();return s<60&&(i=(i+6)%7),i}var In="\u0E50\u0E51\u0E52\u0E53\u0E54\u0E55\u0E56\u0E57\u0E58\u0E59".split("");function Tr(s,o,i,v){var l="",M=0,h=0,R=i.y,k,x=0;switch(s){case 98:R=i.y+543;case 121:switch(o.length){case 1:case 2:k=R%100,x=2;break;default:k=R%1e4,x=4;break}break;case 109:switch(o.length){case 1:case 2:k=i.m,x=o.length;break;case 3:return S[i.m-1][1];case 5:return S[i.m-1][0];default:return S[i.m-1][2]}break;case 100:switch(o.length){case 1:case 2:k=i.d,x=o.length;break;case 3:return y[i.q][0];default:return y[i.q][1]}break;case 104:switch(o.length){case 1:case 2:k=1+(i.H+11)%12,x=o.length;break;default:throw"bad hour format: "+o}break;case 72:switch(o.length){case 1:case 2:k=i.H,x=o.length;break;default:throw"bad hour format: "+o}break;case 77:switch(o.length){case 1:case 2:k=i.M,x=o.length;break;default:throw"bad minute format: "+o}break;case 115:if(o!="s"&&o!="ss"&&o!=".0"&&o!=".00"&&o!=".000")throw"bad second format: "+o;return i.u===0&&(o=="s"||o=="ss")?n(i.S,o.length):(v>=2?h=v===3?1e3:100:h=v===1?10:1,M=Math.round(h*(i.S+i.u)),M>=60*h&&(M=0),o==="s"?M===0?"0":""+M/h:(l=n(M,2+v),o==="ss"?l.substr(0,2):"."+l.substr(2,o.length-1)));case 90:switch(o){case"[h]":case"[hh]":k=i.D*24+i.H;break;case"[m]":case"[mm]":k=(i.D*24+i.H)*60+i.M;break;case"[s]":case"[ss]":k=((i.D*24+i.H)*60+i.M)*60+(v==0?Math.round(i.S+i.u):i.S);break;default:throw"bad abstime format: "+o}x=o.length===3?1:2;break;case 101:k=R,x=1;break}var L=x>0?n(k,x):"";return L}function fe(s){var o=3;if(s.length<=o)return s;for(var i=s.length%o,v=s.substr(0,i);i!=s.length;i+=o)v+=(v.length>0?",":"")+s.substr(i,o);return v}var ce=function(){var o=/%/g;function i(m,c,p){var I=c.replace(o,""),E=c.length-I.length;return ce(m,I,p*Math.pow(10,2*E))+t("%",E)}function v(m,c,p){for(var I=c.length-1;c.charCodeAt(I-1)===44;)--I;return ce(m,c.substr(0,I),p/Math.pow(10,3*(c.length-I)))}function l(m,c){var p,I=m.indexOf("E")-m.indexOf(".")-1;if(m.match(/^#+0.0E\+0$/)){if(c==0)return"0.0E+0";if(c<0)return"-"+l(m,-c);var E=m.indexOf(".");E===-1&&(E=m.indexOf("E"));var C=Math.floor(Math.log(c)*Math.LOG10E)%E;if(C<0&&(C+=E),p=(c/Math.pow(10,C)).toPrecision(I+1+(E+C)%E),p.indexOf("e")===-1){var O=Math.floor(Math.log(c)*Math.LOG10E);for(p.indexOf(".")===-1?p=p.charAt(0)+"."+p.substr(1)+"E+"+(O-p.length+C):p+="E+"+(O-C);p.substr(0,2)==="0.";)p=p.charAt(0)+p.substr(2,E)+"."+p.substr(2+E),p=p.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");p=p.replace(/\+-/,"-")}p=p.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(W,G,V,U){return G+V+U.substr(0,(E+C)%E)+"."+U.substr(C)+"E"})}else p=c.toExponential(I);return m.match(/E\+00$/)&&p.match(/e[+-]\d$/)&&(p=p.substr(0,p.length-1)+"0"+p.charAt(p.length-1)),m.match(/E\-/)&&p.match(/e\+/)&&(p=p.replace(/e\+/,"e")),p.replace("e","E")}var M=/# (\?+)( ?)\/( ?)(\d+)/;function h(m,c,p){var I=parseInt(m[4],10),E=Math.round(c*I),C=Math.floor(E/I),O=E-C*I,W=I;return p+(C===0?"":""+C)+" "+(O===0?t(" ",m[1].length+1+m[4].length):a(O,m[1].length)+m[2]+"/"+m[3]+n(W,m[4].length))}function R(m,c,p){return p+(c===0?"":""+c)+t(" ",m[1].length+2+m[4].length)}var k=/^#*0*\.([0#]+)/,x=/\).*[0#]/,L=/\(###\) ###\\?-####/;function F(m){for(var c="",p,I=0;I!=m.length;++I)switch(p=m.charCodeAt(I)){case 35:break;case 63:c+=" ";break;case 48:c+="0";break;default:c+=String.fromCharCode(p)}return c}function ne(m,c){var p=Math.pow(10,c);return""+Math.round(m*p)/p}function xe(m,c){var p=m-Math.floor(m),I=Math.pow(10,c);return c<(""+Math.round(p*I)).length?0:Math.round(p*I)}function nt(m,c){return c<(""+Math.round((m-Math.floor(m))*Math.pow(10,c))).length?1:0}function oe(m){return m<2147483647&&m>-2147483648?""+(m>=0?m|0:m-1|0):""+Math.floor(m)}function B(m,c,p){if(m.charCodeAt(0)===40&&!c.match(x)){var I=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return p>=0?B("n",I,p):"("+B("n",I,-p)+")"}if(c.charCodeAt(c.length-1)===44)return v(m,c,p);if(c.indexOf("%")!==-1)return i(m,c,p);if(c.indexOf("E")!==-1)return l(c,p);if(c.charCodeAt(0)===36)return"$"+B(m,c.substr(c.charAt(1)==" "?2:1),p);var E,C,O,W,G=Math.abs(p),V=p<0?"-":"";if(c.match(/^00+$/))return V+f(G,c.length);if(c.match(/^[#?]+$/))return E=f(p,0),E==="0"&&(E=""),E.length>c.length?E:F(c.substr(0,c.length-E.length))+E;if(C=c.match(M))return h(C,G,V);if(c.match(/^#+0+$/))return V+f(G,c.length-c.indexOf("0"));if(C=c.match(k))return E=ne(p,C[1].length).replace(/^([^\.]+)$/,"$1."+F(C[1])).replace(/\.$/,"."+F(C[1])).replace(/\.(\d*)$/,function(te,De){return"."+De+t("0",F(C[1]).length-De.length)}),c.indexOf("0.")!==-1?E:E.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),C=c.match(/^(0*)\.(#*)$/))return V+ne(G,C[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,C[1].length?"0.":".");if(C=c.match(/^#{1,3},##0(\.?)$/))return V+fe(f(G,0));if(C=c.match(/^#,##0\.([#0]*0)$/))return p<0?"-"+B(m,c,-p):fe(""+(Math.floor(p)+nt(p,C[1].length)))+"."+n(xe(p,C[1].length),C[1].length);if(C=c.match(/^#,#*,#0/))return B(m,c.replace(/^#,#*,/,""),p);if(C=c.match(/^([0#]+)(\\?-([0#]+))+$/))return E=e(B(m,c.replace(/[\\-]/g,""),p)),O=0,e(e(c.replace(/\\/g,"")).replace(/[0#]/g,function(te){return O<E.length?E.charAt(O++):te==="0"?"0":""}));if(c.match(L))return E=B(m,"##########",p),"("+E.substr(0,3)+") "+E.substr(3,3)+"-"+E.substr(6);var U="";if(C=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return O=Math.min(C[4].length,7),W=Y(G,Math.pow(10,O)-1,!1),E=""+V,U=ce("n",C[1],W[1]),U.charAt(U.length-1)==" "&&(U=U.substr(0,U.length-1)+"0"),E+=U+C[2]+"/"+C[3],U=u(W[2],O),U.length<C[4].length&&(U=F(C[4].substr(C[4].length-U.length))+U),E+=U,E;if(C=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return O=Math.min(Math.max(C[1].length,C[4].length),7),W=Y(G,Math.pow(10,O)-1,!0),V+(W[0]||(W[1]?"":"0"))+" "+(W[1]?a(W[1],O)+C[2]+"/"+C[3]+u(W[2],O):t(" ",2*O+1+C[2].length+C[3].length));if(C=c.match(/^[#0?]+$/))return E=f(p,0),c.length<=E.length?E:F(c.substr(0,c.length-E.length))+E;if(C=c.match(/^([#0?]+)\.([#0]+)$/)){E=""+p.toFixed(Math.min(C[2].length,10)).replace(/([^0])0+$/,"$1"),O=E.indexOf(".");var Se=c.indexOf(".")-O,ot=c.length-E.length-Se;return F(c.substr(0,Se)+E+c.substr(c.length-ot))}if(C=c.match(/^00,000\.([#0]*0)$/))return O=xe(p,C[1].length),p<0?"-"+B(m,c,-p):fe(oe(p)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(te){return"00,"+(te.length<3?n(0,3-te.length):"")+te})+"."+n(O,C[1].length);switch(c){case"###,##0.00":return B(m,"#,##0.00",p);case"###,###":case"##,###":case"#,###":var Ae=fe(f(G,0));return Ae!=="0"?V+Ae:"";case"###,###.00":return B(m,"###,##0.00",p).replace(/^0\./,".");case"#,###.00":return B(m,"#,##0.00",p).replace(/^0\./,".");default:}throw new Error("unsupported format |"+c+"|")}function we(m,c,p){for(var I=c.length-1;c.charCodeAt(I-1)===44;)--I;return ce(m,c.substr(0,I),p/Math.pow(10,3*(c.length-I)))}function Ne(m,c,p){var I=c.replace(o,""),E=c.length-I.length;return ce(m,I,p*Math.pow(10,2*E))+t("%",E)}function q(m,c){var p,I=m.indexOf("E")-m.indexOf(".")-1;if(m.match(/^#+0.0E\+0$/)){if(c==0)return"0.0E+0";if(c<0)return"-"+q(m,-c);var E=m.indexOf(".");E===-1&&(E=m.indexOf("E"));var C=Math.floor(Math.log(c)*Math.LOG10E)%E;if(C<0&&(C+=E),p=(c/Math.pow(10,C)).toPrecision(I+1+(E+C)%E),!p.match(/[Ee]/)){var O=Math.floor(Math.log(c)*Math.LOG10E);p.indexOf(".")===-1?p=p.charAt(0)+"."+p.substr(1)+"E+"+(O-p.length+C):p+="E+"+(O-C),p=p.replace(/\+-/,"-")}p=p.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(W,G,V,U){return G+V+U.substr(0,(E+C)%E)+"."+U.substr(C)+"E"})}else p=c.toExponential(I);return m.match(/E\+00$/)&&p.match(/e[+-]\d$/)&&(p=p.substr(0,p.length-1)+"0"+p.charAt(p.length-1)),m.match(/E\-/)&&p.match(/e\+/)&&(p=p.replace(/e\+/,"e")),p.replace("e","E")}function K(m,c,p){if(m.charCodeAt(0)===40&&!c.match(x)){var I=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return p>=0?K("n",I,p):"("+K("n",I,-p)+")"}if(c.charCodeAt(c.length-1)===44)return we(m,c,p);if(c.indexOf("%")!==-1)return Ne(m,c,p);if(c.indexOf("E")!==-1)return q(c,p);if(c.charCodeAt(0)===36)return"$"+K(m,c.substr(c.charAt(1)==" "?2:1),p);var E,C,O,W,G=Math.abs(p),V=p<0?"-":"";if(c.match(/^00+$/))return V+n(G,c.length);if(c.match(/^[#?]+$/))return E=""+p,p===0&&(E=""),E.length>c.length?E:F(c.substr(0,c.length-E.length))+E;if(C=c.match(M))return R(C,G,V);if(c.match(/^#+0+$/))return V+n(G,c.length-c.indexOf("0"));if(C=c.match(k))return E=(""+p).replace(/^([^\.]+)$/,"$1."+F(C[1])).replace(/\.$/,"."+F(C[1])),E=E.replace(/\.(\d*)$/,function(te,De){return"."+De+t("0",F(C[1]).length-De.length)}),c.indexOf("0.")!==-1?E:E.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),C=c.match(/^(0*)\.(#*)$/))return V+(""+G).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,C[1].length?"0.":".");if(C=c.match(/^#{1,3},##0(\.?)$/))return V+fe(""+G);if(C=c.match(/^#,##0\.([#0]*0)$/))return p<0?"-"+K(m,c,-p):fe(""+p)+"."+t("0",C[1].length);if(C=c.match(/^#,#*,#0/))return K(m,c.replace(/^#,#*,/,""),p);if(C=c.match(/^([0#]+)(\\?-([0#]+))+$/))return E=e(K(m,c.replace(/[\\-]/g,""),p)),O=0,e(e(c.replace(/\\/g,"")).replace(/[0#]/g,function(te){return O<E.length?E.charAt(O++):te==="0"?"0":""}));if(c.match(L))return E=K(m,"##########",p),"("+E.substr(0,3)+") "+E.substr(3,3)+"-"+E.substr(6);var U="";if(C=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return O=Math.min(C[4].length,7),W=Y(G,Math.pow(10,O)-1,!1),E=""+V,U=ce("n",C[1],W[1]),U.charAt(U.length-1)==" "&&(U=U.substr(0,U.length-1)+"0"),E+=U+C[2]+"/"+C[3],U=u(W[2],O),U.length<C[4].length&&(U=F(C[4].substr(C[4].length-U.length))+U),E+=U,E;if(C=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return O=Math.min(Math.max(C[1].length,C[4].length),7),W=Y(G,Math.pow(10,O)-1,!0),V+(W[0]||(W[1]?"":"0"))+" "+(W[1]?a(W[1],O)+C[2]+"/"+C[3]+u(W[2],O):t(" ",2*O+1+C[2].length+C[3].length));if(C=c.match(/^[#0?]+$/))return E=""+p,c.length<=E.length?E:F(c.substr(0,c.length-E.length))+E;if(C=c.match(/^([#0]+)\.([#0]+)$/)){E=""+p.toFixed(Math.min(C[2].length,10)).replace(/([^0])0+$/,"$1"),O=E.indexOf(".");var Se=c.indexOf(".")-O,ot=c.length-E.length-Se;return F(c.substr(0,Se)+E+c.substr(c.length-ot))}if(C=c.match(/^00,000\.([#0]*0)$/))return p<0?"-"+K(m,c,-p):fe(""+p).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(te){return"00,"+(te.length<3?n(0,3-te.length):"")+te})+"."+n(0,C[1].length);switch(c){case"###,###":case"##,###":case"#,###":var Ae=fe(""+G);return Ae!=="0"?V+Ae:"";default:if(c.match(/\.[0#?]*$/))return K(m,c.slice(0,c.lastIndexOf(".")),p)+F(c.slice(c.lastIndexOf(".")))}throw new Error("unsupported format |"+c+"|")}return function(c,p,I){return(I|0)===I?K(c,p,I):B(c,p,I)}}();function St(s){for(var o=[],i=!1,v=0,l=0;v<s.length;++v)switch(s.charCodeAt(v)){case 34:i=!i;break;case 95:case 42:case 92:++v;break;case 59:o[o.length]=s.substr(l,v-l),l=v+1}if(o[o.length]=s.substr(l),i===!0)throw new Error("Format |"+s+"| unterminated string ");return o}r._split=St;var At=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Dt(s){for(var o=0,i="",v="";o<s.length;)switch(i=s.charAt(o)){case"G":w(s,o)&&(o+=6),o++;break;case'"':for(;s.charCodeAt(++o)!==34&&o<s.length;);++o;break;case"\\":o+=2;break;case"_":o+=2;break;case"@":++o;break;case"B":case"b":if(s.charAt(o+1)==="1"||s.charAt(o+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(s.substr(o,3).toUpperCase()==="A/P"||s.substr(o,5).toUpperCase()==="AM/PM"||s.substr(o,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++o;break;case"[":for(v=i;s.charAt(o++)!=="]"&&o<s.length;)v+=s.charAt(o);if(v.match(At))return!0;break;case".":case"0":case"#":for(;o<s.length&&("0#?.,E+-%".indexOf(i=s.charAt(++o))>-1||i=="\\"&&s.charAt(o+1)=="-"&&"0#".indexOf(s.charAt(o+2))>-1););break;case"?":for(;s.charAt(++o)===i;);break;case"*":++o,(s.charAt(o)==" "||s.charAt(o)=="*")&&++o;break;case"(":case")":++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;o<s.length&&"0123456789".indexOf(s.charAt(++o))>-1;);break;case" ":++o;break;default:++o;break}return!1}r.is_date=Dt;function kt(s,o,i,v){for(var l=[],M="",h=0,R="",k="t",x,L,F,ne="H";h<s.length;)switch(R=s.charAt(h)){case"G":if(!w(s,h))throw new Error("unrecognized character "+R+" in "+s);l[l.length]={t:"G",v:"General"},h+=7;break;case'"':for(M="";(F=s.charCodeAt(++h))!==34&&h<s.length;)M+=String.fromCharCode(F);l[l.length]={t:"t",v:M},++h;break;case"\\":var xe=s.charAt(++h),nt=xe==="("||xe===")"?xe:"t";l[l.length]={t:nt,v:xe},++h;break;case"_":l[l.length]={t:"t",v:" "},h+=2;break;case"@":l[l.length]={t:"T",v:o},++h;break;case"B":case"b":if(s.charAt(h+1)==="1"||s.charAt(h+1)==="2"){if(x==null&&(x=z(o,i,s.charAt(h+1)==="2"),x==null))return"";l[l.length]={t:"X",v:s.substr(h,2)},k=R,h+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":R=R.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(o<0||x==null&&(x=z(o,i),x==null))return"";for(M=R;++h<s.length&&s.charAt(h).toLowerCase()===R;)M+=R;R==="m"&&k.toLowerCase()==="h"&&(R="M"),R==="h"&&(R=ne),l[l.length]={t:R,v:M},k=R;break;case"A":case"a":case"\u4E0A":var oe={t:R,v:R};if(x==null&&(x=z(o,i)),s.substr(h,3).toUpperCase()==="A/P"?(x!=null&&(oe.v=x.H>=12?s.charAt(h+2):R),oe.t="T",ne="h",h+=3):s.substr(h,5).toUpperCase()==="AM/PM"?(x!=null&&(oe.v=x.H>=12?"PM":"AM"),oe.t="T",h+=5,ne="h"):s.substr(h,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(x!=null&&(oe.v=x.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),oe.t="T",h+=5,ne="h"):(oe.t="t",++h),x==null&&oe.t==="T")return"";l[l.length]=oe,k=R;break;case"[":for(M=R;s.charAt(h++)!=="]"&&h<s.length;)M+=s.charAt(h);if(M.slice(-1)!=="]")throw'unterminated "[" block: |'+M+"|";if(M.match(At)){if(x==null&&(x=z(o,i),x==null))return"";l[l.length]={t:"Z",v:M.toLowerCase()},k=M.charAt(1)}else M.indexOf("$")>-1&&(M=(M.match(/\$([^-\[\]]*)/)||[])[1]||"$",Dt(s)||(l[l.length]={t:"t",v:M}));break;case".":if(x!=null){for(M=R;++h<s.length&&(R=s.charAt(h))==="0";)M+=R;l[l.length]={t:"s",v:M};break}case"0":case"#":for(M=R;++h<s.length&&"0#?.,E+-%".indexOf(R=s.charAt(h))>-1;)M+=R;l[l.length]={t:"n",v:M};break;case"?":for(M=R;s.charAt(++h)===R;)M+=R;l[l.length]={t:R,v:M},k=R;break;case"*":++h,(s.charAt(h)==" "||s.charAt(h)=="*")&&++h;break;case"(":case")":l[l.length]={t:v===1?"t":R,v:R},++h;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(M=R;h<s.length&&"0123456789".indexOf(s.charAt(++h))>-1;)M+=s.charAt(h);l[l.length]={t:"D",v:M};break;case" ":l[l.length]={t:R,v:R},++h;break;case"$":l[l.length]={t:"t",v:"$"},++h;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(R)===-1)throw new Error("unrecognized character "+R+" in "+s);l[l.length]={t:"t",v:R},++h;break}var B=0,we=0,Ne;for(h=l.length-1,k="t";h>=0;--h)switch(l[h].t){case"h":case"H":l[h].t=ne,k="h",B<1&&(B=1);break;case"s":(Ne=l[h].v.match(/\.0+$/))&&(we=Math.max(we,Ne[0].length-1),B=4),B<3&&(B=3);case"d":case"y":case"e":k=l[h].t;break;case"M":k=l[h].t,B<2&&(B=2);break;case"m":k==="s"&&(l[h].t="M",B<2&&(B=2));break;case"X":break;case"Z":B<1&&l[h].v.match(/[Hh]/)&&(B=1),B<2&&l[h].v.match(/[Mm]/)&&(B=2),B<3&&l[h].v.match(/[Ss]/)&&(B=3)}var q;switch(B){case 0:break;case 1:case 2:case 3:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H),x.H>=24&&(x.H=0,++x.D,q=z(x.D),q.u=x.u,q.S=x.S,q.M=x.M,q.H=x.H,x=q);break;case 4:switch(we){case 1:x.u=Math.round(x.u*10)/10;break;case 2:x.u=Math.round(x.u*100)/100;break;case 3:x.u=Math.round(x.u*1e3)/1e3;break}x.u>=1&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H),x.H>=24&&(x.H=0,++x.D,q=z(x.D),q.u=x.u,q.S=x.S,q.M=x.M,q.H=x.H,x=q);break}var K="",m;for(h=0;h<l.length;++h)switch(l[h].t){case"t":case"T":case" ":case"D":break;case"X":l[h].v="",l[h].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[h].v=Tr(l[h].t.charCodeAt(0),l[h].v,x,we),l[h].t="t";break;case"n":case"?":for(m=h+1;l[m]!=null&&((R=l[m].t)==="?"||R==="D"||(R===" "||R==="t")&&l[m+1]!=null&&(l[m+1].t==="?"||l[m+1].t==="t"&&l[m+1].v==="/")||l[h].t==="("&&(R===" "||R==="n"||R===")")||R==="t"&&(l[m].v==="/"||l[m].v===" "&&l[m+1]!=null&&l[m+1].t=="?"));)l[h].v+=l[m].v,l[m]={v:"",t:";"},++m;K+=l[h].v,h=m-1;break;case"G":l[h].t="t",l[h].v=me(o,i);break}var c="",p,I;if(K.length>0){K.charCodeAt(0)==40?(p=o<0&&K.charCodeAt(0)===45?-o:o,I=ce("n",K,p)):(p=o<0&&v>1?-o:o,I=ce("n",K,p),p<0&&l[0]&&l[0].t=="t"&&(I=I.substr(1),l[0].v="-"+l[0].v)),m=I.length-1;var E=l.length;for(h=0;h<l.length;++h)if(l[h]!=null&&l[h].t!="t"&&l[h].v.indexOf(".")>-1){E=h;break}var C=l.length;if(E===l.length&&I.indexOf("E")===-1){for(h=l.length-1;h>=0;--h)l[h]==null||"n?".indexOf(l[h].t)===-1||(m>=l[h].v.length-1?(m-=l[h].v.length,l[h].v=I.substr(m+1,l[h].v.length)):m<0?l[h].v="":(l[h].v=I.substr(0,m+1),m=-1),l[h].t="t",C=h);m>=0&&C<l.length&&(l[C].v=I.substr(0,m+1)+l[C].v)}else if(E!==l.length&&I.indexOf("E")===-1){for(m=I.indexOf(".")-1,h=E;h>=0;--h)if(!(l[h]==null||"n?".indexOf(l[h].t)===-1)){for(L=l[h].v.indexOf(".")>-1&&h===E?l[h].v.indexOf(".")-1:l[h].v.length-1,c=l[h].v.substr(L+1);L>=0;--L)m>=0&&(l[h].v.charAt(L)==="0"||l[h].v.charAt(L)==="#")&&(c=I.charAt(m--)+c);l[h].v=c,l[h].t="t",C=h}for(m>=0&&C<l.length&&(l[C].v=I.substr(0,m+1)+l[C].v),m=I.indexOf(".")+1,h=E;h<l.length;++h)if(!(l[h]==null||"n?(".indexOf(l[h].t)===-1&&h!==E)){for(L=l[h].v.indexOf(".")>-1&&h===E?l[h].v.indexOf(".")+1:0,c=l[h].v.substr(0,L);L<l[h].v.length;++L)m<I.length&&(c+=I.charAt(m++));l[h].v=c,l[h].t="t",C=h}}}for(h=0;h<l.length;++h)l[h]!=null&&"n?".indexOf(l[h].t)>-1&&(p=v>1&&o<0&&h>0&&l[h-1].v==="-"?-o:o,l[h].v=ce(l[h].t,l[h].v,p),l[h].t="t");var O="";for(h=0;h!==l.length;++h)l[h]!=null&&(O+=l[h].v);return O}r._eval=kt;var Ot=/\[[=<>]/,_t=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Nt(s,o){if(o==null)return!1;var i=parseFloat(o[2]);switch(o[1]){case"=":if(s==i)return!0;break;case">":if(s>i)return!0;break;case"<":if(s<i)return!0;break;case"<>":if(s!=i)return!0;break;case">=":if(s>=i)return!0;break;case"<=":if(s<=i)return!0;break}return!1}function Lt(s,o){var i=St(s),v=i.length,l=i[v-1].indexOf("@");if(v<4&&l>-1&&--v,i.length>4)throw new Error("cannot find right format for |"+i.join("|")+"|");if(typeof o!="number")return[4,i.length===4||l>-1?i[i.length-1]:"@"];switch(i.length){case 1:i=l>-1?["General","General","General",i[0]]:[i[0],i[0],i[0],"@"];break;case 2:i=l>-1?[i[0],i[0],i[0],i[1]]:[i[0],i[1],i[0],"@"];break;case 3:i=l>-1?[i[0],i[1],i[0],i[2]]:[i[0],i[1],i[2],"@"];break;case 4:break}var M=o>0?i[0]:o<0?i[1]:i[2];if(i[0].indexOf("[")===-1&&i[1].indexOf("[")===-1)return[v,M];if(i[0].match(Ot)!=null||i[1].match(Ot)!=null){var h=i[0].match(_t),R=i[1].match(_t);return Nt(o,h)?[v,i[0]]:Nt(o,R)?[v,i[1]]:[v,i[h!=null&&R!=null?2:1]]}return[v,M]}function Ft(s,o,i){i==null&&(i={});var v="";switch(typeof s){case"string":s=="m/d/yy"&&i.dateNF?v=i.dateNF:v=s;break;case"number":s==14&&i.dateNF?v=i.dateNF:v=(i.table!=null?i.table:N)[s],v==null&&(v=i.table&&i.table[_[s]]||N[_[s]]),v==null&&(v=X[s]||"General");break}if(w(v,0))return me(o,i);o instanceof Date&&(o=j(o,i.date1904));var l=Lt(v,o);if(w(l[1]))return me(o,i);if(o===!0)o="TRUE";else if(o===!1)o="FALSE";else if(o===""||o==null)return"";return kt(l[1],o,i,l[0])}function Pt(s,o){if(typeof o!="number"){o=+o||-1;for(var i=0;i<392;++i){if(N[i]==null){o<0&&(o=i);continue}if(N[i]==s){o=i;break}}o<0&&(o=391)}return N[o]=s,o}r.load=Pt,r._table=N,r.get_table=function(){return N},r.load_table=function(o){for(var i=0;i!=392;++i)o[i]!==void 0&&Pt(o[i],i)},r.init_table=D,r.format=Ft,r.choose_format=Lt}En(pr);typeof wt<"u"&&typeof DO_NOT_EXPORT_SSF>"u"&&(wt.exports=pr)});var Ce=12,Ut="sans-serif";var it=22,Le=76;var Sn=Le/2,st=0;var Fe="&#10;";var at=16384,lt=1048576;var Bt="=",ct="_";var ke=256;var ht=9;var Oe="General";var Pe=new Set(["#ERROR!","#DIV/0!","#NULL!","#NUM!","#REF!","#VALUE!","#N/A","#NAME?"]),A=1,$e={thin:A,hair:A,dotted:A,dashed:A,dashDot:A,dashDotDot:A,double:A,medium:A*2,mediumDashed:A*2,mediumDashDot:A*2,mediumDashDotDot:A*2,thick:A*4};function be(r){if(typeof r=="boolean")return[!0,Number(r)];if(typeof r=="number"&&!isNaN(r))return[!0,r];if(typeof r!="string")return[!1,0];if(r.length>12)return[!1,0];let e=Number(r);return isNaN(e)?[!1,0]:[!0,e]}function Ht(r,e){return`${r}${ct}${e}`}function Wt(r){let[e,t]=r.split(ct),n=parseInt(e,10),a=parseInt(t,10);return{row:isNaN(n)?-1:n,col:isNaN(a)?-1:a}}function zt(){return!1}var P=class extends Error{constructor(e){super(e),this.value=e}};function H(r,e="#VALUE!"){if(!r)throw new P(e)}function Ue(r){H(r.length===1);let[e]=r;return e}function Re(r){let e=Ue(r);return H(typeof e=="string"),e}function Q(r){let e=Ue(r),[t,n]=be(e);return H(t),n}function ut(r){H(r.length===0)}function Be(r){let e=r.toUpperCase();return/^[A-Z]+\d+$/.test(e)||/^[A-Z]+$/.test(e)}var Or=(...r)=>{let e=Ue(r);return typeof e=="string"?e:""},_r=(...r)=>Re(r).toLowerCase(),Gt=(...r)=>{let e=Q(r);return String.fromCharCode(e)},Vt=(...r)=>Re(r).charCodeAt(0),Nr=(...r)=>Re(r).length,Lr=(...r)=>{H(r.length===2);let[e,t]=r;return H(typeof e=="string"),H(typeof t=="string"),e.split(t)},Fr=(...r)=>Re(r).toUpperCase(),Pr=(...r)=>Re(r).replace(/ +/g," ").trim(),Xt=(...r)=>(H(r.length<=ke),r.join("")),$r={CONCAT:Xt,CONCATENATE:Xt,SPLIT:Lr,CHAR:Gt,CODE:Vt,UNICHAR:Gt,UNICODE:Vt,LEN:Nr,LOWER:_r,UPPER:Fr,TRIM:Pr,T:Or},jt=$r;function Jt(r){let e=[];for(let t=0;t<r.length;t++){let[n,a]=be(r[t]);n&&e.push(a)}return e}var Ur=(...r)=>{let e=Q(r);return Math.abs(e)},Br=(...r)=>{let e=Q(r);return Math.acos(e)},Hr=(...r)=>{let e=Q(r);return Math.log(e+Math.sqrt(e*e-1))},Wr=(...r)=>{let e=Q(r);return Math.atan(1/e)},zr=(...r)=>{let e=Q(r);return .5*Math.log((e+1)/(e-1))},Gr=(...r)=>{let e=Q(r);return Math.asin(e)},Vr=(...r)=>{let e=Q(r);return Math.log(e+Math.sqrt(e*e+1))},Xr=(...r)=>{let e=Q(r);return Math.atan(e)},jr=(...r)=>{H(r.length===2);let[e,t]=r;return H(typeof e=="number"),H(typeof t=="number"),Math.atan2(e,t)},Jr=(...r)=>{let e=Q(r);return Math.log((1+e)/(e+1))/2},Kr=(...r)=>{let e=Jt(r);return H(e.length<=ke&&e.length>=1),e.reduce((t,n)=>t+n,0)/e.length},Qr=(...r)=>{let e=Q(r);return Math.cos(e)},Zr=(...r)=>{let e=Q(r);return 1/Math.tan(e)};var qr=(...r)=>{let e=Q(r);return Math.exp(e)},Yr=(...r)=>{let e=Q(r);return Math.floor(e)};var en=(...r)=>(ut(r),Math.PI),tn=(...r)=>(ut(r),Math.E),rn=(...r)=>{let e=Q(r);return Math.sin(e)},nn=(...r)=>{let e=Jt(r);return H(e.length<=ke),e.reduce((t,n)=>t+n,0)},on={ABS:Ur,ACOS:Br,ACOSH:Hr,ACOT:Wr,ACOTH:zr,ASIN:Gr,ASINH:Vr,ATAN:Xr,ATAN2:jr,ATANH:Jr,AVERAGE:Kr,COT:Zr,COS:Qr,EXP:qr,INT:Yr,PI:en,E:tn,SIN:rn,SUM:nn},Kt=on;function Qt(r){let e=String(r),t=/[.](\d*)/.exec(e);if(t&&t[1]){let n=Math.pow(10,Math.min(t[1].length,ht)),a=e.split("."),u=a[0]+a[1].slice(0,ht);return Number(u)/n}else return r}var sn={...jt,...Kt},pt=sn;var ae=class{constructor(e,t){this.type=e,this.value=t}toString(){return this.value}};function Zt(r){let e=r.toUpperCase(),t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)-64+t*26;return t-1}function dt(r){let e=r+1,t="",n=Math.floor(Math.abs(e)),a;for(;n>0;)a=(n-1)%26,t=String.fromCharCode(65+a)+t,n=Math.floor((n-a)/26);return t.toUpperCase()}function qt(r){let e=parseInt(r,10);return isNaN(e)?e=-1:e=Math.max(e-1,-1),e}function Te(r){return ye(r)&&ve(r)}function ye(r){return r.colCount===0}function ve(r){return r.rowCount===0}function Yt(r,e){if(r.colCount===0&&e.colCount!==0||r.rowCount===0&&e.rowCount!==0)return!1;if(e.colCount===0&&e.row===r.row||e.rowCount===0&&e.col===r.col)return!0;let{row:t,col:n}=r;return t>=e.row&&t<e.row+e.rowCount&&n>=e.col&&n<e.col+e.colCount}var he=class r{constructor(e,t,n,a,u){this.row=0;this.col=0;this.colCount=0;this.rowCount=0;this.sheetId="";this.row=e,this.col=t,this.colCount=a,this.rowCount=n,this.sheetId=u}static makeRange(e){return new r(e.row,e.col,e.rowCount,e.colCount,e.sheetId)}toIRange(){return{row:this.row,col:this.col,rowCount:this.rowCount,colCount:this.colCount,sheetId:this.sheetId}}};function er(r,e,t){let{row:n,col:a,rowCount:u,colCount:d}=r;if(!e)return;if(Te(r)){for(let f=0;f<e.rowCount;f++)for(let w=0;w<e.colCount;w++)if(t(f,w))return;return}if(ye(r)){for(let f=0;f<e.colCount;f++)if(t(n,f))return;return}if(ve(r)){for(let f=0;f<e.rowCount;f++)if(t(f,a))return;return}let g=n+u,b=a+d;for(let f=n;f<g;f++)for(let w=a;w<b;w++)if(t(f,w))return}var He=r=>r>="a"&&r<="z"||r>="A"&&r<="Z",ue=r=>r>="0"&&r<="9";function an(r){return r}function tr(r,e){if(!r)return;let t=r.trim(),[n,a=""]=t.split("!");t.includes("!")||(n="",a=t),n&&n[0]==="'"&&n[n.length-1]==="'"&&(n=n.slice(1,-1));let u=0,d="",g="";for(a[u]==="$"&&u++;u<a.length&&He(a[u]);)g+=a[u++];for(a[u]==="$"&&u++;u<a.length&&ue(a[u]);)d+=a[u++];if(u!==a.length||!d&&!g)return;let b=1,f=1,w=-1,y=-1;return d===""?(b=0,w=0):w=qt(d),g===""?(f=0,y=0):y=Zt(g),w<0||y<0||y>=at||w>=lt?void 0:new he(w,y,b,f,e(n))}function nr(r,e=an){let[t,n]=r.split(":"),a=tr(t,e);if(!a)return;let u=tr(n,e);return u?(u.sheetId=a.sheetId,ft(a,u)):a}function ft(r,e){if(r.sheetId!==e.sheetId)return;if(r.row===e.row&&r.col===e.col&&r.rowCount===e.rowCount&&r.colCount===e.colCount)return r;if(r.rowCount===0&&e.rowCount!==0||r.rowCount!==0&&e.rowCount===0||r.colCount===0&&e.colCount!==0||r.colCount!==0&&e.colCount===0)return;let t=Math.abs(r.row-e.row)+1,n=Math.abs(r.col-e.col)+1,a=r.row<e.row?r.row:e.row,u=r.col<e.col?r.col:e.col;return new he(a,u,t,n,r.sheetId)}function rr(r,e){let t=-1;if(r.startsWith("[")){let n=parseInt(r.slice(1,-1),10);isNaN(n)||(t=e+n)}else{let n=parseInt(r,10);isNaN(n)||(t=n-1)}return isNaN(t)?-1:t}function or(r,e={row:-1,col:-1}){let t=r.toUpperCase();if(t[0]!=="R")return;let n=t.slice(1).split("C");if(n.length!==2)return;let[a,u]=n,d=-1,g=-1;return a?d=rr(a,e.row):d=e.row,u?g=rr(u,e.col):g=e.col,g>=at||d>=lt||d<0||g<0?void 0:new he(d,g,1,1,"")}var ir="",ln=new Map([["TRUE",20],["FALSE",21]]),We=class{constructor(e){this.current=0;this.start=0;this.tokens=[];this.list=[...e]}scan(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();return this.tokens.push(new ae(31,"")),this.tokens.length>0&&this.tokens[0].type===0&&this.tokens.shift(),this.tokens}peek(){return this.isAtEnd()?ir:this.list[this.current]}match(e){return this.peek()!==e?!1:(this.next(),!0)}next(){return this.isAtEnd()?ir:this.list[this.current++]}isAtEnd(){return this.current>=this.list.length}addToken(e){let t=this.list.slice(this.start,this.current).join("");this.tokens.push(new ae(e,t))}string(e){for(;!this.isAtEnd()&&this.peek()!==e;)this.next();if(this.peek()!==e)throw new P("#VALUE!");this.next();let t=this.list.slice(this.start+1,this.current-1).join("");this.tokens.push(new ae(17,t))}getDigits(){for(;!this.isAtEnd()&&ue(this.peek());)this.next()}getAlphas(){for(;!this.isAtEnd()&&He(this.peek());)this.next()}matchR1C1(){if(this.match("[")){if(this.match("-"),ue(this.peek()))this.getDigits();else throw new P("#VALUE!");if(this.peek()!=="]")throw new P("#VALUE!");this.next()}else this.getDigits()}matchScientificCounting(e){if(this.match("E")||this.match("e")){if(this.match("+")||this.match("-"))return this.getDigits(),this.addToken(e?18:19),!0;if(ue(this.peek()))return this.getDigits(),this.addToken(e?18:19),!0;throw new P("#VALUE!")}return!1}number(){if(this.getDigits(),this.matchScientificCounting(!1))return;let t=!1;this.match(".")&&(t=!0,this.getDigits()),!this.matchScientificCounting(!0)&&this.addToken(t?18:19)}addIdentifier(){for(;!this.isAtEnd()&&this.anyChar(this.peek());)this.next();let e=this.list.slice(this.start,this.current).join(""),t=e.toUpperCase(),n=ln.get(t),a=16;n&&(e=t,a=n),/^[A-Z]+\$\d+$/.test(t)&&(e=t,a=29),this.tokens.push(new ae(a,e))}scanToken(){let e=this.next();switch(e){case"$":{He(this.peek())?(this.getAlphas(),this.match("$")?ue(this.peek())?(this.getDigits(),this.addToken(30)):this.addIdentifier():ue(this.peek())?(this.getDigits(),this.addToken(29)):this.addToken(30)):ue(this.peek())?(this.getDigits(),this.addToken(30)):this.addIdentifier();break}case"r":case"R":{if(this.matchR1C1(),this.match("C")||this.match("c")){this.matchR1C1();let t=this.list.slice(this.start,this.current).join("").toUpperCase();this.tokens.push(new ae(28,t))}else this.addIdentifier();break}case"(":this.addToken(22);break;case")":this.addToken(23);break;case",":this.addToken(11);break;case":":this.addToken(10);break;case Bt:this.addToken(0);break;case"<":this.match(">")?this.addToken(1):this.match("=")?this.addToken(15):this.addToken(14);break;case">":this.match("=")?this.addToken(8):this.addToken(7);break;case"+":this.addToken(2);break;case"-":this.addToken(3);break;case"*":this.addToken(4);break;case"/":this.addToken(5);break;case"^":this.addToken(6);break;case"&":this.addToken(9);break;case"%":this.addToken(13);break;case'"':this.string(e);break;case"'":this.string(e);break;case"!":this.addToken(27);break;case";":this.addToken(26);break;case"{":this.addToken(24);break;case"}":this.addToken(25);break;case" ":break;case"\r":case"	":case`
`:break;default:ue(e)?this.number():this.addIdentifier();break}}anyChar(e){return!'(),:=<>+-*/^&%"{}!'.includes(e)&&!this.isWhiteSpace(e)}isWhiteSpace(e){return e===" "||e==="\r"||e===`
`||e==="	"}};var ge=class{constructor(e,t,n){this.left=e,this.operator=t,this.right=n}accept(e){return e.visitBinaryExpression(this)}handleConcatenate(e){let t=e.toString();return this.operator.type===9&&e instanceof Ee&&e.value.type===17?JSON.stringify(t):t}toString(){let e=this.handleConcatenate(this.left),t=this.handleConcatenate(this.right);return`${e}${this.operator.toString()}${t}`}},ze=class{constructor(e,t){this.operator=e,this.right=t}accept(e){return e.visitUnaryExpression(this)}toString(){return this.operator.toString()+this.right.toString()}},Ge=class{constructor(e,t){this.operator=e,this.left=t}accept(e){return e.visitPostUnaryExpression(this)}toString(){return this.left.toString()+this.operator.toString()}},Ee=class{constructor(e){this.value=e}accept(e){return e.visitLiteralExpression(this)}toString(){return this.value.toString()}},Ve=class{constructor(e){this.value=e}accept(e){return e.visitR1C1Expression(this)}toString(){return this.value.toString()}},ie=class{constructor(e,t,n){this.value=e,this.sheetName=n,this.type=t}accept(e){return e.visitCellExpression(this)}toString(){let e=this.value.toString().toUpperCase();if(this.sheetName){let t=this.sheetName.toString();return t.includes(" ")&&(t=`'${t}'`),`${t}!${e}`}else return e}},Xe=class{constructor(e,t){this.name=e,this.params=t}accept(e){return e.visitCallExpression(this)}toString(){return`${this.name.toString().toUpperCase()}(${this.params.map(e=>e.toString()).join(",")})`}},je=class{constructor(e,t,n){this.left=e,this.operator=t,this.right=n}accept(e){return e.visitCellRangeExpression(this)}toString(){return this.left.toString()+this.operator.toString()+this.right.toString()}},Je=class{constructor(e){this.value=e}accept(e){return e.visitGroupExpression(this)}toString(){return`(${this.value.toString()})`}},Ie=class{constructor(e){this.value=e}accept(e){return e.visitTokenExpression(this)}toString(){return this.value.toString()}};var Ke=class{constructor(e){this.current=0;this.tokens=e}parse(){let e=[];for(;!this.isAtEnd();)e.push(this.expression());return e}expression(){return this.comparison()}comparison(){let e=this.concatenate();for(;this.match(0,1,7,8,14,15);){let t=this.previous(),n=this.concatenate();e=new ge(e,t,n)}return e}concatenate(){let e=this.term();for(;this.match(9);){let t=this.previous(),n=this.term();e=new ge(e,t,n)}return e}term(){let e=this.factor();for(;this.match(2,3);){let t=this.previous(),n=this.factor();e=new ge(e,t,n)}return e}factor(){let e=this.expo();for(;this.match(5,4);){let t=this.previous(),n=this.expo();e=new ge(e,t,n)}return e}expo(){let e=this.unary();for(;this.match(6);){let t=this.previous(),n=this.unary();e=new ge(e,t,n)}return e}unary(){if(this.match(2,3)){let e=this.previous(),t=this.unary();return new ze(e,t)}return this.postUnary()}postUnary(){let e=this.cellRange();if(this.match(13)){let t=this.previous();e=new Ge(t,e)}return e}cellRange(){let e=this.sheetRange();for(;this.match(10);){let t=this.previous(),n=this.sheetRange(),a=this.convertToCellExpression(n),u=this.convertToCellExpression(e);e=new je(u,t,a)}return e}convertToCellExpression(e){if(e instanceof ie)return e;if(e instanceof Ie&&Be(e.value.value))return new ie(e.value,"relative",void 0);if(e instanceof Ee&&e.value.type===19)return new ie(e.value,"relative",void 0);throw new P("#NAME?")}sheetRange(){let e=this.call();if(this.match(27)){let t=this.call();if(e instanceof Ie||e instanceof Ee){let n=this.convertToCellExpression(t);return new ie(n.value,n.type,e.value)}}return e}call(){let e=this.primary();for(;this.match(22);)e=this.finishCall(e);return e}finishCall(e){let t=[];if(!this.check(23))do{if(this.peek().type==23)break;t.push(this.expression())}while(this.match(11));return this.expect(23),new Xe(e,t)}primary(){if(this.match(22)){let e=this.expression();return this.expect(23),new Je(e)}if(this.match(19,18,17,20,21))return new Ee(this.previous());if(this.match(30)){let e=this.previous();return new ie(e,"absolute",void 0)}if(this.match(29)){let e=this.previous();return new ie(e,"mixed",void 0)}if(this.match(16)){let e=this.previous(),t=e.value.toUpperCase();if(Pe.has(t))throw new P(t);return new Ie(e)}if(this.match(28))return new Ve(this.previous());throw new P("#ERROR!")}match(...e){let{type:t}=this.peek();return e.includes(t)?(this.next(),!0):!1}previous(){return this.tokens[this.current-1]}check(e){return this.peek().type===e}expect(e){if(this.check(e))return this.next(),this.previous();throw new P("#ERROR!")}next(){this.current++}isAtEnd(){return this.peek().type===31}peek(){return this.current<this.tokens.length?this.tokens[this.current]:new ae(31,"")}};var Qe=class{constructor(e,t,n,a){this.expressions=e,this.functionMap=a,this.cellDataMap=t,this.definedNamesMap=n}interpret(){let e=[];for(let t of this.expressions)e.push(this.evaluate(t));if(e.length===1)return this.getRangeCellValue(e[0]);throw new P("#ERROR!")}visitBinaryExpression(e){let t=this.evaluate(e.left),n=this.evaluate(e.right);switch(t=this.getRangeCellValue(t),n=this.getRangeCellValue(n),e.operator.type){case 3:return H(typeof t=="number"),H(typeof n=="number"),t-n;case 2:return H(typeof t=="number"),H(typeof n=="number"),t+n;case 5:if(H(typeof t=="number"),H(typeof n=="number"),n===0)throw new P("#DIV/0!");return t/n;case 4:return H(typeof t=="number"),H(typeof n=="number"),t*n;case 6:return H(typeof t=="number"),H(typeof n=="number"),Math.pow(t,n);case 0:return t===n;case 1:return t!==n;case 7:return t>n;case 8:return t>=n;case 14:return t<n;case 15:return t<=n;case 9:return`${t}${n}`;default:throw new P("#VALUE!")}}visitCallExpression(e){let t=this.evaluate(e.name);if(t&&typeof t=="function"){let n=[];for(let a of e.params){let u=this.evaluate(a);if(u instanceof he){let d=this.cellDataMap.get(u);n=n.concat(d)}else n.push(u)}return t(...n)}throw new P("#NAME?")}visitR1C1Expression(e){let t=or(e.value.value,this.cellDataMap.getCurrentCell());if(!t)throw new P("#NAME?");return t}visitCellExpression(e){let t="";if(e.sheetName&&(t=this.cellDataMap.convertSheetNameToSheetId(e.sheetName.value),!t))throw new P("#NAME?");let n=nr(e.value.value);if(!n)throw new P("#NAME?");return t&&(n.sheetId=t),n}visitLiteralExpression(e){let{type:t,value:n}=e.value;switch(t){case 17:return n;case 18:case 19:{let[a,u]=be(n);if(a)return u;throw new P("#VALUE!")}case 20:return!0;case 21:return!1;default:throw new P("#ERROR!")}}visitTokenExpression(e){let{value:t}=e.value,n=t.toLowerCase();if(this.definedNamesMap.get(n)){let d=this.definedNamesMap.get(n);return this.cellDataMap.get(d)[0]}let a=t.toUpperCase(),u=this.functionMap[a];if(u)return u;if(Be(t))return this.visitCellExpression(new ie(e.value,"relative",void 0));throw new P("#NAME?")}visitUnaryExpression(e){let t=this.evaluate(e.right);switch(e.operator.type){case 3:return H(typeof t=="number"),-t;case 2:return H(typeof t=="number"),t;default:throw new P("#VALUE!")}}visitCellRangeExpression(e){switch(e.operator.type){case 10:{let t=this.visitCellExpression(e.left),n=this.visitCellExpression(e.right),a=ft(t,n);if(!a)throw new P("#NAME?");return a}default:throw new P("#NAME?")}}visitGroupExpression(e){return this.evaluate(e.value)}visitPostUnaryExpression(e){let t=this.evaluate(e.left);switch(e.operator.type){case 13:return H(typeof t=="number"),t*.01;default:throw new P("#VALUE!")}}evaluate(e){return e.accept(this)}getRangeCellValue(e){if(e instanceof he){if(e.colCount===e.rowCount&&e.colCount===1)return this.cellDataMap.get(e)[0];throw new P("#REF!")}return e}};function mt(r,e=new Ze,t=new qe,n=pt){let a="";try{let u=new We(r).scan(),d=new Ke(u).parse(),g=new Qe(d,e,t,n).interpret(),b=[];for(let w of d)b.push(w.toString());a=b.join("");let f=g;return typeof f=="number"&&!isNaN(f)&&(f=Qt(f)),{result:f,isError:!1,expressionStr:a}}catch(u){if(u instanceof P)return{result:u.value,isError:!0,expressionStr:a};throw u}}var Ze=class{constructor(){this.map=new Map;this.sheetNameMap={};this.cell={row:0,col:0}}getKey(e,t,n){return`${e}_${t}_${n}`}setCurrentCell(e){this.cell=e}setSheetNameMap(e){this.sheetNameMap=e}set(e,t){let{row:n,col:a,sheetId:u}=e;for(let d=0;d<t.length;d++)for(let g=0;g<t[d].length;g++){let b=this.getKey(n+d,a+g,u);this.map.set(b,t[d][g])}}get(e){let t=[],{row:n,col:a,rowCount:u,colCount:d,sheetId:g}=e;for(let b=n,f=n+u;b<f;b++)for(let w=a,y=a+d;w<y;w++){let S=this.getKey(b,w,g),D=this.map.get(S);typeof D<"u"&&t.push(D)}return t}convertSheetNameToSheetId(e){return this.sheetNameMap[e]||""}getCurrentCell(){return{...this.cell}}},qe=class{constructor(){this.map=new Map}set(e,t){this.map.set(e,t)}get(e){return this.map.get(e)}};function xt(r){return r?typeof Intl>"u"||typeof Intl.Segmenter!="function"?[...r]:[...new Intl.Segmenter([],{granularity:"word"}).segment(r)].map(n=>n.segment):[]}var cn={smallFont:"10px",font:"12px",largeFont:"14px",padding:"12px",lineHeight:1.5,mediumPadding:"8px",largePadding:"20px",borderRadius:"4px",borderLargeRadius:"8px",tinyPadding:"4px",scrollBarContent:"30px",formulaBarHeight:"25px"},sr=cn;var hn={lowZIndex:2,middleZIndex:3,highZIndex:4,highestZIndex:9},ar=hn;function un(r,e,t,n){e=e/100,t=t/100;let a=(1-Math.abs(2*t-1))*e,u=a*(1-Math.abs(r/60%2-1)),d=t-a/2,g,b,f;if(r>=0&&r<60?(g=a,b=u,f=0):r>=60&&r<120?(g=u,b=a,f=0):r>=120&&r<180?(g=0,b=a,f=u):r>=180&&r<240?(g=0,b=u,f=a):r>=240&&r<300?(g=u,b=0,f=a):(g=a,b=0,f=u),n!==1)return`rgba(${g},${b},${f},${n})`;let w=N=>Math.round(N*255).toString(16).padStart(2,"0"),y=w(g+d),S=w(b+d),D=w(f+d);return`#${y}${S}${D}`}var pn=(r,e,t)=>{let n=r/255,a=e/255,u=t/255,d=Math.min(n,a,u),g=Math.max(n,a,u),b=g-d,f=dn(n,a,u),w=gn(g,d),y=fn(b,w);return[f,y*100,w*100]},dn=(r,e,t)=>{let n=Math.max(r,e,t),a=Math.min(r,e,t),u=n-a,d=0;if(u==0)d=0;else switch(n){case r:{let f=(e-t)/u,w=0;f<0&&(w=360/60),d=f+w;break}case e:{let f=(t-r)/u,w=120/60;d=f+w;break}case t:let g=(r-e)/u,b=240/60;d=g+b;break}return d*60},fn=(r,e)=>r==0?0:r/(1-Math.abs(2*e-1)),gn=(r,e)=>(r+e)/2,lr=([r,e,t,n])=>{let[a,u,d]=pn(r,e,t);return un(a,u*.9,100-d,n)};function mn(r){r.startsWith("#")&&(r=r.slice(1));let e=parseInt(r.substring(0,2),16),t=parseInt(r.substring(2,4),16),n=parseInt(r.substring(4,6),16),a=parseInt(r.substring(6,8)||"ff",16);return[e,t,n,a/255]}var Ct=r=>{if(r.startsWith("rgb")){let t=r.replace("rgb","").replace("a","").replace("(","").replace(")","").split(",").map(Number);return t.length<=3&&t.push(1),lr(t)}else return lr(mn(r))};var bt=Object.freeze({primaryColor:"#217346",buttonActiveColor:"#c6c6c6",selectionColor:"rgba(198,198,198,0.3)",backgroundColor:"#e6e6e6",hoverColor:"rgba(0, 0, 0, 0.04)",scrollbarColor:"rgba(0, 0, 0, 0.1)",scrollbarHoveColor:"rgba(0, 0, 0, 0.2)",dialogBackground:"rgba(0, 0, 0, 0.6)",white:"#ffffff",black:"#000000",triangleFillColor:"#dddddd",contentColor:"#333333",borderColor:"#cccccc",activeBorderColor:"#808080",errorFormulaColor:"#ff0000"}),cr=Object.freeze(Object.fromEntries(Object.entries(bt).map(([r,e])=>[r,Ct(e)])));var Ye={...sr,...ar},xn="data-theme";function Cn(){if(typeof sessionStorage<"u"){let r=sessionStorage.getItem(xn);if(r&&(r==="dark"||r==="light"))return r}return typeof matchMedia=="function"&&matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function J(r,e){return e==="dark"||Cn()==="dark"?cr[r]:bt[r]}var Et;function Me(r=typeof devicePixelRatio>"u"?void 0:devicePixelRatio){return typeof Et=="number"?Et:Math.max(Math.floor(r||1),1)}function $(r){return Math.floor(r*Me())}function hr(r){Et=Math.max(Math.floor(r||1),1)}function ur(r){let e=r||{};return[Object,Array].includes(e.constructor)&&!Object.entries(e).length}function et(r="normal",e="normal",t=Ce,n=""){let a=`${r} ${e} ${t}px `,u=[Ut];return zt()&&u.unshift("Source Code Pro"),n&&u.unshift(n),a+u.join(",")}var Rt=kr(dr());function fr(r,e,t={}){return Rt.default.format(e||Oe,r,t)}function gr(r){return r?Rt.default.is_date(r):!1}var Tt=new Map;function wn(r,e){let t=`${e}__${r.font}`;if(Tt.has(t))return Tt.get(t);let n=r.measureText(e),{actualBoundingBoxAscent:a,actualBoundingBoxDescent:u}=n,d=a+u,g=n.width,b=Math.ceil(g/Me()),f=Math.ceil(d/Me()),w={width:b,height:f};return Tt.set(t,w),w}function re(r,e,t,n,a){r.fillRect($(e),$(t),$(n),$(a))}function yt(r,e,t,n,a){r.strokeRect($(e),$(t),$(n),$(a))}function vt(r,e,t,n,a){r.clearRect($(e),$(t),$(n),$(a))}function tt(r,e,t,n){r.fillText(e,$(t),$(n))}function pe(r,e){if(e.length!==0){r.beginPath();for(let t=0;t<e.length;t+=2){let n=e[t],a=e[t+1];r.moveTo($(n[0]),$(n[1])),r.lineTo($(a[0]),$(a[1]))}r.stroke()}}function mr(r,e,t,n){r.beginPath(),r.moveTo($(e[0]),$(e[1])),r.lineTo($(t[0]),$(t[1])),r.lineTo($(n[0]),$(n[1])),r.fill()}function xr(r,e,t){let n=r.slice(),[a,u]=r,d=A*2,g=t?d:0;return e==="bottom"?n.push([a[0]+g,a[1]-d],[u[0]-g,u[1]-d]):e==="top"?n.push([a[0]+g,a[1]+d],[u[0]-g,u[1]+d]):e==="left"?n.push([a[0]+d,a[1]+g],[u[0]+d,u[1]-g]):e==="right"&&n.push([a[0]-d,a[1]+g],[u[0]-d,u[1]-g]),n}function Rn(r,e,t){return t?e?r.split(Fe):xt(r.replaceAll(Fe,"")):xt(r)}function Cr(r,e,t,n,a){r.setLineDash([$(8),$(6)]);let u=A;yt(r,e+u,t+u,n-u*2,a-u*2),r.setLineDash([])}function Tn(r){let e=[];return r==="hair"?e=[A,A]:r==="dotted"||r==="mediumDashed"?e=[A*2,A*2]:r==="dashed"?e=[A*4,A*4]:r==="dashDot"||r==="mediumDashDot"?e=[A*4,A*4,A*8,A*4]:(r==="dashDotDot"||r==="mediumDashDotDot")&&(e=[A*4,A*4,A*8,A*4,A*4,A*4]),e}function _e(r,e,t,n,a){if(!t)return;let{top:u,left:d,width:g,height:b}=e,f=[];n==="top"?f=[[d,u],[d+g,u]]:n==="bottom"?f=[[d,u+b],[d+g,u+b]]:n==="left"?f=[[d,u],[d,u+b]]:n==="right"&&(f=[[d+g,u],[d+g,u+b]]);let{type:w,color:y}=t;r.lineWidth=$e[w],r.strokeStyle=y||J("black",a);let S=Tn(w);w==="double"&&(f=xr(f,n,!0)),S.length>0&&r.setLineDash(S.map(D=>$(D))),pe(r,f),S.length>0&&r.setLineDash([])}function br(r,e,t,n,a,u){let d={height:0,width:0};if(t===""&&ur(n))return d;let g=n?.numberFormat||Oe,b=g===Oe&&typeof t=="number",f=fr(t,g),w=n?.fontSize?n.fontSize:Ce,y=et(n?.isItalic?"italic":"normal",n?.isBold?"bold":"500",$(w),n?.fontFamily);n?.fillColor&&(r.fillStyle=n?.fillColor,re(r,e.left,e.top,e.width,e.height));let S=n?.fontColor||J("contentColor",u);Pe.has(f)&&(S=J("errorFormulaColor",u)),r.font=y,r.fillStyle=S;let D=n?{...n}:{},N=D?.horizontalAlign;D?.horizontalAlign===void 0&&b&&(N=2),D.horizontalAlign=N;let _=a&&f.includes(Fe),Y=(!D?.isWrapText&&gr(g)?[f]:Rn(f,n?.isWrapText,a)).map(se=>{let Z=wn(r,se);return{str:se,width:Z.width,height:Z.height===0?w:Z.height}}),{width:ee,height:z,resultList:le}=yn(Y,e,D,_);if(ee>0&&z>0){let se=Math.ceil(w*(Ye.lineHeight-1)/2),Z=[];for(let j of le){if(tt(r,j.text,j.x,j.y),D?.underline){r.strokeStyle=S;let de=j.y+j.height+se/2,me=[[j.x,de],[j.x+j.width,de]];D?.underline===2?Z=Z.concat(xr(me,"bottom",!1)):Z=Z.concat(me)}if(D?.isStrike){r.strokeStyle=S;let de=j.y+j.height/2+se/2;Z=Z.concat([[j.x,de],[j.x+j.width,de]])}}pe(r,Z)}return d.height=Math.ceil(z),d.width=Math.ceil(ee),d}function yn(r,e,t,n){let a=t?.fontSize?t.fontSize:Ce,u=Math.ceil(a*(Ye.lineHeight-1)/2),d=t?.verticalAlign??1,{left:g,top:b,height:f}=e,w=Math.max(e.width,...r.map(N=>N.width)),y=[],S=0,D=0;if(t?.isWrapText&&n){let N=0;for(let _=0;_<r.length;_++){let T=r[_];S=Math.max(S,T.width);let X=T.height+u*2;D+=X,y.push({text:T.str,x:0,y:N,width:T.width,height:T.height}),N+=X}}else if(t?.isWrapText){let N=0;for(let _=0;_<r.length;){let T=w,X="",Y=0,ee=0;for(;_<r.length;){let z=r[_];if(T>=z.width)Y+=z.width,ee=Math.max(ee,z.height),T-=z.width,X+=z.str,_++;else break}if(X){S=Math.max(S,Y);let z=ee+u*2;D+=z,y.push({text:X,x:0,y:N,width:Y,height:ee}),N+=z}}}else{let N="",_=w;for(let T=0;T<r.length;T++){let X=r[T];if(_>=X.width)S+=X.width,D=Math.max(D,X.height),N+=X.str,_-=X.width;else break}y.push({text:N,x:0,y:0,width:S,height:D})}if(D=Math.max(D,a*Ye.lineHeight),S+=u,D+=u,S<=w&&D<=f){let N=g+u,_=b+(f-D)/2+u;d===0?_=b+u:d===2&&(_=b+(f-D)+u),t?.horizontalAlign===1?N=g+(w-S)/2:t?.horizontalAlign===2&&(N=g+(w-S)-u);for(let T of y)T.x=T.x+N,T.y=T.y+_}return{width:S,height:D,resultList:y}}function It(r){return{textAlign:"center",textBaseline:"middle",font:et(void 0,"500",$(Ce)),fillStyle:J("black",r),lineWidth:A,strokeStyle:J("borderColor",r)}}var Er=Math.max(...Object.values($e)),rt=class{constructor(e){this.width=0;this.height=0;this.isRendering=!1;this.rowMap={};this.colMap={};this.eventData={theme:"light",sheetData:{},canvasSize:{top:0,left:0,width:0,height:0},headerSize:{width:0,height:0},currentSheetInfo:{isHide:!1,rowCount:0,colCount:0,name:"",sheetId:"",tabColor:"",sort:1},scroll:{left:0,top:0,row:0,col:0,scrollLeft:0,scrollTop:0},range:{row:0,col:0,rowCount:1,colCount:1,sheetId:""},copyRange:void 0,customHeight:{},customWidth:{},currentMergeCells:[]};this.canvas=e,this.ctx=e.getContext("2d");let t=Me();this.ctx.scale(t,t)}render(e){if(e.changeSet.size===0||this.isRendering)return;this.isRendering=!0,this.eventData=e,this.clear();let{ctx:t}=this;t.strokeStyle=J("primaryColor",e.theme),t.fillStyle=J("white",e.theme),t.lineWidth=A*2;let{width:n,height:a}=this.eventData.canvasSize,u=this.eventData.headerSize,{endRow:d,contentHeight:g}=this.renderRowsHeader(a),{endCol:b,contentWidth:f}=this.renderColsHeader(n);this.renderGrid(n-u.width,a-u.height),this.renderTriangle(),this.renderMergeCell(),this.ctx.fillStyle=J("selectionColor",this.eventData.theme);let w=this.renderSelection({endRow:d,endCol:b,contentHeight:g,contentWidth:f});return this.renderAntLine(w),this.renderContent({endRow:d,endCol:b,contentHeight:g,contentWidth:f}),this.ctx.lineWidth=Er,yt(this.ctx,w.left,w.top,w.width,w.height),this.isRendering=!1,{rowMap:this.rowMap,colMap:this.colMap}}resize(e){this.width=e.width,this.height=e.height,this.canvas.width=$(e.width),this.canvas.height=$(e.height)}clear(){vt(this.ctx,0,0,this.width,this.height)}renderRowsHeader(e){let{row:t}=this.eventData.scroll,n=this.eventData.headerSize,{rowCount:a}=this.eventData.currentSheetInfo;this.ctx.save();let u=this.eventData.range;re(this.ctx,0,n.height,n.width,e),Object.assign(this.ctx,It(this.eventData.theme));let d=[],g=n.height,b=t;for(;b<a&&g<e;b++){let w=this.getRowHeight(b),y=g;if(b===t&&(y+=A/2),d.push([0,y],[n.width,y]),w>0){let S=this.isHighlightRow(u,b);this.ctx.fillStyle=S?J("primaryColor",this.eventData.theme):J("black",this.eventData.theme),tt(this.ctx,String(b+1),n.width/2,y+w/2)}g+=w}d.push([0,g],[n.width,g]),d.push([0,0],[0,g]),pe(this.ctx,d),this.ctx.restore();let f=b>=a?g:e;return{endRow:b,contentHeight:Math.floor(f)}}renderColsHeader(e){let{col:t}=this.eventData.scroll,n=this.eventData.headerSize,{colCount:a}=this.eventData.currentSheetInfo,u=this.eventData.range,d=[];this.ctx.save(),re(this.ctx,n.width,0,e,n.height),Object.assign(this.ctx,It());let g=n.width,b=t;for(;b<a&&g<=e;b++){let w=this.getColWidth(b),y=g;if(b===t&&(y+=A/2),d.push([y,0],[y,n.height]),w>0){let S=this.isHighlightCol(u,b);this.ctx.fillStyle=S?J("primaryColor",this.eventData.theme):J("black",this.eventData.theme),tt(this.ctx,dt(b),y+w/2,n.height/2)}g+=w}d.push([g,0],[g,n.height]),d.push([0,0],[g,0]),pe(this.ctx,d),this.ctx.restore();let f=b>=a?g:e;return{endCol:b,contentWidth:Math.floor(f)}}renderGrid(e,t){let n=this.eventData.headerSize,{row:a,col:u}=this.eventData.scroll,{rowCount:d,colCount:g}=this.eventData.currentSheetInfo;this.ctx.save(),this.ctx.lineWidth=A,this.ctx.strokeStyle=J("borderColor",this.eventData.theme),this.ctx.translate($(n.width),$(n.height));let b=[],f=0,w=0;for(let y=a;y<d&&f<=t;y++){for(;y<d&&this.getRowHeight(y)===0;)y++;b.push([0,f],[e,f]);let S=this.getRowHeight(y);f+=S}for(let y=u;y<g&&w<=e;y++){for(;y<g&&this.getColWidth(y)===0;)y++;b.push([w,0],[w,f]);let S=this.getColWidth(y);w+=S}b.push([0,f],[w,f]),b.push([w,0],[w,f]),pe(this.ctx,b),this.ctx.restore()}renderTriangle(){let e=this.eventData.headerSize;this.ctx.save(),re(this.ctx,0,0,e.width,e.height),this.ctx.fillStyle=J("triangleFillColor",this.eventData.theme);let t=2,n=Math.floor(t),a=Math.floor(e.height-t),u=Math.floor(e.width*.4),d=Math.floor(e.width-t);mr(this.ctx,[d,n],[u,a],[d,a]),this.ctx.restore()}getRowHeight(e){let t=`${this.eventData.currentSheetInfo.sheetId}_${e}`,n=this.eventData.customHeight[t];return n?n.isHide?st:n.len:it}getColWidth(e){let t=`${this.eventData.currentSheetInfo.sheetId}_${e}`,n=this.eventData.customWidth[t];return n?n.isHide?st:n.len:Le}isHighlightRow(e,t){return!!(Te(e)||ve(e)||t>=e.row&&t<e.row+e.rowCount)}isHighlightCol(e,t){return!!(Te(e)||ye(e)||t>=e.col&&t<e.col+e.colCount)}renderAntLine(e){let t=this.eventData.copyRange;!t||t.sheetId!==this.eventData.currentSheetInfo.sheetId||(this.ctx.lineWidth=Er,this.ctx.strokeStyle=J("primaryColor",this.eventData.theme),Cr(this.ctx,e.left,e.top,e.width,e.height))}renderMergeCell(){let e=this.eventData.currentMergeCells;if(e.length===0)return;let t=this.eventData.range;for(let n of e)t.row===n.row&&t.col===n.col||this.clearRect(n)}getCellSize(e){let{row:t,col:n,colCount:a,rowCount:u}=e,d=t,g=n,b=t+u,f=n+a,w=this.eventData.currentSheetInfo;Te(e)?(g=0,f=w.colCount,d=0,b=w.rowCount):ve(e)?(d=0,b=w.rowCount):ye(e)&&(g=0,f=w.colCount);let y=0,S=0;for(;d<b;d++)S+=this.getRowHeight(d);for(;g<f;g++)y+=this.getColWidth(g);return{width:y,height:S}}computeCellPosition(e){let{row:t,col:n}=e,a=this.eventData.headerSize,u=this.eventData.scroll,d=a.width,g=a.height,b=u.row,f=u.col;if(n>=u.col)for(;f<n;)d+=this.getColWidth(f),f++;else for(d=-a.width;f>n;)d-=this.getColWidth(f),f--;if(t>=u.row)for(;b<t;)g+=this.getRowHeight(b),b++;else for(g=-a.height;b>t;)g-=this.getRowHeight(b),b--;return{top:g,left:d}}getActiveRange(e){let t=e||this.eventData.range,n=this.eventData.currentMergeCells;for(let a of n)if(Yt(t,a))return{range:{...a,sheetId:a.sheetId},isMerged:!0};return{range:t,isMerged:!1}}clearRect(e){let t=this.getCellSize(e);if(t.width<=0||t.height<=0)return;let n=this.computeCellPosition(e),a=A;vt(this.ctx,n.left+a,n.top+a,t.width-a*2,t.height-a*2)}renderContent(e){let{endCol:t,endRow:n,contentHeight:a,contentWidth:u}=e,{ctx:d}=this;d.textAlign="left",d.textBaseline="top",d.lineWidth=A*2;let g=this.eventData.headerSize,{row:b,col:f}=this.eventData.scroll,w=Math.floor(u-g.width),y=Math.floor(a-g.height);d.save(),this.rowMap={},this.colMap={};let S=this.eventData.currentMergeCells;for(let D=b;D<n;D++)for(let N=f;N<t;N++){let _=S.find(T=>T.row===D&&T.col===N);this.renderCell(D,N,_,w,y)}d.restore()}renderCell(e,t,n,a,u){let{ctx:d}=this,g={row:e,col:t,rowCount:1,colCount:1,sheetId:""},b=`${e}_${t}`,f=this.eventData.sheetData[b];if(!f)return;let w=this.getCellSize(n||g);if(w.width<=0||w.height<=0)return;let y=this.computeCellPosition(g);d.lineWidth=A*2;let S=this.eventData.theme,D=br(d,{top:y.top,left:y.left,width:Math.min(w.width,a),height:Math.min(w.height,u)},f.value,f.style,!!n,S),N=Math.max(this.rowMap[e]??0,D.height),_=Math.max(this.colMap[t]??0,D.width);N>=it&&(this.rowMap[e]=N),_>=Le&&(this.colMap[t]=_);let T={top:y.top,left:y.left,height:Math.max(N,w.height),width:Math.max(_,w.width)};_e(d,T,f.style?.borderTop,"top",S),_e(d,T,f.style?.borderBottom,"bottom",S),_e(d,T,f.style?.borderLeft,"left",S),_e(d,T,f.style?.borderRight,"right",S)}renderSelection(e){let t=this.eventData.range;return Te(t)?this.renderSelectAll(e):ve(t)?this.renderSelectCol(e):ye(t)?this.renderSelectRow(e):this.renderSelectRange()}renderSelectRange(){let e=this.eventData.headerSize,t=this.eventData.range,n=this.computeCellPosition({row:t.row,col:t.col,rowCount:1,colCount:1,sheetId:""}),a=t.row+t.rowCount-1,u=t.col+t.colCount-1,d={row:a,col:u,rowCount:1,colCount:1,sheetId:""},g=this.computeCellPosition(d),b=this.getCellSize(d),f=g.left+b.width-n.left,w=g.top+b.height-n.top;re(this.ctx,n.left,0,f,e.height),re(this.ctx,0,n.top,e.width,w);let y=t.rowCount>1||t.colCount>1;y&&re(this.ctx,n.left,n.top,f,w);let S=[[n.left,e.height],[n.left+f,e.height]];return S.push([e.width,n.top],[e.width,n.top+w]),pe(this.ctx,S),y&&this.renderActiveCell(),{left:n.left,top:n.top,width:f,height:w}}renderSelectAll(e){let{contentHeight:t,contentWidth:n}=e,a=this.eventData.headerSize;re(this.ctx,0,0,n,t),this.renderActiveCell();let u=n-a.width,d=t-a.height;return{left:a.width,top:a.height,width:u,height:d}}renderSelectCol({contentHeight:e}){let t=this.eventData.headerSize,n=this.eventData.range,a=this.computeCellPosition(n),u=0;for(let b=n.col,f=n.col+n.colCount;b<f;b++)u+=this.getColWidth(b);let d=e-t.height;re(this.ctx,a.left,0,u,e),re(this.ctx,0,a.top,t.width,d);let g=[[t.width,t.height],[t.width,e]];return pe(this.ctx,g),this.renderActiveCell(),{left:a.left,top:t.height,width:u,height:d}}renderSelectRow({contentWidth:e}){let t=this.eventData.headerSize,n=this.eventData.range,a=this.computeCellPosition(n),u=0;for(let b=n.row,f=n.row+n.rowCount;b<f;b++)u+=this.getRowHeight(b);let d=e-t.width-A;re(this.ctx,a.left,0,d,t.height),re(this.ctx,0,a.top,e,u);let g=[[a.left,t.height],[e,t.height]];return pe(this.ctx,g),this.renderActiveCell(),{left:t.width,top:a.top,width:d,height:u}}renderActiveCell(){let e=this.eventData.range,t=this.getActiveRange({row:e.row,col:e.col,rowCount:1,colCount:1,sheetId:e.sheetId}).range;this.clearRect(t)}};var Mt;self.addEventListener("message",r=>{if(r.data.status==="formula"){let t={list:vn(r.data),status:"formula"};self.postMessage(t)}else if(r.data.status==="init")Mt=new rt(r.data.canvas),hr(r.data.dpr);else if(r.data.status==="render"){let e=Mt.render(r.data);if(e){let t={...e,status:"render"};self.postMessage(t)}}else r.data.status==="resize"&&Mt.resize(r.data)});function vn(r){let{currentSheetId:e,worksheets:t}=r,n=new Map,a=t[e]||{},u=[];for(let[d,g]of Object.entries(a))if(g?.formula){let b=wr(g.formula,r,n,Wt(d),u);b.result!==g.value&&u.push({key:d,newValue:b.result,sheetId:e})}return u}function wr(r,e,t,n,a){let u=t.get(r);if(u)return u;let{currentSheetId:d,worksheets:g,definedNames:b,workbook:f}=e,w=mt(r,{getCurrentCell:()=>n,get:y=>{let{row:S,col:D,sheetId:N}=y,_=N||d,T=[],X=f.find(ee=>ee.sheetId===_);if(!X||S>=X.rowCount||D>=X.colCount)throw new P("#REF!");let Y=g[_]||{};return er(y,X,(ee,z)=>{let le=Ht(ee,z);if(Y[le]){let se=Y[le].formula,Z=Y[le].value;if(se){let j=wr(se,e,t,{row:ee,col:z},a);j.result!==Z&&a.push({key:le,newValue:j.result,sheetId:_}),T.push(j?.result)}else T.push(Z)}return!1}),T},set:()=>{throw new P("#REF!")},convertSheetNameToSheetId:y=>f.find(S=>S.name===y)?.sheetId||""},{set:()=>{throw new P("#REF!")},get:y=>b[y]});return t.set(r,w),w}
//# sourceMappingURL=worker.js.map
