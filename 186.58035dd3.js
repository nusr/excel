"use strict";(self.webpackChunkexcel=self.webpackChunkexcel||[]).push([["186"],{5700:function(t,e,i){i.d(e,{Z:()=>b});var r=i("2712"),n=i("3438");function s(t){return t?"undefined"==typeof Intl||"function"!=typeof Intl.Segmenter?[...t]:[...new Intl.Segmenter([],{granularity:"word"}).segment(t)].map(t=>t.segment):[]}var h=i("6725"),o=i("9176"),l=i("20"),a=i("8024"),c=i("5923"),u=i("7620"),d=i("4642"),p=i("2716");let f=new Map;function g(t,e,i,r,n){t.fillRect((0,o.tt)(e),(0,o.tt)(i),(0,o.tt)(r),(0,o.tt)(n))}function m(t,e,i,r,n){t.strokeRect((0,o.tt)(e),(0,o.tt)(i),(0,o.tt)(r),(0,o.tt)(n))}function v(t,e,i,r,n){t.clearRect((0,o.tt)(e),(0,o.tt)(i),(0,o.tt)(r),(0,o.tt)(n))}function C(t,e,i,r){t.fillText(e,(0,o.tt)(i),(0,o.tt)(r))}function E(t,e){if(0!==e.length){t.beginPath();for(let i=0;i<e.length;i+=2){let r=e[i],n=e[i+1];t.moveTo((0,o.tt)(r[0]),(0,o.tt)(r[1])),t.lineTo((0,o.tt)(n[0]),(0,o.tt)(n[1]))}t.stroke()}}function w(t,e,i,r){t.beginPath(),t.moveTo((0,o.tt)(e[0]),(0,o.tt)(e[1])),t.lineTo((0,o.tt)(i[0]),(0,o.tt)(i[1])),t.lineTo((0,o.tt)(r[0]),(0,o.tt)(r[1])),t.fill()}function A(t,e,i){let r=t.slice(),[n,s]=t,h=2*c.py,o=i?h:0;return"bottom"===e?r.push([n[0]+o,n[1]-h],[s[0]-o,s[1]-h]):"top"===e?r.push([n[0]+o,n[1]+h],[s[0]-o,s[1]+h]):"left"===e?r.push([n[0]+h,n[1]+o],[s[0]+h,s[1]-o]):"right"===e&&r.push([n[0]-h,n[1]+o],[s[0]-h,s[1]-o]),r}function S(t,e,i,r,n){var s;let l;if(!i)return;let{top:a,left:u,width:d,height:p}=e,f=[];"top"===r?f=[[u,a],[u+d,a]]:"bottom"===r?f=[[u,a+p],[u+d,a+p]]:"left"===r?f=[[u,a],[u,a+p]]:"right"===r&&(f=[[u+d,a],[u+d,a+p]]);let{type:g,color:m}=i;t.lineWidth=c.xS[g],t.strokeStyle=m||(0,h.pe)("black",n);let v=(l=[],"hair"===(s=g)?l=[c.py,c.py]:"dotted"===s||"mediumDashed"===s?l=[2*c.py,2*c.py]:"dashed"===s?l=[4*c.py,4*c.py]:"dashDot"===s||"mediumDashDot"===s?l=[4*c.py,4*c.py,8*c.py,4*c.py]:("dashDotDot"===s||"mediumDashDotDot"===s)&&(l=[4*c.py,4*c.py,8*c.py,4*c.py,4*c.py,4*c.py]),l);"double"===g&&(f=A(f,r,!0)),v.length>0&&t.setLineDash(v.map(t=>(0,o.tt)(t))),E(t,f),v.length>0&&t.setLineDash([])}function R(t){return{textAlign:"center",textBaseline:"middle",font:(0,a.AY)(void 0,"500",(0,o.tt)(c.n5)),fillStyle:(0,h.pe)("black",t),lineWidth:c.py,strokeStyle:(0,h.pe)("borderColor",t)}}var y=i("8937"),x=i("1791");let T=Math.max(...Object.values(c.xS));class N{render(t){if(0===t.changeSet.size||this.isRendering)return;this.isRendering=!0,this.eventData=t,this.clear();let{ctx:e}=this;e.strokeStyle=(0,h.pe)("primaryColor",t.theme),e.fillStyle=(0,h.pe)("white",t.theme),e.lineWidth=2*c.py;let{width:i,height:r}=this.eventData.canvasSize,n=this.eventData.headerSize,{endRow:s,contentHeight:o}=this.renderRowsHeader(r),{endCol:l,contentWidth:a}=this.renderColsHeader(i);this.renderGrid(i-n.width,r-n.height),this.renderTriangle(),this.renderMergeCell(),this.ctx.fillStyle=(0,h.pe)("selectionColor",this.eventData.theme);let u=this.renderSelection({endRow:s,endCol:l,contentHeight:o,contentWidth:a});return this.renderAntLine(u),this.renderContent({endRow:s,endCol:l,contentHeight:o,contentWidth:a}),this.ctx.lineWidth=T,m(this.ctx,u.left,u.top,u.width,u.height),this.isRendering=!1,{rowMap:{...this.rowMap},colMap:{...this.colMap}}}resize(t){this.width=t.width,this.height=t.height,this.canvas.width=(0,o.tt)(t.width),this.canvas.height=(0,o.tt)(t.height)}clear(){v(this.ctx,0,0,this.width,this.height)}renderRowsHeader(t){let{row:e}=this.eventData.scroll,i=this.eventData.headerSize,{rowCount:r}=this.eventData.currentSheetInfo;this.ctx.save();let n=this.eventData.range;g(this.ctx,0,i.height,i.width,t),Object.assign(this.ctx,R(this.eventData.theme));let s=[],o=i.height,l=e;for(;l<r&&o<t;l++){let t=this.getRowHeight(l),r=o;if(l===e&&(r+=c.py/2),s.push([0,r],[i.width,r]),t>0){let e=this.isHighlightRow(n,l);this.ctx.fillStyle=e?(0,h.pe)("primaryColor",this.eventData.theme):(0,h.pe)("black",this.eventData.theme),C(this.ctx,String(l+1),i.width/2,r+t/2)}o+=t}s.push([0,o],[i.width,o]),s.push([0,0],[0,o]),E(this.ctx,s),this.ctx.restore();let a=l>=r?o:t;return{endRow:l,contentHeight:Math.floor(a)}}renderColsHeader(t){let{col:e,row:i}=this.eventData.scroll,r=this.eventData.headerSize,{colCount:n}=this.eventData.currentSheetInfo,s=this.eventData.range,o=[];this.ctx.save(),g(this.ctx,r.width,0,t,r.height),Object.assign(this.ctx,R());let l=r.width,a=e,u=this.eventData.autoFilter,d=0;for(let t=i;t<this.eventData.currentSheetInfo.rowCount&&0===(d=this.getRowHeight(i));t++);for(;a<n&&l<=t;a++){let t=this.getColWidth(a),i=l;if(a===e&&(i+=c.py/2),o.push([i,0],[i,r.height]),t>0){let e=this.isHighlightCol(s,a);this.ctx.fillStyle=e?(0,h.pe)("primaryColor",this.eventData.theme):(0,h.pe)("black",this.eventData.theme),C(this.ctx,(0,y.ar)(a),i+t/2,r.height/2)}u&&a>=u.range.col&&a<u.range.col+u.range.colCount&&this.renderFilter(l+t,r.height+d,u.col===a),l+=t}o.push([l,0],[l,r.height]),o.push([0,0],[l,0]),E(this.ctx,o),this.ctx.restore();let p=a>=n?l:t;return{endCol:a,contentWidth:Math.floor(p)}}renderFilter(t,e,i){let r=c.Eg,n=4*c.py,s=t-r-n,o=e-r-n;this.ctx.fillStyle=i?(0,h.pe)("primaryColor",this.eventData.theme):(0,h.pe)("borderColor",this.eventData.theme),this.ctx.strokeStyle=i?(0,h.pe)("primaryColor",this.eventData.theme):(0,h.pe)("borderColor",this.eventData.theme),m(this.ctx,s,o,r,r),w(this.ctx,[s+r/4,o+3*r/8],[s+3*r/4,o+3*r/8],[s+r/2,o+5*r/8])}renderGrid(t,e){let i=this.eventData.headerSize,{row:r,col:n}=this.eventData.scroll,{rowCount:s,colCount:l}=this.eventData.currentSheetInfo;this.ctx.save(),this.ctx.lineWidth=c.py,this.ctx.strokeStyle=(0,h.pe)("borderColor",this.eventData.theme),this.ctx.translate((0,o.tt)(i.width),(0,o.tt)(i.height));let a=[],u=0,d=0;for(let i=r;i<s&&u<=e;i++){for(;i<s&&0===this.getRowHeight(i);)i++;a.push([0,u],[t,u]),u+=this.getRowHeight(i)}for(let e=n;e<l&&d<=t;e++){for(;e<l&&0===this.getColWidth(e);)e++;a.push([d,0],[d,u]),d+=this.getColWidth(e)}a.push([0,u],[d,u]),a.push([d,0],[d,u]),E(this.ctx,a),this.ctx.restore()}renderTriangle(){let t=this.eventData.headerSize;this.ctx.save(),g(this.ctx,0,0,t.width,t.height),this.ctx.fillStyle=(0,h.pe)("triangleFillColor",this.eventData.theme);let e=Math.floor(2),i=Math.floor(t.height-2),r=Math.floor(.4*t.width),n=Math.floor(t.width-2);w(this.ctx,[n,e],[r,i],[n,i]),this.ctx.restore()}getRowHeight(t){let e=(0,p.kh)(this.eventData.currentSheetInfo.sheetId,t),i=this.eventData.customHeight[e];return i?i.isHide?c.Hl:i.len:c.Zv}getColWidth(t){let e=(0,p.kh)(this.eventData.currentSheetInfo.sheetId,t),i=this.eventData.customWidth[e];return i?i.isHide?c.Hl:i.len:c._g}isHighlightRow(t,e){return!!((0,x.bP)(t)||(0,x.B1)(t))||!!(e>=t.row)&&!!(e<t.row+t.rowCount)||!1}isHighlightCol(t,e){return!!((0,x.bP)(t)||(0,x.jC)(t))||!!(e>=t.col)&&!!(e<t.col+t.colCount)||!1}renderAntLine(t){let e=this.eventData.copyRange;if(!!e&&e.sheetId===this.eventData.currentSheetInfo.sheetId)this.ctx.lineWidth=T,this.ctx.strokeStyle=(0,h.pe)("primaryColor",this.eventData.theme),!function(t,e,i,r,n){t.setLineDash([(0,o.tt)(8),(0,o.tt)(6)]);let s=c.py;m(t,e+s,i+s,r-2*s,n-2*s),t.setLineDash([])}(this.ctx,t.left,t.top,t.width,t.height)}renderMergeCell(){let t=this.eventData.currentMergeCells;if(0===t.length)return;let e=this.eventData.range;for(let i of t){if(e.row!==i.row||e.col!==i.col)this.clearRect(i)}}getCellSize(t){let{row:e,col:i,colCount:r,rowCount:n}=t,s=e,h=i,o=e+n,l=i+r,a=this.eventData.currentSheetInfo;(0,x.bP)(t)?(h=0,l=a.colCount,s=0,o=a.rowCount):(0,x.B1)(t)?(s=0,o=a.rowCount):(0,x.jC)(t)&&(h=0,l=a.colCount);let c=0,u=0;for(;s<o;s++)u+=this.getRowHeight(s);for(;h<l;h++)c+=this.getColWidth(h);return{width:c,height:u}}computeCellPosition(t){let{row:e,col:i}=t,r=this.eventData.headerSize,n=this.eventData.scroll,s=r.width,h=r.height,o=n.row,l=n.col;if(i>=n.col)for(;l<i;)s+=this.getColWidth(l),l++;else for(s=-r.width;l>i;)s-=this.getColWidth(l),l--;if(e>=n.row)for(;o<e;)h+=this.getRowHeight(o),o++;else for(h=-r.height;o>e;)h-=this.getRowHeight(o),o--;return{top:h,left:s}}getActiveRange(t){let e=t||this.eventData.range;for(let t of this.eventData.currentMergeCells)if((0,x.PI)(e,t))return{range:{...t,sheetId:t.sheetId},isMerged:!0};return{range:e,isMerged:!1}}clearRect(t){let e=this.getCellSize(t);if(e.width<=0||e.height<=0)return;let i=this.computeCellPosition(t),r=c.py;v(this.ctx,i.left+r,i.top+r,e.width-2*r,e.height-2*r)}renderContent(t){let{endCol:e,endRow:i,contentHeight:r,contentWidth:n}=t,{ctx:s}=this;s.textAlign="left",s.textBaseline="top",s.lineWidth=2*c.py;let h=this.eventData.headerSize,{row:o,col:l}=this.eventData.scroll,a=Math.floor(n-h.width),u=Math.floor(r-h.height);s.save(),this.rowMap={},this.colMap={};let d=this.eventData.currentMergeCells;for(let t=o;t<i;t++)for(let i=l;i<e;i++){let e=d.find(e=>e.row===t&&e.col===i);this.renderCell(t,i,e,a,u)}s.restore()}renderCell(t,e,i,r,n){var m,v,w,R;let{ctx:y}=this,x={row:t,col:e,rowCount:1,colCount:1,sheetId:""},T=(0,p.uJ)(t,e),N=this.eventData.sheetData[T];if(!N)return;let M=this.getCellSize(i||x);if(M.width<=0||M.height<=0)return;let b=this.computeCellPosition(x);y.lineWidth=2*c.py;let k=this.eventData.theme,L=function(t,e,i,r,n,m){var v,w;let S={height:0,width:0};if(""===i&&(0,l.xb)(r))return S;let R=(null==r?void 0:r.numberFormat)||c.s8,y=R===c.s8&&"number"==typeof i,x=(0,d.Y4)(i,R),T=(null==r?void 0:r.fontSize)?r.fontSize:c.n5,N=(0,a.AY)((null==r?void 0:r.isItalic)?"italic":"normal",(null==r?void 0:r.isBold)?"bold":"500",(0,o.tt)(T),null==r?void 0:r.fontFamily);(null==r?void 0:r.fillColor)&&(t.fillStyle=null==r?void 0:r.fillColor,g(t,e.left,e.top,e.width,e.height));let M=(null==r?void 0:r.fontColor)||(0,h.pe)("contentColor",m);c.BD.has(x)&&(M=(0,h.pe)("errorFormulaColor",m)),t.font=N,t.fillStyle=M;let b=r?{...r}:{},k=null==b?void 0:b.horizontalAlign;(null==b?void 0:b.horizontalAlign)===void 0&&y&&(k=u.KM.RIGHT),b.horizontalAlign=k;let{width:L,height:I,resultList:D}=function(t,e,i,r){let n=(null==i?void 0:i.fontSize)?i.fontSize:c.n5,s=Math.ceil(n*(h.pt.lineHeight-1)/2),o=(null==i?void 0:i.verticalAlign)??u._v.MIDDLE,{left:l,top:a,height:d}=e,p=Math.max(e.width,...t.map(t=>t.width)),f=[],g=0,m=0;if((null==i?void 0:i.isWrapText)&&r){let e=0;for(let i=0;i<t.length;i++){let r=t[i];g=Math.max(g,r.width);let n=r.height+2*s;m+=n,f.push({text:r.str,x:0,y:e,width:r.width,height:r.height}),e+=n}}else if(null==i?void 0:i.isWrapText){let e=0;for(let i=0;i<t.length;){let r=p,n="",h=0,o=0;for(;i<t.length;){let e=t[i];if(r>=e.width)h+=e.width,o=Math.max(o,e.height),r-=e.width,n+=e.str,i++;else break}if(n){g=Math.max(g,h);let t=o+2*s;m+=t,f.push({text:n,x:0,y:e,width:h,height:o}),e+=t}}}else{let e="",i=p;for(let r=0;r<t.length;r++){let n=t[r];if(i>=n.width)g+=n.width,m=Math.max(m,n.height),e+=n.str,i-=n.width;else break}f.push({text:e,x:0,y:0,width:g,height:m})}if(m=Math.max(m,n*h.pt.lineHeight),g+=s,m+=s,g<=p&&m<=d){let t=l+s,e=a+(d-m)/2+s;for(let r of(o===u._v.TOP?e=a+s:o===u._v.BOTTOM&&(e=a+(d-m)+s),(null==i?void 0:i.horizontalAlign)===u.KM.CENTER?t=l+(p-g)/2:(null==i?void 0:i.horizontalAlign)===u.KM.RIGHT&&(t=l+(p-g)-s),f))r.x=r.x+t,r.y=r.y+e}return{width:g,height:m,resultList:f}}((!(null==b?void 0:b.isWrapText)&&(0,d.V5)(R)?[x]:(v=x,w=null==r?void 0:r.isWrapText,n?w?v.split(c.NJ):s(v.replaceAll(c.NJ,"")):s(v))).map(e=>{let i=function(t,e){let i=`${e}__${t.font}`;if(f.has(i))return f.get(i);let r=t.measureText(e),{actualBoundingBoxAscent:n,actualBoundingBoxDescent:s}=r,h=Math.ceil(r.width/(0,o.uN)()),l={width:h,height:Math.ceil((n+s)/(0,o.uN)())};return f.set(i,l),l}(t,e);return{str:e,width:i.width,height:0===i.height?T:i.height}}),e,b,(0,p.dM)(!!n,x));if(L>0&&I>0){let e=Math.ceil(T*(h.pt.lineHeight-1)/2),i=[];for(let r of D){if(C(t,r.text,r.x,r.y),null==b?void 0:b.underline){t.strokeStyle=M;let n=r.y+r.height+e/2,s=[[r.x,n],[r.x+r.width,n]];i=(null==b?void 0:b.underline)===u.nI.DOUBLE?i.concat(A(s,"bottom",!1)):i.concat(s)}if(null==b?void 0:b.isStrike){t.strokeStyle=M;let n=r.y+r.height/2+e/2;i=i.concat([[r.x,n],[r.x+r.width,n]])}}E(t,i)}return S.height=Math.ceil(I),S.width=Math.ceil(L),S}(y,{top:b.top,left:b.left,width:Math.min(M.width,r),height:Math.min(M.height,n)},N.value,N.style,!!i,k),I=Math.max(this.rowMap[t]??0,L.height),D=Math.max(this.colMap[e]??0,L.width);I>=c.Zv&&(this.rowMap[t]=I),D>=c._g&&(this.colMap[e]=D);let O={top:b.top,left:b.left,height:Math.max(I,M.height),width:Math.max(D,M.width)};S(y,O,null===(m=N.style)||void 0===m?void 0:m.borderTop,"top",k),S(y,O,null===(v=N.style)||void 0===v?void 0:v.borderBottom,"bottom",k),S(y,O,null===(w=N.style)||void 0===w?void 0:w.borderLeft,"left",k),S(y,O,null===(R=N.style)||void 0===R?void 0:R.borderRight,"right",k)}renderSelection(t){let e=this.eventData.range;return(0,x.bP)(e)?this.renderSelectAll(t):(0,x.B1)(e)?this.renderSelectCol(t):(0,x.jC)(e)?this.renderSelectRow(t):this.renderSelectRange()}renderSelectRange(){let t=this.eventData.headerSize,e=this.eventData.range,i=this.computeCellPosition({row:e.row,col:e.col,rowCount:1,colCount:1,sheetId:""}),r=e.row+e.rowCount-1,n={row:r,col:e.col+e.colCount-1,rowCount:1,colCount:1,sheetId:""},s=this.computeCellPosition(n),h=this.getCellSize(n),o=s.left+h.width-i.left,l=s.top+h.height-i.top;g(this.ctx,i.left,0,o,t.height),g(this.ctx,0,i.top,t.width,l);let a=e.rowCount>1||e.colCount>1;a&&g(this.ctx,i.left,i.top,o,l);let c=[[i.left,t.height],[i.left+o,t.height]];return c.push([t.width,i.top],[t.width,i.top+l]),E(this.ctx,c),a&&this.renderActiveCell(),{left:i.left,top:i.top,width:o,height:l}}renderSelectAll(t){let{contentHeight:e,contentWidth:i}=t,r=this.eventData.headerSize;g(this.ctx,0,0,i,e),this.renderActiveCell();let n=i-r.width,s=e-r.height;return{left:r.width,top:r.height,width:n,height:s}}renderSelectCol(t){let{contentHeight:e}=t,i=this.eventData.headerSize,r=this.eventData.range,n=this.computeCellPosition(r),s=0;for(let t=r.col,e=r.col+r.colCount;t<e;t++)s+=this.getColWidth(t);let h=e-i.height;g(this.ctx,n.left,0,s,e),g(this.ctx,0,n.top,i.width,h);let o=[[i.width,i.height],[i.width,e]];return E(this.ctx,o),this.renderActiveCell(),{left:n.left,top:i.height,width:s,height:h}}renderSelectRow(t){let{contentWidth:e}=t,i=this.eventData.headerSize,r=this.eventData.range,n=this.computeCellPosition(r),s=0;for(let t=r.row,e=r.row+r.rowCount;t<e;t++)s+=this.getRowHeight(t);let h=e-i.width-c.py;g(this.ctx,n.left,0,h,i.height),g(this.ctx,0,n.top,e,s);let o=[[n.left,i.height],[e,i.height]];return E(this.ctx,o),this.renderActiveCell(),{left:i.width,top:n.top,width:h,height:s}}renderActiveCell(){let t=this.eventData.range,e=this.getActiveRange({row:t.row,col:t.col,rowCount:1,colCount:1,sheetId:t.sheetId}).range;this.clearRect(e)}constructor(t){(0,n._)(this,"canvas",void 0),(0,n._)(this,"ctx",void 0),(0,n._)(this,"width",0),(0,n._)(this,"height",0),(0,n._)(this,"isRendering",!1),(0,n._)(this,"rowMap",{}),(0,n._)(this,"colMap",{}),(0,n._)(this,"eventData",{theme:"light",sheetData:{},canvasSize:{top:0,left:0,width:0,height:0},headerSize:{width:0,height:0},currentSheetInfo:{isHide:!1,rowCount:0,colCount:0,name:"",sheetId:"",tabColor:"",sort:1},scroll:{left:0,top:0,row:0,col:0,scrollLeft:0,scrollTop:0},range:{row:0,col:0,rowCount:1,colCount:1,sheetId:""},copyRange:void 0,customHeight:{},customWidth:{},currentMergeCells:[],autoFilter:void 0}),this.canvas=t,this.ctx=t.getContext("2d");let e=(0,o.uN)();this.ctx.scale(e,e)}}let M=null,b={init(t){M=new N(t.canvas),(0,o.BR)(t.dpr)},resize(t){null==M||M.resize(t)},async render(t,e){let i=null==M?void 0:M.render(t);i&&await e(i)},computeFormulas:r.A}},2712:function(t,e,i){i.d(e,{A:()=>F});var r,n=i("3438");var s=((r={})[r.EQUAL=0]="EQUAL",r[r.NOT_EQUAL=1]="NOT_EQUAL",r[r.PLUS=2]="PLUS",r[r.MINUS=3]="MINUS",r[r.STAR=4]="STAR",r[r.SLASH=5]="SLASH",r[r.EXPONENT=6]="EXPONENT",r[r.GREATER=7]="GREATER",r[r.GREATER_EQUAL=8]="GREATER_EQUAL",r[r.CONCATENATE=9]="CONCATENATE",r[r.COLON=10]="COLON",r[r.COMMA=11]="COMMA",r[r.EMPTY_CHAR=12]="EMPTY_CHAR",r[r.PERCENT=13]="PERCENT",r[r.LESS=14]="LESS",r[r.LESS_EQUAL=15]="LESS_EQUAL",r[r.STRING=16]="STRING",r[r.NUMBER=17]="NUMBER",r[r.BOOL=18]="BOOL",r[r.ERROR=19]="ERROR",r[r.ERROR_REF=20]="ERROR_REF",r[r.LEFT_BRACKET=21]="LEFT_BRACKET",r[r.RIGHT_BRACKET=22]="RIGHT_BRACKET",r[r.lEFT_BRACE=23]="lEFT_BRACE",r[r.RIGHT_BRACE=24]="RIGHT_BRACE",r[r.SEMICOLON=25]="SEMICOLON",r[r.EXCLAMATION=26]="EXCLAMATION",r[r.R1C1=27]="R1C1",r[r.SHEET_NAME=28]="SHEET_NAME",r[r.CELL=29]="CELL",r[r.COLUMN=30]="COLUMN",r[r.ROW=31]="ROW",r[r.DEFINED_NAME=32]="DEFINED_NAME",r[r.EXCEL_FUNCTION=33]="EXCEL_FUNCTION",r[r.REF_FUNCTION=34]="REF_FUNCTION",r[r.REF_FUNCTION_COND=35]="REF_FUNCTION_COND",r[r.EOF=36]="EOF",r);class h{toString(){return this.value}constructor(t,e){(0,n._)(this,"type",void 0),(0,n._)(this,"value",void 0),this.type=t,this.value=e}}var o=i("5923"),l=i("2716");class a extends Error{constructor(t){super(t),(0,n._)(this,"value",void 0),this.value=t}}function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#VALUE!";if(!t)throw new a(e)}function u(t){c(1===t.length);let[e]=t;return e}function d(t){let e=u(t);return c("string"==typeof e),e}function p(t){let e=u(t),[i,r]=(0,l.p3)(e);return c(i),r}var f=i("4642");let g=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return String.fromCharCode(p(e))},m=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return d(e).charCodeAt(0)},v=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return c(e.length<=o.tO),e.join("")};function C(t){let e=[];for(let i=0;i<t.length;i++){let[r,n]=(0,l.p3)(t[i]);r&&e.push(n)}return e}let E={CONCAT:v,CONCATENATE:v,SPLIT:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];c(2===e.length);let[r,n]=e;return c("string"==typeof r),c("string"==typeof n),r.split(n)},CHAR:g,CODE:m,UNICHAR:g,UNICODE:m,LEN:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return d(e).length},LOWER:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return d(e).toLowerCase()},UPPER:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return d(e).toUpperCase()},TRIM:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return d(e).replace(/ +/g," ").trim()},TEXT:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];c(2===e.length);let[r,n]=e;return c("string"==typeof r||"number"==typeof r),c("string"==typeof n),(0,f.Y4)(r,n)},T:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let r=u(e);return"string"==typeof r?r:""},ABS:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return Math.abs(p(e))},ACOS:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return Math.acos(p(e))},ACOSH:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let r=p(e);return Math.log(r+Math.sqrt(r*r-1))},ACOT:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return Math.atan(1/p(e))},ACOTH:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let r=p(e);return .5*Math.log((r+1)/(r-1))},ASIN:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return Math.asin(p(e))},ASINH:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let r=p(e);return Math.log(r+Math.sqrt(r*r+1))},ATAN:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return Math.atan(p(e))},ATAN2:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];c(2===e.length);let[r,n]=e;return c("number"==typeof r),c("number"==typeof n),Math.atan2(r,n)},ATANH:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let r=p(e);return Math.log((1+r)/(r+1))/2},AVERAGE:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let r=C(e);return c(r.length<=o.tO&&r.length>=1),r.reduce((t,e)=>t+e,0)/r.length},COT:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return 1/Math.tan(p(e))},COS:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return Math.cos(p(e))},EXP:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return Math.exp(p(e))},INT:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return Math.floor(p(e))},PI:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return c(0===e.length),Math.PI},SIN:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return Math.sin(p(e))},SUM:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let r=C(e);return c(r.length<=o.tO),r.reduce((t,e)=>t+e,0)}};var w=i("3397");class A{scan(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();return this.tokens.push(new h(s.EOF,"")),this.tokens.length>0&&this.tokens[0].type===s.EQUAL&&this.tokens.shift(),this.tokens}peek(){return this.isAtEnd()?"":this.list[this.current]}match(t){return this.peek()===t&&(this.next(),!0)}next(){return this.isAtEnd()?"":this.list[this.current++]}isAtEnd(){return this.current>=this.list.length}addToken(t){let e=this.list.slice(this.start,this.current).join("");this.tokens.push(new h(t,e))}string(t){for(;!this.isAtEnd()&&this.peek()!==t;)this.next();if(this.peek()!==t)throw new a("#VALUE!");this.next();let e=this.list.slice(this.start+1,this.current-1).join("");if("'"===t&&this.match("!")){this.tokens.push(new h(s.SHEET_NAME,e));return}this.tokens.push(new h(s.STRING,e))}getDigits(){for(;!this.isAtEnd()&&(0,w.X1)(this.peek());)this.next()}getAlphas(){for(;!this.isAtEnd()&&(0,w.$9)(this.peek());)this.next()}matchR1C1(){if(this.match("[")){if(this.match("-"),(0,w.X1)(this.peek()))this.getDigits();else throw new a("#VALUE!");if("]"!==this.peek())throw new a("#VALUE!");this.next()}else this.getDigits()}matchScientificCounting(){if(this.match("E")||this.match("e")){if(this.match("+")||this.match("-")||(0,w.X1)(this.peek()))return this.getDigits(),this.addToken(s.NUMBER),!0;throw new a("#VALUE!")}return!1}number(){if(this.getDigits(),this.matchScientificCounting())return;if(this.match(".")&&this.getDigits(),!this.matchScientificCounting())this.addToken(s.NUMBER)}addIdentifier(){for(;!this.isAtEnd()&&this.anyChar(this.peek());)this.next();let t=this.list.slice(this.start,this.current).join(""),e=t.toUpperCase();if(o.Gl.has(e)&&this.match("(")){this.tokens.push(new h(s.EXCEL_FUNCTION,e));return}if(["IF","CHOOSE"].includes(e)&&this.match("(")){this.tokens.push(new h(s.REF_FUNCTION_COND,e));return}if(["INDEX","OFFSET","INDIRECT"].includes(e)&&this.match("(")){this.tokens.push(new h(s.REF_FUNCTION,e));return}if(this.match("!")){this.tokens.push(new h(s.SHEET_NAME,t));return}let i=s.BOOL;if("TRUE"===e||"FALSE"===e)t=e,i=s.BOOL;else if(o.BD.has(e))t=e,i="#REF!"===e?s.ERROR_REF:s.ERROR;else if(o.Dk.test(e))i=s.CELL;else if(o.n6.test(e))i=s.COLUMN;else if(o.s4.test(e))i=s.ROW;else if(o.Mz.test(e))i=s.DEFINED_NAME;else throw new a("#NAME?");this.tokens.push(new h(i,t))}scanToken(){let t=this.next();switch(t){case"$":(0,w.$9)(this.peek())?(this.getAlphas(),this.match("$")?(0,w.X1)(this.peek())?(this.getDigits(),this.addToken(s.CELL)):this.addIdentifier():(0,w.X1)(this.peek())?(this.getDigits(),this.addToken(s.CELL)):this.addToken(s.COLUMN)):(0,w.X1)(this.peek())?(this.getDigits(),this.addToken(s.ROW)):this.addIdentifier();break;case"r":case"R":if(this.matchR1C1(),this.match("C")||this.match("c")){this.matchR1C1();let t=this.list.slice(this.start,this.current).join("").toUpperCase();this.tokens.push(new h(s.R1C1,t))}else this.addIdentifier();break;case"(":this.addToken(s.LEFT_BRACKET);break;case")":this.addToken(s.RIGHT_BRACKET);break;case",":this.addToken(s.COMMA);break;case":":this.addToken(s.COLON);break;case o.Ob:this.addToken(s.EQUAL);break;case"<":this.match(">")?this.addToken(s.NOT_EQUAL):this.match("=")?this.addToken(s.LESS_EQUAL):this.addToken(s.LESS);break;case">":this.match("=")?this.addToken(s.GREATER_EQUAL):this.addToken(s.GREATER);break;case"+":this.addToken(s.PLUS);break;case"-":this.addToken(s.MINUS);break;case"*":this.addToken(s.STAR);break;case"/":this.addToken(s.SLASH);break;case"^":this.addToken(s.EXPONENT);break;case"&":this.addToken(s.CONCATENATE);break;case"%":this.addToken(s.PERCENT);break;case'"':case"'":this.string(t);break;case"!":this.addToken(s.EXCLAMATION);break;case";":this.addToken(s.SEMICOLON);break;case"{":this.addToken(s.lEFT_BRACE);break;case"}":this.addToken(s.RIGHT_BRACE);break;case" ":case"\r":case"	":case"\n":break;default:(0,w.X1)(t)?this.number():this.addIdentifier()}}anyChar(t){return!'(),:=<>+-*/^&%"{}!'.includes(t)&&!this.isWhiteSpace(t)}isWhiteSpace(t){return" "===t||"\r"===t||"\n"===t||"	"===t}constructor(t){(0,n._)(this,"list",void 0),(0,n._)(this,"current",0),(0,n._)(this,"start",0),(0,n._)(this,"tokens",[]),this.list=[...t]}}class S{accept(t){return t.visitBinaryExpression(this)}handleConcatenate(t){let e=t.toString();return this.operator.type===s.CONCATENATE&&t instanceof x&&t.value.type===s.STRING?JSON.stringify(e):e}toString(){let t=this.handleConcatenate(this.left),e=this.handleConcatenate(this.right);return`${t}${this.operator.toString()}${e}`}constructor(t,e,i){(0,n._)(this,"left",void 0),(0,n._)(this,"right",void 0),(0,n._)(this,"operator",void 0),this.left=t,this.operator=e,this.right=i}}class R{accept(t){return t.visitUnaryExpression(this)}toString(){return this.operator.toString()+this.right.toString()}constructor(t,e){(0,n._)(this,"right",void 0),(0,n._)(this,"operator",void 0),this.operator=t,this.right=e}}class y{accept(t){return t.visitPostUnaryExpression(this)}toString(){return this.left.toString()+this.operator.toString()}constructor(t,e){(0,n._)(this,"left",void 0),(0,n._)(this,"operator",void 0),this.operator=t,this.left=e}}class x{accept(t){return t.visitLiteralExpression(this)}toString(){return this.value.toString()}constructor(t){(0,n._)(this,"value",void 0),this.value=t}}class T{accept(t){return t.visitCellExpression(this)}toString(){let t=this.value.toString().toUpperCase();if(!this.sheetName)return t;{let e=this.sheetName.toString();return e.includes(" ")&&(e=`'${e}'`),`${e}!${t}`}}constructor(t,e){(0,n._)(this,"value",void 0),(0,n._)(this,"sheetName",void 0),this.value=t,this.sheetName=e}}class N{accept(t){return t.visitCallExpression(this)}toString(){return`${this.name.toString()}(${this.params.map(t=>t.toString()).join(",")})`}constructor(t,e){(0,n._)(this,"name",void 0),(0,n._)(this,"params",void 0),this.name=t,this.params=e}}class M{accept(t){return t.visitCellRangeExpression(this)}toString(){return this.left.toString()+this.operator.toString()+this.right.toString()}constructor(t,e,i){(0,n._)(this,"right",void 0),(0,n._)(this,"operator",void 0),(0,n._)(this,"left",void 0),this.left=t,this.operator=e,this.right=i}}class b{accept(t){return t.visitGroupExpression(this)}toString(){return`(${this.value.toString()})`}constructor(t){(0,n._)(this,"value",void 0),this.value=t}}class k{accept(t){return t.visitArrayExpression(this)}toString(){let t=this.value.map(t=>t.toString()).join(",");return`{${t}}`}constructor(t){(0,n._)(this,"value",void 0),this.value=t}}class L{parse(){let t=[];for(;!this.isAtEnd();)t.push(this.expression());return t}expression(){return this.comparison()}comparison(){let t=this.concatenate();for(;this.match(s.EQUAL,s.NOT_EQUAL,s.GREATER,s.GREATER_EQUAL,s.LESS,s.LESS_EQUAL);){let e=this.previous();t=new S(t,e,this.concatenate())}return t}concatenate(){let t=this.term();for(;this.match(s.CONCATENATE);){let e=this.previous();t=new S(t,e,this.term())}return t}term(){let t=this.factor();for(;this.match(s.PLUS,s.MINUS);){let e=this.previous();t=new S(t,e,this.factor())}return t}factor(){let t=this.expo();for(;this.match(s.SLASH,s.STAR);){let e=this.previous();t=new S(t,e,this.expo())}return t}expo(){let t=this.unary();for(;this.match(s.EXPONENT);){let e=this.previous();t=new S(t,e,this.unary())}return t}unary(){if(this.match(s.PLUS,s.MINUS)){let t=this.previous();return new R(t,this.unary())}return this.postUnary()}postUnary(){let t=this.cellRange();return this.match(s.PERCENT)&&(t=new y(this.previous(),t)),t}cellRange(){let t=this.sheetRange();for(;this.match(s.COLON);){let e=this.previous(),i=this.sheetRange(),r=this.convertToCellExpression(i);t=new M(this.convertToCellExpression(t),e,r)}return t}convertToCellExpression(t){if(t instanceof T)return t;if(t instanceof x&&t.value.type===s.NUMBER)return new T(t.value,void 0);throw new a("#NAME?")}sheetRange(){if(this.match(s.SHEET_NAME)){let t=this.previous(),e=this.call();if(e instanceof T)return new T(e.value,t);throw new a("#REF!")}return this.call()}call(){for(;this.match(s.EXCEL_FUNCTION,s.REF_FUNCTION,s.REF_FUNCTION_COND);){let t=this.previous(),e=[];if(!this.check(s.RIGHT_BRACKET))do{if(this.peek().type==s.RIGHT_BRACKET)break;e.push(this.expression())}while(this.match(s.COMMA));return this.expect(s.RIGHT_BRACKET),new N(t,e)}return this.primary()}primary(){if(this.match(s.lEFT_BRACE)){let t=[];do{if(this.peek().type==s.RIGHT_BRACE)break;t.push(this.expression())}while(this.match(s.COMMA));return this.expect(s.RIGHT_BRACE),new k(t)}if(this.match(s.LEFT_BRACKET)){let t=this.expression();return this.expect(s.RIGHT_BRACKET),new b(t)}if(this.match(s.NUMBER,s.STRING,s.BOOL))return new x(this.previous());if(this.match(s.CELL,s.COLUMN,s.ROW,s.DEFINED_NAME,s.R1C1))return new T(this.previous(),void 0);if(this.match(s.ERROR,s.ERROR_REF))throw new a(this.previous().value);throw new a("#VALUE!")}match(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let{type:r}=this.peek();return!!e.includes(r)&&(this.next(),!0)}previous(){return this.tokens[this.current-1]}check(t){return this.peek().type===t}expect(t){if(this.check(t))return this.next(),this.previous();throw new a("#VALUE!")}next(){this.current++}isAtEnd(){return this.peek().type===s.EOF}peek(){return this.current<this.tokens.length?this.tokens[this.current]:new h(s.EOF,"")}constructor(t){(0,n._)(this,"tokens",void 0),(0,n._)(this,"current",0),this.tokens=t}}var I=i("1791");class D{interpret(){let t=[];for(let e of this.expressions){let i=this.evaluate(e),r=this.getRangeCellValue(i);Array.isArray(r)?t=t.concat(r):t.push(r)}return t}visitBinaryExpression(t){let e=this.evaluate(t.left),i=this.evaluate(t.right);switch(e=this.getOneValue(e),i=this.getOneValue(i),[s.MINUS,s.PLUS,s.SLASH,s.STAR,s.EXPONENT].includes(t.operator.type)&&(e=this.parseNumber(e),i=this.parseNumber(i)),t.operator.type){case s.MINUS:return e-i;case s.PLUS:return e+i;case s.SLASH:if(0===i)throw new a("#DIV/0!");return e/i;case s.STAR:return e*i;case s.EXPONENT:return Math.pow(e,i);case s.EQUAL:return e===i;case s.NOT_EQUAL:return e!==i;case s.GREATER:return e>i;case s.GREATER_EQUAL:return e>=i;case s.LESS:return e<i;case s.LESS_EQUAL:return e<=i;case s.CONCATENATE:return`${e}${i}`;default:throw new a("#TEXT")}}visitCallExpression(t){let e=this.cellDataMap.getFunction(t.name.value);if(e&&"function"==typeof e){let i=[];for(let e of t.params){let t=this.evaluate(e);if(t instanceof I.Nq){let e=this.getCellValue(t,!1);i=i.concat(e)}else i.push(t)}return e(...i)}throw new a("#NAME?")}visitCellExpression(t){let e,i="";if(t.sheetName){let e=this.cellDataMap.getSheetInfo("",t.sheetName.value);if(!(null==e?void 0:e.sheetId))throw new a("#REF!");i=e.sheetId}if([s.DEFINED_NAME,s.CELL,s.COLUMN,s.R1C1].includes(t.value.type)&&(e=this.cellDataMap.getDefinedName(t.value.value)),!e&&(e=t.value.type===s.R1C1?(0,w.hh)(t.value.value,this.currentCoord):(0,w.gx)(t.value.value)),!e)throw new a("#REF!");return i&&(e.sheetId=i),e}visitLiteralExpression(t){let{type:e,value:i}=t.value;switch(e){case s.STRING:return i;case s.NUMBER:{let[t,e]=(0,l.p3)(i);if(t)return e;throw new a("#VALUE!")}case s.BOOL:return"TRUE"===i;default:throw new a("#VALUE!")}}visitUnaryExpression(t){let e=this.evaluate(t.right),i=this.parseNumber(this.getOneValue(e));switch(t.operator.type){case s.MINUS:return-i;case s.PLUS:return i;default:throw new a("#VALUE!")}}visitCellRangeExpression(t){if(t.operator.type===s.COLON){let e=this.visitCellExpression(t.left),i=this.visitCellExpression(t.right),r=(0,w.d1)(e,i);if(!r)throw new a("#NAME?");return r}throw new a("#NAME?")}visitGroupExpression(t){return this.evaluate(t.value)}visitArrayExpression(t){let e=[];for(let i of t.value)e.push(this.evaluate(i));return e}visitPostUnaryExpression(t){let e=this.evaluate(t.left),i=this.parseNumber(this.getOneValue(e));if(t.operator.type===s.PERCENT)return .01*i;throw new a("#VALUE!")}evaluate(t){return t.accept(this)}getRangeCellValue(t){if(t instanceof I.Nq){if(t.colCount===t.rowCount&&1===t.colCount)return this.getCellValue(t,!0);throw new a("#REF!")}return t}getOneValue(t){let e=this.getRangeCellValue(t);return Array.isArray(e)?e[0]:e}parseNumber(t){let[e,i]=(0,l.p3)(t);if(!e)throw new a("#VALUE!");return i}getCellValue(t,e){let i=[];if(e){let e=this.cellDataMap.getCell(t),r=this.cellDataMap.handleCell(e,{row:t.row,col:t.col});return i=i.concat(r)}let{row:r,col:n,sheetId:s}=t,h=this.cellDataMap.getSheetInfo(s);if(!h||r>=h.rowCount||n>=h.colCount)throw new a("#REF!");return(0,I.m5)(t,h.rowCount,h.colCount,(t,e)=>{let r=this.cellDataMap.getCell({row:t,col:e,rowCount:1,colCount:1,sheetId:s}),n=this.cellDataMap.handleCell(r,{row:t,col:e});return i=i.concat(n),!1}),i}constructor(t,e,i){(0,n._)(this,"expressions",void 0),(0,n._)(this,"cellDataMap",void 0),(0,n._)(this,"currentCoord",void 0),this.expressions=t,this.cellDataMap=i,this.currentCoord=e}}var O=i("9111");let _="_test_";class U{getKey(t,e,i){return`${t}_${e}_${i||_}`}setSheetList(t){this.sheetList=t}set(t,e){let{row:i,col:r,sheetId:n}=t;for(let t=0;t<e.length;t++)for(let s=0;s<e[t].length;s++){let h=this.getKey(i+t,r+s,n),o=e[t][s];"string"==typeof o&&(0,l.jr)(o)?this.map.set(h,{formula:o,value:""}):this.map.set(h,{value:o})}}getCell(t){let{row:e,col:i,sheetId:r}=t,n=this.getKey(e,i,r);return this.map.get(n)}getSheetInfo(t,e){if(e)return this.sheetList.find(t=>t.name===e);let i=t||this.currentSheetId;return this.sheetList.find(t=>t.sheetId===i)}setDefinedName(t,e){let i=O.Nq.makeRange(e);this.definedNameMap.set(t,i)}getDefinedName(t){return this.definedNameMap.get(t)}constructor(){(0,n._)(this,"map",new Map),(0,n._)(this,"definedNameMap",new Map),(0,n._)(this,"currentSheetId",_),(0,n._)(this,"sheetList",[{sheetId:_,name:"_test_",rowCount:200,colCount:30,isHide:!1,sort:1}]),(0,n._)(this,"getFunction",t=>E[t]),(0,n._)(this,"handleCell",(t,e)=>t?[t.value]:[])}}function F(t,e){let{currentSheetId:i,worksheets:r,workbook:n,definedNames:s}=t,h=new Map,c=r[i]||{},u={list:[]},d={handleCell:()=>[],getFunction:t=>E[t],getCell:t=>{let{row:e,col:n,sheetId:s}=t,h=r[s||i]||{};return h[(0,l.uJ)(e,n)]},set:()=>{throw new a("#REF!")},getSheetInfo:(t,e)=>{if(e)return n.find(t=>t.name===e);let r=t||i;return n.find(t=>t.sheetId===r)},setDefinedName:()=>{throw new a("#REF!")},getDefinedName:t=>{let e=s[t];return e?O.Nq.makeRange(e):e}};for(let[t,e]of Object.entries(c)){if(!(null==e?void 0:e.formula))continue;let r=function t(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{row:0,col:0},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new U,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map;if(n.has(e)){let t=n.get(e);return 0===t.result.length?{result:[0]}:t}try{r.handleCell=(e,i)=>{if(e)return e.formula?t(e.formula,i,r,n).result:[e.value];return[]};let s={result:[],expressionStr:""};n.set(e,s);let h=new A(e).scan(),l=new L(h).parse(),a=new D(l,i,r).interpret(),c=[];for(let t of l)c.push(t.toString());for(let t of(s.expressionStr=c.join(""),a))"number"!=typeof t||isNaN(t)?s.result.push(t):s.result.push(function(t){let e=String(t),i=/[.](\d*)/.exec(e);if(!i||!i[1])return t;{let t=Math.pow(10,Math.min(i[1].length,o.Jt)),r=e.split(".");return Number(r[0]+r[1].slice(0,o.Jt))/t}}(t));return s}catch(t){if(t instanceof a){let i={result:[t.value]};return n.set(e,i),i}throw t}}(null==e?void 0:e.formula,(0,l.pl)(t),d,h);if(!r)continue;let n=r.result[0];n!==e.value&&u.list.push({key:t,newValue:n,sheetId:i})}e(u)}},555:function(t,e,i){i.d(e,{n:function(){return l}});let r=(t,e,i)=>{let r=t/255,o=e/255,l=i/255,a=Math.min(r,o,l),c=Math.max(r,o,l),u=c-a,d=n(r,o,l),p=h(c,a);return[d,100*s(u,p),100*p]},n=(t,e,i)=>{let r=Math.max(t,e,i),n=r-Math.min(t,e,i),s=0;if(0==n)s=0;else switch(r){case t:{let t=(e-i)/n,r=0;t<0&&(r=6),s=t+r;break}case e:s=(i-t)/n+2;break;case i:s=(t-e)/n+4}return 60*s},s=(t,e)=>0==t?0:t/(1-Math.abs(2*e-1)),h=(t,e)=>(t+e)/2,o=t=>{let[e,i,n,s]=t,[h,o,l]=r(e,i,n);return function(t,e,i,r){let n,s,h;let o=(1-Math.abs(2*(i/=100)-1))*(e/=100),l=o*(1-Math.abs(t/60%2-1)),a=i-o/2;if(t>=0&&t<60?(n=o,s=l,h=0):t>=60&&t<120?(n=l,s=o,h=0):t>=120&&t<180?(n=0,s=o,h=l):t>=180&&t<240?(n=0,s=l,h=o):t>=240&&t<300?(n=l,s=0,h=o):(n=o,s=0,h=l),1!==r)return`rgba(${n},${s},${h},${r})`;let c=t=>Math.round(255*t).toString(16).padStart(2,"0"),u=c(n+a),d=c(s+a),p=c(h+a);return`#${u}${d}${p}`}(h,.9*o,100-l,s)},l=t=>{var e;if(t.startsWith("rgb")){let e=t.replace("rgb","").replace("a","").replace("(","").replace(")","").split(",").map(Number);return e.length<=3&&e.push(1),o(e)}return o(((e=t).startsWith("#")&&(e=e.slice(1)),[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16),parseInt(e.substring(6,8)||"ff",16)/255]))}},6503:function(t,e,i){i.d(e,{Z:function(){return r}});let r={smallFont:"10px",font:"12px",largeFont:"14px",padding:"12px",lineHeight:1.5,mediumPadding:"8px",largePadding:"20px",borderRadius:"4px",borderLargeRadius:"8px",tinyPadding:"4px",scrollBarContent:"30px",formulaBarHeight:"25px"}},6570:function(t,e,i){i.d(e,{Z:function(){return r}});let r={lowZIndex:2,middleZIndex:3,highZIndex:4,highestZIndex:9}},8937:function(t,e,i){function r(t){let e=t.toUpperCase(),i=0;for(let t=0;t<e.length;t++)i=e.charCodeAt(t)-64+26*i;return i-1}function n(t){let e;let i="",r=Math.floor(Math.abs(t+1));for(;r>0;)i=String.fromCharCode(65+(e=(r-1)%26))+i,r=Math.floor((r-e)/26);return i.toUpperCase()}function s(t){let e=parseInt(t,10);return e=isNaN(e)?-1:Math.max(e-1,-1)}i.d(e,{BB:function(){return s},S1:function(){return r},ar:function(){return n}})},9176:function(t,e,i){let r;i.d(e,{BR:function(){return h},tt:function(){return s},uN:function(){return n}});function n(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof devicePixelRatio?void 0:devicePixelRatio;return"number"==typeof r?r:Math.max(Math.floor(t||1),1)}function s(t){return Math.floor(t*n())}function h(t){r=Math.max(Math.floor(t||1),1)}},3928:function(t){t.exports=JSON.parse('{"copy":"Copy","cut":"Cut","paste":"Paste","delete":"Delete","add":"Add","rows":"Rows","menu":"Menu","insert":"Insert","rename":"Rename","reset":"Reset","hide":"Hide","unhide":"Unhide","cancel":"Cancel","line-chart":"Line Chart","bar-chart":"Bar Chart","pie-chart":"Pie Chart","scatter-chart":"Scatter Chart","radar-chart":"Radar Chart","polar-area-chart":"PolarArea Chart","confirm":"Confirm","tab-color":"Tab Color","unhide-sheet":"Unhide sheet:","wrap-text":"Wrap Text","import-xlsx":"Import XLSX","export-xlsx":"Export XLSX","export-csv":"Export CSV","export-json":"Export JSON","import-csv":"Import CSV","floating-picture":"Floating Picture","chart":"Chart","chart-title":"Chart Title","duplicate":"Duplicate","select-data":"Select Data","change-chart-title":"Change Chart Title","change-chart-type":"Change Chart Type","save-as-picture":"Save as Picture","reset-size":"Reset Size","add-at-the-bottom":"Add at the bottom","row-height":"Row Height","column-width":"Column Width","greater-than-zero":"The value must be greater than or equal to 0","insert-columns":"Insert Columns","delete-columns":"Delete Columns","hide-columns":"Hide Columns","unhide-columns":"Unhide Columns","insert-rows":"Insert Rows","delete-rows":"Delete Rows","hide-rows":"Hide rows","unhide-rows":"Unhide rows","reference-is-empty":"The reference is empty","reference-is-not-valid":"The reference is not valid","the-value-cannot-be-empty":"The value cannot be empty","edit-data-source":"Edit Data Source","sheet-is-not-exist":"The sheet is not exist","sheet-id-is-duplicate":"The sheet id is duplicate","a-workbook-must-contains-at-least-one-visible-worksheet":"A workbook must contains at least one visible worksheet","sheet-name-is-duplicate":"The sheet name is duplicate","uuid-is-duplicate":"The uuid is duplicate","cells-must-contain-data":"The selected cells must contain the data","image-source-is-empty":"The image source is empty","merging-cell-is-duplicate":"The merging cell is duplicate","insert-column-left":"Insert Column Left","insert-column-right":"Insert Column Right","insert-row-above":"Insert Row Above","insert-row-below":"Insert Row Below","get-all-installed-fonts":"Get all the fonts installed locally","unsupported-chart-types":"Unsupported chart types","merge-cell":"Merge","merge-and-center":"Merge and Center","merge-cells":"Merge Cells","merge-content":"Merge Content","none":"none","single-underline":"single underline","double-underline":"double underline","general":"General","number":"Number","currency":"Currency","accounting":"Accounting","short-date":"Short Date","long-date":"Long Date","time":"Time","percentage":"Percentage","fraction":"Fraction","scientific":"Scientific","text":"Text","more-number-formats":"More Number Formats","short-date-format":"m/d/yyyy;@","long-date-format":"[$-409]dddd,mmmm d,yyyy;@","time-format":"h:mm:ss AM/PM","sheet-id-can-not-be-empty":"The sheetId can not be empty","no-border":"No Border","all-borders":"All Borders","outside-borders":"OutSide Borders","thick-box-border":"Thick Box Border","bottom-border":"Bottom Border","top-border":"Top Border","left-border":"Left Border","right-border":"Right Border","line-color":"Line Color","line-style":"Line Style","filter":"Filter","filter-empty":"(empty)","filter-all":"All"}')},6235:function(t){t.exports=JSON.parse('{"copy":"复制","cut":"剪切","paste":"粘贴","delete":"删除","add":"添加","rows":"行","menu":"菜单","insert":"插入","rename":"重命名","reset":"重置","hide":"隐藏","unhide":"显示","cancel":"取消","line-chart":"折线图","bar-chart":"柱状图","pie-chart":"饼图","scatter-chart":"散点图","radar-chart":"雷达图","polar-area-chart":"极区图","confirm":"确认","tab-color":"选项卡颜色","unhide-sheet":"显示工作表:","wrap-text":"自动换行","import-xlsx":"导入 XLSX","export-xlsx":"导出 XLSX","export-csv":"导出 CSV","export-json":"导出 JSON","import-csv":"导入 CSV","floating-picture":"浮动图片","chart":"图表","chart-title":"图表标题","duplicate":"复制","select-data":"选择数据","change-chart-title":"更改图表标题","change-chart-type":"更改图表类型","save-as-picture":"保存为图片","reset-size":"重置大小","add-at-the-bottom":"在底部添加","row-height":"行高","column-width":"列宽","greater-than-zero":"值必须大于或等于 0","insert-columns":"插入列","delete-columns":"删除列","hide-columns":"隐藏列","unhide-columns":"取消隐藏列","insert-rows":"插入行","delete-rows":"删除行","hide-rows":"隐藏行","unhide-rows":"取消隐藏行","reference-is-empty":"引用为空","reference-is-not-valid":"引用无效","the-value-cannot-be-empty":"值不能为空","edit-data-source":"编辑数据源","sheet-id-is-duplicate":"工作表 ID 重复","a-workbook-must-contains-at-least-one-visible-worksheet":"工作簿必须至少包含一个可见工作表","sheet-name-is-duplicate":"工作表名称重复","uuid-is-duplicate":"UUID 重复","cells-must-contain-data":"所选单元格必须包含数据","image-source-is-empty":"图像源为空","merging-cell-is-duplicate":"合并单元格重复","insert-column-left":"向左插入列","insert-column-right":"向右插入列","insert-row-above":"在上面插入行","insert-row-below":"在下面插入行","get-all-installed-fonts":"获取本地安装的所有字体","unsupported-chart-types":"不支持的图表类型","merge-cell":"合并单元格","merge-and-center":"合并并且居中","merge-cells":"合并单元格","merge-content":"合并内容","none":"无","single-underline":"单层下划线","double-underline":"双层下划线","general":"常规","number":"数值","currency":"货币","accounting":"会计专用","short-date":"短日期","long-date":"长日期","time":"时间","percentage":"百分比","fraction":"分数","scientific":"科学计数","text":"文本","more-number-formats":"其他数字格式","short-date-format":"yyyy/m/d;@","long-date-format":"yyyy\\"年\\"m\\"月\\"d\\"日\\"","time-format":"h:mm:ss","sheet-id-can-not-be-empty":"SheetId 不能为空","no-border":"无边框","all-borders":"全边框","outside-borders":"外边框","thick-box-border":"厚框边框","bottom-border":"底边框","top-border":"顶边框","left-border":"左边框","right-border":"右边框","line-color":"线条颜色","line-style":"线条样式","filter":"筛选","filter-empty":"(空)","filter-all":"全部","sheet-is-not-exist":"工作表不存在"}')}}]);