/* 
MIT License

Copyright (c) 2020 Steve Xu

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/
import{A as et,K as ne,N as tt,O as rt,W as nt,la as Oe,ma as st,na as Se,oa as Y,pa as at,qa as it,s as qe,sa as ot,u as le,w as _e,y as Ye}from"./chunk-5HPRGV2K.js";import{b as vt,c as Mt}from"./chunk-AI5EXC2Q.js";var ut=vt((or,Le)=>{"use strict";var ht={};function Rt(u){u.version="0.11.3";function e(s){for(var t="",n=s.length-1;n>=0;)t+=s.charAt(n--);return t}function r(s,t){for(var n="";n.length<t;)n+=s;return n}function c(s,t){var n=""+s;return n.length>=t?n:r("0",t-n.length)+n}function m(s,t){var n=""+s;return n.length>=t?n:r(" ",t-n.length)+n}function v(s,t){var n=""+s;return n.length>=t?n:n+r(" ",t-n.length)}function N(s,t){var n=""+Math.round(s);return n.length>=t?n:r("0",t-n.length)+n}function G(s,t){var n=""+s;return n.length>=t?n:r("0",t-n.length)+n}var F=Math.pow(2,32);function R(s,t){if(s>F||s<-F)return N(s,t);var n=Math.round(s);return G(n,t)}function $(s,t){return t=t||0,s.length>=7+t&&(s.charCodeAt(t)|32)===103&&(s.charCodeAt(t+1)|32)===101&&(s.charCodeAt(t+2)|32)===110&&(s.charCodeAt(t+3)|32)===101&&(s.charCodeAt(t+4)|32)===114&&(s.charCodeAt(t+5)|32)===97&&(s.charCodeAt(t+6)|32)===108}var H=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],z=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function X(s){s[0]="General",s[1]="0",s[2]="0.00",s[3]="#,##0",s[4]="#,##0.00",s[9]="0%",s[10]="0.00%",s[11]="0.00E+00",s[12]="# ?/?",s[13]="# ??/??",s[14]="m/d/yy",s[15]="d-mmm-yy",s[16]="d-mmm",s[17]="mmm-yy",s[18]="h:mm AM/PM",s[19]="h:mm:ss AM/PM",s[20]="h:mm",s[21]="h:mm:ss",s[22]="m/d/yy h:mm",s[37]="#,##0 ;(#,##0)",s[38]="#,##0 ;[Red](#,##0)",s[39]="#,##0.00;(#,##0.00)",s[40]="#,##0.00;[Red](#,##0.00)",s[45]="mm:ss",s[46]="[h]:mm:ss",s[47]="mmss.0",s[48]="##0.0E+0",s[49]="@",s[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'}var W={};X(W);var V=[],b=0;for(b=5;b<=8;++b)V[b]=32+b;for(b=23;b<=26;++b)V[b]=0;for(b=27;b<=31;++b)V[b]=14;for(b=50;b<=58;++b)V[b]=14;for(b=59;b<=62;++b)V[b]=b-58;for(b=67;b<=68;++b)V[b]=b-58;for(b=72;b<=75;++b)V[b]=b-58;for(b=67;b<=68;++b)V[b]=b-57;for(b=76;b<=78;++b)V[b]=b-56;for(b=79;b<=81;++b)V[b]=b-34;var bt={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function pe(s,t,n){for(var E=s<0?-1:1,a=s*E,T=0,o=1,d=0,y=1,p=0,A=0,w=Math.floor(a);p<t&&(w=Math.floor(a),d=w*o+T,A=w*p+y,!(a-w<5e-8));)a=1/(a-w),T=o,o=d,y=p,p=A;if(A>t&&(p>t?(A=y,d=T):(A=p,d=o)),!n)return[0,E*d,A];var Q=Math.floor(E*d/A);return[Q,E*d-Q*A,A]}function yt(s){var t=s.toPrecision(16);if(t.indexOf("e")>-1){var n=t.slice(0,t.indexOf("e"));return n=n.indexOf(".")>-1?n.slice(0,n.slice(0,2)=="0."?17:16):n.slice(0,15)+r("0",n.length-15),n+t.slice(t.indexOf("e"))}var E=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+r("0",t.length-15);return Number(E)}function te(s,t,n){if(s>2958465||s<0)return null;s=yt(s);var E=s|0,a=Math.floor(86400*(s-E)),T=0,o=[],d={D:E,T:a,u:86400*(s-E)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),t&&t.date1904&&(E+=1462),d.u>.9999&&(d.u=0,++a==86400&&(d.T=a=0,++E,++d.D)),E===60)o=n?[1317,10,29]:[1900,2,29],T=3;else if(E===0)o=n?[1317,8,29]:[1900,1,0],T=6;else{E>60&&--E;var y=new Date(1900,0,1);y.setDate(y.getDate()+E-1),o=[y.getFullYear(),y.getMonth()+1,y.getDate()],T=y.getDay(),E<60&&(T=(T+6)%7),n&&(T=wt(y,o))}return d.y=o[0],d.m=o[1],d.d=o[2],d.S=a%60,a=Math.floor(a/60),d.M=a%60,a=Math.floor(a/60),d.H=a,d.q=T,d}u.parse_date_code=te;var Ge=new Date(1899,11,31,0,0,0),kt=Ge.getTime(),At=new Date(1900,2,1,0,0,0);function Pe(s,t){var n=s.getTime();return t?n-=1461*24*60*60*1e3:s>=At&&(n+=24*60*60*1e3),(n-(kt+(s.getTimezoneOffset()-Ge.getTimezoneOffset())*6e4))/(24*60*60*1e3)}var He=function(){var t=/(?:\.0*|(\.\d*[1-9])0+)$/;function n(p){return p.indexOf(".")==-1?p:p.replace(t,"$1")}var E=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,a=/(E[+-])(\d)$/;function T(p){return p.indexOf("E")==-1?p:p.replace(E,"$1E").replace(a,"$10$2")}function o(p){var A=p<0?12:11,w=n(p.toFixed(12));return w.length<=A||(w=p.toPrecision(10),w.length<=A)?w:p.toExponential(5)}function d(p){var A=n(p.toFixed(11));return A.length>(p<0?12:11)||A==="0"||A==="-0"?p.toPrecision(6):A}function y(p){var A=Math.floor(Math.log(Math.abs(p))*Math.LOG10E),w;return A>=-4&&A<=-1?w=p.toPrecision(10+A):Math.abs(A)<=9?w=o(p):A===10?w=p.toFixed(10).substr(0,12):w=d(p),n(T(w.toUpperCase()))}return y}();u._general_num=He;function fe(s,t){switch(typeof s){case"string":return s;case"boolean":return s?"TRUE":"FALSE";case"number":return(s|0)===s?s.toString(10):He(s);case"undefined":return"";case"object":if(s==null)return"";if(s instanceof Date)return We(14,Pe(s,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+s)}u._general=fe;function wt(s,t){t[0]-=581;var n=s.getDay();return s<60&&(n=(n+6)%7),n}var ir="\u0E50\u0E51\u0E52\u0E53\u0E54\u0E55\u0E56\u0E57\u0E58\u0E59".split("");function Ct(s,t,n,E){var a="",T=0,o=0,d=n.y,y,p=0;switch(s){case 98:d=n.y+543;case 121:switch(t.length){case 1:case 2:y=d%100,p=2;break;default:y=d%1e4,p=4;break}break;case 109:switch(t.length){case 1:case 2:y=n.m,p=t.length;break;case 3:return z[n.m-1][1];case 5:return z[n.m-1][0];default:return z[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:y=n.d,p=t.length;break;case 3:return H[n.q][0];default:return H[n.q][1]}break;case 104:switch(t.length){case 1:case 2:y=1+(n.H+11)%12,p=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:y=n.H,p=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:y=n.M,p=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?c(n.S,t.length):(E>=2?o=E===3?1e3:100:o=E===1?10:1,T=Math.round(o*(n.S+n.u)),T>=60*o&&(T=0),t==="s"?T===0?"0":""+T/o:(a=c(T,2+E),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":y=n.D*24+n.H;break;case"[m]":case"[mm]":y=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":y=((n.D*24+n.H)*60+n.M)*60+(E==0?Math.round(n.S+n.u):n.S);break;default:throw"bad abstime format: "+t}p=t.length===3?1:2;break;case 101:y=d,p=1;break}var A=p>0?c(y,p):"";return A}function q(s){var t=3;if(s.length<=t)return s;for(var n=s.length%t,E=s.substr(0,n);n!=s.length;n+=t)E+=(E.length>0?",":"")+s.substr(n,t);return E}var Z=function(){var t=/%/g;function n(l,i,h){var x=i.replace(t,""),g=i.length-x.length;return Z(l,x,h*Math.pow(10,2*g))+r("%",g)}function E(l,i,h){for(var x=i.length-1;i.charCodeAt(x-1)===44;)--x;return Z(l,i.substr(0,x),h/Math.pow(10,3*(i.length-x)))}function a(l,i){var h,x=l.indexOf("E")-l.indexOf(".")-1;if(l.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+a(l,-i);var g=l.indexOf(".");g===-1&&(g=l.indexOf("E"));var f=Math.floor(Math.log(i)*Math.LOG10E)%g;if(f<0&&(f+=g),h=(i/Math.pow(10,f)).toPrecision(x+1+(g+f)%g),h.indexOf("e")===-1){var k=Math.floor(Math.log(i)*Math.LOG10E);for(h.indexOf(".")===-1?h=h.charAt(0)+"."+h.substr(1)+"E+"+(k-h.length+f):h+="E+"+(k-f);h.substr(0,2)==="0.";)h=h.charAt(0)+h.substr(2,g)+"."+h.substr(2+g),h=h.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");h=h.replace(/\+-/,"-")}h=h.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(O,S,L,M){return S+L+M.substr(0,(g+f)%g)+"."+M.substr(f)+"E"})}else h=i.toExponential(x);return l.match(/E\+00$/)&&h.match(/e[+-]\d$/)&&(h=h.substr(0,h.length-1)+"0"+h.charAt(h.length-1)),l.match(/E\-/)&&h.match(/e\+/)&&(h=h.replace(/e\+/,"e")),h.replace("e","E")}var T=/# (\?+)( ?)\/( ?)(\d+)/;function o(l,i,h){var x=parseInt(l[4],10),g=Math.round(i*x),f=Math.floor(g/x),k=g-f*x,O=x;return h+(f===0?"":""+f)+" "+(k===0?r(" ",l[1].length+1+l[4].length):m(k,l[1].length)+l[2]+"/"+l[3]+c(O,l[4].length))}function d(l,i,h){return h+(i===0?"":""+i)+r(" ",l[1].length+2+l[4].length)}var y=/^#*0*\.([0#]+)/,p=/\).*[0#]/,A=/\(###\) ###\\?-####/;function w(l){for(var i="",h,x=0;x!=l.length;++x)switch(h=l.charCodeAt(x)){case 35:break;case 63:i+=" ";break;case 48:i+="0";break;default:i+=String.fromCharCode(h)}return i}function Q(l,i){var h=Math.pow(10,i);return""+Math.round(l*h)/h}function re(l,i){var h=l-Math.floor(l),x=Math.pow(10,i);return i<(""+Math.round(h*x)).length?0:Math.round(h*x)}function Me(l,i){return i<(""+Math.round((l-Math.floor(l))*Math.pow(10,i))).length?1:0}function j(l){return l<2147483647&&l>-2147483648?""+(l>=0?l|0:l-1|0):""+Math.floor(l)}function _(l,i,h){if(l.charCodeAt(0)===40&&!i.match(p)){var x=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return h>=0?_("n",x,h):"("+_("n",x,-h)+")"}if(i.charCodeAt(i.length-1)===44)return E(l,i,h);if(i.indexOf("%")!==-1)return n(l,i,h);if(i.indexOf("E")!==-1)return a(i,h);if(i.charCodeAt(0)===36)return"$"+_(l,i.substr(i.charAt(1)==" "?2:1),h);var g,f,k,O,S=Math.abs(h),L=h<0?"-":"";if(i.match(/^00+$/))return L+R(S,i.length);if(i.match(/^[#?]+$/))return g=R(h,0),g==="0"&&(g=""),g.length>i.length?g:w(i.substr(0,i.length-g.length))+g;if(f=i.match(T))return o(f,S,L);if(i.match(/^#+0+$/))return L+R(S,i.length-i.indexOf("0"));if(f=i.match(y))return g=Q(h,f[1].length).replace(/^([^\.]+)$/,"$1."+w(f[1])).replace(/\.$/,"."+w(f[1])).replace(/\.(\d*)$/,function(B,ce){return"."+ce+r("0",w(f[1]).length-ce.length)}),i.indexOf("0.")!==-1?g:g.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),f=i.match(/^(0*)\.(#*)$/))return L+Q(S,f[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=i.match(/^#{1,3},##0(\.?)$/))return L+q(R(S,0));if(f=i.match(/^#,##0\.([#0]*0)$/))return h<0?"-"+_(l,i,-h):q(""+(Math.floor(h)+Me(h,f[1].length)))+"."+c(re(h,f[1].length),f[1].length);if(f=i.match(/^#,#*,#0/))return _(l,i.replace(/^#,#*,/,""),h);if(f=i.match(/^([0#]+)(\\?-([0#]+))+$/))return g=e(_(l,i.replace(/[\\-]/g,""),h)),k=0,e(e(i.replace(/\\/g,"")).replace(/[0#]/g,function(B){return k<g.length?g.charAt(k++):B==="0"?"0":""}));if(i.match(A))return g=_(l,"##########",h),"("+g.substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var M="";if(f=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(f[4].length,7),O=pe(S,Math.pow(10,k)-1,!1),g=""+L,M=Z("n",f[1],O[1]),M.charAt(M.length-1)==" "&&(M=M.substr(0,M.length-1)+"0"),g+=M+f[2]+"/"+f[3],M=v(O[2],k),M.length<f[4].length&&(M=w(f[4].substr(f[4].length-M.length))+M),g+=M,g;if(f=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max(f[1].length,f[4].length),7),O=pe(S,Math.pow(10,k)-1,!0),L+(O[0]||(O[1]?"":"0"))+" "+(O[1]?m(O[1],k)+f[2]+"/"+f[3]+v(O[2],k):r(" ",2*k+1+f[2].length+f[3].length));if(f=i.match(/^[#0?]+$/))return g=R(h,0),i.length<=g.length?g:w(i.substr(0,i.length-g.length))+g;if(f=i.match(/^([#0?]+)\.([#0]+)$/)){g=""+h.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),k=g.indexOf(".");var he=i.indexOf(".")-k,Re=i.length-g.length-he;return w(i.substr(0,he)+g+i.substr(i.length-Re))}if(f=i.match(/^00,000\.([#0]*0)$/))return k=re(h,f[1].length),h<0?"-"+_(l,i,-h):q(j(h)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(B){return"00,"+(B.length<3?c(0,3-B.length):"")+B})+"."+c(k,f[1].length);switch(i){case"###,##0.00":return _(l,"#,##0.00",h);case"###,###":case"##,###":case"#,###":var ue=q(R(S,0));return ue!=="0"?L+ue:"";case"###,###.00":return _(l,"###,##0.00",h).replace(/^0\./,".");case"#,###.00":return _(l,"#,##0.00",h).replace(/^0\./,".");default:}throw new Error("unsupported format |"+i+"|")}function ae(l,i,h){for(var x=i.length-1;i.charCodeAt(x-1)===44;)--x;return Z(l,i.substr(0,x),h/Math.pow(10,3*(i.length-x)))}function ge(l,i,h){var x=i.replace(t,""),g=i.length-x.length;return Z(l,x,h*Math.pow(10,2*g))+r("%",g)}function P(l,i){var h,x=l.indexOf("E")-l.indexOf(".")-1;if(l.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+P(l,-i);var g=l.indexOf(".");g===-1&&(g=l.indexOf("E"));var f=Math.floor(Math.log(i)*Math.LOG10E)%g;if(f<0&&(f+=g),h=(i/Math.pow(10,f)).toPrecision(x+1+(g+f)%g),!h.match(/[Ee]/)){var k=Math.floor(Math.log(i)*Math.LOG10E);h.indexOf(".")===-1?h=h.charAt(0)+"."+h.substr(1)+"E+"+(k-h.length+f):h+="E+"+(k-f),h=h.replace(/\+-/,"-")}h=h.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(O,S,L,M){return S+L+M.substr(0,(g+f)%g)+"."+M.substr(f)+"E"})}else h=i.toExponential(x);return l.match(/E\+00$/)&&h.match(/e[+-]\d$/)&&(h=h.substr(0,h.length-1)+"0"+h.charAt(h.length-1)),l.match(/E\-/)&&h.match(/e\+/)&&(h=h.replace(/e\+/,"e")),h.replace("e","E")}function U(l,i,h){if(l.charCodeAt(0)===40&&!i.match(p)){var x=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return h>=0?U("n",x,h):"("+U("n",x,-h)+")"}if(i.charCodeAt(i.length-1)===44)return ae(l,i,h);if(i.indexOf("%")!==-1)return ge(l,i,h);if(i.indexOf("E")!==-1)return P(i,h);if(i.charCodeAt(0)===36)return"$"+U(l,i.substr(i.charAt(1)==" "?2:1),h);var g,f,k,O,S=Math.abs(h),L=h<0?"-":"";if(i.match(/^00+$/))return L+c(S,i.length);if(i.match(/^[#?]+$/))return g=""+h,h===0&&(g=""),g.length>i.length?g:w(i.substr(0,i.length-g.length))+g;if(f=i.match(T))return d(f,S,L);if(i.match(/^#+0+$/))return L+c(S,i.length-i.indexOf("0"));if(f=i.match(y))return g=(""+h).replace(/^([^\.]+)$/,"$1."+w(f[1])).replace(/\.$/,"."+w(f[1])),g=g.replace(/\.(\d*)$/,function(B,ce){return"."+ce+r("0",w(f[1]).length-ce.length)}),i.indexOf("0.")!==-1?g:g.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),f=i.match(/^(0*)\.(#*)$/))return L+(""+S).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=i.match(/^#{1,3},##0(\.?)$/))return L+q(""+S);if(f=i.match(/^#,##0\.([#0]*0)$/))return h<0?"-"+U(l,i,-h):q(""+h)+"."+r("0",f[1].length);if(f=i.match(/^#,#*,#0/))return U(l,i.replace(/^#,#*,/,""),h);if(f=i.match(/^([0#]+)(\\?-([0#]+))+$/))return g=e(U(l,i.replace(/[\\-]/g,""),h)),k=0,e(e(i.replace(/\\/g,"")).replace(/[0#]/g,function(B){return k<g.length?g.charAt(k++):B==="0"?"0":""}));if(i.match(A))return g=U(l,"##########",h),"("+g.substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var M="";if(f=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(f[4].length,7),O=pe(S,Math.pow(10,k)-1,!1),g=""+L,M=Z("n",f[1],O[1]),M.charAt(M.length-1)==" "&&(M=M.substr(0,M.length-1)+"0"),g+=M+f[2]+"/"+f[3],M=v(O[2],k),M.length<f[4].length&&(M=w(f[4].substr(f[4].length-M.length))+M),g+=M,g;if(f=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max(f[1].length,f[4].length),7),O=pe(S,Math.pow(10,k)-1,!0),L+(O[0]||(O[1]?"":"0"))+" "+(O[1]?m(O[1],k)+f[2]+"/"+f[3]+v(O[2],k):r(" ",2*k+1+f[2].length+f[3].length));if(f=i.match(/^[#0?]+$/))return g=""+h,i.length<=g.length?g:w(i.substr(0,i.length-g.length))+g;if(f=i.match(/^([#0]+)\.([#0]+)$/)){g=""+h.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),k=g.indexOf(".");var he=i.indexOf(".")-k,Re=i.length-g.length-he;return w(i.substr(0,he)+g+i.substr(i.length-Re))}if(f=i.match(/^00,000\.([#0]*0)$/))return h<0?"-"+U(l,i,-h):q(""+h).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(B){return"00,"+(B.length<3?c(0,3-B.length):"")+B})+"."+c(0,f[1].length);switch(i){case"###,###":case"##,###":case"#,###":var ue=q(""+S);return ue!=="0"?L+ue:"";default:if(i.match(/\.[0#?]*$/))return U(l,i.slice(0,i.lastIndexOf(".")),h)+w(i.slice(i.lastIndexOf(".")))}throw new Error("unsupported format |"+i+"|")}return function(i,h,x){return(x|0)===x?U(i,h,x):_(i,h,x)}}();function Ve(s){for(var t=[],n=!1,E=0,a=0;E<s.length;++E)switch(s.charCodeAt(E)){case 34:n=!n;break;case 95:case 42:case 92:++E;break;case 59:t[t.length]=s.substr(a,E-a),a=E+1}if(t[t.length]=s.substr(a),n===!0)throw new Error("Format |"+s+"| unterminated string ");return t}u._split=Ve;var Be=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Xe(s){for(var t=0,n="",E="";t<s.length;)switch(n=s.charAt(t)){case"G":$(s,t)&&(t+=6),t++;break;case'"':for(;s.charCodeAt(++t)!==34&&t<s.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(s.charAt(t+1)==="1"||s.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(s.substr(t,3).toUpperCase()==="A/P"||s.substr(t,5).toUpperCase()==="AM/PM"||s.substr(t,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++t;break;case"[":for(E=n;s.charAt(t++)!=="]"&&t<s.length;)E+=s.charAt(t);if(E.match(Be))return!0;break;case".":case"0":case"#":for(;t<s.length&&("0#?.,E+-%".indexOf(n=s.charAt(++t))>-1||n=="\\"&&s.charAt(t+1)=="-"&&"0#".indexOf(s.charAt(t+2))>-1););break;case"?":for(;s.charAt(++t)===n;);break;case"*":++t,(s.charAt(t)==" "||s.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<s.length&&"0123456789".indexOf(s.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}u.is_date=Xe;function Qe(s,t,n,E){for(var a=[],T="",o=0,d="",y="t",p,A,w,Q="H";o<s.length;)switch(d=s.charAt(o)){case"G":if(!$(s,o))throw new Error("unrecognized character "+d+" in "+s);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(T="";(w=s.charCodeAt(++o))!==34&&o<s.length;)T+=String.fromCharCode(w);a[a.length]={t:"t",v:T},++o;break;case"\\":var re=s.charAt(++o),Me=re==="("||re===")"?re:"t";a[a.length]={t:Me,v:re},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(s.charAt(o+1)==="1"||s.charAt(o+1)==="2"){if(p==null&&(p=te(t,n,s.charAt(o+1)==="2"),p==null))return"";a[a.length]={t:"X",v:s.substr(o,2)},y=d,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||p==null&&(p=te(t,n),p==null))return"";for(T=d;++o<s.length&&s.charAt(o).toLowerCase()===d;)T+=d;d==="m"&&y.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=Q),a[a.length]={t:d,v:T},y=d;break;case"A":case"a":case"\u4E0A":var j={t:d,v:d};if(p==null&&(p=te(t,n)),s.substr(o,3).toUpperCase()==="A/P"?(p!=null&&(j.v=p.H>=12?s.charAt(o+2):d),j.t="T",Q="h",o+=3):s.substr(o,5).toUpperCase()==="AM/PM"?(p!=null&&(j.v=p.H>=12?"PM":"AM"),j.t="T",o+=5,Q="h"):s.substr(o,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(p!=null&&(j.v=p.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),j.t="T",o+=5,Q="h"):(j.t="t",++o),p==null&&j.t==="T")return"";a[a.length]=j,y=d;break;case"[":for(T=d;s.charAt(o++)!=="]"&&o<s.length;)T+=s.charAt(o);if(T.slice(-1)!=="]")throw'unterminated "[" block: |'+T+"|";if(T.match(Be)){if(p==null&&(p=te(t,n),p==null))return"";a[a.length]={t:"Z",v:T.toLowerCase()},y=T.charAt(1)}else T.indexOf("$")>-1&&(T=(T.match(/\$([^-\[\]]*)/)||[])[1]||"$",Xe(s)||(a[a.length]={t:"t",v:T}));break;case".":if(p!=null){for(T=d;++o<s.length&&(d=s.charAt(o))==="0";)T+=d;a[a.length]={t:"s",v:T};break}case"0":case"#":for(T=d;++o<s.length&&"0#?.,E+-%".indexOf(d=s.charAt(o))>-1;)T+=d;a[a.length]={t:"n",v:T};break;case"?":for(T=d;s.charAt(++o)===d;)T+=d;a[a.length]={t:d,v:T},y=d;break;case"*":++o,(s.charAt(o)==" "||s.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:E===1?"t":d,v:d},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(T=d;o<s.length&&"0123456789".indexOf(s.charAt(++o))>-1;)T+=s.charAt(o);a[a.length]={t:"D",v:T};break;case" ":a[a.length]={t:d,v:d},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+s);a[a.length]={t:"t",v:d},++o;break}var _=0,ae=0,ge;for(o=a.length-1,y="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=Q,y="h",_<1&&(_=1);break;case"s":(ge=a[o].v.match(/\.0+$/))&&(ae=Math.max(ae,ge[0].length-1),_=4),_<3&&(_=3);case"d":case"y":case"e":y=a[o].t;break;case"M":y=a[o].t,_<2&&(_=2);break;case"m":y==="s"&&(a[o].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[o].v.match(/[Hh]/)&&(_=1),_<2&&a[o].v.match(/[Mm]/)&&(_=2),_<3&&a[o].v.match(/[Ss]/)&&(_=3)}var P;switch(_){case 0:break;case 1:case 2:case 3:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H),p.H>=24&&(p.H=0,++p.D,P=te(p.D),P.u=p.u,P.S=p.S,P.M=p.M,P.H=p.H,p=P);break;case 4:switch(ae){case 1:p.u=Math.round(p.u*10)/10;break;case 2:p.u=Math.round(p.u*100)/100;break;case 3:p.u=Math.round(p.u*1e3)/1e3;break}p.u>=1&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H),p.H>=24&&(p.H=0,++p.D,P=te(p.D),P.u=p.u,P.S=p.S,P.M=p.M,P.H=p.H,p=P);break}var U="",l;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=Ct(a[o].t.charCodeAt(0),a[o].v,p,ae),a[o].t="t";break;case"n":case"?":for(l=o+1;a[l]!=null&&((d=a[l].t)==="?"||d==="D"||(d===" "||d==="t")&&a[l+1]!=null&&(a[l+1].t==="?"||a[l+1].t==="t"&&a[l+1].v==="/")||a[o].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(a[l].v==="/"||a[l].v===" "&&a[l+1]!=null&&a[l+1].t=="?"));)a[o].v+=a[l].v,a[l]={v:"",t:";"},++l;U+=a[o].v,o=l-1;break;case"G":a[o].t="t",a[o].v=fe(t,n);break}var i="",h,x;if(U.length>0){U.charCodeAt(0)==40?(h=t<0&&U.charCodeAt(0)===45?-t:t,x=Z("n",U,h)):(h=t<0&&E>1?-t:t,x=Z("n",U,h),h<0&&a[0]&&a[0].t=="t"&&(x=x.substr(1),a[0].v="-"+a[0].v)),l=x.length-1;var g=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){g=o;break}var f=a.length;if(g===a.length&&x.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(l>=a[o].v.length-1?(l-=a[o].v.length,a[o].v=x.substr(l+1,a[o].v.length)):l<0?a[o].v="":(a[o].v=x.substr(0,l+1),l=-1),a[o].t="t",f=o);l>=0&&f<a.length&&(a[f].v=x.substr(0,l+1)+a[f].v)}else if(g!==a.length&&x.indexOf("E")===-1){for(l=x.indexOf(".")-1,o=g;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(A=a[o].v.indexOf(".")>-1&&o===g?a[o].v.indexOf(".")-1:a[o].v.length-1,i=a[o].v.substr(A+1);A>=0;--A)l>=0&&(a[o].v.charAt(A)==="0"||a[o].v.charAt(A)==="#")&&(i=x.charAt(l--)+i);a[o].v=i,a[o].t="t",f=o}for(l>=0&&f<a.length&&(a[f].v=x.substr(0,l+1)+a[f].v),l=x.indexOf(".")+1,o=g;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==g)){for(A=a[o].v.indexOf(".")>-1&&o===g?a[o].v.indexOf(".")+1:0,i=a[o].v.substr(0,A);A<a[o].v.length;++A)l<x.length&&(i+=x.charAt(l++));a[o].v=i,a[o].t="t",f=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(h=E>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=Z(a[o].t,a[o].v,h),a[o].t="t");var k="";for(o=0;o!==a.length;++o)a[o]!=null&&(k+=a[o].v);return k}u._eval=Qe;var je=/\[[=<>]/,Ke=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ze(s,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(s==n)return!0;break;case">":if(s>n)return!0;break;case"<":if(s<n)return!0;break;case"<>":if(s!=n)return!0;break;case">=":if(s>=n)return!0;break;case"<=":if(s<=n)return!0;break}return!1}function Je(s,t){var n=Ve(s),E=n.length,a=n[E-1].indexOf("@");if(E<4&&a>-1&&--E,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break;case 4:break}var T=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[E,T];if(n[0].match(je)!=null||n[1].match(je)!=null){var o=n[0].match(Ke),d=n[1].match(Ke);return ze(t,o)?[E,n[0]]:ze(t,d)?[E,n[1]]:[E,n[o!=null&&d!=null?2:1]]}return[E,T]}function We(s,t,n){n==null&&(n={});var E="";switch(typeof s){case"string":s=="m/d/yy"&&n.dateNF?E=n.dateNF:E=s;break;case"number":s==14&&n.dateNF?E=n.dateNF:E=(n.table!=null?n.table:W)[s],E==null&&(E=n.table&&n.table[V[s]]||W[V[s]]),E==null&&(E=bt[s]||"General");break}if($(E,0))return fe(t,n);t instanceof Date&&(t=Pe(t,n.date1904));var a=Je(E,t);if($(a[1]))return fe(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Qe(a[1],t,n,a[0])}function Ze(s,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(W[n]==null){t<0&&(t=n);continue}if(W[n]==s){t=n;break}}t<0&&(t=391)}return W[t]=s,t}u.load=Ze,u._table=W,u.get_table=function(){return W},u.load_table=function(t){for(var n=0;n!=392;++n)t[n]!==void 0&&Ze(t[n],n)},u.init_table=X,u.format=We,u.choose_format=Je}Rt(ht);typeof Le<"u"&&typeof DO_NOT_EXPORT_SSF>"u"&&(Le.exports=ht)});var Ne=Mt(ut());function ct(u,e,r={}){return Ne.default.format(e||Ye,u,r)}function ur(u){return u?Ne.default.is_date(u):!1}function cr(u,e){let r=new Date(1899,11,31,0,0,0),c=r.getTime(),m=new Date(1900,2,1,0,0,0),v=u.getTime();return e?v-=1461*24*60*60*1e3:u>=m&&(v+=24*60*60*1e3),(v-(c+(u.getTimezoneOffset()-r.getTimezoneOffset())*6e4))/(24*60*60*1e3)}var J=class{constructor(e,r){this.type=e,this.value=r}toString(){return this.value}};var C=class extends Error{constructor(e){super(e),this.value=e}};function I(u,e="#VALUE!"){if(!u)throw new C(e)}function de(u){I(u.length===1);let[e]=u;return e}function ie(u){let e=de(u);return I(typeof e=="string"),e}function D(u){let e=de(u),[r,c]=ne(e);return I(r),c}function $e(u){I(u.length===0)}function Ee(u){let e=u.toUpperCase();return/^[A-Z]+\d+$/.test(e)||/^[A-Z]+$/.test(e)}var _t=(...u)=>{let e=de(u);return typeof e=="string"?e:""},Ot=(...u)=>ie(u).toLowerCase(),lt=(...u)=>{let e=D(u);return String.fromCharCode(e)},pt=(...u)=>ie(u).charCodeAt(0),St=(...u)=>ie(u).length,Lt=(...u)=>{I(u.length===2);let[e,r]=u;return I(typeof e=="string"),I(typeof r=="string"),e.split(r)},Nt=(...u)=>ie(u).toUpperCase(),$t=(...u)=>{I(u.length===2);let[e,r]=u;return I(typeof e=="string"||typeof e=="number"),I(typeof r=="string"),ct(e,r)},It=(...u)=>ie(u).replace(/ +/g," ").trim(),ft=(...u)=>(I(u.length<=le),u.join("")),Ut={CONCAT:ft,CONCATENATE:ft,SPLIT:Lt,CHAR:lt,CODE:pt,UNICHAR:lt,UNICODE:pt,LEN:St,LOWER:Ot,UPPER:Nt,TRIM:It,TEXT:$t,T:_t},gt=Ut;function dt(u){let e=[];for(let r=0;r<u.length;r++){let[c,m]=ne(u[r]);c&&e.push(m)}return e}var Dt=(...u)=>{let e=D(u);return Math.abs(e)},Ft=(...u)=>{let e=D(u);return Math.acos(e)},Gt=(...u)=>{let e=D(u);return Math.log(e+Math.sqrt(e*e-1))},Pt=(...u)=>{let e=D(u);return Math.atan(1/e)},Ht=(...u)=>{let e=D(u);return .5*Math.log((e+1)/(e-1))},Vt=(...u)=>{let e=D(u);return Math.asin(e)},Bt=(...u)=>{let e=D(u);return Math.log(e+Math.sqrt(e*e+1))},Xt=(...u)=>{let e=D(u);return Math.atan(e)},Qt=(...u)=>{I(u.length===2);let[e,r]=u;return I(typeof e=="number"),I(typeof r=="number"),Math.atan2(e,r)},jt=(...u)=>{let e=D(u);return Math.log((1+e)/(e+1))/2},Kt=(...u)=>{let e=dt(u);return I(e.length<=le&&e.length>=1),e.reduce((r,c)=>r+c,0)/e.length},zt=(...u)=>{let e=D(u);return Math.cos(e)},Jt=(...u)=>{let e=D(u);return 1/Math.tan(e)};var Wt=(...u)=>{let e=D(u);return Math.exp(e)},Zt=(...u)=>{let e=D(u);return Math.floor(e)};var qt=(...u)=>($e(u),Math.PI),Yt=(...u)=>($e(u),Math.E),er=(...u)=>{let e=D(u);return Math.sin(e)},tr=(...u)=>{let e=dt(u);return I(e.length<=le),e.reduce((r,c)=>r+c,0)},rr={ABS:Dt,ACOS:Ft,ACOSH:Gt,ACOT:Pt,ACOTH:Ht,ASIN:Vt,ASINH:Bt,ATAN:Xt,ATAN2:Qt,ATANH:jt,AVERAGE:Kt,COT:Jt,COS:zt,EXP:Wt,INT:Zt,PI:qt,E:Yt,SIN:er,SUM:tr},Et=rr;function xt(u){let e=String(u),r=/[.](\d*)/.exec(e);if(r&&r[1]){let c=Math.pow(10,Math.min(r[1].length,_e)),m=e.split("."),v=m[0]+m[1].slice(0,_e);return Number(v)/c}else return u}var nr={...gt,...Et},Ie=nr;var mt="",sr=new Map([["TRUE",20],["FALSE",21]]),xe=class{constructor(e){this.current=0;this.start=0;this.tokens=[];this.list=[...e]}scan(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();return this.tokens.push(new J(31,"")),this.tokens.length>0&&this.tokens[0].type===0&&this.tokens.shift(),this.tokens}peek(){return this.isAtEnd()?mt:this.list[this.current]}match(e){return this.peek()!==e?!1:(this.next(),!0)}next(){return this.isAtEnd()?mt:this.list[this.current++]}isAtEnd(){return this.current>=this.list.length}addToken(e){let r=this.list.slice(this.start,this.current).join("");this.tokens.push(new J(e,r))}string(e){for(;!this.isAtEnd()&&this.peek()!==e;)this.next();if(this.peek()!==e)throw new C("#VALUE!");this.next();let r=this.list.slice(this.start+1,this.current-1).join("");this.tokens.push(new J(17,r))}getDigits(){for(;!this.isAtEnd()&&Y(this.peek());)this.next()}getAlphas(){for(;!this.isAtEnd()&&Se(this.peek());)this.next()}matchR1C1(){if(this.match("[")){if(this.match("-"),Y(this.peek()))this.getDigits();else throw new C("#VALUE!");if(this.peek()!=="]")throw new C("#VALUE!");this.next()}else this.getDigits()}matchScientificCounting(e){if(this.match("E")||this.match("e")){if(this.match("+")||this.match("-"))return this.getDigits(),this.addToken(e?18:19),!0;if(Y(this.peek()))return this.getDigits(),this.addToken(e?18:19),!0;throw new C("#VALUE!")}return!1}number(){if(this.getDigits(),this.matchScientificCounting(!1))return;let r=!1;this.match(".")&&(r=!0,this.getDigits()),!this.matchScientificCounting(!0)&&this.addToken(r?18:19)}addIdentifier(){for(;!this.isAtEnd()&&this.anyChar(this.peek());)this.next();let e=this.list.slice(this.start,this.current).join(""),r=e.toUpperCase(),c=sr.get(r),m=16;c&&(e=r,m=c),/^[A-Z]+\$\d+$/.test(r)&&(e=r,m=29),this.tokens.push(new J(m,e))}scanToken(){let e=this.next();switch(e){case"$":{Se(this.peek())?(this.getAlphas(),this.match("$")?Y(this.peek())?(this.getDigits(),this.addToken(30)):this.addIdentifier():Y(this.peek())?(this.getDigits(),this.addToken(29)):this.addToken(30)):Y(this.peek())?(this.getDigits(),this.addToken(30)):this.addIdentifier();break}case"r":case"R":{if(this.matchR1C1(),this.match("C")||this.match("c")){this.matchR1C1();let r=this.list.slice(this.start,this.current).join("").toUpperCase();this.tokens.push(new J(28,r))}else this.addIdentifier();break}case"(":this.addToken(22);break;case")":this.addToken(23);break;case",":this.addToken(11);break;case":":this.addToken(10);break;case qe:this.addToken(0);break;case"<":this.match(">")?this.addToken(1):this.match("=")?this.addToken(15):this.addToken(14);break;case">":this.match("=")?this.addToken(8):this.addToken(7);break;case"+":this.addToken(2);break;case"-":this.addToken(3);break;case"*":this.addToken(4);break;case"/":this.addToken(5);break;case"^":this.addToken(6);break;case"&":this.addToken(9);break;case"%":this.addToken(13);break;case'"':this.string(e);break;case"'":this.string(e);break;case"!":this.addToken(27);break;case";":this.addToken(26);break;case"{":this.addToken(24);break;case"}":this.addToken(25);break;case" ":break;case"\r":case"	":case`
`:break;default:Y(e)?this.number():this.addIdentifier();break}}anyChar(e){return!'(),:=<>+-*/^&%"{}!'.includes(e)&&!this.isWhiteSpace(e)}isWhiteSpace(e){return e===" "||e==="\r"||e===`
`||e==="	"}};var ee=class{constructor(e,r,c){this.left=e,this.operator=r,this.right=c}accept(e){return e.visitBinaryExpression(this)}handleConcatenate(e){let r=e.toString();return this.operator.type===9&&e instanceof se&&e.value.type===17?JSON.stringify(r):r}toString(){let e=this.handleConcatenate(this.left),r=this.handleConcatenate(this.right);return`${e}${this.operator.toString()}${r}`}},me=class{constructor(e,r){this.operator=e,this.right=r}accept(e){return e.visitUnaryExpression(this)}toString(){return this.operator.toString()+this.right.toString()}},Te=class{constructor(e,r){this.operator=e,this.left=r}accept(e){return e.visitPostUnaryExpression(this)}toString(){return this.left.toString()+this.operator.toString()}},se=class{constructor(e){this.value=e}accept(e){return e.visitLiteralExpression(this)}toString(){return this.value.toString()}},be=class{constructor(e){this.value=e}accept(e){return e.visitR1C1Expression(this)}toString(){return this.value.toString()}},K=class{constructor(e,r,c){this.value=e,this.sheetName=c,this.type=r}accept(e){return e.visitCellExpression(this)}toString(){let e=this.value.toString().toUpperCase();if(this.sheetName){let r=this.sheetName.toString();return r.includes(" ")&&(r=`'${r}'`),`${r}!${e}`}else return e}},ye=class{constructor(e,r){this.name=e,this.params=r}accept(e){return e.visitCallExpression(this)}toString(){return`${this.name.toString().toUpperCase()}(${this.params.map(e=>e.toString()).join(",")})`}},ke=class{constructor(e,r,c){this.left=e,this.operator=r,this.right=c}accept(e){return e.visitCellRangeExpression(this)}toString(){return this.left.toString()+this.operator.toString()+this.right.toString()}},Ae=class{constructor(e){this.value=e}accept(e){return e.visitGroupExpression(this)}toString(){return`(${this.value.toString()})`}},oe=class{constructor(e){this.value=e}accept(e){return e.visitTokenExpression(this)}toString(){return this.value.toString()}},we=class{constructor(e){this.value=e}accept(e){return e.visitArrayExpression(this)}toString(){return`{${this.value.map(r=>r.toString()).join(",")}}`}};var Ce=class{constructor(e){this.current=0;this.tokens=e}parse(){let e=[];for(;!this.isAtEnd();)e.push(this.expression());return e}expression(){return this.comparison()}comparison(){let e=this.concatenate();for(;this.match(0,1,7,8,14,15);){let r=this.previous(),c=this.concatenate();e=new ee(e,r,c)}return e}concatenate(){let e=this.term();for(;this.match(9);){let r=this.previous(),c=this.term();e=new ee(e,r,c)}return e}term(){let e=this.factor();for(;this.match(2,3);){let r=this.previous(),c=this.factor();e=new ee(e,r,c)}return e}factor(){let e=this.expo();for(;this.match(5,4);){let r=this.previous(),c=this.expo();e=new ee(e,r,c)}return e}expo(){let e=this.unary();for(;this.match(6);){let r=this.previous(),c=this.unary();e=new ee(e,r,c)}return e}unary(){if(this.match(2,3)){let e=this.previous(),r=this.unary();return new me(e,r)}return this.postUnary()}postUnary(){let e=this.cellRange();if(this.match(13)){let r=this.previous();e=new Te(r,e)}return e}cellRange(){let e=this.sheetRange();for(;this.match(10);){let r=this.previous(),c=this.sheetRange(),m=this.convertToCellExpression(c),v=this.convertToCellExpression(e);e=new ke(v,r,m)}return e}convertToCellExpression(e){if(e instanceof K)return e;if(e instanceof oe&&Ee(e.value.value))return new K(e.value,"relative",void 0);if(e instanceof se&&e.value.type===19)return new K(e.value,"relative",void 0);throw new C("#NAME?")}sheetRange(){let e=this.call();if(this.match(27)){let r=this.call();if(e instanceof oe||e instanceof se){let c=this.convertToCellExpression(r);return new K(c.value,c.type,e.value)}}return e}call(){let e=this.primary();for(;this.match(22);)e=this.finishCall(e);return e}finishCall(e){let r=[];if(!this.check(23))do{if(this.peek().type==23)break;r.push(this.expression())}while(this.match(11));return this.expect(23),new ye(e,r)}primary(){if(this.match(24)){let e=[];do{if(this.peek().type==25)break;e.push(this.expression())}while(this.match(11));return this.expect(25),new we(e)}if(this.match(22)){let e=this.expression();return this.expect(23),new Ae(e)}if(this.match(19,18,17,20,21))return new se(this.previous());if(this.match(30)){let e=this.previous();return new K(e,"absolute",void 0)}if(this.match(29)){let e=this.previous();return new K(e,"mixed",void 0)}if(this.match(16)){let e=this.previous(),r=e.value.toUpperCase();if(et.has(r))throw new C(r);return new oe(e)}if(this.match(28))return new be(this.previous());throw new C("#VALUE!")}match(...e){let{type:r}=this.peek();return e.includes(r)?(this.next(),!0):!1}previous(){return this.tokens[this.current-1]}check(e){return this.peek().type===e}expect(e){if(this.check(e))return this.next(),this.previous();throw new C("#VALUE!")}next(){this.current++}isAtEnd(){return this.peek().type===31}peek(){return this.current<this.tokens.length?this.tokens[this.current]:new J(31,"")}};var ve=class{constructor(e,r,c){this.expressions=e,this.cellDataMap=c,this.currentCoord=r}interpret(){let e=[];for(let r of this.expressions){let c=this.evaluate(r),m=this.getRangeCellValue(c);Array.isArray(m)?e=e.concat(m):e.push(m)}return e}visitBinaryExpression(e){let r=this.evaluate(e.left),c=this.evaluate(e.right);switch(r=this.getOneValue(r),c=this.getOneValue(c),[3,2,5,4,6].includes(e.operator.type)&&(r=this.parseNumber(r),c=this.parseNumber(c)),e.operator.type){case 3:return r-c;case 2:return r+c;case 5:{if(c===0)throw new C("#DIV/0!");return r/c}case 4:return r*c;case 6:return Math.pow(r,c);case 0:return r===c;case 1:return r!==c;case 7:return r>c;case 8:return r>=c;case 14:return r<c;case 15:return r<=c;case 9:return`${r}${c}`;default:throw new C("#TEXT")}}visitCallExpression(e){let r=this.evaluate(e.name);if(r&&typeof r=="function"){let c=[];for(let m of e.params){let v=this.evaluate(m);if(v instanceof Oe){let N=this.getCellValue(v,!1);c=c.concat(N)}else c.push(v)}return r(...c)}throw new C("#NAME?")}visitR1C1Expression(e){let r=ot(e.value.value,this.currentCoord);if(!r)throw new C("#NAME?");return r}visitCellExpression(e){let r="";if(e.sheetName){let m=this.cellDataMap.getSheetInfo("",e.sheetName.value);if(!m)throw new C("#REF!");r=m.sheetId}let c=at(e.value.value);if(!c)throw new C("#NAME?");return r&&(c.sheetId=r),c}visitLiteralExpression(e){let{type:r,value:c}=e.value;switch(r){case 17:return c;case 18:case 19:{let[m,v]=ne(c);if(m)return v;throw new C("#VALUE!")}case 20:return!0;case 21:return!1;default:throw new C("#VALUE!")}}visitTokenExpression(e){let{value:r}=e.value,c=r.toLowerCase();if(this.cellDataMap.getDefinedName(c)){let v=this.cellDataMap.getDefinedName(c);return this.getCellValue(v,!0)}let m=this.cellDataMap.getFunction(r.toUpperCase());if(m)return m;if(Ee(r))return this.visitCellExpression(new K(e.value,"relative",void 0));throw new C("#NAME?")}visitUnaryExpression(e){let r=this.evaluate(e.right),c=this.parseNumber(this.getOneValue(r));switch(e.operator.type){case 3:return-c;case 2:return c;default:throw new C("#VALUE!")}}visitCellRangeExpression(e){switch(e.operator.type){case 10:{let r=this.visitCellExpression(e.left),c=this.visitCellExpression(e.right),m=it(r,c);if(!m)throw new C("#NAME?");return m}default:throw new C("#NAME?")}}visitGroupExpression(e){return this.evaluate(e.value)}visitArrayExpression(e){let r=[];for(let c of e.value)r.push(this.evaluate(c));return r}visitPostUnaryExpression(e){let r=this.evaluate(e.left),c=this.parseNumber(this.getOneValue(r));switch(e.operator.type){case 13:return c*.01;default:throw new C("#VALUE!")}}evaluate(e){return e.accept(this)}getRangeCellValue(e){if(e instanceof Oe){if(e.colCount===e.rowCount&&e.colCount===1)return this.getCellValue(e,!0);throw new C("#REF!")}return e}getOneValue(e){let r=this.getRangeCellValue(e);return Array.isArray(r)?r[0]:r}parseNumber(e){let[r,c]=ne(e);if(!r)throw new C("#VALUE!");return c}getCellValue(e,r){let c=[];if(r){let F=this.cellDataMap.getCell(e),R=this.cellDataMap.handleCell(F,{row:e.row,col:e.col});return c=c.concat(R),c}let{row:m,col:v,sheetId:N}=e,G=this.cellDataMap.getSheetInfo(N);if(!G||m>=G.rowCount||v>=G.colCount)throw new C("#REF!");return st(e,G,(F,R)=>{let $=this.cellDataMap.getCell({row:F,col:R,rowCount:1,colCount:1,sheetId:N}),H=this.cellDataMap.handleCell($,{row:F,col:R});return c=c.concat(H),!1}),c}};function Tt(u,e={row:0,col:0},r=new Fe,c=new Map){if(c.has(u))return c.get(u);try{r.handleCell=(R,$)=>R?R.formula?Tt(R.formula,$,r,c).result:[R.value]:[];let m={result:[],expressionStr:""};c.set(u,m);let v=new xe(u).scan(),N=new Ce(v).parse(),G=new ve(N,e,r).interpret(),F=[];for(let R of N)F.push(R.toString());m.expressionStr=F.join("");for(let R of G)typeof R=="number"&&!isNaN(R)?m.result.push(xt(R)):m.result.push(R);return m}catch(m){if(m instanceof C){let v={result:[m.value]};return c.set(u,v),v}throw m}}var De="_test_",Fe=class{constructor(){this.map=new Map;this.definedNameMap=new Map;this.currentSheetId=De;this.sheetList=[{sheetId:De,name:"_test_",rowCount:200,colCount:30,isHide:!1,sort:1}];this.getFunction=e=>Ie[e];this.handleCell=(e,r)=>e?[e.value]:[]}getKey(e,r,c){return`${e}_${r}_${c||De}`}setSheetList(e){this.sheetList=e}set(e,r){let{row:c,col:m,sheetId:v}=e;for(let N=0;N<r.length;N++)for(let G=0;G<r[N].length;G++){let F=this.getKey(c+N,m+G,v),R=r[N][G];typeof R=="string"&&nt(R)?this.map.set(F,{formula:R,value:""}):this.map.set(F,{value:R})}}getCell(e){let{row:r,col:c,sheetId:m}=e,v=this.getKey(r,c,m);return this.map.get(v)}getSheetInfo(e,r){if(r)return this.sheetList.find(m=>m.name===r);let c=e||this.currentSheetId;return this.sheetList.find(m=>m.sheetId===c)}setDefinedName(e,r){this.definedNameMap.set(e,r)}getDefinedName(e){return this.definedNameMap.get(e)}};function ar(u,e){let{currentSheetId:r,worksheets:c,workbook:m,definedNames:v}=u,N=new Map,G=c[r]||{},F={list:[]},R={handleCell:()=>[],getFunction:$=>Ie[$],getCell:$=>{let{row:H,col:z,sheetId:X}=$,V=c[X||r]||{},b=tt(H,z);return V[b]},set:()=>{throw new C("#REF!")},getSheetInfo:($,H)=>{if(H)return m.find(X=>X.name===H);let z=$||r;return m.find(X=>X.sheetId===z)},setDefinedName:()=>{throw new C("#REF!")},getDefinedName:$=>v[$]};for(let[$,H]of Object.entries(G)){if(!H?.formula)continue;let z=Tt(H?.formula,rt($),R,N);if(!z)continue;let X=z.result[0];X!==H.value&&F.list.push({key:$,newValue:X,sheetId:r})}e(F)}export{ct as a,ur as b,cr as c,ar as d};
//# sourceMappingURL=chunk-MVCONUYI.js.map
