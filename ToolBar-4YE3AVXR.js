/* 
MIT License

Copyright (c) 2020 Steve Xu

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/
import{a as ge}from"./chunk-YXI3BZGE.js";import{c as K,d as N,h as Q}from"./chunk-OWMK2NZE.js";import{a as $,c as a,d as le,e as ae,f as C,g as U,i as J,m as f,n as se,o as de,r as P}from"./chunk-DP2NF2EL.js";import{F as j,Ka as ne,La as ie,M as oe,Qa as n,Ua as x,Z as q,_ as V,l as te,ya as X,za as re}from"./chunk-JN5Q2OC2.js";import{c as Y}from"./chunk-AI5EXC2Q.js";var e=Y($());var s={"toolbar-wrapper":"e","merge-cell":"Jr",border:"Kr","merge-cell-button":"Nr","number-format":"Or","number-format-value":"Qr",fontFamily:"Tr",bold:"Vr",italic:"Wr",strike:"Xr","wrap-text":"_r","icon-center":"ro"};var m=Y($());var Z=(0,m.memo)(({controller:t})=>{let d=(0,m.useRef)(null),o=(0,m.useCallback)(async A=>{let w=A.target.files?.[0];if(!w)return;let h=w.name,u=w.type.slice(6);h=h.slice(0,-(u.length+1));let c=await ne(w,!0);if(d.current&&(d.current.value="",d.current.blur()),!c)return;let p=await ie(c),I=t.getActiveRange().range;await t.addDrawing({width:p.width,height:p.height,originHeight:p.height,originWidth:p.width,title:h,type:"floating-picture",uuid:j(),imageSrc:c,sheetId:I.sheetId,fromRow:I.row,fromCol:I.col,marginX:0,marginY:0})},[]);return m.default.createElement(a,{testId:"toolbar-floating-picture",title:"Floating Picture"},m.default.createElement("input",{type:"file",hidden:!0,onChange:o,accept:"image/*",ref:d,id:"upload_float_image","data-testid":"toolbar-floating-picture-input"}),m.default.createElement("label",{htmlFor:"upload_float_image"},n("floating-picture")))});Z.displayName="InsertFloatingPicture";var R=(0,m.memo)(({controller:t})=>{let d=(0,m.useCallback)(async()=>{let o=t.getActiveRange().range;await t.addDrawing({width:400,height:300,originHeight:300,originWidth:400,title:n("chart-title"),type:"chart",uuid:j(),sheetId:o.sheetId,fromRow:o.row,fromCol:o.col,chartRange:o,chartType:"line",marginX:0,marginY:0})},[]);return m.default.createElement(a,{testId:"toolbar-chart",onClick:d,title:"Chart"},n("chart"))});R.displayName="InsertChart";var l=Y($());var z={container:"i",trigger:"oo",main:"eo",menu:"z",portal:"io"};var ee=(0,l.memo)(({controller:t})=>{let[d,o]=(0,l.useState)(""),[A,w]=(0,l.useState)("thin"),[h,u]=(0,l.useState)("all-borders"),c=(0,l.useRef)({color:d,borderType:A,type:h}),p=()=>({color:c.current.color,type:c.current.borderType}),I=()=>{u("all-borders");let r=p();t.updateCellStyle({borderLeft:r,borderRight:r,borderTop:r,borderBottom:r},t.getActiveRange().range)},G=r=>{c.current.color=r,o(r),I()},W=r=>{c.current.borderType=r,w(r),I()},_=()=>{u("no-border"),t.updateCellStyle({borderLeft:void 0,borderRight:void 0,borderTop:void 0,borderBottom:void 0},t.getActiveRange().range)},F=()=>{u("bottom-border");let r=t.getActiveRange().range,v=p(),{row:S,col:B,colCount:T,rowCount:k}=r;t.updateCellStyle({borderBottom:v},{row:S+k-1,rowCount:1,colCount:T,col:q(r)?0:B,sheetId:""})},L=()=>{u("top-border");let r=t.getActiveRange().range,v=p(),{row:S,col:B,colCount:T}=r,k={row:S,rowCount:1,colCount:T,col:q(r)?0:B,sheetId:""};t.updateCellStyle({borderTop:v},k)},M=()=>{u("left-border");let r=t.getActiveRange().range,v=p(),{row:S,col:B,rowCount:T}=r;t.updateCellStyle({borderLeft:v},{row:V(r)?0:S,rowCount:T,colCount:1,col:B,sheetId:""})},E=()=>{u("right-border");let r=t.getActiveRange().range,v=p(),{row:S,col:B,rowCount:T,colCount:k}=r;t.updateCellStyle({borderRight:v},{row:V(r)?0:S,rowCount:T,colCount:1,col:B+k-1,sheetId:""})},O=()=>{L(),E(),F(),M(),u("outside-borders")},D=()=>{let r=c.current.borderType;c.current.borderType="medium",O(),c.current.borderType=r,u("thick-box-border")},H=()=>{({"all-borders":I,"no-border":_,"bottom-border":F,"top-border":L,"left-border":M,"right-border":E,"thick-box-border":D,"outside-borders":O})[h]()};return l.default.createElement("div",{className:z.container},l.default.createElement(a,{onClick:H,type:"plain",className:z.main,testId:"toolbar-border-shortcut",title:n(h)},n(h)),l.default.createElement(de,{className:z.menu,label:l.default.createElement(C,{name:"down"}),isPlain:!0,testId:"toolbar-border",position:"bottom",size:"small",portalClassName:z.portal},l.default.createElement(f,{onClick:_,testId:"toolbar-no-border"},n("no-border")),l.default.createElement(f,{onClick:I,testId:"toolbar-all-borders"},n("all-borders")),l.default.createElement(f,{onClick:O,testId:"toolbar-outside-borders"},n("outside-borders")),l.default.createElement(f,{onClick:D,testId:"toolbar-thick-box-border"},n("thick-box-border")),l.default.createElement(f,{onClick:F,testId:"toolbar-bottom-border"},n("bottom-border")),l.default.createElement(f,{onClick:L,testId:"toolbar-top-border"},n("top-border")),l.default.createElement(f,{onClick:M,testId:"toolbar-left-border"},n("left-border")),l.default.createElement(f,{onClick:E,testId:"toolbar-right-border"},n("right-border")),l.default.createElement(f,null,l.default.createElement(P,{color:d,onChange:G,position:"right",testId:"toolbar-border-color"},l.default.createElement("span",{style:{color:d}},n("line-color")," >"))),l.default.createElement(se,{label:`${n("line-style")} >`,testId:"toolbar-border-style"},Object.keys(te).map(r=>l.default.createElement(f,{key:r,onClick:()=>W(r),testId:`toolbar-border-style-${r}`,active:A===r},r)))))});ee.displayName="BorderToolBar";var Be=[{value:0,label:n("none"),disabled:!1},{value:1,label:n("single-underline"),disabled:!1},{value:2,label:n("double-underline"),disabled:!1}],Te=[{value:0,label:n("merge-and-center"),disabled:!1},{value:1,label:n("merge-cells"),disabled:!1},{value:2,label:n("merge-content"),disabled:!1}],ce=(0,e.memo)(({controller:t})=>{let d=(0,e.useSyncExternalStore)(K.subscribe,K.getSnapshot),o=(0,e.useSyncExternalStore)(Q.subscribe,Q.getSnapshot),A=(0,e.useSyncExternalStore)(N.subscribe,N.getSnapshot),w=(0,e.useMemo)(()=>({color:o.fillColor}),[o.fillColor]),h=(0,e.useMemo)(()=>({color:o.fontColor}),[o.fontColor]),[u,c]=(0,e.useMemo)(()=>{let i=x[0];if(o.numberFormat){let b=x.find(g=>g.value===o.numberFormat);b?i=b:i=x[x.length-1]}return[i.label,String(i.value)]},[o.numberFormat]),p=(0,e.useCallback)(i=>({fontFamily:String(i)}),[]),I=(0,e.useCallback)(i=>{String(i)===X&&typeof window.queryLocalFonts=="function"?window.queryLocalFonts().then(b=>{let g=b.map(y=>y.fullName);g=Array.from(new Set(g)).filter(y=>ge(y)),g.sort((y,ye)=>y.localeCompare(ye));let Ie=g.map(y=>({label:y,value:y,disabled:!1}));g.length>0?(N.setState(Ie),localStorage.setItem(re,JSON.stringify(g))):N.setState(N.getSnapshot().filter(y=>y.value!==X))}):t.updateCellStyle({fontFamily:String(i)},t.getActiveRange().range)},[]),G=(0,e.useCallback)(()=>{t.undo()},[]),W=(0,e.useCallback)(()=>{t.redo()},[]),_=(0,e.useCallback)(()=>{t.copy()},[]),F=(0,e.useCallback)(()=>{t.cut()},[]),L=(0,e.useCallback)(()=>{t.paste()},[]),M=(0,e.useCallback)(i=>{t.updateCellStyle({fontSize:Number(i)},t.getActiveRange().range)},[]),E=(0,e.useCallback)(()=>{t.updateCellStyle({isBold:!o.isBold},t.getActiveRange().range)},[o.isBold]),O=(0,e.useCallback)(()=>{t.updateCellStyle({isItalic:!o.isItalic},t.getActiveRange().range)},[o.isItalic]),D=(0,e.useCallback)(()=>{t.updateCellStyle({isStrike:!o.isStrike},t.getActiveRange().range)},[o.isStrike]),H=(0,e.useCallback)(i=>{let b=Number(i),g=0;b===1?g=1:b===2&&(g=2),t.updateCellStyle({underline:g},t.getActiveRange().range)},[]),r=(0,e.useCallback)(i=>{t.updateCellStyle({fillColor:i},t.getActiveRange().range)},[]),v=(0,e.useCallback)(i=>{t.updateCellStyle({fontColor:i},t.getActiveRange().range)},[]),S=(0,e.useCallback)(()=>{t.updateCellStyle({isWrapText:!o.isWrapText},t.getActiveRange().range)},[o.isWrapText]),B=(0,e.useCallback)(()=>{let{range:i,isMerged:b}=t.getActiveRange();b?t.deleteMergeCell(i):t.addMergeCell(i)},[]),T=(0,e.useCallback)(i=>{if(!i)return;let{range:b,isMerged:g}=t.getActiveRange();g?t.deleteMergeCell(b):t.addMergeCell(b,Number(i))},[]),k=(0,e.useCallback)(i=>{i&&t.updateCellStyle({numberFormat:i},t.getActiveRange().range)},[]),me=(0,e.useCallback)(()=>{t.updateCellStyle({horizontalAlign:0},t.getActiveRange().range)},[]),ue=(0,e.useCallback)(()=>{t.updateCellStyle({horizontalAlign:1},t.getActiveRange().range)},[]),pe=(0,e.useCallback)(()=>{t.updateCellStyle({horizontalAlign:2},t.getActiveRange().range)},[]),be=(0,e.useCallback)(()=>{t.updateCellStyle({verticalAlign:0},t.getActiveRange().range)},[]),Ce=(0,e.useCallback)(()=>{t.updateCellStyle({verticalAlign:1},t.getActiveRange().range)},[]),fe=(0,e.useCallback)(()=>{t.updateCellStyle({verticalAlign:2},t.getActiveRange().range)},[]),he=(0,e.useCallback)(()=>{t.getFilter()&&t.deleteFilter(),t.addFilter(t.getActiveRange().range)},[]);return e.default.createElement("div",{className:s["toolbar-wrapper"],"data-testid":"toolbar"},e.default.createElement(a,{disabled:!d.canUndo,onClick:G,testId:"toolbar-undo",title:"Undo",className:s["icon-center"]},e.default.createElement(C,{name:"undo"})),e.default.createElement(a,{disabled:!d.canRedo,onClick:W,testId:"toolbar-redo",title:"Redo",className:s["icon-center"]},e.default.createElement(C,{name:"redo"})),e.default.createElement(a,{onClick:_,testId:"toolbar-copy",title:"Copy"},n("copy")),e.default.createElement(a,{onClick:F,testId:"toolbar-cut",title:"Cut"},n("cut")),e.default.createElement(a,{onClick:L,testId:"toolbar-paste",title:"Paste"},n("paste")),e.default.createElement(U,{data:A,value:o.fontFamily,getItemStyle:p,onChange:I,testId:"toolbar-font-family",className:s.fontFamily}),e.default.createElement(U,{data:oe,value:o.fontSize,onChange:M,testId:"toolbar-font-size"}),e.default.createElement(a,{active:o.isBold,onClick:E,testId:"toolbar-bold",title:"Bold"},e.default.createElement("span",{className:s.bold},"B")),e.default.createElement(a,{active:o.isItalic,onClick:O,testId:"toolbar-italic",title:"Italic"},e.default.createElement("span",{className:s.italic},"I")),e.default.createElement(a,{active:o.isStrike,onClick:D,testId:"toolbar-strike",title:"Strike"},e.default.createElement("span",{className:s.strike},"A")),e.default.createElement(U,{data:Be,value:o.underline,title:"Underline",onChange:H,testId:"toolbar-underline"}),e.default.createElement(ee,{controller:t}),e.default.createElement(P,{key:"fill-color",color:o.fillColor,onChange:r,testId:"toolbar-fill-color"},e.default.createElement(a,{style:w,testId:"toolbar-fill-color",className:s["icon-center"],title:"Fill Color"},e.default.createElement(ae,null))),e.default.createElement(P,{key:"font-color",color:o.fontColor,onChange:v,testId:"toolbar-font-color"},e.default.createElement(a,{style:h,testId:"toolbar-font-color",className:s["icon-center"],title:"Font Color"},e.default.createElement(C,{name:"fontColor"}))),e.default.createElement(a,{active:o.verticalAlign===0,onClick:be,testId:"toolbar-vertical-top",className:s["icon-center"],title:"Top Align"},e.default.createElement(C,{name:"verticalTop"})),e.default.createElement(a,{active:o.verticalAlign===1,onClick:Ce,testId:"toolbar-vertical-middle",className:s["icon-center"],title:"Middle Align"},e.default.createElement(C,{name:"verticalMiddle"})),e.default.createElement(a,{active:o.verticalAlign===2,onClick:fe,testId:"toolbar-vertical-bottom",className:s["icon-center"],title:"Bottom Align"},e.default.createElement(C,{name:"verticalBottom"})),e.default.createElement(a,{active:o.horizontalAlign===0,onClick:me,testId:"toolbar-horizontal-left",className:s["icon-center"],title:"Align Text Left"},e.default.createElement(C,{name:"horizontalLeft"})),e.default.createElement(a,{active:o.horizontalAlign===1,onClick:ue,testId:"toolbar-horizontal-center",className:s["icon-center"],title:"Align Text Center"},e.default.createElement(C,{name:"horizontalCenter"})),e.default.createElement(a,{active:o.horizontalAlign===2,onClick:pe,testId:"toolbar-horizontal-right",className:s["icon-center"],title:"Align Text Right"},e.default.createElement(C,{name:"horizontalRight"})),e.default.createElement(a,{active:o.isWrapText,onClick:S,testId:"toolbar-wrap-text",className:s["wrap-text"],title:"Wrap Text"},n("wrap-text")),e.default.createElement(J,{data:Te,value:o.mergeType,onChange:T,className:s["merge-cell"],testId:"toolbar-merge-cell-select"},e.default.createElement(a,{active:o.isMergeCell,onClick:B,testId:"toolbar-merge-cell",className:s["merge-cell-button"],type:"plain",title:"Merge And Center"},n("merge-and-center"))),e.default.createElement(J,{data:x,value:c,onChange:k,className:s["number-format"],testId:"toolbar-number-format"},e.default.createElement("div",{className:s["number-format-value"],"data-testid":"toolbar-number-format-value"},u)),e.default.createElement(a,{active:d.isFilter,onClick:he,testId:"toolbar-filter",className:s["wrap-text"],title:"Filter"},n("filter")),e.default.createElement(Z,{controller:t}),e.default.createElement(R,{controller:t}),e.default.createElement(le,null))});ce.displayName="ToolbarContainer";var Ze=ce;export{ce as ToolbarContainer,Ze as default};
//# sourceMappingURL=ToolBar-4YE3AVXR.js.map
