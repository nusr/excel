{
  "version": 3,
  "sources": ["../src/containers/canvas/index.tsx", "../src/containers/canvas/index.module.css", "../src/containers/store/base.ts", "../src/containers/store/sheetList.ts", "../src/containers/store/activeCell.ts", "../src/containers/store/core.ts", "../src/containers/store/fontFamily.ts", "../src/containers/store/scroll.ts", "../src/containers/store/floatElement.ts", "../src/containers/canvas/ScrollBar.tsx", "../src/canvas/util.ts", "../src/canvas/constant.ts", "../src/canvas/Main.ts", "../src/canvas/shortcut.ts", "../src/canvas/event.ts", "../src/canvas/Content.ts", "../src/containers/canvas/ContextMenu.tsx", "../src/containers/canvas/util.ts", "../src/containers/canvas/BottomBar.tsx", "../src/containers/FloatElement/index.tsx", "../src/containers/FloatElement/FloatElement.tsx", "../src/containers/FloatElement/FloatElement.module.css", "../src/containers/FloatElement/ContextMenu.tsx", "../src/containers/FloatElement/util.ts", "../src/containers/FloatElement/Toolbar.tsx", "../src/containers/FormulaBar/index.tsx", "../src/containers/FormulaBar/FormulaEditor.tsx", "../src/containers/FormulaBar/index.module.css", "../src/containers/FormulaBar/DefineName.tsx", "../src/containers/ToolBar/index.tsx", "../src/containers/ToolBar/index.module.css", "../src/containers/SheetBar/index.tsx", "../src/containers/SheetBar/SheetBarContextMenu.tsx", "../src/containers/SheetBar/index.module.css", "../src/containers/index.module.css", "../src/containers/index.tsx", "../src/containers/MenuBar/index.tsx", "../src/containers/Excel/import.ts", "../src/containers/Excel/exportConstant.ts", "../src/containers/Excel/exportXLSX.ts", "../src/containers/Excel/exportCSV.ts", "../src/containers/MenuBar/index.module.css", "../src/containers/MenuBar/Theme.tsx", "../src/containers/MenuBar/I18N.tsx", "../src/index.tsx", "../src/controller/Controller.ts", "../src/formula/formula/error.ts", "../src/formula/formula/text.ts", "../src/formula/formula/math.ts", "../src/formula/formula/index.ts", "../src/formula/token.ts", "../src/formula/scanner.ts", "../src/formula/expression.ts", "../src/formula/parser.ts", "../src/formula/interpreter.ts", "../src/formula/eval.ts", "../src/model/History.ts", "../src/model/Model.ts", "../src/model/mockData.ts", "../src/model/mockModel.ts", "../src/controller/init.ts"],
  "sourcesContent": ["import React, { useRef, useEffect, Fragment, useState } from 'react';\nimport { IController, EditorStatus } from '@/types';\nimport { getHitInfo, DEFAULT_POSITION } from '@/util';\nimport styles from './index.module.css';\nimport { coreStore } from '@/containers/store';\nimport { ScrollBar } from './ScrollBar';\nimport { ContextMenu } from './ContextMenu';\nimport { initCanvas } from './util';\nimport { checkFocus, setActiveCellValue } from '@/canvas';\nimport { BottomBar } from './BottomBar';\nimport { FloatElementContainer } from '../FloatElement';\n\ninterface Props {\n  controller: IController;\n}\nconst DOUBLE_CLICK_TIME = 300;\n\ntype State = {\n  timeStamp: number;\n};\n\nexport const CanvasContainer: React.FunctionComponent<Props> = (props) => {\n  const { controller } = props;\n  const state = useRef<State>({\n    timeStamp: 0,\n  });\n  const [menuPosition, setMenuPosition] = useState({\n    top: DEFAULT_POSITION,\n    left: DEFAULT_POSITION,\n  });\n\n  const ref = useRef<HTMLCanvasElement>(null);\n  useEffect(() => {\n    if (!ref.current) {\n      return;\n    }\n    controller.setMainDom({ canvas: ref.current! });\n    return initCanvas(controller);\n  }, []);\n  const handleContextMenu = (event: React.MouseEvent<HTMLCanvasElement>) => {\n    event.preventDefault();\n    setMenuPosition({\n      top: event.clientY,\n      left: event.clientX,\n    });\n    return false;\n  };\n  const hideContextMenu = () => {\n    setMenuPosition({\n      top: DEFAULT_POSITION,\n      left: DEFAULT_POSITION,\n    });\n  };\n  const handlePointerMove = (event: React.PointerEvent<HTMLCanvasElement>) => {\n    if (event.buttons !== 1) {\n      return;\n    }\n    const headerSize = controller.getHeaderSize();\n    const rect = controller.getDomRect();\n    const { clientX, clientY } = event;\n    const x = clientX - rect.left;\n    const y = clientY - rect.top;\n\n    const position = getHitInfo(controller, x, y);\n    if (!position) {\n      return;\n    }\n    const activeCell = controller.getActiveCell();\n    if (activeCell.row === position.row && activeCell.col === position.col) {\n      return;\n    }\n    if (x > headerSize.width && y > headerSize.height) {\n      const colCount = Math.abs(position.col - activeCell.col) + 1;\n      const rowCount = Math.abs(position.row - activeCell.row) + 1;\n      controller.setActiveCell({\n        row: Math.min(position.row, activeCell.row),\n        col: Math.min(position.col, activeCell.col),\n        rowCount,\n        colCount,\n        sheetId: '',\n      });\n      return;\n    }\n    // select row\n    if (headerSize.width > x && headerSize.height <= y) {\n      const rowCount = Math.abs(position.row - activeCell.row) + 1;\n      controller.setActiveCell({\n        row: Math.min(position.row, activeCell.row),\n        col: Math.min(position.col, activeCell.col),\n        rowCount,\n        colCount: 0,\n        sheetId: '',\n      });\n      return;\n    }\n    // select col\n    if (headerSize.width <= x && headerSize.height > y) {\n      const colCount = Math.abs(position.col - activeCell.col) + 1;\n      controller.setActiveCell({\n        row: Math.min(position.row, activeCell.row),\n        col: Math.min(position.col, activeCell.col),\n        rowCount: 0,\n        colCount,\n        sheetId: '',\n      });\n      return;\n    }\n  };\n  const handlePointerDown = (event: React.PointerEvent<HTMLCanvasElement>) => {\n    if (event.buttons !== 1) {\n      return;\n    }\n    const headerSize = controller.getHeaderSize();\n    const canvasRect = controller.getDomRect();\n    const { timeStamp, clientX, clientY } = event;\n    const x = clientX - canvasRect.left;\n    const y = clientY - canvasRect.top;\n    const position = getHitInfo(controller, x, y);\n    if (!position) {\n      return;\n    }\n    // select all\n    if (headerSize.width > x && headerSize.height > y) {\n      controller.setActiveCell({\n        row: 0,\n        col: 0,\n        colCount: 0,\n        rowCount: 0,\n        sheetId: '',\n      });\n      return;\n    }\n    // select row\n    if (headerSize.width > x && headerSize.height <= y) {\n      controller.setActiveCell({\n        row: position.row,\n        col: position.col,\n        rowCount: 1,\n        colCount: 0,\n        sheetId: '',\n      });\n      return;\n    }\n    // select col\n    if (headerSize.width <= x && headerSize.height > y) {\n      controller.setActiveCell({\n        row: position.row,\n        col: position.col,\n        rowCount: 0,\n        colCount: 1,\n        sheetId: '',\n      });\n      return;\n    }\n    const activeCell = controller.getActiveCell();\n    const check =\n      activeCell.row >= 0 &&\n      activeCell.row === position.row &&\n      activeCell.col === position.col;\n    if (!check) {\n      if (checkFocus(controller)) {\n        setActiveCellValue(controller);\n      }\n      controller.setActiveCell({\n        row: position.row,\n        col: position.col,\n        rowCount: 1,\n        colCount: 1,\n        sheetId: '',\n      });\n    } else {\n      const delay = timeStamp - state.current.timeStamp;\n      if (delay < DOUBLE_CLICK_TIME) {\n        coreStore.mergeState({ editorStatus: EditorStatus.EDIT_CELL });\n      }\n    }\n\n    state.current.timeStamp = timeStamp;\n  };\n\n  return (\n    <Fragment>\n      <div\n        className={styles['canvas-container']}\n        data-testid=\"canvas-container\"\n      >\n        <canvas\n          className={styles['canvas-content']}\n          onContextMenu={handleContextMenu}\n          onPointerMove={handlePointerMove}\n          onPointerDown={handlePointerDown}\n          ref={ref}\n          data-testid=\"canvas-main\"\n        />\n        <ScrollBar controller={controller} />\n        <BottomBar controller={controller} />\n        <FloatElementContainer controller={controller} />\n      </div>\n      {menuPosition.top >= 0 && menuPosition.left >= 0 && (\n        <ContextMenu\n          {...menuPosition}\n          controller={controller}\n          hideContextMenu={hideContextMenu}\n        />\n      )}\n    </Fragment>\n  );\n};\nCanvasContainer.displayName = 'CanvasContainer';\n", ".canvas-container {\n  flex: 1;\n  position: relative;\n  overflow: hidden;\n  height: 100%;\n  width: 100%;\n}\n\n.vertical-scroll-bar {\n  position: absolute;\n  width: var(--scrollBarSize);\n  right: 0;\n  bottom: 0;\n  top: 0;\n  background-color: var(--white);\n  box-sizing: border-box;\n  padding: 0 5px;\n  border: 1px solid var(--borderColor);\n  border-top-color: var(--white);\n}\n\n.vertical-scroll-bar-content {\n  position: relative;\n  cursor: pointer;\n  border-radius: var(--borderRadius);\n  background-color: var(--scrollbarColor);\n}\n\n.horizontal-scroll-bar {\n  position: absolute;\n  height: var(--scrollBarSize);\n  right: 0;\n  left: 0;\n  bottom: 0;\n  box-sizing: border-box;\n  padding: 5px 0;\n  border: 1px solid var(--borderColor);\n  border-left-color: var(--white);\n  background-color: var(--white);\n}\n\n.horizontal-scroll-bar-content {\n  position: relative;\n  cursor: pointer;\n  border-radius: var(--borderRadius);\n  background-color: var(--scrollbarColor);\n  height: 100%;\n}\n\n.horizontal-scroll-bar-content:hover,\n.vertical-scroll-bar-content:hover {\n  background-color: var(--scrollbarHoveColor);\n}\n\n.context-menu {\n  position: fixed;\n  background-color: var(--white);\n  border-radius: var(--borderRadius);\n  width: 110px;\n  z-index: 4;\n}\n\n.context-menu > button {\n  width: 100%;\n  background-color: var(--white);\n}\n\n.bottom-bar {\n  position: absolute;\n  display: none;\n  align-items: center;\n  padding: var(--tinyPadding) var(--mediumPadding);\n  padding-top: 50px;\n  right: 18px;\n  bottom: 36px;\n}\n\n.bottom-bar-text {\n  margin: 0 var(--tinyPadding);\n}\n\n.add-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n", "import { deepEqual } from '@/util';\n\ntype StoreListener = () => void;\n\n// store value must be a primitive type or plain object or array of plain object\nexport class BaseStore<T> {\n  private listeners: StoreListener[] = [];\n  private state: T;\n  constructor(initValue: T) {\n    this.state = initValue;\n  }\n  // set array number boolean or plain object\n  setState = (data: T): void => {\n    // if (deepEqual(data, this.state)) {\n    //   return;\n    // }\n    this.state = data;\n    this.emitChange();\n  };\n  // set plain object\n  mergeState = (data: Partial<T>): void => {\n    const newState: T = {\n      ...this.state,\n      ...data,\n    };\n    if (deepEqual(newState, this.state)) {\n      return;\n    }\n    this.state = newState;\n    this.emitChange();\n  };\n  subscribe = (listener: StoreListener): StoreListener => {\n    this.listeners = [...this.listeners, listener];\n    return () => {\n      this.listeners = this.listeners.filter((l) => l !== listener);\n    };\n  };\n  getSnapshot = (): T => {\n    return this.state;\n  };\n  private emitChange() {\n    for (const listener of this.listeners) {\n      listener();\n    }\n  }\n}\n", "import type { WorksheetType } from '@/types';\nimport { BaseStore } from './base';\n\nexport type SheetItem = Pick<\n  WorksheetType,\n  'sheetId' | 'isHide' | 'name' | 'tabColor'\n>;\n\nexport const sheetListStore = new BaseStore<SheetItem[]>([]);\n", "import type {\n  StyleType,\n  IRange,\n  CanvasOverlayPosition,\n  ModelCellType,\n} from '@/types';\nimport { DEFAULT_POSITION } from '@/util';\nimport { BaseStore } from './base';\n\nexport type CellStoreType = Partial<StyleType> &\n  CanvasOverlayPosition &\n  IRange &\n  Pick<ModelCellType, 'value' | 'formula'> & {\n    defineName: string;\n    isMergeCell: boolean;\n  };\n\nconst cellData: CellStoreType = {\n  value: '',\n  formula: '',\n  row: 0,\n  col: 0,\n  left: DEFAULT_POSITION,\n  top: DEFAULT_POSITION,\n  width: 0,\n  height: 0,\n  defineName: '',\n  isMergeCell: false,\n  rowCount: 1,\n  colCount: 1,\n  sheetId: '',\n};\n\nexport const activeCellStore = new BaseStore<CellStoreType>(cellData);\n", "import { BaseStore } from './base';\nimport { EditorStatus } from '@/types';\nexport interface CoreStore {\n  editorStatus: EditorStatus;\n  canRedo: boolean;\n  canUndo: boolean;\n  activeUuid: string;\n}\n\nexport const coreStore = new BaseStore<CoreStore>({\n  editorStatus: EditorStatus.NONE,\n  canRedo: false,\n  canUndo: false,\n  activeUuid: '',\n});\n", "import type { OptionItem } from '@/types';\nimport { initFontFamilyList } from '@/util';\nimport { BaseStore } from './base';\n\nexport const fontFamilyStore = new BaseStore<OptionItem[]>(\n  initFontFamilyList(),\n);\n", "import { BaseStore } from './base';\n\nexport interface ScrollStore {\n  scrollTop: number;\n  scrollLeft: number;\n}\n\nexport const scrollStore = new BaseStore<ScrollStore>({\n  scrollTop: 0,\n  scrollLeft: 0,\n});\n", "import type { FloatElement } from '@/types';\nimport { BaseStore } from './base';\nexport type FloatElementItem = FloatElement & {\n  labels: string[];\n  datasets: Array<{ label: string; data: number[] }>;\n  top: number;\n  left: number;\n};\n\nexport const floatElementStore = new BaseStore<FloatElementItem[]>([]);\n", "import React, { useRef, Fragment, useSyncExternalStore } from 'react';\nimport { IController, ScrollStatus, ScrollValue } from '@/types';\nimport { SCROLL_SIZE } from '@/util';\nimport { computeScrollRowAndCol, computeScrollPosition } from '@/canvas';\nimport styles from './index.module.css';\nimport { scrollStore } from '../store';\n\ninterface Props {\n  controller: IController;\n}\n\ninterface State {\n  prevPageY: number;\n  prevPageX: number;\n  scrollStatus: ScrollStatus;\n}\n\nfunction scrollBar(controller: IController, scrollX: number, scrollY: number) {\n  const oldScroll = controller.getScroll();\n  const { maxHeight, maxScrollHeight, maxScrollWidth, maxWidth } =\n    computeScrollPosition(controller, oldScroll.left, oldScroll.top);\n\n  let scrollTop = oldScroll.scrollTop + Math.ceil(scrollY);\n  let scrollLeft = oldScroll.scrollLeft + Math.ceil(scrollX);\n  if (scrollTop < 0) {\n    scrollTop = 0;\n  } else if (scrollTop > maxScrollHeight) {\n    scrollTop = maxScrollHeight;\n  }\n  if (scrollLeft < 0) {\n    scrollLeft = 0;\n  } else if (scrollLeft > maxScrollWidth) {\n    scrollLeft = maxScrollWidth;\n  }\n  const top = Math.floor((maxHeight * scrollTop) / maxScrollHeight);\n  const left = Math.floor((maxWidth * scrollLeft) / maxScrollWidth);\n  const { row, col } = computeScrollRowAndCol(controller, left, top);\n  const data: ScrollValue = {\n    top,\n    left,\n    row,\n    col,\n    scrollLeft,\n    scrollTop,\n  };\n  controller.setScroll(data);\n}\nexport const ScrollBar: React.FunctionComponent<Props> = ({ controller }) => {\n  const state = useRef<State>({\n    prevPageX: 0,\n    prevPageY: 0,\n    scrollStatus: ScrollStatus.NONE,\n  });\n  const { scrollLeft, scrollTop } = useSyncExternalStore(\n    scrollStore.subscribe,\n    scrollStore.getSnapshot,\n  );\n  function handleDrag(event: PointerEvent) {\n    if (event.buttons !== 1) {\n      return;\n    }\n    event.stopPropagation();\n    if (state.current.scrollStatus === ScrollStatus.VERTICAL) {\n      if (state.current.prevPageY) {\n        scrollBar(controller, 0, event.pageY - state.current.prevPageY);\n      }\n      state.current.prevPageY = event.pageY;\n    } else if (state.current.scrollStatus === ScrollStatus.HORIZONTAL) {\n      if (state.current.prevPageX) {\n        scrollBar(controller, event.pageX - state.current.prevPageX, 0);\n      }\n      state.current.prevPageX = event.pageX;\n    }\n  }\n  function handleDragEnd() {\n    state.current.scrollStatus = ScrollStatus.NONE;\n    state.current.prevPageY = 0;\n    state.current.prevPageX = 0;\n    document.removeEventListener('pointermove', handleDrag);\n    document.removeEventListener('pointerup', handleDragEnd);\n  }\n  function register(\n    event: React.PointerEvent<HTMLDivElement>,\n    status: ScrollStatus,\n  ) {\n    if (event.buttons !== 1) {\n      return;\n    }\n    if (state.current.scrollStatus) {\n      return;\n    }\n    state.current.scrollStatus = status;\n    document.addEventListener('pointermove', handleDrag);\n    document.addEventListener('pointerup', handleDragEnd);\n  }\n  return (\n    <Fragment>\n      <div\n        className={styles['vertical-scroll-bar']}\n        data-testid=\"vertical-scroll-bar\"\n        onPointerLeave={handleDragEnd}\n        onPointerDown={(event) => {\n          register(event, ScrollStatus.VERTICAL);\n        }}\n      >\n        <div\n          className={styles['vertical-scroll-bar-content']}\n          style={{\n            height: SCROLL_SIZE,\n            transform: `translateY(${scrollTop}px)`,\n          }}\n        />\n      </div>\n      <div\n        className={styles['horizontal-scroll-bar']}\n        data-testid=\"horizontal-scroll-bar\"\n        onPointerLeave={handleDragEnd}\n        onPointerDown={(event) => {\n          register(event, ScrollStatus.HORIZONTAL);\n        }}\n      >\n        <div\n          className={styles['horizontal-scroll-bar-content']}\n          style={{\n            width: SCROLL_SIZE,\n            transform: `translateX(${scrollLeft}px)`,\n          }}\n        />\n      </div>\n    </Fragment>\n  );\n};\nScrollBar.displayName = 'ScrollBar';\n", "import {\n  npx,\n  DEFAULT_FONT_CONFIG,\n  isNumber,\n  DEFAULT_FONT_SIZE,\n  makeFont,\n  ERROR_SET,\n  dpr,\n  isEmpty,\n  splitToWords,\n  convertResultTypeToString,\n  sizeConfig,\n  getThemeColor,\n} from '@/util';\nimport {\n  ModelCellType,\n  CanvasOverlayPosition,\n  ErrorTypes,\n  Point,\n  EUnderLine,\n  IController,\n  IWindowSize,\n} from '@/types';\n\nconst measureTextMap = new Map<string, IWindowSize>();\n\nexport function measureText(\n  ctx: CanvasRenderingContext2D,\n  char: string,\n): IWindowSize {\n  const mapKey = `${char}__${ctx.font}`;\n  if (measureTextMap.has(mapKey)) {\n    return measureTextMap.get(mapKey)!;\n  }\n  const text = ctx.measureText(char);\n  const { actualBoundingBoxAscent, actualBoundingBoxDescent } = text;\n  const h = actualBoundingBoxAscent + actualBoundingBoxDescent;\n  const w = text.width;\n  const width = Math.ceil(w / dpr());\n  const height = Math.ceil(h / dpr());\n  const result = { width, height };\n  measureTextMap.set(mapKey, result);\n  return result;\n}\n\nexport function fillRect(\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n): void {\n  ctx.fillRect(npx(x), npx(y), npx(width), npx(height));\n}\nexport function strokeRect(\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n): void {\n  ctx.strokeRect(npx(x), npx(y), npx(width), npx(height));\n}\n\nexport function clearRect(\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n): void {\n  ctx.clearRect(npx(x), npx(y), npx(width), npx(height));\n}\n\nexport function fillText(\n  ctx: CanvasRenderingContext2D,\n  text: string,\n  x: number,\n  y: number,\n) {\n  ctx.fillText(text, npx(x), npx(y));\n}\n\ninterface IRenderCellResult {\n  height: number;\n  width: number;\n  fontSizeHeight?: number;\n}\n\nfunction drawUnderlineData(\n  ctx: CanvasRenderingContext2D,\n  isNum: boolean,\n  style: ModelCellType['style'],\n  textHeight: number,\n  x: number,\n  y: number,\n  textWidth: number,\n) {\n  let list: Point[] = [];\n  if (style?.underline) {\n    let pointList: Point[] = [];\n    const isDouble = style?.underline === EUnderLine.DOUBLE;\n    const t = Math.floor(y + textHeight);\n    if (isNum) {\n      pointList = [\n        [x - textWidth, t],\n        [x, t],\n      ];\n    } else {\n      pointList = [\n        [x, t],\n        [x + textWidth, t],\n      ];\n    }\n    list = list.concat(getPointList(pointList, isDouble));\n  }\n  if (style?.isStrike) {\n    let pointList: Point[] = [];\n    const t = Math.floor(y + textHeight * 0.2);\n    if (isNum) {\n      pointList = [\n        [x - textWidth, t],\n        [x, t],\n      ];\n    } else {\n      pointList = [\n        [x, t],\n        [x + textWidth, t],\n      ];\n    }\n    list = list.concat(getPointList(pointList, false));\n  }\n  drawLines(ctx, list);\n}\n\nexport function renderCellData(\n  controller: IController,\n  ctx: CanvasRenderingContext2D,\n  row: number,\n  col: number,\n): IWindowSize {\n  const range = {\n    row,\n    col,\n    colCount: 1,\n    rowCount: 1,\n    sheetId: '',\n  };\n  const cellInfo = controller.getCell(range);\n  const result: IWindowSize = {\n    width: 0,\n    height: 0,\n  };\n  if (!cellInfo) {\n    return result;\n  }\n  const cellSize = controller.getCellSize(range);\n  if (cellSize.width <= 0 || cellSize.height <= 0) {\n    return result;\n  }\n  const position = controller.computeCellPosition(range);\n  const newSize = renderCell(ctx, {\n    ...cellInfo,\n    top: position.top,\n    left: position.left,\n    width: cellSize.width,\n    height: cellSize.height,\n  });\n  result.height = Math.ceil(newSize.height);\n  result.width = Math.ceil(newSize.width);\n  return result;\n}\n\nexport function renderCell(\n  ctx: CanvasRenderingContext2D,\n  cellInfo: ModelCellType & CanvasOverlayPosition,\n): IRenderCellResult {\n  const { style, value, left, top, width, height } = cellInfo;\n  const result: IRenderCellResult = { height: 0, width: 0 };\n  if (isEmpty(cellInfo.value) && isEmpty(cellInfo.style)) {\n    return result;\n  }\n  const isNum = isNumber(value);\n  let font = DEFAULT_FONT_CONFIG;\n  let fillStyle: string = getThemeColor('contentColor');\n  const fontSize = style?.fontSize ? style.fontSize : DEFAULT_FONT_SIZE;\n  if (!isEmpty(style)) {\n    font = makeFont(\n      style?.isItalic ? 'italic' : 'normal',\n      style?.isBold ? 'bold' : '500',\n      npx(fontSize),\n      style?.fontFamily,\n    );\n    fillStyle = style?.fontColor || getThemeColor('contentColor');\n    if (style?.fillColor) {\n      ctx.fillStyle = style?.fillColor;\n      fillRect(ctx, left, top, width, height);\n    }\n  }\n  const text = convertResultTypeToString(value);\n  if (ERROR_SET.has(text as ErrorTypes)) {\n    fillStyle = getThemeColor('errorFormulaColor');\n  }\n\n  const texts = splitToWords(text);\n  if (texts.length === 0) {\n    return result;\n  }\n  ctx.textAlign = isNum ? 'right' : 'left';\n  ctx.font = font;\n  ctx.fillStyle = fillStyle;\n  ctx.textBaseline = 'middle';\n  if (texts.length === 0) {\n    return result;\n  }\n\n  if (style?.underline) {\n    ctx.strokeStyle = fillStyle;\n  }\n\n  const textHeight = Math.ceil(fontSize * sizeConfig.lineHeight);\n  const lineGap = Math.ceil((fontSize * (sizeConfig.lineHeight - 1)) / 2);\n  const x = left + (isNum ? width - lineGap : lineGap);\n  result.height = textHeight;\n  if (style?.isWrapText) {\n    result.height = lineGap * 2;\n    let y = top + result.height;\n    let line = '';\n    let textWidth = 0;\n    let h = 0;\n    for (let i = 0; i < texts.length; i++) {\n      const testLine = line + texts[i];\n      const size = measureText(ctx, testLine);\n      if (size.width > width) {\n        y += lineGap;\n        if (i === 0) {\n          textWidth = size.width;\n          h = size.height;\n          fillText(ctx, texts[i], x, y);\n          line = '';\n        } else {\n          fillText(ctx, line, x, y);\n          line = texts[i];\n        }\n        drawUnderlineData(ctx, isNum, style, h, x, y, textWidth);\n        y += h + lineGap;\n        result.height += h + lineGap * 2;\n        result.width = Math.max(textWidth, result.width);\n      } else {\n        textWidth = size.width;\n        h = size.height;\n        line = testLine;\n      }\n    }\n    if (line) {\n      result.height += h + lineGap;\n      result.width = Math.max(textWidth, result.width);\n      fillText(ctx, line, x, y);\n      drawUnderlineData(ctx, isNum, style, h, x, y, textWidth);\n    }\n    result.width += lineGap * 2;\n  } else {\n    let line = '';\n    let textWidth = 0;\n    let h = 0;\n\n    for (let i = 0; i < texts.length; i++) {\n      const testLine = line + texts[i];\n      const size = measureText(ctx, testLine);\n      if (size.width > width) {\n        if (i === 0) {\n          textWidth = size.width;\n          h = size.height;\n          line = testLine;\n        }\n        break;\n      } else {\n        textWidth = size.width;\n        h = size.height;\n        line = testLine;\n      }\n    }\n    const t = h > height ? h : height;\n    const y = top + t / 2;\n    result.height = h;\n    fillText(ctx, line, x, y);\n    drawUnderlineData(ctx, isNum, style, h, x, y, textWidth);\n    result.width = textWidth + lineGap * 2;\n  }\n\n  return result;\n}\n\nexport function drawLines(\n  ctx: CanvasRenderingContext2D,\n  pointList: Point[],\n): void {\n  if (pointList.length === 0) {\n    return;\n  }\n  ctx.beginPath();\n  for (let i = 0; i < pointList.length; i += 2) {\n    const first = pointList[i];\n    const second = pointList[i + 1];\n    ctx.moveTo(npx(first[0]), npx(first[1]));\n    ctx.lineTo(npx(second[0]), npx(second[1]));\n  }\n  ctx.stroke();\n}\n\nexport function drawTriangle(\n  ctx: CanvasRenderingContext2D,\n  point1: Point,\n  point2: Point,\n  point3: Point,\n) {\n  ctx.beginPath();\n  ctx.moveTo(npx(point1[0]), npx(point1[1]));\n  ctx.lineTo(npx(point2[0]), npx(point2[1]));\n  ctx.lineTo(npx(point3[0]), npx(point3[1]));\n  ctx.fill();\n}\n\nexport function drawAntLine(\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n) {\n  const oldDash = ctx.getLineDash();\n  ctx.setLineDash([npx(8), npx(6)]);\n  const offset = dpr() / 2;\n  strokeRect(\n    ctx,\n    x + offset,\n    y + offset,\n    width - offset * 2,\n    height - offset * 2,\n  );\n  ctx.setLineDash(oldDash);\n}\n\nexport function getPointList(pointList: Point[], isExtra: boolean) {\n  const [start, end] = pointList;\n  const offset = dpr();\n  const list: Point[] = [\n    [start[0], start[1] - offset],\n    [end[0], end[1] - offset],\n  ];\n  if (isExtra) {\n    const t = offset * 2;\n    list.push([start[0], start[1] - t], [end[0], end[1] - t]);\n  }\n  return list;\n}\n\nexport function resizeCanvas(\n  canvas: HTMLCanvasElement,\n  width: number,\n  height: number,\n): void {\n  canvas.style.width = `${width}px`;\n  canvas.style.height = `${height}px`;\n  const realWidth = npx(width);\n  const realHeight = npx(height);\n  canvas.width = realWidth;\n  canvas.height = realHeight;\n}\n", "import { thinLineWidth, DEFAULT_FONT_CONFIG, getThemeColor } from '@/util';\n\nexport function getHeaderStyle(): Pick<\n  CanvasRenderingContext2D,\n  | 'textAlign'\n  | 'textBaseline'\n  | 'font'\n  | 'fillStyle'\n  | 'lineWidth'\n  | 'strokeStyle'\n> {\n  return {\n    textAlign: 'center',\n    textBaseline: 'middle',\n    font: DEFAULT_FONT_CONFIG,\n    fillStyle: getThemeColor('black'),\n    lineWidth: thinLineWidth(),\n    strokeStyle: getThemeColor('borderColor'),\n  };\n}\n", "import {\n  dpr,\n  npx,\n  isCol,\n  isRow,\n  isSheet,\n  canvasLog,\n  thinLineWidth,\n  intToColumnName,\n  containRange,\n  getThemeColor,\n} from '@/util';\nimport {\n  EventType,\n  ContentView,\n  CanvasOverlayPosition,\n  IController,\n  Point,\n  IRange,\n} from '@/types';\nimport {\n  fillRect,\n  strokeRect,\n  drawLines,\n  drawTriangle,\n  clearRect,\n  drawAntLine,\n  resizeCanvas,\n  fillText,\n  renderCellData,\n} from './util';\nimport { getHeaderStyle } from './constant';\n\nexport class MainCanvas {\n  private ctx: CanvasRenderingContext2D;\n  private content: ContentView;\n  private controller: IController;\n  private isRendering = false;\n  constructor(controller: IController, content: ContentView) {\n    const canvas = controller.getMainDom().canvas!;\n    this.controller = controller;\n    this.ctx = canvas.getContext('2d')!;\n    this.content = content;\n    const size = dpr();\n    this.ctx.scale(size, size);\n  }\n  resize() {\n    const size = this.controller.getDomRect();\n    const { width, height } = size;\n    resizeCanvas(this.ctx.canvas, width, height);\n    this.content.resize();\n  }\n  private clear() {\n    const { width, height } = this.controller.getDomRect();\n    this.ctx.clearRect(0, 0, npx(width), npx(height));\n  }\n  render = (params: EventType) => {\n    if (params.changeSet.size === 0) {\n      return;\n    }\n    if (this.isRendering) {\n      canvasLog('It is rendering');\n      return;\n    }\n    this.isRendering = true;\n    this.content.render(params);\n    this.clear();\n\n    this.ctx.drawImage(this.content.getCanvas(), 0, 0);\n\n    const { width, height } = this.controller.getDomRect();\n    const headerSize = this.controller.getHeaderSize();\n    const contentWidth = width - headerSize.width;\n    const contentHeight = height - headerSize.height;\n    this.renderGrid(contentWidth, contentHeight);\n    this.renderRowsHeader(contentHeight);\n    this.renderColsHeader(contentWidth);\n    this.renderTriangle();\n\n    const result = this.renderSelection();\n    this.renderAntLine(result);\n\n    this.renderMergeCell();\n\n    this.isRendering = false;\n  };\n\n  private renderMergeCell() {\n    const { controller } = this;\n    const range = controller.getActiveCell();\n    const mergeCells = controller.getMergeCells(controller.getCurrentSheetId());\n    if (mergeCells.length === 0) {\n      return;\n    }\n    for (const item of mergeCells) {\n      const position = controller.computeCellPosition(item);\n      const size = controller.getCellSize(item);\n      if (size.width <= 0 || size.height <= 0) {\n        continue;\n      }\n      // clear merge cell area\n      clearRect(this.ctx, position.left, position.top, size.width, size.height);\n      // render content\n      renderCellData(controller, this.ctx, item.row, item.col);\n      if (isSheet(range) || isRow(range) || isCol(range)) {\n        continue;\n      }\n      if (containRange(range.row, range.col, item)) {\n        this.ctx.strokeStyle = getThemeColor('primaryColor');\n        this.ctx.lineWidth = dpr();\n        // highlight line\n        strokeRect(\n          this.ctx,\n          position.left,\n          position.top,\n          size.width,\n          size.height,\n        );\n      }\n    }\n  }\n\n  private renderGrid(width: number, height: number): void {\n    const { controller } = this;\n    const headerSize = controller.getHeaderSize();\n    const { row: rowIndex, col: colIndex } = controller.getScroll();\n    const { rowCount, colCount } = this.controller.getSheetInfo(\n      this.controller.getCurrentSheetId(),\n    )!;\n    const lineWidth = thinLineWidth();\n    this.ctx.save();\n    this.ctx.fillStyle = getThemeColor('white');\n    this.ctx.lineWidth = lineWidth;\n    this.ctx.strokeStyle = getThemeColor('borderColor');\n    this.ctx.translate(npx(headerSize.width), npx(headerSize.height));\n    const pointList: Point[] = [];\n    let y = 0;\n    let x = 0;\n    let maxX = 0;\n    for (let i = colIndex; i < colCount; i++) {\n      maxX += controller.getColWidth(i).len;\n      if (maxX > width) {\n        break;\n      }\n    }\n    const realWidth = Math.min(maxX, width);\n    let skip = false;\n    for (let i = rowIndex; i < rowCount; i++) {\n      if (!skip) {\n        pointList.push([0, y], [realWidth, y]);\n      } else {\n        skip = false;\n      }\n      const h = controller.getRowHeight(i).len;\n      if (h === 0) {\n        skip = true;\n      }\n      y += h;\n      if (y > height) {\n        break;\n      }\n    }\n    for (let i = colIndex; i < colCount; i++) {\n      if (!skip) {\n        pointList.push([x, 0], [x, y]);\n      } else {\n        skip = false;\n      }\n      const w = controller.getColWidth(i).len;\n      if (w === 0) {\n        skip = true;\n      }\n      x += w;\n      if (x > realWidth) {\n        break;\n      }\n    }\n    pointList.push([0, y], [x, y]);\n    pointList.push([x, 0], [x, y]);\n    drawLines(this.ctx, pointList);\n    this.ctx.restore();\n  }\n  private isHighlightRow(\n    mergeCells: IRange[],\n    range: IRange,\n    row: number,\n  ): boolean {\n    if (isSheet(range)) {\n      return true;\n    }\n    if (isCol(range)) {\n      return true;\n    }\n    if (row >= range.row && row < range.row + range.rowCount) {\n      return true;\n    }\n    return mergeCells.some((v) => row >= v.row && row < v.row + v.rowCount);\n  }\n\n  private isHighlightCol(\n    mergeCells: IRange[],\n    range: IRange,\n    col: number,\n  ): boolean {\n    if (isSheet(range)) {\n      return true;\n    }\n\n    if (isRow(range)) {\n      return true;\n    }\n    if (col >= range.col && col < range.col + range.colCount) {\n      return true;\n    }\n    return mergeCells.some((v) => col >= v.col && col < v.col + v.colCount);\n  }\n  private renderRowsHeader(height: number): void {\n    const { controller } = this;\n    const { row: rowIndex } = controller.getScroll();\n    const headerSize = controller.getHeaderSize();\n    const { rowCount } = controller.getSheetInfo(\n      controller.getCurrentSheetId(),\n    )!;\n    const mergeCells = controller.getMergeCells(controller.getCurrentSheetId());\n    this.ctx.save();\n    const range = this.controller.getActiveCell();\n    this.ctx.fillStyle = getThemeColor('white');\n    fillRect(this.ctx, 0, headerSize.height, headerSize.width, height);\n    Object.assign(this.ctx, getHeaderStyle());\n    const pointList: Point[] = [];\n    let y = headerSize.height;\n    let i = rowIndex;\n\n    for (; i < rowCount; i++) {\n      const rowHeight = controller.getRowHeight(i).len;\n      let temp = y;\n      if (i === rowIndex) {\n        temp += thinLineWidth() / 2;\n      }\n      pointList.push([0, temp], [headerSize.width, temp]);\n      if (rowHeight > 0) {\n        const check = this.isHighlightRow(mergeCells, range, i);\n        this.ctx.fillStyle = check\n          ? getThemeColor('primaryColor')\n          : getThemeColor('black');\n\n        fillText(\n          this.ctx,\n          String(i + 1),\n          headerSize.width / 2,\n          temp + rowHeight / 2,\n        );\n      }\n      y += rowHeight;\n      if (y > height) {\n        break;\n      }\n    }\n    pointList.push([0, y], [headerSize.width, y]);\n    pointList.push([0, 0], [0, y]);\n    drawLines(this.ctx, pointList);\n    this.ctx.restore();\n  }\n  private renderColsHeader(width: number): void {\n    const { controller } = this;\n\n    const { col: colIndex } = controller.getScroll();\n    const headerSize = controller.getHeaderSize();\n    const { colCount } = controller.getSheetInfo(\n      controller.getCurrentSheetId(),\n    )!;\n    const mergeCells = controller.getMergeCells(controller.getCurrentSheetId());\n    const range = this.controller.getActiveCell();\n    const pointList: Point[] = [];\n    this.ctx.save();\n    this.ctx.fillStyle = getThemeColor('white');\n    fillRect(this.ctx, headerSize.width, 0, width, headerSize.height);\n    Object.assign(this.ctx, getHeaderStyle());\n\n    let x = headerSize.width;\n    let i = colIndex;\n    for (; i < colCount; i++) {\n      const colWidth = controller.getColWidth(i).len;\n      let temp = x;\n      if (i === colIndex) {\n        temp += thinLineWidth() / 2;\n      }\n      pointList.push([temp, 0], [temp, headerSize.height]);\n      if (colWidth > 0) {\n        const check = this.isHighlightCol(mergeCells, range, i);\n        this.ctx.fillStyle = check\n          ? getThemeColor('primaryColor')\n          : getThemeColor('black');\n        fillText(\n          this.ctx,\n          intToColumnName(i),\n          temp + colWidth / 2,\n          headerSize.height / 2 + dpr(),\n        );\n      }\n      x += colWidth;\n      if (x > width) {\n        break;\n      }\n    }\n    pointList.push([x, 0], [x, headerSize.height]);\n    pointList.push([0, 0], [x, 0]);\n    drawLines(this.ctx, pointList);\n    this.ctx.restore();\n  }\n  private renderTriangle(): void {\n    const headerSize = this.controller.getHeaderSize();\n    this.ctx.save();\n    this.ctx.fillStyle = getThemeColor('white');\n\n    fillRect(this.ctx, 0, 0, headerSize.width, headerSize.height);\n    this.ctx.fillStyle = getThemeColor('triangleFillColor');\n\n    const offset = 2;\n    const minY = Math.floor(offset);\n    const maxY = Math.floor(headerSize.height - offset);\n    const minX = Math.floor(headerSize.width * 0.4);\n    const maxX = Math.floor(headerSize.width - offset);\n\n    drawTriangle(this.ctx, [maxX, minY], [minX, maxY], [maxX, maxY]);\n\n    this.ctx.restore();\n  }\n  private renderAntLine(position: CanvasOverlayPosition) {\n    const { controller } = this;\n    const ranges = controller.getCopyRanges();\n    if (ranges.length === 0) {\n      return;\n    }\n    const [range] = ranges;\n    if (range.sheetId !== controller.getCurrentSheetId()) {\n      return;\n    }\n    canvasLog('render canvas ant line');\n    this.ctx.strokeStyle = getThemeColor('primaryColor');\n    this.ctx.lineWidth = dpr();\n    drawAntLine(\n      this.ctx,\n      position.left,\n      position.top,\n      position.width,\n      position.height,\n    );\n  }\n\n  private renderSelection(): CanvasOverlayPosition {\n    const { controller } = this;\n    const range = controller.getActiveCell();\n    canvasLog('render canvas selection');\n    if (isSheet(range)) {\n      const result = this.renderSelectAll();\n      return result;\n    }\n    if (isCol(range)) {\n      const result = this.renderSelectCol();\n      return result;\n    }\n    if (isRow(range)) {\n      const result = this.renderSelectRow();\n      return result;\n    }\n    return this.renderSelectRange();\n  }\n\n  private renderActiveCell() {\n    const { controller } = this;\n    const range = controller.getActiveCell();\n    if (range.rowCount === range.colCount && range.rowCount === 1) {\n      return;\n    }\n    const temp = {\n      row: range.row,\n      col: range.col,\n      rowCount: 1,\n      colCount: 1,\n      sheetId: '',\n    };\n    const activeCell = controller.computeCellPosition(temp);\n    const cellSize = controller.getCellSize(temp);\n    clearRect(\n      this.ctx,\n      activeCell.left,\n      activeCell.top,\n      cellSize.width,\n      cellSize.height,\n    );\n    renderCellData(controller, this.ctx, range.row, range.col);\n  }\n  private renderSelectRange() {\n    const { controller } = this;\n    const headerSize = controller.getHeaderSize();\n    const range = controller.getActiveCell();\n\n    const activeCell = controller.computeCellPosition({\n      row: range.row,\n      col: range.col,\n      rowCount: 1,\n      colCount: 1,\n      sheetId: '',\n    });\n    const endCellRow = range.row + range.rowCount - 1;\n    const endCellCol = range.col + range.colCount - 1;\n\n    const temp = {\n      row: endCellRow,\n      col: endCellCol,\n      rowCount: 1,\n      colCount: 1,\n      sheetId: '',\n    };\n    const endCell = controller.computeCellPosition(temp);\n    const endCellSize = controller.getCellSize(temp);\n    const width = endCell.left + endCellSize.width - activeCell.left;\n    const height = endCell.top + endCellSize.height - activeCell.top;\n\n    this.ctx.fillStyle = getThemeColor('selectionColor');\n\n    // col header\n    fillRect(this.ctx, activeCell.left, 0, width, headerSize.height);\n    // row header\n    fillRect(this.ctx, 0, activeCell.top, headerSize.width, height);\n    const check = range.rowCount > 1 || range.colCount > 1;\n    if (check) {\n      // main\n      fillRect(this.ctx, activeCell.left, activeCell.top, width, height);\n    }\n\n    this.ctx.strokeStyle = getThemeColor('primaryColor');\n    this.ctx.lineWidth = dpr();\n\n    const list: Point[] = [\n      [activeCell.left, headerSize.height],\n      [activeCell.left + width, headerSize.height],\n    ];\n    list.push(\n      [headerSize.width, activeCell.top],\n      [headerSize.width, activeCell.top + height],\n    );\n    drawLines(this.ctx, list);\n    if (check) {\n      this.renderActiveCell();\n    }\n    // highlight line\n    strokeRect(this.ctx, activeCell.left, activeCell.top, width, height);\n    return {\n      left: activeCell.left,\n      top: activeCell.top,\n      width,\n      height,\n    };\n  }\n  private renderSelectAll(): CanvasOverlayPosition {\n    const { controller } = this;\n    const { width, height } = this.controller.getDomRect();\n    this.ctx.fillStyle = getThemeColor('selectionColor');\n    // main\n    fillRect(this.ctx, 0, 0, width, height);\n\n    const headerSize = controller.getHeaderSize();\n    this.ctx.strokeStyle = getThemeColor('primaryColor');\n    this.ctx.lineWidth = dpr();\n    this.renderActiveCell();\n    // highlight line\n    strokeRect(this.ctx, headerSize.width, headerSize.height, width, height);\n    return {\n      left: headerSize.width,\n      top: headerSize.height,\n      width: width,\n      height: height,\n    };\n  }\n  private renderSelectCol() {\n    const { controller } = this;\n    const headerSize = controller.getHeaderSize();\n    const range = controller.getActiveCell();\n    const { height } = controller.getDomRect();\n    this.ctx.fillStyle = getThemeColor('selectionColor');\n    const activeCell = controller.computeCellPosition({\n      row: range.row,\n      col: range.col,\n      colCount: 1,\n      rowCount: 1,\n      sheetId: '',\n    });\n\n    let strokeWidth = 0;\n    for (\n      let i = range.col, endCol = range.col + range.colCount;\n      i < endCol;\n      i++\n    ) {\n      strokeWidth += controller.getColWidth(i).len;\n    }\n    // col header\n    fillRect(this.ctx, activeCell.left, 0, strokeWidth, headerSize.height);\n\n    // row header\n    fillRect(this.ctx, 0, activeCell.top, headerSize.width, height);\n\n    // main\n    fillRect(this.ctx, activeCell.left, activeCell.top, strokeWidth, height);\n\n    this.ctx.strokeStyle = getThemeColor('primaryColor');\n    this.ctx.lineWidth = dpr();\n    const list: Point[] = [\n      [headerSize.width, headerSize.height],\n      [headerSize.width, height],\n    ];\n    drawLines(this.ctx, list);\n    this.renderActiveCell();\n    // highlight line\n    strokeRect(this.ctx, activeCell.left, activeCell.top, strokeWidth, height);\n    return {\n      left: activeCell.left,\n      top: activeCell.top,\n      width: strokeWidth,\n      height,\n    };\n  }\n  private renderSelectRow() {\n    const { controller } = this;\n    const headerSize = controller.getHeaderSize();\n    const range = controller.getActiveCell();\n    const { width } = controller.getDomRect();\n    this.ctx.fillStyle = getThemeColor('selectionColor');\n    const activeCell = controller.computeCellPosition({\n      row: range.row,\n      col: range.col,\n      colCount: 1,\n      rowCount: 1,\n      sheetId: '',\n    });\n    let strokeHeight = 0;\n    for (\n      let i = range.row, endRow = range.row + range.rowCount;\n      i < endRow;\n      i++\n    ) {\n      strokeHeight += controller.getRowHeight(i).len;\n    }\n    // col header\n    fillRect(this.ctx, activeCell.left, 0, width, headerSize.height);\n    // row header\n    fillRect(this.ctx, 0, activeCell.top, headerSize.width, strokeHeight);\n\n    // main\n    fillRect(this.ctx, activeCell.left, activeCell.top, width, strokeHeight);\n\n    this.ctx.strokeStyle = getThemeColor('primaryColor');\n    this.ctx.lineWidth = dpr();\n    const list: Point[] = [\n      [activeCell.left, headerSize.height],\n      [width, headerSize.height],\n    ];\n    drawLines(this.ctx, list);\n    this.renderActiveCell();\n    // highlight line\n    strokeRect(this.ctx, activeCell.left, activeCell.top, width, strokeHeight);\n    return {\n      left: activeCell.left,\n      top: activeCell.top,\n      width,\n      height: strokeHeight,\n    };\n  }\n}\n", "import {\n  KeyboardEventItem,\n  IController,\n  EUnderLine,\n  EditorStatus,\n} from '@/types';\nimport { BOTTOM_BUFF, SCROLL_SIZE, isMac } from '@/util';\nimport { coreStore } from '@/containers/store';\n\nexport function handleTabClick(controller: IController) {\n  checkActiveElement(controller);\n  controller.setNextActiveCell('right');\n  recalculateScroll(controller);\n}\n\nexport function handleEnterClick(controller: IController) {\n  checkActiveElement(controller);\n  controller.setNextActiveCell('down');\n  recalculateScroll(controller);\n}\n\nexport function computeScrollRowAndCol(\n  controller: IController,\n  left: number,\n  top: number,\n) {\n  const oldScroll = controller.getScroll();\n  let { row, col } = oldScroll;\n  if (oldScroll.top !== top) {\n    row = 0;\n    let t = top;\n    while (t > 0) {\n      const a = controller.getRowHeight(row).len;\n      if (a > t) {\n        break;\n      }\n      t -= a;\n      row++;\n    }\n  }\n  if (oldScroll.left !== left) {\n    col = 0;\n    let t = left;\n    while (t > 0) {\n      const a = controller.getColWidth(col).len;\n      if (a > t) {\n        break;\n      }\n      t -= a;\n      col++;\n    }\n  }\n\n  return {\n    row,\n    col,\n  };\n}\n\nexport function computeScrollPosition(\n  controller: IController,\n  left: number,\n  top: number,\n) {\n  const canvasRect = controller.getDomRect();\n  const viewSize = controller.getViewSize();\n  const maxHeight = viewSize.height - canvasRect.height + BOTTOM_BUFF;\n  const maxWidth = viewSize.width - canvasRect.width + BOTTOM_BUFF;\n  const maxScrollHeight = canvasRect.height - SCROLL_SIZE * 1;\n  const maxScrollWidth = canvasRect.width - SCROLL_SIZE * 1;\n\n  const scrollTop = Math.floor((top * maxScrollHeight) / maxHeight);\n  const scrollLeft = Math.floor((left * maxScrollWidth) / maxWidth);\n  return {\n    maxHeight,\n    maxWidth,\n    maxScrollHeight,\n    maxScrollWidth,\n    scrollTop,\n    scrollLeft,\n  };\n}\n\nexport function scrollBar(\n  controller: IController,\n  scrollX: number,\n  scrollY: number,\n) {\n  const oldScroll = controller.getScroll();\n  const { maxHeight, maxWidth, maxScrollHeight, maxScrollWidth } =\n    computeScrollPosition(controller, oldScroll.left, oldScroll.top);\n  let top = oldScroll.top + Math.ceil(scrollY);\n  if (top < 0) {\n    top = 0;\n  } else if (top > maxHeight) {\n    top = maxHeight;\n  }\n\n  let left = oldScroll.left + Math.ceil(scrollX);\n  if (left < 0) {\n    left = 0;\n  } else if (left > maxWidth) {\n    left = maxWidth;\n  }\n  const { row, col } = computeScrollRowAndCol(controller, left, top);\n  const scrollTop = Math.floor((top * maxScrollHeight) / maxHeight);\n  const scrollLeft = Math.floor((left * maxScrollWidth) / maxWidth);\n  controller.setScroll({\n    row,\n    col,\n    top,\n    left,\n    scrollTop,\n    scrollLeft,\n  });\n}\n\nfunction recalculateScroll(controller: IController) {\n  const activeCell = controller.getActiveCell();\n  const temp = {\n    row: activeCell.row,\n    col: activeCell.col,\n    colCount: 1,\n    rowCount: 1,\n    sheetId: '',\n  };\n  const position = controller.computeCellPosition(temp);\n  const cellSize = controller.getCellSize(temp);\n  const domRect = controller.getDomRect();\n  const oldScroll = controller.getScroll();\n  const sheetInfo = controller.getSheetInfo(controller.getCurrentSheetId())!;\n  const headerSize = controller.getHeaderSize();\n  const buff = 5;\n  const { maxHeight, maxWidth, maxScrollHeight, maxScrollWidth } =\n    computeScrollPosition(controller, oldScroll.left, oldScroll.top);\n  if (position.left + cellSize.width + buff > domRect.width) {\n    if (oldScroll.col <= sheetInfo.colCount - 2) {\n      const col = oldScroll.col + 1;\n      const left = oldScroll.left + controller.getColWidth(oldScroll.col).len;\n      const scrollLeft = Math.floor((left * maxScrollWidth) / maxWidth);\n      controller.setScroll({\n        ...oldScroll,\n        col,\n        left,\n        scrollLeft,\n      });\n    }\n  }\n\n  if (position.left - headerSize.width < domRect.left + buff) {\n    if (oldScroll.col >= 1) {\n      const col = oldScroll.col - 1;\n      const left = oldScroll.left - controller.getColWidth(oldScroll.col).len;\n      const scrollLeft = Math.floor((left * maxScrollWidth) / maxWidth);\n      controller.setScroll({\n        ...oldScroll,\n        col,\n        left,\n        scrollLeft,\n      });\n    }\n  }\n  if (position.top + cellSize.height + buff > domRect.height) {\n    if (oldScroll.row <= sheetInfo.rowCount - 2) {\n      const row = oldScroll.row + 1;\n      const top = oldScroll.top + controller.getRowHeight(oldScroll.row).len;\n      const scrollTop = Math.floor((top * maxScrollHeight) / maxHeight);\n      controller.setScroll({\n        ...oldScroll,\n        row,\n        top,\n        scrollTop,\n      });\n    }\n  }\n\n  if (position.top - headerSize.height < domRect.top + buff) {\n    if (oldScroll.row >= 1) {\n      const row = oldScroll.row - 1;\n      const top = oldScroll.top - controller.getRowHeight(oldScroll.row).len;\n      const scrollTop = Math.floor((top * maxScrollHeight) / maxHeight);\n      controller.setScroll({\n        ...oldScroll,\n        row,\n        top,\n        scrollTop,\n      });\n    }\n  }\n}\n\nexport function checkFocus(controller: IController) {\n  const inputDom = controller.getMainDom()?.input;\n  if (!inputDom) {\n    return false;\n  }\n  return document.activeElement === inputDom;\n}\n\nexport function setActiveCellValue(controller: IController) {\n  const inputDom = controller.getMainDom().input!;\n  controller.setCellValues(\n    [[inputDom.value]],\n    [],\n    [controller.getActiveRange().range],\n  );\n  inputDom.value = '';\n  inputDom.blur();\n  coreStore.mergeState({\n    editorStatus: EditorStatus.NONE,\n  });\n}\n\nfunction checkActiveElement(controller: IController) {\n  if (!checkFocus(controller)) {\n    return false;\n  }\n  setActiveCellValue(controller);\n  return true;\n}\n\nexport const keyboardEventList: KeyboardEventItem[] = [\n  {\n    key: 'Enter',\n    modifierKey: [],\n    handler: handleEnterClick,\n  },\n  {\n    key: 'Tab',\n    modifierKey: [],\n    handler: handleTabClick,\n  },\n  {\n    key: 'ArrowDown',\n    modifierKey: [isMac() ? 'meta' : 'ctrl'],\n    handler: (controller) => {\n      if (checkFocus(controller)) {\n        return;\n      }\n      checkActiveElement(controller);\n      const viewSize = controller.getViewSize();\n      scrollBar(controller, 0, viewSize.height);\n    },\n  },\n  {\n    key: 'ArrowUp',\n    modifierKey: [isMac() ? 'meta' : 'ctrl'],\n    handler: (controller) => {\n      if (checkFocus(controller)) {\n        return;\n      }\n      checkActiveElement(controller);\n      const viewSize = controller.getViewSize();\n      scrollBar(controller, 0, -viewSize.height);\n    },\n  },\n  {\n    key: 'ArrowRight',\n    modifierKey: [isMac() ? 'meta' : 'ctrl'],\n    handler: (controller) => {\n      if (checkFocus(controller)) {\n        return;\n      }\n      checkActiveElement(controller);\n      const viewSize = controller.getViewSize();\n      scrollBar(controller, viewSize.width, 0);\n    },\n  },\n  {\n    key: 'ArrowLeft',\n    modifierKey: [isMac() ? 'meta' : 'ctrl'],\n    handler: (controller) => {\n      if (checkFocus(controller)) {\n        return;\n      }\n      checkActiveElement(controller);\n      const viewSize = controller.getViewSize();\n      scrollBar(controller, -viewSize.width, 0);\n    },\n  },\n  {\n    key: 'ArrowDown',\n    modifierKey: [],\n    handler: (controller) => {\n      if (checkFocus(controller)) {\n        return;\n      }\n      handleEnterClick(controller);\n    },\n  },\n  {\n    key: 'ArrowUp',\n    modifierKey: [],\n    handler: (controller) => {\n      if (checkFocus(controller)) {\n        return;\n      }\n      checkActiveElement(controller);\n      controller.setNextActiveCell('up');\n      recalculateScroll(controller);\n    },\n  },\n  {\n    key: 'ArrowRight',\n    modifierKey: [],\n    handler: (controller) => {\n      if (checkFocus(controller)) {\n        return;\n      }\n      handleTabClick(controller);\n    },\n  },\n  {\n    key: 'ArrowLeft',\n    modifierKey: [],\n    handler: (controller) => {\n      if (checkFocus(controller)) {\n        return;\n      }\n      checkActiveElement(controller);\n      controller.setNextActiveCell('left');\n      recalculateScroll(controller);\n    },\n  },\n  {\n    key: 'b',\n    modifierKey: [isMac() ? 'meta' : 'ctrl'],\n    handler: (controller) => {\n      if (checkFocus(controller)) {\n        return;\n      }\n      const cellData = controller.getCell(controller.getActiveCell());\n      controller.updateCellStyle({ isBold: !cellData?.style?.isBold }, [\n        controller.getActiveCell(),\n      ]);\n    },\n  },\n  {\n    key: 'i',\n    modifierKey: [isMac() ? 'meta' : 'ctrl'],\n    handler: (controller) => {\n      if (checkFocus(controller)) {\n        return;\n      }\n\n      const cellData = controller.getCell(controller.getActiveCell());\n      controller.updateCellStyle({ isItalic: !cellData?.style?.isItalic }, [\n        controller.getActiveCell(),\n      ]);\n    },\n  },\n  {\n    key: '5',\n    modifierKey: [isMac() ? 'meta' : 'ctrl'],\n    handler: (controller) => {\n      if (checkFocus(controller)) {\n        return;\n      }\n      const cellData = controller.getCell(controller.getActiveCell());\n      controller.updateCellStyle({ isStrike: !cellData?.style?.isStrike }, [\n        controller.getActiveCell(),\n      ]);\n    },\n  },\n  {\n    key: 'u',\n    modifierKey: [isMac() ? 'meta' : 'ctrl'],\n    handler: (controller) => {\n      if (checkFocus(controller)) {\n        return;\n      }\n      const cellData = controller.getCell(controller.getActiveCell());\n      const underline = cellData?.style?.underline;\n      let newUnderline = EUnderLine.NONE;\n      if (underline === undefined || underline === EUnderLine.NONE) {\n        newUnderline = EUnderLine.SINGLE;\n      } else {\n        newUnderline = EUnderLine.NONE;\n      }\n      controller.updateCellStyle({ underline: newUnderline }, [\n        controller.getActiveCell(),\n      ]);\n    },\n  },\n  {\n    key: 'z',\n    modifierKey: [isMac() ? 'meta' : 'ctrl'],\n    handler: (controller) => {\n      controller.undo();\n    },\n  },\n  {\n    key: 'y',\n    modifierKey: [isMac() ? 'meta' : 'ctrl'],\n    handler: (controller) => {\n      controller.redo();\n    },\n  },\n];\n", "import {\n  IController,\n  KeyboardEventItem,\n  ChangeEventType,\n  EditorStatus,\n} from '@/types';\nimport { throttle } from '@/util';\nimport { keyboardEventList, scrollBar } from './shortcut';\nimport { coreStore } from '@/containers/store';\n\nfunction isInputEvent(event: any): boolean {\n  const name = (event?.target?.tagName || '').toLowerCase();\n  return name === 'input' || name === 'textarea';\n}\n\nexport function registerGlobalEvent(\n  controller: IController,\n  resizeWindow: (changeSet: Set<ChangeEventType>) => void,\n) {\n  function handleKeydown(event: KeyboardEvent) {\n    if (isInputEvent(event)) {\n      return;\n    }\n    const list = keyboardEventList.filter((v) => v.key === event.key);\n    list.sort((a, b) => b.modifierKey.length - a.modifierKey.length);\n    let temp: KeyboardEventItem | null = null;\n    for (const item of list) {\n      if (item.modifierKey.length > 0) {\n        if (item.modifierKey.some((v) => event[`${v}Key`])) {\n          temp = item;\n          break;\n        }\n      } else {\n        temp = item;\n        break;\n      }\n    }\n    if (temp) {\n      event.preventDefault();\n      temp.handler(controller);\n      return;\n    }\n    if (event.metaKey || event.ctrlKey) {\n      return;\n    }\n    coreStore.mergeState({\n      editorStatus: EditorStatus.EDIT_CELL,\n    });\n    controller.getMainDom().input?.focus();\n  }\n\n  const handleWheel = throttle((event: WheelEvent) => {\n    if (event.target !== controller.getMainDom().canvas!) {\n      return;\n    }\n    scrollBar(controller, event.deltaX, event.deltaY);\n  }, 1000 / 60);\n\n  function handlePaste(event: ClipboardEvent) {\n    if (isInputEvent(event)) {\n      return;\n    }\n    event.preventDefault();\n    controller.paste(event);\n  }\n\n  function handleCopy(event: ClipboardEvent) {\n    if (isInputEvent(event)) {\n      return;\n    }\n\n    event.preventDefault();\n    controller.copy(event);\n  }\n\n  function handleCut(event: ClipboardEvent) {\n    if (isInputEvent(event)) {\n      return;\n    }\n    event.preventDefault();\n    controller.cut(event);\n  }\n\n  function handleResize() {\n    resizeWindow(new Set<ChangeEventType>(['row']));\n  }\n\n  window.addEventListener('resize', handleResize);\n  document.body.addEventListener('keydown', handleKeydown);\n  document.body.addEventListener('wheel', handleWheel);\n  document.body.addEventListener('paste', handlePaste);\n  document.body.addEventListener('copy', handleCopy);\n  document.body.addEventListener('cut', handleCut);\n\n  return () => {\n    window.removeEventListener('resize', handleResize);\n    document.body.removeEventListener('keydown', handleKeydown);\n    document.body.removeEventListener('wheel', handleWheel);\n    document.body.removeEventListener('paste', handlePaste);\n    document.body.removeEventListener('copy', handleCopy);\n    document.body.removeEventListener('cut', handleCut);\n  };\n}\n", "import { npx, dpr, canvasLog, CELL_HEIGHT, CELL_WIDTH } from '@/util';\nimport { resizeCanvas, renderCellData } from './util';\nimport { ContentView, IController, EventType } from '@/types';\n\nexport class Content implements ContentView {\n  private ctx: CanvasRenderingContext2D;\n  private controller: IController;\n  constructor(controller: IController, canvas: HTMLCanvasElement) {\n    this.controller = controller;\n    const ctx = canvas.getContext('2d')!;\n    this.ctx = ctx;\n    const size = dpr();\n    this.ctx.scale(size, size);\n  }\n  getCanvas() {\n    return this.ctx.canvas;\n  }\n  resize() {\n    const { width, height } = this.controller.getDomRect();\n    resizeCanvas(this.ctx.canvas, width, height);\n  }\n  render({ changeSet }: EventType) {\n    if (changeSet.size === 0) {\n      return;\n    }\n\n    const check =\n      changeSet.has('row') ||\n      changeSet.has('col') ||\n      changeSet.has('sheetList') ||\n      changeSet.has('sheetId') ||\n      changeSet.has('cellStyle') ||\n      changeSet.has('cellValue') ||\n      changeSet.has('scroll');\n\n    if (!check) {\n      return;\n    }\n    canvasLog('render canvas content');\n    this.clear();\n    this.renderContent();\n  }\n  private clear() {\n    const { width, height } = this.controller.getDomRect();\n    this.ctx.clearRect(0, 0, npx(width), npx(height));\n  }\n\n  private renderContent(): void {\n    const { controller, ctx } = this;\n    const { width, height } = controller.getDomRect();\n    const headerSize = controller.getHeaderSize();\n    const { row, col } = controller.getScroll();\n\n    let x = headerSize.width;\n    let c = col;\n    let y = headerSize.height;\n    let r = row;\n\n    while (x + controller.getColWidth(c).len < width) {\n      x += controller.getColWidth(c).len;\n      c++;\n    }\n\n    while (y + controller.getRowHeight(r).len < height) {\n      y += controller.getRowHeight(r).len;\n      r++;\n    }\n    const endRow = r;\n    const endCol = c;\n    ctx.save();\n\n    const rowMap = new Map<number, number>();\n    const colMap = new Map<number, number>();\n\n    for (let rowIndex = row; rowIndex < endRow; rowIndex++) {\n      for (let colIndex = col; colIndex < endCol; colIndex++) {\n        const size = renderCellData(controller, ctx, rowIndex, colIndex);\n        rowMap.set(\n          rowIndex,\n          Math.max(rowMap.get(rowIndex) || 0, CELL_HEIGHT, size.height),\n        );\n        colMap.set(\n          colIndex,\n          Math.max(colMap.get(colIndex) || 0, CELL_WIDTH, size.width),\n        );\n      }\n    }\n    for (const [r, h] of rowMap.entries()) {\n      if (h <= 0) {\n        continue;\n      }\n      controller.setRowHeight(r, h, false);\n    }\n    for (const [c, w] of colMap.entries()) {\n      if (w <= 0) {\n        continue;\n      }\n      controller.setColWidth(c, w, false);\n    }\n\n    ctx.restore();\n  }\n}\n", "import React, { Fragment, memo, useMemo, useSyncExternalStore } from 'react';\nimport { Button, info, toast } from '../components';\nimport { IController } from '@/types';\nimport styles from './index.module.css';\nimport { useClickOutside } from '../hooks';\nimport { activeCellStore } from '@/containers/store';\nimport { $ } from '@/i18n';\n\ninterface Props {\n  controller: IController;\n  top: number;\n  left: number;\n  hideContextMenu: () => void;\n}\n\nenum ClickPosition {\n  COLUMN_HEADER,\n  ROW_HEADER,\n  TRIANGLE,\n  CONTENT,\n}\n\nconst MENU_WIDTH = 110;\nconst ITEM_HEIGHT = 20;\n\nfunction computeMenuStyle(controller: IController, top: number, left: number) {\n  const headerSize = controller.getHeaderSize();\n  const rect = controller.getMainDom().canvas!.getBoundingClientRect();\n  let clickPosition = ClickPosition.CONTENT;\n  let menuHeight = ITEM_HEIGHT * 3;\n  const y = top - rect.top;\n  const x = left - rect.left;\n  if (y < headerSize.height && x < headerSize.width) {\n    clickPosition = ClickPosition.TRIANGLE;\n  } else if (y < headerSize.height) {\n    clickPosition = ClickPosition.COLUMN_HEADER;\n    menuHeight = ITEM_HEIGHT * 6;\n  } else if (x < headerSize.width) {\n    clickPosition = ClickPosition.ROW_HEADER;\n    menuHeight = ITEM_HEIGHT * 6;\n  }\n\n  // recompute menu position\n  let realTop = top;\n  let realLeft = left;\n  const gap = 18;\n  const height = rect.height + rect.top;\n  if (realTop + menuHeight > height) {\n    realTop = height - menuHeight - gap;\n  }\n  if (realLeft + MENU_WIDTH > rect.width) {\n    realLeft = rect.width - MENU_WIDTH - gap;\n  }\n\n  return {\n    style: {\n      top: realTop,\n      left: realLeft,\n    },\n    position: clickPosition,\n  };\n}\n\nexport const ContextMenu: React.FunctionComponent<Props> = memo((props) => {\n  const {\n    controller,\n    top,\n    left,\n\n    hideContextMenu,\n  } = props;\n  const { row, col, colCount, rowCount } = useSyncExternalStore(\n    activeCellStore.subscribe,\n    activeCellStore.getSnapshot,\n  );\n  const [ref] = useClickOutside(hideContextMenu);\n  const { style, position } = useMemo(() => {\n    const temp = computeMenuStyle(controller, top, left);\n    return temp;\n  }, [top, left]);\n  const handleDialog = (isRow: boolean) => {\n    let value = isRow\n      ? controller.getRowHeight(row).len\n      : controller.getColWidth(col).len;\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n      value = parseInt(event.currentTarget.value, 10);\n      event.stopPropagation();\n    };\n    info({\n      visible: true,\n      title: isRow ? $('row-height') : $('column-width'),\n      children: (\n        <input\n          type=\"number\"\n          min=\"0\"\n          max=\"10000\"\n          style={{ width: '200px' }}\n          defaultValue={value}\n          onChange={handleChange}\n        />\n      ),\n      onOk: () => {\n        if (value < 0) {\n          toast({ type: 'error', message: $('greater-than-zero') });\n          return;\n        }\n        if (isRow) {\n          for (let i = 0; i < rowCount; i++) {\n            controller.setRowHeight(row + i, value, true);\n          }\n        } else {\n          for (let i = 0; i < colCount; i++) {\n            controller.setColWidth(col + i, value, true);\n          }\n        }\n        hideContextMenu();\n      },\n      onCancel: () => {\n        hideContextMenu();\n      },\n    });\n  };\n  return (\n    <div\n      className={styles['context-menu']}\n      data-testid=\"context-menu\"\n      style={style}\n      ref={ref}\n    >\n      <Button\n        onClick={() => {\n          hideContextMenu();\n          controller.setFloatElementUuid('');\n          controller.copy();\n        }}\n      >\n        {$('copy')}\n      </Button>\n      <Button\n        onClick={() => {\n          hideContextMenu();\n          controller.setFloatElementUuid('');\n          controller.cut();\n        }}\n      >\n        {$('cut')}\n      </Button>\n      <Button\n        onClick={() => {\n          hideContextMenu();\n          controller.paste();\n        }}\n      >\n        {$('paste')}\n      </Button>\n      {position === ClickPosition.TRIANGLE && (\n        <Button\n          onClick={() => {\n            hideContextMenu();\n            controller.deleteAll(controller.getCurrentSheetId());\n          }}\n        >\n          {$('delete')}\n        </Button>\n      )}\n      {position === ClickPosition.COLUMN_HEADER && (\n        <Fragment>\n          <Button\n            onClick={() => {\n              hideContextMenu();\n              controller.addCol(col, colCount);\n            }}\n          >\n            {$('insert-columns')}\n          </Button>\n          <Button\n            onClick={() => {\n              hideContextMenu();\n\n              controller.deleteCol(col, colCount);\n            }}\n          >\n            {$('delete-columns')}\n          </Button>\n          <Button\n            onClick={() => {\n              hideContextMenu();\n\n              controller.hideCol(col, colCount);\n            }}\n          >\n            {$('hide-columns')}\n          </Button>\n          <Button\n            onClick={() => {\n              handleDialog(false);\n            }}\n          >\n            {$('column-width')}\n          </Button>\n        </Fragment>\n      )}\n      {position === ClickPosition.ROW_HEADER && (\n        <Fragment>\n          <Button\n            onClick={() => {\n              hideContextMenu();\n              controller.addRow(row, rowCount);\n            }}\n          >\n            {$('insert-rows')}\n          </Button>\n          <Button\n            onClick={() => {\n              hideContextMenu();\n\n              controller.deleteRow(row, rowCount);\n            }}\n          >\n            {$('delete-rows')}\n          </Button>\n          <Button\n            onClick={() => {\n              hideContextMenu();\n\n              controller.hideRow(row, rowCount);\n            }}\n          >\n            {$('hide-rows')}\n          </Button>\n          <Button\n            onClick={() => {\n              handleDialog(true);\n            }}\n          >\n            {$('row-height')}\n          </Button>\n        </Fragment>\n      )}\n    </div>\n  );\n});\nContextMenu.displayName = 'ContextMenuContainer';\n", "import { IController, ChangeEventType, EUnderLine, IRange } from '@/types';\nimport {\n  DEFAULT_FONT_SIZE,\n  copyOrCut,\n  paste,\n  Range,\n  parseNumber,\n  HIDE_CELL,\n  getThemeColor,\n} from '@/util';\nimport {\n  coreStore,\n  activeCellStore,\n  sheetListStore,\n  fontFamilyStore,\n  scrollStore,\n  floatElementStore,\n  FloatElementItem,\n} from '@/containers/store';\nimport { MainCanvas, registerGlobalEvent, Content } from '@/canvas';\n\nfunction createCanvas() {\n  const canvas = document.createElement('canvas');\n  canvas.style.display = 'none';\n  document.body.appendChild(canvas);\n  return canvas;\n}\n\nfunction getChartData(\n  range: IRange,\n  controller: IController,\n): Pick<FloatElementItem, 'labels' | 'datasets'> {\n  const { row, col, rowCount, colCount, sheetId } = range;\n  const result: Pick<FloatElementItem, 'labels' | 'datasets'> = {\n    labels: [],\n    datasets: [],\n  };\n  for (\n    let r = row, index = 1, endRow = row + rowCount;\n    r < endRow;\n    r++, index++\n  ) {\n    const rowHeight = controller.getRowHeight(r).len;\n    if (rowHeight === HIDE_CELL) {\n      continue;\n    }\n    const list = [];\n    for (let c = col, endCol = col + colCount; c < endCol; c++) {\n      const t = controller.getCell({\n        row: r,\n        col: c,\n        rowCount: 1,\n        colCount: 1,\n        sheetId,\n      });\n      if (!t || typeof t.value === 'undefined') {\n        continue;\n      }\n      list.push(parseNumber(t.value));\n    }\n    if (list.length > 0) {\n      result.datasets.push({ label: `Series${index}`, data: list });\n    }\n  }\n  if (result.datasets[0] && result.datasets[0].data.length > 0) {\n    result.labels = Array.from({ length: result.datasets[0].data.length })\n      .fill('')\n      .map((_value, i) => String(i + 1));\n  }\n  return result;\n}\n\nfunction updateActiveCell(controller: IController) {\n  const { top } = controller.getDomRect();\n  const { range: activeCell, isMerged } = controller.getActiveRange();\n  const sheetId = activeCell.sheetId || controller.getCurrentSheetId();\n  const cell = controller.getCell(activeCell);\n  const defineName = controller.getDefineName(\n    new Range(activeCell.row, activeCell.col, 1, 1, sheetId),\n  );\n  const cellSize = controller.getCellSize(activeCell);\n  const cellPosition = controller.computeCellPosition(activeCell);\n  cellPosition.top = top + cellPosition.top;\n  let fontFamily = cell?.style?.fontFamily || '';\n  if (!fontFamily) {\n    let defaultFontFamily = '';\n    const list = fontFamilyStore.getSnapshot();\n    for (const item of list) {\n      if (!item.disabled) {\n        defaultFontFamily = String(item.value);\n        break;\n      }\n    }\n    fontFamily = defaultFontFamily;\n  }\n  const {\n    isBold = false,\n    isItalic = false,\n    isStrike = false,\n    fontSize = DEFAULT_FONT_SIZE,\n    fontColor = getThemeColor('contentColor'),\n    fillColor = '',\n    isWrapText = false,\n    underline = EUnderLine.NONE,\n    numberFormat = 0,\n  } = cell?.style || {};\n\n  activeCellStore.setState({\n    top: cellPosition.top,\n    left: cellPosition.left,\n    width: cellSize.width,\n    height: cellSize.height,\n    row: activeCell.row,\n    col: activeCell.col,\n    rowCount: activeCell.rowCount,\n    colCount: activeCell.colCount,\n    sheetId,\n    value: cell?.value,\n    formula: cell?.formula,\n    isBold,\n    isItalic,\n    isStrike,\n    fontColor,\n    fontSize,\n    fontFamily,\n    fillColor,\n    isWrapText,\n    underline,\n    numberFormat,\n    defineName,\n    isMergeCell: isMerged,\n  });\n}\n\nconst handleStateChange = (\n  changeSet: Set<ChangeEventType>,\n  controller: IController,\n) => {\n  if (\n    changeSet.has('range') ||\n    changeSet.has('cellStyle') ||\n    changeSet.has('cellValue')\n  ) {\n    updateActiveCell(controller);\n  }\n  if (changeSet.has('sheetList')) {\n    const sheetList = controller.getSheetList().map((v) => ({\n      sheetId: v.sheetId,\n      name: v.name,\n      isHide: v.isHide,\n      tabColor: v.tabColor,\n    }));\n    sheetListStore.setState(sheetList);\n  }\n\n  if (changeSet.has('sheetId')) {\n    coreStore.mergeState({\n      canRedo: controller.canRedo(),\n      canUndo: controller.canUndo(),\n      activeUuid: '',\n    });\n  } else {\n    coreStore.mergeState({\n      canRedo: controller.canRedo(),\n      canUndo: controller.canUndo(),\n    });\n  }\n\n  if (changeSet.has('scroll')) {\n    const scroll = controller.getScroll();\n    scrollStore.setState({\n      scrollLeft: scroll.scrollLeft,\n      scrollTop: scroll.scrollTop,\n    });\n  }\n\n  if (\n    changeSet.has('floatElement') ||\n    changeSet.has('cellValue') ||\n    changeSet.has('row') ||\n    changeSet.has('col') ||\n    changeSet.has('sheetId') ||\n    changeSet.has('scroll')\n  ) {\n    const scroll = controller.getScroll();\n    const canvasSize = controller.getDomRect();\n    const minX = scroll.left;\n    const minY = scroll.top;\n    const maxX = canvasSize.width + minX;\n    const maxY = canvasSize.height + minY;\n    const list = controller.getFloatElementList(controller.getCurrentSheetId());\n    const result: FloatElementItem[] = [];\n    for (const v of list) {\n      const p = controller.computeCellPosition({\n        row: v.fromRow,\n        col: v.fromCol,\n        colCount: 1,\n        rowCount: 1,\n        sheetId: '',\n      });\n      const top = p.top + v.marginY;\n      const left = p.left + v.marginX;\n      // the start point in the box or the end point in the box\n      const check =\n        (top > minY && top < maxY) ||\n        (left > minX && left < maxX) ||\n        (top + v.height > minY && top + v.height < maxY) ||\n        (left + v.width > minX && left + v.width < maxX);\n      if (check) {\n        const t: FloatElementItem = {\n          ...v,\n          top,\n          left,\n          labels: [],\n          datasets: [],\n        };\n        if (v.type === 'chart') {\n          const c = getChartData(v.chartRange!, controller);\n          t.labels = c.labels;\n          t.datasets = c.datasets;\n        }\n        result.push(t);\n      }\n    }\n    floatElementStore.setState(result);\n  }\n};\nexport function initCanvas(controller: IController): () => void {\n  const mainCanvas = new MainCanvas(\n    controller,\n    new Content(controller, createCanvas()),\n  );\n  const render = (changeSet: Set<ChangeEventType>) => {\n    mainCanvas.render({ changeSet });\n    mainCanvas.render({\n      changeSet: controller.getChangeSet(),\n    });\n  };\n  const resize = (changeSet: Set<ChangeEventType>) => {\n    mainCanvas.resize();\n    render(changeSet);\n  };\n\n  const removeEvent = registerGlobalEvent(controller, resize);\n  controller.setHooks({\n    copyOrCut,\n    paste,\n    modelChange: (changeSet: Set<ChangeEventType>) => {\n      handleStateChange(changeSet, controller);\n      render(changeSet);\n    },\n  });\n\n  const changeSet = new Set<ChangeEventType>([\n    'sheetId',\n    'scroll',\n    'range',\n    'sheetList',\n    'floatElement',\n    'cellValue',\n    'row',\n    'col',\n    'cellStyle',\n    'defineName',\n    'mergeCell',\n    'undoRedo',\n    'antLine',\n  ]);\n  handleStateChange(changeSet, controller);\n  resize(changeSet);\n  setTimeout(() => {\n    resize(changeSet);\n  }, 10);\n\n  return () => {\n    removeEvent();\n  };\n}\n", "import React, { useState, useSyncExternalStore } from 'react';\nimport { Button } from '../components';\nimport { IController } from '@/types';\nimport styles from './index.module.css';\nimport { scrollStore } from '../store';\nimport { scrollBar } from '@/canvas';\nimport { $ } from '@/i18n';\n\ninterface Props {\n  controller: IController;\n}\n\nexport const BottomBar: React.FunctionComponent<Props> = ({ controller }) => {\n  const { scrollTop } = useSyncExternalStore(\n    scrollStore.subscribe,\n    scrollStore.getSnapshot,\n  );\n  const headerSize = controller.getHeaderSize();\n  const rect = controller.getDomRect();\n  const [value, setValue] = useState(10);\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const val = event.currentTarget.value;\n    setValue(parseInt(val, 10));\n    event.stopPropagation();\n  };\n  const handleClick = () => {\n    const sheetInfo = controller.getSheetInfo(controller.getCurrentSheetId())!;\n    controller.addRow(sheetInfo.rowCount - 1, value);\n    const viewSize = controller.getViewSize();\n    scrollBar(controller, 0, viewSize.height);\n  };\n  return (\n    <div\n      className={styles['bottom-bar']}\n      data-testid=\"canvas-bottom-bar\"\n      style={{\n        left: headerSize.width,\n        display: scrollTop / rect.height >= 0.856 ? 'flex' : 'none',\n      }}\n    >\n      <div className={styles['bottom-bar-text']}>{$('add-at-the-bottom')}</div>\n      <input\n        value={value}\n        onChange={handleChange}\n        type=\"number\"\n        min={1}\n        max={200}\n      />\n      <div className={styles['bottom-bar-text']}>{$('rows')}</div>\n      <Button className={styles['add-button']} onClick={handleClick}>\n        {$('add')}\n      </Button>\n    </div>\n  );\n};\n", "import React, {\n  useSyncExternalStore,\n  Fragment,\n  memo,\n  useState,\n  useEffect,\n  useRef,\n} from 'react';\nimport { IController, IWindowSize } from '@/types';\nimport { floatElementStore, coreStore } from '@/containers/store';\nimport { FloatElement } from './FloatElement';\nimport styles from './FloatElement.module.css';\nimport { getHitInfo, classnames } from '@/util';\nimport {\n  State,\n  ResizePosition,\n  FloatElementPosition,\n  INITIAL_STATE,\n  roundPosition,\n} from './util';\n\ninterface Props {\n  controller: IController;\n}\nexport const FloatElementContainer: React.FunctionComponent<Props> = memo(\n  ({ controller }) => {\n    const floatElementList = useSyncExternalStore(\n      floatElementStore.subscribe,\n      floatElementStore.getSnapshot,\n    );\n    const { activeUuid } = useSyncExternalStore(\n      coreStore.subscribe,\n      coreStore.getSnapshot,\n    );\n    const state = useRef<State>({ ...INITIAL_STATE });\n    const [position, setPosition] = useState<FloatElementPosition>({\n      ...INITIAL_STATE.position,\n    });\n\n    const handleResizePointerDown = (\n      event: React.PointerEvent<HTMLDivElement>,\n    ) => {\n      event.stopPropagation();\n      event.preventDefault();\n      if (event.buttons !== 1) {\n        return;\n      }\n\n      const p = event.currentTarget.dataset.position || '';\n      if (!p) {\n        return;\n      }\n      state.current.resizePosition = p;\n      state.current.moveStartX = event.clientX;\n      state.current.moveStartY = event.clientY;\n    };\n\n    const updateSize = (e: PointerEvent) => {\n      const deltaX = Math.round(e.clientX - state.current.moveStartX);\n      const deltaY = Math.round(e.clientY - state.current.moveStartY);\n      setPosition((old) => {\n        const p = state.current.resizePosition as ResizePosition;\n        let { top, left, width, height } = old;\n        if (\n          [\n            ResizePosition.topRight,\n            ResizePosition.topLeft,\n            ResizePosition.top,\n          ].includes(p)\n        ) {\n          height -= deltaY;\n          top += deltaY;\n        } else if (\n          [\n            ResizePosition.bottomRight,\n            ResizePosition.bottom,\n            ResizePosition.bottomLeft,\n          ].includes(p)\n        ) {\n          height += deltaY;\n        }\n\n        if (\n          [\n            ResizePosition.topLeft,\n            ResizePosition.bottomLeft,\n            ResizePosition.left,\n          ].includes(p)\n        ) {\n          width -= deltaX;\n          left += deltaX;\n        } else if (\n          [\n            ResizePosition.topRight,\n            ResizePosition.bottomRight,\n            ResizePosition.right,\n          ].includes(p)\n        ) {\n          width += deltaX;\n        }\n\n        const newData = {\n          ...roundPosition(top, left, controller),\n          imageAngle: old.imageAngle,\n          width,\n          height,\n        };\n        state.current.position = newData;\n        return newData;\n      });\n    };\n    const updateRotate = (event: PointerEvent) => {\n      const deltaX = event.clientX - state.current.moveStartX;\n      const deltaY = event.clientY - state.current.moveStartY;\n      const imageAngle = (Math.atan2(deltaY, deltaX) * 180) / Math.PI;\n      setPosition((old) => {\n        const newData = {\n          ...old,\n          imageAngle,\n        };\n        state.current.position = newData;\n        return newData;\n      });\n    };\n\n    useEffect(() => {\n      const handlePointerUp = (event: PointerEvent) => {\n        event.stopPropagation();\n        event.preventDefault();\n        if (!activeUuid) {\n          state.current = { ...INITIAL_STATE };\n          return;\n        }\n        if (state.current.resizePosition) {\n          if (state.current.resizePosition === ResizePosition.rotate) {\n            controller.updateFloatElement(activeUuid, {\n              imageAngle: state.current.position.imageAngle,\n            });\n          } else if (\n            state.current.position.height > 0 &&\n            state.current.position.width > 0\n          ) {\n            controller.updateFloatElement(activeUuid, {\n              height: state.current.position.height,\n              width: state.current.position.width,\n            });\n          }\n        }\n        const rect = controller.getDomRect();\n        const { left, top } = state.current.position;\n        if (left >= 0 && top >= 0 && left < rect.width && top < rect.height) {\n          const newRange = getHitInfo(controller, left, top);\n          if (newRange) {\n            controller.updateFloatElement(activeUuid, {\n              fromCol: newRange.col,\n              fromRow: newRange.row,\n              marginX: newRange.marginX,\n              marginY: newRange.marginY,\n            });\n          }\n        }\n        state.current = { ...INITIAL_STATE };\n      };\n      const handlePointerMove = (event: PointerEvent) => {\n        if (!activeUuid) {\n          return;\n        }\n        if (event.buttons !== 1) {\n          return;\n        }\n\n        event.stopPropagation();\n        event.preventDefault();\n        if (state.current.resizePosition) {\n          if (state.current.resizePosition === ResizePosition.rotate) {\n            updateRotate(event);\n          } else {\n            updateSize(event);\n            state.current.moveStartX = event.clientX;\n            state.current.moveStartY = event.clientY;\n          }\n\n          return;\n        }\n        const deltaX = Math.round(event.clientX - state.current.moveStartX);\n        const deltaY = Math.round(event.clientY - state.current.moveStartY);\n        setPosition((old) => {\n          const newTop = old.top + deltaY;\n          const newLeft = old.left + deltaX;\n\n          const newData = {\n            ...roundPosition(newTop, newLeft, controller),\n            imageAngle: old.imageAngle,\n            width: old.width,\n            height: old.height,\n          };\n          state.current.position = newData;\n          return newData;\n        });\n        state.current.moveStartX = event.clientX;\n        state.current.moveStartY = event.clientY;\n      };\n      document.addEventListener('pointerup', handlePointerUp);\n      document.addEventListener('pointermove', handlePointerMove);\n      return () => {\n        document.removeEventListener('pointerup', handlePointerUp);\n        document.removeEventListener('pointermove', handlePointerMove);\n      };\n    }, [activeUuid]);\n    return (\n      <Fragment>\n        <div\n          className={classnames(styles['float-element-mask'], {\n            [styles['active']]: !!activeUuid,\n          })}\n          onPointerDown={() => {\n            state.current = { ...INITIAL_STATE };\n            coreStore.mergeState({ activeUuid: '' });\n            controller.setFloatElementUuid('');\n          }}\n        />\n        {floatElementList.map((v) => {\n          const isActive = v.uuid === activeUuid;\n          const props = {\n            ...v,\n            ...(isActive ? position : {}),\n          };\n          return (\n            <FloatElement\n              key={v.uuid}\n              {...props}\n              active={isActive}\n              controller={controller}\n              resetResize={(size: IWindowSize) =>\n                setPosition((old) => ({ ...old, ...size }))\n              }\n              pointerDown={(event) => {\n                event.stopPropagation();\n                event.preventDefault();\n                if (event.buttons !== 1) {\n                  return;\n                }\n                state.current.moveStartX = event.clientX;\n                state.current.moveStartY = event.clientY;\n                state.current.position = { ...INITIAL_STATE.position };\n                controller.setFloatElementUuid(v.uuid);\n                coreStore.mergeState({ activeUuid: v.uuid });\n                setPosition({\n                  top: v.top,\n                  left: v.left,\n                  width: v.width,\n                  height: v.height,\n                  imageAngle: v.imageAngle || 0,\n                });\n              }}\n              resizeDown={handleResizePointerDown}\n            />\n          );\n        })}\n      </Fragment>\n    );\n  },\n);\n\nexport { InsertFloatingPicture, InsertChart } from './Toolbar';\n", "import React, { useState, memo, lazy, Suspense } from 'react';\nimport styles from './FloatElement.module.css';\nimport { FloatElementItem } from '@/containers/store';\nimport { FloatElementContextMenu } from './ContextMenu';\nimport { DEFAULT_POSITION, classnames } from '@/util';\nimport { ResizePosition } from './util';\nimport { Icon } from '../components';\nimport { IController, IWindowSize } from '@/types';\nimport { Loading } from '../components';\n\ntype FloatElementProps = FloatElementItem & {\n  controller: IController;\n  active: boolean;\n  resetResize: (size: IWindowSize) => void;\n  pointerDown: (event: React.PointerEvent<HTMLDivElement>) => void;\n  resizeDown: (event: React.PointerEvent<HTMLDivElement>) => void;\n};\n\nconst Chart = lazy(() => import('./Chart'));\n\nexport const FloatElement: React.FunctionComponent<FloatElementProps> = memo(\n  (props) => {\n    const {\n      top,\n      left,\n      active,\n      width,\n      height,\n      type,\n      imageAngle = 0,\n      resetResize,\n      pointerDown,\n      resizeDown,\n    } = props;\n    const [contextMenuPosition, setContextMenuPosition] = useState({\n      top: DEFAULT_POSITION,\n      left: DEFAULT_POSITION,\n    });\n\n    const handleContextMenu = (event: React.MouseEvent<HTMLDivElement>) => {\n      event.preventDefault();\n      event.stopPropagation();\n      setContextMenuPosition({ top: event.clientY, left: event.clientX });\n      return false;\n    };\n    const hideContextMenu = () => {\n      setContextMenuPosition({\n        top: DEFAULT_POSITION,\n        left: DEFAULT_POSITION,\n      });\n    };\n\n    let children = null;\n    if (type === 'floating-picture') {\n      children = (\n        <img\n          title={props.title}\n          alt={props.title}\n          src={props.imageSrc!}\n          className={styles['image']}\n        />\n      );\n    } else if (type === 'chart') {\n      children = (\n        <Suspense fallback={<Loading/>}>\n          <Chart {...props} />;\n        </Suspense>\n      );\n    }\n    if (!children) {\n      return null;\n    }\n    return (\n      <React.Fragment>\n        <div\n          onPointerDown={pointerDown}\n          onContextMenu={handleContextMenu}\n          className={classnames(styles['float-element'], {\n            [styles['active']]: active,\n          })}\n          style={{\n            transform: `translateX(${left}px) translateY(${top}px) ${\n              type === 'floating-picture' ? `rotate(${imageAngle}deg)` : ''\n            } `,\n            width,\n            height,\n          }}\n        >\n          {children}\n          {active && (\n            <React.Fragment>\n              <div\n                className={classnames(styles['resize-handler'], styles['top'])}\n                data-position={ResizePosition.top}\n                onPointerDown={resizeDown}\n              >\n                <div className={styles['scale-dot']}></div>\n              </div>\n              <div\n                className={classnames(\n                  styles['resize-handler'],\n                  styles['top-right'],\n                )}\n                data-position={ResizePosition.topRight}\n                onPointerDown={resizeDown}\n              >\n                <div className={styles['scale-dot']}></div>\n              </div>\n              <div\n                className={classnames(\n                  styles['resize-handler'],\n                  styles['top-left'],\n                )}\n                data-position={ResizePosition.topLeft}\n                onPointerDown={resizeDown}\n              >\n                <div className={styles['scale-dot']}></div>\n              </div>\n              <div\n                className={classnames(styles['resize-handler'], styles['left'])}\n                data-position={ResizePosition.left}\n                onPointerDown={resizeDown}\n              >\n                <div className={styles['scale-dot']}></div>\n              </div>\n              <div\n                className={classnames(\n                  styles['resize-handler'],\n                  styles['right'],\n                )}\n                data-position={ResizePosition.right}\n                onPointerDown={resizeDown}\n              >\n                <div className={styles['scale-dot']}></div>\n              </div>\n              <div\n                className={classnames(\n                  styles['resize-handler'],\n                  styles['bottom-right'],\n                )}\n                data-position={ResizePosition.bottomRight}\n                onPointerDown={resizeDown}\n              >\n                <div className={styles['scale-dot']}></div>\n              </div>\n              <div\n                className={classnames(\n                  styles['resize-handler'],\n                  styles['bottom-left'],\n                )}\n                data-position={ResizePosition.bottomLeft}\n                onPointerDown={resizeDown}\n              >\n                <div className={styles['scale-dot']}></div>\n              </div>\n              <div\n                className={classnames(\n                  styles['resize-handler'],\n                  styles['bottom'],\n                )}\n                data-position={ResizePosition.bottom}\n                onPointerDown={resizeDown}\n              >\n                <div className={styles['scale-dot']}></div>\n              </div>\n              {type === 'floating-picture' && (\n                <div\n                  className={classnames(\n                    styles['resize-handler'],\n                    styles['rotate'],\n                  )}\n                  data-position={ResizePosition.rotate}\n                  onPointerDown={resizeDown}\n                >\n                  <div className={styles['rotate-icon']}>\n                    <Icon name=\"rotate\" />\n                  </div>\n                </div>\n              )}\n            </React.Fragment>\n          )}\n        </div>\n        {contextMenuPosition.top >= 0 && contextMenuPosition.left >= 0 && (\n          <FloatElementContextMenu\n            {...props}\n            resetResize={resetResize}\n            menuLeft={contextMenuPosition.left}\n            menuTop={contextMenuPosition.top}\n            hideContextMenu={hideContextMenu}\n          />\n        )}\n      </React.Fragment>\n    );\n  },\n);\n", ".float-element {\n  user-select: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n  border: 1px solid var(--borderColor);\n  background-color: var(--white);\n  z-index: var(--lowZIndex);\n}\n\n.float-element.active {\n  border-style: dashed;\n  border-style: dashed;\n  cursor: move;\n  z-index: var(--middleZIndex);\n}\n\n.float-element-mask {\n  display: none;\n  top: 0;\n  bottom: -30px;\n  left: 0;\n  right: 0;\n}\n.float-element-mask.active {\n  position: absolute;\n  display: block;\n}\n\n.context-menu {\n  position: fixed;\n  background-color: var(--white);\n  border-radius: var(--borderRadius);\n  width: 150px;\n  z-index: var(--middleZIndex);\n}\n\n.context-menu > button {\n  width: 100%;\n  background-color: var(--white);\n}\n\n.title {\n  text-align: center;\n  font-weight: bold;\n  width: 98%;\n  border: none;\n  padding: var(--tinyPadding);\n  z-index: var(--middleZIndex);\n}\n\n.image {\n  width: 100%;\n  height: 100%;\n  display: block;\n}\n.resize-handler {\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 32px;\n  height: 32px;\n  box-sizing: content-box;\n}\n.resize-handler-rect {\n  width: 100%;\n  height: 16px;\n}\n.scale-dot {\n  border-radius: 50%;\n  background-color: var(--white);\n  width: 10px;\n  height: 10px;\n  border: 1px solid var(--borderColor);\n  box-sizing: content-box;\n}\n.rotate-icon {\n  color: var(--white);\n  background-color: var(--borderColor);\n  border-radius: 50%;\n  width: 16px;\n  height: 16px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.top {\n  top: -16px;\n  left: 50%;\n  margin-left: -16px;\n  cursor: ns-resize;\n}\n.bottom {\n  bottom: -16px;\n  left: 50%;\n  margin-left: -16px;\n  cursor: ns-resize;\n}\n.top-right {\n  top: -16px;\n  right: -16px;\n  cursor: nesw-resize;\n}\n.top-left {\n  top: -16px;\n  left: -16px;\n  cursor: nwse-resize;\n}\n.bottom-right {\n  bottom: -16px;\n  right: -16px;\n  cursor: nwse-resize;\n}\n.bottom-left {\n  bottom: -16px;\n  left: -16px;\n  cursor: nesw-resize;\n}\n.right {\n  right: -16px;\n  top: 50%;\n  cursor: ew-resize;\n  margin-top: -10px;\n}\n.left {\n  left: -16px;\n  top: 50%;\n  margin-top: -16px;\n  cursor: ew-resize;\n}\n.rotate {\n  top: -48px;\n  left: 50%;\n  margin-left: -16px;\n  cursor: grabbing;\n}\n.rotate::after {\n  position: absolute;\n  content: '';\n  top: 14px;\n  height: 28px;\n  width: 1px;\n  background-color: var(--borderColor);\n}\n", "import React, { memo } from 'react';\nimport { Button, info, Select, toast } from '../components';\nimport { IController } from '@/types';\nimport styles from './FloatElement.module.css';\nimport { useClickOutside } from '../hooks';\nimport type { ChartType } from 'chart.js';\nimport {\n  saveAs,\n  convertToReference,\n  parseReference,\n  isSameRange,\n} from '@/util';\nimport { FloatElementItem } from '@/containers/store';\nimport { IWindowSize } from '@/types';\nimport { $ } from '@/i18n';\n\ntype Props = FloatElementItem & {\n  controller: IController;\n  menuLeft: number;\n  menuTop: number;\n  resetResize: (size: IWindowSize) => void;\n  hideContextMenu: () => void;\n};\n\nfunction extractTypeFromBase64(base64: string) {\n  const text = 'data:image/';\n  let i = text.length;\n  for (; i < base64.length; i++) {\n    if (base64[i] === ';') {\n      break;\n    }\n  }\n  return base64.slice(text.length, i);\n}\n\nconst chartList: Array<{ value: ChartType; label: string }> = [\n  {\n    value: 'line',\n    label: $('line-chart'),\n  },\n  {\n    value: 'bar',\n    label: $('bar-chart'),\n  },\n  {\n    value: 'pie',\n    label: $('pie-chart'),\n  },\n  {\n    value: 'scatter',\n    label: $('scatter-chart'),\n  },\n  {\n    value: 'radar',\n    label: $('radar-chart'),\n  },\n  {\n    value: 'polarArea',\n    label: $('polar-area-chart'),\n  },\n];\n\nexport const FloatElementContextMenu: React.FunctionComponent<Props> = memo(\n  (props) => {\n    const {\n      controller,\n      menuLeft,\n      menuTop,\n      uuid,\n      type,\n      chartType,\n      title,\n      resetResize,\n      hideContextMenu,\n      originHeight,\n      originWidth,\n      width,\n      height,\n    } = props;\n    const [ref] = useClickOutside(hideContextMenu);\n    const selectData = () => {\n      let value = convertToReference(\n        props.chartRange!,\n        'absolute',\n        (sheetId: string) => {\n          return controller.getSheetInfo(sheetId)?.name || '';\n        },\n      );\n      const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        value = event.currentTarget.value;\n        event.stopPropagation();\n      };\n      info({\n        visible: true,\n        title: $('edit-data-source'),\n        children: (\n          <input\n            type=\"text\"\n            spellCheck\n            style={{ width: '400px' }}\n            defaultValue={value}\n            onChange={handleChange}\n          />\n        ),\n        onOk: () => {\n          const realValue = value.trim();\n          if (!realValue) {\n            toast({ type: 'error', message: $('reference-is-empty') });\n            return;\n          }\n          const sheetList = controller.getSheetList();\n          const range = parseReference(realValue, (sheetName: string) => {\n            return sheetList.find((v) => v.name === sheetName)?.sheetId || '';\n          });\n          if (\n            !range ||\n            !range.isValid() ||\n            isSameRange(range, props.chartRange!)\n          ) {\n            toast({ type: 'error', message: $('reference-is-not-valid') });\n            return;\n          }\n          controller.updateFloatElement(uuid, { chartRange: range });\n          hideContextMenu();\n        },\n        onCancel: () => {\n          hideContextMenu();\n        },\n      });\n    };\n    const changeChartTitle = () => {\n      let value = title;\n      const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        value = event.currentTarget.value;\n        event.stopPropagation();\n      };\n      info({\n        visible: true,\n        title: $('change-chart-title'),\n        children: (\n          <input\n            type=\"text\"\n            spellCheck\n            style={{ width: '200px' }}\n            defaultValue={value}\n            onChange={handleChange}\n          />\n        ),\n        onOk: () => {\n          const realValue = value.trim();\n          if (!realValue) {\n            toast({ type: 'error', message: $('the-value-cannot-be-empty') });\n            return;\n          }\n          controller.updateFloatElement(uuid, { title: realValue });\n          hideContextMenu();\n        },\n        onCancel: () => {\n          hideContextMenu();\n        },\n      });\n    };\n    const changeChartType = () => {\n      let newChartType: ChartType = chartType!;\n      info({\n        title: $('change-chart-title'),\n        visible: true,\n        children: (\n          <Select\n            style={{ width: '100%' }}\n            defaultValue={newChartType}\n            data={chartList.map((v) => ({ ...v, disabled: false }))}\n            onChange={(v) => (newChartType = String(v) as ChartType)}\n          />\n        ),\n        onCancel() {\n          hideContextMenu();\n        },\n        onOk() {\n          controller.updateFloatElement(uuid, { chartType: newChartType });\n          hideContextMenu();\n        },\n      });\n    };\n    const saveAsPicture = () => {\n      hideContextMenu();\n      const list = controller.getFloatElementList(\n        controller.getCurrentSheetId(),\n      );\n      const item = list.find((v) => v.uuid === uuid);\n      if (!item) {\n        return;\n      }\n      if (type === 'floating-picture' && item.imageSrc) {\n        saveAs(\n          item.imageSrc,\n          item.title + '.' + extractTypeFromBase64(item.imageSrc),\n        );\n      }\n      if (type === 'chart') {\n        const dom = document.querySelector<HTMLCanvasElement>(\n          `canvas[data-uuid=\"${uuid}\"]`,\n        );\n        if (!dom) {\n          return;\n        }\n        saveAs(dom.toDataURL(), item.title + '.png');\n      }\n    };\n    return (\n      <div\n        className={styles['context-menu']}\n        data-testid=\"float-element-context-menu\"\n        ref={ref}\n        style={{ top: menuTop, left: menuLeft }}\n      >\n        <Button\n          onClick={() => {\n            hideContextMenu();\n            controller.setFloatElementUuid(uuid);\n            controller.copy();\n          }}\n        >\n          {$('copy')}\n        </Button>\n\n        <Button\n          onClick={() => {\n            hideContextMenu();\n            controller.setFloatElementUuid(uuid);\n            controller.cut();\n          }}\n        >\n          {$('cut')}\n        </Button>\n        <Button\n          onClick={() => {\n            hideContextMenu();\n            controller.paste();\n          }}\n        >\n          {$('paste')}\n        </Button>\n        <Button\n          onClick={() => {\n            hideContextMenu();\n            controller.setFloatElementUuid(uuid);\n            controller.copy();\n            controller.paste();\n            controller.setFloatElementUuid('');\n          }}\n        >\n          {$('duplicate')}\n        </Button>\n        {type === 'chart' ? (\n          <React.Fragment>\n            <Button onClick={selectData}>{$('select-data')}</Button>\n            <Button onClick={changeChartTitle}>\n              {$('change-chart-title')}\n            </Button>\n            <Button onClick={changeChartType}>{$('change-chart-type')}</Button>\n          </React.Fragment>\n        ) : null}\n        <Button onClick={saveAsPicture}>{$('save-as-picture')}</Button>\n        <Button\n          disabled={width === originWidth && height === originHeight}\n          onClick={() => {\n            hideContextMenu();\n            controller.updateFloatElement(uuid, {\n              height: originHeight,\n              width: originWidth,\n            });\n            resetResize({ width: originWidth, height: originHeight });\n          }}\n        >\n          {$('reset-size')}\n        </Button>\n        <Button\n          onClick={() => {\n            hideContextMenu();\n            controller.deleteFloatElement(uuid);\n          }}\n        >\n          {$('delete')}\n        </Button>\n      </div>\n    );\n  },\n);\nFloatElementContextMenu.displayName = 'FloatElementContextMenu';\n", "import { CanvasOverlayPosition, IController } from '@/types';\n\nexport enum ResizePosition {\n  top = 'top',\n  topRight = 'top-right',\n  topLeft = 'top-left',\n  bottom = 'bottom',\n  bottomLeft = 'bottom-left',\n  bottomRight = 'bottom-right',\n  left = 'left',\n  right = 'right',\n  rotate = 'rotate',\n}\nexport type FloatElementPosition = {\n  width: number;\n  top: number;\n  left: number;\n  height: number;\n  imageAngle: number;\n};\nexport type State = {\n  moveStartX: number;\n  moveStartY: number;\n  resizePosition: string;\n  position: FloatElementPosition;\n};\n\nexport function computeElementSize(\n  deltaX: number,\n  deltaY: number,\n  p: ResizePosition,\n): CanvasOverlayPosition {\n  let height = 0;\n  let width = 0;\n  let top = 0;\n  let left = 0;\n  if (\n    [\n      ResizePosition.topRight,\n      ResizePosition.topLeft,\n      ResizePosition.top,\n    ].includes(p)\n  ) {\n    height -= deltaY;\n    top += deltaY;\n  } else if (\n    [\n      ResizePosition.bottomRight,\n      ResizePosition.bottom,\n      ResizePosition.bottomLeft,\n    ].includes(p)\n  ) {\n    height += deltaY;\n  }\n\n  if (\n    [\n      ResizePosition.topLeft,\n      ResizePosition.bottomLeft,\n      ResizePosition.left,\n    ].includes(p)\n  ) {\n    width -= deltaX;\n    left += deltaX;\n  } else if (\n    [\n      ResizePosition.topRight,\n      ResizePosition.bottomRight,\n      ResizePosition.right,\n    ].includes(p)\n  ) {\n    width += deltaX;\n  }\n\n  return {\n    width,\n    height,\n    left,\n    top,\n  };\n}\n\nexport const INITIAL_STATE: State = {\n  resizePosition: '',\n  moveStartX: 0,\n  moveStartY: 0,\n  position: {\n    width: -1,\n    height: -1,\n    imageAngle: 0,\n    top: -1,\n    left: -1,\n  },\n};\n\nexport function roundPosition(\n  top: number,\n  left: number,\n  controller: IController,\n) {\n  const size = controller.getHeaderSize();\n  const canvasSize = controller.getDomRect();\n  const minTop = size.height;\n  const minLeft = size.width;\n  if (top < minTop) {\n    top = minTop;\n  }\n  if (top > canvasSize.height) {\n    top = canvasSize.height;\n  }\n  if (left < minLeft) {\n    left = minLeft;\n  }\n  if (left > canvasSize.width) {\n    left = canvasSize.width;\n  }\n  return {\n    top,\n    left,\n  };\n}\n", "import React, { useRef } from 'react';\nimport { IController } from '@/types';\nimport { Button } from '../components';\nimport { generateUUID } from '@/util';\nimport { $ } from '@/i18n';\n\ninterface Props {\n  controller: IController;\n}\nexport const InsertFloatingPicture: React.FunctionComponent<Props> = ({\n  controller,\n}) => {\n  const ref = useRef<HTMLInputElement>(null);\n  const readImage = (base64Image: string, fileName: string) => {\n    const image = new Image();\n    image.src = base64Image;\n    image.onload = function () {\n      const range = controller.getActiveCell();\n      controller.addFloatElement({\n        width: image.width,\n        height: image.height,\n        originHeight: image.height,\n        originWidth: image.width,\n        title: fileName,\n        type: 'floating-picture',\n        uuid: generateUUID(),\n        imageSrc: base64Image,\n        sheetId: range.sheetId,\n        fromRow: range.row,\n        fromCol: range.col,\n        marginX: 0,\n        marginY: 0,\n      });\n    };\n  };\n  const handleImport = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    event.stopPropagation();\n    const file = event.target.files?.[0];\n    if (!file) {\n      return;\n    }\n    let fileName = file.name;\n    const fileType = file.type.slice('image/'.length);\n    fileName = fileName.slice(0, -(fileType.length + 1));\n    const reader = new FileReader();\n    reader.onload = function (e) {\n      ref.current!.value = '';\n      ref.current!.blur();\n      const base64Image = e.target?.result;\n      if (!base64Image || typeof base64Image !== 'string') {\n        return;\n      }\n      readImage(base64Image, fileName);\n    };\n\n    reader.readAsDataURL(file);\n  };\n  return (\n    <Button>\n      <input\n        type=\"file\"\n        hidden\n        onChange={handleImport}\n        accept=\"image/*\"\n        ref={ref}\n        id=\"upload_float_image\"\n      />\n      <label htmlFor=\"upload_float_image\">{$('floating-picture')}</label>\n    </Button>\n  );\n};\n\nexport const InsertChart: React.FunctionComponent<Props> = ({ controller }) => {\n  const handleClick = () => {\n    const range = controller.getActiveCell();\n    controller.addFloatElement({\n      width: 400,\n      height: 300,\n      originHeight: 300,\n      originWidth: 400,\n      title: 'Chart Title',\n      type: 'chart',\n      uuid: generateUUID(),\n      sheetId: range.sheetId,\n      fromRow: range.row,\n      fromCol: range.col,\n      chartRange: range,\n      chartType: 'line',\n      marginX: 0,\n      marginY: 0,\n    });\n  };\n\n  return <Button onClick={handleClick}>{$('chart')}</Button>;\n};\n", "import React, { useSyncExternalStore, useMemo } from 'react';\nimport {\n  FormulaEditor,\n  getEditorStyle,\n  getDisplayStyle,\n} from './FormulaEditor';\nimport { classnames, intToColumnName } from '@/util';\nimport styles from './index.module.css';\nimport { IController, EditorStatus } from '@/types';\nimport { activeCellStore, coreStore } from '@/containers/store';\nimport { DefineName } from './DefineName';\n\ninterface Props {\n  controller: IController;\n}\n\nexport const FormulaBarContainer: React.FunctionComponent<Props> = ({\n  controller,\n}) => {\n  const activeCell = useSyncExternalStore(\n    activeCellStore.subscribe,\n    activeCellStore.getSnapshot,\n  );\n  const { editorStatus } = useSyncExternalStore(\n    coreStore.subscribe,\n    coreStore.getSnapshot,\n  );\n  const displayName = useMemo(() => {\n    return (\n      activeCell.defineName ||\n      `${intToColumnName(activeCell.col)}${activeCell.row + 1}`\n    );\n  }, [activeCell]);\n  const editorValue = activeCell.formula || String(activeCell.value || '');\n  const handleClick = () => {\n    coreStore.mergeState({\n      editorStatus: EditorStatus.EDIT_FORMULA_BAR,\n    });\n    controller.getMainDom().input?.focus();\n  };\n  return (\n    <div className={styles['formula-bar-wrapper']} data-testid=\"formula-bar\">\n      <DefineName controller={controller} displayName={displayName} />\n      <div className={styles['formula-bar-editor-wrapper']}>\n        {editorStatus !== EditorStatus.NONE ? (\n          <FormulaEditor\n            controller={controller}\n            initValue={editorValue}\n            style={getEditorStyle(activeCell, editorStatus)}\n            testId=\"formula-editor\"\n          />\n        ) : null}\n        <div\n          className={classnames(styles['formula-bar-value'], {\n            [styles['show']]: editorStatus !== EditorStatus.EDIT_FORMULA_BAR,\n          })}\n          style={getDisplayStyle(activeCell)}\n          onClick={handleClick}\n        >\n          {editorValue}\n        </div>\n      </div>\n    </div>\n  );\n};\nFormulaBarContainer.displayName = 'FormulaBarContainer';\n", "import React, { CSSProperties, useRef, useEffect } from 'react';\nimport { CanvasOverlayPosition, IController, EditorStatus } from '@/types';\nimport styles from './index.module.css';\nimport { CellStoreType } from '../store';\nimport { handleTabClick, handleEnterClick } from '../../canvas/shortcut';\n\ninterface Props {\n  controller: IController;\n  initValue: string;\n  style: CSSProperties | undefined;\n  testId?: string;\n}\nexport function getDisplayStyle(\n  style: CellStoreType,\n  isFormulaBar = true,\n): CSSProperties {\n  const result: CSSProperties = {};\n  if (style?.isItalic) {\n    result.fontStyle = 'italic';\n  }\n  if (style?.isBold) {\n    result.fontWeight = 'bold';\n  }\n  if (style?.fontFamily) {\n    result.fontFamily = style?.fontFamily;\n  }\n  if (style?.fontSize && !isFormulaBar) {\n    result.fontSize = style?.fontSize;\n  }\n  if (style?.fillColor && !isFormulaBar) {\n    result.backgroundColor = style.fillColor;\n  }\n  if (style?.fontColor && !isFormulaBar) {\n    result.color = style?.fontColor;\n  }\n  if (style?.underline && style?.isStrike) {\n    result.textDecorationLine = 'underline line-through';\n  } else if (style?.underline) {\n    result.textDecorationLine = 'underline';\n  } else if (style?.isStrike) {\n    result.textDecorationLine = 'line-through';\n  }\n  // if (style.underline === EUnderLine.DOUBLE) {\n  //   result.textDecorationStyle = 'double';\n  // }\n  return result;\n}\nexport function getEditorStyle(\n  style: CellStoreType,\n  editorStatus: EditorStatus,\n): CSSProperties | undefined {\n  if (editorStatus === EditorStatus.NONE) {\n    return undefined;\n  }\n  const isFormulaBar = editorStatus === EditorStatus.EDIT_FORMULA_BAR;\n\n  const editorStyle = getDisplayStyle(style, isFormulaBar);\n  if (isFormulaBar) {\n    return editorStyle;\n  }\n  const cellPosition: CanvasOverlayPosition = {\n    top: style.top,\n    left: style.left,\n    width: style.width,\n    height: style.height,\n  };\n  return {\n    ...editorStyle,\n    ...cellPosition,\n    border: '1px solid var(--primaryColor)',\n  };\n}\n\nexport const FormulaEditor: React.FunctionComponent<Props> = ({\n  controller,\n  initValue,\n  style,\n  testId,\n}) => {\n  const ref = useRef<HTMLInputElement>(null);\n  useEffect(() => {\n    if (!ref.current) {\n      return;\n    }\n    controller.setMainDom({ input: ref.current });\n  }, []);\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    event.stopPropagation();\n    if (event.key === 'Enter') {\n      handleEnterClick(controller);\n    } else if (event.key === 'Tab') {\n      handleTabClick(controller);\n    }\n  };\n  return (\n    <input\n      className={styles['base-editor']}\n      ref={ref}\n      spellCheck\n      defaultValue={initValue}\n      onKeyDown={handleKeyDown}\n      type=\"text\"\n      style={style}\n      data-testid={testId}\n    />\n  );\n};\n\nFormulaEditor.displayName = 'FormulaEditor';\n", ".formula-bar-wrapper {\n  width: 100%;\n  box-sizing: content-box;\n  padding: var(--mediumPadding) var(--largePadding);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: var(--largePadding);\n  border-bottom: 1px solid var(--borderColor);\n}\n\n.formula-bar-name {\n  border: 1px solid var(--borderColor);\n  width: 100px;\n  height: 100%;\n  margin-right: 10px;\n  border-radius: 2px;\n  text-align: center;\n  background-color: var(--white);\n  user-select: none;\n}\n.formula-bar-name-editor {\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  border: none;\n  text-align: center;\n  border-radius: unset;\n  outline: none;\n  font: inherit;\n  overflow: hidden;\n  box-sizing: border-box;\n}\n\n.formula-bar-editor-wrapper {\n  border: 1px solid var(--borderColor);\n  flex: 1;\n  height: 100%;\n  border-radius: 2px;\n  background-color: var(--white);\n}\n\n.formula-bar-value {\n  padding: 0 var(--tinyPadding);\n  margin: 0;\n  display: none;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n}\n\n.formula-bar-value.show {\n  display: flex;\n  align-items: center;\n}\n\n.base-editor {\n  width: 100%;\n  min-height: 18px;\n  padding: 0 var(--tinyPadding);\n  margin: 0;\n  border: none;\n  border-radius: unset;\n  outline: none;\n  font: inherit;\n  background-color: var(--white);\n  overflow: hidden;\n  position: fixed;\n  box-sizing: border-box;\n  z-index: var(--middleZIndex);\n}\n", "import React, { useEffect, useState, useRef } from 'react';\nimport { IController } from '@/types';\nimport styles from './index.module.css';\nimport { parseReference } from '@/util';\n\ninterface Props {\n  controller: IController;\n  displayName: string;\n}\n\nexport const DefineName: React.FunctionComponent<Props> = ({\n  controller,\n  displayName,\n}) => {\n  const ref = useRef<HTMLInputElement>(null);\n\n  const [value, setValue] = useState(displayName);\n  useEffect(() => {\n    setValue(displayName);\n  }, [displayName]);\n\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    event.stopPropagation();\n    if (event.key === 'Enter') {\n      const t = event.currentTarget.value.trim().toLowerCase();\n      if (!t) {\n        return;\n      }\n      ref.current?.blur();\n      const range = controller.checkDefineName(t);\n      if (range) {\n        setValue(displayName);\n        controller.setActiveCell(range);\n        return;\n      }\n      const r = parseReference(t);\n      const sheetInfo = controller.getSheetInfo(controller.getCurrentSheetId())!;\n      if (r && r.col < sheetInfo.colCount && r.row < sheetInfo.rowCount) {\n        setValue(displayName);\n        controller.setActiveCell(r);\n        return;\n      }\n      if (/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(t) && t.length <= 255) {\n        controller.setDefineName(controller.getActiveCell(), t);\n      } else {\n        setValue(displayName);\n      }\n    }\n  };\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setValue(event.currentTarget.value);\n  };\n  return (\n    <div className={styles['formula-bar-name']} data-testid=\"formula-bar-name\">\n      <input\n        value={value}\n        ref={ref}\n        spellCheck\n        type=\"text\"\n        onChange={handleChange}\n        className={styles['formula-bar-name-editor']}\n        onKeyDown={handleKeyDown}\n      />\n    </div>\n  );\n};\n", "import React, { useSyncExternalStore } from 'react';\nimport {\n  Icon,\n  Button,\n  Github,\n  Select,\n  FillColorIcon,\n  ColorPicker,\n} from '../components';\nimport {\n  FONT_SIZE_LIST,\n  QUERY_ALL_LOCAL_FONT,\n  LOCAL_FONT_KEY,\n  isSupportFontFamily,\n  isMobile,\n} from '@/util';\nimport { StyleType, EUnderLine, OptionItem, IController } from '@/types';\nimport styles from './index.module.css';\nimport {\n  activeCellStore,\n  fontFamilyStore,\n  coreStore,\n} from '@/containers/store';\nimport { InsertFloatingPicture, InsertChart } from '../FloatElement';\nimport { $ } from '@/i18n';\n\ninterface Props {\n  controller: IController;\n}\n\nconst underlineList: OptionItem[] = [\n  {\n    value: EUnderLine.NONE,\n    label: 'none',\n    disabled: false,\n  },\n  {\n    value: EUnderLine.SINGLE,\n    label: 'single underline',\n    disabled: false,\n  },\n  {\n    value: EUnderLine.DOUBLE,\n    label: 'double underline',\n    disabled: false,\n  },\n];\n\nexport const ToolbarContainer: React.FunctionComponent<Props> = ({\n  controller,\n}) => {\n  const { canRedo, canUndo } = useSyncExternalStore(\n    coreStore.subscribe,\n    coreStore.getSnapshot,\n  );\n  const activeCell = useSyncExternalStore(\n    activeCellStore.subscribe,\n    activeCellStore.getSnapshot,\n  );\n  const fontFamilyList = useSyncExternalStore(\n    fontFamilyStore.subscribe,\n    fontFamilyStore.getSnapshot,\n  );\n  const getItemStyle = (value: string | number): React.CSSProperties => {\n    return {\n      fontFamily: String(value),\n      fontSize: '16px',\n    };\n  };\n  const setCellStyle = (value: Partial<StyleType>) => {\n    controller.updateCellStyle(value, [controller.getActiveCell()]);\n  };\n  const {\n    isBold,\n    isItalic,\n    isStrike,\n    fontSize,\n    fontColor = '',\n    fillColor = '',\n    isWrapText,\n    underline,\n    fontFamily,\n  } = activeCell;\n  const handleFontFamilyChange = (value: string | number) => {\n    const t = String(value);\n    const queryLocalFonts = (window as any).queryLocalFonts;\n    if (t === QUERY_ALL_LOCAL_FONT && typeof queryLocalFonts === 'function') {\n      queryLocalFonts().then(\n        (\n          list: Array<{\n            fullName: string;\n            family: string;\n            postscriptName: string;\n            style: string;\n          }>,\n        ) => {\n          let fontList = list.map((v) => v.fullName);\n          fontList = Array.from(new Set(fontList)).filter((v) =>\n            isSupportFontFamily(v),\n          );\n          fontList.sort((a, b) => a.localeCompare(b));\n          localStorage.setItem(LOCAL_FONT_KEY, JSON.stringify(fontList));\n          const l = fontList.map((v) => ({\n            label: v,\n            value: v,\n            disabled: false,\n          }));\n          fontFamilyStore.setState(l);\n        },\n      );\n    } else {\n      setCellStyle({ fontFamily: String(value) });\n    }\n  };\n  return (\n    <div className={styles['toolbar-wrapper']} data-testid=\"toolbar\">\n      <Button\n        disabled={!canUndo}\n        onClick={() => controller.undo()}\n        testId=\"toolbar-undo\"\n        title=\"undo\"\n      >\n        <Icon name=\"undo\" />\n      </Button>\n      <Button\n        disabled={!canRedo}\n        onClick={() => controller.redo()}\n        testId=\"toolbar-redo\"\n        title=\"redo\"\n      >\n        <Icon name=\"redo\" />\n      </Button>\n      <Button onClick={() => controller.copy()} testId=\"toolbar-copy\">\n        {$('copy')}\n      </Button>\n      <Button onClick={() => controller.cut()} testId=\"toolbar-cut\">\n        {$('cut')}\n      </Button>\n      <Button onClick={() => controller.paste()} testId=\"toolbar-paste\">\n        {$('paste')}\n      </Button>\n\n      <Select\n        data={fontFamilyList}\n        value={fontFamily}\n        style={{\n          width: 140,\n        }}\n        getItemStyle={getItemStyle}\n        onChange={handleFontFamilyChange}\n      />\n      <Select\n        data={FONT_SIZE_LIST}\n        value={fontSize}\n        onChange={(value) => setCellStyle({ fontSize: Number(value) })}\n      />\n      <Button\n        active={isBold}\n        onClick={() => setCellStyle({ isBold: !isBold })}\n        testId=\"toolbar-bold\"\n        title=\"Bold\"\n      >\n        <span style={{ fontWeight: 'bold' }}>B</span>\n      </Button>\n      <Button\n        active={isItalic}\n        onClick={() => setCellStyle({ isItalic: !isItalic })}\n        testId=\"toolbar-italic\"\n        title=\"Italic\"\n      >\n        <span style={{ fontStyle: 'italic' }}>I</span>\n      </Button>\n      <Button\n        active={isStrike}\n        onClick={() => setCellStyle({ isStrike: !isStrike })}\n        testId=\"toolbar-strike\"\n        title=\"Strike\"\n      >\n        <span style={{ textDecorationLine: 'line-through' }}>A</span>\n      </Button>\n      <Select\n        data={underlineList}\n        value={underline}\n        style={{ width: 130 }}\n        title=\"Underline\"\n        onChange={(value) => setCellStyle({ underline: Number(value) })}\n      />\n      <ColorPicker\n        key=\"fill-color\"\n        color={fillColor}\n        onChange={(value) => setCellStyle({ fillColor: value })}\n      >\n        <Button style={{ color: fillColor }}>\n          <FillColorIcon />\n        </Button>\n      </ColorPicker>\n\n      <ColorPicker\n        key=\"font-color\"\n        color={fontColor}\n        onChange={(value) => setCellStyle({ fontColor: value })}\n      >\n        <Button style={{ color: fontColor }}>\n          <Icon name=\"fontColor\" />\n        </Button>\n      </ColorPicker>\n      <Button\n        active={isWrapText}\n        onClick={() => setCellStyle({ isWrapText: !isWrapText })}\n        testId=\"toolbar-wrap-text\"\n        style={{ minWidth: 80 }}\n      >\n        {$('wrap-text')}\n      </Button>\n      <InsertFloatingPicture controller={controller} />\n      {isMobile() ? null : <InsertChart controller={controller} />}\n      {/* <Button\n        active={isMergeCell}\n        onClick={() => {\n          const { range, isMerged } = controller.getActiveRange();\n          if (isMerged) {\n            controller.deleteMergeCell(range);\n          } else {\n            controller.addMergeCell(range);\n          }\n        }}\n        testId=\"toolbar-merge-cells\"\n        style={{ minWidth: 80 }}\n      >\n        Merge Cells\n      </Button> */}\n      <Github />\n    </div>\n  );\n};\n\nToolbarContainer.displayName = 'ToolbarContainer';\n", ".toolbar-wrapper {\n  padding: var(--mediumPadding) var(--largePadding) 0 var(--largePadding);\n  box-sizing: border-box;\n  border-bottom: 1px solid var(--borderColor);\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n}\n.toolbar-wrapper > * {\n  margin-right: 8px;\n  margin-bottom: var(--mediumPadding);\n}\n", "import React, {\n  FunctionComponent,\n  useSyncExternalStore,\n  useState,\n} from 'react';\nimport { classnames, DEFAULT_POSITION } from '@/util';\nimport { Button, Icon } from '../components';\nimport { SheetBarContextMenu } from './SheetBarContextMenu';\nimport styles from './index.module.css';\nimport { IController } from '@/types';\nimport { sheetListStore, activeCellStore } from '@/containers/store';\n\ninterface Props {\n  controller: IController;\n}\n\nexport const SheetBarContainer: FunctionComponent<Props> = ({ controller }) => {\n  const sheetList = useSyncExternalStore(\n    sheetListStore.subscribe,\n    sheetListStore.getSnapshot,\n  );\n  // filter hide sheet\n  const realSheetList = sheetList.filter((v) => !v.isHide);\n  const { sheetId: currentSheetId } = useSyncExternalStore(\n    activeCellStore.subscribe,\n    activeCellStore.getSnapshot,\n  );\n  const [menuPosition, setMenuPosition] = useState(DEFAULT_POSITION);\n  const [editing, setEditing] = useState(false);\n\n  const setSheetName = (sheetName: string) => {\n    controller.renameSheet(sheetName);\n    setEditing(false);\n  };\n  const handleContextMenu = (event: React.MouseEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    const pos = (event.clientX || 0) - 30;\n    setMenuPosition(pos);\n    return false;\n  };\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    event.stopPropagation();\n    if (event.key === 'Enter') {\n      const t = event.currentTarget.value;\n      if (!t) {\n        return;\n      }\n      setSheetName(t);\n    }\n  };\n  return (\n    <div className={styles['sheet-bar-wrapper']}>\n      <div className={styles['sheet-bar-list']} data-testid=\"sheet-bar-list\">\n        {realSheetList.map((item) => {\n          const isActive = currentSheetId === item.sheetId;\n          const showInput = isActive && editing;\n          const tabColor = item.tabColor || '';\n          const cls = classnames(styles['sheet-bar-item'], {\n            [styles['active']]: isActive,\n          });\n          let style = undefined;\n          if (!isActive && !editing && tabColor) {\n            style = { backgroundColor: tabColor };\n          }\n          return (\n            <div\n              key={item.sheetId}\n              className={cls}\n              style={style}\n              onContextMenu={handleContextMenu}\n              onClick={() => {\n                setEditing(false);\n                controller.setCurrentSheetId(item.sheetId);\n              }}\n            >\n              {showInput ? (\n                <input\n                  className={styles['sheet-bar-input']}\n                  defaultValue={item.name}\n                  onKeyDown={handleKeyDown}\n                  type=\"text\"\n                  spellCheck\n                />\n              ) : (\n                <React.Fragment>\n                  {isActive && tabColor && (\n                    <span\n                      className={styles['sheet-bar-item-color']}\n                      style={{ backgroundColor: tabColor }}\n                    />\n                  )}\n                  <span className={styles['sheet-bar-item-text']}>\n                    {item.name}\n                  </span>\n                </React.Fragment>\n              )}\n            </div>\n          );\n        })}\n      </div>\n      <div className={styles['sheet-bar-add']}>\n        <Button\n          onClick={() => controller.addSheet()}\n          type=\"circle\"\n          className={styles['add-button']}\n        >\n          <Icon name=\"plus\" />\n        </Button>\n      </div>\n      {menuPosition >= 0 && (\n        <SheetBarContextMenu\n          controller={controller}\n          position={menuPosition}\n          sheetList={sheetList}\n          currentSheetId={currentSheetId}\n          hideMenu={() => setMenuPosition(DEFAULT_POSITION)}\n          editSheetName={() => setEditing(true)}\n        />\n      )}\n    </div>\n  );\n};\nSheetBarContainer.displayName = 'SheetBarContainer';\n", "import React, { useMemo } from 'react';\nimport { Button, Select, info, ColorPicker } from '../components';\nimport { IController, OptionItem } from '@/types';\nimport styles from './index.module.css';\nimport { useClickOutside } from '../hooks';\nimport { SheetItem } from '../store';\nimport { $ } from '@/i18n';\n\ninterface Props {\n  controller: IController;\n  position: number;\n  sheetList: SheetItem[];\n  currentSheetId: string;\n  hideMenu: () => void;\n  editSheetName: () => void;\n}\n\nexport const SheetBarContextMenu: React.FunctionComponent<Props> = ({\n  controller,\n  position,\n  sheetList,\n  currentSheetId,\n  hideMenu,\n  editSheetName,\n}) => {\n  const [ref] = useClickOutside(() => {\n    hideMenu();\n  });\n  const tabColor = useMemo(() => {\n    return sheetList.find((v) => v.sheetId === currentSheetId)?.tabColor || '';\n  }, [sheetList, currentSheetId]);\n  const hideSheetList: OptionItem[] = useMemo(() => {\n    return sheetList\n      .filter((v) => v.isHide)\n      .map((item) => ({\n        value: String(item.sheetId),\n        label: item.name,\n        disabled: false,\n      }));\n  }, [sheetList]);\n  const handleUnhide = () => {\n    let value = String(hideSheetList[0]?.value) || '';\n    info({\n      visible: true,\n      title: $('unhide-sheet'),\n      children: (\n        <Select\n          data={hideSheetList}\n          onChange={(v) => (value = String(v))}\n          style={{ width: 300 }}\n          defaultValue={value}\n        />\n      ),\n      onCancel: hideMenu,\n      onOk() {\n        controller.unhideSheet(value);\n        hideMenu();\n      },\n    });\n  };\n  const handleTabColorChange = (color: string) => {\n    controller.setTabColor(color);\n    hideMenu();\n  };\n  return (\n    <div\n      className={styles['sheet-bar-context-menu']}\n      style={{ left: position }}\n      ref={ref}\n      data-testid=\"sheet-bar-context-menu\"\n    >\n      <Button\n        onClick={() => {\n          hideMenu();\n          controller.addSheet();\n        }}\n      >\n        {$('insert')}\n      </Button>\n      <Button\n        onClick={() => {\n          hideMenu();\n          controller.deleteSheet();\n        }}\n      >\n        {$('delete')}\n      </Button>\n      <Button\n        onClick={() => {\n          hideMenu();\n          editSheetName();\n        }}\n      >\n        {$('rename')}\n      </Button>\n      <Button\n        onClick={() => {\n          hideMenu();\n          controller.hideSheet();\n        }}\n      >\n        {$('hide')}\n      </Button>\n      <Button\n        className={styles['sheet-bar-unhide']}\n        disabled={hideSheetList.length === 0}\n        onClick={handleUnhide}\n      >\n        {$('unhide')}\n      </Button>\n      <ColorPicker\n        color={tabColor}\n        onChange={handleTabColorChange}\n        position=\"top\"\n      >\n        <Button className={styles['sheet-bar-unhide']}>{$('tab-color')}</Button>\n      </ColorPicker>\n    </div>\n  );\n};\nSheetBarContextMenu.displayName = 'SheetBarContextMenu';\n", ".sheet-bar-wrapper {\n  width: 100%;\n  box-sizing: border-box;\n  padding: 0 var(--largePadding);\n  display: flex;\n  align-items: center;\n  position: relative;\n  background-color: var(--backgroundColor);\n}\n\n.sheet-bar-list {\n  display: flex;\n  align-items: center;\n  height: 30px;\n  line-height: 30px;\n  overflow: auto;\n}\n\n.sheet-bar-item {\n  padding: 0 10px;\n  border-left: 1px solid var(--borderColor);\n  user-select: none;\n  position: relative;\n}\n\n.sheet-bar-item.active {\n  background-color: var(--white);\n  color: var(--primaryColor);\n}\n\n.sheet-bar-item-color {\n  width: 100%;\n  height: 3px;\n  position: absolute;\n  bottom: 2px;\n  left: 0;\n  right: 0;\n}\n\n.sheet-bar-context-menu {\n  position: fixed;\n  left: 0;\n  bottom: 32px;\n  background-color: var(--white);\n  border-radius: var(--borderRadius);\n  width: 100px;\n  z-index: var(--lowZIndex);\n}\n\n.sheet-bar-context-menu > button {\n  width: 100%;\n  background-color: var(--white);\n}\n\n.sheet-bar-input {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  background-color: var(--white);\n  outline: none;\n  font: inherit;\n  border: none;\n  border-radius: unset;\n}\n\n.show-block {\n  display: inline-block;\n}\n\n.sheet-bar-add {\n  margin-left: var(--mediumPadding);\n}\n\n.sheet-bar-unhide {\n  width: 100%;\n  background-color: var(--white);\n}\n.add-button {\n  background-color: var(--buttonActiveColor);\n  display: flex;\n  align-items: center;\n  justify-self: center;\n}\n", ".app-container {\n  overflow: hidden;\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n}\n", "import { CanvasContainer } from './canvas';\nimport { FormulaBarContainer } from './FormulaBar';\nimport { ToolbarContainer } from './ToolBar';\nimport { SheetBarContainer } from './SheetBar';\nimport styles from './index.module.css';\nimport React from 'react';\nimport type { IController } from '@/types';\nimport { MenuBarContainer } from './MenuBar';\n\ninterface Props {\n  controller: IController;\n}\n\nexport const App: React.FunctionComponent<Props> = ({ controller }) => {\n  return (\n    <div className={styles['app-container']} data-testid=\"app-container\">\n      <MenuBarContainer controller={controller} />\n      <ToolbarContainer controller={controller} />\n      <FormulaBarContainer controller={controller} />\n      <CanvasContainer controller={controller} />\n      <SheetBarContainer controller={controller} />\n    </div>\n  );\n};\nApp.displayName = 'App';\n", "import React, { useRef } from 'react';\nimport { IController } from '@/types';\nimport { Menu, MenuItem, SubMenu, Button } from '../components';\nimport { importXLSX } from '../Excel/import';\nimport { exportToXLSX } from '../Excel/exportXLSX';\nimport { exportToCsv } from '../Excel/exportCSV';\nimport styles from './index.module.css';\nimport { Theme } from './Theme';\nimport { $ } from '@/i18n';\nimport { I18N } from './I18N';\n\ninterface Props {\n  controller: IController;\n}\nconst menuStyle = { width: 150, flex: 1 };\n\nexport const MenuBarContainer: React.FunctionComponent<Props> = ({\n  controller,\n}) => {\n  const ref = useRef<HTMLInputElement>(null);\n\n  const handleExportXLSX = () => {\n    exportToXLSX(`excel_${Date.now()}.xlsx`, controller);\n  };\n  const handleExportCSV = () => {\n    exportToCsv(`excel_${Date.now()}.csv`, controller);\n  };\n  const handleImport = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    event.stopPropagation();\n    const file = event.target.files?.[0];\n    if (!file) {\n      return;\n    }\n    const model = await importXLSX(file);\n    controller.fromJSON(model);\n    ref.current!.value = '';\n    ref.current!.blur();\n  };\n\n  return (\n    <div className={styles['menubar-container']} data-testid=\"menubar\">\n      <div className={styles['menubar-menu']}>\n        <Menu\n          menuButton={<Button>{$('menu')}</Button>}\n          style={menuStyle}\n          testId=\"menubar-excel\"\n        >\n          <MenuItem testId=\"menubar-import-xlsx\">\n            <input\n              type=\"file\"\n              hidden\n              onChange={handleImport}\n              accept=\".xlsx\"\n              ref={ref}\n              id=\"import_xlsx\"\n            />\n            <label htmlFor=\"import_xlsx\">{$('import-xlsx')}</label>\n          </MenuItem>\n          <SubMenu label=\"Export\" style={menuStyle} testId=\"menubar-export\">\n            <MenuItem onClick={handleExportXLSX} testId=\"menubar-export-xlsx\">\n              {$('export-xlsx')}\n            </MenuItem>\n            <MenuItem testId=\"menubar-export-csv\" onClick={handleExportCSV}>\n              {$('export-csv')}\n            </MenuItem>\n          </SubMenu>\n        </Menu>\n      </div>\n      <I18N />\n      <Theme\n        toggleTheme={() => controller.setChangeSet(new Set(['cellStyle']))}\n      />\n    </div>\n  );\n};\n", "import {\n  WorkBookJSON,\n  WorksheetType,\n  ModelCellType,\n  StyleType,\n  EHorizontalAlign,\n  EVerticalAlign,\n  EUnderLine,\n  FloatElement,\n  IWindowSize,\n} from '@/types';\nimport {\n  get,\n  parseReference,\n  NUMBER_FORMAT_LIST,\n  CELL_HEIGHT,\n  CELL_WIDTH,\n  XLSX_MAX_ROW_COUNT,\n  XLSX_MAX_COL_COUNT,\n  coordinateToString,\n  getCustomWidthOrHeightKey,\n  generateUUID,\n} from '@/util';\n\nfunction getImageSize(base64: string): Promise<IWindowSize> {\n  return new Promise((resolve, reject) => {\n    const image = new Image();\n    image.onload = () => {\n      // \u83B7\u53D6\u56FE\u50CF\u7684\u5BBD\u5EA6\u548C\u9AD8\u5EA6\n      const width = image.width;\n      const height = image.height;\n\n      resolve({ width, height });\n    };\n    image.onerror = (error) => {\n      reject(error);\n    };\n    // \u8BBE\u7F6E\u56FE\u50CF\u7684\u6E90\u4E3A Blob \u5BF9\u8C61\n    image.src = base64;\n  });\n}\n\nconst COMMON_PREFIX = 'xl';\nconst STYLE_PATH = 'xl/styles.xml';\nconst WORKBOOK_PATH = 'xl/workbook.xml';\nconst WORKBOOK_RELATION_PATH = 'xl/_rels/workbook.xml.rels';\nconst THEME_PATH = 'xl/theme/theme1.xml';\nconst SHARED_STRINGS = 'xl/sharedStrings.xml';\nconst textKey = '#text';\nconst DRAWING_PREFIX_KEY = 'xl/drawings/';\nconst DRAWING_FLAG = '../drawings/';\n\nconst imageTypeMap = {\n  'image/apng': ['.apng'],\n  'image/bmp': ['.bmp'],\n  'image/x-icon': ['.ico', '.cur'],\n  // 'image/tiff': ['.tif', '.tiff'], // only Safari\n  'image/png': ['.png'],\n  'image/webp': ['.webp'],\n  'image/svg+xml': ['.svg'],\n  'image/avif': ['.avif'],\n  'image/gif': ['.gif'],\n  'image/jpeg': ['.jpeg', '.jpg', '.jfif', '.pjpeg', '.pjp'],\n} as const;\n\nconst chartTypeList = [\n  // 'area',\n  'bar',\n  // 'bubble',\n  // 'doughnut',\n  'line',\n  'pie',\n  // 'ofPie',\n  // 'radar',\n  // 'scatter',\n  // 'surface',\n] as const;\n\nexport const CUSTOM_WIdTH_RADIO = 8;\n\ntype SharedStringItem = {\n  t?: {\n    [textKey]: string;\n  };\n};\ntype ThemeData = Record<\n  string,\n  {\n    'a:srgbClr': { val: string };\n    'a:sysClr': { lastClr: string; val: string };\n  }\n>;\ntype SheetItem = Pick<WorksheetType, 'name' | 'sheetId'> & {\n  'r:id': string;\n  state?: string;\n};\ninterface RelationItem {\n  Id: string;\n  Target: string;\n  Type?: string;\n}\n\ninterface ColItem {\n  r: string;\n  s: string;\n  t?: string;\n  v?: {\n    [textKey]: string;\n  };\n}\ninterface SheetDataRowItem {\n  customHeight?: string;\n  hidden?: string;\n  ht?: string;\n  r: string;\n  c: ColItem[];\n}\n\ninterface CustomColItem {\n  min: string;\n  max: string;\n  width: string;\n  customWidth: string;\n  hidden?: string;\n}\n\ntype ChartData = {\n  'xdr:from': {\n    'xdr:col': {\n      [textKey]: string;\n    };\n    'xdr:row': {\n      [textKey]: string;\n    };\n  };\n  'xdr:graphicFrame'?: {\n    'xdr:nvGraphicFramePr': {\n      'xdr:cNvPr': {\n        id: string;\n        name: string;\n        descr?: string;\n        title?: string;\n      };\n    };\n    'a:graphic': {\n      'a:graphicData': {\n        'c:chart': {\n          'r:id': string;\n        };\n      };\n    };\n  };\n  'xdr:pic'?: {\n    'xdr:nvPicPr': {\n      'xdr:cNvPr': {\n        id: string;\n        name: string;\n        descr?: string;\n        title?: string;\n      };\n    };\n    'xdr:blipFill': {\n      'a:blip': {\n        'r:embed': string;\n      };\n    };\n  };\n};\n\nexport interface XfItem {\n  fontId: string;\n  fillId: string;\n  numFmtId: string;\n  applyFill?: string;\n  applyFont?: string;\n  applyNumberFormat?: string;\n  applyAlignment?: string;\n  alignment?: {\n    vertical?: 'top' | 'center' | 'bottom';\n    horizontal?: 'left' | 'center' | 'right';\n    wrapText?: string;\n  };\n}\n\ntype ObjectItem = Record<string, any>;\ninterface ColorItem {\n  rgb?: string;\n  theme?: string;\n  indexed?: string;\n  tint?: string;\n  auto?: string;\n}\ninterface FontItem {\n  b?: ObjectItem;\n  i?: ObjectItem;\n  u?: ObjectItem;\n  strike?: ObjectItem;\n  color: ColorItem;\n  name?: {\n    val: string;\n  };\n  sz?: {\n    val: string;\n  };\n}\ninterface FillItem {\n  patternFill?: {\n    patternType: string;\n    fgColor: ColorItem;\n    bgColor: ColorItem;\n  };\n  gradientFill?: {\n    stop: Array<{ color: ColorItem }>;\n  };\n}\n\ninterface DefineNameItem {\n  name: string;\n  [textKey]: string;\n}\n\nfunction xmlToJson(xml: any) {\n  // Create the return object\n  let obj: ObjectItem = {};\n\n  if (xml.nodeType === Node.ELEMENT_NODE) {\n    // element\n    // do attributes\n    if (xml.attributes.length > 0) {\n      for (const attribute of xml.attributes) {\n        obj[attribute.nodeName] = attribute.nodeValue;\n      }\n    }\n  } else if (xml.nodeType === Node.TEXT_NODE) {\n    // text\n    obj = xml.nodeValue;\n  }\n\n  // do children\n  if (xml.childNodes.length > 0) {\n    for (const item of xml.childNodes) {\n      const n = item.nodeName;\n      // clear empty text\n      if (typeof item.nodeValue === 'string' && !item.nodeValue.trim()) {\n        continue;\n      }\n      if (typeof obj[n] === 'undefined') {\n        obj[n] = xmlToJson(item);\n      } else {\n        if (typeof obj[n].push === 'undefined') {\n          obj[n] = [obj[n]];\n        }\n        obj[n].push(xmlToJson(item));\n      }\n    }\n  }\n  return obj;\n}\n\nexport function convertXMLToJSON(xmlStr: string) {\n  const parser = new DOMParser();\n  const xml = parser.parseFromString(xmlStr, 'text/xml');\n  const json = xmlToJson(xml);\n  return json;\n}\nfunction convertRGB(c?: string) {\n  if (!c) {\n    return '';\n  }\n  const colorPrefix = '#';\n  if (c.length === 6) {\n    return colorPrefix + c;\n  }\n  if (c.length === 8 && c.startsWith('FF')) {\n    return colorPrefix + c.slice(2);\n  }\n  return '';\n}\n\nfunction convertColor(themeData: ThemeData, color?: ColorItem) {\n  if (!color) {\n    return '';\n  }\n  if (color.theme) {\n    const themeIndex = [\n      'a:lt1',\n      'a:dk1',\n      'a:lt2',\n      'a:dk2',\n      'a:accent1',\n      'a:accent2',\n      'a:accent3',\n      'a:accent4',\n      'a:accent5',\n      'a:accent6',\n    ];\n    const i = parseInt(color.theme, 10);\n    if (i >= 0 && i <= 1) {\n      return convertRGB(themeData[themeIndex[i]]['a:sysClr'].lastClr);\n    }\n    if (i > 1 && i < themeIndex.length) {\n      return convertRGB(themeData[themeIndex[i]]['a:srgbClr'].val);\n    }\n  }\n\n  return convertRGB(color.rgb);\n}\n\nfunction getCellStyle(\n  xml: ObjectItem,\n  styleId: number,\n  themeData: ThemeData,\n): Partial<StyleType> {\n  const result: Partial<StyleType> = {};\n  const xfList = get<XfItem[]>(xml, 'styleSheet.cellXfs.xf', []);\n  if (!styleId || xfList.length === 0 || !xfList[styleId]) {\n    return result;\n  }\n  const xf = xfList[styleId];\n  if (xf.applyAlignment && xf.alignment) {\n    if (xf.alignment.horizontal) {\n      const alignMap = {\n        left: EHorizontalAlign.LEFT,\n        center: EHorizontalAlign.CENTER,\n        right: EHorizontalAlign.RIGHT,\n      };\n      result.horizontalAlign = alignMap[xf.alignment.horizontal];\n    }\n    if (xf.alignment.vertical) {\n      const alignMap = {\n        top: EVerticalAlign.TOP,\n        center: EVerticalAlign.CENTER,\n        bottom: EVerticalAlign.BOTTOM,\n      };\n      result.verticalAlign = alignMap[xf.alignment.vertical];\n    } else {\n      result.verticalAlign = EVerticalAlign.BOTTOM;\n    }\n    result.isWrapText = Boolean(xf.alignment.wrapText);\n  }\n  if (xf.applyFont && xf.fontId) {\n    const fontList = get<FontItem[]>(xml, 'styleSheet.fonts.font', []);\n    const fontId = parseInt(xf.fontId, 10);\n    if (!isNaN(fontId) && fontList.length > 0 && fontList[fontId]) {\n      const font = fontList[fontId];\n      const fz = font?.sz?.val ? parseInt(font?.sz?.val, 10) : undefined;\n      result.fontSize = fz ? fz : undefined;\n      result.isBold = Boolean(font?.b);\n      result.isItalic = Boolean(font?.i);\n      result.isStrike = Boolean(font?.strike);\n      result.underline = font.u ? EUnderLine.SINGLE : EUnderLine.NONE;\n      result.fontFamily = font?.name?.val;\n      const color = convertColor(themeData, font.color);\n      if (color) {\n        result.fontColor = color;\n      }\n    }\n  }\n  if (xf.applyNumberFormat && xf.numFmtId) {\n    const id = parseInt(xf.numFmtId, 10);\n    if (NUMBER_FORMAT_LIST.some((v) => v.id === id)) {\n      result.numberFormat = id;\n    }\n  }\n  if (xf.applyFill && xf.fillId) {\n    const list = get<FillItem[]>(xml, 'styleSheet.fills.fill', []);\n    const i = parseInt(xf.fillId, 10);\n    if (list.length > 0 && !isNaN(i) && list[i]) {\n      const g = list[i].gradientFill;\n      const p = list[i].patternFill;\n      if (g && g.stop[0]) {\n        // TODO: handle multiple color\n        const color = convertColor(themeData, g.stop[0].color);\n        if (color) {\n          result.fillColor = color;\n        }\n      } else if (p) {\n        const color = convertColor(themeData, p.fgColor);\n        if (color) {\n          result.fillColor = color;\n        }\n      }\n    }\n  }\n  return result;\n}\n\nexport function convertXMLDataToModel(\n  xmlData: ObjectItem,\n  imageSizeMap: Record<string, IWindowSize>,\n): WorkBookJSON {\n  const workbook = xmlData[WORKBOOK_PATH];\n\n  let sharedStrings: SharedStringItem[] = get(\n    xmlData[SHARED_STRINGS],\n    'sst.si',\n    [],\n  );\n  if (!Array.isArray(sharedStrings)) {\n    sharedStrings = [sharedStrings];\n  }\n  const themeData = get<ThemeData>(\n    xmlData[THEME_PATH],\n    'a:theme.a:themeElements.a:clrScheme',\n    {},\n  );\n\n  const result: WorkBookJSON = {\n    workbook: {},\n    mergeCells: {},\n    customHeight: {},\n    customWidth: {},\n    definedNames: {},\n    currentSheetId: '',\n    drawings: {},\n    rangeMap: {},\n    worksheets: {},\n  };\n  const relationList = get<RelationItem[]>(\n    xmlData[WORKBOOK_RELATION_PATH],\n    'Relationships.Relationship',\n    [],\n  );\n  const sheetPathMap: Record<string, string> = {};\n  const drawingMap: Record<string, string[]> = {};\n  let drawingCount = 0;\n  let sheetList: SheetItem[] = get(workbook, 'workbook.sheets.sheet', []);\n  if (!Array.isArray(sheetList)) {\n    sheetList = [sheetList];\n  }\n  let sheetSort = 0;\n  for (const item of sheetList) {\n    if (!item) {\n      continue;\n    }\n    const sheetTarget =\n      relationList.find((v) => v.Id === item['r:id'])?.Target || '';\n    const worksheetPrefix = 'worksheets/';\n    const baseSheet = sheetTarget.slice(worksheetPrefix.length);\n    const refPath = `${COMMON_PREFIX}/${worksheetPrefix}_rels/${baseSheet}.rels`;\n    if (xmlData[refPath]) {\n      let list: RelationItem[] = get(\n        xmlData[refPath],\n        'Relationships.Relationship',\n        [],\n      );\n      if (!Array.isArray(list)) {\n        list = [list];\n      }\n      for (const v of list) {\n        if (!drawingMap[item.sheetId]) {\n          drawingMap[item.sheetId] = [];\n        }\n        drawingMap[item.sheetId].push(v.Target);\n        if (v.Target.startsWith(DRAWING_FLAG)) {\n          drawingCount++;\n        }\n      }\n    }\n    const sheetPath = `${COMMON_PREFIX}/${sheetTarget}`;\n    sheetPathMap[item.sheetId] = sheetPath;\n    const range = parseReference(\n      get<string>(\n        xmlData[sheetPath],\n        'worksheet.sheetViews.sheetView.selection.sqref',\n        '',\n      ),\n    )!;\n    const tabSelected = get<string>(\n      xmlData[sheetPath],\n      'worksheet.sheetViews.sheetView.tabSelected',\n      '',\n    );\n    if (tabSelected === '1') {\n      result.currentSheetId = item.sheetId;\n    }\n    const sheetData = {\n      sheetId: item.sheetId,\n      name: item.name,\n      isHide: item.state === 'hidden',\n      rowCount: 200,\n      colCount: 200,\n      sort: sheetSort++,\n    };\n    result.workbook[sheetData.sheetId] = sheetData;\n    if (range) {\n      result.rangeMap[item.sheetId] = range;\n      range.sheetId = item.sheetId;\n    }\n  }\n  const sheets = Object.values(result.workbook);\n  sheets.sort((a, b) => a.sort - b.sort);\n  result.currentSheetId = result.currentSheetId || sheets[0].sheetId;\n\n  for (const item of sheets) {\n    const sheetPath = sheetPathMap[item.sheetId];\n    let sheetData: SheetDataRowItem[] = get(\n      xmlData[sheetPath],\n      'worksheet.sheetData.row',\n    );\n    if (!Array.isArray(sheetData)) {\n      sheetData = [sheetData];\n    }\n    let customWidth: CustomColItem[] = get(\n      xmlData[sheetPath],\n      'worksheet.cols.col',\n      [],\n    );\n    customWidth = Array.isArray(customWidth) ? customWidth : [customWidth];\n    const defaultWOrH = get(xmlData[sheetPath], 'worksheet.sheetFormatPr', {\n      defaultColWidth: '',\n      defaultRowHeight: '',\n      outlineLevelRow: '',\n    });\n    if (customWidth.length > 0) {\n      for (const col of customWidth) {\n        if (col && col.customWidth && col.width && col.min && col.max) {\n          const isDefault = defaultWOrH.defaultColWidth === col.width;\n          const w = isDefault\n            ? CELL_WIDTH\n            : parseFloat(col.width) * CUSTOM_WIdTH_RADIO;\n          const isHide = Boolean(col.hidden);\n          for (\n            let start = parseInt(col.min, 10) - 1, end = parseInt(col.max, 10);\n            start < end;\n            start++\n          ) {\n            result.customWidth[getCustomWidthOrHeightKey(item.sheetId, start)] =\n              {\n                len: w,\n                isHide,\n              };\n          }\n        }\n      }\n    }\n\n    if (sheetData.length === 0) {\n      continue;\n    }\n\n    let { colCount } = item;\n    let { rowCount } = item;\n    for (const row of sheetData) {\n      if (!row) {\n        continue;\n      }\n      const realRow = parseInt(row.r, 10) - 1;\n      rowCount = Math.max(rowCount, realRow + 1);\n      if (rowCount > XLSX_MAX_ROW_COUNT) {\n        continue;\n      }\n      if (row.customHeight && row.ht) {\n        const isDefault = defaultWOrH.defaultRowHeight === row.ht;\n        result.customHeight[getCustomWidthOrHeightKey(item.sheetId, realRow)] =\n          {\n            len: isDefault ? CELL_HEIGHT : parseFloat(row.ht),\n            isHide: Boolean(row.hidden),\n          };\n      }\n      const colList = Array.isArray(row.c) ? row.c : [row.c];\n      for (const col of colList) {\n        if (!col) {\n          continue;\n        }\n        const range = parseReference(col.r)!;\n        if (!range) {\n          continue;\n        }\n        colCount = Math.max(colCount, range.col + 1);\n        if (colCount > XLSX_MAX_COL_COUNT) {\n          continue;\n        }\n        let val = col?.v?.[textKey] || '';\n        const styleId = parseInt(col.s, 10);\n        const style = getCellStyle(xmlData[STYLE_PATH], styleId, themeData);\n        const t: ModelCellType = {\n          style,\n        };\n        if (col.t === 's') {\n          const i = parseInt(val, 10);\n          if (!isNaN(i)) {\n            const data = sharedStrings[i];\n            const text = data?.t?.[textKey] || '';\n            if (text) {\n              val = text;\n            }\n          }\n        }\n        if (val.startsWith('=')) {\n          t.formula = val;\n        } else {\n          t.value = val;\n        }\n\n        result.worksheets[item.sheetId] = result.worksheets[item.sheetId] || {};\n        result.worksheets[item.sheetId][\n          coordinateToString(realRow, range.col)\n        ] = t;\n        colCount = Math.max(colCount, range.col + 1);\n      }\n    }\n    item.rowCount = Math.max(item.rowCount, rowCount);\n    item.colCount = Math.max(item.colCount, colCount);\n  }\n\n  let definedNames: DefineNameItem[] = get(\n    workbook,\n    'workbook.definedNames.definedName',\n    [],\n  );\n  definedNames = Array.isArray(definedNames) ? definedNames : [definedNames];\n  const convertSheetName = (sheetName: string) => {\n    const list = Object.values(result.workbook);\n    return list.find((v) => v.name === sheetName)?.sheetId || '';\n  };\n  for (const item of definedNames) {\n    const range = parseReference(item[textKey], convertSheetName);\n    if (range && range.sheetId && range.isValid() && item?.name) {\n      result.definedNames[item.name.toLowerCase()] = range.toIRange();\n    }\n  }\n  for (let drawingId = 1; drawingId <= drawingCount; drawingId++) {\n    const basePath = `drawing${drawingId}.xml`;\n    const key = `${DRAWING_PREFIX_KEY}${basePath}`;\n    const ref = `${DRAWING_PREFIX_KEY}_rels/${basePath}.rels`;\n    if (!xmlData[key] || !xmlData[ref]) {\n      break;\n    }\n\n    let relations: RelationItem[] = get(\n      xmlData[ref],\n      'Relationships.Relationship',\n      [],\n    );\n    if (!Array.isArray(relations)) {\n      relations = [relations];\n    }\n    let sheetId = '';\n    for (const [id, list] of Object.entries(drawingMap)) {\n      if (list.some((v) => v === DRAWING_FLAG + basePath)) {\n        sheetId = id;\n        break;\n      }\n    }\n\n    let floatElementList: ChartData[] = get(\n      xmlData[key],\n      'xdr:wsDr.xdr:twoCellAnchor',\n      [],\n    );\n    if (!Array.isArray(floatElementList)) {\n      floatElementList = [floatElementList];\n    }\n    for (const float of floatElementList) {\n      const chartId = get(\n        float,\n        'xdr:graphicFrame.a:graphic.a:graphicData.c:chart.r:id',\n        '',\n      );\n      const imageId = get(float, 'xdr:pic.xdr:blipFill.a:blip.r:embed', '');\n      const isImage = !!imageId;\n      const rid = isImage ? imageId : chartId;\n      const target = relations.find((v) => v.Id === rid)?.Target || '';\n      if (!target) {\n        continue;\n      }\n      const filePath = COMMON_PREFIX + target.slice(2);\n      const fromRow = float['xdr:from']['xdr:col'][textKey];\n      const fromCol = float['xdr:from']['xdr:row'][textKey];\n      if (!fromRow || !fromCol) {\n        continue;\n      }\n      const uuid = generateUUID();\n      const floatElementData: FloatElement = {\n        title: '',\n        type: isImage ? 'floating-picture' : 'chart',\n        uuid,\n        width: 300,\n        height: 300,\n        originHeight: 300,\n        originWidth: 300,\n        fromCol: parseInt(fromCol, 10),\n        fromRow: parseInt(fromRow, 10),\n        sheetId,\n        marginX: 0,\n        marginY: 0,\n      };\n\n      if (isImage) {\n        if (!xmlData[filePath]) {\n          continue;\n        }\n        const name = get(float, 'xdr:pic.xdr:nvPicPr.xdr:cNvPr.name', '');\n        const title = get(float, 'xdr:pic.xdr:nvPicPr.xdr:cNvPr.title', '');\n        floatElementData.title = title || name;\n        floatElementData.imageAngle = 0;\n        floatElementData.imageSrc = xmlData[filePath] || '';\n        const size = imageSizeMap[filePath];\n        if (size && size.width > 0 && size.height > 0) {\n          floatElementData.width = size.width;\n          floatElementData.height = size.height;\n          floatElementData.originWidth = size.width;\n          floatElementData.originHeight = size.height;\n        }\n      } else {\n        floatElementData.title = get(\n          xmlData[filePath],\n          'c:chartSpace.c:chart.c:title.c:tx.c:rich.a:p.0.a:r.a:t.' + textKey,\n          '',\n        );\n        let ref = '';\n        for (const chartType of chartTypeList) {\n          const t = get(\n            xmlData[filePath],\n            `c:chartSpace.c:chart.c:plotArea.c:${chartType}Chart.c:ser.0.c:val.c:numRef.c:f.${textKey}`,\n            '',\n          );\n          if (t) {\n            ref = t;\n            floatElementData.chartType = chartType;\n            break;\n          }\n        }\n\n        if (!ref) {\n          continue;\n        }\n        const range = parseReference(ref, (sheetName: string) => {\n          const data = Object.values(result.workbook).find(\n            (v) => v.name === sheetName,\n          );\n          return data?.sheetId || '';\n        });\n        if (!range) {\n          continue;\n        }\n        floatElementData.chartRange = range;\n      }\n\n      result.drawings[uuid] = floatElementData;\n    }\n  }\n\n  return result;\n}\n\nexport async function importXLSX(file: File) {\n  const jszip = await import('jszip');\n  const zip = await jszip.default.loadAsync(file);\n  const { files } = zip;\n  const result: ObjectItem = {};\n  const imageSizeMap: Record<string, IWindowSize> = {};\n  for (const key of Object.keys(files)) {\n    if (files[key].dir) {\n      continue;\n    }\n    if (key.includes('.xml')) {\n      const data = await files[key].async('string');\n      if (data) {\n        result[key] = convertXMLToJSON(data);\n      }\n    } else {\n      let imageType = '';\n      for (const [type, list] of Object.entries(imageTypeMap)) {\n        if (list.some((v) => key.endsWith(v))) {\n          imageType = type;\n          break;\n        }\n      }\n      if (!imageType) {\n        continue;\n      }\n      const data = await files[key].async('base64');\n      if (data) {\n        result[key] = `data:${imageType};base64,${data}`;\n        imageSizeMap[key] = await getImageSize(result[key]);\n      }\n    }\n  }\n\n  const model = convertXMLDataToModel(result, imageSizeMap);\n  return model;\n}\n", "export interface StyleData {\n  cellXfs: string[];\n  numFmts: string[];\n  fonts: string[];\n  fills: string[];\n}\n\nexport function getCoreXML() {\n  const createDate = new Date().toLocaleDateString('zh').replaceAll('/', '-');\n  const createTime = new Date().toLocaleTimeString('zh');\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n<cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\"\n  xmlns:dc=\"http://purl.org/dc/elements/1.1/\"\n  xmlns:dcterms=\"http://purl.org/dc/terms/\"\n  xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\"\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n  <dc:creator>Steve Xu</dc:creator>\n  <cp:lastModifiedBy>Steve Xu</cp:lastModifiedBy>\n  <dcterms:created xsi:type=\"dcterms:W3CDTF\">${createDate}T${createTime}Z</dcterms:created>\n  <dcterms:modified xsi:type=\"dcterms:W3CDTF\">${createDate}T${createTime}Z</dcterms:modified>\n</cp:coreProperties>`;\n}\n\nexport function generateStyleFile(styles: StyleData) {\n  const result = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n  <styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"\n    xmlns:xr9=\"http://schemas.microsoft.com/office/spreadsheetml/2016/revision9\">\n    <numFmts count=\"${styles.numFmts.length}\">\n    ${styles.numFmts.join('\\n')}\n    </numFmts>\n    <fonts count=\"${styles.fonts.length}\">\n    ${styles.fonts.join('\\n')}\n    </fonts>\n    <fills count=\"${styles.fills.length}\">\n    ${styles.fills.join('\\n')}\n    </fills>\n    <borders count=\"9\">\n      <border>\n        <left/>\n        <right/>\n        <top/>\n        <bottom/>\n        <diagonal/>\n      </border>\n      <border>\n        <left style=\"thin\">\n          <color rgb=\"FFB2B2B2\"/>\n        </left>\n        <right style=\"thin\">\n          <color rgb=\"FFB2B2B2\"/>\n        </right>\n        <top style=\"thin\">\n          <color rgb=\"FFB2B2B2\"/>\n        </top>\n        <bottom style=\"thin\">\n          <color rgb=\"FFB2B2B2\"/>\n        </bottom>\n        <diagonal/>\n      </border>\n      <border>\n        <left/>\n        <right/>\n        <top/>\n        <bottom style=\"medium\">\n          <color theme=\"4\"/>\n        </bottom>\n        <diagonal/>\n      </border>\n      <border>\n        <left/>\n        <right/>\n        <top/>\n        <bottom style=\"medium\">\n          <color theme=\"4\" tint=\"0.499984740745262\"/>\n        </bottom>\n        <diagonal/>\n      </border>\n      <border>\n        <left style=\"thin\">\n          <color rgb=\"FF7F7F7F\"/>\n        </left>\n        <right style=\"thin\">\n          <color rgb=\"FF7F7F7F\"/>\n        </right>\n        <top style=\"thin\">\n          <color rgb=\"FF7F7F7F\"/>\n        </top>\n        <bottom style=\"thin\">\n          <color rgb=\"FF7F7F7F\"/>\n        </bottom>\n        <diagonal/>\n      </border>\n      <border>\n        <left style=\"thin\">\n          <color rgb=\"FF3F3F3F\"/>\n        </left>\n        <right style=\"thin\">\n          <color rgb=\"FF3F3F3F\"/>\n        </right>\n        <top style=\"thin\">\n          <color rgb=\"FF3F3F3F\"/>\n        </top>\n        <bottom style=\"thin\">\n          <color rgb=\"FF3F3F3F\"/>\n        </bottom>\n        <diagonal/>\n      </border>\n      <border>\n        <left style=\"double\">\n          <color rgb=\"FF3F3F3F\"/>\n        </left>\n        <right style=\"double\">\n          <color rgb=\"FF3F3F3F\"/>\n        </right>\n        <top style=\"double\">\n          <color rgb=\"FF3F3F3F\"/>\n        </top>\n        <bottom style=\"double\">\n          <color rgb=\"FF3F3F3F\"/>\n        </bottom>\n        <diagonal/>\n      </border>\n      <border>\n        <left/>\n        <right/>\n        <top/>\n        <bottom style=\"double\">\n          <color rgb=\"FFFF8001\"/>\n        </bottom>\n        <diagonal/>\n      </border>\n      <border>\n        <left/>\n        <right/>\n        <top style=\"thin\">\n          <color theme=\"4\"/>\n        </top>\n        <bottom style=\"double\">\n          <color theme=\"4\"/>\n        </bottom>\n        <diagonal/>\n      </border>\n    </borders>\n    <cellStyleXfs count=\"49\">\n      <xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"43\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"0\" applyFill=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"44\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"0\" applyFill=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"9\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"0\" applyFill=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"41\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"0\" applyFill=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"42\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"0\" applyFill=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyNumberFormat=\"0\" applyFill=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyNumberFormat=\"0\" applyFill=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyNumberFormat=\"0\" applyFont=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyNumberFormat=\"0\" applyFill=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyNumberFormat=\"0\" applyFill=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"5\" fillId=\"0\" borderId=\"0\" applyNumberFormat=\"0\" applyFill=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"6\" fillId=\"0\" borderId=\"2\" applyNumberFormat=\"0\" applyFill=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"7\" fillId=\"0\" borderId=\"2\" applyNumberFormat=\"0\" applyFill=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"8\" fillId=\"0\" borderId=\"3\" applyNumberFormat=\"0\" applyFill=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"8\" fillId=\"0\" borderId=\"0\" applyNumberFormat=\"0\" applyFill=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"9\" fillId=\"3\" borderId=\"4\" applyNumberFormat=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"10\" fillId=\"4\" borderId=\"5\" applyNumberFormat=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"11\" fillId=\"4\" borderId=\"4\" applyNumberFormat=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"12\" fillId=\"5\" borderId=\"6\" applyNumberFormat=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"13\" fillId=\"0\" borderId=\"7\" applyNumberFormat=\"0\" applyFill=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"14\" fillId=\"0\" borderId=\"8\" applyNumberFormat=\"0\" applyFill=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"15\" fillId=\"6\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"16\" fillId=\"7\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"17\" fillId=\"8\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"18\" fillId=\"9\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"19\" fillId=\"10\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"19\" fillId=\"11\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"18\" fillId=\"12\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"18\" fillId=\"13\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"19\" fillId=\"14\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"19\" fillId=\"15\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"18\" fillId=\"16\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"18\" fillId=\"17\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"19\" fillId=\"18\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"19\" fillId=\"19\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"18\" fillId=\"20\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"18\" fillId=\"21\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"19\" fillId=\"22\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"19\" fillId=\"23\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"18\" fillId=\"24\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"18\" fillId=\"25\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"19\" fillId=\"26\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"19\" fillId=\"27\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"18\" fillId=\"28\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"18\" fillId=\"29\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"19\" fillId=\"30\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"19\" fillId=\"31\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n      <xf numFmtId=\"0\" fontId=\"18\" fillId=\"32\" borderId=\"0\" applyNumberFormat=\"0\" applyBorder=\"0\" applyAlignment=\"0\" applyProtection=\"0\">\n        <alignment vertical=\"center\"/>\n      </xf>\n    </cellStyleXfs>\n    <cellXfs count=\"${styles.cellXfs.length}\">\n    ${styles.cellXfs.join('\\n')}\n    </cellXfs>\n    <cellStyles count=\"49\">\n      <cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/>\n      <cellStyle name=\"Comma\" xfId=\"1\" builtinId=\"3\"/>\n      <cellStyle name=\"Currency\" xfId=\"2\" builtinId=\"4\"/>\n      <cellStyle name=\"Percent\" xfId=\"3\" builtinId=\"5\"/>\n      <cellStyle name=\"Comma [0]\" xfId=\"4\" builtinId=\"6\"/>\n      <cellStyle name=\"Currency [0]\" xfId=\"5\" builtinId=\"7\"/>\n      <cellStyle name=\"Hyperlink\" xfId=\"6\" builtinId=\"8\"/>\n      <cellStyle name=\"Followed Hyperlink\" xfId=\"7\" builtinId=\"9\"/>\n      <cellStyle name=\"Note\" xfId=\"8\" builtinId=\"10\"/>\n      <cellStyle name=\"Warning Text\" xfId=\"9\" builtinId=\"11\"/>\n      <cellStyle name=\"Title\" xfId=\"10\" builtinId=\"15\"/>\n      <cellStyle name=\"CExplanatory Text\" xfId=\"11\" builtinId=\"53\"/>\n      <cellStyle name=\"Heading 1\" xfId=\"12\" builtinId=\"16\"/>\n      <cellStyle name=\"Heading 2\" xfId=\"13\" builtinId=\"17\"/>\n      <cellStyle name=\"Heading 3\" xfId=\"14\" builtinId=\"18\"/>\n      <cellStyle name=\"Heading 4\" xfId=\"15\" builtinId=\"19\"/>\n      <cellStyle name=\"Input\" xfId=\"16\" builtinId=\"20\"/>\n      <cellStyle name=\"Output\" xfId=\"17\" builtinId=\"21\"/>\n      <cellStyle name=\"Calculation\" xfId=\"18\" builtinId=\"22\"/>\n      <cellStyle name=\"Check Cell\" xfId=\"19\" builtinId=\"23\"/>\n      <cellStyle name=\"Linked Cell\" xfId=\"20\" builtinId=\"24\"/>\n      <cellStyle name=\"Total\" xfId=\"21\" builtinId=\"25\"/>\n      <cellStyle name=\"Good\" xfId=\"22\" builtinId=\"26\"/>\n      <cellStyle name=\"Bad\" xfId=\"23\" builtinId=\"27\"/>\n      <cellStyle name=\"Neutral\" xfId=\"24\" builtinId=\"28\"/>\n      <cellStyle name=\"Accent1\" xfId=\"25\" builtinId=\"29\"/>\n      <cellStyle name=\"20% - Accent1\" xfId=\"26\" builtinId=\"30\"/>\n      <cellStyle name=\"40% - Accent1\" xfId=\"27\" builtinId=\"31\"/>\n      <cellStyle name=\"60% - Accent1\" xfId=\"28\" builtinId=\"32\"/>\n      <cellStyle name=\"Accent2\" xfId=\"29\" builtinId=\"33\"/>\n      <cellStyle name=\"20% - Accent2\" xfId=\"30\" builtinId=\"34\"/>\n      <cellStyle name=\"40% - Accent2\" xfId=\"31\" builtinId=\"35\"/>\n      <cellStyle name=\"60% - Accent2\" xfId=\"32\" builtinId=\"36\"/>\n      <cellStyle name=\"Accent3\" xfId=\"33\" builtinId=\"37\"/>\n      <cellStyle name=\"20% - Accent3\" xfId=\"34\" builtinId=\"38\"/>\n      <cellStyle name=\"40% - Accent3\" xfId=\"35\" builtinId=\"39\"/>\n      <cellStyle name=\"60% - Accent3\" xfId=\"36\" builtinId=\"40\"/>\n      <cellStyle name=\"Accent4\" xfId=\"37\" builtinId=\"41\"/>\n      <cellStyle name=\"20% - Accent4\" xfId=\"38\" builtinId=\"42\"/>\n      <cellStyle name=\"40% - Accent4\" xfId=\"39\" builtinId=\"43\"/>\n      <cellStyle name=\"60% - Accent4\" xfId=\"40\" builtinId=\"44\"/>\n      <cellStyle name=\"Accent5\" xfId=\"41\" builtinId=\"45\"/>\n      <cellStyle name=\"20% - Accent5\" xfId=\"42\" builtinId=\"46\"/>\n      <cellStyle name=\"40% - Accent5\" xfId=\"43\" builtinId=\"47\"/>\n      <cellStyle name=\"60% - Accent5\" xfId=\"44\" builtinId=\"48\"/>\n      <cellStyle name=\"Accent6\" xfId=\"45\" builtinId=\"49\"/>\n      <cellStyle name=\"20% - Accent6\" xfId=\"46\" builtinId=\"50\"/>\n      <cellStyle name=\"40% - Accent6\" xfId=\"47\" builtinId=\"51\"/>\n      <cellStyle name=\"60% - Accent6\" xfId=\"48\" builtinId=\"52\"/>\n    </cellStyles>\n    <dxfs count=\"17\">\n      <dxf>\n        <fill>\n          <patternFill patternType=\"solid\">\n            <fgColor theme=\"4\" tint=\"0.799981688894314\"/>\n            <bgColor theme=\"4\" tint=\"0.799981688894314\"/>\n          </patternFill>\n        </fill>\n      </dxf>\n      <dxf>\n        <fill>\n          <patternFill patternType=\"solid\">\n            <fgColor theme=\"4\" tint=\"0.799981688894314\"/>\n            <bgColor theme=\"4\" tint=\"0.799981688894314\"/>\n          </patternFill>\n        </fill>\n      </dxf>\n      <dxf>\n        <font>\n          <b val=\"1\"/>\n          <color theme=\"1\"/>\n        </font>\n      </dxf>\n      <dxf>\n        <font>\n          <b val=\"1\"/>\n          <color theme=\"1\"/>\n        </font>\n      </dxf>\n      <dxf>\n        <font>\n          <b val=\"1\"/>\n          <color theme=\"1\"/>\n        </font>\n        <border>\n          <top style=\"double\">\n            <color theme=\"4\"/>\n          </top>\n        </border>\n      </dxf>\n      <dxf>\n        <font>\n          <b val=\"1\"/>\n          <color theme=\"0\"/>\n        </font>\n        <fill>\n          <patternFill patternType=\"solid\">\n            <fgColor theme=\"4\"/>\n            <bgColor theme=\"4\"/>\n          </patternFill>\n        </fill>\n      </dxf>\n      <dxf>\n        <font>\n          <color theme=\"1\"/>\n        </font>\n        <border>\n          <left style=\"thin\">\n            <color theme=\"4\"/>\n          </left>\n          <right style=\"thin\">\n            <color theme=\"4\"/>\n          </right>\n          <top style=\"thin\">\n            <color theme=\"4\"/>\n          </top>\n          <bottom style=\"thin\">\n            <color theme=\"4\"/>\n          </bottom>\n          <horizontal style=\"thin\">\n            <color theme=\"4\" tint=\"0.399975585192419\"/>\n          </horizontal>\n        </border>\n      </dxf>\n      <dxf>\n        <fill>\n          <patternFill patternType=\"solid\">\n            <fgColor theme=\"4\" tint=\"0.799981688894314\"/>\n            <bgColor theme=\"4\" tint=\"0.799981688894314\"/>\n          </patternFill>\n        </fill>\n        <border>\n          <bottom style=\"thin\">\n            <color theme=\"4\" tint=\"0.399975585192419\"/>\n          </bottom>\n        </border>\n      </dxf>\n      <dxf>\n        <font>\n          <b val=\"1\"/>\n        </font>\n        <fill>\n          <patternFill patternType=\"solid\">\n            <fgColor theme=\"4\" tint=\"0.799981688894314\"/>\n            <bgColor theme=\"4\" tint=\"0.799981688894314\"/>\n          </patternFill>\n        </fill>\n        <border>\n          <bottom style=\"thin\">\n            <color theme=\"4\" tint=\"0.399975585192419\"/>\n          </bottom>\n        </border>\n      </dxf>\n      <dxf>\n        <font>\n          <color theme=\"1\"/>\n        </font>\n      </dxf>\n      <dxf>\n        <font>\n          <color theme=\"1\"/>\n        </font>\n        <border>\n          <bottom style=\"thin\">\n            <color theme=\"4\" tint=\"0.399975585192419\"/>\n          </bottom>\n        </border>\n      </dxf>\n      <dxf>\n        <font>\n          <b val=\"1\"/>\n          <color theme=\"1\"/>\n        </font>\n      </dxf>\n      <dxf>\n        <font>\n          <b val=\"1\"/>\n          <color theme=\"1\"/>\n        </font>\n        <border>\n          <top style=\"thin\">\n            <color theme=\"4\"/>\n          </top>\n          <bottom style=\"thin\">\n            <color theme=\"4\"/>\n          </bottom>\n        </border>\n      </dxf>\n      <dxf>\n        <fill>\n          <patternFill patternType=\"solid\">\n            <fgColor theme=\"4\" tint=\"0.799981688894314\"/>\n            <bgColor theme=\"4\" tint=\"0.799981688894314\"/>\n          </patternFill>\n        </fill>\n      </dxf>\n      <dxf>\n        <fill>\n          <patternFill patternType=\"solid\">\n            <fgColor theme=\"4\" tint=\"0.799981688894314\"/>\n            <bgColor theme=\"4\" tint=\"0.799981688894314\"/>\n          </patternFill>\n        </fill>\n      </dxf>\n      <dxf>\n        <font>\n          <b val=\"1\"/>\n          <color theme=\"1\"/>\n        </font>\n        <fill>\n          <patternFill patternType=\"solid\">\n            <fgColor theme=\"4\" tint=\"0.799981688894314\"/>\n            <bgColor theme=\"4\" tint=\"0.799981688894314\"/>\n          </patternFill>\n        </fill>\n        <border>\n          <top style=\"thin\">\n            <color theme=\"4\" tint=\"0.399975585192419\"/>\n          </top>\n          <bottom style=\"thin\">\n            <color theme=\"4\" tint=\"0.399975585192419\"/>\n          </bottom>\n        </border>\n      </dxf>\n      <dxf>\n        <font>\n          <b val=\"1\"/>\n          <color theme=\"1\"/>\n        </font>\n        <fill>\n          <patternFill patternType=\"solid\">\n            <fgColor theme=\"4\" tint=\"0.799981688894314\"/>\n            <bgColor theme=\"4\" tint=\"0.799981688894314\"/>\n          </patternFill>\n        </fill>\n        <border>\n          <bottom style=\"thin\">\n            <color theme=\"4\" tint=\"0.399975585192419\"/>\n          </bottom>\n        </border>\n      </dxf>\n    </dxfs>\n    <tableStyles count=\"2\" defaultTableStyle=\"TableStylePreset3_Accent1\" defaultPivotStyle=\"PivotStylePreset2_Accent1\">\n      <tableStyle name=\"TableStylePreset3_Accent1\" pivot=\"0\" count=\"7\" xr9:uid=\"{59DB682C-5494-4EDE-A608-00C9E5F0F923}\">\n        <tableStyleElement type=\"wholeTable\" dxfId=\"6\"/>\n        <tableStyleElement type=\"headerRow\" dxfId=\"5\"/>\n        <tableStyleElement type=\"totalRow\" dxfId=\"4\"/>\n        <tableStyleElement type=\"firstColumn\" dxfId=\"3\"/>\n        <tableStyleElement type=\"lastColumn\" dxfId=\"2\"/>\n        <tableStyleElement type=\"firstRowStripe\" dxfId=\"1\"/>\n        <tableStyleElement type=\"firstColumnStripe\" dxfId=\"0\"/>\n      </tableStyle>\n      <tableStyle name=\"PivotStylePreset2_Accent1\" table=\"0\" count=\"10\" xr9:uid=\"{267968C8-6FFD-4C36-ACC1-9EA1FD1885CA}\">\n        <tableStyleElement type=\"headerRow\" dxfId=\"16\"/>\n        <tableStyleElement type=\"totalRow\" dxfId=\"15\"/>\n        <tableStyleElement type=\"firstRowStripe\" dxfId=\"14\"/>\n        <tableStyleElement type=\"firstColumnStripe\" dxfId=\"13\"/>\n        <tableStyleElement type=\"firstSubtotalRow\" dxfId=\"12\"/>\n        <tableStyleElement type=\"secondSubtotalRow\" dxfId=\"11\"/>\n        <tableStyleElement type=\"firstRowSubheading\" dxfId=\"10\"/>\n        <tableStyleElement type=\"secondRowSubheading\" dxfId=\"9\"/>\n        <tableStyleElement type=\"pageFieldLabels\" dxfId=\"8\"/>\n        <tableStyleElement type=\"pageFieldValues\" dxfId=\"7\"/>\n      </tableStyle>\n    </tableStyles>\n    <extLst>\n      <ext uri=\"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}\"\n        xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\">\n        <x14:slicerStyles defaultSlicerStyle=\"SlicerStyleLight1\"/>\n      </ext>\n    </extLst>\n  </styleSheet>`;\n  return result;\n}\nexport const getContentTypeXml = (extra: string) => {\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">\n            <Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>\n            <Default Extension=\"xml\" ContentType=\"application/xml\"/>\n            <Override PartName=\"/docProps/app.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.extended-properties+xml\"/>\n            <Override PartName=\"/docProps/core.xml\" ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\"/>\n            <Override PartName=\"/docProps/custom.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.custom-properties+xml\"/>\n            <Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\"/>\n            <Override PartName=\"/xl/theme/theme1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\"/>\n            <Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\"/>\n            ${extra}\n          </Types>`;\n};\nexport const REFS = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>\n<Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Target=\"docProps/core.xml\"/>\n<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Target=\"docProps/app.xml\"/>\n<Relationship Id=\"rId4\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties\" Target=\"docProps/custom.xml\"/>\n</Relationships>`;\nexport const THEME1_XML = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"WPS\">\n  <a:themeElements>\n    <a:clrScheme name=\"WPS\">\n      <a:dk1>\n        <a:sysClr val=\"windowText\" lastClr=\"000000\"/>\n      </a:dk1>\n      <a:lt1>\n        <a:sysClr val=\"window\" lastClr=\"FFFFFF\"/>\n      </a:lt1>\n      <a:dk2>\n        <a:srgbClr val=\"44546A\"/>\n      </a:dk2>\n      <a:lt2>\n        <a:srgbClr val=\"E7E6E6\"/>\n      </a:lt2>\n      <a:accent1>\n        <a:srgbClr val=\"4874CB\"/>\n      </a:accent1>\n      <a:accent2>\n        <a:srgbClr val=\"EE822F\"/>\n      </a:accent2>\n      <a:accent3>\n        <a:srgbClr val=\"F2BA02\"/>\n      </a:accent3>\n      <a:accent4>\n        <a:srgbClr val=\"75BD42\"/>\n      </a:accent4>\n      <a:accent5>\n        <a:srgbClr val=\"30C0B4\"/>\n      </a:accent5>\n      <a:accent6>\n        <a:srgbClr val=\"E54C5E\"/>\n      </a:accent6>\n      <a:hlink>\n        <a:srgbClr val=\"0026E5\"/>\n      </a:hlink>\n      <a:folHlink>\n        <a:srgbClr val=\"7E1FAD\"/>\n      </a:folHlink>\n    </a:clrScheme>\n    <a:fontScheme name=\"WPS\">\n      <a:majorFont>\n        <a:latin typeface=\"Calibri Light\"/>\n        <a:ea typeface=\"\"/>\n        <a:cs typeface=\"\"/>\n        <a:font script=\"Jpan\" typeface=\"\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF\"/>\n        <a:font script=\"Hang\" typeface=\"\uB9D1\uC740 \uACE0\uB515\"/>\n        <a:font script=\"Hans\" typeface=\"\u5B8B\u4F53\"/>\n        <a:font script=\"Hant\" typeface=\"\u65B0\u7D30\u660E\u9AD4\"/>\n        <a:font script=\"Arab\" typeface=\"Times New Roman\"/>\n        <a:font script=\"Hebr\" typeface=\"Times New Roman\"/>\n        <a:font script=\"Thai\" typeface=\"Tahoma\"/>\n        <a:font script=\"Ethi\" typeface=\"Nyala\"/>\n        <a:font script=\"Beng\" typeface=\"Vrinda\"/>\n        <a:font script=\"Gujr\" typeface=\"Shruti\"/>\n        <a:font script=\"Khmr\" typeface=\"MoolBoran\"/>\n        <a:font script=\"Knda\" typeface=\"Tunga\"/>\n        <a:font script=\"Guru\" typeface=\"Raavi\"/>\n        <a:font script=\"Cans\" typeface=\"Euphemia\"/>\n        <a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>\n        <a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>\n        <a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>\n        <a:font script=\"Thaa\" typeface=\"MV Boli\"/>\n        <a:font script=\"Deva\" typeface=\"Mangal\"/>\n        <a:font script=\"Telu\" typeface=\"Gautami\"/>\n        <a:font script=\"Taml\" typeface=\"Latha\"/>\n        <a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>\n        <a:font script=\"Orya\" typeface=\"Kalinga\"/>\n        <a:font script=\"Mlym\" typeface=\"Kartika\"/>\n        <a:font script=\"Laoo\" typeface=\"DokChampa\"/>\n        <a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>\n        <a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>\n        <a:font script=\"Viet\" typeface=\"Times New Roman\"/>\n        <a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>\n        <a:font script=\"Geor\" typeface=\"Sylfaen\"/>\n      </a:majorFont>\n      <a:minorFont>\n        <a:latin typeface=\"Calibri\"/>\n        <a:ea typeface=\"\"/>\n        <a:cs typeface=\"\"/>\n        <a:font script=\"Jpan\" typeface=\"\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF\"/>\n        <a:font script=\"Hang\" typeface=\"\uB9D1\uC740 \uACE0\uB515\"/>\n        <a:font script=\"Hans\" typeface=\"\u5B8B\u4F53\"/>\n        <a:font script=\"Hant\" typeface=\"\u65B0\u7D30\u660E\u9AD4\"/>\n        <a:font script=\"Arab\" typeface=\"Arial\"/>\n        <a:font script=\"Hebr\" typeface=\"Arial\"/>\n        <a:font script=\"Thai\" typeface=\"Tahoma\"/>\n        <a:font script=\"Ethi\" typeface=\"Nyala\"/>\n        <a:font script=\"Beng\" typeface=\"Vrinda\"/>\n        <a:font script=\"Gujr\" typeface=\"Shruti\"/>\n        <a:font script=\"Khmr\" typeface=\"DaunPenh\"/>\n        <a:font script=\"Knda\" typeface=\"Tunga\"/>\n        <a:font script=\"Guru\" typeface=\"Raavi\"/>\n        <a:font script=\"Cans\" typeface=\"Euphemia\"/>\n        <a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>\n        <a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>\n        <a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>\n        <a:font script=\"Thaa\" typeface=\"MV Boli\"/>\n        <a:font script=\"Deva\" typeface=\"Mangal\"/>\n        <a:font script=\"Telu\" typeface=\"Gautami\"/>\n        <a:font script=\"Taml\" typeface=\"Latha\"/>\n        <a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>\n        <a:font script=\"Orya\" typeface=\"Kalinga\"/>\n        <a:font script=\"Mlym\" typeface=\"Kartika\"/>\n        <a:font script=\"Laoo\" typeface=\"DokChampa\"/>\n        <a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>\n        <a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>\n        <a:font script=\"Viet\" typeface=\"Arial\"/>\n        <a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>\n        <a:font script=\"Geor\" typeface=\"Sylfaen\"/>\n      </a:minorFont>\n    </a:fontScheme>\n    <a:fmtScheme name=\"WPS\">\n      <a:fillStyleLst>\n        <a:solidFill>\n          <a:schemeClr val=\"phClr\"/>\n        </a:solidFill>\n        <a:gradFill>\n          <a:gsLst>\n            <a:gs pos=\"0\">\n              <a:schemeClr val=\"phClr\">\n                <a:lumOff val=\"17500\"/>\n              </a:schemeClr>\n            </a:gs>\n            <a:gs pos=\"100000\">\n              <a:schemeClr val=\"phClr\"/>\n            </a:gs>\n          </a:gsLst>\n          <a:lin ang=\"2700000\" scaled=\"0\"/>\n        </a:gradFill>\n        <a:gradFill>\n          <a:gsLst>\n            <a:gs pos=\"0\">\n              <a:schemeClr val=\"phClr\">\n                <a:hueOff val=\"-2520000\"/>\n              </a:schemeClr>\n            </a:gs>\n            <a:gs pos=\"100000\">\n              <a:schemeClr val=\"phClr\"/>\n            </a:gs>\n          </a:gsLst>\n          <a:lin ang=\"2700000\" scaled=\"0\"/>\n        </a:gradFill>\n      </a:fillStyleLst>\n      <a:lnStyleLst>\n        <a:ln w=\"12700\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n          <a:solidFill>\n            <a:schemeClr val=\"phClr\"/>\n          </a:solidFill>\n          <a:prstDash val=\"solid\"/>\n          <a:miter lim=\"800000\"/>\n        </a:ln>\n        <a:ln w=\"12700\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n          <a:solidFill>\n            <a:schemeClr val=\"phClr\"/>\n          </a:solidFill>\n          <a:prstDash val=\"solid\"/>\n          <a:miter lim=\"800000\"/>\n        </a:ln>\n        <a:ln w=\"12700\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n          <a:gradFill>\n            <a:gsLst>\n              <a:gs pos=\"0\">\n                <a:schemeClr val=\"phClr\">\n                  <a:hueOff val=\"-4200000\"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos=\"100000\">\n                <a:schemeClr val=\"phClr\"/>\n              </a:gs>\n            </a:gsLst>\n            <a:lin ang=\"2700000\" scaled=\"1\"/>\n          </a:gradFill>\n          <a:prstDash val=\"solid\"/>\n          <a:miter lim=\"800000\"/>\n        </a:ln>\n      </a:lnStyleLst>\n      <a:effectStyleLst>\n        <a:effectStyle>\n          <a:effectLst>\n            <a:outerShdw blurRad=\"101600\" dist=\"50800\" dir=\"5400000\" algn=\"ctr\" rotWithShape=\"0\">\n              <a:schemeClr val=\"phClr\">\n                <a:alpha val=\"60000\"/>\n              </a:schemeClr>\n            </a:outerShdw>\n          </a:effectLst>\n        </a:effectStyle>\n        <a:effectStyle>\n          <a:effectLst>\n            <a:reflection stA=\"50000\" endA=\"300\" endPos=\"40000\" dist=\"25400\" dir=\"5400000\" sy=\"-100000\" algn=\"bl\" rotWithShape=\"0\"/>\n          </a:effectLst>\n        </a:effectStyle>\n        <a:effectStyle>\n          <a:effectLst>\n            <a:outerShdw blurRad=\"57150\" dist=\"19050\" dir=\"5400000\" algn=\"ctr\" rotWithShape=\"0\">\n              <a:srgbClr val=\"000000\">\n                <a:alpha val=\"63000\"/>\n              </a:srgbClr>\n            </a:outerShdw>\n          </a:effectLst>\n        </a:effectStyle>\n      </a:effectStyleLst>\n      <a:bgFillStyleLst>\n        <a:solidFill>\n          <a:schemeClr val=\"phClr\"/>\n        </a:solidFill>\n        <a:solidFill>\n          <a:schemeClr val=\"phClr\">\n            <a:tint val=\"95000\"/>\n            <a:satMod val=\"170000\"/>\n          </a:schemeClr>\n        </a:solidFill>\n        <a:gradFill rotWithShape=\"1\">\n          <a:gsLst>\n            <a:gs pos=\"0\">\n              <a:schemeClr val=\"phClr\">\n                <a:tint val=\"93000\"/>\n                <a:satMod val=\"150000\"/>\n                <a:shade val=\"98000\"/>\n                <a:lumMod val=\"102000\"/>\n              </a:schemeClr>\n            </a:gs>\n            <a:gs pos=\"50000\">\n              <a:schemeClr val=\"phClr\">\n                <a:tint val=\"98000\"/>\n                <a:satMod val=\"130000\"/>\n                <a:shade val=\"90000\"/>\n                <a:lumMod val=\"103000\"/>\n              </a:schemeClr>\n            </a:gs>\n            <a:gs pos=\"100000\">\n              <a:schemeClr val=\"phClr\">\n                <a:shade val=\"63000\"/>\n                <a:satMod val=\"120000\"/>\n              </a:schemeClr>\n            </a:gs>\n          </a:gsLst>\n          <a:lin ang=\"5400000\" scaled=\"0\"/>\n        </a:gradFill>\n      </a:bgFillStyleLst>\n    </a:fmtScheme>\n  </a:themeElements>\n  <a:objectDefaults/>\n</a:theme>`;\n\nexport const CUSTOM_XML = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\"\nxmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\">\n<property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"2\" name=\"ICV\">\n  <vt:lpwstr>A43D6FDBA27248266CF32D6511460B89_41</vt:lpwstr>\n</property>\n<property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"3\" name=\"KSOProductBuildVer\">\n  <vt:lpwstr>1033-6.2.1.8344</vt:lpwstr>\n</property>\n</Properties>`;\n", "import {\n  IController,\n  IRange,\n  StyleType,\n  EUnderLine,\n  EHorizontalAlign,\n  EVerticalAlign,\n  CustomHeightOrWidthItem,\n} from '@/types';\nimport {\n  convertToReference,\n  isEmpty,\n  NUMBER_FORMAT_LIST,\n  saveAs,\n  stringToCoordinate,\n  getCustomWidthOrHeightKey,\n  convertResultTypeToString,\n  convertColorToHex,\n} from '@/util';\nimport { XfItem, CUSTOM_WIdTH_RADIO } from './import';\nimport {\n  THEME1_XML,\n  getContentTypeXml,\n  REFS,\n  StyleData,\n  generateStyleFile,\n  CUSTOM_XML,\n  getCoreXML,\n} from './exportConstant';\n\nfunction getSheetData(\n  activeCell: IRange,\n  sheetData: string,\n  isActiveSheet: boolean,\n  customWidthMap: CustomHeightOrWidthItem,\n  sheetId: string,\n) {\n  let customWidth = '';\n  if (customWidthMap) {\n    const list: string[] = [];\n    for (const [key, value] of Object.entries(customWidthMap)) {\n      if (!key.startsWith(sheetId) || !value) {\n        continue;\n      }\n      const t = parseInt(key.slice(sheetId.length + 1), 10) + 1;\n      list.push(\n        `<col min=\"${t}\" max=\"${t}\" width=\"${\n          value.len / CUSTOM_WIdTH_RADIO\n        }\" customWidth=\"1\" ${value.isHide ? 'hidden=\"1\"' : ''}/>`,\n      );\n    }\n    customWidth = `<cols>${list.join('')}</cols>`;\n  }\n  const realActiveCell = {\n    ...activeCell,\n    sheetId: '',\n  };\n  const v = sheetData ? `<sheetData>${sheetData}</sheetData>` : '<sheetData/>';\n  const result = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n    <worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"\n      xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"\n      xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\"\n      xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\"\n      xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n      xmlns:etc=\"http://www.wps.cn/officeDocument/2017/etCustomData\">\n      <sheetPr/>\n      <dimension ref=\"A1:B1\"/>\n      <sheetViews>\n        <sheetView ${isActiveSheet ? 'tabSelected=\"1\"' : ''} workbookViewId=\"0\">\n          <selection activeCell=\"${convertToReference({\n            row: activeCell.row,\n            col: activeCell.col,\n            rowCount: 1,\n            colCount: 1,\n            sheetId: '',\n          })}\" sqref=\"${convertToReference(realActiveCell)}\"/>\n        </sheetView>\n      </sheetViews>\n      <sheetFormatPr defaultColWidth=\"9\" defaultRowHeight=\"16.8\" outlineLevelCol=\"1\"/>\n      ${customWidth}\n      ${v}\n      <pageMargins left=\"0.75\" right=\"0.75\" top=\"1\" bottom=\"1\" header=\"0.5\" footer=\"0.5\"/>\n      <headerFooter/>\n    </worksheet>`;\n  return result;\n}\n\n// TODO: convert color to rgb\nfunction convertColorToRGB(val: string) {\n  const t = convertColorToHex(val);\n  return `FF${t.slice(1, -2)}`;\n}\n\nfunction convertStyle(styles: StyleData, style: Partial<StyleType>) {\n  if (!style || isEmpty(style)) {\n    return;\n  }\n  const extraList: string[] = [];\n  const result: XfItem = {\n    fontId: '0',\n    fillId: '0',\n    numFmtId: '0',\n    applyAlignment: '',\n    applyFill: '',\n    applyFont: '',\n    applyNumberFormat: '',\n  };\n  if (style.fillColor) {\n    result.fillId = String(styles.fills.length);\n    extraList.push('applyFill=\"1\"');\n    styles.fills.push(`<fill>\n    <patternFill patternType=\"solid\">\n      <fgColor rgb=\"${convertColorToRGB(style.fillColor)}\"/>\n      <bgColor indexed=\"64\"/>\n    </patternFill>\n  </fill>`);\n  }\n  const fontList: string[] = [];\n  if (\n    style.underline === EUnderLine.SINGLE ||\n    style.underline === EUnderLine.DOUBLE\n  ) {\n    fontList.push('<u/>');\n  }\n  if (style.isBold) {\n    fontList.push('<b/>');\n  }\n  if (style.isItalic) {\n    fontList.push('<i/>');\n  }\n  if (style.isStrike) {\n    fontList.push('<strike/>');\n  }\n  if (typeof style.fontSize !== 'undefined') {\n    fontList.push(`<sz val=\"${style.fontSize}\"/>`);\n  }\n  if (style.fontColor) {\n    fontList.push(`<color rgb=\"${convertColorToRGB(style.fontColor)}\"/>`);\n  }\n  if (style.fontFamily) {\n    fontList.push(`<name val=\"${style.fontFamily}\"/>`);\n  }\n\n  if (fontList.length > 0) {\n    result.fontId = String(styles.fonts.length);\n    extraList.push('applyFont=\"1\"');\n    styles.fonts.push(\n      `<font>${fontList.join(\n        '',\n      )}<charset val=\"0\"/><scheme val=\"minor\"/></font>`,\n    );\n  }\n\n  const item = NUMBER_FORMAT_LIST.find((v) => v.id === style.numberFormat);\n  if (item) {\n    extraList.push('applyNumberFormat=\"1\"');\n    result.numFmtId = String(style.numberFormat);\n    styles.numFmts.push(\n      `<numFmt numFmtId=\"${style.numberFormat}\" formatCode=\"${item.formatCode}\"/>`,\n    );\n  }\n  let alignment = '<alignment vertical=\"center\"/>';\n  if (\n    style.isWrapText ||\n    style.horizontalAlign !== undefined ||\n    style.verticalAlign !== undefined\n  ) {\n    const list: string[] = [];\n    extraList.push('applyAlignment=\"1\"');\n    if (style.isWrapText) {\n      list.push('wrapText=\"1\"');\n    }\n    if (style.horizontalAlign !== undefined) {\n      const alignMap = {\n        [EHorizontalAlign.LEFT]: 'left',\n        [EHorizontalAlign.CENTER]: 'center',\n        [EHorizontalAlign.RIGHT]: 'right',\n      };\n      list.push(`horizontal=\"${alignMap[style.horizontalAlign]}\"`);\n    }\n    if (style.verticalAlign !== undefined) {\n      const alignMap = {\n        [EVerticalAlign.TOP]: 'top',\n        [EVerticalAlign.CENTER]: 'center',\n        [EVerticalAlign.BOTTOM]: 'bottom',\n      };\n      if (style.verticalAlign !== EVerticalAlign.BOTTOM) {\n        list.push(`vertical=\"${alignMap[style.verticalAlign]}\"`);\n      }\n    }\n    alignment = `<alignment ${list.join(' ')}/>`;\n  }\n\n  const t = `<xf numFmtId=\"${result.numFmtId}\" fontId=\"${\n    result.fontId\n  }\" fillId=\"${result.fillId}\" borderId=\"0\" xfId=\"0\" ${extraList.join(\n    ' ',\n  )}>${alignment}</xf>`;\n  styles.cellXfs.push(t);\n}\n\nexport async function exportToXLSX(fileName: string, controller: IController) {\n  const JSZip = (await import('jszip')).default;\n\n  const modelJson = controller.toJSON();\n  const currentSheetId = controller.getCurrentSheetId();\n  const sheetList = Object.values(modelJson.workbook);\n\n  const sheetRelMap: Record<string, { rid: string; target: string }> = {};\n  for (let i = 0; i < sheetList.length; i++) {\n    const t = sheetList[i];\n    const a = i + 1;\n    sheetRelMap[t.sheetId] = {\n      rid: `rId${a}`,\n      target: `sheet${a}.xml`,\n    };\n  }\n\n  const zip = new JSZip();\n  const contentTypeExtra = sheetList\n    .map(\n      (item) =>\n        `<Override PartName=\"/xl/worksheets/${\n          sheetRelMap[item.sheetId]!.target\n        }\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\"/>`,\n    )\n    .join('');\n  zip.file('[Content_Types].xml', getContentTypeXml(contentTypeExtra));\n\n  const rel = zip.folder('_rels')!;\n  rel.file('.rels', REFS);\n\n  const docProps = zip.folder('docProps')!;\n  docProps.file(\n    'app.xml',\n    `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\"\n  xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\">\n  <Application>WPS Spreadsheets</Application>\n  <HeadingPairs>\n    <vt:vector size=\"2\" baseType=\"variant\">\n      <vt:variant>\n        <vt:lpstr>\u5DE5\u4F5C\u8868</vt:lpstr>\n      </vt:variant>\n      <vt:variant>\n        <vt:i4>1</vt:i4>\n      </vt:variant>\n    </vt:vector>\n  </HeadingPairs>\n  <TitlesOfParts>\n    <vt:vector size=\"${sheetList.length}\" baseType=\"lpstr\">\n      ${sheetList\n        .map(\n          (item) => `<vt:lpstr>${sheetRelMap[item.sheetId].target}</vt:lpstr>`,\n        )\n        .join('')}\n    </vt:vector>\n  </TitlesOfParts>\n</Properties>`,\n  );\n  docProps.file('core.xml', getCoreXML());\n  docProps.file('custom.xml', CUSTOM_XML);\n\n  const xl = zip.folder('xl')!;\n  // TODO: export style\n  const styles: StyleData = {\n    cellXfs: [\n      `<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" xfId=\"0\">\n    <alignment vertical=\"center\"/>\n  </xf>`,\n    ],\n    numFmts: [],\n    fonts: [\n      `<font>\n    <sz val=\"11\"/>\n    <color theme=\"1\"/>\n    <name val=\"Calibri\"/>\n    <charset val=\"134\"/>\n    <scheme val=\"minor\"/>\n  </font>`,\n    ],\n    fills: [\n      `<fill>\n    <patternFill patternType=\"none\"/>\n  </fill>`,\n    ],\n  };\n\n  const activeIndex = sheetList.findIndex((v) => v.sheetId === currentSheetId);\n  const convertSheetIdToSheetName = (sheetId: string) => {\n    const id = sheetId || currentSheetId;\n    return sheetList.find((v) => v.sheetId === id)?.name || '';\n  };\n  const defineNames: string[] = [];\n  for (const name of Object.keys(modelJson.definedNames)) {\n    const range = modelJson.definedNames[name];\n    const text = convertToReference(\n      range,\n      'absolute',\n      convertSheetIdToSheetName,\n    );\n    defineNames.push(`<definedName name=\"${name}\">${text}</definedName>`);\n  }\n  const workbook = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n  <workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"\n    xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">\n    <fileVersion appName=\"xl\" lastEdited=\"3\" lowestEdited=\"5\" rupBuild=\"9302\"/>\n    <workbookPr/>\n    <bookViews>\n      <workbookView windowWidth=\"28800\" windowHeight=\"11340\" ${\n        activeIndex > 0 ? `activeTab=\"${activeIndex}\"` : ''\n      } />\n    </bookViews>\n    <sheets>\n      ${sheetList\n        .map(\n          (item) =>\n            `<sheet name=\"${item.name}\" sheetId=\"${item.sheetId}\" r:id=\"${\n              sheetRelMap[item.sheetId]!.rid\n            }\" ${item.isHide ? 'state=\"hidden\"' : ''}/>`,\n        )\n        .join('')}\n    </sheets>\n    ${\n      defineNames.length > 0\n        ? `<definedNames>${defineNames.join('')}</definedNames>`\n        : ''\n    }\n    <calcPr calcId=\"144525\"/>\n  </workbook>`;\n  xl.file('workbook.xml', workbook);\n\n  const xlRel = xl.folder('_rels')!;\n\n  const workbookRel = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n  <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n    <Relationship Id=\"rId${\n      sheetList.length + 2\n    }\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>\n    <Relationship Id=\"rId${\n      sheetList.length + 1\n    }\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"theme/theme1.xml\"/>\n    ${sheetList\n      .map((item) => {\n        const t = sheetRelMap[item.sheetId]!;\n        return `<Relationship Id=\"${t.rid}\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/${t.target}\"/>`;\n      })\n      .reverse()\n      .join('')}\n  </Relationships>`;\n  xlRel.file('workbook.xml.rels', workbookRel);\n\n  const theme = xl.folder('theme')!;\n  theme.file('theme1.xml', THEME1_XML);\n\n  const worksheets = xl.folder('worksheets')!;\n  for (const item of sheetList) {\n    const activeCell = modelJson.rangeMap[item.sheetId];\n    const t = sheetRelMap[item.sheetId];\n    const cellData = modelJson.worksheets[item.sheetId];\n    const isActiveSheet = item.sheetId === currentSheetId;\n    if (!cellData) {\n      worksheets.file(\n        t.target,\n        getSheetData(\n          activeCell,\n          '',\n          isActiveSheet,\n          modelJson.customWidth,\n          item.sheetId,\n        ),\n      );\n      continue;\n    }\n    const rowMap = new Map<number, string[]>();\n    const rowList: string[] = [];\n    for (const [key, v] of Object.entries(cellData)) {\n      const range = stringToCoordinate(key);\n      const ref = convertToReference({\n        ...range,\n        rowCount: 1,\n        colCount: 1,\n        sheetId: '',\n      });\n      const list = rowMap.get(range.row) || [];\n      const f = v.formula ? `<f>${v.formula.slice(1)}</f>` : '';\n      const val = f ? '' : `<v>${convertResultTypeToString(v.value)}</v>`;\n      let s = '';\n      if (v.style && !isEmpty(v.style)) {\n        s = `s=\"${styles.cellXfs.length}\"`;\n        convertStyle(styles, v.style);\n      }\n      list.push(`<c r=\"${ref}\" ${s}>${f}${val}</c>`);\n      rowMap.set(range.row, list);\n    }\n    const rowKeyList = Array.from(rowMap.keys());\n    rowKeyList.sort();\n\n    for (const row of rowKeyList) {\n      const customHeight =\n        modelJson.customHeight[getCustomWidthOrHeightKey(item.sheetId, row)];\n      let ht = '';\n      if (customHeight) {\n        ht = `ht=\"${customHeight.len}\" customHeight=\"1\" ${\n          customHeight.isHide ? 'hidden=\"1\"' : ''\n        }`;\n      }\n      rowList.push(\n        `<row r=\"${row + 1}\" ${ht}>${rowMap.get(row)!.join('')}</row>`,\n      );\n    }\n\n    worksheets.file(\n      t.target,\n      getSheetData(\n        activeCell,\n        rowList.join(''),\n        isActiveSheet,\n        modelJson.customWidth,\n        item.sheetId,\n      ),\n    );\n  }\n\n  xl.file('styles.xml', generateStyleFile(styles));\n\n  const blob = await zip.generateAsync({ type: 'blob' });\n  saveAs(blob, fileName);\n}\n", "import { IController, ResultType } from '@/types';\nimport { saveAs, coordinateToString } from '@/util';\n\nconst DELIMITER = ',';\nconst RECORD_DELIMITER = '\\n';\n\nfunction processItem(value: any) {\n  const type = typeof value;\n  if (type === 'string') {\n    return value;\n  } else if (type === 'bigint') {\n    return '' + value;\n  } else if (type === 'number') {\n    return '' + value;\n  } else if (type === 'boolean') {\n    return value ? 'TRUE' : 'FALSE';\n  } else if (value instanceof Date) {\n    return '' + value.getTime();\n  } else if (type === 'object' && value !== null) {\n    return JSON.stringify(value);\n  } else {\n    return '';\n  }\n}\n\nfunction processRow(row: ResultType[]) {\n  const quote = '\"';\n  const escape_formulas = false;\n  const quoted_string = false;\n  const escape = '\"';\n  const quoted = false;\n\n  let csvRecord = '';\n  for (let j = 0; j < row.length; j++) {\n    const field = row[j];\n    let value = processItem(field);\n    if ('' === value) {\n      csvRecord += value;\n    } else if (value) {\n      const containDelimiter =\n        DELIMITER.length && value.indexOf(DELIMITER) >= 0;\n      const containsQuote = value.indexOf(quote) >= 0;\n      const containsEscape = value.indexOf(escape) >= 0 && escape !== quote;\n      const containsRecordDelimiter = value.indexOf(RECORD_DELIMITER) >= 0;\n      const quotedString = quoted_string && typeof field === 'string';\n      if (escape_formulas) {\n        switch (value[0]) {\n          case '=':\n          case '+':\n          case '-':\n          case '@':\n          case '\\t':\n          case '\\r':\n          case '\\uFF1D': // Unicode '='\n          case '\\uFF0B': // Unicode '+'\n          case '\\uFF0D': // Unicode '-'\n          case '\\uFF20': // Unicode '@'\n            value = `'${value}`;\n            break;\n        }\n      }\n      const shouldQuote =\n        containsQuote === true ||\n        containDelimiter ||\n        containsRecordDelimiter ||\n        quoted ||\n        quotedString;\n      if (shouldQuote === true && containsEscape === true) {\n        const regexp = new RegExp(escape, 'g');\n        value = value.replace(regexp, escape + escape);\n      }\n      if (containsQuote === true) {\n        const regexp = new RegExp(quote, 'g');\n        value = value.replace(regexp, escape + quote);\n      }\n      if (shouldQuote === true) {\n        value = quote + value + quote;\n      }\n      csvRecord += value;\n    }\n    if (j !== row.length - 1) {\n      csvRecord += DELIMITER;\n    }\n  }\n  return csvRecord;\n}\nexport function exportToCsv(fileName: string, controller: IController) {\n  const sheetData =\n    controller.toJSON().worksheets[controller.getCurrentSheetId()];\n  const csvList: string[] = [];\n  const sheetInfo = controller.getSheetInfo(controller.getCurrentSheetId())!;\n  if (sheetData) {\n    for (let row = 0; row < sheetInfo.rowCount; row++) {\n      const list: ResultType[] = [];\n      for (let col = 0; col < sheetInfo.colCount; col++) {\n        const key = coordinateToString(row, col);\n        list.push(sheetData[key]?.value);\n      }\n      csvList.push(processRow(list));\n    }\n  }\n  const base = Array.from({ length: sheetInfo.colCount })\n    .fill('')\n    .join(DELIMITER);\n  // delete empty row\n  while (csvList.length > 0) {\n    if (csvList[csvList.length - 1] === base) {\n      csvList.pop();\n    } else {\n      break;\n    }\n  }\n  const blob = new Blob([csvList.join(RECORD_DELIMITER)], {\n    type: 'text/csv;charset=utf-8;',\n  });\n  saveAs(blob, fileName);\n}\n", ".menubar-container {\n  border-bottom: 1px solid var(--borderColor);\n  padding: var(--mediumPadding) var(--largePadding);\n  box-sizing: border-box;\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n}\n\n.menubar-menu {\n  flex: 1;\n}\n.theme-button {\n  margin-right: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.i18n {\n  margin: 0 var(--mediumPadding);\n}\n", "import React, { memo, useEffect, useState } from 'react';\nimport { Button, Icon } from '../components';\nimport styles from './index.module.css';\nimport { sizeConfig, darkColor, lightColor, setTheme, getTheme } from '@/util';\nimport { ThemeType } from '@/types';\n\ninterface Props {\n  toggleTheme: () => void;\n}\n\nfunction setCssVariable(data: Record<string, string | number>) {\n  const keyList = Object.keys(data);\n  for (const key of keyList) {\n    const name = `--${key}`;\n    const value = String(data[key] || '');\n    document.documentElement.style.setProperty(name, value);\n  }\n}\n\nfunction updateCssVariable(value: ThemeType) {\n  if (value === 'dark') {\n    setCssVariable(darkColor);\n  } else {\n    setCssVariable(lightColor);\n  }\n  document.documentElement.setAttribute('data-theme', value);\n}\n\nexport const Theme: React.FunctionComponent<Props> = memo(({ toggleTheme }) => {\n  const [themeData, setThemeData] = useState<ThemeType>('light');\n  useEffect(() => {\n    setCssVariable(sizeConfig);\n  }, []);\n  useEffect(() => {\n    const update = (c: ThemeType) => {\n      setThemeData(c);\n      setTheme(c);\n      updateCssVariable(c);\n      toggleTheme();\n    };\n    update(getTheme());\n    if (window.matchMedia && typeof window.matchMedia === 'function') {\n      window\n        .matchMedia('(prefers-color-scheme: dark)')\n        .addEventListener('change', (event) => {\n          const { matches: isDark } = event;\n          update(isDark ? 'dark' : 'light');\n        });\n    }\n  }, [toggleTheme]);\n\n  const handleClick = (old: ThemeType) => {\n    const n = old === 'dark' ? 'light' : 'dark';\n    updateCssVariable(n);\n    setTheme(n);\n    setThemeData(n);\n    toggleTheme();\n  };\n  return (\n    <div>\n      <Button\n        onClick={() => handleClick(themeData)}\n        className={styles['theme-button']}\n      >\n        <Icon name={themeData === 'dark' ? 'sun' : 'moon'} />\n      </Button>\n    </div>\n  );\n});\n", "import React from 'react';\nimport { Select } from '../components';\nimport { OptionItem, LanguageType } from '@/types';\nimport { LANGUAGE_LIST } from '@/util';\nimport styles from './index.module.css';\nimport { getLanguage, setLanguage } from '@/i18n';\n\nconst dataList: OptionItem[] = LANGUAGE_LIST.map((v) => ({\n  value: v,\n  label: v,\n  disabled: false,\n}));\nconst defaultValue = getLanguage();\n\nexport const I18N: React.FunctionComponent = () => {\n  const handleChange = (c: string | number) => {\n    const l = String(c) as LanguageType;\n    setLanguage(l);\n    window.location.reload();\n  };\n  return (\n    <div className={styles.i18n}>\n      <Select\n        data={dataList}\n        defaultValue={defaultValue}\n        onChange={handleChange}\n      ></Select>\n    </div>\n  );\n};\n", "import { App } from './containers';\nimport './global.css';\nimport { createRoot } from 'react-dom/client';\nimport React, { StrictMode } from 'react';\nimport { initController } from '@/controller';\nimport { MOCK_MODEL } from '@/model';\nimport { allFormulas } from './formula';\n\nfunction initSentry() {\n  if (location.hostname === 'localhost') {\n    return;\n  }\n  import('@sentry/react').then((sentry) => {\n    sentry.init({\n      dsn: 'https://b292d91ba509038c141ecfc7d10e7bb7@o4506851168092160.ingest.sentry.io/4506851171041280',\n      integrations: [\n        sentry.browserTracingIntegration(),\n        sentry.replayIntegration({\n          maskAllText: false,\n          blockAllMedia: false,\n        }),\n      ],\n      // Performance Monitoring\n      tracesSampleRate: 1.0, //  Capture 100% of the transactions\n      // Set 'tracePropagationTargets' to control for which URLs distributed tracing should be enabled\n      tracePropagationTargets: ['nusr.github.io'],\n      // Session Replay\n      replaysSessionSampleRate: 0.1, // This sets the sample rate at 10%. You may want to change it to 100% while in development and then sample at a lower rate in production.\n      replaysOnErrorSampleRate: 1.0, // If you're not already sampling the entire session, change the sample rate to 100% when sampling sessions where errors occur.\n    });\n  });\n}\n\nfunction initExcel(rootId = 'root') {\n  const domNode = document.getElementById(rootId)!;\n  const controller = initController();\n  const root = createRoot(domNode);\n  root.render(\n    <StrictMode>\n      <App controller={controller} />\n    </StrictMode>,\n  );\n  return controller;\n}\n\nexport default { initExcel, defaultModel: MOCK_MODEL, initSentry, allFormulas };\n", "import {\n  WorkBookJSON,\n  StyleType,\n  ChangeEventType,\n  IController,\n  IHooks,\n  IModel,\n  WorksheetType,\n  IWindowSize,\n  CanvasOverlayPosition,\n  ScrollValue,\n  IRange,\n  ResultType,\n  ClipboardData,\n  ClipboardType,\n  MainDom,\n  FloatElement,\n  IPosition,\n} from '@/types';\nimport {\n  controllerLog,\n  Range,\n  PLAIN_FORMAT,\n  HTML_FORMAT,\n  generateHTML,\n  convertToCssString,\n  containRange,\n  parseHTML,\n  generateUUID,\n  sizeConfig,\n} from '@/util';\n\nconst ROW_TITLE_HEIGHT = 24;\nconst COL_TITLE_WIDTH = 34;\n\nconst defaultScrollValue: ScrollValue = {\n  top: 0,\n  left: 0,\n  row: 0,\n  col: 0,\n  scrollLeft: 0,\n  scrollTop: 0,\n};\n\nexport class Controller implements IController {\n  private scrollValue: Record<string, ScrollValue> = {};\n  private model: IModel;\n  private changeSet = new Set<ChangeEventType>();\n  private copyRanges: IRange[] = []; // cut or copy ranges\n  private isCut = false; // cut or copy\n  private floatElementUuid = '';\n  private hooks: IHooks = {\n    modelChange() {},\n    async copyOrCut() {\n      return '';\n    },\n    async paste() {\n      return {\n        [HTML_FORMAT]: '',\n        [PLAIN_FORMAT]: '',\n      };\n    },\n  };\n  // sheet size\n  private viewSize = {\n    width: 0,\n    height: 0,\n  };\n  private headerSize = {\n    width: COL_TITLE_WIDTH,\n    height: ROW_TITLE_HEIGHT,\n  };\n  private mainDom: MainDom = {};\n  constructor(model: IModel) {\n    this.model = model;\n  }\n  getCurrentSheetId(): string {\n    return this.model.getCurrentSheetId();\n  }\n  getSheetList(): WorksheetType[] {\n    return this.model.getSheetList();\n  }\n  getSheetInfo(sheetId: string) {\n    return this.model.getSheetInfo(sheetId);\n  }\n  setHooks(hooks: IHooks): void {\n    this.hooks = hooks;\n  }\n  private emitChange(): void {\n    if (this.changeSet.size === 0) {\n      return;\n    }\n    this.computeViewSize();\n    const result = this.changeSet;\n    this.changeSet = new Set<ChangeEventType>();\n    controllerLog(result);\n    this.model.emitChange(result);\n    this.hooks.modelChange(result);\n  }\n  getActiveCell(): IRange {\n    const range = this.model.getActiveCell();\n    return range;\n  }\n  private getRange(range: IRange) {\n    const mergeCells = this.getMergeCells(this.getCurrentSheetId());\n    if (mergeCells.length === 0) {\n      return {\n        range,\n        isMerged: false,\n      };\n    }\n\n    for (const item of mergeCells) {\n      if (containRange(range.row, range.col, item)) {\n        const newRange = {\n          ...item,\n          sheetId: item.sheetId || this.getCurrentSheetId(),\n        };\n        return {\n          range: newRange,\n          isMerged: true,\n        };\n      }\n    }\n\n    return {\n      range,\n      isMerged: false,\n    };\n  }\n  getActiveRange() {\n    const range = this.getActiveCell();\n    return this.getRange(range);\n  }\n  setNextActiveCell(direction: 'left' | 'right' | 'down' | 'up'): IRange {\n    const range = this.getActiveCell();\n    let startCol = range.col;\n    let startRow = range.row;\n    const sheetInfo = this.getSheetInfo(range.sheetId)!;\n    const mergeCells = this.getMergeCells(range.sheetId);\n    const result = {\n      ...range,\n    };\n    if (direction === 'left') {\n      startCol--;\n      // eslint-disable-next-line no-constant-condition\n      while (1) {\n        let check1 = false;\n        let check2 = false;\n        for (const item of mergeCells) {\n          if (startCol >= item.col && startCol < item.col + item.colCount) {\n            startCol = Math.min(startCol, item.col - 1);\n            check1 = true;\n            break;\n          }\n        }\n        while (startCol > 0 && this.getColWidth(startCol).len <= 0) {\n          startCol--;\n          check2 = true;\n        }\n        if (startCol <= 0) {\n          startCol = 0;\n          break;\n        }\n        if (!check2 && !check1) {\n          break;\n        }\n      }\n      result.col = startCol;\n    }\n    if (direction === 'right') {\n      startCol++;\n      // eslint-disable-next-line no-constant-condition\n      while (1) {\n        let check1 = false;\n        let check2 = false;\n        for (const item of mergeCells) {\n          if (startCol >= item.col && startCol < item.col + item.colCount) {\n            startCol = Math.max(startCol, item.col + item.colCount);\n            check1 = true;\n            break;\n          }\n        }\n        while (\n          startCol < sheetInfo.colCount &&\n          this.getColWidth(startCol).len <= 0\n        ) {\n          startCol++;\n          check2 = true;\n        }\n        if (startCol >= sheetInfo.colCount - 1) {\n          startCol = sheetInfo.colCount - 1;\n          break;\n        }\n        if (!check2 && !check1) {\n          break;\n        }\n      }\n      result.col = startCol;\n    }\n    if (direction === 'up') {\n      startRow--;\n      // eslint-disable-next-line no-constant-condition\n      while (1) {\n        let check1 = false;\n        let check2 = false;\n        for (const item of mergeCells) {\n          if (startRow >= item.row && startRow < item.row + item.rowCount) {\n            startRow = Math.min(startRow, item.row - 1);\n            check1 = true;\n            break;\n          }\n        }\n        while (startRow > 0 && this.getColWidth(startRow).len <= 0) {\n          startRow--;\n          check2 = true;\n        }\n        if (startRow <= 0) {\n          startRow = 0;\n          break;\n        }\n        if (!check2 && !check1) {\n          break;\n        }\n      }\n      result.row = startRow;\n    }\n    if (direction === 'down') {\n      startRow++;\n      // eslint-disable-next-line no-constant-condition\n      while (1) {\n        let check1 = false;\n        let check2 = false;\n        for (const item of mergeCells) {\n          if (startRow >= item.row && startRow < item.row + item.rowCount) {\n            startRow = Math.max(startRow, item.row + item.rowCount);\n            check1 = true;\n            break;\n          }\n        }\n        while (\n          startRow < sheetInfo.rowCount &&\n          this.getColWidth(startRow).len <= 0\n        ) {\n          startRow++;\n          check2 = true;\n        }\n        if (startRow >= sheetInfo.rowCount - 1) {\n          startRow = sheetInfo.rowCount - 1;\n          break;\n        }\n        if (!check2 && !check1) {\n          break;\n        }\n      }\n      result.row = startRow;\n    }\n    const temp = this.getRange(result).range;\n    this.setActiveCell(temp);\n    return temp;\n  }\n  private setSheetCell(range: IRange) {\n    const id = range.sheetId || this.model.getCurrentSheetId();\n    range.sheetId = id;\n    this.model.setActiveCell(range);\n    this.changeSet.add('range');\n  }\n  setActiveCell(range: IRange): void {\n    this.setSheetCell(range);\n    this.emitChange();\n  }\n  setCurrentSheetId(id: string): void {\n    if (id === this.getCurrentSheetId()) {\n      return;\n    }\n\n    this.model.setCurrentSheetId(id);\n    this.changeSet.add('sheetId');\n    this.changeSet.add('cellValue');\n\n    const pos = this.getActiveCell();\n    this.setSheetCell(pos);\n    this.setScroll(this.getScroll());\n  }\n  addSheet = (): void => {\n    this.changeSet.add('sheetList');\n    this.changeSet.add('range');\n    this.model.addSheet();\n    this.setScroll({\n      top: 0,\n      left: 0,\n      row: 0,\n      col: 0,\n      scrollLeft: 0,\n      scrollTop: 0,\n    });\n  };\n  deleteSheet = (sheetId?: string): void => {\n    this.model.deleteSheet(sheetId);\n    this.changeSet.add('sheetList');\n    this.changeSet.add('sheetId');\n    this.changeSet.add('range');\n    this.emitChange();\n  };\n  setTabColor(color: string, sheetId?: string) {\n    this.model.setTabColor(color, sheetId);\n    this.changeSet.add('sheetList');\n    this.emitChange();\n  }\n  hideSheet(sheetId?: string | undefined): void {\n    this.model.hideSheet(sheetId);\n    this.changeSet.add('sheetList');\n    this.changeSet.add('sheetId');\n    this.changeSet.add('range');\n    this.emitChange();\n  }\n  unhideSheet(sheetId?: string | undefined): void {\n    this.model.unhideSheet(sheetId);\n    this.changeSet.add('sheetList');\n    this.changeSet.add('sheetId');\n    this.changeSet.add('range');\n    this.emitChange();\n  }\n  renameSheet(sheetName: string, sheetId?: string | undefined): void {\n    this.model.renameSheet(sheetName, sheetId);\n    this.changeSet.add('sheetList');\n    this.emitChange();\n  }\n  fromJSON(json: WorkBookJSON): void {\n    this.model.fromJSON(json);\n    this.changeSet.add('sheetList');\n    this.changeSet.add('sheetId');\n    this.changeSet.add('range');\n    this.changeSet.add('floatElement');\n    this.changeSet.add('cellValue');\n    this.setSheetCell(this.getActiveCell());\n    this.emitChange();\n  }\n  toJSON(): WorkBookJSON {\n    return this.model.toJSON();\n  }\n\n  setCellValues(\n    value: ResultType[][],\n    style: Array<Array<Partial<StyleType>>>,\n    ranges: IRange[],\n  ): void {\n    this.model.setCellValues(value, style, ranges);\n    this.changeSet.add('cellValue');\n    this.emitChange();\n  }\n  updateCellStyle(style: Partial<StyleType>, ranges: IRange[]): void {\n    this.model.updateCellStyle(style, ranges);\n    this.changeSet.add('cellStyle');\n    this.emitChange();\n  }\n  getCell = (range: IRange) => {\n    const result = this.model.getCell(range);\n    return result;\n  };\n  canRedo(): boolean {\n    return this.model.canRedo();\n  }\n  canUndo(): boolean {\n    return this.model.canUndo();\n  }\n  undo() {\n    this.model.undo();\n    this.changeSet.add('range');\n    this.changeSet.add('sheetList');\n    this.changeSet.add('sheetId');\n    this.changeSet.add('scroll');\n    this.changeSet.add('floatElement');\n    this.changeSet.add('cellValue');\n    this.changeSet.add('undoRedo');\n    this.emitChange();\n  }\n  redo() {\n    this.model.redo();\n    this.changeSet.add('range');\n    this.changeSet.add('sheetList');\n    this.changeSet.add('sheetId');\n    this.changeSet.add('scroll');\n    this.changeSet.add('floatElement');\n    this.changeSet.add('cellValue');\n    this.changeSet.add('undoRedo');\n    this.emitChange();\n  }\n  getColWidth(col: number, sheetId?: string) {\n    return this.model.getColWidth(col, sheetId);\n  }\n  setColWidth(\n    col: number,\n    width: number,\n    isChanged: boolean,\n    sheetId?: string,\n  ): void {\n    this.model.setColWidth(col, width, isChanged, sheetId);\n    this.changeSet.add('col');\n    if (isChanged) {\n      this.emitChange();\n    }\n  }\n  getRowHeight(row: number, sheetId?: string) {\n    return this.model.getRowHeight(row, sheetId);\n  }\n  setRowHeight(\n    row: number,\n    height: number,\n    isChanged: boolean,\n    sheetId?: string,\n  ) {\n    this.model.setRowHeight(row, height, isChanged, sheetId);\n    this.changeSet.add('row');\n    if (isChanged) {\n      this.emitChange();\n    }\n  }\n  private computeViewSize() {\n    const headerSize = this.getHeaderSize();\n    const sheetInfo = this.model.getSheetInfo(this.model.getCurrentSheetId());\n    if (!sheetInfo) {\n      return;\n    }\n    let { width } = headerSize;\n    let { height } = headerSize;\n    for (let i = 0; i < sheetInfo.colCount; i++) {\n      width += this.getColWidth(i).len;\n    }\n    for (let i = 0; i < sheetInfo.rowCount; i++) {\n      height += this.getRowHeight(i).len;\n    }\n    this.viewSize = {\n      width,\n      height,\n    };\n  }\n  getViewSize() {\n    return {\n      ...this.viewSize,\n    };\n  }\n  getCellSize(range: IRange): IWindowSize {\n    range.sheetId = range.sheetId || this.getCurrentSheetId();\n    return this.getRangeSize(range);\n  }\n  private getRangeSize(range: IRange) {\n    const { row, col, colCount, rowCount } = range;\n    const sheetId = range.sheetId || this.getCurrentSheetId();\n    if (colCount === 0 || rowCount === 0) {\n      return {\n        width: this.getColWidth(col, sheetId).len,\n        height: this.getRowHeight(row, sheetId).len,\n      };\n    }\n\n    let width = 0;\n    let height = 0;\n    for (let r = row, endRow = row + rowCount; r < endRow; r++) {\n      height += this.getRowHeight(r, sheetId).len;\n    }\n    for (let c = col, endCol = col + colCount; c < endCol; c++) {\n      width += this.getColWidth(c, sheetId).len;\n    }\n    return { width, height };\n  }\n  getHeaderSize() {\n    return {\n      ...this.headerSize,\n    };\n  }\n  computeCellPosition(range: IRange): IPosition {\n    const { row, col } = range;\n    const sheetId = range.sheetId || this.model.getCurrentSheetId();\n    const size = this.getHeaderSize();\n    const scroll = this.getScroll(sheetId);\n\n    let resultX = size.width;\n    let resultY = size.height;\n    let r = scroll.row;\n    let c = scroll.col;\n    if (col >= scroll.col) {\n      while (c < col) {\n        resultX += this.getColWidth(c, sheetId).len;\n        c++;\n      }\n    } else {\n      resultX = -size.width;\n      while (c > col) {\n        resultX -= this.getColWidth(c, sheetId).len;\n        c--;\n      }\n    }\n    if (row >= scroll.row) {\n      while (r < row) {\n        resultY += this.getRowHeight(r, sheetId).len;\n        r++;\n      }\n    } else {\n      resultY = -size.height;\n      while (r > row) {\n        resultY -= this.getRowHeight(r, sheetId).len;\n        r--;\n      }\n    }\n    return {\n      top: resultY,\n      left: resultX,\n    };\n  }\n\n  addRow(rowIndex: number, count: number): void {\n    this.model.addRow(rowIndex, count);\n    this.changeSet.add('row');\n    this.emitChange();\n  }\n  addCol(colIndex: number, count: number): void {\n    this.model.addCol(colIndex, count);\n    this.changeSet.add('col');\n    this.emitChange();\n  }\n  deleteCol(colIndex: number, count: number): void {\n    this.model.deleteCol(colIndex, count);\n    this.changeSet.add('col');\n    this.emitChange();\n  }\n  deleteRow(rowIndex: number, count: number): void {\n    this.model.deleteRow(rowIndex, count);\n    this.changeSet.add('row');\n    this.emitChange();\n  }\n  hideCol(colIndex: number, count: number): void {\n    this.model.hideCol(colIndex, count);\n    this.changeSet.add('col');\n    this.emitChange();\n  }\n  hideRow(rowIndex: number, count: number): void {\n    this.model.hideRow(rowIndex, count);\n    this.changeSet.add('row');\n    this.emitChange();\n  }\n  getChangeSet(): Set<ChangeEventType> {\n    const result = this.changeSet;\n    this.changeSet = new Set<ChangeEventType>();\n    return result;\n  }\n  setChangeSet(data: Set<ChangeEventType>) {\n    this.changeSet = data;\n    this.emitChange();\n  }\n  getScroll(sheetId?: string): ScrollValue {\n    const id = sheetId || this.model.getCurrentSheetId();\n    const result = this.scrollValue[id] || { ...defaultScrollValue };\n    return { ...result };\n  }\n  setScroll(data: ScrollValue): void {\n    const sheetId = this.model.getCurrentSheetId();\n    this.scrollValue[sheetId] = {\n      ...data,\n    };\n    if (data.row > 9999) {\n      this.headerSize = {\n        width: Math.floor(COL_TITLE_WIDTH * 2),\n        height: ROW_TITLE_HEIGHT,\n      };\n    } else {\n      this.headerSize = {\n        width: COL_TITLE_WIDTH,\n        height: ROW_TITLE_HEIGHT,\n      };\n    }\n    this.changeSet.add('scroll');\n    this.emitChange();\n  }\n  private parseText(text: string) {\n    let list: string[][];\n    if (text.indexOf('\\r\\n') > -1) {\n      list = text\n        .split('\\r\\n')\n        .map((item) => item)\n        .map((item) => item.split('\\t'));\n    } else {\n      list = text\n        .split('\\n')\n        .map((item) => item)\n        .map((item) => item.split('\\t'));\n    }\n    if (list[0].length !== list[list.length - 1].length) {\n      // delete last empty cell\n      const last = list[list.length - 1];\n      if (last.length === 1 && !last[0]) {\n        list.pop();\n      }\n    }\n    const rowCount = list.length;\n    let colCount = 0;\n    for (const item of list) {\n      if (item.length > colCount) {\n        colCount = item.length;\n      }\n    }\n    const activeCell = this.getActiveCell();\n    return {\n      value: list,\n      style: [],\n      range: {\n        ...activeCell,\n        rowCount,\n        colCount,\n      },\n    };\n  }\n  private parseHTML(htmlString: string) {\n    const { textList, styleList } = parseHTML(htmlString);\n    const rowCount = textList.length;\n    const activeCell = this.getActiveCell();\n    const colCount = Math.max(...textList.map((v) => v.length));\n    return {\n      value: textList,\n      style: styleList,\n      range: {\n        ...activeCell,\n        rowCount,\n        colCount,\n      },\n    };\n  }\n  private getCopyData(): ClipboardData {\n    const activeCell = this.getActiveCell();\n    const { row, col, rowCount, colCount } = activeCell;\n    const result: ResultType[][] = [];\n    const html: string[][] = [];\n    let index = 1;\n    const classList: string[] = [];\n    const currentSheetId = this.model.getCurrentSheetId();\n    for (let r = row, endRow = row + rowCount; r < endRow; r++) {\n      const temp: ResultType[] = [];\n      const t: string[] = [];\n      for (let c = col, endCol = col + colCount; c < endCol; c++) {\n        const a = this.model.getCell(new Range(r, c, 1, 1, currentSheetId));\n        if (!a) {\n          continue;\n        }\n        const str = String(a.value || '');\n        temp.push(str);\n        if (a.style) {\n          let text = convertToCssString(a.style);\n          if (!str) {\n            // copy background-color\n            text += 'mso-pattern:black none;';\n          }\n          const className = `xl${index++}`;\n          classList.push(`.${className}{${text}}`);\n          t.push(`<td class=\"${className}\"> ${str} </td>`);\n        } else {\n          t.push(`<td> ${str} </td>`);\n        }\n      }\n      result.push(temp);\n      html.push(t);\n    }\n    const htmlData = generateHTML(\n      classList.join('\\n'),\n      html.map((item) => `<tr>${item.join('\\n')}</tr>`).join('\\n'),\n    );\n    const text = `${result.map((item) => item.join('\\t')).join('\\r\\n')}\\r\\n`;\n    return {\n      [PLAIN_FORMAT]: text,\n      [HTML_FORMAT]: htmlData,\n    };\n  }\n  paste(event?: ClipboardEvent) {\n    if (this.floatElementUuid) {\n      if (this.isCut) {\n        const uuid = this.floatElementUuid;\n        const range = this.getActiveCell();\n\n        this.model.updateFloatElement(uuid, {\n          fromCol: range.col,\n          fromRow: range.row,\n          marginX: 0,\n          marginY: 0,\n        });\n        this.changeSet.add('floatElement');\n        this.copyRanges = [];\n        this.isCut = false;\n        this.floatElementUuid = '';\n        this.emitChange();\n      } else {\n        const list = this.getFloatElementList(this.getCurrentSheetId());\n        const item = list.find((v) => v.uuid === this.floatElementUuid);\n        if (item) {\n          const size = this.getCellSize({\n            row: item.fromRow,\n            col: item.fromCol,\n            rowCount: 1,\n            colCount: 1,\n            sheetId: item.sheetId,\n          });\n          let { marginX, marginY } = item;\n          const offset = 14;\n          if (marginX + offset < size.width) {\n            marginX += offset;\n          } else if (marginX - offset >= 0) {\n            marginX -= offset;\n          }\n          if (marginY + offset < size.width) {\n            marginY += offset;\n          } else if (marginY - offset >= 0) {\n            marginY -= offset;\n          }\n          this.addFloatElement({\n            ...item,\n            uuid: generateUUID(),\n            marginX,\n            marginY,\n          });\n        }\n      }\n      return;\n    }\n    this.basePaste(event);\n  }\n  private async basePaste(event?: ClipboardEvent) {\n    let html = '';\n    let text = '';\n    if (!event) {\n      const data = await this.hooks.paste();\n      html = data[HTML_FORMAT];\n      text = data[PLAIN_FORMAT];\n    } else {\n      html = event.clipboardData?.getData(HTML_FORMAT) || '';\n      text = event.clipboardData?.getData(PLAIN_FORMAT) || '';\n    }\n    html = html.trim();\n    text = text.trim();\n    let activeCell = this.getActiveCell();\n    this.changeSet.add('cellValue');\n    let check = false;\n    if (html) {\n      const result = this.parseHTML(html);\n      if (result.value.length > 0) {\n        activeCell = result.range;\n        this.changeSet.add('cellStyle');\n        this.model.setCellValues(result.value, result.style, [result.range]);\n        check = true;\n      }\n    }\n    if (!check && text) {\n      const result = this.parseText(text);\n      if (result.value.length > 0) {\n        activeCell = result.range;\n        this.model.setCellValues(result.value, [], [result.range]);\n        check = true;\n      }\n    }\n    if (!check && this.copyRanges.length > 0) {\n      const [range] = this.copyRanges.slice();\n      this.changeSet.add('cellStyle');\n      activeCell = this.model.pasteRange(range, this.isCut);\n    }\n    if (this.isCut) {\n      this.copyRanges = [];\n      this.isCut = false;\n      this.hooks.copyOrCut(\n        {\n          [PLAIN_FORMAT]: '',\n          [HTML_FORMAT]: '',\n        },\n        'copy',\n      );\n    }\n    this.setActiveCell(activeCell);\n  }\n  copy(event?: ClipboardEvent): void {\n    this.copyRanges = [this.getActiveCell()];\n    this.isCut = false;\n    this.baseCopy('copy', event);\n  }\n  cut(event?: ClipboardEvent) {\n    this.copyRanges = [this.getActiveCell()];\n    this.isCut = true;\n    this.baseCopy('cut', event);\n  }\n  private baseCopy(type: 'cut' | 'copy', event?: ClipboardEvent) {\n    const data = this.getCopyData();\n    if (event) {\n      const keyList = Object.keys(data) as ClipboardType[];\n      for (const key of keyList) {\n        event.clipboardData?.setData(key, data[key]);\n      }\n    } else {\n      this.hooks.copyOrCut(data, type);\n    }\n    this.changeSet.add('antLine');\n\n    this.emitChange();\n  }\n  getCopyRanges() {\n    if (this.floatElementUuid) {\n      return [];\n    }\n    return this.copyRanges.slice();\n  }\n  getDomRect(): CanvasOverlayPosition {\n    const { canvas } = this.getMainDom();\n    if (!canvas) {\n      return {\n        top: 0,\n        left: 0,\n        width: 0,\n        height: 0,\n      };\n    }\n    const dom = canvas.parentElement!;\n    const scrollbarSize = parseInt(sizeConfig.scrollBarSize, 10);\n    const size = dom.getBoundingClientRect();\n    return {\n      top: size.top,\n      left: size.left,\n      width: dom.clientWidth - scrollbarSize,\n      height: dom.clientHeight - scrollbarSize,\n    };\n  }\n  setMainDom(dom: MainDom): void {\n    this.mainDom = Object.assign(this.mainDom, dom);\n  }\n  getMainDom(): MainDom {\n    return this.mainDom;\n  }\n  deleteAll(sheetId?: string): void {\n    this.model.deleteAll(sheetId);\n    this.changeSet.add('cellValue');\n    this.emitChange();\n  }\n  getDefineName(range: IRange): string {\n    return this.model.getDefineName(range);\n  }\n  setDefineName(range: IRange, name: string): void {\n    this.model.setDefineName(range, name);\n    this.changeSet.add('defineName');\n    this.changeSet.add('cellValue');\n    this.emitChange();\n  }\n  checkDefineName(name: string): IRange | undefined {\n    return this.model.checkDefineName(name);\n  }\n  getFloatElementList(sheetId: string): FloatElement[] {\n    return this.model.getFloatElementList(sheetId);\n  }\n  addFloatElement(data: FloatElement) {\n    this.model.addFloatElement(data);\n    this.changeSet.add('floatElement');\n    this.emitChange();\n  }\n  updateFloatElement(uuid: string, value: Partial<FloatElement>) {\n    this.model.updateFloatElement(uuid, value);\n    this.changeSet.add('floatElement');\n    this.emitChange();\n  }\n  deleteFloatElement(uuid: string) {\n    this.model.deleteFloatElement(uuid);\n    this.changeSet.add('floatElement');\n    this.emitChange();\n  }\n  getMergeCells(sheetId?: string): IRange[] {\n    return this.model.getMergeCells(sheetId);\n  }\n  addMergeCell(range: IRange): void {\n    this.model.addMergeCell(range);\n    this.changeSet.add('mergeCell');\n    this.changeSet.add('cellValue');\n    this.emitChange();\n  }\n  deleteMergeCell(range: IRange): void {\n    this.model.deleteMergeCell(range);\n    this.changeSet.add('mergeCell');\n    this.changeSet.add('cellValue');\n    this.emitChange();\n  }\n  setFloatElementUuid(uuid: string) {\n    if (this.floatElementUuid && !uuid) {\n      this.copyRanges = [];\n    }\n    this.floatElementUuid = uuid;\n  }\n}\n", "import type { ErrorTypes } from '@/types';\n\nexport class CustomError extends Error {\n  readonly value: ErrorTypes;\n  constructor(value: ErrorTypes) {\n    super(value);\n    this.value = value;\n  }\n}\n\nexport function assert(condition: boolean, message: ErrorTypes = '#VALUE!'): asserts condition {\n  if (!condition) {\n    throw new CustomError(message);\n  }\n}\n\nexport function mustOne(list: any[]): any {\n  assert(list.length === 1);\n  const [value] = list;\n  return value;\n}\n\nexport function mustOneString(list: any[]): string {\n  const value = mustOne(list);\n  assert(typeof value === 'string');\n  return value;\n}\n\nexport function mustOneNumber(list: any[]): number {\n  const value = mustOne(list);\n  assert(typeof value === 'number' && !isNaN(value));\n  return value;\n}\n\nexport function mustEmpty(list: any[]) {\n  assert(list.length === 0);\n}\n", "import type { TextFormulaType, ResultType } from '@/types';\nimport { MAX_PARAMS_COUNT } from '@/util';\nimport { assert, mustOneString, mustOneNumber, mustOne } from './error';\n\nexport const T = (...list: ResultType[]): string => {\n  const value = mustOne(list);\n  return typeof value === 'string' ? value : '';\n};\n\nexport const LOWER = (...list: ResultType[]): string => {\n  const value = mustOneString(list);\n  return value.toLowerCase();\n};\nexport const CHAR = (...list: ResultType[]): string => {\n  const value = mustOneNumber(list);\n  return String.fromCharCode(value);\n};\nexport const CODE = (...list: ResultType[]): number => {\n  const value = mustOneString(list);\n  return value.charCodeAt(0);\n};\nexport const LEN = (...list: ResultType[]): number => {\n  const value = mustOneString(list);\n  return value.length;\n};\n\nexport const SPLIT = (...list: ResultType[]): string[] => {\n  assert(list.length === 2);\n  const [value, sep] = list;\n  assert(typeof value === 'string');\n  assert(typeof sep === 'string');\n  return value.split(sep);\n};\nexport const UPPER = (...list: ResultType[]): string => {\n  const value = mustOneString(list);\n  return value.toUpperCase();\n};\nexport const TRIM = (...list: ResultType[]): string => {\n  const value = mustOneString(list);\n  return value.replace(/ +/g, ' ').trim();\n};\nexport const CONCAT = (...list: ResultType[]): string => {\n  assert(list.length <= MAX_PARAMS_COUNT);\n  return list.join('');\n};\n\nconst formulas: TextFormulaType = {\n  CONCAT,\n  CONCATENATE: CONCAT,\n  SPLIT,\n  CHAR,\n  CODE,\n  UNICHAR: CHAR,\n  UNICODE: CODE,\n  LEN,\n  LOWER,\n  UPPER,\n  TRIM,\n  T,\n};\n\nexport default formulas;\n", "import { parseNumberArray, MAX_PARAMS_COUNT } from '@/util';\nimport type { MathFormulaType, ResultType } from '../../types';\nimport { assert, mustOneNumber, mustEmpty } from './error';\n\nexport const ABS = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return Math.abs(data);\n};\nexport const ACOS = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return Math.acos(data);\n};\n\nexport const ACOSH = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return Math.log(data + Math.sqrt(data * data - 1));\n};\n\nexport const ACOT = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return Math.atan(1 / data);\n};\n\nexport const ACOTH = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return 0.5 * Math.log((data + 1) / (data - 1));\n};\nexport const ASIN = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return Math.asin(data);\n};\n\nexport const ASINH = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return Math.log(data + Math.sqrt(data * data + 1));\n};\nexport const ATAN = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return Math.atan(data);\n};\nexport const ATAN2 = (...list: ResultType[]): number => {\n  assert(list.length === 2);\n  const [x, y] = list;\n  assert(typeof x === 'number');\n  assert(typeof y === 'number');\n  return Math.atan2(x, y);\n};\nexport const ATANH = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return Math.log((1 + data) / (data + 1)) / 2;\n};\n\nexport const COS = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return Math.cos(data);\n};\nexport const COT = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return 1 / Math.tan(data);\n};\nexport const CSC = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return 1 / Math.sin(data);\n};\nexport const DECIMAL = (...list: ResultType[]): number => {\n  assert(list.length === 2);\n  const [data, radix] = list;\n  assert(typeof data === 'string');\n  assert(typeof radix === 'number');\n  return parseInt(data, radix);\n};\nexport const DEGREES = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return (data * 180) / Math.PI;\n};\nexport const EXP = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return Math.exp(data);\n};\nexport const INT = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return Math.floor(data);\n};\nexport const LN10 = (...list: ResultType[]): number => {\n  mustEmpty(list);\n  return Math.log(10);\n};\nexport const LN2 = (...list: ResultType[]): number => {\n  mustEmpty(list);\n  return Math.log(2);\n};\nexport const LOG10E = (...list: ResultType[]): number => {\n  mustEmpty(list);\n  return Math.LOG10E;\n};\nexport const LOG2E = (...list: ResultType[]): number => {\n  mustEmpty(list);\n  return Math.LOG2E;\n};\nexport const LOG = (...list: ResultType[]): number => {\n  assert(list.length >= 1 && list.length <= 2);\n  const [data, base = 10] = list;\n  assert(typeof data === 'number');\n  assert(typeof base === 'number');\n  return Math.log(data) / Math.log(base);\n};\n\nexport const LOG10 = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return Math.log(data) / Math.log(10);\n};\nexport const PI = (...list: ResultType[]): number => {\n  mustEmpty(list);\n  return Math.PI;\n};\nexport const E = (...list: ResultType[]): number => {\n  mustEmpty(list);\n  return Math.E;\n};\nexport const SIN = (...list: ResultType[]): number => {\n  const data = mustOneNumber(list);\n  return Math.sin(data);\n};\nexport const SUM = (...rest: ResultType[]): number => {\n  const list = parseNumberArray(rest);\n  assert(list.length <= MAX_PARAMS_COUNT);\n  return list.reduce((sum, cur) => sum + cur, 0);\n};\n\nexport const AVERAGE = (...rest: ResultType[]): number => {\n  const list = parseNumberArray(rest);\n  assert(list.length <= MAX_PARAMS_COUNT && list.length >= 1);\n  return list.reduce((sum, cur) => sum + cur, 0) / list.length;\n};\n\nconst formulas: MathFormulaType = {\n  ABS,\n  ACOS,\n  ACOSH,\n  ACOT,\n  ACOTH,\n  ASIN,\n  ASINH,\n  ATAN,\n  ATAN2,\n  ATANH,\n  AVERAGE,\n  COT,\n  COS,\n  EXP,\n  INT,\n  PI,\n  E,\n  SIN,\n  SUM,\n};\n\nexport default formulas;\n", "import textFormulas from './text';\nimport mathFormulas from './math';\nimport type { FormulaType } from '@/types';\n\nconst allFormulas: FormulaType = {\n  ...textFormulas,\n  ...mathFormulas,\n};\nexport * from './error';\nexport default allFormulas;\n", "import type { TokenType } from '@/types';\n\nexport class Token {\n  type: TokenType;\n  value: string;\n  constructor(type: TokenType, value: string) {\n    this.type = type;\n    this.value = value;\n  }\n  error() {\n    return `type:${this.type},value:${this.value}`;\n  }\n  toString(): string {\n    return this.value;\n  }\n}\n", "import { TokenType } from '@/types';\nimport { Token } from './token';\nimport { CustomError } from './formula';\nimport { FORMULA_PREFIX } from '@/util';\n\nconst emptyData = '';\nconst identifierMap = new Map<string, TokenType>([\n  ['TRUE', TokenType.TRUE],\n  ['FALSE', TokenType.FALSE],\n]);\n\nexport class Scanner {\n  private readonly list: string[];\n  private current = 0;\n  private start = 0;\n  private readonly tokens: Token[] = [];\n  constructor(source: string) {\n    this.list = [...source];\n  }\n  scan(): Token[] {\n    while (!this.isAtEnd()) {\n      this.start = this.current;\n      this.scanToken();\n    }\n    this.tokens.push(new Token(TokenType.EOF, ''));\n    if (this.tokens.length > 0 && this.tokens[0].type === TokenType.EQUAL) {\n      this.tokens.shift();\n    }\n    return this.tokens;\n  }\n  private peek() {\n    if (this.isAtEnd()) {\n      return emptyData;\n    }\n    return this.list[this.current];\n  }\n  private match(text: string) {\n    if (this.peek() !== text) {\n      return false;\n    }\n    this.next();\n    return true;\n  }\n  private next() {\n    if (this.isAtEnd()) {\n      return emptyData;\n    }\n    return this.list[this.current++];\n  }\n  private isAtEnd() {\n    return this.current >= this.list.length;\n  }\n  private addToken(type: TokenType) {\n    const text = this.list.slice(this.start, this.current).join('');\n    this.tokens.push(new Token(type, text));\n  }\n  private string(end: string) {\n    while (!this.isAtEnd() && this.peek() !== end) {\n      this.next();\n    }\n    if (this.peek() !== end) {\n      throw new CustomError('#VALUE!');\n    } else {\n      this.next();\n    }\n    const text = this.list.slice(this.start + 1, this.current - 1).join('');\n    this.tokens.push(new Token(TokenType.STRING, text));\n  }\n  private allDigit() {\n    while (!this.isAtEnd() && this.isDigit(this.peek())) {\n      this.next();\n    }\n  }\n  private matchScientificCounting() {\n    if (this.match('E') || this.match('e')) {\n      // 1E-10 1E+10\n      if (this.match('+') || this.match('-')) {\n        this.allDigit();\n        this.addToken(TokenType.NUMBER);\n        return true;\n      }\n      if (this.isDigit(this.peek())) {\n        this.allDigit();\n        this.addToken(TokenType.NUMBER);\n        return true;\n      }\n      throw new CustomError('#VALUE!');\n    }\n    return false;\n  }\n  private number() {\n    this.allDigit();\n    const check1 = this.matchScientificCounting();\n    if (check1) {\n      return;\n    }\n    if (this.match('.')) {\n      this.allDigit();\n    }\n    const check2 = this.matchScientificCounting();\n    if (check2) {\n      return;\n    }\n    this.addToken(TokenType.NUMBER);\n  }\n  private isDigit(char: string) {\n    return char >= '0' && char <= '9';\n  }\n  private identifier() {\n    while (!this.isAtEnd() && this.anyChar(this.peek())) {\n      this.next();\n    }\n    let text = this.list.slice(this.start, this.current).join('');\n    const temp = identifierMap.get(text.toUpperCase());\n    let type: TokenType = TokenType.IDENTIFIER;\n    if (temp) {\n      text = text.toUpperCase();\n      type = temp;\n    }\n    this.tokens.push(new Token(type, text));\n  }\n  private scanToken() {\n    const c = this.next();\n    switch (c) {\n      case '(':\n        this.addToken(TokenType.LEFT_BRACKET);\n        break;\n      case ')':\n        this.addToken(TokenType.RIGHT_BRACKET);\n        break;\n      case ',':\n        this.addToken(TokenType.COMMA);\n        break;\n      case ':':\n        this.addToken(TokenType.COLON);\n        break;\n      case FORMULA_PREFIX:\n        this.addToken(TokenType.EQUAL);\n        break;\n      case '<':\n        if (this.match('>')) {\n          this.addToken(TokenType.NOT_EQUAL);\n        } else if (this.match('=')) {\n          this.addToken(TokenType.LESS_EQUAL);\n        } else {\n          this.addToken(TokenType.LESS);\n        }\n        break;\n      case '>':\n        if (this.match('=')) {\n          this.addToken(TokenType.GREATER_EQUAL);\n        } else {\n          this.addToken(TokenType.GREATER);\n        }\n        break;\n      case '+':\n        this.addToken(TokenType.PLUS);\n        break;\n      case '-':\n        this.addToken(TokenType.MINUS);\n        break;\n      case '*':\n        this.addToken(TokenType.STAR);\n        break;\n      case '/':\n        this.addToken(TokenType.SLASH);\n        break;\n      case '^':\n        this.addToken(TokenType.EXPONENT);\n        break;\n      case '&':\n        this.addToken(TokenType.CONCATENATE);\n        break;\n      case '%':\n        this.addToken(TokenType.PERCENT);\n        break;\n      case '\"':\n        this.string(c);\n        break;\n      case '!':\n        this.addToken(TokenType.EXCLAMATION);\n        break;\n      case ';':\n        this.addToken(TokenType.SEMICOLON);\n        break;\n      case '{':\n        this.addToken(TokenType.lEFT_BRACE);\n        break;\n      case '}':\n        this.addToken(TokenType.RIGHT_BRACE);\n        break;\n      case ' ':\n        // while (!this.isAtEnd() && this.peek() === ' ') {\n        // this.next();\n        // }\n        // this.addToken(TokenType.EMPTY_CHAR);\n        break;\n      case '\\r':\n      case '\\t':\n      case '\\n':\n        break;\n      default:\n        if (this.isDigit(c)) {\n          this.number();\n        } else if (this.anyChar(c)) {\n          this.identifier();\n        } else {\n          throw new CustomError('#ERROR!');\n        }\n        break;\n    }\n  }\n  private anyChar(c: string) {\n    const text = '(),:=<>+-*/^&%\"{}!';\n    return !text.includes(c) && !this.isWhiteSpace(c);\n  }\n  private isWhiteSpace(c: string) {\n    return c === ' ' || c === '\\r' || c === '\\n' || c === '\\t';\n  }\n}\n", "import type { Token } from './token';\nimport type { ReferenceType } from '@/types';\nimport { TokenType } from '@/types';\n\nexport interface Visitor {\n  visitBinaryExpression: (expr: BinaryExpression) => any;\n  visitUnaryExpression: (expr: UnaryExpression) => any;\n  visitPostUnaryExpression: (expr: PostUnaryExpression) => any;\n  visitLiteralExpression: (expr: LiteralExpression) => any;\n  visitCellExpression: (expr: CellExpression) => any;\n  visitCellRangeExpression: (expr: CellRangeExpression) => any;\n  visitCallExpression: (expr: CallExpression) => any;\n  visitGroupExpression: (expr: GroupExpression) => any;\n  visitTokenExpression: (expr: TokenExpression) => any;\n}\n\nexport interface Expression {\n  accept: (visitor: Visitor) => any;\n  toString: () => string;\n}\n\nexport class BinaryExpression implements Expression {\n  readonly left: Expression;\n  readonly right: Expression;\n  readonly operator: Token;\n  constructor(left: Expression, operator: Token, right: Expression) {\n    this.left = left;\n    this.operator = operator;\n    this.right = right;\n  }\n  accept(visitor: Visitor) {\n    return visitor.visitBinaryExpression(this);\n  }\n  private handleConcatenate(value: Expression): string {\n    const result = value.toString();\n    const check =\n      this.operator.type === TokenType.CONCATENATE &&\n      value instanceof LiteralExpression &&\n      value.value.type === TokenType.STRING;\n    if (check) {\n      return JSON.stringify(result);\n    }\n    return result;\n  }\n  toString(): string {\n    const left = this.handleConcatenate(this.left);\n    const right = this.handleConcatenate(this.right);\n    return `${left}${this.operator.toString()}${right}`;\n  }\n}\n\nexport class UnaryExpression implements Expression {\n  readonly right: Expression;\n  readonly operator: Token;\n  constructor(operator: Token, right: Expression) {\n    this.operator = operator;\n    this.right = right;\n  }\n  accept(visitor: Visitor) {\n    return visitor.visitUnaryExpression(this);\n  }\n  toString(): string {\n    return this.operator.toString() + this.right.toString();\n  }\n}\n\nexport class PostUnaryExpression implements Expression {\n  readonly left: Expression;\n  readonly operator: Token;\n  constructor(operator: Token, left: Expression) {\n    this.operator = operator;\n    this.left = left;\n  }\n  accept(visitor: Visitor) {\n    return visitor.visitPostUnaryExpression(this);\n  }\n  toString(): string {\n    return this.left.toString() + this.operator.toString();\n  }\n}\n\nexport class LiteralExpression implements Expression {\n  readonly value: Token;\n  constructor(value: Token) {\n    this.value = value;\n  }\n  accept(visitor: Visitor) {\n    return visitor.visitLiteralExpression(this);\n  }\n  toString(): string {\n    return this.value.toString();\n  }\n}\n\nexport class CellExpression implements Expression {\n  readonly value: Token;\n  readonly sheetName: Token | null;\n  readonly type: ReferenceType;\n  constructor(value: Token, type: ReferenceType, sheetName: Token | null) {\n    this.value = value;\n    this.sheetName = sheetName;\n    this.type = type;\n  }\n  accept(visitor: Visitor) {\n    return visitor.visitCellExpression(this);\n  }\n  toString(): string {\n    if (this.sheetName) {\n      return `${this.sheetName.toString()}!${this.value.toString()}`;\n    } else {\n      return this.value.toString();\n    }\n  }\n}\n\nexport class CallExpression implements Expression {\n  readonly name: Expression;\n  readonly params: Expression[];\n  constructor(name: Expression, params: Expression[]) {\n    this.name = name;\n    this.params = params;\n  }\n  accept(visitor: Visitor) {\n    return visitor.visitCallExpression(this);\n  }\n  toString(): string {\n    return `${this.name.toString().toUpperCase()}(${this.params\n      .map((item) => item.toString())\n      .join(',')})`;\n  }\n}\nexport class CellRangeExpression implements Expression {\n  readonly left: Expression;\n  readonly right: Expression;\n  readonly operator: Token;\n  constructor(left: Expression, operator: Token, right: Expression) {\n    this.left = left;\n    this.operator = operator;\n    this.right = right;\n  }\n  accept(visitor: Visitor) {\n    return visitor.visitCellRangeExpression(this);\n  }\n  toString(): string {\n    return (\n      this.left.toString() + this.operator.toString() + this.right.toString()\n    );\n  }\n}\n\nexport class GroupExpression implements Expression {\n  readonly value: Expression;\n  constructor(value: Expression) {\n    this.value = value;\n  }\n  accept(visitor: Visitor) {\n    return visitor.visitGroupExpression(this);\n  }\n  toString(): string {\n    return `(${this.value.toString()})`;\n  }\n}\n\nexport class TokenExpression implements Expression {\n  readonly value: Token;\n  constructor(value: Token) {\n    this.value = value;\n  }\n  accept(visitor: Visitor) {\n    return visitor.visitTokenExpression(this);\n  }\n  toString(): string {\n    return this.value.toString();\n  }\n}\n", "import { TokenType, ErrorTypes } from '@/types';\nimport { Token } from './token';\nimport {\n  TokenExpression,\n  Expression,\n  GroupExpression,\n  PostUnaryExpression,\n  BinaryExpression,\n  UnaryExpression,\n  CallExpression,\n  LiteralExpression,\n  CellRangeExpression,\n} from './expression';\nimport { CustomError } from './formula';\n\nconst errorSet = new Set<ErrorTypes>(['#ERROR!', '#DIV/0!', '#NULL!', '#NUM!', '#REF!', '#VALUE!', '#N/A', '#NAME?']);\n\nexport class Parser {\n  private readonly tokens: Token[];\n  private current = 0;\n  constructor(tokens: Token[]) {\n    this.tokens = tokens;\n  }\n  parse(): Expression[] {\n    const result: Expression[] = [];\n    while (!this.isAtEnd()) {\n      result.push(this.expression());\n    }\n    return result;\n  }\n  private expression(): Expression {\n    return this.comparison();\n  }\n  private comparison(): Expression {\n    let expr = this.concatenate();\n    while (\n      this.match(\n        TokenType.EQUAL,\n        TokenType.NOT_EQUAL,\n        TokenType.GREATER,\n        TokenType.GREATER_EQUAL,\n        TokenType.LESS,\n        TokenType.LESS_EQUAL,\n      )\n    ) {\n      const operator = this.previous();\n      const right = this.concatenate();\n      expr = new BinaryExpression(expr, operator, right);\n    }\n    return expr;\n  }\n  private concatenate(): Expression {\n    let expr = this.term();\n    while (this.match(TokenType.CONCATENATE)) {\n      const operator = this.previous();\n      const right = this.term();\n      expr = new BinaryExpression(expr, operator, right);\n    }\n    return expr;\n  }\n  private term(): Expression {\n    let expr = this.factor();\n    while (this.match(TokenType.PLUS, TokenType.MINUS)) {\n      const operator = this.previous();\n      const right = this.factor();\n      expr = new BinaryExpression(expr, operator, right);\n    }\n    return expr;\n  }\n  private factor(): Expression {\n    let expr = this.expo();\n    while (this.match(TokenType.SLASH, TokenType.STAR)) {\n      const operator = this.previous();\n      const right = this.expo();\n      expr = new BinaryExpression(expr, operator, right);\n    }\n    return expr;\n  }\n  private expo(): Expression {\n    let expr = this.unary();\n    while (this.match(TokenType.EXPONENT)) {\n      const operator = this.previous();\n      const right = this.unary();\n      expr = new BinaryExpression(expr, operator, right);\n    }\n    return expr;\n  }\n\n  private unary(): Expression {\n    if (this.match(TokenType.PLUS, TokenType.MINUS)) {\n      const operator = this.previous();\n      const right = this.unary();\n      return new UnaryExpression(operator, right);\n    }\n    return this.postUnary();\n  }\n  private postUnary(): Expression {\n    let expr = this.cellRange();\n    if (this.match(TokenType.PERCENT)) {\n      const operator = this.previous();\n      expr = new PostUnaryExpression(operator, expr);\n    }\n    return expr;\n  }\n  private cellRange(): Expression {\n    let expr = this.call();\n    while (this.match(TokenType.COLON, TokenType.EXCLAMATION)) {\n      const operator = this.previous();\n      const right = this.call();\n      expr = new CellRangeExpression(expr, operator, right);\n    }\n    return expr;\n  }\n  private call(): Expression {\n    let expr = this.primary();\n    // eslint-disable-next-line no-constant-condition\n    while (1) {\n      if (this.match(TokenType.LEFT_BRACKET)) {\n        expr = this.finishCall(expr);\n      } else {\n        break;\n      }\n    }\n    return expr;\n  }\n\n  private finishCall(name: Expression): CallExpression {\n    const params: Expression[] = [];\n    if (!this.check(TokenType.RIGHT_BRACKET)) {\n      do {\n        // fix SUM(1,)\n        if (this.peek().type == TokenType.RIGHT_BRACKET) {\n          break;\n        }\n        params.push(this.expression());\n      } while (this.match(TokenType.COMMA));\n    }\n    this.expect(TokenType.RIGHT_BRACKET);\n    return new CallExpression(name, params);\n  }\n  private primary(): Expression {\n    if (this.match(TokenType.LEFT_BRACKET)) {\n      const value = this.expression();\n      this.expect(TokenType.RIGHT_BRACKET);\n      return new GroupExpression(value);\n    }\n    if (this.match(TokenType.NUMBER, TokenType.STRING, TokenType.TRUE, TokenType.FALSE)) {\n      return new LiteralExpression(this.previous());\n    }\n\n    if (this.match(TokenType.IDENTIFIER)) {\n      const name = this.previous();\n      const realValue = name.value.toUpperCase();\n      if (errorSet.has(realValue as ErrorTypes)) {\n        throw new CustomError(realValue as ErrorTypes);\n      }\n      return new TokenExpression(name);\n    }\n\n    throw new CustomError('#ERROR!');\n  }\n  private match(...types: TokenType[]): boolean {\n    const { type } = this.peek();\n    if (types.includes(type)) {\n      this.next();\n      return true;\n    }\n    return false;\n  }\n  private previous(): Token {\n    return this.tokens[this.current - 1];\n  }\n  private check(type: TokenType): boolean {\n    return this.peek().type === type;\n  }\n  private expect(type: TokenType): Token {\n    if (this.check(type)) {\n      this.next();\n      return this.previous();\n    } else {\n      throw new CustomError('#ERROR!');\n    }\n  }\n  private next() {\n    this.current++;\n  }\n  private isAtEnd() {\n    return this.peek().type === TokenType.EOF;\n  }\n  private peek(): Token {\n    if (this.current < this.tokens.length) {\n      return this.tokens[this.current];\n    }\n    return new Token(TokenType.EOF, '');\n  }\n}\n", "import { Range, mergeRange, parseReference } from '@/util';\nimport {\n  TokenType,\n  CellDataMap,\n  DefinedNamesMap,\n  FormulaType,\n  ReferenceType,\n  FormulaKeys,\n  ResultType,\n} from '@/types';\nimport type {\n  Visitor,\n  Expression,\n  CellRangeExpression,\n  PostUnaryExpression,\n} from './expression';\nimport {\n  BinaryExpression,\n  UnaryExpression,\n  CellExpression,\n  CallExpression,\n  LiteralExpression,\n  TokenExpression,\n  GroupExpression,\n} from './expression';\nimport { CustomError, assert } from './formula';\nimport { Token } from './token';\n\nexport class Interpreter implements Visitor {\n  private readonly expressions: Expression[];\n  private readonly functionMap: FormulaType;\n  private readonly cellDataMap: CellDataMap;\n  private readonly definedNamesMap: DefinedNamesMap;\n  constructor(\n    expressions: Expression[],\n    cellDataMap: CellDataMap,\n    definedNamesMap: DefinedNamesMap,\n    functionMap: FormulaType,\n  ) {\n    this.expressions = expressions;\n    this.functionMap = functionMap;\n    this.cellDataMap = cellDataMap;\n    this.definedNamesMap = definedNamesMap;\n  }\n  interpret(): ResultType {\n    const result: ResultType[] = [];\n    for (const item of this.expressions) {\n      result.push(this.evaluate(item));\n    }\n    if (result.length === 1) {\n      return this.getRangeCellValue(result[0]);\n    } else {\n      throw new CustomError('#ERROR!');\n    }\n  }\n\n  visitBinaryExpression(data: BinaryExpression): any {\n    let left = this.evaluate(data.left);\n    let right = this.evaluate(data.right);\n    left = this.getRangeCellValue(left);\n    right = this.getRangeCellValue(right);\n    switch (data.operator.type) {\n      case TokenType.MINUS:\n        assert(typeof left === 'number');\n        assert(typeof right === 'number');\n        return left - right;\n      case TokenType.PLUS:\n        assert(typeof left === 'number');\n        assert(typeof right === 'number');\n        return left + right;\n      case TokenType.SLASH:\n        assert(typeof left === 'number');\n        assert(typeof right === 'number');\n        if (right === 0) {\n          throw new CustomError('#DIV/0!');\n        }\n        return left / right;\n      case TokenType.STAR:\n        assert(typeof left === 'number');\n        assert(typeof right === 'number');\n        return left * right;\n      case TokenType.EXPONENT:\n        assert(typeof left === 'number');\n        assert(typeof right === 'number');\n        return Math.pow(left, right);\n      case TokenType.EQUAL:\n        return left === right;\n      case TokenType.NOT_EQUAL:\n        return left !== right;\n      case TokenType.GREATER:\n        return left > right;\n      case TokenType.GREATER_EQUAL:\n        return left >= right;\n      case TokenType.LESS:\n        return left < right;\n      case TokenType.LESS_EQUAL:\n        return left <= right;\n      case TokenType.CONCATENATE:\n        return `${left}${right}`;\n      default:\n        throw new CustomError('#VALUE!');\n    }\n  }\n  visitCallExpression(expr: CallExpression) {\n    const callee = this.evaluate(expr.name);\n    if (callee && typeof callee === 'function') {\n      let params: ResultType[] = [];\n      for (const item of expr.params) {\n        const t = this.evaluate(item);\n        if (t instanceof Range) {\n          const list = this.cellDataMap.get(t);\n          params = params.concat(list);\n        } else {\n          params.push(t);\n        }\n      }\n      return callee(...params);\n    }\n    throw new CustomError('#NAME?');\n  }\n  visitCellExpression(data: CellExpression) {\n    let sheetId = '';\n    if (data.sheetName) {\n      sheetId = this.cellDataMap.convertSheetNameToSheetId(\n        data.sheetName.value,\n      );\n      if (!sheetId) {\n        throw new CustomError('#NAME?');\n      }\n    }\n    const t = parseReference(data.value.value);\n    if (t === null) {\n      throw new CustomError('#NAME?');\n    }\n    if (sheetId) {\n      t.sheetId = sheetId;\n    }\n    return t;\n  }\n  visitLiteralExpression(expr: LiteralExpression) {\n    const { type, value } = expr.value;\n    switch (type) {\n      case TokenType.STRING:\n        return value;\n      case TokenType.NUMBER: {\n        const t = parseFloat(value);\n        if (isNaN(t)) {\n          throw new CustomError('#VALUE!');\n        }\n        return t;\n      }\n      case TokenType.TRUE:\n        return true;\n      case TokenType.FALSE:\n        return false;\n      default:\n        throw new CustomError('#ERROR!');\n    }\n  }\n\n  visitTokenExpression(expr: TokenExpression) {\n    const { value, type } = expr.value;\n    const defineName = value.toLowerCase();\n    if (this.definedNamesMap.has(defineName)) {\n      const temp = this.definedNamesMap.get(defineName)!;\n      return this.cellDataMap.get(temp)[0];\n    }\n    const funcName = value.toUpperCase();\n    const func = this.functionMap[funcName as FormulaKeys];\n    if (func) {\n      return func;\n    }\n    const realValue = funcName;\n    const newToken = new Token(type, realValue);\n    if (\n      /^\\$[A-Z]+\\$\\d+$/.test(realValue) ||\n      /^\\$[A-Z]+$/.test(realValue) ||\n      /^\\$\\d+$/.test(realValue)\n    ) {\n      return this.addCellExpression(newToken, 'absolute', null);\n    }\n    if (/^\\$[A-Z]+\\d+$/.test(realValue) || /^[A-Z]+\\$\\d+$/.test(realValue)) {\n      return this.addCellExpression(newToken, 'mixed', null);\n    }\n    if (/^[A-Z]+\\d+$/.test(realValue) || /^[A-Z]+$/.test(realValue)) {\n      return this.addCellExpression(newToken, 'relative', null);\n    }\n\n    throw new CustomError('#NAME?');\n  }\n  visitUnaryExpression(data: UnaryExpression): any {\n    const value = this.evaluate(data.right);\n    switch (data.operator.type) {\n      case TokenType.MINUS:\n        return -value;\n      case TokenType.PLUS:\n        return value;\n      default:\n        throw new CustomError('#VALUE!');\n    }\n  }\n\n  visitCellRangeExpression(expr: CellRangeExpression): any {\n    switch (expr.operator.type) {\n      case TokenType.COLON: {\n        const left = this.convertToCellExpression(expr.left);\n        const right = this.convertToCellExpression(expr.right);\n        if (left !== null && right !== null) {\n          const a = this.visitCellExpression(left);\n          const b = this.visitCellExpression(right);\n          const result = mergeRange(a, b);\n          if (result === null) {\n            throw new CustomError('#NAME?');\n          }\n          return result;\n        } else {\n          throw new CustomError('#NAME?');\n        }\n      }\n      case TokenType.EXCLAMATION: {\n        const right = this.convertToCellExpression(expr.right);\n        if (right === null) {\n          throw new CustomError('#REF!');\n        }\n        if (expr.left instanceof TokenExpression) {\n          return this.visitCellExpression(\n            new CellExpression(right.value, right.type, expr.left.value),\n          );\n        }\n        throw new CustomError('#NAME?');\n      }\n      default:\n        throw new CustomError('#NAME?');\n    }\n  }\n  visitGroupExpression(expr: GroupExpression): any {\n    return this.evaluate(expr.value);\n  }\n  visitPostUnaryExpression(expr: PostUnaryExpression): any {\n    const value = this.evaluate(expr.left);\n    switch (expr.operator.type) {\n      case TokenType.PERCENT:\n        assert(typeof value === 'number');\n        return value * 0.01;\n      default:\n        throw new CustomError('#VALUE!');\n    }\n  }\n  private evaluate(expr: Expression) {\n    return expr.accept(this);\n  }\n  private convertToCellExpression(expr: Expression): CellExpression | null {\n    if (expr instanceof CellExpression) {\n      return expr;\n    }\n    if (expr instanceof TokenExpression) {\n      return new CellExpression(\n        new Token(TokenType.IDENTIFIER, expr.value.value.toUpperCase()),\n        'relative',\n        null,\n      );\n    }\n    if (expr instanceof LiteralExpression) {\n      if (\n        expr.value.type === TokenType.NUMBER &&\n        /^\\d+$/.test(expr.value.value)\n      ) {\n        return new CellExpression(\n          new Token(TokenType.IDENTIFIER, expr.value.value),\n          'relative',\n          null,\n        );\n      }\n    }\n    return null;\n  }\n  private addCellExpression(\n    value: Token,\n    type: ReferenceType,\n    sheetName: Token | null,\n  ) {\n    value.value = value.value.toUpperCase();\n    const result = new CellExpression(value, type, sheetName);\n    return this.visitCellExpression(result);\n  }\n  private getRangeCellValue(value: any): ResultType {\n    if (value instanceof Range) {\n      if (value.colCount === value.rowCount && value.colCount === 1) {\n        const list = this.cellDataMap.get(value);\n        return list[0];\n      } else {\n        throw new CustomError('#REF!');\n      }\n    }\n    return value;\n  }\n}\n", "import { Scanner } from './scanner';\nimport { Parser } from './parser';\nimport allFormulas, { CustomError } from './formula';\nimport { Interpreter } from './interpreter';\nimport {\n  CellDataMap,\n  InterpreterResult,\n  DefinedNamesMap,\n  IRange,\n  FormulaType,\n  ResultType,\n} from '@/types';\n\nexport function parseFormula(\n  source: string,\n  cellData: CellDataMap = new CellDataMapImpl(),\n  definedNamesMap: DefinedNamesMap = new DefinedNamesMapImpl(),\n  functionMap: FormulaType = allFormulas,\n): InterpreterResult {\n  let expressionStr = '';\n  try {\n    const list = new Scanner(source).scan();\n    const expressions = new Parser(list).parse();\n    const result = new Interpreter(\n      expressions,\n      cellData,\n      definedNamesMap,\n      functionMap,\n    ).interpret();\n\n    const strList: string[] = [];\n    for (const item of expressions) {\n      strList.push(item.toString());\n    }\n    expressionStr = strList.join('');\n\n    return {\n      result,\n      error: null,\n      expressionStr,\n    };\n  } catch (error) {\n    if (error instanceof CustomError) {\n      return {\n        result: null,\n        error: error.value,\n        expressionStr,\n      };\n    }\n  }\n  return {\n    result: null,\n    error: '#ERROR!',\n    expressionStr,\n  };\n}\n\nexport class CellDataMapImpl implements CellDataMap {\n  private readonly map = new Map<string, ResultType>();\n  private sheetNameMap: Record<string, string> = {};\n  private getKey(row: number, col: number, sheetId = '1') {\n    const key = `${row}_${col}_${sheetId}`;\n    return key;\n  }\n  setSheetNameMap(sheetNameMap: Record<string, string>) {\n    this.sheetNameMap = sheetNameMap;\n  }\n  set(range: IRange, value: ResultType[][]): void {\n    const { row, col, sheetId } = range;\n    for (let i = 0; i < value.length; i++) {\n      for (let j = 0; j < value[i].length; j++) {\n        const key = this.getKey(row + i, col + j, sheetId);\n        this.map.set(key, value[i][j]);\n      }\n    }\n  }\n  get(range: IRange): ResultType[] {\n    const list: ResultType[] = [];\n    const { row, col, rowCount, colCount, sheetId } = range;\n    for (let r = row, endRow = row + rowCount; r < endRow; r++) {\n      for (let c = col, endCol = col + colCount; c < endCol; c++) {\n        const key = this.getKey(r, c, sheetId);\n        list.push(this.map.get(key));\n      }\n    }\n\n    return list;\n  }\n  convertSheetNameToSheetId(sheetName: string): string {\n    if (!sheetName) {\n      return '';\n    }\n    return this.sheetNameMap[sheetName] || '';\n  }\n}\n\nexport class DefinedNamesMapImpl implements DefinedNamesMap {\n  private readonly map = new Map<string, IRange>();\n  set(name: string, value: IRange): void {\n    this.map.set(name, value);\n  }\n  get(name: string): IRange | undefined {\n    return this.map.get(name)!;\n  }\n  has(name: string): boolean {\n    return this.map.has(name);\n  }\n}\n", "import { IHistory, ICommandItem } from '@/types';\n\ntype Options = {\n  change: (list: ICommandItem[]) => void;\n  maxLength: number;\n  redo: (item: ICommandItem) => void;\n  undo: (item: ICommandItem) => void;\n};\n\nconst noop = () => {};\nexport class History implements IHistory {\n  private position = -1;\n  private commandList: ICommandItem[][] = [];\n  private commands: ICommandItem[] = [];\n  private options: Options = {\n    change: noop,\n    maxLength: 100,\n    redo: noop,\n    undo: noop,\n  };\n  constructor(options: Partial<Options>) {\n    this.clear(true);\n    this.options.maxLength = options.maxLength || this.options.maxLength;\n    if (typeof options.change === 'function') {\n      this.options.change = options.change;\n    }\n    if (typeof options.redo === 'function') {\n      this.options.redo = options.redo;\n    }\n    if (typeof options.undo === 'function') {\n      this.options.undo = options.undo;\n    }\n  }\n  push(...commands: ICommandItem[]) {\n    if (commands.length === 0) {\n      return;\n    }\n    this.commands = this.commands.concat(commands);\n  }\n  commit() {\n    if (this.commands.length === 0) {\n      return;\n    }\n    this.position++;\n    this.commandList[this.position] = [...this.commands];\n    for (let i = this.position + 1; i < this.commandList.length; i++) {\n      this.commandList[i] = [];\n    }\n    if (this.position >= this.options.maxLength) {\n      this.commandList[this.position - this.options.maxLength] = [];\n    }\n    // Prevent this.commandList array from becoming extraordinarily large\n    for (\n      let i = 0;\n      this.commandList.length > this.options.maxLength && i < this.position;\n      i++\n    ) {\n      if (this.commandList[0].length === 0) {\n        this.commandList.shift();\n        this.position--;\n      }\n    }\n\n    this.change(this.commands);\n    this.commands = [];\n  }\n  redo(): void {\n    if (!this.canRedo()) {\n      return;\n    }\n    this.position++;\n    const list = this.commandList[this.position];\n    if (list.length > 0) {\n      for (const item of list) {\n        this.options.redo(item as ICommandItem);\n      }\n    }\n    this.change(list);\n  }\n  undo(): void {\n    if (!this.canUndo()) {\n      return;\n    }\n    const list = this.commandList[this.position];\n    if (list.length > 0) {\n      for (const item of list) {\n        this.options.undo(item as ICommandItem);\n      }\n    }\n    this.position--;\n    this.change(list);\n  }\n  canRedo(): boolean {\n    if (this.position >= this.commandList.length - 1) {\n      return false;\n    }\n    let hasRecord = false;\n    for (let i = this.position + 1; i < this.commandList.length; i++) {\n      if (this.commandList[i].length > 0) {\n        hasRecord = true;\n        break;\n      }\n    }\n    return hasRecord;\n  }\n  canUndo(): boolean {\n    const lower = Math.max(this.commandList.length - this.options.maxLength, 0);\n    return this.position > lower;\n  }\n  clear(clearAll: boolean = false): void {\n    if (clearAll) {\n      this.position = -1;\n      this.commandList = [];\n    }\n    this.commands = [];\n  }\n  private change(_list: ICommandItem[]) {\n    this.options.change(_list);\n  }\n  get(): ICommandItem[] {\n    if (this.position >= 0 && this.position < this.commandList.length) {\n      return this.commandList[this.position];\n    }\n    return [];\n  }\n  getLength(): number {\n    return Math.min(this.commandList.length, this.options.maxLength);\n  }\n}\n", "import {\n  StyleType,\n  WorkBookJSON,\n  WorksheetType,\n  Coordinate,\n  IModel,\n  ResultType,\n  IRange,\n  ModelCellValue,\n  CustomItem,\n  FloatElement,\n  IHistory,\n  ChangeEventType,\n  ICommandItem,\n} from '@/types';\nimport {\n  getDefaultSheetInfo,\n  assert,\n  Range,\n  DEFAULT_ROW_COUNT,\n  DEFAULT_COL_COUNT,\n  isSameRange,\n  CELL_HEIGHT,\n  CELL_WIDTH,\n  XLSX_MAX_ROW_COUNT,\n  XLSX_MAX_COL_COUNT,\n  coordinateToString,\n  stringToCoordinate,\n  getCustomWidthOrHeightKey,\n  FORMULA_PREFIX,\n  HIDE_CELL,\n  isEmpty,\n  convertToReference,\n  modelLog,\n} from '@/util';\nimport { parseFormula, CustomError } from '@/formula';\nimport { History } from './History';\nimport { $ } from '@/i18n';\n\nconst DELETE_FLAG = Symbol('delete');\n\nconst getKey = (item: ICommandItem) => {\n  return item.t + (item.k ? '.' + item.k : '');\n};\n\nfunction setData(obj: Record<string, any>, key: string, value: any) {\n  if (!obj || typeof obj !== 'object') {\n    return;\n  }\n  const keyList = key.split('.');\n  keyList.reduce((res, key, index, arr) => {\n    if (index === arr.length - 1) {\n      if (value === DELETE_FLAG) {\n        delete res[key];\n      } else {\n        res[key] = value;\n      }\n    } else if (res[key] === null || res[key] === undefined) {\n      res[key] = {};\n    }\n    return res[key];\n  }, obj);\n}\n\nexport class Model implements IModel {\n  private history: IHistory;\n  private currentSheetId = '';\n  private rangeMap: WorkBookJSON['rangeMap'] = {};\n  private workbook: WorkBookJSON['workbook'] = {};\n  private mergeCells: WorkBookJSON['mergeCells'] = {};\n  private worksheets: WorkBookJSON['worksheets'] = {};\n  private definedNames: WorkBookJSON['definedNames'] = {};\n  private customWidth: WorkBookJSON['customWidth'] = {};\n  private customHeight: WorkBookJSON['customHeight'] = {};\n  private drawings: WorkBookJSON['drawings'] = {};\n  constructor() {\n    this.history = new History({\n      undo: (item: ICommandItem) => {\n        if (item.t === 'currentSheetId') {\n          if (!this.workbook[item.o] || this.workbook[item.o].isHide) {\n            this.currentSheetId = this.getSheetId();\n          } else {\n            this.currentSheetId = item.o;\n          }\n          return;\n        }\n        const key = getKey(item);\n        setData(this, key, item.o);\n      },\n      redo: (item: ICommandItem) => {\n        if (item.t === 'currentSheetId') {\n          if (!this.workbook[item.n] || this.workbook[item.n].isHide) {\n            this.currentSheetId = this.getSheetId();\n          } else {\n            this.currentSheetId = item.n;\n          }\n          return;\n        }\n        const key = getKey(item);\n        setData(this, key, item.n);\n      },\n      change: (list) => {\n        modelLog(list);\n      },\n    });\n  }\n\n  getSheetList(): WorksheetType[] {\n    const list = Object.values(this.workbook);\n    list.sort((a, b) => a.sort - b.sort);\n    return list;\n  }\n  getActiveCell(): IRange {\n    const id = this.currentSheetId;\n    const range = this.rangeMap[id];\n    if (range) {\n      return {\n        ...range,\n      };\n    }\n    return {\n      row: 0,\n      col: 0,\n      rowCount: 1,\n      colCount: 1,\n      sheetId: id,\n    };\n  }\n  setActiveCell(newRange: IRange): void {\n    newRange.sheetId = newRange.sheetId || this.currentSheetId;\n    const sheet = this.workbook[newRange.sheetId];\n    if (!sheet) {\n      return;\n    }\n    const { row, col } = newRange;\n    if (row < 0 || col < 0 || row >= sheet.rowCount || col >= sheet.colCount) {\n      return;\n    }\n    const oldValue = this.rangeMap[newRange.sheetId];\n    if (oldValue && isSameRange(oldValue, newRange)) {\n      return;\n    }\n    this.rangeMap[newRange.sheetId] = newRange;\n\n    // this.history.push({\n    //   t: 'rangeMap',\n    //   k: newRange.sheetId,\n    //   n: newRange,\n    //   o: oldValue ? oldValue : DELETE_FLAG,\n    // });\n  }\n  addSheet(): void {\n    const list = this.getSheetList();\n    const item = getDefaultSheetInfo(list);\n    const sheet: WorksheetType = {\n      ...item,\n      isHide: false,\n      colCount: DEFAULT_COL_COUNT,\n      rowCount: DEFAULT_ROW_COUNT,\n      sort: list.length,\n    };\n    const check = this.workbook[sheet.sheetId];\n    assert(!check, $('sheet-id-is-duplicate'));\n    this.worksheets[sheet.sheetId] = this.worksheets[sheet.sheetId] || {};\n    this.workbook[sheet.sheetId] = sheet;\n\n    this.history.push({\n      t: 'workbook',\n      k: sheet.sheetId,\n      n: { ...sheet },\n      o: DELETE_FLAG,\n    });\n    this.setCurrentSheetId(sheet.sheetId);\n\n    this.setActiveCell({\n      row: 0,\n      col: 0,\n      rowCount: 1,\n      colCount: 1,\n      sheetId: sheet.sheetId,\n    });\n  }\n\n  deleteSheet(sheetId?: string): void {\n    const id = sheetId || this.currentSheetId;\n    if (!this.workbook[id]) {\n      return;\n    }\n    const sheetList = this.getSheetList();\n    const list = sheetList.filter((v) => !v.isHide);\n    assert(\n      list.length >= 2,\n      $('a-workbook-must-contains-at-least-one-visible-worksheet')\n    );\n    const newSheetId = this.getNextSheetId(id);\n    const oldSheet = this.workbook[id];\n    delete this.workbook[id];\n    const oldData = this.worksheets[id];\n    delete this.worksheets[id];\n\n    this.history.push({\n      t: 'workbook',\n      k: id,\n      n: DELETE_FLAG,\n      o: oldSheet,\n    });\n\n    this.history.push({\n      t: 'worksheets',\n      k: id,\n      n: DELETE_FLAG,\n      o: oldData,\n    });\n\n    this.setCurrentSheetId(newSheetId);\n  }\n  setTabColor(color: string, sheetId?: string): void {\n    const id = sheetId || this.currentSheetId;\n    if (!this.workbook[id]) {\n      return;\n    }\n    if (this.workbook[id].tabColor === color) {\n      return;\n    }\n    const old = this.workbook[id].tabColor;\n    this.workbook[id].tabColor = color;\n\n    this.history.push({\n      t: 'workbook',\n      k: `${id}.tabColor`,\n      n: color,\n      o: old,\n    });\n  }\n  hideSheet(sheetId?: string | undefined): void {\n    const id = sheetId || this.currentSheetId;\n    if (!this.workbook[id]) {\n      return;\n    }\n    if (this.workbook[id].isHide) {\n      return;\n    }\n    const sheetList = this.getSheetList();\n    const list = sheetList.filter((v) => !v.isHide);\n    assert(\n      list.length >= 2,\n      $('a-workbook-must-contains-at-least-one-visible-worksheet')\n    );\n    const newSheetId = this.getNextSheetId(sheetId);\n    this.workbook[id].isHide = true;\n\n    this.history.push({\n      t: 'workbook',\n      k: `${id}.isHide`,\n      n: true,\n      o: false,\n    });\n    this.setCurrentSheetId(newSheetId);\n  }\n  unhideSheet(sheetId?: string | undefined): void {\n    const id = sheetId || this.currentSheetId;\n    if (!this.workbook[id]) {\n      return;\n    }\n    if (!this.workbook[id].isHide) {\n      return;\n    }\n    this.workbook[id].isHide = false;\n\n    this.history.push({\n      t: 'workbook',\n      k: `${id}.isHide`,\n      n: false,\n      o: true,\n    });\n    this.setCurrentSheetId(id);\n  }\n  renameSheet(sheetName: string, sheetId?: string | undefined): void {\n    assert(!!sheetName, $('the-value-cannot-be-empty'));\n    const id = sheetId || this.currentSheetId;\n    const sheetList = this.getSheetList();\n    const item = sheetList.find((v) => v.name === sheetName);\n    if (item) {\n      if (item.sheetId === sheetId) {\n        return;\n      }\n      assert(false, $('sheet-name-is-duplicate'));\n    }\n    const sheetInfo = this.workbook[id];\n    const oldName = sheetInfo.name;\n    if (sheetInfo.name === sheetName) {\n      return;\n    }\n    sheetInfo.name = sheetName;\n\n    this.history.push({\n      t: 'workbook',\n      k: `${id}.name`,\n      n: sheetName,\n      o: oldName,\n    });\n  }\n  getSheetInfo(id?: string): WorksheetType | undefined {\n    const sheetId = id || this.currentSheetId;\n    const item = this.workbook[sheetId];\n    if (item) {\n      item.sheetId = sheetId;\n    }\n    return item;\n  }\n  setCurrentSheetId(newSheetId: string): void {\n    if (this.currentSheetId !== newSheetId) {\n      const oldSheetId = this.currentSheetId;\n      this.currentSheetId = newSheetId;\n      this.history.push({\n        t: 'currentSheetId',\n        k: '',\n        n: newSheetId,\n        o: oldSheetId,\n      });\n    }\n  }\n  getCurrentSheetId(): string {\n    return this.currentSheetId;\n  }\n  fromJSON = (json: WorkBookJSON): void => {\n    const {\n      workbook = {},\n      mergeCells = {},\n      customHeight = {},\n      customWidth = {},\n      definedNames = {},\n      currentSheetId = '',\n      drawings = {},\n      rangeMap = {},\n      worksheets = {},\n    } = json;\n    this.workbook = workbook;\n    this.mergeCells = mergeCells;\n    this.customWidth = customWidth;\n    this.customHeight = customHeight;\n    this.definedNames = definedNames;\n    this.drawings = drawings;\n    this.rangeMap = rangeMap;\n    this.worksheets = worksheets;\n    if (workbook[currentSheetId] && !workbook[currentSheetId].isHide) {\n      this.currentSheetId = currentSheetId;\n    } else {\n      this.currentSheetId = this.getSheetId();\n    }\n    this.history.clear(true);\n  };\n  toJSON = (): WorkBookJSON => {\n    return {\n      workbook: { ...this.workbook },\n      mergeCells: { ...this.mergeCells },\n      customHeight: { ...this.customHeight },\n      customWidth: { ...this.customWidth },\n      definedNames: { ...this.definedNames },\n      currentSheetId: this.currentSheetId,\n      drawings: { ...this.drawings },\n      rangeMap: { ...this.rangeMap },\n      worksheets: { ...this.worksheets },\n    };\n  };\n\n  setCellValues(\n    value: ResultType[][],\n    style: Array<Array<Partial<StyleType>>>,\n    ranges: IRange[],\n  ): void {\n    if (isEmpty(value)) {\n      return;\n    }\n    const [range] = ranges;\n    const { row, col } = range;\n    for (let r = 0; r < value.length; r++) {\n      for (let c = 0; c < value[r].length; c++) {\n        const t = value[r][c];\n        const temp: Coordinate = {\n          row: row + r,\n          col: col + c,\n        };\n        if (style[r] && style[r][c]) {\n          this.setStyle(style[r][c], temp);\n        }\n        if (t && typeof t === 'string' && t.startsWith(FORMULA_PREFIX)) {\n          this.setCellFormula(t, temp);\n        } else {\n          this.setCellFormula('', temp);\n          this.setCellValue(t, temp);\n        }\n      }\n    }\n  }\n\n  updateCellStyle(style: Partial<StyleType>, ranges: IRange[]): void {\n    if (isEmpty(style)) {\n      return;\n    }\n    const [range] = ranges;\n    const { row, col, rowCount, colCount } = range;\n    for (let r = row, endRow = row + rowCount; r < endRow; r++) {\n      for (let c = col, endCol = col + colCount; c < endCol; c++) {\n        this.updateStyle(style, { row: r, col: c });\n      }\n    }\n  }\n  getCell = (range: IRange): ModelCellValue | null => {\n    const { row, col, sheetId } = range;\n    const id = sheetId || this.currentSheetId;\n    if (\n      this.getRowHeight(row, id).len === HIDE_CELL ||\n      this.getColWidth(col, id).len === HIDE_CELL\n    ) {\n      return null;\n    }\n    const key = coordinateToString(row, col);\n    this.worksheets[id] = this.worksheets[id] || {};\n    const sheetData = this.worksheets[id];\n    const cellData = sheetData?.[key] || {};\n    return {\n      ...cellData,\n      row,\n      col,\n    };\n  };\n\n  addRow(rowIndex: number, count: number): void {\n    const sheetInfo = this.getSheetInfo()!;\n    if (sheetInfo.rowCount >= XLSX_MAX_ROW_COUNT) {\n      return;\n    }\n    sheetInfo.rowCount += count;\n    const id = this.currentSheetId;\n    const sheetData = this.worksheets[id];\n    if (!sheetData) {\n      return;\n    }\n    const list = Array.from(Object.keys(sheetData)).map((key) =>\n      stringToCoordinate(key),\n    );\n    list.sort((a, b) => a.row - b.row);\n    for (let i = list.length - 1; i >= 0; i--) {\n      const item = list[i];\n      if (item.row <= rowIndex) {\n        break;\n      }\n      const key = coordinateToString(item.row, item.col);\n      const newKey = coordinateToString(item.row + count, item.col);\n      const value = sheetData[key];\n      const newValue = value ? { ...value } : {};\n      const oldData = sheetData[newKey] ? { ...sheetData[newKey] } : {};\n\n      sheetData[newKey] = { ...newValue };\n      delete sheetData[key];\n\n      this.history.push({\n        t: 'worksheets',\n        k: `${id}.${key}`,\n        n: DELETE_FLAG,\n        o: newValue,\n      });\n\n      this.history.push({\n        t: 'worksheets',\n        k: `${id}.${newKey}`,\n        n: newValue,\n        o: oldData,\n      });\n    }\n  }\n  addCol(colIndex: number, count: number): void {\n    const sheetInfo = this.getSheetInfo()!;\n    if (sheetInfo.colCount >= XLSX_MAX_COL_COUNT) {\n      return;\n    }\n    sheetInfo.colCount += count;\n    const id = this.currentSheetId;\n    const sheetData = this.worksheets[id];\n    if (!sheetData) {\n      return;\n    }\n    const list = Array.from(Object.keys(sheetData)).map((key) =>\n      stringToCoordinate(key),\n    );\n    list.sort((a, b) => a.col - b.col);\n    for (let i = list.length - 1; i >= 0; i--) {\n      const item = list[i];\n      if (item.col <= colIndex) {\n        break;\n      }\n      const key = coordinateToString(item.row, item.col);\n      const newKey = coordinateToString(item.row, item.col + count);\n      const value = sheetData[key];\n      const newValue = value ? { ...value } : {};\n      const oldValue = sheetData[newKey] ? { ...sheetData[newKey] } : {};\n\n      sheetData[newKey] = { ...newValue };\n      delete sheetData[key];\n\n      this.history.push({\n        t: 'worksheets',\n        k: `${id}.${key}`,\n        n: DELETE_FLAG,\n        o: newValue,\n      });\n\n      this.history.push({\n        t: 'worksheets',\n        k: `${id}.${newKey}`,\n        n: newValue,\n        o: oldValue,\n      });\n    }\n  }\n  deleteCol(colIndex: number, count: number): void {\n    const sheetInfo = this.getSheetInfo()!;\n    sheetInfo.colCount -= count;\n    const id = this.currentSheetId;\n    const sheetData = this.worksheets[id];\n    for (const [uuid, item] of Object.entries(this.drawings)) {\n      if (item.fromCol >= colIndex) {\n        const oldValue = item.fromCol;\n        if (item.fromCol >= count) {\n          item.fromCol -= count;\n        } else {\n          item.fromCol = 0;\n        }\n        this.history.push({\n          t: 'drawings',\n          k: `${uuid}.fromCol`,\n          n: item.fromCol,\n          o: oldValue,\n        });\n      }\n      if (item.type === 'chart' && item.chartRange!.col >= colIndex) {\n        const oldCol = item.chartRange!.col;\n        const oldColCount = item.chartRange!.colCount;\n        if (item.chartRange!.col >= count) {\n          item.chartRange!.col -= count;\n        } else {\n          const t = count - item.chartRange!.col;\n          item.chartRange!.col = 0;\n          if (item.chartRange!.colCount >= t) {\n            item.chartRange!.colCount -= t;\n          } else {\n            item.chartRange!.colCount = 1;\n          }\n          this.history.push({\n            t: 'drawings',\n            k: `${uuid}.chartRange.colCount`,\n            n: item.chartRange!.col,\n            o: oldColCount,\n          });\n        }\n        this.history.push({\n          t: 'drawings',\n          k: `${uuid}.chartRange.col`,\n          n: item.chartRange!.col,\n          o: oldCol,\n        });\n      }\n    }\n\n    if (!sheetData) {\n      return;\n    }\n    const list = Array.from(Object.keys(sheetData)).map((key) =>\n      stringToCoordinate(key),\n    );\n    list.sort((a, b) => a.col - b.col);\n    for (let i = 0; i < list.length; i++) {\n      const item = list[i];\n      if (item.col < colIndex) {\n        continue;\n      }\n      const key = coordinateToString(item.row, item.col);\n      const newValue = sheetData[key] ? { ...sheetData[key] } : {};\n      if (item.col >= colIndex + count) {\n        const newKey = coordinateToString(item.row, item.col - count);\n        const oldValue = sheetData[newKey] ? { ...sheetData[newKey] } : {};\n\n        sheetData[newKey] = { ...newValue };\n        this.history.push({\n          t: 'worksheets',\n          k: `${id}.${newKey}`,\n          n: newValue,\n          o: oldValue,\n        });\n      }\n      delete sheetData[key];\n      this.history.push({\n        t: 'worksheets',\n        k: `${id}.${key}`,\n        n: DELETE_FLAG,\n        o: newValue,\n      });\n    }\n  }\n  deleteRow(rowIndex: number, count: number): void {\n    const sheetInfo = this.getSheetInfo()!;\n    sheetInfo.rowCount -= count;\n    const id = this.currentSheetId;\n    const sheetData = this.worksheets[id];\n    for (const [uuid, item] of Object.entries(this.drawings)) {\n      if (item.fromRow >= rowIndex) {\n        const oldValue = item.fromRow;\n        if (item.fromRow >= count) {\n          item.fromRow -= count;\n        } else {\n          item.fromRow = 0;\n        }\n        this.history.push({\n          t: 'drawings',\n          k: `${uuid}.fromRow`,\n          n: item.fromRow,\n          o: oldValue,\n        });\n      }\n      if (item.type === 'chart' && item.chartRange!.row >= rowIndex) {\n        const oldRow = item.chartRange!.row;\n        const oldRowCount = item.chartRange!.rowCount;\n        if (item.chartRange!.row >= count) {\n          item.chartRange!.row -= count;\n        } else {\n          const t = count - item.chartRange!.row;\n          item.chartRange!.row = 0;\n          if (item.chartRange!.rowCount >= t) {\n            item.chartRange!.rowCount -= t;\n          } else {\n            item.chartRange!.rowCount = 1;\n          }\n          this.history.push({\n            t: 'drawings',\n            k: `${uuid}.chartRange.rowCount`,\n            n: item.chartRange!.row,\n            o: oldRowCount,\n          });\n        }\n        this.history.push({\n          t: 'drawings',\n          k: `${uuid}.chartRange.row`,\n          n: item.chartRange!.row,\n          o: oldRow,\n        });\n      }\n    }\n\n    if (!sheetData) {\n      return;\n    }\n    const list = Array.from(Object.keys(sheetData)).map((key) =>\n      stringToCoordinate(key),\n    );\n    list.sort((a, b) => a.row - b.row);\n    for (let i = 0; i < list.length; i++) {\n      const item = list[i];\n      if (item.row < rowIndex) {\n        continue;\n      }\n      const key = coordinateToString(item.row, item.col);\n      const newValue = sheetData[key] ? { ...sheetData[key] } : {};\n      if (item.row >= rowIndex + count) {\n        const newKey = coordinateToString(item.row - count, item.col);\n        const oldValue = sheetData[newKey] ? { ...sheetData[newKey] } : {};\n        sheetData[newKey] = { ...newValue };\n        this.history.push({\n          t: 'worksheets',\n          k: `${id}.${newKey}`,\n          n: newValue,\n          o: oldValue,\n        });\n      }\n      delete sheetData[key];\n      this.history.push({\n        t: 'worksheets',\n        k: `${id}.${key}`,\n        n: DELETE_FLAG,\n        o: newValue,\n      });\n    }\n  }\n\n  hideCol(colIndex: number, count: number): void {\n    for (let i = 0; i < count; i++) {\n      const c = colIndex + i;\n      const key = getCustomWidthOrHeightKey(this.currentSheetId, c);\n      const old = this.customWidth[key];\n      if (old && old.isHide) {\n        continue;\n      }\n      const newData = old\n        ? { ...old, isHide: true }\n        : {\n            len: CELL_WIDTH,\n            isHide: true,\n          };\n      this.customWidth[key] = newData;\n      this.history.push({\n        t: 'customWidth',\n        k: key,\n        n: { ...newData },\n        o: { ...old },\n      });\n    }\n  }\n  getColWidth(col: number, sheetId?: string): CustomItem {\n    const id = sheetId || this.currentSheetId;\n    const key = getCustomWidthOrHeightKey(id, col);\n    const temp = this.customWidth[key];\n    if (!temp) {\n      return {\n        len: CELL_WIDTH,\n        isHide: false,\n      };\n    }\n    if (temp.isHide) {\n      return {\n        isHide: true,\n        len: HIDE_CELL,\n      };\n    } else {\n      return { ...temp };\n    }\n  }\n  setColWidth(\n    col: number,\n    width: number,\n    _isChanged: boolean,\n    sheetId?: string,\n  ): void {\n    const id = sheetId || this.currentSheetId;\n    const key = getCustomWidthOrHeightKey(id, col);\n\n    const oldData = this.getColWidth(col, sheetId);\n    if (oldData.len === width) {\n      return;\n    }\n\n    const newData = { ...oldData };\n\n    newData.len = width;\n    this.customWidth[key] = newData;\n    if (!_isChanged) {\n      return;\n    }\n    this.history.push({\n      t: 'customWidth',\n      k: key,\n      n: newData,\n      o: this.customWidth[key] ? this.customWidth[key] : DELETE_FLAG,\n    });\n  }\n\n  hideRow(rowIndex: number, count: number): void {\n    for (let i = 0; i < count; i++) {\n      const r = rowIndex + i;\n      const key = getCustomWidthOrHeightKey(this.currentSheetId, r);\n      const old = this.customHeight[key];\n\n      if (old && old.isHide) {\n        continue;\n      }\n      const newData = old\n        ? { ...old, isHide: true }\n        : {\n            len: CELL_HEIGHT,\n            isHide: true,\n          };\n      this.customHeight[key] = newData;\n      this.history.push({\n        t: 'customHeight',\n        k: key,\n        n: newData,\n        o: old,\n      });\n    }\n  }\n  getRowHeight(row: number, sheetId?: string): CustomItem {\n    const id = sheetId || this.currentSheetId;\n    const key = getCustomWidthOrHeightKey(id, row);\n    const temp = this.customHeight[key];\n    if (!temp) {\n      return {\n        len: CELL_HEIGHT,\n        isHide: false,\n      };\n    }\n\n    if (temp.isHide) {\n      return {\n        isHide: true,\n        len: HIDE_CELL,\n      };\n    } else {\n      return { ...temp };\n    }\n  }\n  setRowHeight(\n    row: number,\n    height: number,\n    _isChanged: boolean,\n    sheetId?: string,\n  ): void {\n    const id = sheetId || this.currentSheetId;\n    const key = getCustomWidthOrHeightKey(id, row);\n\n    const oldData = this.getRowHeight(row, sheetId);\n    if (oldData.len === height) {\n      return;\n    }\n\n    const newData = { ...oldData };\n    newData.len = height;\n    this.customHeight[key] = newData;\n    if (!_isChanged) {\n      return;\n    }\n    this.history.push({\n      t: 'customHeight',\n      k: key,\n      n: newData,\n      o: this.customHeight[key] ? this.customHeight[key] : DELETE_FLAG,\n    });\n  }\n  canRedo(): boolean {\n    return this.history.canRedo();\n  }\n  canUndo(): boolean {\n    return this.history.canUndo();\n  }\n  undo(): void {\n    this.history.undo();\n  }\n  redo(): void {\n    this.history.redo();\n  }\n\n  pasteRange(fromRange: IRange, isCut: boolean): IRange {\n    const id = this.currentSheetId;\n    const activeCell = this.getActiveCell();\n\n    const { row, col, rowCount, colCount, sheetId } = fromRange;\n    const realSheetId = sheetId || id;\n    const fromSheetData = this.worksheets[realSheetId];\n\n    const realRange: IRange = {\n      ...activeCell,\n      rowCount,\n      colCount,\n    };\n\n    if (!fromSheetData) {\n      return realRange;\n    }\n    this.worksheets[id] = this.worksheets[id] || {};\n    const currentSheetData = this.worksheets[id];\n    this.iterateRange(fromRange, (r, c) => {\n      const oldPath = coordinateToString(r, c);\n      const newValue = fromSheetData[oldPath]\n        ? { ...fromSheetData[oldPath] }\n        : {};\n      const realRow = activeCell.row + (r - row);\n      const realCol = activeCell.col + (c - col);\n      const path = coordinateToString(realRow, realCol);\n      const oldValue = currentSheetData[path]\n        ? { ...currentSheetData[path] }\n        : {};\n      currentSheetData[path] = { ...newValue };\n      this.history.push({\n        t: 'worksheets',\n        k: `${id}.${path}`,\n        n: newValue,\n        o: oldValue,\n      });\n\n      if (isCut) {\n        delete fromSheetData[oldPath];\n        this.history.push({\n          t: 'worksheets',\n          k: `${realSheetId}.${oldPath}`,\n          n: DELETE_FLAG,\n          o: newValue,\n        });\n      }\n      return false;\n    });\n\n    return realRange;\n  }\n  deleteAll(sheetId?: string): void {\n    const id = sheetId || this.currentSheetId;\n    const oldSheetData = this.worksheets[id] ? { ...this.worksheets[id] } : {};\n    delete this.worksheets[id];\n\n    this.history.push({\n      t: 'worksheets',\n      k: id,\n      n: DELETE_FLAG,\n      o: oldSheetData,\n    });\n\n    for (const [key, value] of Object.entries(this.mergeCells)) {\n      if (value.sheetId === id) {\n        delete this.mergeCells[key];\n        this.history.push({\n          t: 'mergeCells',\n          k: key,\n          n: DELETE_FLAG,\n          o: value,\n        });\n      }\n    }\n\n    for (const [key, value] of Object.entries(this.drawings)) {\n      if (value.sheetId === id) {\n        delete this.drawings[key];\n        this.history.push({\n          t: 'drawings',\n          k: key,\n          n: DELETE_FLAG,\n          o: value,\n        });\n      }\n    }\n\n    for (const [key, value] of Object.entries(this.customHeight)) {\n      if (key.startsWith(id)) {\n        delete this.customHeight[key];\n        this.history.push({\n          t: 'customHeight',\n          k: key,\n          n: DELETE_FLAG,\n          o: value,\n        });\n      }\n    }\n\n    for (const [key, value] of Object.entries(this.customWidth)) {\n      if (key.startsWith(id)) {\n        delete this.customWidth[key];\n        this.history.push({\n          t: 'customWidth',\n          k: key,\n          n: DELETE_FLAG,\n          o: value,\n        });\n      }\n    }\n\n    for (const [key, value] of Object.entries(this.definedNames)) {\n      if (key.startsWith(id)) {\n        delete this.definedNames[key];\n        this.history.push({\n          t: 'definedNames',\n          k: key,\n          n: DELETE_FLAG,\n          o: value,\n        });\n      }\n    }\n  }\n  getDefineName(range: IRange): string {\n    const sheetId = range.sheetId || this.currentSheetId;\n    for (const [key, t] of Object.entries(this.definedNames)) {\n      if (!t) {\n        continue;\n      }\n      if (t.row === range.row && t.col === range.col && t.sheetId === sheetId) {\n        return key;\n      }\n    }\n    return '';\n  }\n  setDefineName(range: IRange, name: string): void {\n    const oldName = this.getDefineName(range);\n    if (\n      oldName &&\n      Object.prototype.hasOwnProperty.call(this.definedNames, oldName)\n    ) {\n      delete this.definedNames[oldName];\n    }\n    const result: IRange = {\n      row: range.row,\n      col: range.col,\n      sheetId: this.currentSheetId,\n      colCount: 1,\n      rowCount: 1,\n    };\n    this.definedNames[name] = result;\n\n    if (oldName) {\n      this.history.push({\n        t: 'definedNames',\n        k: name,\n        n: result,\n        o: DELETE_FLAG,\n      });\n\n      this.history.push({\n        t: 'definedNames',\n        k: oldName,\n        n: DELETE_FLAG,\n        o: result,\n      });\n    } else {\n      this.history.push({\n        t: 'definedNames',\n        k: name,\n        n: result,\n        o: DELETE_FLAG,\n      });\n    }\n  }\n  checkDefineName(name: string): IRange | undefined {\n    return this.definedNames[name];\n  }\n\n  private setCellValue(value: ResultType, range: Coordinate): void {\n    const { row, col } = range;\n    const id = this.currentSheetId;\n    this.worksheets[id] = this.worksheets[id] || {};\n    const sheetData = this.worksheets[id];\n    const key = coordinateToString(row, col);\n    sheetData[key] = sheetData[key] || {};\n    const oldData = sheetData[key];\n    if (oldData.value === value) {\n      return;\n    }\n    const oldValue = oldData.value ?? '';\n    const newValue = value ?? '';\n    sheetData[key].value = newValue;\n\n    this.history.push({\n      t: 'worksheets',\n      k: `${id}.${key}.value`,\n      n: newValue,\n      o: oldValue,\n    });\n  }\n  private setCellFormula(formula: string, range: Coordinate): void {\n    const { row, col } = range;\n    const id = this.currentSheetId;\n    this.worksheets[id] = this.worksheets[id] || {};\n    const sheetData = this.worksheets[id];\n    const key = coordinateToString(row, col);\n    sheetData[key] = sheetData[key] || {};\n    const oldData = sheetData[key];\n    const oldFormula = oldData.formula;\n    if (oldFormula === formula) {\n      return;\n    }\n    sheetData[key].formula = formula;\n\n    this.history.push({\n      t: 'worksheets',\n      k: `${id}.${key}.formula`,\n      n: formula,\n      o: oldFormula,\n    });\n  }\n  private computeAllCell() {\n    for (const [key, sheetData] of Object.entries(this.worksheets)) {\n      if (!sheetData) {\n        continue;\n      }\n      for (const [k, data] of Object.entries(sheetData)) {\n        if (data?.formula) {\n          const result = this.parseFormula(data.formula);\n          const newValue = result.error ? result.error : result.result;\n          const oldValue = data.value;\n          if (newValue !== oldValue) {\n            data.value = newValue;\n            this.history.push({\n              t: 'worksheets',\n              k: `${key}.${k}.value`,\n              n: newValue,\n              o: oldValue,\n            });\n          }\n        }\n      }\n    }\n  }\n  private iterateRange(\n    range: IRange,\n    fn: (row: number, col: number) => boolean,\n  ) {\n    const { row, col, rowCount, colCount, sheetId } = range;\n    const sheetInfo = this.getSheetInfo(sheetId);\n    if (!sheetInfo) {\n      return;\n    }\n    if (colCount === 0 && rowCount > 0) {\n      for (let r = row, endRow = row + sheetInfo.rowCount; r < endRow; r++) {\n        if (fn(r, col)) {\n          break;\n        }\n      }\n    } else if (rowCount === 0 && colCount > 0) {\n      for (let c = col, endCol = col + sheetInfo.colCount; c < endCol; c++) {\n        if (fn(row, c)) {\n          break;\n        }\n      }\n    } else {\n      for (\n        let r = row, endRow = row + (rowCount || sheetInfo.rowCount);\n        r < endRow;\n        r++\n      ) {\n        for (\n          let c = col, endCol = col + (colCount || sheetInfo.colCount);\n          c < endCol;\n          c++\n        ) {\n          if (fn(r, c)) {\n            return;\n          }\n        }\n      }\n    }\n  }\n  private parseFormula(formula: string) {\n    const result = parseFormula(\n      formula,\n      {\n        get: (range: IRange) => {\n          const { row, col, sheetId } = range;\n          const result: ResultType[] = [];\n          const sheetInfo = this.getSheetInfo(sheetId);\n          if (\n            !sheetInfo ||\n            row >= sheetInfo.rowCount ||\n            col >= sheetInfo.colCount\n          ) {\n            throw new CustomError('#REF!');\n          }\n          this.iterateRange(range, (r, c) => {\n            const temp = this.getCell(new Range(r, c, 1, 1, sheetId));\n            if (temp) {\n              result.push(temp.value);\n            }\n            return false;\n          });\n          return result;\n        },\n        set: () => {\n          throw new CustomError('#REF!');\n        },\n        convertSheetNameToSheetId: this.convertSheetNameToSheetId,\n      },\n      {\n        set: () => {\n          throw new CustomError('#REF!');\n        },\n        get: (name: string) => this.checkDefineName(name),\n        has: (name: string) => {\n          const t = this.checkDefineName(name);\n          return Boolean(t);\n        },\n      },\n    );\n    return result;\n  }\n  private getNextSheetId(sheetId?: string) {\n    const id = sheetId || this.currentSheetId;\n    const list = this.getSheetList();\n    const index = list.findIndex((item) => item.sheetId === id);\n    assert(index >= 0);\n    const isLast = index === list.length - 1;\n    let lastIndex = isLast\n      ? (index - 1 + list.length) % list.length\n      : (index + 1) % list.length;\n    while (lastIndex !== index) {\n      if (list[lastIndex].isHide) {\n        lastIndex = isLast\n          ? (lastIndex - 1 + list.length) % list.length\n          : (lastIndex + 1) % list.length;\n      } else {\n        break;\n      }\n    }\n    return list[lastIndex].sheetId;\n  }\n  private getSheetId() {\n    const list = this.getSheetList();\n    const result = list.filter((v) => !v.isHide);\n    return result[0].sheetId;\n  }\n  private updateStyle(style: Partial<StyleType>, range: Coordinate) {\n    if (isEmpty(style)) {\n      return;\n    }\n    const key = coordinateToString(range.row, range.col);\n    const id = this.currentSheetId;\n    this.worksheets[id] = this.worksheets[id] || {};\n    const sheetData = this.worksheets[id];\n    sheetData[key] = sheetData[key] || {};\n    sheetData[key].style = sheetData[key].style || {};\n    const keyList = Object.keys(style) as Array<keyof Partial<StyleType>>;\n    for (const k of keyList) {\n      const oldValue = sheetData[key]?.style?.[k];\n\n      const newValue = style[k];\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      sheetData[key].style[k] = newValue;\n\n      this.history.push({\n        t: 'worksheets',\n        k: `${id}.${key}.style.${k}`,\n        n: newValue,\n        o: oldValue === undefined ? DELETE_FLAG : oldValue,\n      });\n    }\n  }\n\n  private setStyle(style: Partial<StyleType>, range: Coordinate) {\n    const key = coordinateToString(range.row, range.col);\n    const id = this.currentSheetId;\n    this.worksheets[id] = this.worksheets[id] || {};\n    const sheetData = this.worksheets[id];\n    sheetData[key] = sheetData[key] || {};\n    const cellData = sheetData[key];\n\n    const styleData = cellData.style || {};\n\n    const oldStyle = { ...styleData };\n    sheetData[key].style = style;\n\n    this.history.push({\n      t: 'worksheets',\n      k: `${id}.${key}.style`,\n      n: style,\n      o: oldStyle,\n    });\n  }\n  getFloatElementList(sheetId: string): FloatElement[] {\n    const id = sheetId || this.currentSheetId;\n    const list = Object.values(this.drawings).filter((v) => v.sheetId === id);\n    return list;\n  }\n  addFloatElement(data: FloatElement) {\n    const oldData = this.drawings[data.uuid];\n    assert(!oldData, $('uuid-is-duplicate'));\n    if (data.type === 'chart') {\n      const range = data.chartRange!;\n      let check = false;\n      this.iterateRange(range, (row: number, col: number) => {\n        const data = this.getCell({\n          row,\n          col,\n          rowCount: 1,\n          colCount: 1,\n          sheetId: '',\n        });\n        if (data?.value) {\n          check = true;\n          return true;\n        } else {\n          return false;\n        }\n      });\n      assert(check, $('cells-must-contain-data'));\n    } else if (data.type === 'floating-picture') {\n      assert(!!data.imageSrc, $('image-source-is-empty'));\n      if (typeof data.imageAngle !== 'number') {\n        data.imageAngle = 0;\n      }\n    }\n    this.drawings[data.uuid] = data;\n    this.history.push({\n      t: 'drawings',\n      k: data.uuid,\n      n: data,\n      o: DELETE_FLAG,\n    });\n  }\n  updateFloatElement(uuid: string, value: Partial<FloatElement>) {\n    const item = this.drawings[uuid];\n    if (!item) {\n      return;\n    }\n    const keyList = Object.keys(value) as Array<keyof FloatElement>;\n    for (const key of keyList) {\n      if (item[key] !== value[key]) {\n        const oldValue = item[key];\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        item[key] = value[key];\n        this.history.push({\n          t: 'drawings',\n          k: `${uuid}.${key}`,\n          n: item[key],\n          o: oldValue,\n        });\n      }\n    }\n  }\n  deleteFloatElement(uuid: string) {\n    const oldData = this.drawings[uuid];\n    if (!oldData) {\n      return;\n    }\n    delete this.drawings[uuid];\n    this.history.push({\n      t: 'drawings',\n      k: uuid,\n      n: DELETE_FLAG,\n      o: oldData,\n    });\n  }\n  getMergeCells(sheetId?: string): IRange[] {\n    const id = sheetId || this.currentSheetId;\n    return Object.values(this.mergeCells).filter((v) => v.sheetId === id);\n  }\n  addMergeCell(range: IRange): void {\n    if (range.colCount > 1 || range.rowCount > 1) {\n      range.sheetId = range.sheetId || this.currentSheetId;\n      const ref = convertToReference(\n        range,\n        'absolute',\n        this.convertSheetIdToName,\n      );\n      assert(!this.mergeCells[ref], $('merging-cell-is-duplicate'));\n      this.mergeCells[ref] = range;\n      this.history.push({\n        t: 'mergeCells',\n        k: ref,\n        n: range,\n        o: DELETE_FLAG,\n      });\n    }\n  }\n  deleteMergeCell(range: IRange): void {\n    range.sheetId = range.sheetId || this.currentSheetId;\n    const ref = convertToReference(\n      range,\n      'absolute',\n      this.convertSheetIdToName,\n    );\n    if (!this.mergeCells[ref]) {\n      return;\n    }\n    const oldRange = this.mergeCells[ref];\n    delete this.mergeCells[ref];\n\n    this.history.push({\n      t: 'mergeCells',\n      k: ref,\n      n: DELETE_FLAG,\n      o: oldRange,\n    });\n  }\n  emitChange(dataset: Set<ChangeEventType>) {\n    if (dataset.has('cellValue')) {\n      this.computeAllCell();\n    }\n    if (!dataset.has('undoRedo')) {\n      this.history.commit();\n    }\n    this.history.clear(false);\n  }\n  private convertSheetIdToName = (sheetId: string) => {\n    const data = this.workbook[sheetId];\n    return data?.name || '';\n  };\n  private convertSheetNameToSheetId = (sheetName: string): string => {\n    const item = this.getSheetList().find((v) => v.name === sheetName);\n    return item?.sheetId || '';\n  };\n}\n", "export const mockImage =\n  'data:image/jpeg;base64,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';\n", "import { WorkBookJSON, EUnderLine } from '@/types';\nimport {\n  DEFAULT_ROW_COUNT,\n  DEFAULT_COL_COUNT,\n  generateUUID,\n  isMobile,\n} from '@/util';\nimport { mockImage } from './mockData';\n\nconst MOCK_MODEL: WorkBookJSON = {\n  currentSheetId: '',\n  rangeMap: {\n    '1': {\n      row: 2,\n      col: 2,\n      rowCount: 1,\n      colCount: 1,\n      sheetId: '1',\n    },\n    '2': {\n      row: 4,\n      col: 4,\n      rowCount: 2,\n      colCount: 2,\n      sheetId: '2',\n    },\n    '3': {\n      row: 4,\n      col: 4,\n      rowCount: 2,\n      colCount: 2,\n      sheetId: '3',\n    },\n  },\n  workbook: {\n    '1': {\n      sheetId: '1',\n      name: 'basic',\n      isHide: false,\n      colCount: DEFAULT_COL_COUNT,\n      rowCount: DEFAULT_ROW_COUNT,\n      sort: 1,\n    },\n    '2': {\n      sheetId: '2',\n      name: 'floating-picture',\n      isHide: false,\n      colCount: DEFAULT_COL_COUNT,\n      rowCount: DEFAULT_ROW_COUNT,\n      sort: 2,\n      tabColor: '#FE4B4B',\n    },\n    '3': {\n      sheetId: '3',\n      name: 'hide',\n      isHide: true,\n      colCount: DEFAULT_COL_COUNT,\n      rowCount: DEFAULT_ROW_COUNT,\n      sort: 3,\n    },\n    '4': {\n      sheetId: '4',\n      name: 'chart',\n      isHide: false,\n      colCount: DEFAULT_COL_COUNT,\n      rowCount: DEFAULT_ROW_COUNT,\n      sort: 4,\n      tabColor: '#CEF273',\n    },\n    '5': {\n      sheetId: '5',\n      name: 'defined name',\n      isHide: false,\n      colCount: DEFAULT_COL_COUNT,\n      rowCount: DEFAULT_ROW_COUNT,\n      sort: 5,\n      tabColor: '#76EFEF',\n    },\n    '6': {\n      sheetId: '6',\n      name: 'unicode',\n      isHide: false,\n      colCount: DEFAULT_COL_COUNT,\n      rowCount: DEFAULT_ROW_COUNT,\n      sort: 6,\n      tabColor: '#9E6DE3',\n    },\n    '7': {\n      sheetId: '7',\n      name: 'formula',\n      isHide: false,\n      colCount: DEFAULT_COL_COUNT,\n      rowCount: DEFAULT_ROW_COUNT,\n      sort: 7,\n      tabColor: '#E7258F',\n    },\n  },\n  worksheets: {\n    '1': {\n      '0_0': {\n        value: '1',\n        style: {\n          fontColor: '#ff0000',\n        },\n      },\n\n      '0_3': {\n        value: 'large text',\n        style: {\n          fontSize: 36,\n        },\n      },\n      '0_4': {\n        value: 'This is a very long text that needs to be wrapped',\n        style: {\n          isWrapText: true,\n          isStrike: true,\n          isItalic: true,\n          underline: EUnderLine.DOUBLE,\n        },\n      },\n      '0_5': {\n        value: '10',\n      },\n\n      '1_0': {\n        formula: '=SUM(F:F)',\n      },\n      '1_5': {\n        value: '5',\n      },\n      '3_0': {\n        style: {\n          fillColor: 'red',\n        },\n      },\n      '3_1': {\n        style: {\n          fillColor: 'red',\n        },\n      },\n      '4_0': {\n        style: {\n          fillColor: 'red',\n        },\n      },\n      '4_1': {\n        style: {\n          fillColor: 'red',\n        },\n      },\n    },\n    '2': {\n      '0_0': {\n        formula: '=basic!A1',\n      },\n    },\n    '4': {\n      '6_6': {\n        value: 3,\n      },\n      '6_7': {\n        value: 6,\n      },\n      '6_8': {\n        value: 29,\n      },\n      '7_6': {\n        value: 35,\n      },\n      '7_7': {\n        value: 15,\n      },\n      '7_8': {\n        value: 34,\n      },\n      '8_6': {\n        value: 23,\n      },\n      '8_7': {\n        value: 24,\n      },\n      '8_8': {\n        value: 15,\n      },\n    },\n    '5': {\n      '0_0': {\n        value: '1',\n      },\n      '0_2': {\n        value: '',\n        formula: '=foo',\n      },\n    },\n    '6': {\n      '0_1': {\n        value: 'Z\u0351\u036B\u0343\u036A\u0302\u036B\u033D\u034F\u0334\u0319\u0324\u031E\u0349\u035A\u032F\u031E\u0320\u034DA\u036B\u0357\u0334\u0362\u0335\u031C\u0330\u0354L\u0368\u0367\u0369\u0358\u0320G\u0311\u0357\u030E\u0305\u035B\u0341\u0334\u033B\u0348\u034D\u0354\u0339O\u0342\u030C\u030C\u0358\u0328\u0335\u0339\u033B\u031D\u0333!\u033F\u030B\u0365\u0365\u0302\u0363\u0310\u0301\u0301\u035E\u035C\u0356\u032C\u0330\u0319\u0317',\n        style: {\n          fontSize: 26,\n        },\n      },\n      '0_6': {\n        formula: '=CONCAT(\"\uD83D\uDE0A\", \"\uD83D\uDC68\u200D\uD83D\uDC68\u200D\uD83D\uDC67\u200D\uD83D\uDC67\", \"\uD83D\uDC66\uD83C\uDFFE\")',\n        style: {\n          fontSize: 36,\n        },\n      },\n      '0_7': {\n        value: '\u1103\u1167\u1109\u1170',\n        style: {\n          fontSize: 36,\n        },\n      },\n      '0_8': {\n        value: 'L\u0301o\u0342r\u030Ce\u0327m\u0305',\n        style: {\n          fontSize: 36,\n        },\n      },\n      '0_10': {\n        value: '\uD83C\uDF37\uD83C\uDF81\uD83D\uDCA9\uD83D\uDE1C\uD83D\uDC4D\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08',\n      },\n    },\n    '7': {\n      '0_0': {\n        formula: '=SUM(1,2)',\n      },\n      '0_1': {\n        value: 'test',\n      },\n      '0_2': {\n        formula: '=CONCATENATE(A1,B1)',\n      },\n      '0_3': {\n        formula: '=UNICODE(\"\u6D4B\u8BD5\")',\n      },\n      '1_0': {\n        formula: '=PI()',\n      },\n      '2_0': {\n        formula: '=E()',\n      },\n      '3_0': {\n        formula: '=E()*PI()',\n      },\n      '4_0': {\n        formula: '=SUM(1, SIN(PI()/2),3)',\n      },\n    },\n  },\n\n  // TODO:\n  mergeCells: {},\n  customHeight: {},\n  customWidth: {},\n  definedNames: {\n    foo: {\n      row: 0,\n      col: 0,\n      rowCount: 1,\n      colCount: 1,\n      sheetId: '5',\n    },\n  },\n  drawings: {},\n};\n\nif (!isMobile()) {\n  const imageUuid = generateUUID();\n  MOCK_MODEL.drawings[imageUuid] = {\n    title: 'icon',\n    type: 'floating-picture',\n    uuid: imageUuid,\n    imageSrc: mockImage,\n    width: 200,\n    height: 356,\n    originHeight: 356,\n    originWidth: 200,\n    sheetId: '2',\n    fromCol: 1,\n    fromRow: 1,\n    marginX: 0,\n    marginY: 0,\n  };\n  const chartUuid = generateUUID();\n  MOCK_MODEL.drawings[chartUuid] = {\n    title: 'Chart Title',\n    type: 'chart',\n    uuid: chartUuid,\n    width: 400,\n    height: 250,\n    originHeight: 250,\n    originWidth: 400,\n    marginX: 0,\n    marginY: 0,\n    sheetId: '4',\n    fromCol: 4,\n    fromRow: 4,\n    chartType: 'bar',\n    chartRange: {\n      row: 6,\n      col: 6,\n      colCount: 3,\n      rowCount: 3,\n      sheetId: '4',\n    },\n  };\n}\n\nexport { MOCK_MODEL };\n", "import { Model } from '@/model';\nimport { IController } from '@/types';\nimport { Controller } from './Controller';\n\nexport function initController(): IController {\n  const model = new Model();\n  const controller = new Controller(model);\n  controller.addSheet();\n  (window as any).controller = controller;\n  (window as any).model = model;\n  return controller;\n}\n"],
  "mappings": "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CA,EAAO,MAAM,KAAK;AAAA,CAAI,CAAC;AAAA;AAAA,oBAETA,EAAO,MAAM,MAAM;AAAA,MACjCA,EAAO,MAAM,KAAK;AAAA,CAAI,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAkQPA,EAAO,QAAQ,MAAM;AAAA,MACrCA,EAAO,QAAQ,KAAK;AAAA,CAAI,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA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,GACR,SAAUD,GACV,SAAUC,GACV,KAAM,CACR,EACA,EAAK,CACH,QAAS,IACT,KAAM,QACN,OAAQ,GACR,SAAUD,GACV,SAAUC,GACV,KAAM,EACN,SAAU,SACZ,EACA,EAAK,CACH,QAAS,IACT,KAAM,eACN,OAAQ,GACR,SAAUD,GACV,SAAUC,GACV,KAAM,EACN,SAAU,SACZ,EACA,EAAK,CACH,QAAS,IACT,KAAM,UACN,OAAQ,GACR,SAAUD,GACV,SAAUC,GACV,KAAM,EACN,SAAU,SACZ,EACA,EAAK,CACH,QAAS,IACT,KAAM,UACN,OAAQ,GACR,SAAUD,GACV,SAAUC,GACV,KAAM,EACN,SAAU,SACZ,CACF,EACA,WAAY,CACV,EAAK,CACH,MAAO,CACL,MAAO,IACP,MAAO,CACL,UAAW,SACb,CACF,EAEA,MAAO,CACL,MAAO,aACP,MAAO,CACL,SAAU,EACZ,CACF,EACA,MAAO,CACL,MAAO,oDACP,MAAO,CACL,WAAY,GACZ,SAAU,GACV,SAAU,GACV,WACF,CACF,EACA,MAAO,CACL,MAAO,IACT,EAEA,MAAO,CACL,QAAS,WACX,EACA,MAAO,CACL,MAAO,GACT,EACA,MAAO,CACL,MAAO,CACL,UAAW,KACb,CACF,EACA,MAAO,CACL,MAAO,CACL,UAAW,KACb,CACF,EACA,MAAO,CACL,MAAO,CACL,UAAW,KACb,CACF,EACA,MAAO,CACL,MAAO,CACL,UAAW,KACb,CACF,CACF,EACA,EAAK,CACH,MAAO,CACL,QAAS,WACX,CACF,EACA,EAAK,CACH,MAAO,CACL,MAAO,CACT,EACA,MAAO,CACL,MAAO,CACT,EACA,MAAO,CACL,MAAO,EACT,EACA,MAAO,CACL,MAAO,EACT,EACA,MAAO,CACL,MAAO,EACT,EACA,MAAO,CACL,MAAO,EACT,EACA,MAAO,CACL,MAAO,EACT,EACA,MAAO,CACL,MAAO,EACT,EACA,MAAO,CACL,MAAO,EACT,CACF,EACA,EAAK,CACH,MAAO,CACL,MAAO,GACT,EACA,MAAO,CACL,MAAO,GACP,QAAS,MACX,CACF,EACA,EAAK,CACH,MAAO,CACL,MAAO,uaACP,MAAO,CACL,SAAU,EACZ,CACF,EACA,MAAO,CACL,QAAS,uGACT,MAAO,CACL,SAAU,EACZ,CACF,EACA,MAAO,CACL,MAAO,2BACP,MAAO,CACL,SAAU,EACZ,CACF,EACA,MAAO,CACL,MAAO,sCACP,MAAO,CACL,SAAU,EACZ,CACF,EACA,OAAQ,CACN,MAAO,6EACT,CACF,EACA,EAAK,CACH,MAAO,CACL,QAAS,WACX,EACA,MAAO,CACL,MAAO,MACT,EACA,MAAO,CACL,QAAS,qBACX,EACA,MAAO,CACL,QAAS,0BACX,EACA,MAAO,CACL,QAAS,OACX,EACA,MAAO,CACL,QAAS,MACX,EACA,MAAO,CACL,QAAS,WACX,EACA,MAAO,CACL,QAAS,wBACX,CACF,CACF,EAGA,WAAY,CAAC,EACb,aAAc,CAAC,EACf,YAAa,CAAC,EACd,aAAc,CACZ,IAAK,CACH,IAAK,EACL,IAAK,EACL,SAAU,EACV,SAAU,EACV,QAAS,GACX,CACF,EACA,SAAU,CAAC,CACb,EAEA,GAAI,CAACC,GAAS,EAAG,CACf,IAAMC,EAAYC,GAAa,EAC/BL,GAAW,SAASI,CAAS,EAAI,CAC/B,MAAO,OACP,KAAM,mBACN,KAAMA,EACN,SAAUE,GACV,MAAO,IACP,OAAQ,IACR,aAAc,IACd,YAAa,IACb,QAAS,IACT,QAAS,EACT,QAAS,EACT,QAAS,EACT,QAAS,CACX,EACA,IAAMC,EAAYF,GAAa,EAC/BL,GAAW,SAASO,CAAS,EAAI,CAC/B,MAAO,cACP,KAAM,QACN,KAAMA,EACN,MAAO,IACP,OAAQ,IACR,aAAc,IACd,YAAa,IACb,QAAS,EACT,QAAS,EACT,QAAS,IACT,QAAS,EACT,QAAS,EACT,UAAW,MACX,WAAY,CACV,IAAK,EACL,IAAK,EACL,SAAU,EACV,SAAU,EACV,QAAS,GACX,CACF,CACF,CChTO,SAASC,IAA8B,CAC5C,IAAMC,EAAQ,IAAIC,GACZC,EAAa,IAAIC,GAAWH,CAAK,EACvC,OAAAE,EAAW,SAAS,EACnB,OAAe,WAAaA,EAC5B,OAAe,MAAQF,EACjBE,CACT,ChBHA,SAASE,IAAa,CAChB,SAAS,WAAa,aAG1B,OAAO,mBAAe,EAAE,KAAMC,GAAW,CACvCA,EAAO,KAAK,CACV,IAAK,+FACL,aAAc,CACZA,EAAO,0BAA0B,EACjCA,EAAO,kBAAkB,CACvB,YAAa,GACb,cAAe,EACjB,CAAC,CACH,EAEA,iBAAkB,EAElB,wBAAyB,CAAC,gBAAgB,EAE1C,yBAA0B,GAC1B,yBAA0B,CAC5B,CAAC,CACH,CAAC,CACH,CAEA,SAASC,GAAUC,EAAS,OAAQ,CAClC,IAAMC,EAAU,SAAS,eAAeD,CAAM,EACxCE,EAAaC,GAAe,EAElC,SADa,eAAWF,CAAO,EAC1B,OACH,GAAAG,QAAA,cAAC,mBACC,GAAAA,QAAA,cAACC,GAAA,CAAI,WAAYH,EAAY,CAC/B,CACF,EACOA,CACT,CAEA,IAAOI,GAAQ,CAAE,UAAAP,GAAW,aAAcQ,GAAY,WAAAV,GAAY,YAAAW,EAAY",
  "names": ["import_react", "canvas_default", "canvas-container", "vertical-scroll-bar", "vertical-scroll-bar-content", "horizontal-scroll-bar", "horizontal-scroll-bar-content", "context-menu", "bottom-bar", "bottom-bar-text", "add-button", "BaseStore", "initValue", "data", "newState", "deepEqual", "listener", "l", "sheetListStore", "BaseStore", "cellData", "DEFAULT_POSITION", "activeCellStore", "BaseStore", "coreStore", "BaseStore", "fontFamilyStore", "BaseStore", "initFontFamilyList", "scrollStore", "BaseStore", "floatElementStore", "BaseStore", "import_react", "measureTextMap", "measureText", "ctx", "char", "mapKey", "text", "actualBoundingBoxAscent", "actualBoundingBoxDescent", "h", "w", "width", "dpr", "height", "result", "fillRect", "x", "y", "npx", "strokeRect", "clearRect", "fillText", "drawUnderlineData", "isNum", "style", "textHeight", "textWidth", "list", "pointList", "isDouble", "t", "getPointList", "drawLines", "renderCellData", "controller", "row", "col", "range", "cellInfo", "cellSize", "position", "newSize", "renderCell", "value", "left", "top", "isEmpty", "isNumber", "font", "DEFAULT_FONT_CONFIG", "fillStyle", "getThemeColor", "fontSize", "DEFAULT_FONT_SIZE", "makeFont", "convertResultTypeToString", "ERROR_SET", "texts", "splitToWords", "sizeConfig", "lineGap", "line", "i", "testLine", "size", "first", "second", "drawTriangle", "point1", "point2", "point3", "drawAntLine", "oldDash", "offset", "isExtra", "start", "end", "resizeCanvas", "canvas", "realWidth", "realHeight", "getHeaderStyle", "DEFAULT_FONT_CONFIG", "getThemeColor", "thinLineWidth", "MainCanvas", "controller", "content", "params", "canvasLog", "width", "height", "headerSize", "contentWidth", "contentHeight", "result", "canvas", "size", "dpr", "resizeCanvas", "npx", "range", "mergeCells", "item", "position", "clearRect", "renderCellData", "isSheet", "isRow", "isCol", "containRange", "getThemeColor", "strokeRect", "rowIndex", "colIndex", "rowCount", "colCount", "lineWidth", "thinLineWidth", "pointList", "y", "x", "maxX", "i", "realWidth", "skip", "h", "w", "drawLines", "row", "v", "col", "fillRect", "getHeaderStyle", "rowHeight", "temp", "check", "fillText", "colWidth", "intToColumnName", "offset", "minY", "maxY", "minX", "drawTriangle", "ranges", "drawAntLine", "activeCell", "cellSize", "endCellRow", "endCellCol", "endCell", "endCellSize", "list", "strokeWidth", "endCol", "strokeHeight", "endRow", "handleTabClick", "controller", "checkActiveElement", "recalculateScroll", "handleEnterClick", "computeScrollRowAndCol", "left", "top", "oldScroll", "row", "col", "t", "computeScrollPosition", "canvasRect", "viewSize", "maxHeight", "BOTTOM_BUFF", "maxWidth", "maxScrollHeight", "SCROLL_SIZE", "maxScrollWidth", "scrollTop", "scrollLeft", "scrollBar", "scrollX", "scrollY", "activeCell", "temp", "position", "cellSize", "domRect", "sheetInfo", "headerSize", "buff", "checkFocus", "inputDom", "setActiveCellValue", "coreStore", "keyboardEventList", "isMac", "cellData", "underline", "newUnderline", "isInputEvent", "event", "name", "registerGlobalEvent", "controller", "resizeWindow", "handleKeydown", "list", "keyboardEventList", "v", "a", "b", "temp", "item", "coreStore", "handleWheel", "throttle", "scrollBar", "handlePaste", "handleCopy", "handleCut", "handleResize", "Content", "controller", "canvas", "ctx", "size", "dpr", "width", "height", "resizeCanvas", "changeSet", "canvasLog", "npx", "headerSize", "row", "col", "x", "y", "r", "endRow", "endCol", "rowMap", "colMap", "rowIndex", "colIndex", "renderCellData", "CELL_HEIGHT", "CELL_WIDTH", "h", "c", "w", "scrollBar", "controller", "scrollX", "scrollY", "oldScroll", "maxHeight", "maxScrollHeight", "maxScrollWidth", "maxWidth", "computeScrollPosition", "scrollTop", "scrollLeft", "top", "left", "row", "col", "computeScrollRowAndCol", "data", "ScrollBar", "state", "scrollStore", "handleDrag", "event", "handleDragEnd", "register", "status", "React", "canvas_default", "SCROLL_SIZE", "import_react", "MENU_WIDTH", "ITEM_HEIGHT", "computeMenuStyle", "controller", "top", "left", "headerSize", "rect", "clickPosition", "menuHeight", "y", "x", "realTop", "realLeft", "gap", "height", "ContextMenu", "props", "hideContextMenu", "row", "col", "colCount", "rowCount", "activeCellStore", "ref", "useClickOutside", "style", "position", "handleDialog", "isRow", "value", "handleChange", "event", "info", "$", "React", "toast", "i", "canvas_default", "Button", "createCanvas", "canvas", "getChartData", "range", "controller", "row", "col", "rowCount", "colCount", "sheetId", "result", "r", "index", "endRow", "HIDE_CELL", "list", "c", "endCol", "t", "parseNumber", "_value", "i", "updateActiveCell", "top", "activeCell", "isMerged", "cell", "defineName", "Range", "cellSize", "cellPosition", "fontFamily", "defaultFontFamily", "fontFamilyStore", "item", "isBold", "isItalic", "isStrike", "fontSize", "DEFAULT_FONT_SIZE", "fontColor", "getThemeColor", "fillColor", "isWrapText", "underline", "numberFormat", "activeCellStore", "handleStateChange", "changeSet", "sheetList", "v", "sheetListStore", "coreStore", "scroll", "scrollStore", "canvasSize", "minX", "minY", "maxX", "maxY", "p", "left", "floatElementStore", "initCanvas", "mainCanvas", "MainCanvas", "Content", "render", "resize", "removeEvent", "registerGlobalEvent", "copyOrCut", "paste", "import_react", "BottomBar", "controller", "scrollTop", "scrollStore", "headerSize", "rect", "value", "setValue", "handleChange", "event", "val", "handleClick", "sheetInfo", "viewSize", "scrollBar", "React", "canvas_default", "$", "Button", "import_react", "import_react", "FloatElement_default", "float-element", "active", "float-element-mask", "context-menu", "title", "image", "resize-handler", "resize-handler-rect", "scale-dot", "rotate-icon", "top", "bottom", "top-right", "top-left", "bottom-right", "bottom-left", "right", "left", "rotate", "import_react", "extractTypeFromBase64", "base64", "text", "i", "chartList", "$", "FloatElementContextMenu", "props", "controller", "menuLeft", "menuTop", "uuid", "type", "chartType", "title", "resetResize", "hideContextMenu", "originHeight", "originWidth", "width", "height", "ref", "useClickOutside", "selectData", "value", "convertToReference", "sheetId", "handleChange", "event", "info", "React", "realValue", "toast", "sheetList", "range", "parseReference", "sheetName", "v", "isSameRange", "changeChartTitle", "changeChartType", "newChartType", "Select", "saveAsPicture", "item", "saveAs", "dom", "FloatElement_default", "Button", "INITIAL_STATE", "roundPosition", "top", "left", "controller", "size", "canvasSize", "minTop", "minLeft", "Chart", "FloatElement", "props", "top", "left", "active", "width", "height", "type", "imageAngle", "resetResize", "pointerDown", "resizeDown", "contextMenuPosition", "setContextMenuPosition", "DEFAULT_POSITION", "handleContextMenu", "event", "hideContextMenu", "children", "React", "FloatElement_default", "Loading", "classnames", "Icon", "FloatElementContextMenu", "import_react", "InsertFloatingPicture", "controller", "ref", "readImage", "base64Image", "fileName", "image", "range", "generateUUID", "React", "Button", "event", "file", "fileType", "reader", "e", "$", "InsertChart", "FloatElementContainer", "controller", "floatElementList", "floatElementStore", "activeUuid", "coreStore", "state", "INITIAL_STATE", "position", "setPosition", "handleResizePointerDown", "event", "p", "updateSize", "e", "deltaX", "deltaY", "old", "top", "left", "width", "height", "newData", "roundPosition", "updateRotate", "imageAngle", "handlePointerUp", "rect", "newRange", "getHitInfo", "handlePointerMove", "newTop", "newLeft", "React", "classnames", "FloatElement_default", "v", "isActive", "props", "FloatElement", "size", "DOUBLE_CLICK_TIME", "CanvasContainer", "props", "controller", "state", "menuPosition", "setMenuPosition", "DEFAULT_POSITION", "ref", "initCanvas", "handleContextMenu", "event", "hideContextMenu", "handlePointerMove", "headerSize", "rect", "clientX", "clientY", "x", "y", "position", "getHitInfo", "activeCell", "colCount", "rowCount", "handlePointerDown", "canvasRect", "timeStamp", "coreStore", "checkFocus", "setActiveCellValue", "React", "canvas_default", "ScrollBar", "BottomBar", "FloatElementContainer", "ContextMenu", "import_react", "import_react", "FormulaBar_default", "formula-bar-wrapper", "formula-bar-name", "formula-bar-name-editor", "formula-bar-editor-wrapper", "formula-bar-value", "show", "base-editor", "getDisplayStyle", "style", "isFormulaBar", "result", "getEditorStyle", "editorStatus", "editorStyle", "cellPosition", "FormulaEditor", "controller", "initValue", "testId", "ref", "handleKeyDown", "event", "handleEnterClick", "handleTabClick", "React", "FormulaBar_default", "import_react", "DefineName", "controller", "displayName", "ref", "value", "setValue", "handleKeyDown", "event", "t", "range", "r", "parseReference", "sheetInfo", "handleChange", "React", "FormulaBar_default", "FormulaBarContainer", "controller", "activeCell", "activeCellStore", "editorStatus", "coreStore", "displayName", "intToColumnName", "editorValue", "handleClick", "React", "FormulaBar_default", "DefineName", "FormulaEditor", "getEditorStyle", "classnames", "getDisplayStyle", "import_react", "ToolBar_default", "toolbar-wrapper", "underlineList", "ToolbarContainer", "controller", "canRedo", "canUndo", "coreStore", "activeCell", "activeCellStore", "fontFamilyList", "fontFamilyStore", "getItemStyle", "value", "setCellStyle", "isBold", "isItalic", "isStrike", "fontSize", "fontColor", "fillColor", "isWrapText", "underline", "fontFamily", "handleFontFamilyChange", "t", "queryLocalFonts", "QUERY_ALL_LOCAL_FONT", "list", "fontList", "v", "isSupportFontFamily", "a", "b", "LOCAL_FONT_KEY", "l", "React", "ToolBar_default", "Button", "Icon", "$", "Select", "FONT_SIZE_LIST", "ColorPicker", "FillColorIcon", "InsertFloatingPicture", "isMobile", "InsertChart", "Github", "import_react", "import_react", "SheetBar_default", "sheet-bar-wrapper", "sheet-bar-list", "sheet-bar-item", "active", "sheet-bar-item-color", "sheet-bar-context-menu", "sheet-bar-input", "show-block", "sheet-bar-add", "sheet-bar-unhide", "add-button", "SheetBarContextMenu", "controller", "position", "sheetList", "currentSheetId", "hideMenu", "editSheetName", "ref", "useClickOutside", "tabColor", "v", "hideSheetList", "item", "handleUnhide", "value", "info", "$", "React", "Select", "handleTabColorChange", "color", "SheetBar_default", "Button", "ColorPicker", "SheetBarContainer", "controller", "sheetList", "sheetListStore", "realSheetList", "v", "currentSheetId", "activeCellStore", "menuPosition", "setMenuPosition", "DEFAULT_POSITION", "editing", "setEditing", "setSheetName", "sheetName", "handleContextMenu", "event", "pos", "handleKeyDown", "t", "React", "SheetBar_default", "item", "isActive", "showInput", "tabColor", "cls", "classnames", "style", "Button", "Icon", "SheetBarContextMenu", "containers_default", "app-container", "import_react", "import_react", "getImageSize", "base64", "resolve", "reject", "image", "width", "height", "error", "COMMON_PREFIX", "STYLE_PATH", "WORKBOOK_PATH", "WORKBOOK_RELATION_PATH", "THEME_PATH", "SHARED_STRINGS", "textKey", "DRAWING_PREFIX_KEY", "DRAWING_FLAG", "imageTypeMap", "chartTypeList", "CUSTOM_WIdTH_RADIO", "xmlToJson", "xml", "obj", "attribute", "item", "n", "convertXMLToJSON", "xmlStr", "convertRGB", "c", "colorPrefix", "convertColor", "themeData", "color", "themeIndex", "i", "getCellStyle", "styleId", "result", "xfList", "get", "xf", "alignMap", "fontList", "fontId", "font", "fz", "id", "NUMBER_FORMAT_LIST", "v", "list", "g", "p", "convertXMLDataToModel", "xmlData", "imageSizeMap", "workbook", "sharedStrings", "relationList", "sheetPathMap", "drawingMap", "drawingCount", "sheetList", "sheetSort", "sheetTarget", "worksheetPrefix", "baseSheet", "refPath", "sheetPath", "range", "parseReference", "sheetData", "sheets", "a", "b", "customWidth", "defaultWOrH", "col", "w", "CELL_WIDTH", "isHide", "start", "end", "getCustomWidthOrHeightKey", "colCount", "rowCount", "row", "realRow", "XLSX_MAX_ROW_COUNT", "isDefault", "CELL_HEIGHT", "colList", "XLSX_MAX_COL_COUNT", "val", "t", "text", "coordinateToString", "definedNames", "convertSheetName", "sheetName", "drawingId", "basePath", "key", "ref", "relations", "sheetId", "floatElementList", "float", "chartId", "imageId", "isImage", "rid", "target", "filePath", "fromRow", "fromCol", "uuid", "generateUUID", "floatElementData", "name", "title", "size", "chartType", "importXLSX", "file", "zip", "files", "data", "imageType", "type", "getCoreXML", "createDate", "createTime", "generateStyleFile", "styles", "getContentTypeXml", "extra", "REFS", "THEME1_XML", "CUSTOM_XML", "getSheetData", "activeCell", "sheetData", "isActiveSheet", "customWidthMap", "sheetId", "customWidth", "list", "key", "value", "t", "CUSTOM_WIdTH_RADIO", "realActiveCell", "v", "convertToReference", "convertColorToRGB", "val", "convertColorToHex", "convertStyle", "styles", "style", "isEmpty", "extraList", "result", "fontList", "item", "NUMBER_FORMAT_LIST", "alignment", "alignMap", "exportToXLSX", "fileName", "controller", "JSZip", "modelJson", "currentSheetId", "sheetList", "sheetRelMap", "i", "a", "zip", "contentTypeExtra", "getContentTypeXml", "REFS", "docProps", "getCoreXML", "CUSTOM_XML", "xl", "activeIndex", "convertSheetIdToSheetName", "id", "defineNames", "name", "range", "text", "workbook", "xlRel", "workbookRel", "THEME1_XML", "worksheets", "cellData", "rowMap", "rowList", "stringToCoordinate", "ref", "f", "convertResultTypeToString", "s", "rowKeyList", "row", "customHeight", "getCustomWidthOrHeightKey", "ht", "generateStyleFile", "blob", "saveAs", "DELIMITER", "RECORD_DELIMITER", "processItem", "value", "type", "processRow", "row", "quote", "escape", "csvRecord", "j", "field", "containDelimiter", "containsQuote", "containsEscape", "containsRecordDelimiter", "quotedString", "shouldQuote", "regexp", "exportToCsv", "fileName", "controller", "sheetData", "csvList", "sheetInfo", "list", "col", "key", "coordinateToString", "base", "blob", "saveAs", "MenuBar_default", "menubar-container", "menubar-menu", "theme-button", "i18n", "import_react", "setCssVariable", "data", "keyList", "key", "name", "value", "updateCssVariable", "darkColor", "lightColor", "Theme", "toggleTheme", "themeData", "setThemeData", "sizeConfig", "update", "c", "setTheme", "getTheme", "event", "isDark", "handleClick", "old", "n", "React", "Button", "MenuBar_default", "Icon", "import_react", "dataList", "LANGUAGE_LIST", "v", "defaultValue", "getLanguage", "I18N", "handleChange", "c", "l", "setLanguage", "React", "MenuBar_default", "Select", "menuStyle", "MenuBarContainer", "controller", "ref", "handleExportXLSX", "exportToXLSX", "handleExportCSV", "exportToCsv", "handleImport", "event", "file", "model", "importXLSX", "React", "MenuBar_default", "Menu", "Button", "$", "MenuItem", "SubMenu", "I18N", "Theme", "App", "controller", "React", "containers_default", "MenuBarContainer", "ToolbarContainer", "FormulaBarContainer", "CanvasContainer", "SheetBarContainer", "import_client", "import_react", "ROW_TITLE_HEIGHT", "COL_TITLE_WIDTH", "defaultScrollValue", "Controller", "model", "HTML_FORMAT", "PLAIN_FORMAT", "sheetId", "range", "hooks", "result", "controllerLog", "mergeCells", "item", "containRange", "direction", "startCol", "startRow", "sheetInfo", "check1", "check2", "temp", "id", "pos", "color", "sheetName", "json", "value", "style", "ranges", "col", "width", "isChanged", "row", "height", "headerSize", "colCount", "rowCount", "r", "endRow", "endCol", "size", "scroll", "resultX", "resultY", "c", "rowIndex", "count", "colIndex", "data", "text", "list", "last", "activeCell", "htmlString", "textList", "styleList", "parseHTML", "v", "html", "index", "classList", "currentSheetId", "t", "a", "Range", "str", "convertToCssString", "className", "htmlData", "generateHTML", "event", "uuid", "marginX", "marginY", "offset", "generateUUID", "check", "type", "keyList", "key", "canvas", "dom", "scrollbarSize", "sizeConfig", "name", "CustomError", "value", "assert", "condition", "message", "mustOne", "list", "mustOneString", "mustOneNumber", "mustEmpty", "T", "list", "value", "mustOne", "LOWER", "mustOneString", "CHAR", "mustOneNumber", "CODE", "LEN", "SPLIT", "assert", "sep", "UPPER", "TRIM", "CONCAT", "MAX_PARAMS_COUNT", "formulas", "text_default", "ABS", "list", "data", "mustOneNumber", "ACOS", "ACOSH", "ACOT", "ACOTH", "ASIN", "ASINH", "ATAN", "ATAN2", "assert", "x", "y", "ATANH", "COS", "COT", "EXP", "list", "data", "mustOneNumber", "INT", "PI", "list", "mustEmpty", "E", "SIN", "data", "mustOneNumber", "SUM", "rest", "parseNumberArray", "assert", "MAX_PARAMS_COUNT", "sum", "cur", "AVERAGE", "formulas", "ABS", "ACOS", "ACOSH", "ACOT", "ACOTH", "ASIN", "ASINH", "ATAN", "ATAN2", "ATANH", "COT", "COS", "EXP", "INT", "math_default", "allFormulas", "text_default", "math_default", "formula_default", "Token", "type", "value", "emptyData", "identifierMap", "Scanner", "source", "Token", "text", "type", "end", "CustomError", "char", "temp", "c", "FORMULA_PREFIX", "BinaryExpression", "left", "operator", "right", "visitor", "value", "result", "LiteralExpression", "UnaryExpression", "PostUnaryExpression", "CellExpression", "type", "sheetName", "CallExpression", "name", "params", "item", "CellRangeExpression", "GroupExpression", "TokenExpression", "errorSet", "Parser", "tokens", "result", "expr", "operator", "right", "BinaryExpression", "UnaryExpression", "PostUnaryExpression", "CellRangeExpression", "name", "params", "CallExpression", "value", "GroupExpression", "LiteralExpression", "realValue", "CustomError", "TokenExpression", "types", "type", "Token", "Interpreter", "expressions", "cellDataMap", "definedNamesMap", "functionMap", "result", "item", "CustomError", "data", "left", "right", "assert", "expr", "callee", "params", "t", "Range", "list", "sheetId", "parseReference", "type", "value", "defineName", "temp", "funcName", "func", "realValue", "newToken", "Token", "a", "b", "mergeRange", "TokenExpression", "CellExpression", "LiteralExpression", "sheetName", "parseFormula", "source", "cellData", "CellDataMapImpl", "definedNamesMap", "DefinedNamesMapImpl", "functionMap", "formula_default", "expressionStr", "list", "Scanner", "expressions", "Parser", "result", "Interpreter", "strList", "item", "error", "CustomError", "row", "col", "sheetId", "sheetNameMap", "range", "value", "i", "j", "key", "rowCount", "colCount", "r", "endRow", "c", "endCol", "sheetName", "name", "noop", "History", "options", "commands", "i", "list", "item", "hasRecord", "lower", "clearAll", "_list", "DELETE_FLAG", "getKey", "item", "setData", "obj", "key", "value", "res", "index", "arr", "Model", "json", "workbook", "mergeCells", "customHeight", "customWidth", "definedNames", "currentSheetId", "drawings", "rangeMap", "worksheets", "range", "row", "col", "sheetId", "id", "HIDE_CELL", "coordinateToString", "sheetName", "v", "History", "list", "modelLog", "a", "b", "newRange", "sheet", "oldValue", "isSameRange", "getDefaultSheetInfo", "DEFAULT_COL_COUNT", "DEFAULT_ROW_COUNT", "check", "assert", "$", "newSheetId", "oldSheet", "oldData", "color", "old", "sheetInfo", "oldName", "oldSheetId", "style", "ranges", "isEmpty", "r", "c", "t", "temp", "FORMULA_PREFIX", "rowCount", "colCount", "endRow", "endCol", "rowIndex", "count", "XLSX_MAX_ROW_COUNT", "sheetData", "stringToCoordinate", "i", "newKey", "newValue", "colIndex", "XLSX_MAX_COL_COUNT", "uuid", "oldCol", "oldColCount", "oldRow", "oldRowCount", "getCustomWidthOrHeightKey", "newData", "CELL_WIDTH", "width", "_isChanged", "CELL_HEIGHT", "height", "fromRange", "isCut", "activeCell", "realSheetId", "fromSheetData", "realRange", "currentSheetData", "oldPath", "realRow", "realCol", "path", "oldSheetData", "name", "result", "formula", "oldFormula", "k", "data", "fn", "parseFormula", "CustomError", "Range", "isLast", "lastIndex", "keyList", "oldStyle", "ref", "convertToReference", "oldRange", "dataset", "mockImage", "MOCK_MODEL", "DEFAULT_COL_COUNT", "DEFAULT_ROW_COUNT", "isMobile", "imageUuid", "generateUUID", "mockImage", "chartUuid", "initController", "model", "Model", "controller", "Controller", "initSentry", "sentry", "initExcel", "rootId", "domNode", "controller", "initController", "React", "App", "src_default", "MOCK_MODEL", "formula_default"]
}
